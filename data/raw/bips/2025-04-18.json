{
  "source": "github",
  "repository": "bitcoin/bips",
  "fetched_at": "2026-01-15T21:31:53.674375+00:00",
  "date": "2025-04-18",
  "pull_requests": [
    {
      "number": 1831,
      "title": "BIP 39: potential entropy distribution issue report",
      "body": "Potential Weakness in BIP-39 Mnemonic Entropy Distribution Across Multiple Languages",
      "state": "closed",
      "user": "okba14",
      "created_at": "2025-04-18T17:11:30Z",
      "updated_at": "2025-04-19T05:16:25Z",
      "comments": 7,
      "url": "https://github.com/bitcoin/bips/pull/1831",
      "labels": [],
      "comment_list": [
        {
          "user": "okba14",
          "body": "Hi maintainers ðŸ‘‹\r\n\r\nI initially attempted to submit this issue via GitHub Issues but could not proceed due to repository contribution restrictions. As recommended in the contributing guidelines, I am submitting my research via this pull request instead.\r\n\r\nLooking forward to your feedback. Thank you for your time and review!\r\n\r\nBest regards,  \r\nOkba [ GUIAR OQBA ]\r\ntechokba@gmail.com\r\n",
          "created_at": "2025-04-18T17:14:18Z"
        },
        {
          "user": "jonatack",
          "body": "Thank you for your report.\r\n\r\nDoes this pertain to the BIP39 reference implementation (https://github.com/trezor/python-mnemonic)?\r\n\r\nFor more context, see:\r\n\r\n- https://github.com/bitcoin/bips/pull/1413#issuecomment-1416160292\r\n- https://github.com/bitcoin/bips/pull/1677#discussion_r1788604447\r\n\r\nNote that BIP39 replacements exist like https://github.com/satoshilabs/slips/blob/master/slip-0039.md and BIP93.\r\n\r\nPerhaps add your feedback to https://github.com/bitcoin/bips/wiki/Comments:BIP-0039 if applicable to the BIP39 spec or its reference implementation.\r\n\r\nClosing this PR, as it isn't a change that is intended to be merged. Feel free to continue the discussion here. Thanks!",
          "created_at": "2025-04-18T17:41:16Z"
        },
        {
          "user": "okba14",
          "body": "Thank you for your response and for the helpful references.\r\n\r\nYes, my findings are primarily related to how the BIP-39 standard is implemented and used in practice, including but not limited to the python-mnemonic reference implementation. The statistical anomalies I observed could point to either potential implementation issues or broader concerns regarding entropy usage in mnemonic generation across different platforms and languages.\r\n\r\nI understand this PR doesn't fit the criteria for a direct merge, and I appreciate the clarification. I will follow your suggestion and contribute my observations to the [BIP-0039 Comments Wiki](https://github.com/bitcoin/bips/wiki/Comments:BIP-0039) to help improve awareness and discussion around this topic.\r\n\r\nThank you again for your time and for maintaining such an important repository.\r\n\r\nBest regards,\r\nOkba [ GUIAR OQBA ]\r\nSecurity Researcher",
          "created_at": "2025-04-18T18:03:17Z"
        },
        {
          "user": "jonatack",
          "body": "@okba14 in that comments wiki, I see that you added this note:\r\n\r\n```\r\nðŸ“Œ Final Note from the Researcher:\r\n\r\nThis report is submitted as an initiative to raise security awareness and improve the implementation quality of the BIP-39 standard across different languages and platforms. All observations are based on scientific analysis and public data without compromising any privacy or breaching any system.\r\n\r\nI welcome all your feedback and comments, and look forward to collaborating with the developer and research community to ensure a more secure environment for blockchain technology users.\r\n\r\nBest regards, Okba [GUIAR OQBA] Cybersecurity Researcher\r\n```\r\n\r\nIt seems to be missing some content that you wished to add. Let me know if I can help.",
          "created_at": "2025-04-18T20:05:03Z"
        },
        {
          "user": "okba14",
          "body": "Hi @jonatack, thank you again for your follow-up and close attention.\r\n\r\nYou're absolutely right â€” the note I added to the wiki was intentionally concise, but I now realize it may have created the impression that something was missing. In fact, I was initially being cautious not to overload the space with technical details before confirming the appropriateness of such content.\r\n\r\nAs a cybersecurity researcher, my intention is to shed light on a potentially serious entropy-related issue that I encountered while analyzing the generation and recovery of BIP-39 mnemonic phrases. In short, while testing wallet recovery mechanisms, I was struck by the surprisingly high number of successful wallet restorations using algorithmically generated mnemonic phrases â€” far beyond what should statistically occur under ideal entropy assumptions.\r\n\r\nI've documented the full methodology, findings, and statistical outcomes in a structured report, including:\r\n\r\nScripted generation and validation of mnemonics using bip_utils, web3.py, and solana.rpc.api\r\n\r\nObserved frequency-based patterns across different languages and positions within the 12/24-word phrases\r\n\r\nA sample set of empty but valid wallets generated during testing (ready to share securely)\r\n\r\nStatistical summaries showing thousands of real wallet recoveries, with balances in some cases\r\n\r\nGiven the sensitivity of this topic (especially with real wallets being unintentionally accessed), I wanted to ensure responsible disclosure practices and community input before publishing further.\r\n\r\nI would greatly appreciate your guidance on how best to proceed:\r\n\r\nWould you recommend submitting the full report as a supplemental document?\r\n\r\nOr would it be more appropriate to open a new structured discussion in the BIP39 Comments Wiki?\r\n\r\nAgain, thank you for your support and consideration. My sole intent is to contribute meaningfully to the improvement and awareness of potential implementation-level risks in widely-used crypto standards like BIP-39.\r\n\r\nBest regards,\r\nOkba [GUIAR OQBA]\r\nCybersecurity Researcher\r\ntechokba@gmail.com\r\n\r\n",
          "created_at": "2025-04-18T21:07:57Z"
        },
        {
          "user": "murchandamus",
          "body": "@okba14: Do you think your findings could be explained by some users manually picking their own words from the word list to create mnemonics rather than generating them randomly?",
          "created_at": "2025-04-18T23:21:43Z"
        },
        {
          "user": "okba14",
          "body": "@murchandamus : Thank you for your input!\n\nWhile itâ€™s technically possible for advanced users to manually select words from the BIP39 word list and import them into wallets that support custom mnemonics, the majority of mainstream wallets do not allow users to manually craft their mnemonic phrasesâ€”theyâ€™re usually generated randomly using secure entropy sources.\n\nIn my analysis, I considered the possibility of handcrafted mnemonics, but the patterns observed appear too frequent and systematic to be fully explained by manual selection. The entropy distribution and word frequency suggest potential bias or deviation in the generation process, possibly at the wallet level.\n\nStill, I agree it's a factor worth keeping in mind when interpreting the findings.\n",
          "created_at": "2025-04-19T05:16:24Z"
        }
      ]
    },
    {
      "number": 1830,
      "title": "Add BIP: QES2 â€“ Hybrid PQC-based Digital Signature Algorithm",
      "body": "Summary:\r\nThis pull request introduces a new Bitcoin Improvement Proposal (BIP) for QES2, a hybrid digital signature algorithm that combines post-quantum cryptography (PQC) with traditional ECDSA. The proposal aims to address the potential vulnerabilities posed by quantum computing while preserving backward compatibility with existing Bitcoin infrastructure.\r\n\r\nDetails:\r\n\r\nAbstract: QES2 leverages a dual-signature mechanism to incorporate both a post-quantum signature and a classical ECDSA signature into Bitcoin transactions.\r\n\r\nMotivation: With the emerging threat of quantum computers, classical cryptographic methods may become vulnerable. QES2 presents a transitional solution that enhances security during the shift towards quantum-safe systems.\r\n\r\nSpecification: The BIP outlines the structure, key generation, signing, and verification methods for the hybrid scheme.\r\n\r\nRationale: The hybrid approach ensures that if one signature method is compromised, the other still provides protection, offering a balanced trade-off between security and backward compatibility.\r\n\r\nReference Implementation: A reference implementation will be linked later for further review and testing.",
      "state": "open",
      "user": "j1729labs",
      "created_at": "2025-04-18T08:03:18Z",
      "updated_at": "2025-09-10T21:35:35Z",
      "comments": 16,
      "url": "https://github.com/bitcoin/bips/pull/1830",
      "labels": [
        "New BIP",
        "PR Author action required"
      ],
      "comment_list": [
        {
          "user": "cryptoquick",
          "body": "Would it make sense to just add QES2 support to [BIP-360](https://github.com/cryptoquick/bips/blob/p2qrh/bip-0360.mediawiki)?\r\n",
          "created_at": "2025-04-18T15:29:37Z"
        },
        {
          "user": "jonatack",
          "body": "Hi @j1729labs, have you posted about this to the bitcoin-dev mailing list at https://groups.google.com/g/bitcoindev? Please refer to https://github.com/bitcoin/bips/blob/master/bip-0002.mediawiki#user-content-BIP_workflow for details. Thanks!\r\n",
          "created_at": "2025-04-18T17:54:07Z"
        },
        {
          "user": "j1729labs",
          "body": "> Hi @j1729labs, have you posted about this to the bitcoin-dev mailing list at https://groups.google.com/g/bitcoindev? Please refer to https://github.com/bitcoin/bips/blob/master/bip-0002.mediawiki#user-content-BIP_workflow for details. Thanks!\r\n\r\nThank you for the guidance. I will make sure to post this to the mailing list.",
          "created_at": "2025-05-12T03:50:42Z"
        },
        {
          "user": "murchandamus",
          "body": "Hi @j1729labs, are you still working on this proposal?",
          "created_at": "2025-06-20T22:23:27Z"
        },
        {
          "user": "j1729labs",
          "body": "> Hi @j1729labs, are you still working on this proposal?\r\n\r\nBased on your advice, I intend to deliver meaningful outcomes and build upon them to develop further proposals. Thank you for your support.",
          "created_at": "2025-06-21T00:18:36Z"
        },
        {
          "user": "j1729labs",
          "body": "To @murchandamus, @cryptoquick, and @jonatack,\r\n\r\nFirst of all, thank you very much for your valuable advice. Initially, we focused on developing general-purpose technologies, but your insights helped us recognize the importance of building solutions tailored specifically for Bitcoin.\r\n\r\nBased on this, we extended our original QES2 framework into a hybrid signature scheme incorporating the Schnorr algorithm. Considering existing protocols, the implementation was not particularly difficult. As a result, we split QES2 into two variants â€” QES2_ECDSA and QES2_Schnorr â€” and have completed the corresponding whitepaper.\r\n\r\n[QES2_Schnorr Architecture and Design]\r\n\r\nA hybrid signature algorithm that performs the first signature using Dilion (an improved version of Dilithium) and the second signature using Schnorr.\r\n\r\nThe Dilion signature is generated off-chain, and the resulting signature is wrapped with a Schnorr signature so that Bitcoin can perform verification using its native Schnorr support.\r\n\r\n[Benefits of QES2_Schnorr]\r\n\r\nIt is structured to enable seamless compatibility with Bitcoinâ€™s Schnorr verification without additional processing of the off-chain Dilion signature.\r\n\r\nAlthough the total signature size is about 4000 bytes (similar to Dilion), only a 64-byte Schnorr signature is used on-chain, achieving lightweight on-chain performance.\r\n\r\nThe scheme maintains post-quantum security due to its structural integration with Dilion.\r\n\r\nWe have built a website to provide access to the whitepaper and allow you to try out the demo.\r\n\r\nðŸ”— Website: https://pqc-function.xyz/\r\n\r\nAbout the site:\r\nIt introduces Dilion, a post-quantum digital signature algorithm (an enhanced version of Dilithium), as well as hybrid schemes QES2_Schnorr and QES2_ECDSA, and the zk-FIDNA zero-knowledge proof algorithm. The platform also provides engine APIs as a SaaS service.",
          "created_at": "2025-07-07T04:40:39Z"
        },
        {
          "user": "cryptoquick",
          "body": "If you're still committing to a secp256k1 key, which is what you'd need to do if you use a P2TR address, you're still vulnerable against quantum attackers. I'm not sure what this gets you without key path spends disabled.",
          "created_at": "2025-07-07T07:30:18Z"
        },
        {
          "user": "j1729labs",
          "body": "> If you're still committing to a secp256k1 key, which is what you'd need to do if you use a P2TR address, you're still vulnerable against quantum attackers. I'm not sure what this gets you without key path spends disabled.\r\n\r\n## QES2\\_Schnorr: A Hybrid Signature Scheme that Achieves Post-Quantum Security in Taproot Without Public Key Exposure\r\n\r\nBitcoin's Taproot (P2TR) was introduced to simplify signature structures, improve privacy, and enable greater scripting capabilities. It utilizes the Schnorr signature algorithm as its core. However, Taproot still requires the commitment of a **secp256k1-based public key** on-chain, which becomes a security liability in a **post-quantum context**, where quantum computers could eventually derive private keys from exposed public keys.\r\n\r\nTo address this structural vulnerability, we introduce **QES2\\_Schnorr**, a hybrid signature scheme designed to retain full Taproot compatibility while providing **post-quantum resilience without revealing the committed public key**.\r\n\r\n---\r\n\r\n##  QES2\\_Schnorr Architecture Overview\r\n\r\nQES2\\_Schnorr generates signatures through two distinct phases:\r\n\r\n1. **Primary Signature (Off-chain, PQC-based)**\r\n   â†’ A signature is first generated using **Dilion**, a post-quantum secure scheme derived from Dilithium. This ensures quantum-resistant forgery protection at the origin of the transaction.\r\n\r\n2. **Secondary Signature (On-chain, Schnorr-based)**\r\n   â†’ The Dilion signature is then treated as the message input for generating a **Schnorr signature**. This final Schnorr signature is what gets included and verified on-chain under a Taproot (`P2TR`) address.\r\n\r\nIn this model, while the address remains in Taproot format (`bc1p...`), the **secp256k1 public key is never directly revealed** on-chain. The only data accessible to the blockchain is the Schnorr signature itself, which encapsulates the quantum-secure Dilion signature. As a result, even in the presence of quantum adversaries, an attack would require breaking the underlying PQ signature schemeâ€”**a computationally infeasible task**.\r\n\r\n",
          "created_at": "2025-07-07T08:22:12Z"
        },
        {
          "user": "cryptoquick",
          "body": "Whatever Taproot address is committed to, that corresponds to a valid private key, no matter if it's part of your scheme or not. A CRQC running Shor's could absolutely compromise the funds in that address if the key path spend is not disabled.",
          "created_at": "2025-07-07T08:25:13Z"
        },
        {
          "user": "j1729labs",
          "body": "> Whatever Taproot address is committed to, that corresponds to a valid private key, no matter if it's part of your scheme or not. A CRQC running Shor's could absolutely compromise the funds in that address if the key path spend is not disabled.\r\n\r\nThanks for the insight â€” your point about Taproot committing to a secp256k1 key is absolutely valid. However, in the QES2\\_Schnorr scheme we're working on, **key path spend is deliberately disabled**. So although the Taproot address includes a commitment to a classical key, itâ€™s never used to authorize spending. This effectively removes the classical path that a quantum attacker would exploit.\r\n\r\nInstead, **spending is enforced entirely through the script path**, where we include **post-quantum signatures like Dilithium** in the MAST structure. QES2\\_Schnorr isnâ€™t about relying solely on Schnorr â€” itâ€™s used selectively within a hybrid architecture that combines compatibility (with Bitcoinâ€™s existing stack) and forward-looking quantum resistance. So in practice, the design stays secure against CRQC, while remaining deployable in today's ecosystem. \r\n\r\nI would appreciate it if you could understand that, for now, this primarily represents the cryptographic approach required for such development, rather than the overall system architecture.\r\n",
          "created_at": "2025-07-07T08:37:48Z"
        },
        {
          "user": "cryptoquick",
          "body": "That's not quite what the BIP says:\r\nhttps://github.com/bitcoin/bips/pull/1830/files#diff-43c37a8806b41fe5af6e8835d2cb9c00e662fb80228bdb8a0f3ea372b086959fR332-R342\r\n\r\nAlso, P2QRH is being trimmed down quite a bit in the recent edits. If you want, you can review the changes and see if you might want to make it a dependency of this BIP:\r\nhttps://github.com/cryptoquick/bips/pull/21",
          "created_at": "2025-07-07T08:42:32Z"
        },
        {
          "user": "j1729labs",
          "body": "> That's not quite what the BIP says: https://github.com/bitcoin/bips/pull/1830/files#diff-43c37a8806b41fe5af6e8835d2cb9c00e662fb80228bdb8a0f3ea372b086959fR332-R342\r\n> \r\n> Also, P2QRH is being trimmed down quite a bit in the recent edits. If you want, you can review the changes and see if you might want to make it a dependency of this BIP: [cryptoquick#21](https://github.com/cryptoquick/bips/pull/21)\r\n\r\nYes, I understand! Actually, I haven't made the changes yet, but I'm planning to revise the BIP proposal based on the advice you kindly shared, @cryptoquick. I just wanted to leave a comment first to show that I'm taking your suggestions seriously and planning to make improvements!\r\n\r\nI was hoping for a bit of encouragement, so I was a little sad to get corrected instead. ðŸ˜…\r\nBut I appreciate the feedback â€” Iâ€™ll make sure to review everything more thoroughly.\r\n",
          "created_at": "2025-07-07T08:58:04Z"
        },
        {
          "user": "samuelmanzanera",
          "body": "> > That's not quite what the BIP says: https://github.com/bitcoin/bips/pull/1830/files#diff-43c37a8806b41fe5af6e8835d2cb9c00e662fb80228bdb8a0f3ea372b086959fR332-R342\r\n> > Also, P2QRH is being trimmed down quite a bit in the recent edits. If you want, you can review the changes and see if you might want to make it a dependency of this BIP: [cryptoquick#21](https://github.com/cryptoquick/bips/pull/21)\r\n> \r\n> Yes, I understand! Actually, I haven't made the changes yet, but I'm planning to revise the BIP proposal based on the advice you kindly shared, @cryptoquick. I just wanted to leave a comment first to show that I'm taking your suggestions seriously and planning to make improvements!\r\n> \r\n> I was hoping for a bit of encouragement, so I was a little sad to get corrected instead. ðŸ˜… But I appreciate the feedback â€” Iâ€™ll make sure to review everything more thoroughly.\r\n\r\nI think it is totally okay that the changes aren't made yet; just showing you're engaged and planning to improve is already a big step forward. \r\nItâ€™s clear you're putting genuine effort into this, and that kind of attitude is exactly what makes collaboration productive and rewarding. \r\nThe approach for the hybrid solution of post quantum and still relying on ECDSA seems interesting and promising. Keep going, I'm sure your work here would be appreciated! ",
          "created_at": "2025-07-07T12:07:27Z"
        },
        {
          "user": "cryptoquick",
          "body": "I'll admit I would be more encouraging if I understood it better. I still don't really understand the _why_ behind this. Please be sure to do your best to explain, in simple but comprehensive terms, why this necessary. I also invite you to find flaws in P2QRH as it stands now, or how this might be capable of being integrated into that in some way.",
          "created_at": "2025-07-09T15:34:48Z"
        },
        {
          "user": "murchandamus",
          "body": "Hey @j1729labs, it has been about four months since this pull request was opened. My understanding is that you are working on the implementation corresponding to this proposal, but this proposal itself has not seen any updates since then. We prefer pull requests to be opened against this repository when a proposal is close to ready for publication and actively being developed.\r\n\r\nIt doesnâ€™t make sense to me for this pull request to be open, if the proposal is not getting updates. Could you please share your timeline when you expect work on this proposal to pick up? If this is not expected to be updated within the next month, perhaps it would make more sense if the pull request were closed for now and you would submit your document at a later time when you are focused on it.",
          "created_at": "2025-08-08T23:09:58Z"
        },
        {
          "user": "j1729labs",
          "body": "> Hey @j1729labs, it has been about four months since this pull request was opened. My understanding is that you are working on the implementation corresponding to this proposal, but this proposal itself has not seen any updates since then. We prefer pull requests to be opened against this repository when a proposal is close to ready for publication and actively being developed.\r\n> \r\n> It doesnâ€™t make sense to me for this pull request to be open, if the proposal is not getting updates. Could you please share your timeline when you expect work on this proposal to pick up? If this is not expected to be updated within the next month, perhaps it would make more sense if the pull request were closed for now and you would submit your document at a later time when you are focused on it.\r\n\r\nThank you for the feedback. First of all, I apologize for the delay over the past period. I believed it would be more meaningful to complete the results and proceed with a paper submission before updating, and that work has now been completed and the updates are in place. I will make sure to take your suggestion into account and manage this more appropriately moving forward.",
          "created_at": "2025-09-08T05:33:02Z"
        }
      ]
    }
  ],
  "issues": [],
  "summary": {
    "pull_requests": 2,
    "issues": 0
  }
}