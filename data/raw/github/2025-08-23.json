{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T20:08:40.250427+00:00",
  "date": "2025-08-23",
  "pull_requests": [
    {
      "number": 33248,
      "title": "doc: Replace FIXME placeholders with correct libblkmaker version numbers",
      "body": "## Summary\n\nThis PR replaces FIXME placeholders in the release notes with the correct libblkmaker version numbers.\n\n## Changes\n\n- Replace FIXME placeholders in release notes with correct version numbers:\n  - `FIXME` ‚Üí `0.4.2`\n  - `FIXME` ‚Üí `0.5.1`\n\n## Context\n\nThe release notes for version 0.10.4 contained FIXME placeholders for libblkmaker version numbers. These same version numbers are correctly specified in other release notes (e.g., 0.9.5, 0.10.0, 0.11.2) as 0.4.2 and 0.5.1.\n\n## Testing\n\n- [x] Verified the change is correct by comparing with other release notes\n- [x] No functional changes - this is purely documentation\n- [x] Follows Bitcoin Core documentation style\n\n## Why This Matters\n\nComplete and accurate documentation helps users understand the correct version requirements for mining software when upgrading Bitcoin Core.\n\nThis is my second contribution to Bitcoin Core. I chose this TODO item because it's:\n- Low risk (documentation only)\n- Clearly actionable\n- Improves documentation quality\n- Easy to verify correctness ",
      "state": "closed",
      "user": "151henry151",
      "created_at": "2025-08-23T22:36:50Z",
      "updated_at": "2025-08-24T11:30:37Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/33248",
      "labels": [
        "Docs"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "üìÅ Archived release notes are archived and should not be modified.",
          "created_at": "2025-08-23T22:36:55Z"
        },
        {
          "user": "DrahtBot",
          "body": "‚ôªÔ∏è Automatically closing for now based on heuristics. Please leave a comment, if this was erroneous. Generally, please focus on creating high-quality, original content that demonstrates a clear understanding of the project's requirements and goals.",
          "created_at": "2025-08-23T22:36:56Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33248.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-08-23T22:36:58Z"
        },
        {
          "user": "151henry151",
          "body": "I thought this might be a worthwhile first attempt at contributing to the bitcoin core project, but it looks like the pull request was closed automatically. Can someone help me understand why, or check this out to see if that is correct?",
          "created_at": "2025-08-23T22:54:00Z"
        },
        {
          "user": "hebasto",
          "body": "> ... it looks like the pull request was closed automatically. Can someone help me understand why...\r\n\r\nSee https://github.com/bitcoin/bitcoin/pull/33248#issuecomment-3217454645.",
          "created_at": "2025-08-24T11:30:37Z"
        }
      ]
    },
    {
      "number": 33247,
      "title": "build: Remove CMAKE_SKIP_BUILD_RPATH and SKIP_BUILD_RPATH settings",
      "body": "Remove CMAKE_SKIP_BUILD_RPATH and SKIP_BUILD_RPATH settings that are no longer needed after reordering the Guix build script to perform binary checks after installation.\n\nThis PR also removes the unused CMake maintenance targets (`check-security` and `check-symbols`) and updates the Guix security checks to include binaries in the `libexec/` directory (added in PR #31679).",
      "state": "closed",
      "user": "151henry151",
      "created_at": "2025-08-23T22:35:38Z",
      "updated_at": "2025-11-17T11:00:09Z",
      "comments": 35,
      "url": "https://github.com/bitcoin/bitcoin/pull/33247",
      "labels": [
        "Build system"
      ]
    },
    {
      "number": 33243,
      "title": "test: Fix CLI_MAX_ARG_SIZE issues",
      "body": "`CLI_MAX_ARG_SIZE` has many edge case issues:\r\n\r\n* It seems to be lower on some systems, but it is unknown how to reproduce locally: https://github.com/bitcoin/bitcoin/pull/33079#issuecomment-3139957274\r\n* `MAX_ARG_STRLEN` is a limit per arg, but we probably want \"The maximum length of [all of] the arguments\": See https://www.man7.org/linux/man-pages/man3/sysconf.3.html, section `ARG_MAX - _SC_ARG_MAX`.\r\n* It doesn't account for the additional args added by the `bitcoin` command later on: https://github.com/bitcoin/bitcoin/blob/73220fc0f958f9b65f66cf0cf042af220b312fc6/src/bitcoin.cpp#L85-L92\r\n* It doesn't account for unicode encoding a string to bytes before taking its length.\r\n\r\nThe issues are mostly harmless edge cases, but it would be good to fix them. So do that here, by:\r\n\r\n* Replacing `max()` by `sum()`, to correctly take into account all args, not just the largest one.\r\n* Reduce `CLI_MAX_ARG_SIZE`, to account for the `bitcoin` command additional args.\r\n\r\nAlso, there is a test. The test can be called with `ulimit` to hopefully limit the max args size to the hard-coded value in the test framework. For reference:\r\n\r\n```\r\n$ ( ulimit -s 512 && python3 -c 'import os; print(os.sysconf(\"SC_ARG_MAX\") )' ) \r\n131072\r\n```\r\n\r\nOn top of this pull it should pass, ...\r\n\r\n```\r\nbash -c 'ulimit -s 512 && BITCOIN_CMD=\"bitcoin -M\" ./bld-cmake/test/functional/rpc_misc.py --usecli -l DEBUG'\r\n```\r\n\r\n... and with the test_framework changes reverted, it should fail:\r\n\r\n\r\n```\r\nOSError: [Errno 7] Argument list too long: 'bitcoin'\r\n```\r\n\r\n\r\nAlso, there is a commit to enable `CI_LIMIT_STACK_SIZE=1` in the i686 task, because it should now be possible and no longer hit the hard-to-reproduce issue mentioned above.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-08-23T09:39:43Z",
      "updated_at": "2025-09-26T08:18:13Z",
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/pull/33243",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33243.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [cedwies](https://github.com/bitcoin/bitcoin/pull/33243#issuecomment-3224114903), [enirox001](https://github.com/bitcoin/bitcoin/pull/33243#pullrequestreview-3156543444), [mzumsande](https://github.com/bitcoin/bitcoin/pull/33243#pullrequestreview-3206763025), [achow101](https://github.com/bitcoin/bitcoin/pull/33243#issuecomment-3282836726) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-08-23T09:39:47Z"
        },
        {
          "user": "cedwies",
          "body": "ACK fabe214\r\n\r\nThis PR fixes how the functional test framework estimates command-line argument size. Previously it checked only the longest argument, but the OS limit is on the total argv/env size, so it now sums all args. It also adds a functional test using very large echo args, which exercises the `-stdin` fallback. The test passes for me.\r\n\r\nI appreciate lowering `CLI_MAX_ARG_SIZE` to `1024`. It‚Äôs a very safe, conservative threshold that avoids platform-dependent `ARG_MAX` issues, and since larger payloads automatically go through -stdin anyway, I see no real downside. A nice fail-safe change IMO.",
          "created_at": "2025-08-25T16:18:53Z"
        },
        {
          "user": "cedwies",
          "body": "ACK fa96a4a",
          "created_at": "2025-08-26T13:09:14Z"
        },
        {
          "user": "maflcko",
          "body": "> the relevant bottleneck for me (tested on Ubuntu and Debian) was not `ARG_MAX`, but `MAX_ARG_STRLEN`, which accounts for the maximum per arg, not the sum.\r\n\r\nThanks for clarifying that this was intentionally picked and that `MAX_ARG_STRLEN` is a limit per arg, separate from the command size limit `SC_ARG_MAX`. `SC_ARG_MAX` is larger on many modern systems, but not all. Also, it reduces to `MAX_ARG_STRLEN`, or even lower on some systems. I've edited the pull description, to better reflect this.",
          "created_at": "2025-08-27T05:48:09Z"
        },
        {
          "user": "maflcko",
          "body": "(+GHA ci)",
          "created_at": "2025-09-04T10:12:09Z"
        },
        {
          "user": "achow101",
          "body": "ACK fa96a4afea2a9bf90c843198e75a00acef02c32d",
          "created_at": "2025-09-11T22:32:33Z"
        },
        {
          "user": "fanquake",
          "body": "Backported to 30.x in #33356.",
          "created_at": "2025-09-15T09:25:19Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 33246,
      "title": "tracing: test `interface_usdt_net.py` fails due to garbage message type in `net:outbound_message` tracepoint",
      "body": "The functional test `interface_usdt_net.py` currently fails on master (commit 73220fc0f958f9b65f66cf0cf042af220b312fc6) on my aarch64 machine, running Ubuntu 25.04:\n```\n$ cmake -B build -DWITH_USDT=ON\n$ cmake --build build -j12\n# ./build/test/functional/interface_usdt_net.py\n2025-08-23T10:53:12.137229Z TestFramework (INFO): PRNG seed is: 2587673157417500984\n2025-08-23T10:53:12.137976Z TestFramework (INFO): Initializing test directory /tmp/bitcoin_func_test_iem787yt\n2025-08-23T10:53:12.415409Z TestFramework (INFO): hook into the net:inbound_message and net:outbound_message tracepoints\n2025-08-23T10:53:13.229315Z TestFramework (INFO): connect a P2P test node to our bitcoind node\n2025-08-23T10:53:13.336504Z TestFramework (INFO): check receipt and content of in- and outbound version messages\n2025-08-23T10:53:13.336668Z TestFramework (INFO): check_p2p_message(): inbound P2PMessage(peer=0, addr=127.0.0.1:54608, conn_type=inbound, msg_type=version, msg_size=111)\n2025-08-23T10:53:13.341459Z TestFramework (ERROR): Unexpected exception\nTraceback (most recent call last):\n  File \"/home/thestack/bitcoin/test/functional/test_framework/test_framework.py\", line 195, in main\n    self.run_test()\n    ~~~~~~~~~~~~~^^\n  File \"/home/thestack/bitcoin/./build/test/functional/interface_usdt_net.py\", line 260, in run_test\n    self.p2p_message_tracepoint_test()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/thestack/bitcoin/./build/test/functional/interface_usdt_net.py\", line 334, in p2p_message_tracepoint_test\n    check_p2p_message(event, is_inbound)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^\n  File \"/home/thestack/bitcoin/./build/test/functional/interface_usdt_net.py\", line 300, in check_p2p_message\n    if event.msg_type.decode(\"utf-8\") == \"version\":\n       ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xa8 in position 0: invalid start byte\n.....\n```\n\nThe message type parameter in the `net:outbound_message` tracepoint seems to point to garbage at the time it is evaluated in the probe, as printing out the `event.msg_type` contents over a few test runs shows:\n```\nevent.msg_type == b'\\xa8\\xc2\\xffG\\xff\\xff'\nevent.msg_type == b'\\xa8\\xb2\\xfbt\\xff\\xff'\nevent.msg_type == b'\\xa8\\xb2|i\\xff\\xff'\nevent.msg_type == b'\\xa8\\xc2\\xffo\\xff\\xff'\nevent.msg_type == b'\\xa8\\xc2~S\\xff\\xff'\n.....\n```\n\nIt looks like a potential life-time issue, but it's unclear to me how this could be possible at all  (see also e.g. https://github.com/bitcoin/bitcoin/issues/27380#issuecomment-2286970765), given that probes should be executed synchronously and the relevant msgtype object is clearly still alive after the tracepoint call (`msg` gets `std::move`d later in the function though):\nhttps://github.com/bitcoin/bitcoin/blob/73220fc0f958f9b65f66cf0cf042af220b312fc6/src/net.cpp#L3885\n\nOS / compiler / packages:\n```\n$ head -1 /etc/issue\nUbuntu 25.04 \\n \\l\n$ uname -s -r -v -m\nLinux 6.16.0-21-qcom-x1e #21-Ubuntu SMP PREEMPT_DYNAMIC Sun Aug 10 00:54:48 UTC 2025 aarch64\n$ gcc --version | head -1\ngcc (Ubuntu 14.2.0-19ubuntu2) 14.2.0\n$ apt info systemtap-sdt-dev | grep Version\nVersion: 5.1-4.1\n```",
      "state": "open",
      "user": "theStack",
      "created_at": "2025-08-23T11:25:21Z",
      "updated_at": "2026-01-15T09:14:29Z",
      "comments": 8,
      "url": "https://github.com/bitcoin/bitcoin/issues/33246",
      "labels": [
        "Tests",
        "Scripts and tools",
        "interfaces"
      ],
      "comment_list": [
        {
          "user": "achow101",
          "body": "I'm able to reproduce this with a release build, but not a debug build.",
          "created_at": "2025-08-26T23:28:30Z"
        },
        {
          "user": "maflcko",
          "body": "I can reproduce via `-DAPPEND_CXXFLAGS='-O1 -g2'`, but it passes via `-DAPPEND_CXXFLAGS='-O1 -fno-inline    -g2'`, so I wonder if this is a compiler error, or if the error is something else.",
          "created_at": "2025-08-27T10:27:41Z"
        },
        {
          "user": "0xB10C",
          "body": "Can you share the output of `readelf -n ./build/bin/bitcoind | grep outbound_message -A 5 -B 3`?\n\nI wonder if this is related to https://github.com/bitcoin/bitcoin/issues/33227",
          "created_at": "2025-09-02T20:44:28Z"
        },
        {
          "user": "theStack",
          "body": "> Can you share the output of `readelf -n ./build/bin/bitcoind | grep outbound_message -A 5 -B 3`?\n\nSure:\n```\n$ readelf -n ./build/bin/bitcoind | grep outbound_message -A 5 -B 3\n    Arguments: -8@x21 8@x22 8@x23 4@x20 8@x0\n  stapsdt              0x00000057       NT_STAPSDT (SystemTap probe descriptors)\n    Provider: net\n    Name: outbound_message\n    Location: 0x00000000000cf3ac, Base: 0x00000000009ca828, Semaphore: 0x0000000000b19428\n    Arguments: -8@x21 8@x24 8@[sp, 136] 8@[x0] 8@x1 8@x2\n  stapsdt              0x00000044       NT_STAPSDT (SystemTap probe descriptors)\n    Provider: net\n    Name: misbehaving_connection\n```\n\n> I can reproduce via `-DAPPEND_CXXFLAGS='-O1 -g2'`, but it passes via `-DAPPEND_CXXFLAGS='-O1 -fno-inline -g2'`, so I wonder if this is a compiler error, or if the error is something else.\n\nCan confirm that when I build with `-DAPPEND_CXXFLAGS='-fno-inline'`, the problem doesn't occur anymore (didn't try any explicit optimization level / debug options yet).",
          "created_at": "2025-09-02T21:25:24Z"
        },
        {
          "user": "0xB10C",
          "body": ">     Arguments: -8@x21 8@x24 8@[sp, 136] 8@[x0] 8@x1 8@x2\n\nAre these the same if you build with `-DAPPEND_CXXFLAGS='-fno-inline'`? ",
          "created_at": "2025-09-03T08:20:42Z"
        },
        {
          "user": "theStack",
          "body": "> > ```\n> > Arguments: -8@x21 8@x24 8@[sp, 136] 8@[x0] 8@x1 8@x2\n> > ```\n> \n> Are these the same if you build with `-DAPPEND_CXXFLAGS='-fno-inline'`?\n\nThey are quite different on a `-fno-inline` build:\n\n```\n    Name: outbound_message\n    Location: 0x000000000012ed28, Base: 0x000000000111c6d8, Semaphore: 0x00000000016594d0\n    Arguments: -8@x23 8@x24 8@x25 8@x26 8@x27 8@x0\n```\n",
          "created_at": "2025-09-03T12:43:24Z"
        },
        {
          "user": "0xB10C",
          "body": "These arguments translate to the `net:outbound_message` tracepoint arguments.\n\n| arg                                       | broken      | `-fno-inline` working |\n|-------------------------------------------|-------------|-----------------------|\n| `pnode->GetId()`                          | -8@x21      | -8@x23                |\n| `pnode->m_addr_name.c_str()`              | 8@x24       | 8@x24                 |\n| `pnode->ConnectionTypeAsString().c_str()` | 8@[sp, 136] | 8@x25                 |\n| `msg.m_type.c_str()`                      | **8@[x0]**      | 8@x26                 |\n| `msg.data.size()`                         | 8@x1        | 8@x27                 |\n| `msg.data.data()`                         | 8@x2        | 8@x0                  |\n\nSo I suspect there's a problem with either how:\n- bcc on aarch64 reading the value from register `x0` when it's written as `8@[x0]`\n- systemtap on aarch64 writes these ELF notes\n\n ",
          "created_at": "2025-09-03T13:10:28Z"
        },
        {
          "user": "0xB10C",
          "body": "As per https://github.com/iovisor/bcc/blob/791bf81ad9ec18ce2899f79509e4de96ddc21e9d/src/cc/usdt/usdt_args.cc#L228-L231, bcc on `aarch64` claims to support parsing `8@[x0]` via `[-]<size>@[<reg>]`.\n\n```c\n  // Support the following argument patterns:\n  //   [-]<size>@<value>, [-]<size>@<reg>, [-]<size>@[<reg>], or\n  //   [-]<size>@[<reg>,<offset>]\n  //   [-]<size>@[<reg>,<index_reg>]\n```",
          "created_at": "2025-09-03T13:15:30Z"
        }
      ]
    },
    {
      "number": 33245,
      "title": "integer sanitizer warning, when running with -natpmp=1 enabled",
      "body": "I haven't looked here if this is a bug, but it would be good to either suppress this warning (if it is harmless) or change the code (if there is a bug).\r\n\r\nTo reproduce, compile with `clang` and enable the `integer` sanitizer.\r\n\r\nThen, disable ipv6:\r\n\r\n```\r\n# sysctl -w net.ipv6.conf.all.disable_ipv6=1\r\nnet.ipv6.conf.all.disable_ipv6 = 1\r\n```\r\n\r\nThen, run `bitcoind`:\r\n\r\n`# UBSAN_OPTIONS=\"suppressions=$(pwd)/test/sanitizer_suppressions/ubsan:print_stacktrace=1:halt_on_error=1:report_error_type=1\" ./bld-cmake/bin/bitcoind -regtest -noprinttoconsole=1 -natpmp=1`\r\n\r\nIt should fail with:\r\n\r\n```\r\n/root/b-c/src/common/netif.cpp:127:29: runtime error: unsigned integer overflow: 20 - 28 cannot be represented in type 'unsigned long'\r\n    #0 0x5f8c692ea4b7 in (anonymous namespace)::QueryDefaultGatewayImpl(unsigned short) /root/b-c/bld-cmake/src/./common/netif.cpp:127:29\r\n    #1 0x5f8c692ea4b7 in QueryDefaultGateway(Network) /root/b-c/bld-cmake/src/./common/netif.cpp:276:35\r\n    #2 0x5f8c68c1b32a in ProcessPCP() /root/b-c/bld-cmake/src/./mapport.cpp:87:44\r\n    #3 0x5f8c68c1b32a in ThreadMapPort() /root/b-c/bld-cmake/src/./mapport.cpp:125:9\r\n    #4 0x5f8c6957772d in std::function<void ()>::operator()() const /usr/bin/../lib/gcc/x86_64-linux-gnu/13/../../../../include/c++/13/bits/std_function.h:591:9\r\n    #5 0x5f8c6957772d in util::TraceThread(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>) /root/b-c/bld-cmake/src/util/./util/thread.cpp:21:9\r\n    #6 0x5f8c68c1cd4d in void std::__invoke_impl<void, void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, void (*)()>(std::__invoke_other, void (*&&)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*&&, void (*&&)()) /usr/bin/../lib/gcc/x86_64-linux-gnu/13/../../../../include/c++/13/bits/invoke.h:61:14\r\n    #7 0x74eec02ecdb3  (/lib/x86_64-linux-gnu/libstdc++.so.6+0xecdb3) (BuildId: ca77dae775ec87540acd7218fa990c40d1c94ab1)\r\n    #8 0x74eebfe9caa3  (/lib/x86_64-linux-gnu/libc.so.6+0x9caa3) (BuildId: 282c2c16e7b6600b0b22ea0c99010d2795752b5f)\r\n    #9 0x74eebff29c3b  (/lib/x86_64-linux-gnu/libc.so.6+0x129c3b) (BuildId: 282c2c16e7b6600b0b22ea0c99010d2795752b5f)\r\n\r\nSUMMARY: UndefinedBehaviorSanitizer: unsigned-integer-overflow /root/b-c/src/common/netif.cpp:127:29 \r\n```\r\n \r\n\r\n_Originally posted by @maflcko in https://github.com/bitcoin/bitcoin/pull/32345#discussion_r2294197834_\r\n            ",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-08-23T09:51:51Z",
      "updated_at": "2025-09-04T10:13:38Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/33245",
      "labels": [
        "P2P",
        "CI failed"
      ],
      "comment_list": [
        {
          "user": "Sjors",
          "body": "cc @laanwj ",
          "created_at": "2025-08-25T08:46:24Z"
        },
        {
          "user": "achow101",
          "body": "It looks like this is being triggered by a `NLMSG_DONE` message and is something that we could avoid by checking `hdr->nlmsg_type` before doing `NLMSG_DATA` and `RTM_PAYLOAD`. This could be included in #32159 since that's already touching this code.",
          "created_at": "2025-08-26T21:46:12Z"
        }
      ]
    },
    {
      "number": 33244,
      "title": "intermittent timeout in mptest unit test",
      "body": "> Task `ARM, unit tests, no functional tests`: https://github.com/bitcoin/bitcoin/runs/48709103843\r\n> LLM reason (‚ú® experimental): The CI failure is caused by a test timeout during the execution of the 'mptest' test.\r\n\r\nthis failure looks real? The unit test should normally pass in a few milliseconds, so taking 40 minutes seems odd?\r\n\r\nhttps://cirrus-ci.com/task/5714850606743552?logs=ci#L2822: `[23:07:33.279]   3/148 Test   #3: mptest ...............................   Passed    0.03 sec`\r\nhttps://cirrus-ci.com/task/4911861373599744?logs=ci#L3101: `[22:41:29.095] 148/148 Test   #3: mptest ...............................***Timeout 2400.10 sec`\r\n\r\n_Originally posted by @maflcko in https://github.com/bitcoin/bitcoin/issues/33241#issuecomment-3216370455_\r\n\r\n\r\n            ",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-08-23T09:48:19Z",
      "updated_at": "2025-09-19T09:54:43Z",
      "comments": 10,
      "url": "https://github.com/bitcoin/bitcoin/issues/33244",
      "labels": [
        "CI failed"
      ],
      "comment_list": [
        {
          "user": "ryanofsky",
          "body": "As noted https://github.com/bitcoin/bitcoin/pull/33241#issuecomment-3216999952, I'm pretty sure this is caused by https://github.com/bitcoin-core/libmultiprocess/issues/189. It's possible to reproduce the issue locally by just running mptest in a loop thousands of times until it locks up.\n\nhttps://github.com/bitcoin-core/libmultiprocess/issues/189 happens because the new \"disconnecting and blocking\" test introduced in https://github.com/bitcoin-core/libmultiprocess/issues/160 tests for for problems with unclean disconnections that weren't previously detected. The most common issues with unclean disconnections were fixed in https://github.com/bitcoin-core/libmultiprocess/issues/160. But two more issues with unclean disconnections that happened reliably in CI were fixed https://github.com/bitcoin-core/libmultiprocess/pull/186, and one more unclean disconnect issue that happens more rarely and isn't fixed yet is described in https://github.com/bitcoin-core/libmultiprocess/issues/189. The issue is debugged and I think should not be hard to fix but I wanted to hold off because the previous fixes had a bunch of manual testing and seemed to work well in practice while this issue was more artificial, happening as a result of the way the test was written.",
          "created_at": "2025-08-23T18:09:51Z"
        },
        {
          "user": "Sjors",
          "body": "Now that the subtree was updated with #33241 and most cases are fixed, do we still want to fix the more rare https://github.com/bitcoin-core/libmultiprocess/issues/189 for the v30 milestone?",
          "created_at": "2025-09-01T08:08:57Z"
        },
        {
          "user": "maflcko",
          "body": "ctest doesn't have a default timeout, so it would be a bit odd to expose users to a unit test run that never finishes, albeit rarely?\n\n> this issue was more artificial, happening as a result of the way the test was written.\n\n\nThis feature is experimental anyway, so maybe the unit test could be rewritten or removed temporarily for the 30.x release branch, if fixing it is too invasive for now?",
          "created_at": "2025-09-01T08:15:57Z"
        },
        {
          "user": "Sjors",
          "body": "Or we could add a timeout for this specific test. I don't think we should remove it, because we want to catch unknown issues on platforms / circumstances that our CI doesn't cover.",
          "created_at": "2025-09-01T08:18:33Z"
        },
        {
          "user": "maflcko",
          "body": "> add a timeout\n\nSure, but I'd say the timeout should be added in the C++ code, not in ctest, possibly with an error message explaining the known issue.",
          "created_at": "2025-09-01T08:36:37Z"
        },
        {
          "user": "ismaelsadeeq",
          "body": "https://cirrus-ci.com/task/6512217929023488?logs=ci#L3103",
          "created_at": "2025-09-01T18:41:56Z"
        },
        {
          "user": "maflcko",
          "body": "At the same time, it seems to happen frequently in CI, so I prefer my initial suggestion to either rewrite the failing unit test or remove it temporarily.",
          "created_at": "2025-09-02T06:34:40Z"
        },
        {
          "user": "ryanofsky",
          "body": "re: https://github.com/bitcoin/bitcoin/issues/33244#issuecomment-3243976122\n\n> At the same time, it seems to happen frequently in CI, so I prefer my initial suggestion to either rewrite the failing unit test or remove it temporarily.\n\nSorry, I've been very distracted the past two weeks but I should be able to post a fix for this today.\n\nIt'd also be completely reasonable to disable the test, though I'm sure what a good way to disable it is because it's in a subtree.",
          "created_at": "2025-09-02T10:58:33Z"
        },
        {
          "user": "ryanofsky",
          "body": "I think https://github.com/bitcoin-core/libmultiprocess/pull/201 should fix this. I haven't tested it very much yet, but the bug hasn't happened running mptest in a loop for about an hour. ",
          "created_at": "2025-09-02T20:24:19Z"
        },
        {
          "user": "fanquake",
          "body": "Closing this, given #33412.",
          "created_at": "2025-09-19T09:54:43Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 3,
    "issues": 3
  }
}