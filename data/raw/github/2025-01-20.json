{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T19:10:43.338917+00:00",
  "date": "2025-01-20",
  "pull_requests": [
    {
      "number": 31693,
      "title": "bench: fix used file that is not opened",
      "body": "Fixes\r\n```\r\nsrc/bench/load_external.cpp:57:17: error: Used file that is not opened. [useClosedFile]\r\n            if (fwrite(ss.data(), 1, ss.size(), file) != ss.size()) {\r\n                ^\r\nsrc/bench/load_external.cpp:61:9: error: Used file that is not opened. [useClosedFile]\r\n        fclose(file);\r\n        ^\r\n```",
      "state": "closed",
      "user": "rex4539",
      "created_at": "2025-01-20T19:18:40Z",
      "updated_at": "2025-01-21T09:11:01Z",
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/pull/31693",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31693.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
          "created_at": "2025-01-20T19:18:42Z"
        },
        {
          "user": "rex4539",
          "body": "> What are the exact steps to reproduce or test this problem and fix?\r\n\r\n`cppcheck src/bench/load_external.cpp`",
          "created_at": "2025-01-21T08:16:08Z"
        },
        {
          "user": "maflcko",
          "body": "> > What are the exact steps to reproduce or test this problem and fix?\r\n> \r\n> `cppcheck src/bench/load_external.cpp`\r\n\r\ncppcheck is a static code analysis tool. A finding does not imply a bug and removing a finding does not imply a fix.\r\n\r\nWith \"reproduce\" I meant how a real user/developer can run into this problem.\r\n\r\nUsing static analysers to find (and fix) bugs will overall result in more bugs (Source: https://www.sqlite.org/testing.html#static_analysis). Looking at the diff in this pull confirms this sqlite finding.",
          "created_at": "2025-01-21T08:32:40Z"
        },
        {
          "user": "rex4539",
          "body": "Hey, if everyone feels this PR is not helpful, feel free to close. No hard feelings :)",
          "created_at": "2025-01-21T08:47:47Z"
        },
        {
          "user": "maflcko",
          "body": "The burden to motivate a change and explain the change is on the pull request author.\r\n\r\nIf you genuinely think there is benefit in this change and a real user/developer can run into this problem, it would be good  to explain it and put it into context. Also, the pull request author should answer any outstanding review questions.",
          "created_at": "2025-01-21T08:59:24Z"
        },
        {
          "user": "rex4539",
          "body": "This PR doesn't have any seriousness. I had some free time and ran `cppcheck` for fun. I tested a fix proposal that I'm not sure if it's even correct. It appears to fix the issue and not introduce any new bugs (by my testing and CI). I definitely cannot motivate or convince anyone about it. It was made purely for fun.",
          "created_at": "2025-01-21T09:09:51Z"
        }
      ]
    },
    {
      "number": 31691,
      "title": "util: fix compiler warning about deprecated space before _MiB",
      "body": "```\r\nsrc/util/byte_units.h:13:29: error: identifier '_MiB' preceded by whitespace in a literal operator declaration is deprecated [-Werror,-Wdeprecated-literal-operator]\r\n   13 | constexpr size_t operator\"\" _MiB(unsigned long long mebibytes)\r\n      |                  ~~~~~~~~~~~^~~~\r\n      |                  operator\"\"_MiB\r\n1 error generated.\r\n```\r\n\r\nClang 20.0.0",
      "state": "closed",
      "user": "vasild",
      "created_at": "2025-01-20T13:50:03Z",
      "updated_at": "2025-01-20T15:58:59Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/31691",
      "labels": [
        "Utils/log/libs"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31691.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/31691#pullrequestreview-2562454081), [maflcko](https://github.com/bitcoin/bitcoin/pull/31691#issuecomment-2602517116) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n",
          "created_at": "2025-01-20T13:50:06Z"
        },
        {
          "user": "maflcko",
          "body": "lgtm ACK d3339a7cd5f10e8a6b2a6c64daa66cd71a3e81d3\r\n\r\nThere should be an rc1 in two weeks, so the CI could be bumped to that to avoid issues in the future: https://llvm.org/docs/HowToReleaseLLVM.html#annual-release-schedule",
          "created_at": "2025-01-20T14:06:47Z"
        },
        {
          "user": "hebasto",
          "body": "> There should be an rc1 in two weeks, so the CI could be bumped to that to avoid issues in the future: https://llvm.org/docs/HowToReleaseLLVM.html#annual-release-schedule\r\n\r\nIn the meantime, I've added a [nightly build](https://github.com/hebasto/bitcoin-core-nightly/pull/34) that uses the [LLVM Ubuntu nightly packages](https://apt.llvm.org/).",
          "created_at": "2025-01-20T15:58:58Z"
        }
      ]
    },
    {
      "number": 31690,
      "title": "doc: Amend notes on benchmarking",
      "body": "This gives some more context on the motivation and larger picture of benchmarks.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-01-20T11:46:45Z",
      "updated_at": "2025-01-22T16:48:46Z",
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/pull/31690",
      "labels": [
        "Docs"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31690.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [darosior](https://github.com/bitcoin/bitcoin/pull/31690#pullrequestreview-2567642292), [l0rinc](https://github.com/bitcoin/bitcoin/pull/31690#issuecomment-2607709617), [brunoerg](https://github.com/bitcoin/bitcoin/pull/31690#pullrequestreview-2567719412), [instagibbs](https://github.com/bitcoin/bitcoin/pull/31690#issuecomment-2607720719) |\n| Concept ACK | [tdb3](https://github.com/bitcoin/bitcoin/pull/31690#pullrequestreview-2563208382) |\n| Stale ACK | [furszy](https://github.com/bitcoin/bitcoin/pull/31690#pullrequestreview-2562545874), [kevkevinpal](https://github.com/bitcoin/bitcoin/pull/31690#issuecomment-2602619041) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n",
          "created_at": "2025-01-20T11:46:48Z"
        },
        {
          "user": "l0rinc",
          "body": "ACK 2db6923332c7daa20d250cc5aa6bde080a7d0caf",
          "created_at": "2025-01-20T13:32:37Z"
        },
        {
          "user": "kevkevinpal",
          "body": "ACK [2db6923](https://github.com/bitcoin/bitcoin/pull/31690/commits/2db6923332c7daa20d250cc5aa6bde080a7d0caf)\r\n\r\nIf it is wanted I can cherry pick the commits from https://github.com/bitcoin/bitcoin/pull/31153 and open up a PR to remove the various extraneous benchmarks",
          "created_at": "2025-01-20T14:49:52Z"
        },
        {
          "user": "maflcko",
          "body": "> If it is wanted I can cherry pick the commits from #31153 and open up a PR to remove the various extraneous benchmarks\r\n\r\nThe goal of this pull request is to add useful context. Removing benchmarks can be done on a case-by-case basis in a separate pull request, if properly motivated. However, it is not the goal of this pull request to serve as the sole reason to remove (or refuse to add) benchmarks.",
          "created_at": "2025-01-20T15:04:54Z"
        },
        {
          "user": "l0rinc",
          "body": "ACK e94c9d171239c1fc44fa9c77a4595ecd626b767f\r\n\r\nhttps://github.com/bitcoin/bitcoin/compare/2db6923..e94c9d171239c1fc44fa9c77a4595ecd626b767f?w=1",
          "created_at": "2025-01-22T16:30:07Z"
        },
        {
          "user": "instagibbs",
          "body": "reACK e94c9d171239c1fc44fa9c77a4595ecd626b767f",
          "created_at": "2025-01-22T16:34:41Z"
        }
      ]
    },
    {
      "number": 31689,
      "title": "Benchmark Chainstate::ConnectBlock duration",
      "body": "Introduce benchmarks to evaluate ConnectBlock performance for:\r\n- Blocks containing only Schnorr signatures\r\n- Blocks containing both Schnorr and ECDSA signatures\r\n- Blocks containing only ECDSA signatures\r\n\r\nThe benchmarks in this PR focus on signature validation. Additional benchmarks may be added in the future to assess other aspects of ConnectBlock.\r\n\r\nThis is the first step toward implementing Batch Verification of Schnorr Signatures in Core. It provides a way to test and measure the performance improvements of batch verification on Core.\r\nFor more details on batch validation, refer to the [batch-verify module on secp](https://github.com/bitcoin-core/secp256k1/pull/1134) and [batch-verify on core](https://github.com/bitcoin/bitcoin/pull/29491).",
      "state": "closed",
      "user": "Eunovo",
      "created_at": "2025-01-20T10:34:46Z",
      "updated_at": "2025-04-07T21:08:58Z",
      "comments": 26,
      "url": "https://github.com/bitcoin/bitcoin/pull/31689",
      "labels": []
    },
    {
      "number": 31688,
      "title": ".",
      "body": "```javascript\r\nâ€¦key=:pubKey&status=:channelStatus\r\n\r\nBitcoin Core integration/staging tree\r\n=====================================\r\n\r\nhttps://bitcoincore.org\r\n\r\nFor an immediately usable, binary version of the Bitcoin Core software, see https://bitcoincore.org/en/download/.\r\n\r\nWhat is Bitcoin Core?\r\n---------------------\r\n\r\nBitcoin Core connects to the Bitcoin peer-to-peer network to download and fully validate blocks and transactions. It also includes a wallet and graphical user interface, which can be optionally built.\r\n\r\nFurther information about Bitcoin Core is available in the [doc folder](/doc).\r\n\r\nLicense\r\n-------\r\n\r\nBitcoin Core is released under the terms of the MIT license. See [COPYING](COPYING) for more information or see https://opensource.org/licenses/MIT.\r\n\r\nDevelopment Process\r\n-------------------\r\n\r\nThe `master` branch is regularly built (see `doc/build-*.md` for instructions) and tested, but it is not guaranteed to be completely stable. [Tags](https://github.com/bitcoin/bitcoin/tags) are created regularly from release branches to indicate new official, stable release versions of Bitcoin Core.\r\n\r\nThe https://github.com/bitcoin-core/gui repository is used exclusively for the development of the GUI. Its master branch is identical in all monotree repositories. Release branches and tags do not exist, so please do not fork that repository unless it is for development reasons.\r\n\r\nThe contribution workflow is described in [CONTRIBUTING.md](CONTRIBUTING.md) and useful hints for developers can be found in [doc/developer-notes.md](doc/developer-notes.md).\r\n\r\nTesting\r\n-------\r\n\r\nTesting and code review is the bottleneck for development; we get more pull requests than we can review and test on short notice. Please be patient and help out by testing other people's pull requests, and remember this is a security-critical project where any mistake might cost people lots of money.\r\n\r\n### Automated Testing\r\n\r\nDevelopers are strongly encouraged to write [unit tests](src/test/README.md) for new code, and to submit new unit tests for old code. Unit tests can be compiled and run (assuming they weren't disabled during the generation of the build system) with: `ctest`. Further details on running and extending unit tests can be found in [/src/test/README.md](/src/test/README.md).\r\n\r\nThere are also [regression and integration tests](/test), written in Python.\r\nThese tests can be run (if the [test dependencies](/test) are installed) with: `build/test/functional/test_runner.py` (assuming `build` is your build directory).\r\n\r\nThe CI (Continuous Integration) systems make sure that every pull request is built for Windows, Linux, and macOS, and that unit/sanity tests are run automatically.\r\n\r\n### Manual Quality Assurance (QA) Testing\r\n\r\nChanges should be tested by somebody other than the developer who wrote the code. This is especially important for large or high-risk changes. It is useful to add a test plan to the pull request description if testing the changes is not straightforward.\r\n\r\nTranslations\r\n------------\r\n\r\nChanges to translations as well as new translations can be submitted to [Bitcoin Core's Transifex page](https://www.transifex.com/bitcoin/bitcoin/).\r\n\r\n[\r\n  {\r\n    \"status\": 1,\r\n    \"closing_reason\": null,\r\n    \"closing_date\": null,\r\n    \"capacity\": 200000000,\r\n    \"short_id\": \"855248x2989x1\",\r\n    \"id\": \"940355120828055553\",\r\n    \"fee_rate\": 1,\r\n    \"node\": {\r\n      \"alias\": \"yalls.org clearnet-yalls\",\r\n      \"public_key\": \"0288be11d147e1525f7f234f304b094d6627d2c70f3313d7ba3696887b261c4447\",\r\n      \"channels\": 93,\r\n      \"capacity\": \"6651565060\"\r\n    }\r\n  },\r\n  {\r\n    \"status\": 1,\r\n    \"closing_reason\": null,\r\n    \"closing_date\": null,\r\n    \"capacity\": 150000000,\r\n    \"short_id\": \"865606x2919x1\",\r\n    \"id\": \"951743862263971841\",\r\n    \"fee_rate\": 100,\r\n    \"node\": {\r\n      \"alias\": \"Megalithic.me\",\r\n      \"public_key\": \"0322d0e43b3d92d30ed187f4e101a9a9605c3ee5fc9721e6dac3ce3d7732fbb13e\",\r\n      \"channels\": 83,\r\n      \"capacity\": \"6584980682\"\r\n    }\r\n  },\r\n  {\r\n    \"status\": 1,\r\n    \"closing_reason\": null,\r\n    \"closing_date\": null,\r\n    \"capacity\": 150000000,\r\n    \"short_id\": \"867452x3629x1\",\r\n    \"id\": \"953773560775376897\",\r\n    \"fee_rate\": 2000,\r\n    \"node\": {\r\n      \"alias\": \"cyberdyne.sh\",\r\n      \"public_key\": \"03a93b87bf9f052b8e862d51ebbac4ce5e97b5f4137563cd5128548d7f5978dda9\",\r\n      \"channels\": 196,\r\n      \"capacity\": \"8511550562\"\r\n    }\r\n  },\r\n  {\r\n    \"status\": 1,\r\n    \"closing_reason\": null,\r\n    \"closing_date\": null,\r\n    \"capacity\": 115000000,\r\n    \"short_id\": \"827084x1086x1\",\r\n    \"id\": \"909388475218657281\",\r\n    \"fee_rate\": 1000,\r\n    \"node\": {\r\n      \"alias\": \"yalls.org yalls-tor\",\r\n      \"public_key\": \"03d06758583bb5154774a6eb221b1276c9e82d65bbaceca806d90e20c108f4b1c7\",\r\n      \"channels\": 74,\r\n      \"capacity\": \"3241046701\"\r\n    }\r\n  },\r\n  {\r\n    \"status\": 1,\r\n    \"closing_reason\": null,\r\n    \"closing_date\": null,\r\n    \"capacity\": 100000000,\r\n    \"short_id\": \"740620x2091x0\",\r\n    \"id\": \"814320301900496896\",\r\n    \"fee_rate\": 3000,\r\n    \"node\": {\r\n      \"alias\": \"okx\",\r\n      \"public_key\": \"0294ac3e099def03c12a37e30fe5364b1223fd60069869142ef96580c8439c2e0a\",\r\n      \"channels\": 612,\r\n      \"capacity\": \"73942283559\"\r\n    }\r\n  },\r\n  {\r\n    \"status\": 1,\r\n    \"closing_reason\": null,\r\n    \"closing_date\": null,\r\n    \"capacity\": 100000000,\r\n    \"short_id\": \"759240x2353x1\",\r\n    \"id\": \"834793208426856449\",\r\n    \"fee_rate\": 2500,\r\n    \"node\": {\r\n      \"alias\": \"nicehash-ln1\",\r\n      \"public_key\": \"037659a0ac8eb3b8d0a720114efc861d3a940382dcfa1403746b4f8f6b2e8810ba\",\r\n      \"channels\": 1055,\r\n      \"capacity\": \"16787969802\"\r\n    }\r\n  },\r\n  {\r\n    \"status\": 1,\r\n    \"closing_reason\": null,\r\n    \"closing_date\": null,\r\n    \"capacity\": 100000000,\r\n    \"short_id\": \"810358x1309x6\",\r\n    \"id\": \"890998043747090438\",\r\n    \"fee_rate\": 2000,\r\n    \"node\": {\r\n      \"alias\": \"LNBÏŸG [Edge-4]\",\r\n      \"public_key\": \"039edc94987c8f3adc28dab455efc00dea876089a120f573bd0b03c40d9d3fb1e1\",\r\n      \"channels\": 241,\r\n      \"capacity\": \"5095855252\"\r\n    }\r\n  },\r\n  {\r\n    \"status\": 1,\r\n    \"closing_reason\": null,\r\n    \"closing_date\": null,\r\n    \"capacity\": 100000000,\r\n    \"short_id\": \"822086x2856x1\",\r\n    \"id\": \"903893116219031553\",\r\n    \"fee_rate\": 3000,\r\n    \"node\": {\r\n      \"alias\": \"okx\",\r\n      \"public_key\": \"0294ac3e099def03c12a37e30fe5364b1223fd60069869142ef96580c8439c2e0a\",\r\n      \"channels\": 612,\r\n      \"capacity\": \"73942283559\"\r\n    }\r\n  },\r\n  {\r\n    \"status\": 1,\r\n    \"closing_reason\": null,\r\n    \"closing_date\": null,\r\n    \"capacity\": 100000000,\r\n    \"short_id\": \"822104x753x1\",\r\n    \"id\": \"903912907290509313\",\r\n    \"fee_rate\": 3000,\r\n    \"node\": {\r\n      \"alias\": \"okx\",\r\n      \"public_key\": \"0294ac3e099def03c12a37e30fe5364b1223fd60069869142ef96580c8439c2e0a\",\r\n      \"channels\": 612,\r\n      \"capacity\": \"73942283559\"\r\n    }\r\n  },\r\n  {\r\n    \"status\": 1,\r\n    \"closing_reason\": null,\r\n    \"closing_date\": null,\r\n    \"capacity\": 100000000,\r\n    \"short_id\": \"843151x2151x0\",\r\n    \"id\": \"927054328611930112\",\r\n    \"fee_rate\": 2000,\r\n    \"node\": {\r\n      \"alias\": \"Binance\",\r\n      \"public_key\": \"03a1f3afd646d77bdaf545cceaf079bab6057eae52c6319b63b5803d0989d6a72f\",\r\n      \"channels\": 211,\r\n      \"capacity\": \"67249400000\"\r\n    }\r\n  }\r\n]\r\n\r\n\r\nTranslations are periodically pulled from Transifex and merged into the git repository. See the [translation process](doc/translation_process.md) for details on how this works.\r\n\r\n**Important**: We do not accept translation changes as GitHub pull requests because the next pull from Transifex would automatically overwrite them again.\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n\r\n``` ",
      "state": "closed",
      "user": "Recepxx34",
      "created_at": "2025-01-20T07:46:36Z",
      "updated_at": "2025-01-20T08:42:44Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/pull/31688",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31688.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
          "created_at": "2025-01-20T07:46:39Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 31695,
      "title": "bitcoin ?",
      "body": "",
      "state": "closed",
      "user": "alexpkv",
      "created_at": "2025-01-20T23:49:51Z",
      "updated_at": "2025-01-20T23:50:54Z",
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/31695",
      "labels": []
    },
    {
      "number": 31694,
      "title": "Inconsistent hardened derivation marker in `listdescriptors` output",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nIf I use `importdescriptors` to import a descriptor that uses only `'` as the hardened derivation marker, the corresponding output of `listdescriptors` sometimes uses a mix of `'` and `h`.\n\n### Expected behaviour\n\nI would expect the output for a given imported descriptor to either match my input or otherwise use only one of `'` and `h`.\n\nI would also expect the behaviour to be consistent across different descriptors. \n\n### Steps to reproduce\n\n1. Create wallet:\n```\n$ bitcoin-cli -regtest createwallet test_h_vs_apostrophe true\n{\n  \"name\": \"test_h_vs_apostrophe\"\n}\n```\n2. Import `tr` descriptor:\n```\n$ bitcoin-cli -regtest -rpcwallet=test_h_vs_apostrophe importdescriptors \"[{\\\"desc\\\": \\\"tr([1dce71b2/48'/1'/0'/2']tpubDEeP3GefjqbaDTTaVAF5JkXWhoFxFDXQ9KuhVrMBViFXXNR2B3Lvme2d2AoyiKfzRFZChq2AGMNbU1qTbkBMfNv7WGVXLt2pnYXY87gXqcs/0/*,and_v(v:pk([1dce71b2/48'/1'/0'/2']tpubDEeP3GefjqbaDTTaVAF5JkXWhoFxFDXQ9KuhVrMBViFXXNR2B3Lvme2d2AoyiKfzRFZChq2AGMNbU1qTbkBMfNv7WGVXLt2pnYXY87gXqcs/2/*),older(65535)))#xhrh0cvn\\\", \\\"timestamp\\\": \\\"now\\\"}]\"\n[\n  {\n    \"success\": true,\n    \"warnings\": [\n      \"Range not given, using default keypool range\"\n    ]\n  }\n]\n```\n3. Import `wsh` descriptor:\n```\n$ bitcoin-cli -regtest -rpcwallet=test_h_vs_apostrophe importdescriptors \"[{\\\"desc\\\": \\\"wsh(or_d(pk([a233d117/48'/1'/0'/2']tpubDF8d1Q2U8WWfxUHMiqqrYiavBReX2r7hwD7oQsEuq1AiXj5nJcLBkoh1uTLZVx66VrbRfeHyg5bSFvRKzesa1yzYuXDvawZeRi9m97a2Qzd/0/*),and_v(v:pkh([a233d117/48'/1'/0'/2']tpubDF8d1Q2U8WWfxUHMiqqrYiavBReX2r7hwD7oQsEuq1AiXj5nJcLBkoh1uTLZVx66VrbRfeHyg5bSFvRKzesa1yzYuXDvawZeRi9m97a2Qzd/2/*),older(65535))))#segwrd5h\\\", \\\"timestamp\\\": \\\"now\\\"}]\"\n[\n  {\n    \"success\": true,\n    \"warnings\": [\n      \"Range not given, using default keypool range\"\n    ]\n  }\n]\n```\nWhen calling `listdescriptors`, the `tr` descriptor uses a mix of `h` and `'` (and checksum has changed), while `wsh` uses only `'` (and has same checksum):\n```\n$ bitcoin-cli -regtest -rpcwallet=test_h_vs_apostrophe listdescriptors\n{\n  \"wallet_name\": \"test_h_vs_apostrophe\",\n  \"descriptors\": [\n    {\n      \"desc\": \"tr([1dce71b2/48h/1h/0h/2h]tpubDEeP3GefjqbaDTTaVAF5JkXWhoFxFDXQ9KuhVrMBViFXXNR2B3Lvme2d2AoyiKfzRFZChq2AGMNbU1qTbkBMfNv7WGVXLt2pnYXY87gXqcs/0/*,and_v(v:pk([1dce71b2/48'/1'/0'/2']tpubDEeP3GefjqbaDTTaVAF5JkXWhoFxFDXQ9KuhVrMBViFXXNR2B3Lvme2d2AoyiKfzRFZChq2AGMNbU1qTbkBMfNv7WGVXLt2pnYXY87gXqcs/2/*),older(65535)))#2h7g2wme\",\n      \"timestamp\": 1296688602,\n      \"active\": false,\n      \"range\": [\n        0,\n        999\n      ],\n      \"next\": 0,\n      \"next_index\": 0\n    },\n    {\n      \"desc\": \"wsh(or_d(pk([a233d117/48'/1'/0'/2']tpubDF8d1Q2U8WWfxUHMiqqrYiavBReX2r7hwD7oQsEuq1AiXj5nJcLBkoh1uTLZVx66VrbRfeHyg5bSFvRKzesa1yzYuXDvawZeRi9m97a2Qzd/0/*),and_v(v:pkh([a233d117/48'/1'/0'/2']tpubDF8d1Q2U8WWfxUHMiqqrYiavBReX2r7hwD7oQsEuq1AiXj5nJcLBkoh1uTLZVx66VrbRfeHyg5bSFvRKzesa1yzYuXDvawZeRi9m97a2Qzd/2/*),older(65535))))#segwrd5h\",\n      \"timestamp\": 1296688602,\n      \"active\": false,\n      \"range\": [\n        0,\n        999\n      ],\n      \"next\": 0,\n      \"next_index\": 0\n    }\n  ]\n}\n```\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nPre-built binaries\n\n### What version of Bitcoin Core are you using?\n\nv28.0.0\n\n### Operating system and version\n\nUbuntu 24.04\n\n### Machine specifications\n\n_No response_",
      "state": "closed",
      "user": "jp1ac4",
      "created_at": "2025-01-20T21:05:28Z",
      "updated_at": "2025-11-18T22:32:13Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/31694",
      "labels": [
        "Descriptors"
      ],
      "comment_list": [
        {
          "user": "brunoerg",
          "body": "> If I use importdescriptors to import a descriptor that uses only ' as the hardened derivation marker, the corresponding output of listdescriptors sometimes uses a mix of ' and h.\n\nI think this is due to `ToNormalizedString` called by `GetDescriptorString` from`listdescriptors`:\n```cpp\nbool ToNormalizedString(const SigningProvider& arg, std::string& ret, const DescriptorCache* cache) const override\n{\n    std::string sub;\n    if (!m_provider->ToNormalizedString(arg, sub, cache)) return false;\n    // If m_provider is a BIP32PubkeyProvider, we may get a string formatted like a OriginPubkeyProvider\n    // In that case, we need to strip out the leading square bracket and fingerprint from the substring,\n    // and append that to our own origin string.\n    if (sub[0] == '[') {\n        sub = sub.substr(9);\n        ret = \"[\" + OriginString(StringType::PUBLIC, /*normalized=*/true) + std::move(sub);\n    } else {\n        ret = \"[\" + OriginString(StringType::PUBLIC, /*normalized=*/true) + \"]\" + std::move(sub);\n    }\n    return true;\n}\n```",
          "created_at": "2025-01-21T13:56:51Z"
        },
        {
          "user": "pythcoiner",
          "body": "it looks I got a [fix](https://github.com/bitcoin/bitcoin/commit/95220e5aac4839ba0dbdcca070ed34c6226de217), will write tests & PR",
          "created_at": "2025-01-24T06:42:30Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 5,
    "issues": 2
  }
}