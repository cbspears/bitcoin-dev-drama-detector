{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T19:29:37.136382+00:00",
  "date": "2025-04-01",
  "pull_requests": [
    {
      "number": 32194,
      "title": "ci, windows: Do not exclude `wallet_migration.py` in command line",
      "body": "This PR amends the recently merged https://github.com/bitcoin/bitcoin/pull/31176 to resolve a silent merge conflict with the previously merged https://github.com/bitcoin/bitcoin/pull/31248.\r\n\r\nSince https://github.com/bitcoin/bitcoin/pull/31248, it is no longer necessary to use `--exclude wallet_migration.py`, as the test is skipped due to not using previous releases.\r\n\r\nThe `wallet_migration.py` test itself still needs to be fixed for Windows by someone who will work on https://github.com/bitcoin/bitcoin/issues/32192.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-04-01T21:44:18Z",
      "updated_at": "2025-04-02T08:05:14Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/pull/32194",
      "labels": [
        "Windows",
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32194.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [davidgumberg](https://github.com/bitcoin/bitcoin/pull/32194#issuecomment-2770819086) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n",
          "created_at": "2025-04-01T21:44:21Z"
        },
        {
          "user": "davidgumberg",
          "body": "crACK https://github.com/bitcoin/bitcoin/pull/32194/commits/4a679936bbba750969e6260533c4cd5d45225015\r\n\r\n",
          "created_at": "2025-04-01T22:23:27Z"
        }
      ]
    },
    {
      "number": 32193,
      "title": "test: fix spelling in Python code comment",
      "body": "Fixed a couple of typos\r\n",
      "state": "closed",
      "user": "jbampton",
      "created_at": "2025-04-01T21:25:26Z",
      "updated_at": "2025-04-02T01:53:01Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/pull/32193",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32193.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
          "created_at": "2025-04-01T21:25:28Z"
        }
      ]
    },
    {
      "number": 32191,
      "title": "Make TxGraph fuzz tests more deterministic",
      "body": "Part of cluster mempool: #30289 \r\n\r\nThe implicit transaction ordering for transactions in a TxGraphImpl is defined by:\r\n1. higher chunk feerate first\r\n2. lower Cluster* object pointer first\r\n3. lower position within cluster linearization first.\r\n\r\nNumber (2) is not deterministic, as it intricately depends on the heap allocation algorithm. Fix this by giving each Cluster a unique `uint64_t m_sequence` value, and sorting by those instead.\r\n\r\nThe second commit then uses this new approach to optimize GroupClusters a bit more, avoiding some repeated checks and dereferences, by making a local copy of the involved sequence numbers.\r\n\r\nThanks to @dergoegge for pointing this out.",
      "state": "closed",
      "user": "sipa",
      "created_at": "2025-04-01T20:36:52Z",
      "updated_at": "2025-04-19T18:56:18Z",
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/pull/32191",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32191.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [instagibbs](https://github.com/bitcoin/bitcoin/pull/32191#issuecomment-2802436356), [marcofleon](https://github.com/bitcoin/bitcoin/pull/32191#pullrequestreview-2768741453), [glozow](https://github.com/bitcoin/bitcoin/pull/32191#pullrequestreview-2776524353) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32263](https://github.com/bitcoin/bitcoin/pull/32263) (cluster mempool: add TxGraph work controls by sipa)\n* [#31553](https://github.com/bitcoin/bitcoin/pull/31553) (cluster mempool: add TxGraph reorg functionality by sipa)\n* [#31444](https://github.com/bitcoin/bitcoin/pull/31444) (cluster mempool: add txgraph diagrams/mining/eviction by sipa)\n* [#28676](https://github.com/bitcoin/bitcoin/pull/28676) ([WIP] Cluster mempool implementation by sdaftuar)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
          "created_at": "2025-04-01T20:36:56Z"
        },
        {
          "user": "maflcko",
          "body": "Not sure if you just want to make it more determinisic, or fully deterministic, but I ran:\r\n\r\n```\r\ngit rebase bitcoin-core/master\r\nrm -rf ./bld-cmake && cmake -B ./bld-cmake  -DCMAKE_C_COMPILER='clang' -DCMAKE_CXX_COMPILER='clang++;-stdlib=libc++' -DBUILD_FOR_FUZZING=ON    -DCMAKE_CXX_FLAGS='-fprofile-instr-generate -fcoverage-mapping'                && cmake --build ./bld-cmake\r\ncargo run --manifest-path ./contrib/devtools/deterministic-fuzz-coverage/Cargo.toml -- $PWD/bld-cmake/ $PWD/../b-c-qa-assets/fuzz_corpora/ txgraph  32\r\n```\r\n\r\nI only ran it on a subset of the files `txgraph/00*` for a few times, and it printed: `The coverage was not deterministic between runs.`\r\n\r\nThe output had too little context, so I re-created it with more context:\r\n\r\n```diff\r\n$ git diff -U9 --no-index  -- bld-cmake/fuzz_det_cov.show.t0.*.txt\r\ndiff --git a/bld-cmake/fuzz_det_cov.show.t0.a.txt b/bld-cmake/fuzz_det_cov.show.t0.b.txt\r\nindex 0f4fcc3a1d..d5e901bd30 100644\r\n--- a/bld-cmake/fuzz_det_cov.show.t0.a.txt\r\n+++ b/bld-cmake/fuzz_det_cov.show.t0.b.txt\r\n@@ -265929,20 +265929,20 @@\r\n   ------------------\r\n   330|     19|            return (a != nullptr) <=> (b != nullptr);\r\n   331|     19|        }\r\n   332|       |        // If neither pointer is nullptr, compare the Clusters' sequence numbers.\r\n   333|  2.37k|        Assume(a == b || a->m_sequence != b->m_sequence);\r\n   ------------------\r\n   |  |   97|  3.55k|#define Assume(val) inline_assertion_check<false>(val, __FILE__, __LINE__, __func__, #val)\r\n   |  |                                  ^2.37k                             ^2.37k    ^2.37k              ^2.37k\r\n   |  |  ------------------\r\n-  |  |  |  Branch (97:51): [True: 1.19k, False: 1.17k]\r\n-  |  |  |  Branch (97:51): [True: 1.17k, False: 0]\r\n+  |  |  |  Branch (97:51): [True: 1.19k, False: 1.18k]\r\n+  |  |  |  Branch (97:51): [True: 1.18k, False: 0]\r\n   |  |  ------------------\r\n   ------------------\r\n   334|  2.37k|        return a->m_sequence <=> b->m_sequence;\r\n   335|  2.39k|    }\r\n   336|       |\r\n   337|       |public:\r\n   338|       |    /** Construct a new TxGraphImpl with the specified maximum cluster count. */\r\n   339|       |    explicit TxGraphImpl(DepGraphIndex max_cluster_count) noexcept :\r\n   340|      7|        m_max_cluster_count(max_cluster_count)\r\n@@ -266889,23 +266889,23 @@\r\n   974|     32|                auto cluster = FindCluster(index, level);\r\n   975|     32|                if (cluster != nullptr) PullIn(cluster);\r\n                                                       ^30\r\n   ------------------\r\n   |  Branch (975:21): [True: 30, False: 2]\r\n   ------------------\r\n   976|     32|            }\r\n   977|      5|        }\r\n   978|       |        // Group the set of to-be-removed entries by Cluster::m_sequence.\r\n-  979|     93|        std::sort(to_remove.begin(), to_remove.end(), [&](GraphIndex a, GraphIndex b) noexcept {\r\n-  980|     93|            Cluster* cluster_a = m_entries[a].m_locator[level].cluster;\r\n-  981|     93|            Cluster* cluster_b = m_entries[b].m_locator[level].cluster;\r\n-  982|     93|            return CompareClusters(cluster_a, cluster_b) < 0;\r\n-  983|     93|        });\r\n+  979|     94|        std::sort(to_remove.begin(), to_remove.end(), [&](GraphIndex a, GraphIndex b) noexcept {\r\n+  980|     94|            Cluster* cluster_a = m_entries[a].m_locator[level].cluster;\r\n+  981|     94|            Cluster* cluster_b = m_entries[b].m_locator[level].cluster;\r\n+  982|     94|            return CompareClusters(cluster_a, cluster_b) < 0;\r\n+  983|     94|        });\r\n   984|       |        // Process per Cluster.\r\n   985|     28|        std::span to_remove_span{to_remove};\r\n   986|     78|        while (!to_remove_span.empty()) {\r\n   ------------------\r\n```\r\n\r\nThis only shows the symptom. That is, `a == b` does not hold for the same amount of times, even when running over the same set of files. Not sure why that is, though.\r\n\r\nFor reference, the two inputs I ran against:\r\n\r\n```\r\nsh-5.2$ base64 ./txgraph/00dc359d7b7edffe613622aa7f592960eb4db15d\r\n//9/f///f6wAZIw7AAap5QBkiDsABqnlAAaqq5UABqvTAAauQgAGrJsABq085AatAAAAAAASBrkn\r\nAAa6NgAAAAAAAAatPOQGrdcABq5ZAAaYAAcwVQAHOf4AB+Q6AAc7BqybAAatPOQGrdcABq5ZAAaY\r\nAAcwVQAHOf4AB+Q6AAc7Pwa2JgAGtsAABrd8AAbRagAAAAAAAAAAEga5JwAGujYABgBSAH84lgAH\r\nOUjXBzn+BqqrlQAGq9MABq5CAAasmwAGrQAHOuQABzs/AAc7hQAHCidF9P85lgAHOVUABzn+AAc6\r\n5AAHOz8ABzvlAAaKq1oABgrTAAauQgAGrJsABgCtAGUA1wAGrlkABpgAAAAAAACpAAAAAAAAAAAA\r\nAAAAAAAAAAAAAP////8AAABrAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+oAAAAAAAAAAAAAAAAAAAAA\r\n/+oAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC0xwAGtXMABrYmAga2AAAAAAAA+///////1ato\r\ncgAAAAAAAAAAAAAAAAAAYBEAAAdg3/////8sAP//\r\n\r\nsh-5.2$ base64 ./txgraph/0002cb30d28317066ed82c933c477212d1680c53\r\n//9/f///f6wAZIw7AAap5QBkiDsABqnlAAaqq5UABqvTAAauQgAGrJsABq085AatAAAAAAASBrkn\r\nAAa6NgAGAFIAfzjx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx\r\n8fE7AAap5QAGqquVAAar0wAGrkoABqybAAYAAAAAAAAAAPHx8fHx8fHx8QAAAAAAAAAAAAAAAAAW\r\nAAAADgAAABUAAAASAAAAEwAAACMAAAAcAAAAJgAAADIRAAAAHVXPRlXPRkZVVc/PRlXPRs/PRlVG\r\nWs/PBgAAAAUAAAACAAAAAAAAAAAAABgKAAAAAAAAABAAAAAMAAAACAAAAA8AAAAEAAAADQAAACEA\r\nAAAAAAAAAQAAAAkAAAALAAAABwoHRQQANJYABzlVAAaqq5UABqvTAAauQgAGrJsABq085Aat1wAG\r\nrlkABpgAnTBVAAc5/gAHOuQABzs/BrYmAAa2wAAGt3wABtFqAAAHAAAAAAASBrknAAa6NgAGAFIA\r\nfziWAAc5SNcHOf4ABzrkAAc7PwAHO4UABwonRfT/OJYABzlVAAc5/gAHOuQABzs/AAc75QAGqqta\r\nAAar0wAGrkIABqybAAYAAABlrdcABgCumAZZAAAAAAAAqQAAAAAAAAAAAAAAAAAAAAAAAAD/////\r\nAAAAawAAAAAAAAAAAAAAAAAAAAAAAAAAAP/qAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAtMcA\r\nBrVzAAa2JgIGtgAAAAAAAAAAAAAAACpUaHIAQAAAAAAAAAAAAC4AAAA/AAAAJwAAABEAAAAJAAAA\r\nAAAAADwAAAAIAAAAFQAAADkAAAATAAAAEAAAADYAAAACAAAAHQAAADAAAAAAAAAAAABdKQAHXnkA\r\nB18AAABKAAdgEQAAB2Df/////ywA//8=\r\n",
          "created_at": "2025-04-11T13:30:45Z"
        },
        {
          "user": "sipa",
          "body": "@maflcko Huh, interesting, will investigate. `TxGraphImpl` does hold a default-constructed `FastRandomContext`, but those should within the fuzz tests be seeded deterministically now, right?",
          "created_at": "2025-04-11T13:41:35Z"
        },
        {
          "user": "maflcko",
          "body": "Yes, as long as the random context is not global, it should be fine.",
          "created_at": "2025-04-11T13:49:06Z"
        },
        {
          "user": "sipa",
          "body": "@maflcko Fixed, I think! There was another pointer comparison in the fuzz test itself.\r\n\r\n```diff\r\n+++ b/src/test/fuzz/txgraph.cpp\r\n@@ -206,11 +206,14 @@ struct SimTxGraph\r\n                 ret.push_back(ptr);\r\n             }\r\n         }\r\n-        // Deduplicate.\r\n-        std::sort(ret.begin(), ret.end());\r\n-        ret.erase(std::unique(ret.begin(), ret.end()), ret.end());\r\n-        // Replace input.\r\n-        arg = std::move(ret);\r\n+        // Construct deduplicated version in input (do not use std::sort/std::unique for\r\n+        // deduplication as it'd rely on non-deterministic pointer comparison).\r\n+        arg.clear();\r\n+        for (auto ptr : ret) {\r\n+            if (std::find(arg.begin(), arg.end(), ptr) == arg.end()) {\r\n+                arg.push_back(ptr);\r\n+            }\r\n+        }\r\n     }\r\n };\r\n```\r\n",
          "created_at": "2025-04-11T14:44:41Z"
        },
        {
          "user": "maflcko",
          "body": "Nice. `cargo run --manifest-path ./contrib/devtools/deterministic-fuzz-coverage/Cargo.toml -- $PWD/bld-cmake/ $PWD/../b-c-qa-assets/fuzz_corpora/ txgraph  32` from above looks stable now for me.",
          "created_at": "2025-04-11T16:48:28Z"
        },
        {
          "user": "sipa",
          "body": "@maflcko Great, nice tool. I tried it as well with a hastily-constructed txgraph corpus (after `-set_cover_merge=1`'ing it from 30000 to 700 files), and found no issues.",
          "created_at": "2025-04-11T16:50:31Z"
        },
        {
          "user": "instagibbs",
          "body": "reACK 2835216ec09cc2d86b091824376b15601e7c7b8a\r\n\r\ngood catch, didn't check the fuzzer harness for sorts like I did TxGraph itself...\r\n\r\n`git range-diff master 133813c503f2894c36442ec5a34c466d95961f45 2835216ec09cc2d86b091824376b15601e7c7b8a`",
          "created_at": "2025-04-14T17:44:58Z"
        },
        {
          "user": "venpisey",
          "body": "5167170015919920",
          "created_at": "2025-04-19T18:55:27Z"
        }
      ]
    },
    {
      "number": 32190,
      "title": "test: added coverage to bitcoin-chainstate testing invalid block header",
      "body": "## Summary\r\nThis adds coverage to `src/bitcoin-chainstate.cpp` where we get `BLOCK_INVALID_HEADER` and the error message `invalid proof of work or time too old`\r\n\r\n[Where coverage is added](https://github.com/bitcoin/bitcoin/blob/master/src/bitcoin-chainstate.cpp#L239-L241)\r\n\r\nthis change was motivated by [this comment](https://github.com/bitcoin/bitcoin/pull/32145/files#r2014560812)\r\n\r\n---\r\n\r\nYou can check that you cannot find this message with test coverage by using grep\r\n`grep -nri \"or time too old\" ./test/functional/`",
      "state": "closed",
      "user": "kevkevinpal",
      "created_at": "2025-04-01T19:42:37Z",
      "updated_at": "2025-04-02T13:59:12Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/32190",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32190.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Approach ACK | [shahsb](https://github.com/bitcoin/bitcoin/pull/32190#pullrequestreview-2735247977) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n",
          "created_at": "2025-04-01T19:42:40Z"
        },
        {
          "user": "maflcko",
          "body": "Not sure about this. The executable is just a test-only dev-only experimental dummy, expected to change in the future. So adding tests for all edge cases is verbose and will make it harder to change the behavior in the future. ",
          "created_at": "2025-04-02T08:42:49Z"
        },
        {
          "user": "kevkevinpal",
          "body": "> Not sure about this. The executable is just a test-only dev-only experimental dummy, expected to change in the future. So adding tests for all edge cases is verbose and will make it harder to change the behavior in the future.\r\n\r\nOk no problem, I can close this PR and can repopen in the future if its needed\r\n\r\nthanks everyone for the review on this one",
          "created_at": "2025-04-02T13:59:11Z"
        }
      ]
    },
    {
      "number": 32189,
      "title": "refactor: Txid type safety (parent PR)",
      "body": "üö®üö® UNDER NO CIRCUMSTANCES SHOULD THIS BE MERGED!! üö®üö®\r\n\r\nThis is the full Txid type safety refactor. Any transaction that was using uint256 should now be either a Txid, Wtxid, or GenTxid. The implicit conversion in `transaction_identifier.h` from the transaction types to uint256 is removed and any conversions are now explicit, using `FromUint256` or `ToUint256()`. In general, I try to only convert a transaction to uint256 in contexts where the type information isn't preserved. Examples would be bloom filters or the txid hasher.\r\n\r\nThe GenTxid class changes to a variant, which holds both Txids and Wtxids. This provides compile-time type safety and eliminates the manual type check (`bool m_is_wtxid`). Variables that can be either type now use GenTxid, instead of uint256.\r\n\r\nI'll be splitting this up into a few smaller PRs, but any feedback on the approach or questions about specifics are welcome here.",
      "state": "closed",
      "user": "marcofleon",
      "created_at": "2025-04-01T18:47:14Z",
      "updated_at": "2025-08-01T13:59:06Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/32189",
      "labels": [
        "Refactoring",
        "Needs rebase",
        "CI failed"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32189.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32941](https://github.com/bitcoin/bitcoin/pull/32941) (p2p: TxOrphanage revamp cleanups by glozow)\n* [#32844](https://github.com/bitcoin/bitcoin/pull/32844) (RPC/txoutproof: Support including (and verifying) proofs of wtxid by luke-jr)\n* [#32730](https://github.com/bitcoin/bitcoin/pull/32730) (p2p: avoid traversing blocks (twice) during IBD by furszy)\n* [#32631](https://github.com/bitcoin/bitcoin/pull/32631) (refactor: Convert GenTxid to `std::variant` by marcofleon)\n* [#32497](https://github.com/bitcoin/bitcoin/pull/32497) (merkle: pre‚Äëreserve leaves to prevent reallocs with odd vtx count by l0rinc)\n* [#32468](https://github.com/bitcoin/bitcoin/pull/32468) (rpc: generateblock to allow multiple outputs by polespinasa)\n* [#31829](https://github.com/bitcoin/bitcoin/pull/31829) (p2p: improve TxOrphanage denial of service bounds by glozow)\n* [#31682](https://github.com/bitcoin/bitcoin/pull/31682) ([IBD] specialize CheckBlock's input & coinbase checks by l0rinc)\n* [#31650](https://github.com/bitcoin/bitcoin/pull/31650) (refactor: Avoid copies by using const references or by move-construction by maflcko)\n* [#31385](https://github.com/bitcoin/bitcoin/pull/31385) (package validation: relax the package-not-child-with-unconfirmed-parents rule by glozow)\n* [#30442](https://github.com/bitcoin/bitcoin/pull/30442) ([IBD] precalculate SipHash constant salt calculations by l0rinc)\n* [#30116](https://github.com/bitcoin/bitcoin/pull/30116) (p2p: Fill reconciliation sets (Erlay) attempt 2 by sr-gi)\n* [#30079](https://github.com/bitcoin/bitcoin/pull/30079) (Fee Estimation: Ignore all transactions that are CPFP'd by ismaelsadeeq)\n* [#29415](https://github.com/bitcoin/bitcoin/pull/29415) (Broadcast own transactions only via short-lived Tor or I2P connections by vasild)\n* [#28676](https://github.com/bitcoin/bitcoin/pull/28676) ([WIP] Cluster mempool implementation by sdaftuar)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-04-01T18:47:17Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/39796036093</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
          "created_at": "2025-04-01T21:46:36Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `tidy`: https://github.com/bitcoin/bitcoin/runs/42717598129</sub>\n<sub>LLM reason (‚ú® experimental): The CI failure is due to multiple build errors during the compilation process.\n</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-05-22T16:43:13Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\nüêô This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
          "created_at": "2025-07-11T19:16:55Z"
        },
        {
          "user": "marcofleon",
          "body": "Closing this, as the final complete refactor can be seen in https://github.com/bitcoin/bitcoin/pull/32238, https://github.com/bitcoin/bitcoin/pull/32631, https://github.com/bitcoin/bitcoin/pull/33005, and https://github.com/bitcoin/bitcoin/pull/33116. Glad the warning here was heeded üö®",
          "created_at": "2025-08-01T13:59:06Z"
        }
      ]
    },
    {
      "number": 32187,
      "title": "refactor: Remove spurious virtual from final ~CZMQNotificationInterface",
      "body": "`virtual` does not make sense here, because:\r\n\r\n* The class is `final`, thus the destructor isn't overridden in a derived class\r\n* The destructor also isn't overriding the destructor of the base, clarified in commit 2b3ea39de40bc7754cab558245e4ddac1b261750\r\n* Clang 21 may warn about this\r\n\r\n```\r\nsrc/zmq/zmqnotificationinterface.h:25:13: error: virtual method '~CZMQNotificationInterface' is inside a 'final' class and can never be overridden [-Werror,-Wunnecessary-virtual-specifier]\r\n   25 |     virtual ~CZMQNotificationInterface();\r\n      |             ^\r\n```\r\n\r\nFix all issues by removing it.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-04-01T16:51:46Z",
      "updated_at": "2025-04-02T10:51:34Z",
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/pull/32187",
      "labels": [
        "Refactoring"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32187.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [janb84](https://github.com/bitcoin/bitcoin/pull/32187#pullrequestreview-2733737344), [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/32187#pullrequestreview-2733816930), [davidgumberg](https://github.com/bitcoin/bitcoin/pull/32187#issuecomment-2770898577) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n",
          "created_at": "2025-04-01T16:51:49Z"
        },
        {
          "user": "maflcko",
          "body": "(ci failure can be ignored and is unrelated, see https://github.com/bitcoin/bitcoin/pull/32184)",
          "created_at": "2025-04-01T18:36:15Z"
        },
        {
          "user": "davidgumberg",
          "body": "crACK https://github.com/bitcoin/bitcoin/commit/fa69c42fdf0aeec0546e951bc6132ab630edb9d4",
          "created_at": "2025-04-01T23:26:51Z"
        },
        {
          "user": "hebasto",
          "body": ">    * Clang 21 may warn about this\r\n> \r\n> \r\n> ```\r\n> src/zmq/zmqnotificationinterface.h:25:13: error: virtual method '~CZMQNotificationInterface' is inside a 'final' class and can never be overridden [-Werror,-Wunnecessary-virtual-specifier]\r\n>    25 |     virtual ~CZMQNotificationInterface();\r\n>       |             ^\r\n> ```\r\n\r\nDoes Clang 21 have this warning enabled? Asking because I can't see warnings in https://github.com/hebasto/bitcoin-core-nightly/actions/workflows/clang.yml.",
          "created_at": "2025-04-02T09:20:29Z"
        },
        {
          "user": "maflcko",
          "body": "> Does Clang 21 have this warning enabled? Asking because I can't see warnings in https://github.com/hebasto/bitcoin-core-nightly/actions/workflows/clang.yml.\r\n\r\n[It ran ](https://github.com/hebasto/bitcoin-core-nightly/actions/runs/14210657808) 6 hours ago, but this pull was merged 7 hours ago. Thus, if you want to test it with clang-21, you'll have to revert the pull first.",
          "created_at": "2025-04-02T09:22:50Z"
        },
        {
          "user": "hebasto",
          "body": "> > Does Clang 21 have this warning enabled? Asking because I can't see warnings in https://github.com/hebasto/bitcoin-core-nightly/actions/workflows/clang.yml.\r\n> \r\n> [It ran ](https://github.com/hebasto/bitcoin-core-nightly/actions/runs/14210657808) 6 hours ago, but this pull was merged 7 hours ago. Thus, if you want to test it with clang-21, you'll have to revert the pull first.\r\n\r\nThis [one](https://github.com/hebasto/bitcoin-core-nightly/actions/runs/14186473011) run @ 74d9598bfbc24c3b7bfe1dad5bf9d988381bf893. ",
          "created_at": "2025-04-02T09:26:31Z"
        },
        {
          "user": "maflcko",
          "body": "I don't know, but it is possibly before clang enabled the warning by default? I tested `Ubuntu clang version 21.0.0 (++20250331082744+4e8fbc60710e-1~exp1~20250331202915.820)`\r\n\r\nMy recommendation would be to just test on a fresh install of everything, if you want to test this.\r\n\r\nI can take a look, if it fails to reproduce.",
          "created_at": "2025-04-02T09:42:13Z"
        }
      ]
    },
    {
      "number": 32186,
      "title": "descriptor: handle listdescriptors(private=true) for descriptors having partial keys",
      "body": "When parsing descriptors with multiple keys (tr, wsh, sh, miniscript),\r\nwe might not have all the private keys but only few of them\r\n(rest being public keys).\r\n\r\n`listdescriptors(private=true)` RPC should not\r\nfail in such scenario and instead return those partial private keys,\r\nusing public keys for the rest.\r\n\r\nFixes #32078\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "closed",
      "user": "rkrux",
      "created_at": "2025-04-01T14:28:45Z",
      "updated_at": "2025-05-05T11:43:41Z",
      "comments": 12,
      "url": "https://github.com/bitcoin/bitcoin/pull/32186",
      "labels": [
        "Wallet",
        "CI failed"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32186.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [w0xlt](https://github.com/bitcoin/bitcoin/pull/32186#issuecomment-2777359039), [brunoerg](https://github.com/bitcoin/bitcoin/pull/32186#pullrequestreview-2747134106) |\n| Approach NACK | [sipa](https://github.com/bitcoin/bitcoin/pull/32186#issuecomment-2783825867) |\n| Stale ACK | [Randy808](https://github.com/bitcoin/bitcoin/pull/32186#issuecomment-2781065344) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#31734](https://github.com/bitcoin/bitcoin/pull/31734) (miniscript: account for all `StringType` variants in `Miniscriptdescriptor::ToString()` by pythcoiner)\n* [#30243](https://github.com/bitcoin/bitcoin/pull/30243) (descriptors: taproot partial descriptors by Eunovo)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
          "created_at": "2025-04-01T14:28:49Z"
        },
        {
          "user": "rkrux",
          "body": "cc: @furszy ",
          "created_at": "2025-04-01T14:30:16Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/39778817034</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
          "created_at": "2025-04-01T16:46:32Z"
        },
        {
          "user": "furszy",
          "body": "I haven't checked the approach, but based on the title, I assume it is linked to #32078.",
          "created_at": "2025-04-01T19:27:47Z"
        },
        {
          "user": "w0xlt",
          "body": "Concept ACK.\r\nIt addresses the issue mentioned in the PR description.\r\nIt may be better if the test validates the returned message.",
          "created_at": "2025-04-04T01:47:46Z"
        },
        {
          "user": "Randy808",
          "body": "Code Review ACK 3d3d8491948c2825c43db7fae69c32aae343742f",
          "created_at": "2025-04-05T20:01:47Z"
        },
        {
          "user": "sipa",
          "body": "Approach NACK. There is no reason why this needs to be special cased for taproot.\r\n\r\n`listdescriptors true` should always return all private keys that are present in the wallet, even if not all private keys are present. That can happen in taproot branches, but it also could happen for a simple multisig.\r\n\r\n#24361 would have fixed this. Feel free to pick it up.",
          "created_at": "2025-04-07T15:48:07Z"
        },
        {
          "user": "rkrux",
          "body": "I see, it makes sense to solve it for all the cases; I'll rework this PR. ",
          "created_at": "2025-04-07T17:03:26Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/40327848658</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
          "created_at": "2025-04-10T15:47:39Z"
        },
        {
          "user": "rkrux",
          "body": "I don't like the way this diff has turned out, seems repetitive. I will take inspiration from #24361 and spend some time figuring out how to make it work for Miniscript expressions as well. The branch name is outdated too now. \r\n\r\nMost likely will close this and open a new PR.",
          "created_at": "2025-04-11T14:06:55Z"
        },
        {
          "user": "Eunovo",
          "body": "@rkrux still working on this?",
          "created_at": "2025-05-05T11:18:44Z"
        },
        {
          "user": "rkrux",
          "body": "@Eunovo I have not gotten around to trying the other approach yet as I was working on few other PRs. Please feel free to give it a shot if you want else I will give it another try some time later. \r\n\r\nClosing this PR either way.",
          "created_at": "2025-05-05T11:43:41Z"
        }
      ]
    },
    {
      "number": 32185,
      "title": "coins: replace manual `CDBBatch` size estimation with LevelDB's native `ApproximateSize`",
      "body": "### Summary\r\n\r\nThe manual batch size estimation of `CDBBatch` serialized size was [added](https://github.com/bitcoin/bitcoin/pull/10195/commits/e66dbde6d14cb5f253b3bf8850a98f4fda2d9f49) when LevelDB [didn't expose this functionality  yet](https://github.com/google/leveldb/commit/69e2bd2).\r\nThe PR refactors the logic to use the native `leveldb::WriteBatch::ApproximateSize()` function, structured in 3 focused commits to incrementally replace the old behavior safely.\r\n\r\n### Context\r\n\r\nThe previous manual size calculation initialized the estimate to 0, instead of LevelDB's header size (containing an 8-byte sequence number followed by a 4-byte count).\r\nThis PR corrects that and transitions to the now-available native LevelDB function for improved accuracy and maintainability.\r\n\r\n### Approach\r\nThe fix and refactor follow a strangle pattern over three commits:\r\n* correct the initialization bug in the existing manual calculation, isolating the fix and ensuring the subsequent assertions use the corrected logic;\r\n* introduce the native `ApproximateSize()` method alongside the corrected manual one, adding assertions to verify their equivalence at runtime;\r\n* remove the verified manual calculation logic and assertions, leaving only the native method.\r\n\r\n",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2025-04-01T14:06:11Z",
      "updated_at": "2025-04-08T20:20:58Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/32185",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32185.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [sipa](https://github.com/bitcoin/bitcoin/pull/32185#issuecomment-2783546419), [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/32185#pullrequestreview-2749072371), [laanwj](https://github.com/bitcoin/bitcoin/pull/32185#pullrequestreview-2749097332) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#31668](https://github.com/bitcoin/bitcoin/pull/31668) (Added rescan option for import descriptors by saikiran57)\n* [#30673](https://github.com/bitcoin/bitcoin/pull/30673) (coins: remove logic for spent-and-FRESH cache entries and writing non-DIRTY entries by andrewtoth)\n* [#30342](https://github.com/bitcoin/bitcoin/pull/30342) (kernel, logging: Pass Logger instances to kernel objects by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
          "created_at": "2025-04-01T14:06:14Z"
        },
        {
          "user": "laanwj",
          "body": "Concept ACK, leveldb provides internal functionality for this it's better to use that instead of maintaining our own estimate.",
          "created_at": "2025-04-07T10:26:59Z"
        },
        {
          "user": "sipa",
          "body": "utACK e419b0e17f8acfe577c35c62a8a71a19aad249f3",
          "created_at": "2025-04-07T14:31:13Z"
        },
        {
          "user": "sedited",
          "body": "Concept ACK\r\n\r\nIs there a reason you only assert the equivalence in batch sizes in txdb? I think it would be better to do them at the start and end of the methods than at a few of their call sites. ",
          "created_at": "2025-04-07T16:14:02Z"
        },
        {
          "user": "l0rinc",
          "body": "> Is there a reason you only assert the equivalence in batch sizes in txdb? \r\n\r\nI have asserted equivalence at every invocation of `SizeEstimate`, since that's what I'm replacing here. I asserted both before and after to make sure I don't introduce a bias (e.g. \"*I know* that this method won't change it, so there's no need to assert\") and because it was temporary.\r\n\r\n> I think it would be better to do them at the start and end of the methods than at a few of their call sites.\r\n\r\nCan you show me an example, I'm not sure I follow.",
          "created_at": "2025-04-07T16:57:55Z"
        }
      ]
    },
    {
      "number": 32184,
      "title": "ci: Add workaround for vcpkg's `libevent` package",
      "body": "This PR is necessary for Windows GHA [images](https://github.com/actions/runner-images/blob/win22/20250330.1/images/windows/Windows2022-Readme.md), which provide CMake >= 4.0.\r\n\r\nThe idea has been taken from https://github.com/microsoft/vcpkg/pull/44273#discussion_r2009140242.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-04-01T14:05:01Z",
      "updated_at": "2025-04-17T11:52:30Z",
      "comments": 13,
      "url": "https://github.com/bitcoin/bitcoin/pull/32184",
      "labels": [
        "Windows",
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32184.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [maflcko](https://github.com/bitcoin/bitcoin/pull/32184#issuecomment-2770481828), [pinheadmz](https://github.com/bitcoin/bitcoin/pull/32184#pullrequestreview-2733924513) |\n| Concept ACK | [laanwj](https://github.com/bitcoin/bitcoin/pull/32184#issuecomment-2769504239) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32182](https://github.com/bitcoin/bitcoin/pull/32182) (ci: Switch to dynamic library linkage in native Windows job by hebasto)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
          "created_at": "2025-04-01T14:05:05Z"
        },
        {
          "user": "hebasto",
          "body": "cc @laanwj @pinheadmz ",
          "created_at": "2025-04-01T14:05:18Z"
        },
        {
          "user": "laanwj",
          "body": "Concept ACK.\r\n\r\nDo we need to mention this in `build-windows.md` as well, for people manually building using MSVC?\r\n\r\nOr is this so temporary and likely to be worked around upstream.",
          "created_at": "2025-04-01T14:11:39Z"
        },
        {
          "user": "hebasto",
          "body": "> Do we need to mention this in `build-windows.md` as well, for people manually building using MSVC?\r\n> \r\n> Or is this so temporary and likely to be worked around upstream.\r\n\r\nIt seems to be close to being fixed [upstream](https://github.com/microsoft/vcpkg/pull/44273).",
          "created_at": "2025-04-01T14:22:06Z"
        },
        {
          "user": "pinheadmz",
          "body": "https://github.com/libevent/libevent/issues/1782 says:\r\n\r\n> CMake >= 4.0.0-rc1 removed compatibility with versions < 3.5 and errors out with such versions passed to cmake_minimum_required().\r\n\r\nJust so I understand, this PR hacks the min required value, but doesn't handle whatever incompatibility there actually *is* between cmake 4 and 3.5?\r\n\r\nConcept ACK, CI is passing so seems to do the trick. I can test on a windows 2022 server VM later today.",
          "created_at": "2025-04-01T17:06:43Z"
        },
        {
          "user": "maflcko",
          "body": "Shouldn't upstream just merge the fix in https://github.com/microsoft/vcpkg/pull/44356 ?",
          "created_at": "2025-04-01T17:23:27Z"
        },
        {
          "user": "laanwj",
          "body": "> Just so I understand, this PR hacks the min required value, but doesn't handle whatever incompatibility there actually is between cmake 4 and 3.5?\r\n\r\nYes, that's what it does. It doesn't seem that there is an actual incompatibility. My understanding is that as some versioning mechanism for CMake 4.0+ they made it that compatibility needs to be explicitly checked and enabled for each project.",
          "created_at": "2025-04-01T17:27:51Z"
        },
        {
          "user": "hebasto",
          "body": "> ... CI is passing so seems to do the trick.\r\n\r\nPlease note that both CI jobs--[Windows native](https://github.com/bitcoin/bitcoin/actions/runs/14197998351/job/39777781027) and [Windows native, fuzz](https://github.com/bitcoin/bitcoin/actions/runs/14197998351/job/39777781018)--used the `windows-2022` image `Version: 20250324.3.0`, which provides `cmake version 3.31.6`. This image works fine without this PR.\r\n\r\nThis CI [job](https://github.com/hebasto/bitcoin/actions/runs/14197997499/job/39796706961) uses the updated image `Version: 20250330.1.0`, which provides `cmake version 4.0.0`, and does prove the usefulness of this PR.",
          "created_at": "2025-04-01T19:10:42Z"
        },
        {
          "user": "hebasto",
          "body": "> Shouldn't upstream just merge the fix in [microsoft/vcpkg#44356](https://github.com/microsoft/vcpkg/pull/44356) ?\r\n\r\nI don't think so.\r\n\r\nWe have pinned the `libevent` package to the latest [release](https://github.com/libevent/libevent/releases/tag/release-2.1.11-stable) for a reason:https://github.com/bitcoin/bitcoin/blob/1a6fc04d815e45ee895bd7ff0bc1b03685ed96c3/vcpkg.json#L51-L57\r\n\r\nHowever, merging upstream https://github.com/microsoft/vcpkg/pull/44273 would help.",
          "created_at": "2025-04-01T19:18:04Z"
        },
        {
          "user": "maflcko",
          "body": "Thanks for explaining!\r\n\r\nI guess this means the temporary workaround here is needed.\r\n\r\nlgtm ACK 30c59adda44f86b5e78249f3fb0d2cff88dad285",
          "created_at": "2025-04-01T19:28:42Z"
        },
        {
          "user": "hebasto",
          "body": "> > Just so I understand, this PR hacks the min required value, but doesn't handle whatever incompatibility there actually is between cmake 4 and 3.5?\r\n> \r\n> Yes, that's what it does. It doesn't seem that there is an actual incompatibility. My understanding is that as some versioning mechanism for CMake 4.0+ they made it that compatibility needs to be explicitly checked and enabled for each project.\r\n\r\nThe CMake's variable [`CMAKE_POLICY_VERSION_MINIMUM`](https://cmake.org/cmake/help/latest/variable/CMAKE_POLICY_VERSION_MINIMUM.html) specifies:\r\n> a minimum [Policy Version](https://cmake.org/cmake/help/latest/command/cmake_minimum_required.html#policy-version) for a project without modifying its calls to [`cmake_minimum_required(VERSION)`](https://cmake.org/cmake/help/latest/command/cmake_minimum_required.html#command:cmake_minimum_required)...\r\n\r\nIt is safe to bump the policy version to 3.5, as our own patch in depends does the same:https://github.com/bitcoin/bitcoin/blob/1a6fc04d815e45ee895bd7ff0bc1b03685ed96c3/depends/patches/libevent/cmake_fixups.patch#L1-L13",
          "created_at": "2025-04-01T19:32:59Z"
        },
        {
          "user": "hebasto",
          "body": "> This PR is necessary for Windows GHA [images](https://github.com/actions/runner-images/blob/win22/20250330.1/images/windows/Windows2022-Readme.md), which provide CMake >= 4.0.\r\n\r\nThey downgraded CMake to 3.31.6 in the subsequent image [update](https://github.com/actions/runner-images/pull/11958). Nevertheless, it's good for us to be prepared.",
          "created_at": "2025-04-10T09:59:17Z"
        },
        {
          "user": "fanquake",
          "body": "Backported in #32292.",
          "created_at": "2025-04-17T11:52:29Z"
        }
      ]
    },
    {
      "number": 32183,
      "title": "tests: Improve stderr validation in test_runner.py",
      "body": "This PR implements the improvement suggested in a TODO comment in test/util/test_runner.py. \r\nIt adds validation that stderr is empty when no errors are expected in test cases.\r\n\r\nThe change adds a check that verifies stderr is empty when no error_txt is specified in \r\nthe test object, with a special exception for bitcoin-tx running under Wine, which was \r\nmentioned in the original TODO comment.\r\n\r\nThis improvement helps catch unexpected error messages that might otherwise go unnoticed \r\nduring testing, making the test framework more robust.\r\n\r\nThe implementation:\r\n1. Checks if stderr contains output when no error is expected\r\n2. Makes an exception for the known case of bitcoin-tx running under Wine\r\n3. Raises an exception with a detailed error message if unexpected stderr output is found\r\n4. Removes the TODO comment as the task is now completed\r\n\r\nThis change improves test coverage by ensuring that tests don't silently pass when they \r\nproduce unexpected error output.",
      "state": "closed",
      "user": "GarmashAlex",
      "created_at": "2025-04-01T09:54:34Z",
      "updated_at": "2025-04-28T13:47:41Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/pull/32183",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32183.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
          "created_at": "2025-04-01T09:54:37Z"
        },
        {
          "user": "fanquake",
          "body": "Closing in favour of #32327.",
          "created_at": "2025-04-22T16:03:41Z"
        }
      ]
    },
    {
      "number": 32182,
      "title": "ci: Switch to dynamic library linkage in native Windows job",
      "body": "This PR significantly reduces the vcpkg binary cache size, improving CI caching performance:\r\n\r\n| Branch | Cache Size |\r\n|---|--:|\r\n| master | 2.6 GB |\r\n| this PR |  430 MB |\r\n\r\nAlso see https://github.com/bitcoin/bitcoin/pull/31176#issuecomment-2766164288.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-04-01T09:34:35Z",
      "updated_at": "2025-10-01T09:37:05Z",
      "comments": 8,
      "url": "https://github.com/bitcoin/bitcoin/pull/32182",
      "labels": [
        "Windows",
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32182.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [maflcko](https://github.com/bitcoin/bitcoin/pull/32182#issuecomment-2773261035) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n",
          "created_at": "2025-04-01T09:34:38Z"
        },
        {
          "user": "maflcko",
          "body": "Was there a reason to use static linking in this CI here before?",
          "created_at": "2025-04-01T09:39:33Z"
        },
        {
          "user": "hebasto",
          "body": "> Was there a reason to use static linking in this CI here before?\r\n\r\nThe static linking was inherited from the Cirrus task in https://github.com/bitcoin/bitcoin/pull/28173, which, in turn, used our custom Qt build instead of the vcpkg manager.\r\n\r\nMy guess is that, back when we were using our custom MSVC project file, static linking worked seamlessly without needing to manage DLL locations.\r\n\r\nMaybe @sipsorcery could provide more details.",
          "created_at": "2025-04-01T10:02:37Z"
        },
        {
          "user": "sipsorcery",
          "body": "The msvc build was created with static linking because that's what the non-msvc build does. Other than that no real reason.",
          "created_at": "2025-04-01T10:05:43Z"
        },
        {
          "user": "hebasto",
          "body": "Rebased due to a conflict with the merged bitcoin/bitcoin#32184.",
          "created_at": "2025-04-02T08:34:11Z"
        },
        {
          "user": "hebasto",
          "body": "Rebased and undrafted.",
          "created_at": "2025-04-02T16:50:39Z"
        },
        {
          "user": "maflcko",
          "body": "lgtm ACK 7967fe5bfd3e881353db9a4428ea913ce4ea15a5",
          "created_at": "2025-04-02T17:32:49Z"
        },
        {
          "user": "hodlinator",
          "body": "Noticed the build artifact `x86_64-w64-mingw32-executables-<run>` is 916MB (https://github.com/bitcoin/bitcoin/actions/runs/18155350909?pr=31723 / https://github.com/bitcoin/bitcoin/actions/runs/18155350909/job/51673850541?pr=31723#step:9:161).\r\n\r\nArtifact contents:\r\n```shell\r\n$ unzip -l x86_64-w64-mingw32-executables-18155350909.zip \r\nArchive:  x86_64-w64-mingw32-executables-18155350909.zip\r\n  Length      Date    Time    Name\r\n---------  ---------- -----   ----\r\n617942101  10-01-2025 07:57   bin/bench_bitcoin.exe\r\n610761406  10-01-2025 07:57   bin/bitcoin-qt.exe\r\n 62115659  10-01-2025 07:55   bin/bitcoin-tx.exe\r\n 28860486  10-01-2025 07:55   bin/bitcoin-cli.exe\r\n 28258672  10-01-2025 07:55   bin/bitcoin-util.exe\r\n215229370  10-01-2025 07:55   bin/bitcoin-wallet.exe\r\n 17588530  10-01-2025 07:55   bin/bitcoin.exe\r\n472440702  10-01-2025 07:56   bin/bitcoind.exe\r\n722128888  10-01-2025 07:59   bin/fuzz.exe\r\n963138284  10-01-2025 07:59   bin/test_bitcoin.exe\r\n  1006274  10-01-2025 07:54   src/secp256k1/bin/exhaustive_tests.exe\r\n  3244108  10-01-2025 07:54   src/secp256k1/bin/noverify_tests.exe\r\n  3642166  10-01-2025 07:54   src/secp256k1/bin/tests.exe\r\n  4811144  10-01-2025 07:53   src/univalue/object.exe\r\n  4115324  10-01-2025 07:53   src/univalue/unitester.exe\r\n      967  10-01-2025 07:53   test/config.ini\r\n---------                     -------\r\n3755284081                     16 files\r\n```\r\n\r\ntest_bitcoin.exe itself is almost 1GB when uncompressed.\r\n\r\n**Would it be okay to use stripped binaries in the artifact?**\r\n\r\nTried reproducing running `env -i HOME=\"$HOME\" PATH=\"$PATH\" USER=\"$USER\" ... FILE_ENV=\"./ci/test/00_setup_env_win64.sh\" ./ci/test_run_all.sh'` and noticed we have stripped binaries available in release/\r\n```shell\r\nroot@23d2a9125040:/ci_container_base/ci/scratch/build-x86_64-w64-mingw32# ls -alh bin/ release/\r\nbin/:\r\ntotal 3.5G\r\ndrwxr-xr-x  2 root root 4.0K Oct  1 09:04 .\r\ndrwxr-xr-x 10 root root 4.0K Oct  1 09:04 ..\r\n-rwxr-xr-x  1 root root 589M Oct  1 09:02 bench_bitcoin.exe\r\n-rwxr-xr-x  1 root root  28M Oct  1 08:58 bitcoin-cli.exe\r\n-rwxr-xr-x  1 root root 582M Oct  1 09:00 bitcoin-qt.exe\r\n-rwxr-xr-x  1 root root  60M Oct  1 08:58 bitcoin-tx.exe\r\n-rwxr-xr-x  1 root root  27M Oct  1 08:58 bitcoin-util.exe\r\n-rwxr-xr-x  1 root root 206M Oct  1 08:58 bitcoin-wallet.exe\r\n-rwxr-xr-x  1 root root 4.9M Oct  1 08:57 bitcoin.exe\r\n-rwxr-xr-x  1 root root 451M Oct  1 08:59 bitcoind.exe\r\n-rwxr-xr-x  1 root root 688M Oct  1 09:04 fuzz.exe\r\n-rwxr-xr-x  1 root root 918M Oct  1 09:04 test_bitcoin.exe\r\n\r\nrelease/:\r\ntotal 94M\r\ndrwxr-xr-x  2 root root 4.0K Oct  1 09:04 .\r\ndrwxr-xr-x 10 root root 4.0K Oct  1 09:04 ..\r\n-rwxr-xr-x  1 root root 2.2M Oct  1 09:04 bitcoin-cli.exe\r\n-rwxr-xr-x  1 root root  38M Oct  1 09:04 bitcoin-qt.exe\r\n-rwxr-xr-x  1 root root 4.0M Oct  1 09:04 bitcoin-tx.exe\r\n-rwxr-xr-x  1 root root 1.9M Oct  1 09:04 bitcoin-util.exe\r\n-rwxr-xr-x  1 root root 7.9M Oct  1 09:04 bitcoin-wallet.exe\r\n-rwxr-xr-x  1 root root 1.2M Oct  1 09:04 bitcoin.exe\r\n-rwxr-xr-x  1 root root  14M Oct  1 09:04 bitcoind.exe\r\n-rwxr-xr-x  1 root root  26M Oct  1 09:04 test_bitcoin.exe\r\n```",
          "created_at": "2025-10-01T09:37:05Z"
        }
      ]
    },
    {
      "number": 32181,
      "title": "BIP-777 (GPR) The Great Poker Restoration: Add the poker client back to bitcoin",
      "body": "This introduces a local poker client that allows you to play poker against your own node!\r\n\r\nSatoshi envisioned bitcoin as peer-to-peer digital cash but he also added the only other known use case for cryptocurrency in bitcoin's original implementation: gambling.\r\n\r\nThis remains the sole significant innovation across all other cryptocurrency projects. Therefore, I believe it‚Äôs time to reconnect this concept with bitcoin and initiate The Great Poker Restoration.\r\n\r\nOriginal bitcoin poker code can be found here: \r\n\r\n- https://github.com/trottier/original-bitcoin/blob/master/src/uibase.cpp#L1573-L1731\r\n\r\nNext steps \r\n\r\n- Add multiplayer lobbies\r\n- Add OP_SECURETHEPOT",
      "state": "closed",
      "user": "stutxo",
      "created_at": "2025-04-01T06:13:04Z",
      "updated_at": "2025-07-31T19:15:32Z",
      "comments": 30,
      "url": "https://github.com/bitcoin/bitcoin/pull/32181",
      "labels": [
        "Feature",
        "CI failed"
      ]
    }
  ],
  "issues": [
    {
      "number": 32192,
      "title": "ci: Use previous releases in tests on Windows",
      "body": "Currently, none of the CI jobs running on Windows‚Äînamely \"Windows native\" and \"Windows, test cross-built\"‚Äîuses previous releases.\n\nIt seems reasonable to address this issue.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-04-01T20:43:24Z",
      "updated_at": "2025-07-15T16:55:09Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/32192",
      "labels": [
        "Windows",
        "Tests"
      ],
      "comment_list": [
        {
          "user": "fanquake",
          "body": "Fixed by #32219.",
          "created_at": "2025-07-15T16:55:00Z"
        }
      ]
    },
    {
      "number": 32188,
      "title": ".",
      "body": "",
      "state": "closed",
      "user": "PeaceOut13001400",
      "created_at": "2025-04-01T17:34:14Z",
      "updated_at": "2025-04-01T23:16:09Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/32188",
      "labels": [],
      "comment_list": [
        {
          "user": "maflcko",
          "body": "Usually the issue tracker is used to track technical issues related to the Bitcoin Core code base.\n\nGeneral bitcoin questions and/or support requests are best directed to the [Bitcoin StackExchange](https://bitcoin.stackexchange.com) or the `#bitcoin` IRC channel on Libera Chat, or one of the Bitcoin subreddits, or any other place that you feel is well suited.\n\nNetwork-wide consensus and/or P2P changes first need to be discussed with the greater ecosystem, for example https://groups.google.com/g/bitcoindev, or https://delvingbitcoin.org/. Also, they need a BIP to be implemented in Bitcoin Core and other software that connects to the bitcoin P2P network.",
          "created_at": "2025-04-01T17:37:54Z"
        },
        {
          "user": "PeaceOut13001400",
          "body": "I admit it, \"Thank you very much, bro.\" But is there still a chance that they want to implement this there?.",
          "created_at": "2025-04-01T18:48:04Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 12,
    "issues": 2
  }
}