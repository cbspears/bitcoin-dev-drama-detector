{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T19:43:32.692738+00:00",
  "date": "2025-05-18",
  "pull_requests": [
    {
      "number": 32554,
      "title": "bench: replace embedded raw block with configurable block generator",
      "body": "### Problem\r\n\r\nThe [hardcoded benchmark block 413567](https://mempool.space/block/413567) has several issues:\r\n- embeds 1.1MB of binary data in the repository\r\n- mined in 2016, predates SegWit v0, Taproot, and modern script types\r\n- benchmarks cannot test different transaction patterns or script mixes\r\n- updating to a newer block (e.g., [#32457](https://github.com/bitcoin/bitcoin/pull/32457)) would still add binary bloat and would remain inflexible\r\n\r\n### Fix\r\n\r\nAdded configurable `bench/block_generator.{h,cpp}` that builds fully valid blocks at runtime providing blocks or raw serialized stream.\r\n\r\nNote that `HexStrBench` was simplified to work with random data - it doesn't need to be block-related.\r\n\r\n---\r\n\r\nThis supersedes #32457 by eliminating the need for any hardcoded block data while enabling flexible benchmark scenarios.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-05-18T21:39:14Z",
      "updated_at": "2026-01-07T04:04:54Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/32554",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32554.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [laanwj](https://github.com/bitcoin/bitcoin/pull/32554#issuecomment-2890272937), [yuvicc](https://github.com/bitcoin/bitcoin/pull/32554#issuecomment-3016802388), [Raimo33](https://github.com/bitcoin/bitcoin/pull/32554#issuecomment-3419716580) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#34208](https://github.com/bitcoin/bitcoin/pull/34208) (bench: add fluent API for untimed `setup` steps in nanobench by l0rinc)\n* [#32729](https://github.com/bitcoin/bitcoin/pull/32729) (test,refactor: extract script template helpers & widen sigop count coverage by l0rinc)\n* [#31682](https://github.com/bitcoin/bitcoin/pull/31682) ([IBD] specialize CheckBlock's input & coinbase checks by l0rinc)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-18T21:39:17Z"
        },
        {
          "user": "laanwj",
          "body": "Concept ACK",
          "created_at": "2025-05-19T09:18:41Z"
        },
        {
          "user": "yuvicc",
          "body": "Concept ACK\r\n\r\nThis one is pretty useful as I can test with up-to date test_data.",
          "created_at": "2025-06-29T15:44:33Z"
        },
        {
          "user": "Raimo33",
          "body": "Concept ACK for more realistic benchmarks",
          "created_at": "2025-10-19T14:37:15Z"
        },
        {
          "user": "l0rinc",
          "body": "Rebased and applied the new block everywhere, removing the binary of block 413567 embedded in the benchmarks.\r\nLet me know what you think.",
          "created_at": "2025-12-20T23:19:52Z"
        }
      ]
    },
    {
      "number": 32553,
      "title": "wallet: Fix logging of wallet version",
      "body": "The wallet's version (in the minversion record) needs to be logged only after we have read it from disk. Otherwise, we always log the lowest version number of 10500 which is incorrect. Furthermore, it doesn't make sense to log the last client version number if the record didn't exist. This is a regression caused by #26021.\r\n\r\nThe wallet file version logging is moved inside of `LoadMinVersion` so that it is logged after the record is read. It will also log unconditionally if a version is read so that the version number is reported even when there is an error. The last client logging is split into its own log line that will only occur if a last client record is read. The only situation where we expect no version numbers to be logged is when a wallet is being created.\r\n\r\nA test is added in the second commit to check that the version number is correctly logged on loading. This commit can be cherrypicked to master to verify that it fails there. The last commit adds an additional check that creating a new wallet does not log any version info at all.",
      "state": "closed",
      "user": "achow101",
      "created_at": "2025-05-18T19:07:56Z",
      "updated_at": "2025-05-23T01:25:17Z",
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/pull/32553",
      "labels": [
        "Wallet"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32553.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [laanwj](https://github.com/bitcoin/bitcoin/pull/32553#pullrequestreview-2850007943), [janb84](https://github.com/bitcoin/bitcoin/pull/32553#pullrequestreview-2850352360), [furszy](https://github.com/bitcoin/bitcoin/pull/32553#pullrequestreview-2851013472), [rkrux](https://github.com/bitcoin/bitcoin/pull/32553#pullrequestreview-2853743852) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-18T19:07:59Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `lint`: https://github.com/bitcoin/bitcoin/runs/42437801831</sub>\n<sub>LLM reason (‚ú® experimental): The CI failure is due to a Python linting error related to an f-string in `test/functional/wallet_createwallet.py`.\n</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-05-18T19:54:56Z"
        },
        {
          "user": "achow101",
          "body": "> It would also be worth testing this in the compat test ‚Äî mainly to create a wallet on a previous release and verify that their version and last client are properly reported when opened by the latest release.\r\n\r\nWith legacy wallets removed, this wouldn't really be possible to test as descriptor wallets all are version 169900.",
          "created_at": "2025-05-18T23:36:58Z"
        },
        {
          "user": "furszy",
          "body": "> With legacy wallets removed, this wouldn't really be possible to test as descriptor wallets all are version 169900.\r\n\r\nI was thinking of checking the version during migration, when we load the wallet into memory at the beginning of the process. We shouldn't be modifying the version field at that point, but np. Small nit.",
          "created_at": "2025-05-19T14:42:04Z"
        },
        {
          "user": "fanquake",
          "body": "Backported to `29.x` in #32292.",
          "created_at": "2025-05-20T11:31:30Z"
        },
        {
          "user": "davidgumberg",
          "body": "post-merge ACK https://github.com/bitcoin/bitcoin/pull/32553/commits/4b2cd0b41ff4800c8801f2c44883eaec60a035fa",
          "created_at": "2025-05-23T01:25:16Z"
        }
      ]
    },
    {
      "number": 32552,
      "title": "refactor: Remove workaround for resolved MSVC bug",
      "body": "The MSVC bug was [fixed](https://developercommunity.visualstudio.com/t/consteval-conversion-function-fails/1579014) in Visual Studio version 17.11, and the Bitcoin Core project now requires Visual Studio version [17.13](https://github.com/bitcoin/bitcoin/pull/32525) or later.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-05-18T16:33:51Z",
      "updated_at": "2025-11-12T15:18:29Z",
      "comments": 10,
      "url": "https://github.com/bitcoin/bitcoin/pull/32552",
      "labels": [
        "Refactoring"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32552.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-18T16:33:54Z"
        },
        {
          "user": "hebasto",
          "body": "cc @hodlinator ",
          "created_at": "2025-05-18T16:34:17Z"
        },
        {
          "user": "hebasto",
          "body": "> The MSVC bug was [fixed](https://developercommunity.visualstudio.com/t/consteval-conversion-function-fails/1579014) in Visual Studio version 17.11, and the Bitcoin Core project now requires Visual Studio version [17.13](https://github.com/bitcoin/bitcoin/pull/32525) or later.\r\n\r\nIt's still broken in 17.14.0. Going to submit another bug report.",
          "created_at": "2025-05-18T17:56:10Z"
        },
        {
          "user": "l0rinc",
          "body": "I have also tried the same in: https://github.com/bitcoin/bitcoin/pull/31991#issuecomment-2724946307",
          "created_at": "2025-05-18T18:46:24Z"
        },
        {
          "user": "hebasto",
          "body": "> > The MSVC bug was [fixed](https://developercommunity.visualstudio.com/t/consteval-conversion-function-fails/1579014) in Visual Studio version 17.11, and the Bitcoin Core project now requires Visual Studio version [17.13](https://github.com/bitcoin/bitcoin/pull/32525) or later.\r\n> \r\n> It's still broken in 17.14.0. Going to submit another bug report.\r\n\r\nhttps://developercommunity.visualstudio.com/t/Bogus-C7595-error-on-valid-C20-code/10906093",
          "created_at": "2025-05-18T20:13:50Z"
        },
        {
          "user": "maflcko",
          "body": "It would be good to adjust the URL to avoid confusion and duplicate work and pull requests",
          "created_at": "2025-05-19T06:21:35Z"
        },
        {
          "user": "hebasto",
          "body": "> It would be good to adjust the URL to avoid confusion and duplicate work and pull requests\r\n\r\nSure. I'll wait until it's been properly triaged.",
          "created_at": "2025-05-19T07:17:56Z"
        },
        {
          "user": "maflcko",
          "body": "> > It would be good to adjust the URL to avoid confusion and duplicate work and pull requests\r\n> \r\n> Sure. I'll wait until it's been properly triaged.\r\n\r\nSee https://github.com/bitcoin/bitcoin/pull/32561",
          "created_at": "2025-05-19T10:32:13Z"
        },
        {
          "user": "maflcko",
          "body": "If contributors here have a microsoft account, they may want to upvote the issue report, so that microsoft is aware that there is some interest in having it fixed.",
          "created_at": "2025-05-19T10:33:55Z"
        },
        {
          "user": "hebasto",
          "body": "Another attempt in https://github.com/bitcoin/bitcoin/pull/33861.",
          "created_at": "2025-11-12T15:18:29Z"
        }
      ]
    },
    {
      "number": 32551,
      "title": "cmake: Remove `ENABLE_{SSE41,AVX2,X86_SHANI,ARM_SHANI}` from `bitcoin-build-config.h`",
      "body": "`ENABLE_{SSE41,AVX2,X86_SHANI,ARM_SHANI}`  are already conditionally defined for the [`bitcoin_crypto`](https://github.com/bitcoin/bitcoin/blob/master/src/crypto/CMakeLists.txt) target, and they are not used by any other targets. Defining them globally in `bitcoin-build-config.h` is therefore redundant.\r\n\r\nAdditionally, the previously missing `SSE41_CXXFLAGS` variable has been [added](https://github.com/bitcoin/bitcoin/pull/32550#issuecomment-2890918551).",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-05-18T15:24:07Z",
      "updated_at": "2025-05-22T13:57:50Z",
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/pull/32551",
      "labels": [
        "Build system"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32551.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [fanquake](https://github.com/bitcoin/bitcoin/pull/32551#pullrequestreview-2857948411) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-18T15:24:10Z"
        },
        {
          "user": "hebasto",
          "body": "Added a commit from https://github.com/bitcoin/bitcoin/pull/32550.",
          "created_at": "2025-05-19T13:59:59Z"
        },
        {
          "user": "hebasto",
          "body": "Rebased to resolve a conflict with the merged bitcoin/bitcoin#32477.",
          "created_at": "2025-05-20T10:15:51Z"
        },
        {
          "user": "fanquake",
          "body": "Concept ACK",
          "created_at": "2025-05-20T15:41:37Z"
        },
        {
          "user": "hebasto",
          "body": "My Guix build:\r\n```\r\naarch64\r\nd899fe5104a77d8c86d40518cb872e8200142e5711689a7bec1e116fcb1807af  guix-build-800b7cc42ca6/output/aarch64-linux-gnu/SHA256SUMS.part\r\n8f81b2cd236c0116937b950964f1a4a88c0fdf1baf0d859c055153c4fceddcdc  guix-build-800b7cc42ca6/output/aarch64-linux-gnu/bitcoin-800b7cc42ca6-aarch64-linux-gnu-debug.tar.gz\r\n43812573c4d833df3cae58332dfd632afedd428fc0c46a403b872bdfb344bfb7  guix-build-800b7cc42ca6/output/aarch64-linux-gnu/bitcoin-800b7cc42ca6-aarch64-linux-gnu.tar.gz\r\n1e93c16fa60545e3103ee16ab4e251326dafdddb193a9e8b88bb6410edde5cd8  guix-build-800b7cc42ca6/output/arm-linux-gnueabihf/SHA256SUMS.part\r\n6f260d7bb26fe76ab637d751bd390fb4f5a8aaea405f3c3b05b33bc7eb1f5266  guix-build-800b7cc42ca6/output/arm-linux-gnueabihf/bitcoin-800b7cc42ca6-arm-linux-gnueabihf-debug.tar.gz\r\n028d88df8073b27b109f25d6ccc25cabf27dee837562c49e4a456fda96b31a11  guix-build-800b7cc42ca6/output/arm-linux-gnueabihf/bitcoin-800b7cc42ca6-arm-linux-gnueabihf.tar.gz\r\n9042f5fe09b0d61120ca2dda5488e7a1acc93ac1b2e66dd8a8f3107a4fae4700  guix-build-800b7cc42ca6/output/arm64-apple-darwin/SHA256SUMS.part\r\n073fe6a231024932d38d9126cb2d5926e96384cb3ea544d03e6f5b8a53db72e6  guix-build-800b7cc42ca6/output/arm64-apple-darwin/bitcoin-800b7cc42ca6-arm64-apple-darwin-codesigning.tar.gz\r\nf017e990180322579b21214cb2cc6b9a183dc43b5f11f14aaef8633009673726  guix-build-800b7cc42ca6/output/arm64-apple-darwin/bitcoin-800b7cc42ca6-arm64-apple-darwin-unsigned.tar.gz\r\n14e2c8c7aece407c6225194374ab90b4604532cd870502ac4b3915821967fcf2  guix-build-800b7cc42ca6/output/arm64-apple-darwin/bitcoin-800b7cc42ca6-arm64-apple-darwin-unsigned.zip\r\nee33c3391262e4c897a85d7b2f033743e70825378157d3a621ff8055e39f3b69  guix-build-800b7cc42ca6/output/dist-archive/bitcoin-800b7cc42ca6.tar.gz\r\nb1f54424ce1c6cf3380f4d5ad99d181c52753ecb3c61ae8e34f40b2ee643ef0e  guix-build-800b7cc42ca6/output/powerpc64-linux-gnu/SHA256SUMS.part\r\n6b1c52ca508144aa5ea911a0d95a96973fca647eb9033cf6d09f1e7ada478c17  guix-build-800b7cc42ca6/output/powerpc64-linux-gnu/bitcoin-800b7cc42ca6-powerpc64-linux-gnu-debug.tar.gz\r\n505a6998e67b2cda843f85d3194b836910a1a33f54511650d1736c309765fbc7  guix-build-800b7cc42ca6/output/powerpc64-linux-gnu/bitcoin-800b7cc42ca6-powerpc64-linux-gnu.tar.gz\r\nade36e9cf2f3b06e1d9bbb1a45e4806296656441c237a2b04dc649f8631a576e  guix-build-800b7cc42ca6/output/riscv64-linux-gnu/SHA256SUMS.part\r\nbe44082f545987aef1783e8fdc19c99f02324b89ab1e94c6081bd27db74228b5  guix-build-800b7cc42ca6/output/riscv64-linux-gnu/bitcoin-800b7cc42ca6-riscv64-linux-gnu-debug.tar.gz\r\ne826c85054bbcedce5de8121467179f5d3eb9d7973c22508c6e0c04d70c38909  guix-build-800b7cc42ca6/output/riscv64-linux-gnu/bitcoin-800b7cc42ca6-riscv64-linux-gnu.tar.gz\r\nce3a0948679d6effac6323693b935e048bf5ecaf268e4d95710f7e3e6a2bd5be  guix-build-800b7cc42ca6/output/x86_64-apple-darwin/SHA256SUMS.part\r\nefad91469e957bf90af9a62bdc94df1241f23e51715f0da8fecb8de9c3e4f0bc  guix-build-800b7cc42ca6/output/x86_64-apple-darwin/bitcoin-800b7cc42ca6-x86_64-apple-darwin-codesigning.tar.gz\r\n8f763359ae3b1cd638cd83f51e7baa07903fe307fd17502faba48959405bb241  guix-build-800b7cc42ca6/output/x86_64-apple-darwin/bitcoin-800b7cc42ca6-x86_64-apple-darwin-unsigned.tar.gz\r\n8d8ce884550ad5054c773157bdc11b7f5192a9075f2b6247688e580706a596dd  guix-build-800b7cc42ca6/output/x86_64-apple-darwin/bitcoin-800b7cc42ca6-x86_64-apple-darwin-unsigned.zip\r\nacff10fa6e8e86811dff20ce7420c220cec55dfe3eb24d427ffc766dc2079be6  guix-build-800b7cc42ca6/output/x86_64-linux-gnu/SHA256SUMS.part\r\nd6d30f4888fcc4d19916d5a6c774a22a0a216d64588950893746a9c0ce919dca  guix-build-800b7cc42ca6/output/x86_64-linux-gnu/bitcoin-800b7cc42ca6-x86_64-linux-gnu-debug.tar.gz\r\n8a78a2d009c0fef11274ea47a6a46dbeb6effe8aca82ea9aea71b5abbb1b5207  guix-build-800b7cc42ca6/output/x86_64-linux-gnu/bitcoin-800b7cc42ca6-x86_64-linux-gnu.tar.gz\r\n8de26cd66a67a029f06b71661ab64233f380b109b211ce9d26e02ef4634673f0  guix-build-800b7cc42ca6/output/x86_64-w64-mingw32/SHA256SUMS.part\r\n8d66924d1b0f23a9e9cb48b051702ba851d9753cb093f25bca712d0c3b1add11  guix-build-800b7cc42ca6/output/x86_64-w64-mingw32/bitcoin-800b7cc42ca6-win64-codesigning.tar.gz\r\n4acd6691ea9c913e5065380c26f06918e475ded290e111584e6a6ac5b77e5185  guix-build-800b7cc42ca6/output/x86_64-w64-mingw32/bitcoin-800b7cc42ca6-win64-debug.zip\r\n60d4293e162455b6cc329072199dee750e5a1afbc6017307b447dd556b23e6ee  guix-build-800b7cc42ca6/output/x86_64-w64-mingw32/bitcoin-800b7cc42ca6-win64-setup-unsigned.exe\r\n9024c5428fcdd695808d2b105fc3f1b52210b8ec5af3ee407e884c7927adb99e  guix-build-800b7cc42ca6/output/x86_64-w64-mingw32/bitcoin-800b7cc42ca6-win64-unsigned.zip\r\n```",
          "created_at": "2025-05-20T17:01:57Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--9cd9c72976c961c55c7acef8f6ba82cd-->\n### Guix builds (on x86_64) [untrusted test-only build, possibly unsafe, not for production use]\n\n| File | commit 9a887baadebce7c2e76df831fad54c5fa81d309e<br>(master) | commit a443d9a83795584d3b7e94d63ca73a0a4c2b6150<br>(pull/32551/merge) |\n|--|--|--|\n| *-aarch64-linux-gnu-debug.tar.gz | [`bd6620a740c95e51...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-aarch64-linux-gnu-debug.tar.gz) | [`d71b736ff6198891...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-aarch64-linux-gnu-debug.tar.gz) |\n| *-aarch64-linux-gnu.tar.gz | [`e2f34f0460731c77...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-aarch64-linux-gnu.tar.gz) | [`69d4a74167ab8cb4...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-aarch64-linux-gnu.tar.gz) |\n| *-arm-linux-gnueabihf-debug.tar.gz | [`cba7ba1ac3c77dc6...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-arm-linux-gnueabihf-debug.tar.gz) | [`415edfffd2ba8f98...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-arm-linux-gnueabihf-debug.tar.gz) |\n| *-arm-linux-gnueabihf.tar.gz | [`c18cbb0c11903d8e...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-arm-linux-gnueabihf.tar.gz) | [`bf3086e1d4cf381e...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-arm-linux-gnueabihf.tar.gz) |\n| *-arm64-apple-darwin-codesigning.tar.gz | [`08ce1faf4a4f3c97...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-arm64-apple-darwin-codesigning.tar.gz) | [`9dec9c209267c463...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-arm64-apple-darwin-codesigning.tar.gz) |\n| *-arm64-apple-darwin-unsigned.tar.gz | [`8e1eac93dc5b6a27...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-arm64-apple-darwin-unsigned.tar.gz) | [`64c31b3855beeb08...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-arm64-apple-darwin-unsigned.tar.gz) |\n| *-arm64-apple-darwin-unsigned.zip | [`974a2db506d578cb...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-arm64-apple-darwin-unsigned.zip) | [`39319dd70b85c6f2...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-arm64-apple-darwin-unsigned.zip) |\n| *-powerpc64-linux-gnu-debug.tar.gz | [`40806ef6f4ecfc64...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-powerpc64-linux-gnu-debug.tar.gz) | [`8a9b0c3d9aaa4f6d...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-powerpc64-linux-gnu-debug.tar.gz) |\n| *-powerpc64-linux-gnu.tar.gz | [`439500417e348a03...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-powerpc64-linux-gnu.tar.gz) | [`8da9418d12e5561d...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-powerpc64-linux-gnu.tar.gz) |\n| *-riscv64-linux-gnu-debug.tar.gz | [`c2937e060b74e215...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-riscv64-linux-gnu-debug.tar.gz) | [`6189dc10a8fa1ddf...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-riscv64-linux-gnu-debug.tar.gz) |\n| *-riscv64-linux-gnu.tar.gz | [`6d23f4f6251bf6c4...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-riscv64-linux-gnu.tar.gz) | [`05a34b2405ffd231...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-riscv64-linux-gnu.tar.gz) |\n| *-x86_64-apple-darwin-codesigning.tar.gz | [`df215521d1c8fdf9...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-x86_64-apple-darwin-codesigning.tar.gz) | [`d73a7e4711e6fffb...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-x86_64-apple-darwin-codesigning.tar.gz) |\n| *-x86_64-apple-darwin-unsigned.tar.gz | [`d6c812fdc9ccaacc...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-x86_64-apple-darwin-unsigned.tar.gz) | [`e2065729d1c75792...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-x86_64-apple-darwin-unsigned.tar.gz) |\n| *-x86_64-apple-darwin-unsigned.zip | [`22a87644fc7e889b...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-x86_64-apple-darwin-unsigned.zip) | [`389c30d84be3e82e...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-x86_64-apple-darwin-unsigned.zip) |\n| *-x86_64-linux-gnu-debug.tar.gz | [`0bc049eb0bc995e6...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-x86_64-linux-gnu-debug.tar.gz) | [`bfce972dfcf2a82e...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-x86_64-linux-gnu-debug.tar.gz) |\n| *-x86_64-linux-gnu.tar.gz | [`40b2ca54189f86d2...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc-x86_64-linux-gnu.tar.gz) | [`df782b376745bd60...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795-x86_64-linux-gnu.tar.gz) |\n| *.tar.gz | [`97e0d03982493bef...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/bitcoin-9a887baadebc.tar.gz) | [`df44462a303ea747...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/bitcoin-a443d9a83795.tar.gz) |\n| SHA256SUMS.part | [`4890017f5dc45ba9...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/SHA256SUMS.part) | [`b504a36d7c6a0a9a...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/SHA256SUMS.part) |\n| guix_build.log | [`ce6093588c6ed8e9...`](https://drahtbot.space/guix/monotree/9a887baadebce7c2e76df831fad54c5fa81d309e/guix_build.log) | [`ddf8f757093329db...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/guix_build.log) |\n| guix_build.log.diff |  | [`67cc0aa128a6c864...`](https://drahtbot.space/guix/monotree/a443d9a83795584d3b7e94d63ca73a0a4c2b6150/guix_build.log.diff) |\n\n",
          "created_at": "2025-05-21T06:55:17Z"
        },
        {
          "user": "fanquake",
          "body": "Guix Build:\r\n```bash\r\nd899fe5104a77d8c86d40518cb872e8200142e5711689a7bec1e116fcb1807af  guix-build-800b7cc42ca6/output/aarch64-linux-gnu/SHA256SUMS.part\r\n8f81b2cd236c0116937b950964f1a4a88c0fdf1baf0d859c055153c4fceddcdc  guix-build-800b7cc42ca6/output/aarch64-linux-gnu/bitcoin-800b7cc42ca6-aarch64-linux-gnu-debug.tar.gz\r\n43812573c4d833df3cae58332dfd632afedd428fc0c46a403b872bdfb344bfb7  guix-build-800b7cc42ca6/output/aarch64-linux-gnu/bitcoin-800b7cc42ca6-aarch64-linux-gnu.tar.gz\r\n1e93c16fa60545e3103ee16ab4e251326dafdddb193a9e8b88bb6410edde5cd8  guix-build-800b7cc42ca6/output/arm-linux-gnueabihf/SHA256SUMS.part\r\n6f260d7bb26fe76ab637d751bd390fb4f5a8aaea405f3c3b05b33bc7eb1f5266  guix-build-800b7cc42ca6/output/arm-linux-gnueabihf/bitcoin-800b7cc42ca6-arm-linux-gnueabihf-debug.tar.gz\r\n028d88df8073b27b109f25d6ccc25cabf27dee837562c49e4a456fda96b31a11  guix-build-800b7cc42ca6/output/arm-linux-gnueabihf/bitcoin-800b7cc42ca6-arm-linux-gnueabihf.tar.gz\r\n9042f5fe09b0d61120ca2dda5488e7a1acc93ac1b2e66dd8a8f3107a4fae4700  guix-build-800b7cc42ca6/output/arm64-apple-darwin/SHA256SUMS.part\r\n073fe6a231024932d38d9126cb2d5926e96384cb3ea544d03e6f5b8a53db72e6  guix-build-800b7cc42ca6/output/arm64-apple-darwin/bitcoin-800b7cc42ca6-arm64-apple-darwin-codesigning.tar.gz\r\nf017e990180322579b21214cb2cc6b9a183dc43b5f11f14aaef8633009673726  guix-build-800b7cc42ca6/output/arm64-apple-darwin/bitcoin-800b7cc42ca6-arm64-apple-darwin-unsigned.tar.gz\r\n14e2c8c7aece407c6225194374ab90b4604532cd870502ac4b3915821967fcf2  guix-build-800b7cc42ca6/output/arm64-apple-darwin/bitcoin-800b7cc42ca6-arm64-apple-darwin-unsigned.zip\r\nee33c3391262e4c897a85d7b2f033743e70825378157d3a621ff8055e39f3b69  guix-build-800b7cc42ca6/output/dist-archive/bitcoin-800b7cc42ca6.tar.gz\r\nb1f54424ce1c6cf3380f4d5ad99d181c52753ecb3c61ae8e34f40b2ee643ef0e  guix-build-800b7cc42ca6/output/powerpc64-linux-gnu/SHA256SUMS.part\r\n6b1c52ca508144aa5ea911a0d95a96973fca647eb9033cf6d09f1e7ada478c17  guix-build-800b7cc42ca6/output/powerpc64-linux-gnu/bitcoin-800b7cc42ca6-powerpc64-linux-gnu-debug.tar.gz\r\n505a6998e67b2cda843f85d3194b836910a1a33f54511650d1736c309765fbc7  guix-build-800b7cc42ca6/output/powerpc64-linux-gnu/bitcoin-800b7cc42ca6-powerpc64-linux-gnu.tar.gz\r\nade36e9cf2f3b06e1d9bbb1a45e4806296656441c237a2b04dc649f8631a576e  guix-build-800b7cc42ca6/output/riscv64-linux-gnu/SHA256SUMS.part\r\nbe44082f545987aef1783e8fdc19c99f02324b89ab1e94c6081bd27db74228b5  guix-build-800b7cc42ca6/output/riscv64-linux-gnu/bitcoin-800b7cc42ca6-riscv64-linux-gnu-debug.tar.gz\r\ne826c85054bbcedce5de8121467179f5d3eb9d7973c22508c6e0c04d70c38909  guix-build-800b7cc42ca6/output/riscv64-linux-gnu/bitcoin-800b7cc42ca6-riscv64-linux-gnu.tar.gz\r\nce3a0948679d6effac6323693b935e048bf5ecaf268e4d95710f7e3e6a2bd5be  guix-build-800b7cc42ca6/output/x86_64-apple-darwin/SHA256SUMS.part\r\nefad91469e957bf90af9a62bdc94df1241f23e51715f0da8fecb8de9c3e4f0bc  guix-build-800b7cc42ca6/output/x86_64-apple-darwin/bitcoin-800b7cc42ca6-x86_64-apple-darwin-codesigning.tar.gz\r\n8f763359ae3b1cd638cd83f51e7baa07903fe307fd17502faba48959405bb241  guix-build-800b7cc42ca6/output/x86_64-apple-darwin/bitcoin-800b7cc42ca6-x86_64-apple-darwin-unsigned.tar.gz\r\n8d8ce884550ad5054c773157bdc11b7f5192a9075f2b6247688e580706a596dd  guix-build-800b7cc42ca6/output/x86_64-apple-darwin/bitcoin-800b7cc42ca6-x86_64-apple-darwin-unsigned.zip\r\nacff10fa6e8e86811dff20ce7420c220cec55dfe3eb24d427ffc766dc2079be6  guix-build-800b7cc42ca6/output/x86_64-linux-gnu/SHA256SUMS.part\r\nd6d30f4888fcc4d19916d5a6c774a22a0a216d64588950893746a9c0ce919dca  guix-build-800b7cc42ca6/output/x86_64-linux-gnu/bitcoin-800b7cc42ca6-x86_64-linux-gnu-debug.tar.gz\r\n8a78a2d009c0fef11274ea47a6a46dbeb6effe8aca82ea9aea71b5abbb1b5207  guix-build-800b7cc42ca6/output/x86_64-linux-gnu/bitcoin-800b7cc42ca6-x86_64-linux-gnu.tar.gz\r\n8de26cd66a67a029f06b71661ab64233f380b109b211ce9d26e02ef4634673f0  guix-build-800b7cc42ca6/output/x86_64-w64-mingw32/SHA256SUMS.part\r\n8d66924d1b0f23a9e9cb48b051702ba851d9753cb093f25bca712d0c3b1add11  guix-build-800b7cc42ca6/output/x86_64-w64-mingw32/bitcoin-800b7cc42ca6-win64-codesigning.tar.gz\r\n4acd6691ea9c913e5065380c26f06918e475ded290e111584e6a6ac5b77e5185  guix-build-800b7cc42ca6/output/x86_64-w64-mingw32/bitcoin-800b7cc42ca6-win64-debug.zip\r\n60d4293e162455b6cc329072199dee750e5a1afbc6017307b447dd556b23e6ee  guix-build-800b7cc42ca6/output/x86_64-w64-mingw32/bitcoin-800b7cc42ca6-win64-setup-unsigned.exe\r\n9024c5428fcdd695808d2b105fc3f1b52210b8ec5af3ee407e884c7927adb99e  guix-build-800b7cc42ca6/output/x86_64-w64-mingw32/bitcoin-800b7cc42ca6-win64-unsigned.zip\r\n```",
          "created_at": "2025-05-21T13:25:07Z"
        },
        {
          "user": "fanquake",
          "body": "Only 800b7cc42ca63f2a6b245a4d327c7092289da6e1 needs backporting here.",
          "created_at": "2025-05-22T09:01:31Z"
        },
        {
          "user": "fanquake",
          "body": "Backported to 29.x in #32589.",
          "created_at": "2025-05-22T13:57:49Z"
        }
      ]
    },
    {
      "number": 32550,
      "title": "cmake: Add missed `SSE41_CXXFLAGS`",
      "body": "The missed flags were noticed when building with clang-cl on Windows.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-05-18T13:47:26Z",
      "updated_at": "2025-06-27T18:14:59Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/32550",
      "labels": [
        "Build system"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32550.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-18T13:47:29Z"
        },
        {
          "user": "fanquake",
          "body": "Just roll this into #32551?",
          "created_at": "2025-05-19T12:57:23Z"
        },
        {
          "user": "hebasto",
          "body": "> Just roll this into #32551?\r\n\r\nDone.",
          "created_at": "2025-05-19T13:59:40Z"
        }
      ]
    },
    {
      "number": 32547,
      "title": "Mining: Avoid copying template CBlocks",
      "body": "Refactoring to avoid unnecessary copies/complexity, at least in the mainnet paths.\r\n\r\nAlso abstracts out a new `TemplateToJSON` function to keep track of variable scoping better.",
      "state": "closed",
      "user": "luke-jr",
      "created_at": "2025-05-18T09:39:09Z",
      "updated_at": "2025-10-24T14:30:09Z",
      "comments": 12,
      "url": "https://github.com/bitcoin/bitcoin/pull/32547",
      "labels": [
        "Mining",
        "Needs rebase"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32547.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept NACK | [Sjors](https://github.com/bitcoin/bitcoin/pull/32547#issuecomment-3443124185) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#33421](https://github.com/bitcoin/bitcoin/pull/33421) (node: add `BlockTemplateCache` by ismaelsadeeq)\n* [#29415](https://github.com/bitcoin/bitcoin/pull/29415) (Broadcast own transactions only via short-lived Tor or I2P connections by vasild)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-18T09:39:11Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `lint`: https://github.com/bitcoin/bitcoin/runs/42427675996</sub>\n<sub>LLM reason (‚ú® experimental): The CI failure is caused by linting errors, including spelling mistakes and duplicate includes.\n</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-05-18T09:50:52Z"
        },
        {
          "user": "Sjors",
          "body": "Concept ACK on adding a `TemplateToJSON` helper, as well as the new alias for `BlockAssembler::Options`.\r\n\r\nThis breaks the multiprocess build somehow, cc @ryanofsky, e.g.\r\n\r\n```\r\n[06:00:12.877] /ci_container_base/src/interfaces/mining.h:54:34: note: unimplemented pure virtual method 'getCoinbaseMerklePath' in 'ProxyClient'\r\n[06:00:12.877]    54 |     virtual std::vector<uint256> getCoinbaseMerklePath() const = 0;\r\n```",
          "created_at": "2025-05-19T07:57:02Z"
        },
        {
          "user": "ryanofsky",
          "body": "I think goals of this PR should be achievable without too much work, but unfortunately the implementation as of 39a3b5be3d138c8f3f7cc4d5bd22c1bd42f4d525 isn't really compatible with IPC so a different approach needs to be taken. There are two problems currently:\r\n\r\n1. First, the pure virtual methods cannot be marked const. In general it doesn't make sense to mark virtual methods const, because parent classes can't know how subclasses will implement the virtual methods and what state they may access. The point of pure virtual methods is usually to declare abstract interfaces without leaking information about implementations or making assumptions about them.\r\n\r\n2. Methods called over IPC can't return raw pointers or references by default, without additional custom code. It's fine for IPC methods to return ordinary primitive or struct values, or shared_ptr or unique_ptr values, but generated IPC methods like `getBlock` and `getCoinbaseCommitment` can't automatically return raw pointers or references, because after they receive the block data or coinbase commitment data over the socket, then need to return values that can be safely accessed and cleaned up by callers. They can't just return references directly to the received socket data because that data will no longer be available after the methods return. So if they return references they need to copy the data somewhere where it won't be freed right away, but will be freed eventually (to not leak memory), and that requires writing custom code and tracking additional state.\r\n\r\nI also don't know motivation for TemplateToJSON and BlockCreateOptions changes in this PR:\r\n\r\n- I think the point of making the CBlockTemplate::Options struct distinct from the BlockCreateOptions struct, while inheritiing from it, was that BlockCreateOptions was supposed to contain high-level options that were exposed to IPC clients, while CBlockTemplate::Options was supposed to contain lower-level options, not exposed externally over IPC, but could be used for internal code and testing. Current PR seems to collapse that distinction, and it is unclear what the goal of the change is.\r\n\r\n- The TemplateToJSON function seems like a nice way to break up code but seems like it should just be taking input data directly instead of an interface pointer that needs to be actively queried. The could make it simpler internally and also allow it to be easily called from contexts where there is only local data and no IPC.\r\n\r\nAll these things together suggest to me that the Mining interface should probably be exposing the CBlockTemplate struct directly and not hiding it behind so many accessor methods. This should allow dropping methods, simplifying the interface, and also making it more efficient by avoiding copies when it is called locally and no IPC is involved.\r\n\r\nThe simplest way to do this would be to add new two accessor methods to `interfaces::BlockTemplate` like:\r\n\r\n```c++\r\n    virtual const CBlockTemplate* getTemplate() { return nullptr; }\r\n    virtual CBlockTemplate getTemplateData() = 0;\r\n```\r\n\r\nwhich could be implemented in `node::BlockTemplateImpl` as:\r\n\r\n```c++\r\n    const CBlockTemplate* getTemplate() override { return m_block_template.get(); }\r\n    CBlockTemplate getTemplateData() override { return *m_block_template; }\r\n```\r\n\r\nThen if the mining interface is being called from inside the local process, `getTemplate()` will return a valid pointer which can be used directly. But if the mining interface is being called from a remote process `getTemplate()` will return null, and `getTemplateData()` can be used to request and copy the data.\r\n\r\nThis should work, but would require clients to take call `getTemplate()` before `getTemplateData()` to be as efficient as possible and avoid unnecessary copies.\r\n\r\nAn alternate approach that would avoid unnecessary copies and be simpler for clients but require a little more complexity in the IPC implementation would be to expose an `interfaces::BlockTemplate` method like\r\n\r\n```c++\r\n    virtual const CBlockTemplate& getTemplate() = 0;\r\n```\r\n\r\nwith a custom implementation that caches the CBlockTemplate internally in the IPC client class so the references it returns will be valid and the data will be freed when the client is destroyed. There are a few examples of this pattern in #10102, but implementing this would requires using some more complicated c++ features like template specialization so would probably recommend trying the simpler approach first.",
          "created_at": "2025-05-19T16:00:03Z"
        },
        {
          "user": "Sjors",
          "body": "> All these things together suggest to me that the Mining interface should probably be exposing the CBlockTemplate struct directly and not hiding it behind so many accessor methods. \r\n\r\nThe original reason for this was so that a Stratum v2 IPC sidecar can fetch the minimal info it needs for a [NewTemplate](https://github.com/stratum-mining/sv2-spec/blob/main/07-Template-Distribution-Protocol.md#72-newtemplate-server---client) message: basically the version field, some parts of the coinbase and its merkle path. It can do this without fetching the full block.\r\n\r\nLater on it turned out that this interface is also very useful for submitting a solution without (again) having to send a full block over the wire. Ditto for an ergonomic way to wait for fees to rise or a new tip to arrive (with multiple clients).\r\n\r\nIf we assume that Stratum v2 sidecar is running on the same machine as the node, which seems pretty likely, the original optimisation might be overkill and it might as well get the full template. However it's also easier for the sidecar implementation if it doesn't have to hold on to these templates.\r\n\r\nAn approach where the sidecar calls `getTemplateData()`, and we drop `getBlockHeader()`,   `getBlock()`, `getCoinbaseTx()` and `getCoinbaseCommitment()` is fine by me. I'm not worried about making the non-sidecar version https://github.com/Sjors/bitcoin/pull/68 less efficient since that approach is deprecated.\r\n\r\nThe only tricky bits are `getWitnessCommitmentIndex()` and `getCoinbaseMerklePath()`, which I'd rather not implement on the sidecar side. We could cache these values in the `CBlockTemplate` struct (as we do with the coinbase SegWit commitment).\r\n\r\n(since #31283 the sidecar doesn't use `getTxFees()` and `getTxSigops()` anymore so those were already on the nomination list for deletion)\r\n\r\ncc @ismaelsadeeq ",
          "created_at": "2025-05-19T17:27:29Z"
        },
        {
          "user": "ryanofsky",
          "body": "re: https://github.com/bitcoin/bitcoin/pull/32547#issuecomment-2891771230\r\n\r\n> > All these things together suggest to me that the Mining interface should probably be exposing the CBlockTemplate struct directly and not hiding it behind so many accessor methods.\r\n\r\nSorry, I did not write that very clearly. I am not suggesting dropping the `interfaces::BlockTemplate` class and only exposing the `CBlockTemplate` struct. I am just suggesting adding a `const CBlockTemplate*` accessor to the interface which could return a pointer to the internal struct and avoid copying. The new accessor could replace some of the other accessors, or just augment them.\r\n\r\nThis would just be a minor change to avoid unnecessary copies, not a broader rethinking of the interface.",
          "created_at": "2025-05-19T18:08:50Z"
        },
        {
          "user": "Sjors",
          "body": "I agree it could just be an addition to the interface, though it also fits well if we want to prune it a bit.",
          "created_at": "2025-05-19T18:39:20Z"
        },
        {
          "user": "luke-jr",
          "body": ">In general it doesn't make sense to mark virtual methods const, because parent classes can't know how subclasses will implement the virtual methods and what state they may access. The point of pure virtual methods is usually to declare abstract interfaces without leaking information about implementations or making assumptions about them.\r\n\r\nThe constness of methods is a property of the interface. It is a way to say calling it will not change the object, and thereby allows using const references.",
          "created_at": "2025-05-20T02:22:40Z"
        },
        {
          "user": "ryanofsky",
          "body": "> The constness of methods is a property of the interface. It is a way to say calling it will not change the object\r\n\r\nYes, I understand the intent of marking `interfaces::BlockTemplate` methods `const` is to say calling those methods will not change the object. And I agree using `const` to prevent changing the object would be a nice goal, but unfortunately that's not what `const` keyword does here.\r\n\r\nMarking the methods `const` does not mark the block template data `const` or do anything that would prevent modifying it. It only makes the interface itself, which is stateless, `const`, and prevents subclasses implementing the interface from modifying their internal state while not preventing them from modifying `CBlockTemplate` data. Specifically it makes it impossible for the IPC subclass to update its IPC state, and does nothing to prevent the non-IPC subclass from modifying the block template because it is accessed through a non-const pointer. (It does look like that pointer could be const but that's orthogonal to whether these methods are const.",
          "created_at": "2025-05-29T15:26:54Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\nüêô This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
          "created_at": "2025-09-23T23:07:33Z"
        },
        {
          "user": "Sjors",
          "body": "NACK\r\n\r\nIf going through the Mining interface in `getblocktemplate` RPC code is actually a problem, i.e. the extra copy takes significant time compared to JSON serialisation), then someone can open a PR to undo that.\r\n\r\nThe `checkBlock()` and `getBlock()` (template) IPC methods are currently indirectly tested through the `getblocktemplate` (`template`) RPC. We don't want to lose that coverage, but since #33201 we have direct test coverage for the IPC interface in [test/functional/interface_ipc.py](https://github.com/bitcoin/bitcoin/blob/master/test/functional/interface_ipc.py). So if that's expanded to (minimally) cover `checkBlock()` and better cover `getBlock()`, I have no objection to bypassing the interface in RPC code.\r\n\r\nI'm less excited about adding `CBlockTemplate* getTemplate()` since that feels like polluting the interface.\r\n",
          "created_at": "2025-10-24T13:18:51Z"
        },
        {
          "user": "achow101",
          "body": "This PR does not seem to have attracted much attention from reviewers. As such, it does not seem important enough right now to keep it sitting idle in the list of open PRs.\r\n\r\nClosing due to lack of interest.",
          "created_at": "2025-10-24T14:30:09Z"
        }
      ]
    },
    {
      "number": 32546,
      "title": ".",
      "body": "<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "closed",
      "user": "ant12334",
      "created_at": "2025-05-18T01:09:06Z",
      "updated_at": "2025-05-18T01:33:17Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/pull/32546",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32546.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-18T01:09:09Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 32548,
      "title": "Unusual \"Wallet requires newer version\" Error with wallet.dat on macOS, Even with Older Client",
      "body": "### Motivation\n\nI am encountering a persistent \"Wallet requires newer version of Bitcoin Core (code -4)\" error when trying to open my wallet.dat file on macOS. This issue occurs even when attempting to open the wallet with Bitcoin Core version 0.21.0.1, which the debug log from a later version (29.0) indicated was the last client version to interact with the wallet.\nEnvironment:\n * Operating System: macOS 15 \n * Bitcoin Core Version Initially Used: 29.0\n * Bitcoin Core Version Tested (Older): 0.21.0.1\nSteps to Reproduce:\n * Launch Bitcoin Core version 29.0.\n * Bitcoin Core attempts to load the wallet located at /Users/mac/Library/Application Support/Bitcoin/wallets/wallet.dat.\n * The error \"Wallet loading failed. Error loading /Users/mac/Library/Application Support/Bitcoin/wallets/wallet.dat: Wallet requires newer version of Bitcoin Core (code -4)\" is displayed.\n * As per troubleshooting suggestions, Bitcoin Core version 0.21.0.1 was downloaded and installed (after backing up the wallet1.dat file and uninstalling the newer version).\n * Launching Bitcoin Core version 0.21.0.1 resulted in the same \"Wallet requires newer version...\" error.\n * The -rescan command was attempted with version 29.0, and the blockchain synced successfully, but the error persists when trying to load wallet1.dat.\n * The -salvagewallet command was attempted with version 0.21.0.1, and it also resulted in the same \"Wallet requires newer version...\" error.\nRelevant Information from debug.log (from Bitcoin Core version 29.0):\n2025-05-18T05:53:16Z Using wallet /Users/mac/Library/Application Support/Bitcoin/wallets/wallet1.dat\n2025-05-18T05:53:16Z init message: Loading wallet‚Ä¶\n2025-05-18T05:53:16Z [wallet.dat] Wallet file version = 10500, last client version = 210201\n2025-05-18T05:53:16Z [wallet.dat] Releasing wallet wallet.dat..\n\nExpected Behavior:\nThe wallet should load successfully, especially with the Bitcoin Core version (0.21.0.1) that the log indicates last used it.\nActual Behavior:\nThe wallet fails to load with a \"newer version required\" error across multiple client versions, including the one that supposedly last used it.\nPossible Implications:\nThis behavior might indicate:\n * A bug in how Bitcoin Core handles certain types of wallet corruption or metadata.\n * An inaccurate reporting of the \"last client version\" in the debug log.\n * A fundamental incompatibility issue that isn't being correctly identified.\nRequest:\nCould the developers investigate this unusual behavior? The persistent \"newer version required\" error even with an older client version suggests a deeper issue that might affect other users in unexpected scenarios. Any insights or potential fixes would be greatly appreciated.\nAdditional Context:\n * The user (me) does not have any backups of the wallet.dat file or a recovery phrase.\n\n### Possible solution\n\nPossible update the qt framework to 6 and release a new version of Bitcoin core sooner than expected.\n\n### Useful Skills\n\n* Compiling Bitcoin Core from source\n* Running the C++ unit tests and the Python functional tests\n* ...\n\n\n### Guidance for new contributors\n\nWant to work on this issue?\n\nFor guidance on contributing, please read [CONTRIBUTING.md](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md) before opening your pull request.\n",
      "state": "closed",
      "user": "l3x3l",
      "created_at": "2025-05-18T10:11:05Z",
      "updated_at": "2025-06-03T20:50:29Z",
      "comments": 39,
      "url": "https://github.com/bitcoin/bitcoin/issues/32548",
      "labels": [
        "Wallet",
        "Data corruption",
        "Questions and Help"
      ]
    }
  ],
  "summary": {
    "pull_requests": 7,
    "issues": 1
  }
}