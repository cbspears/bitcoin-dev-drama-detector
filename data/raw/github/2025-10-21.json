{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T20:24:44.402543+00:00",
  "date": "2025-10-21",
  "pull_requests": [
    {
      "number": 33672,
      "title": "qt: Increase tooltip wrap threshold from 80 to 100 characters",
      "body": "## Summary\r\nThis PR increases the tooltip wrap threshold from 80 to 100 characters to improve user experience.\r\n\r\n## Changes\r\n- Modified `TOOLTIP_WRAP_THRESHOLD` constant in `src/qt/guiconstants.h`\r\n- Changed value from 80 to 100 characters\r\n\r\n## Rationale\r\nThe previous threshold of 80 characters was too restrictive for modern displays and longer descriptive tooltips. This change allows more content to be displayed before tooltips are converted to rich text format.\r\n\r\n## Testing\r\n- No linter errors introduced\r\n- Change is minimal and low-risk\r\n- Improves UI/UX for longer tooltips\r\n\r\n## Type of Change\r\n- [x] UI/UX improvement\r\n- [x] Low-risk change\r\n- [x] No breaking changes",
      "state": "closed",
      "user": "ilkinsufi",
      "created_at": "2025-10-21T18:43:22Z",
      "updated_at": "2025-10-21T18:54:09Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/pull/33672",
      "labels": [
        "GUI"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33672.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-10-21T18:43:27Z"
        },
        {
          "user": "hebasto",
          "body": "Please move this PR to the GUI repo: https://github.com/bitcoin-core/gui/pulls.",
          "created_at": "2025-10-21T18:44:34Z"
        }
      ]
    },
    {
      "number": 33671,
      "title": "wallet: Add separate balance info for non-mempool wallet txs",
      "body": "Changes `getbalances` to report the sum of txos spent by transactions that aren't confirmed nor in the mempool (eg due to being part of too long a mempool chain, or spending non-standard outputs, or having a datacarrier output that exceeds `-datacarriersize`, etc). Those values are added to the trusted/untrusted_pending/immature/used fields as appropriate (where previously they were skipped), and subtracted from the new nonmempool field, so that the sum of all fields remains the same.\r\n\r\nFor example:\r\n\r\n```\r\n$ bitcoin-cli -regtest getbalances\r\n{\r\n  \"mine\": {\r\n    \"trusted\": 6049.99999220,\r\n    \"untrusted_pending\": 0.00000000,\r\n    \"immature\": 3200.00000780,\r\n    \"nonmempool\": -100.00000000\r\n  },\r\n  \"lastprocessedblock\": {\r\n    \"hash\": \"3ab4582226d5e8ad76438db48d76e822c31bce2cdbc7ba82a5d974a277515d0d\",\r\n    \"height\": 221\r\n  }\r\n}\r\n```\r\n\r\nCloses #11887",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2025-10-21T16:59:13Z",
      "updated_at": "2026-01-08T05:49:22Z",
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/pull/33671",
      "labels": [
        "Wallet"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33671.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept NACK | [achow101](https://github.com/bitcoin/bitcoin/pull/33671#issuecomment-3554858459) |\n| Concept ACK | [vasild](https://github.com/bitcoin/bitcoin/pull/33671#pullrequestreview-3415535438), [RandyMcMillan](https://github.com/bitcoin/bitcoin/pull/33671#issuecomment-3511602426) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#bitcoin-core/gui/911](https://github.com/bitcoin-core/gui/pull/911) (Adds non-mempool wallet balance to overview by ajtowns)\n* [#27865](https://github.com/bitcoin/bitcoin/pull/27865) (wallet: Track no-longer-spendable TXOs separately by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (‚ú® experimental)\n\n\n\nPossible places where comparison-specific test macros should replace generic comparisons:\n\n- test/functional/wallet_send.py: assert from_wallet.getbalances()[\"mine\"][\"nonmempool\"] < 0 -> recommendation: replace with a comparison macro, e.g. assert_greater_than(0, from_wallet.getbalances()[\"mine\"][\"nonmempool\"])\n\n\n\n<sup>2026-01-07</sup>\n",
          "created_at": "2025-10-21T16:59:18Z"
        },
        {
          "user": "ajtowns",
          "body": "Relevant for #29415 -- private relay of our wallet transactions would create spends that weren't in the mempool and would thus disappear mysteriously from the wallet balance which seems unacceptable. I think I've seen similar behaviour when doing lots of consolidations of my signet wallet, which has also been disturbing.\r\n\r\nPerhaps see #11020 for a similar previous attempt.\r\n\r\n~~This PR currently doesn't include tests that this works sensibly for nonzero nonmempool balances, hence wip/draft.~~",
          "created_at": "2025-10-21T17:03:52Z"
        },
        {
          "user": "RandyMcMillan",
          "body": "Concept ACK",
          "created_at": "2025-11-10T13:18:23Z"
        },
        {
          "user": "ajtowns",
          "body": "> This extends the `getbalances` RPC. Would be good to also update the GUI (not necessary in this PR).\r\n\r\nOkay, I have a patch for that opened as draft at bitcoin-core/gui#911 \r\n\r\n> The new type of transactions would have somehow to be fed to the wallet so that they would be returned by `wallet.GetTXOs()`, called by `GetBalance()`. How would that be done?\r\n\r\nI don't think there's a way to do this for arbitrary txs that originate outside of the wallet, even if they involve a wallet address. Maybe there should be? (ie, an RPC that lets you pass raw tx to `AddToWalletIfInvolvingMe` ?)\r\n\r\nBut for txs that are created by the wallet, eg `send` or `sendall` rpc, then I believe they'll be added to the wallet via `CommitTransaction` which will also invoke `SubmitTxMemoryPoolAndRelay()` which in turn invokes `broadcastTransaction`.\r\n\r\nYou can create non-mempool txs by limiting `-datacarriersize` on startup, then using `bitcoin-cli send` to create a tx with a `{\"data\":\"deadbeef...\"}` output that exceeds the datacarriersize you set. Those will not be rejected by the rpc, and will enter the wallet as described above, but not enter the mempool. If you restart with a sufficiently larger datacarriersize, the tx will enter the mempool (and be trusted, since it's from you, to you).\r\n\r\nI've added a test to wallet_send.py that exercises this behaviour.",
          "created_at": "2025-11-19T01:21:09Z"
        },
        {
          "user": "achow101",
          "body": "Concept NACK-ish\r\n\r\nThere's a lot of reasons that an unconfirmed transaction might be in the wallet but not the mempool, and I think giving an accurate balance of those transactions will be hard to get right. We absolutely do not want to mislead users into thinking they have more coins than they actually do, so I am hesitant to add something like this.\r\n\r\nFrom a cursory glance at the code, I think 2 transactions that conflict with each other but aren't in the mempool would both get counted towards the `nonmempool` balance, and which I think is incorrect. But in that case, which one should be counted, if at all?",
          "created_at": "2025-11-19T22:20:33Z"
        },
        {
          "user": "ajtowns",
          "body": "> Concept NACK-ish\r\n> \r\n> There's a lot of reasons that an unconfirmed transaction might be in the wallet but not the mempool, and I think giving an accurate balance of those transactions will be hard to get right. We absolutely do not want to mislead users into thinking they have more coins than they actually do, so I am hesitant to add something like this.\r\n\r\nWe currently mislead users into thinking they have less coins than they actually do (due to transactions in the wallet with long mempool chains, eg), which is very scary, and (IMO) very bad from an accounting POV. So I don't think the current state is acceptable either.\r\n\r\nThe underlying problem (IMO) is that the accounting is unbalanced: if we see two transactions (A,B) in the wallet, where B spends A (via `IsSpent()`) but B is not in the mempool, then because B spends A we will ignore our funds from A (believing it's spent by B) but we will also ignore our funds from B (believing it's not a real tx). There's two ways to fix that: we could not ignore the funds that are still in A, or we could not ignore the funds that are in B. Currently this PR tries not ignoring the funds in B.\r\n\r\n> From a cursory glance at the code, I think 2 transactions that conflict with each other but aren't in the mempool would both get counted towards the `nonmempool` balance, and which I think is incorrect. But in that case, which one should be counted, if at all?\r\n\r\nThat's accurate:\r\n\r\n```\r\n$ bitcoin-cli -regtest -named send outputs='{\"bcrt1qperny2w6xvfkjvec44w4qtwwk3ykuw9py0ejrp\": 1.0, \"data\": \"54686520717569636b2062726f776e20666f78206a756d7073206f76657220746865206c617a7920646f67\"}' fee_rate=1 inputs='[{\"txid\":\"a6e88286d165dbe4f4aab7830f7b68931ef7f5b66d32f0ea573d906594ad6a0c\",\"vout\":0}]'\r\n{\r\n  \"txid\": \"42ef1c7d7c2afee4bb2519fbfcf284ef40ae156ea193ce86a1fa670183a12322\",\r\n  \"complete\": true\r\n}\r\n$ bitcoin-cli -regtest -named send outputs='{\"bcrt1qperny2w6xvfkjvec44w4qtwwk3ykuw9py0ejrp\": 2.0, \"data\": \"54686520717569636b2062726f776e20666f78206a756d7073206f76657220746865206c617a7920646f67\"}' fee_rate=2 inputs='[{\"txid\":\"a6e88286d165dbe4f4aab7830f7b68931ef7f5b66d32f0ea573d906594ad6a0c\",\"vout\":0}]'\r\n{\r\n  \"txid\": \"ebbd3bf4807d8e5683d124cd726de982a4f36e2bae264ff5b91545dae41bacbe\",\r\n  \"complete\": true\r\n}\r\n$ bitcoin-cli -regtest getbalances\r\n{\r\n  \"mine\": {\r\n    \"trusted\": 450.00000000,\r\n    \"untrusted_pending\": 0.00000000,\r\n    \"immature\": 5000.00000000,\r\n    \"nonmempool\": 99.99999415\r\n  },\r\n  \"lastprocessedblock\": {\r\n    \"hash\": \"33e1b4932fb3a464aef972470ffed7650795a35f26214cfa58f76a787d548768\",\r\n    \"height\": 110\r\n  }\r\n}\r\n```\r\n\r\nie spending a single 50 rBTC output twice suddenly gets reported as ~100 rBTC ex fees.\r\n\r\nI don't think there's an easy way to avoid that with the \"don't ignore B's funds\" approach: if you have confirmed utxos A (1 BTC), B (2 BTC), C (3 BTC), you could have non-mempool txs D spending A,B (3 BTC out, 2.9 BTC change) and E spending A,C (4 BTC 3.8 BTC change). You subtract 6 BTC from your balance because each of A,B,C have non-abandoned, non-block/mempool-conflicted spends in the wallet, but if D were to confirm you should add 5.9 BTC (D+C), if E were to confirm you should add 5.8 BTC (E+B), and if you pretended both were to confirm you'd add 6.7 BTC (D+E).\r\n\r\nThe other approach, then, is to say \"D and E aren't in the mempool, so A B and C aren't -really- spent\", and not remove the 6 BTC from A,B,C from your balance; though IMO it still makes sense to separate those out into \"possibly-spent-by-nonmempool-txs\". I believe that easily avoids the double counting if you have conflicting possible spends.\r\n\r\nWith that approach, if I spend an immature coinbase, that changes my balances from:\r\n\r\n```\r\n$ bitcoin-cli -regtest getbalances\r\n{\r\n  \"mine\": {\r\n    \"trusted\": 450.00000000,\r\n    \"untrusted_pending\": 0.00000000,\r\n    \"immature\": 5000.00000000,\r\n    \"nonmempool\": 50.00000000\r\n  },\r\n  \"lastprocessedblock\": {\r\n    \"hash\": \"33e1b4932fb3a464aef972470ffed7650795a35f26214cfa58f76a787d548768\",\r\n    \"height\": 110\r\n  }\r\n}\r\n$ bitcoin-cli -regtest getbalances\r\n{\r\n  \"mine\": {\r\n    \"trusted\": 450.00000000,\r\n    \"untrusted_pending\": 0.00000000,\r\n    \"immature\": 4950.00000000,\r\n    \"nonmempool\": 100.00000000\r\n  },\r\n  \"lastprocessedblock\": {\r\n    \"hash\": \"33e1b4932fb3a464aef972470ffed7650795a35f26214cfa58f76a787d548768\",\r\n    \"height\": 110\r\n  }\r\n}\r\n```\r\n\r\nDouble spending the same tx at that point doesn't change the result. If I do the \"A,B,C\" (50 rBTC each) spent by conflicting \"D,E\", I get:\r\n\r\n```\r\n$ bitcoin-cli -regtest getbalances\r\n{\r\n  \"mine\": {\r\n    \"trusted\": 5949.99999220,\r\n    \"untrusted_pending\": 0.00000000,\r\n    \"immature\": 3200.00000780,\r\n    \"nonmempool\": 100.00000000\r\n  },\r\n  \"lastprocessedblock\": {\r\n    \"hash\": \"3ab4582226d5e8ad76438db48d76e822c31bce2cdbc7ba82a5d974a277515d0d\",\r\n    \"height\": 221\r\n  }\r\n}\r\n...\r\n$ bitcoin-cli -regtest getbalances\r\n{\r\n  \"mine\": {\r\n    \"trusted\": 5899.99999220,\r\n    \"untrusted_pending\": 0.00000000,\r\n    \"immature\": 3200.00000780,\r\n    \"nonmempool\": 150.00000000\r\n  },\r\n  \"lastprocessedblock\": {\r\n    \"hash\": \"3ab4582226d5e8ad76438db48d76e822c31bce2cdbc7ba82a5d974a277515d0d\",\r\n    \"height\": 221\r\n  }\r\n}\r\n```\r\n\r\nThat approach is still \"misleading\" in the sense that those nonmempool txs are reported as how much money you're spending, rather than how much you're potentially keeping as change if those spends go through.\r\n\r\nAnother approach would be to report it as:\r\n\r\n```\r\ntrusted: 6049.99\r\nuntrusted_pending: 0\r\nimmature: 3200\r\nnonmempool-pending: -150\r\n```\r\n\r\nie \"your balance is this, but you have X funds that are currently not in your mempool that you might lose some/all of\"\r\n\r\nCould also perhaps do it more fine-grained as:\r\n\r\n```\r\ntrusted: 6049.99 [-100 non-mempool spends]\r\nuntrusted_pending: 0\r\nimmature: 3200 [-50 non-mempool spends]\r\n```\r\n\r\n[EDIT: You could perhaps also account for locked coins similarly to non-mempool spends, which might be logical if you're locking coins because you're spending them elsewhere in ways you don't expect will make it to your mempool]\r\n\r\nHappy to switch to one of those approaches, or something else, if that seems more acceptable.",
          "created_at": "2025-11-20T00:56:11Z"
        },
        {
          "user": "achow101",
          "body": "> Another approach would be to report it as:\r\n> \r\n> ```\r\n> trusted: 6049.99\r\n> untrusted_pending: 0\r\n> immature: 3200\r\n> nonmempool-pending: -150\r\n> ```\r\n> \r\n> ie \"your balance is this, but you have X funds that are currently not in your mempool that you might lose some/all of\"\r\n\r\nI would prefer this approach and docs just need to be clear that some of that amount may come back as change.",
          "created_at": "2025-11-21T20:40:15Z"
        },
        {
          "user": "ajtowns",
          "body": "Okay, so when a \"transfer to self\" tx paying 1310 sats in fees from 100 BTC of inputs doesn't hit the mempool, it currently looks like:\r\n\r\n```json\r\n{\r\n  \"mine\": {\r\n    \"trusted\": 5949.99999220,\r\n    \"untrusted_pending\": 0.00000000,\r\n    \"immature\": 3200.00000780\r\n  }\r\n}\r\n```\r\n\r\nvs when the tx does hit the mempool:\r\n\r\n```json\r\n{\r\n  \"mine\": {\r\n    \"trusted\": 6049.99997910,\r\n    \"untrusted_pending\": 0.00000000,\r\n    \"immature\": 3200.00000780\r\n  }\r\n}\r\n```\r\n\r\nThat is, there's 99.9999869 BTC missing from your balance while the transaction is in the wallet but not in the mempool.\r\n\r\nWith the current version of this PR, it now looks like this when the tx is not in the mempool:\r\n\r\n```json\r\n{\r\n  \"mine\": {\r\n    \"trusted\": 6049.99999220,\r\n    \"untrusted_pending\": 0.00000000,\r\n    \"immature\": 3200.00000780,\r\n    \"nonmempool\": -100.00000000\r\n  }\r\n}\r\n```\r\n\r\nSo if you add those figures up, you're still 100 BTC down, but at least you have a clue as to what's going on.\r\n\r\nWhen it does hit the mempool (or gets mined), it becomes:\r\n\r\n```json\r\n{\r\n  \"mine\": {\r\n    \"trusted\": 6049.99997910,\r\n    \"untrusted_pending\": 0.00000000,\r\n    \"immature\": 3200.00000780,\r\n    \"nonmempool\": 0.00000000\r\n  }\r\n}\r\n```\r\n\r\nwhich is the same as previously (with the addtion of nonmempool=0).\r\n\r\nI also refactored it to calculate the \"used\" value directly (ie funds held in coins with addresses that are already spent from, for wallets that care about that), since I couldn't figure out how to get the nonmempool figure correct otherwise, but I think that's an improvement anyway.\r\n\r\nI believe there was a \"bug\" in the `cleanup` decorator for wallet_v3_txs in that coins in a wallet spent by non-mempool wallet txs wouldn't be cleared out by the `sendall` calls. That wasn't showing up in the balance checks previously, but does show up when the nonmempool figures are also reported. Addressed that by abandoning any unconfirmed wallet txs prior to calling `sendall`.",
          "created_at": "2025-11-27T05:46:49Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `test each commit`: https://github.com/bitcoin/bitcoin/actions/runs/19727553059/job/56521733216</sub>\n<sub>LLM reason (‚ú® experimental): Git rebase failed due to uncommitted changes in the index.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-11-27T07:28:35Z"
        }
      ]
    },
    {
      "number": 33670,
      "title": "test: Use unassigned p2p_port instead of hardcoded 60000 in p2p_i2p_ports.py",
      "body": "The goal is to fix https://github.com/bitcoin/bitcoin/issues/30030.\r\n\r\nThe root cause it unclear. However, hard-coding the port to 60000 does not seem ideal anyway. This could break in an unlikely setting where so many functional tests are run, such that the port is occupied. Also, it could fail when `TEST_RUNNER_PORT_MIN` is set sufficiently high. (This is purely theoretical, as I don't think anyone would run a command like this, but on current master it fails, and on this pull it passes: `TEST_RUNNER_PORT_MIN=60000 ./bld-cmake/test/functional/p2p_i2p_ports.py --portseed=0`)\r\n\r\nSo fix those issues (and hopefully also 30030) by using an unoccupied p2p_port.\r\n\r\nThe logic is similar to the `extra_port()` logic in the `feature_bind_extra.py` test.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-10-21T16:32:18Z",
      "updated_at": "2025-10-22T09:03:50Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/pull/33670",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33670.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [laanwj](https://github.com/bitcoin/bitcoin/pull/33670#issuecomment-3430717688), [mzumsande](https://github.com/bitcoin/bitcoin/pull/33670#pullrequestreview-3364100215) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-10-21T16:32:23Z"
        },
        {
          "user": "laanwj",
          "body": "Code review ACK fa20275db32c5b9b0fe35effe2d1cf3d958e7310",
          "created_at": "2025-10-22T06:45:05Z"
        }
      ]
    },
    {
      "number": 33669,
      "title": "Add libbitcoinkernel example files",
      "body": "Many Bitcoin-related libraries (such as libsecp256k1 and other Bitcoin Rust crates) include an examples/ folder that demonstrates proper library usage.\r\n\r\nThese examples are especially valuable because they help users learn by example and reduce the need to consult external documentation.\r\n\r\nThis PR proposes adopting the same approach for libbitcoinkernel.\r\n\r\nFor now, I‚Äôve added two examples for the C library (not the C++ wrapper) to gather feedback. If the approach is well-received, I can add more examples within this PR.\r\n\r\nBuilt on top of https://github.com/bitcoin/bitcoin/pull/30595",
      "state": "closed",
      "user": "w0xlt",
      "created_at": "2025-10-21T14:44:17Z",
      "updated_at": "2025-11-06T00:00:19Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/33669",
      "labels": [
        "Needs rebase"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33669.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/33669#issuecomment-3427265866), [stickies-v](https://github.com/bitcoin/bitcoin/pull/33669#pullrequestreview-3364281398) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#33680](https://github.com/bitcoin/bitcoin/pull/33680) (validation: do not wipe utxo cache for stats/scans/snapshots by l0rinc)\n* [#33455](https://github.com/bitcoin/bitcoin/pull/33455) (CPack by purpleKarrot)\n* [#33247](https://github.com/bitcoin/bitcoin/pull/33247) (build: Remove CMAKE_SKIP_BUILD_RPATH and SKIP_BUILD_RPATH settings by 151henry151)\n* [#33191](https://github.com/bitcoin/bitcoin/pull/33191) (net: Provide block templates to peers on request by ajtowns)\n* [#32953](https://github.com/bitcoin/bitcoin/pull/32953) ([POC] ci: Skip compilation when running static code analysis by hebasto)\n* [#32427](https://github.com/bitcoin/bitcoin/pull/32427) ((RFC) kernel: Replace leveldb-based BlockTreeDB with flat-file based store by TheCharlatan)\n* [#32380](https://github.com/bitcoin/bitcoin/pull/32380) (Modernize use of UTF-8 in Windows code by hebasto)\n* [#31507](https://github.com/bitcoin/bitcoin/pull/31507) (build: Use clang-cl to build on Windows natively by hebasto)\n* [#31382](https://github.com/bitcoin/bitcoin/pull/31382) (kernel: Flush in ChainstateManager destructor by TheCharlatan)\n* [#30595](https://github.com/bitcoin/bitcoin/pull/30595) (kernel: Introduce C header API by TheCharlatan)\n* [#30437](https://github.com/bitcoin/bitcoin/pull/30437) (ipc: add bitcoin-mine test program by ryanofsky)\n* [#30342](https://github.com/bitcoin/bitcoin/pull/30342) (kernel, logging: Pass Logger instances to kernel objects by ryanofsky)\n* [#30214](https://github.com/bitcoin/bitcoin/pull/30214) (refactor: Improve assumeutxo state representation by ryanofsky)\n* [#29700](https://github.com/bitcoin/bitcoin/pull/29700) (kernel, refactor: return error status on all fatal errors by ryanofsky)\n* [#29415](https://github.com/bitcoin/bitcoin/pull/29415) (Broadcast own transactions only via short-lived Tor or I2P connections by vasild)\n* [#28792](https://github.com/bitcoin/bitcoin/pull/28792) (Embed default ASMap as binary dump header file by fjahr)\n* [#26022](https://github.com/bitcoin/bitcoin/pull/26022) (Add util::ResultPtr class by ryanofsky)\n* [#25722](https://github.com/bitcoin/bitcoin/pull/25722) (refactor: Use util::Result class for wallet loading by ryanofsky)\n* [#25665](https://github.com/bitcoin/bitcoin/pull/25665) (refactor: Add util::Result failure values, multiple error and warning messages by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-10-21T14:44:22Z"
        },
        {
          "user": "sedited",
          "body": "Concept ACK\r\n\r\nI have something similar over at http://thecharlatan.ch/kernel-docs/examples.html . Purplelkarrot also suggested to have code examples in the style of https://purplekarrot.github.io/btck/design/naming_conventions.html (at the bottom). The tabbed views between the languages look particularly nice imo. I am not sure if we should host this in this repo though. We discussed having a separate repo (under the bitcoin-core org) to host language bindings, examples, and docs in a coherent fashion.\r\n",
          "created_at": "2025-10-21T15:27:42Z"
        },
        {
          "user": "w0xlt",
          "body": "I wasn‚Äôt aware of the theCharlatan‚Äôs website, but that‚Äôs literally the idea behind this PR ‚Äî the user shouldn‚Äôt need to look for any external resources.\r\nAlso, many other Bitcoin libraries use the `examples` folder pattern.\r\n\r\nThat said, I‚Äôm not opposed to having these examples in another place.",
          "created_at": "2025-10-22T11:48:00Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\nüêô This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
          "created_at": "2025-10-28T23:46:55Z"
        },
        {
          "user": "w0xlt",
          "body": "Closing this PR for now.\r\nIf there‚Äôs further interest in adding these examples to this project, we can reopen it.",
          "created_at": "2025-11-06T00:00:18Z"
        }
      ]
    },
    {
      "number": 33666,
      "title": "ci: Drop libFuzzer from msan fuzz task",
      "body": "libFuzzer is mostly unmaintained (https://llvm.org/docs/LibFuzzer.html#status), and it isn't really needed by the CI tasks. While it provides some additional stats like rss or the max input byte size, they are not essential. Dropping libFuzzer here would also drop the \"60 seconds sanity check\" for empty folders, but I think this is an acceptable price to pay to silence false-positives that were hit for years.\r\n\r\nAlso, there seems to be a history of intermittent false-positive msan warnings (https://github.com/bitcoin/bitcoin/pull/33600#issuecomment-3391921802).\r\n\r\nIt is unclear what exactly is causing the false-positives, so just disable libFuzzer in this task for now, to work around them.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-10-21T09:41:15Z",
      "updated_at": "2025-10-30T13:57:19Z",
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/pull/33666",
      "labels": [
        "Tests",
        "Fuzzing"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33666.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [kevkevinpal](https://github.com/bitcoin/bitcoin/pull/33666#issuecomment-3427109226), [dergoegge](https://github.com/bitcoin/bitcoin/pull/33666#pullrequestreview-3368679605) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-10-21T09:41:22Z"
        },
        {
          "user": "kevkevinpal",
          "body": "ACK [fa70e23](https://github.com/bitcoin/bitcoin/pull/33666/commits/fa70e23de75baaf8c1ef6836ffe8ca73562c8937)\r\n\r\nI've seen false positives before from the msan fuzz task before it makes sense to disable it for now till we find the root cause of the false positives.\r\n\r\n---\r\n\r\nIn this doc it mentions that the maintainers moved on to another project \"centipede\". Is there any motivation to try and support this in Bitcoin Core?\r\n\r\n> libFuzzer is mostly unmaintained (https://llvm.org/docs/LibFuzzer.html#status)",
          "created_at": "2025-10-21T14:53:27Z"
        },
        {
          "user": "maflcko",
          "body": "> centipede\r\n\r\nYes, it would be nice to support it, but at least I couldn't get it running. At least inside oss-fuzz, see also https://github.com/google/oss-fuzz/issues/10434",
          "created_at": "2025-10-21T15:00:54Z"
        },
        {
          "user": "fanquake",
          "body": "@dergoegge @marcofleon any opinion here?",
          "created_at": "2025-10-23T07:18:12Z"
        },
        {
          "user": "dergoegge",
          "body": "I guess the only thing we're loosing here is that if there is a harness with no corpus we won't be doing our short \"sanity\" 60 second fuzz from scratch.\r\n\r\nI know that it is possible to get libFuzzer running with MSan because I'm doing that in my own infra but that is an entirely different setup (e.g. the llvm version is different).\r\n\r\nPerhaps in the future we can re-enable libFuzzer but for now I see no reason not to drop it, given that there are repeated annoying false-positives. Concept ACK.",
          "created_at": "2025-10-23T07:24:14Z"
        },
        {
          "user": "maflcko",
          "body": "Thx, added the sanity drop to the description.",
          "created_at": "2025-10-23T07:44:06Z"
        }
      ]
    },
    {
      "number": 33665,
      "title": "wallet: remove redundant sighash calculation in Musig2 signing flow",
      "body": "In the MuSig2 signing flow, the same sighash ends up being recalculated for all the participant public keys involved in the MuSig aggregate keys. This happens for all the three parts of the signing flow: nonce, partial sig, and aggregate sig.\r\n\r\nThe original intent of this refactor to reduce seeing duplicate code, but it should also help in improving performance of the wallet signing operations.\r\n\r\nThis was highlighted during the review of the MuSig2\r\nsigning PR: https://github.com/bitcoin/bitcoin/pull/29675#discussion_r2382674470\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "closed",
      "user": "rkrux",
      "created_at": "2025-10-21T07:17:34Z",
      "updated_at": "2025-11-24T14:21:42Z",
      "comments": 8,
      "url": "https://github.com/bitcoin/bitcoin/pull/33665",
      "labels": [
        "Wallet"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33665.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [Raimo33](https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3431076499), [optout21](https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3475833560) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32876](https://github.com/bitcoin/bitcoin/pull/32876) (refactor: use options struct for signing and PSBT operations by Sjors)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-10-21T07:17:40Z"
        },
        {
          "user": "fanquake",
          "body": "https://github.com/bitcoin/bitcoin/actions/runs/18676072881/job/53246386885?pr=33665#step:9:3427:\r\n```bash\r\nRun script_sign with args ['/home/admin/actions-runner/_work/_temp/build/bin/fuzz', '-runs=1', PosixPath('/home/admin/actions-runner/_work/_temp/ci/scratch/qa-assets/fuzz_corpora/script_sign')]INFO: Running with entropic power schedule (0xFF, 100).\r\nINFO: Seed: 2902865681\r\nINFO: Loaded 1 modules   (615865 inline 8-bit counters): 615865 [0x56e10e6f9bb8, 0x56e10e790171), \r\nINFO: Loaded 1 PC tables (615865 PCs): 615865 [0x56e10e790178,0x56e10f0f5d08), \r\nINFO:     4186 files found in /home/admin/actions-runner/_work/_temp/ci/scratch/qa-assets/fuzz_corpora/script_sign\r\nINFO: -max_len is not provided; libFuzzer will not generate inputs larger than 938660 bytes\r\nINFO: seed corpus: files: 4186 min: 9b max: 938660b total: 57347949b rss: 105Mb\r\n#1024\tpulse  cov: 12906 ft: 62748 corp: 979/178Kb exec/s: 512 rss: 162Mb\r\n/home/admin/actions-runner/_work/_temp/src/script/sign.cpp:84:60: runtime error: implicit conversion from type 'int' of value -2147483648 (32-bit, signed) to type 'uint8_t' (aka 'unsigned char') changed the value to 0 (8-bit, unsigned)\r\n    #0 0x56e10bf84088 in MutableTransactionSignatureCreator::ComputeSchnorrSignatureHash(uint256 const*, SigVersion) const /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:84:60\r\n    #1 0x56e10bf9f6d7 in SignMuSig2(BaseSignatureCreator const&, SignatureData&, SigningProvider const&, std::vector<unsigned char, std::allocator<unsigned char>>&, XOnlyPubKey const&, uint256 const*, uint256 const*, SigVersion) /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:285:46\r\n    #2 0x56e10bf8bdd9 in SignTaproot(SigningProvider const&, BaseSignatureCreator const&, WitnessV1Taproot const&, SignatureData&, std::vector<std::vector<unsigned char, std::allocator<unsigned char>>, std::allocator<std::vector<unsigned char, std::allocator<unsigned char>>>>&)::$_0::operator()(XOnlyPubKey const&, uint256 const*) const /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:581:17\r\n    #3 0x56e10bf8bdd9 in SignTaproot(SigningProvider const&, BaseSignatureCreator const&, WitnessV1Taproot const&, SignatureData&, std::vector<std::vector<unsigned char, std::allocator<unsigned char>>, std::allocator<std::vector<unsigned char, std::allocator<unsigned char>>>>&) /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:587:13\r\n    #4 0x56e10bf8bdd9 in SignStep(SigningProvider const&, BaseSignatureCreator const&, CScript const&, std::vector<std::vector<unsigned char, std::allocator<unsigned char>>, std::allocator<std::vector<unsigned char, std::allocator<unsigned char>>>>&, TxoutType&, SigVersion, SignatureData&) /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:703:16\r\n    #5 0x56e10bf86e4c in ProduceSignature(SigningProvider const&, BaseSignatureCreator const&, CScript const&, SignatureData&) /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:734:19\r\n    #6 0x56e10bf956de in SignTransaction(CMutableTransaction&, SigningProvider const*, std::map<COutPoint, Coin, std::less<COutPoint>, std::allocator<std::pair<COutPoint const, Coin>>> const&, int, std::map<int, bilingual_str, std::less<int>, std::allocator<std::pair<int const, bilingual_str>>>&) /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:1050:13\r\n    #7 0x56e10b9c040e in script_sign_fuzz_target(std::span<unsigned char const, 18446744073709551615ul>) /home/admin/actions-runner/_work/_temp/build/src/test/fuzz/./test/fuzz/script_sign.cpp:135:19\r\n    #8 0x56e10bc78e9e in std::function<void (std::span<unsigned char const, 18446744073709551615ul>)>::operator()(std::span<unsigned char const, 18446744073709551615ul>) const /usr/lib/gcc/x86_64-linux-gnu/13/../../../../include/c++/13/bits/std_function.h:591:9\r\n    #9 0x56e10bc78e9e in test_one_input(std::span<unsigned char const, 18446744073709551615ul>) /home/admin/actions-runner/_work/_temp/build/src/test/fuzz/util/./test/fuzz/fuzz.cpp:88:5\r\n    #10 0x56e10bc78e9e in LLVMFuzzerTestOneInput /home/admin/actions-runner/_work/_temp/build/src/test/fuzz/util/./test/fuzz/fuzz.cpp:216:5\r\n    #11 0x56e10b28521f in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1ab321f) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #12 0x56e10b284829 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1ab2829) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #13 0x56e10b286592 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1ab4592) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #14 0x56e10b286ab0 in fuzzer::Fuzzer::Loop(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1ab4ab0) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #15 0x56e10b273135 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1aa1135) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #16 0x56e10b29f4f6 in main (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1acd4f6) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #17 0x7318303981c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 274eec488d230825a136fa9c4d85370fed7a0a5e)\r\n    #18 0x73183039828a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 274eec488d230825a136fa9c4d85370fed7a0a5e)\r\n    #19 0x56e10b267704 in _start (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1a95704) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n```",
          "created_at": "2025-10-21T08:31:00Z"
        },
        {
          "user": "rkrux",
          "body": "Pushed the second commit to fix the fuzz test failures.",
          "created_at": "2025-10-21T17:01:48Z"
        },
        {
          "user": "Raimo33",
          "body": "Concept ACK",
          "created_at": "2025-10-22T08:30:24Z"
        },
        {
          "user": "optout21",
          "body": "Concept ACK 000c685bcdd395d61a58ad9698563cab41e2d7d0\r\n(more review needed)",
          "created_at": "2025-11-01T06:09:50Z"
        },
        {
          "user": "Sjors",
          "body": "Each commit should leave the code in a valid state, so it would make sense to move 000c685bcdd395d61a58ad9698563cab41e2d7d0 up. ",
          "created_at": "2025-11-11T10:25:31Z"
        },
        {
          "user": "achow101",
          "body": "> The original intent of this refactor to reduce seeing duplicate code\r\n\r\nConsidering how much extra is being changed to avoid the duplication, I don't really think this is worth it.\r\n\r\n> but it should also help in improving performance of the wallet signing operations.\r\n\r\nI don't think that's the case. The MuSig2 functions that are all recomputing the same sighash are never actually doing so in the same call to `SignMuSig2`. `CreateMuSig2AggregateSig` exits early when there aren't enough pubnonces or partial sigs, before the sighash is computed. `CreateMuSig2PartialSig` exits early when there aren't enough pubnonces. It really ends up being that the sighash is basically computed once per `SignMuSig2` call before the deduplication anyways. The only situation where it is computed multiple times is if the wallet has multiple keys in the musig, but that should rarely happen.\r\n\r\nThis change also ends up making MuSig2's behavior different from the other signing functions. The MuSig2 signing functions are the only ones which require the caller to provide the sighash. Arguably, for `TransactionSignatureCreateor`, what the sighash is is an internal implementation detail, not something that callers need to know about.",
          "created_at": "2025-11-19T22:57:16Z"
        },
        {
          "user": "rkrux",
          "body": "> The only situation where it is computed multiple times is if the wallet has multiple keys in the musig, but that should rarely happen.\r\n\r\nOne of the reasons that made me raise the PR was this case, but as highlighted it'd occur rarely.\r\n\r\nRe: https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3554963168\r\n\r\nAll these points make sense to me, thus I'm closing this PR.",
          "created_at": "2025-11-24T14:21:41Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 33673,
      "title": ".",
      "body": "### Please describe the feature you'd like to see added.\n\nBitcoin Core\n\n### Is your feature related to a problem, if so please describe it.\n\n_No response_\n\n### Describe the solution you'd like\n\n_No response_\n\n### Describe any alternatives you've considered\n\n_No response_\n\n### Please leave any additional context\n\n_No response_",
      "state": "closed",
      "user": "carlyluminattinetprise-code",
      "created_at": "2025-10-21T23:31:44Z",
      "updated_at": "2025-10-24T08:57:02Z",
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/33673",
      "labels": []
    },
    {
      "number": 33668,
      "title": "ci: Where to run heavy and high-maintenance CI tasks?",
      "body": "There are some heavy, and some possibly high-maintenance CI configs, which may not be productive to run on every pull request. They could be run on just the master branch for every merge?\n\nCome up in the context of:\n\n* https://github.com/bitcoin/bitcoin/pull/33509#issuecomment-3381737041\n* https://github.com/bitcoin/bitcoin/issues/33411#issuecomment-3427032925\n* https://github.com/bitcoin/bitcoin/pull/33461#issuecomment-3437568326\n* https://github.com/bitcoin/bitcoin/pull/33626\n* ... ?\n\nAnd possibly useful for https://github.com/bitcoin/bitcoin/issues/22064#issuecomment-2607120689",
      "state": "open",
      "user": "maflcko",
      "created_at": "2025-10-21T14:42:30Z",
      "updated_at": "2025-10-28T19:01:40Z",
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/issues/33668",
      "labels": [
        "Brainstorming",
        "Tests"
      ],
      "comment_list": [
        {
          "user": "fanquake",
          "body": "I don't really think \"heavy\" should be as much of a blocker as fragile here. There should be scope to expand the amount of CPU dedicated to the CI.",
          "created_at": "2025-10-21T14:47:22Z"
        },
        {
          "user": "maflcko",
          "body": "Good point that if the only issue is the CPU usage, it could be fixed by more CPU. Though, stuff like msan on -O0 is so heavy that it doesn't pass at all on the GHA provided VM after 6 hours, so it will likely be slow enough to not make sense on pull requests at all.",
          "created_at": "2025-10-21T15:14:54Z"
        },
        {
          "user": "m3dwards",
          "body": "> They could be run on just the master branch for every merge\n\nI like this idea for things that are expensive (beyond what can be solved with more CPU / Memory). As for fragile, I'm not sure I like the idea of just running fragile things less over running them regularly to get more data on why they are fragile and hopefully fixing that. That said, fixing fragile CI jobs often takes significant development effort and you can often be left wondering if it was worth the investment over disabling the job or accepting a certain amount of flake. ",
          "created_at": "2025-10-28T15:56:50Z"
        },
        {
          "user": "maflcko",
          "body": "> As for fragile, I'm not sure I like the idea of just running fragile things less over running them regularly to get more data on why they are fragile and hopefully fixing that. That said, fixing fragile CI jobs often takes significant development effort and you can often be left wondering if it was worth the investment over disabling the job or accepting a certain amount of flake.\n\nAh, I think \"fragile\" may not have been the right word. I was not trying to refer to flaky CI tasks with non-deterministic intermittent failures, which happen for all tasks. Instead, I was more referring to tasks that are deterministically failing, albeit with false-positive warnings, or otherwise hard-to-understand and hard-to-act-on error messages, blocking pull requests for unrelated reasons.\n\nI've replace the word to say \"high-maintenance\" instead.",
          "created_at": "2025-10-28T17:17:37Z"
        },
        {
          "user": "m3dwards",
          "body": "> I was more referring to tasks that are deterministically failing, albeit with false-positive warnings, or otherwise hard-to-understand and hard-to-act-on error messages, blocking pull requests for unrelated reasons\n\nAh, in that case, sounds good to run them less frequently üëç",
          "created_at": "2025-10-28T17:51:33Z"
        },
        {
          "user": "maflcko",
          "body": "I went ahead and pushed the msan -O0, and the s390x task to https://github.com/maflcko/bitcoin-core-nightly/actions/runs/18885767497/job/53900576177. However, they are so slow on GHA, that they time out after 6 hours.\n\nPossibly with a CTest Dashboard to upload results, those tasks could be run on faster or at least dedicated hardware without timeouts.",
          "created_at": "2025-10-28T18:59:57Z"
        }
      ]
    },
    {
      "number": 33667,
      "title": "Unable to fuzz in local on MacOS 15.4.1",
      "body": "Reproduction steps as per [libfuzzer](https://github.com/bitcoin/bitcoin/blob/master/doc/fuzzing.md#quickstart-guide):\n```zsh\n$ brew install llvm lld\n$ cmake --preset=libfuzzer \\\n   -DCMAKE_C_COMPILER=\"$(brew --prefix llvm)/bin/clang\" \\\n   -DCMAKE_CXX_COMPILER=\"$(brew --prefix llvm)/bin/clang++\" \\\n   -DCMAKE_EXE_LINKER_FLAGS=\"-fuse-ld=lld\"\n$ cmake --build build_fuzz\n```\n\n\n<details open>\n<summary>\nGetting the following error instead on the last step:\n</summary>\n\n```zsh\n[ 99%] Building CXX object src/test/fuzz/CMakeFiles/fuzz.dir/__/__/wallet/test/fuzz/spend.cpp.o\n[100%] Building CXX object src/test/fuzz/CMakeFiles/fuzz.dir/__/__/wallet/test/fuzz/scriptpubkeyman.cpp.o\n[100%] Building CXX object src/test/fuzz/CMakeFiles/fuzz.dir/__/__/wallet/test/fuzz/wallet_bdb_parser.cpp.o\n[100%] Linking CXX executable ../../../bin/fuzz\nld64.lld: error: undefined symbol: std::__1::__hash_memory(void const*, unsigned long)\n>>> referenced by /Users/rkrux/projects/rkrux/bitcoin/build_fuzz/src/util/./support/lockedpool.cpp\n>>>               ../../../lib/libbitcoin_util.a(lockedpool.cpp.o):(symbol std::__1::pair<std::__1::__hash_iterator<std::__1::__hash_node<std::__1::__hash_value_type<void*, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>, void*>*>, bool> std::__1::__hash_table<std::__1::__hash_value_type<void*, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>, std::__1::__unordered_map_hasher<void*, std::__1::pair<void* const, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>, std::__1::hash<void*>, std::__1::equal_to<void*>, true>, std::__1::__unordered_map_equal<void*, std::__1::pair<void* const, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>, std::__1::equal_to<void*>, std::__1::hash<void*>, true>, std::__1::allocator<std::__1::pair<void* const, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>>>::__emplace_unique_key_args<void*, void*&, std::__1::__map_iterator<std::__1::__tree_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>&>(void* const&, void*&, std::__1::__map_iterator<std::__1::__tree_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>&)+0x100)\n>>> referenced by /Users/rkrux/projects/rkrux/bitcoin/build_fuzz/src/util/./support/lockedpool.cpp\n>>>               ../../../lib/libbitcoin_util.a(lockedpool.cpp.o):(symbol std::__1::unique_ptr<std::__1::__hash_node<std::__1::__hash_value_type<void*, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>, void*>, std::__1::__hash_node_destructor<std::__1::allocator<std::__1::__hash_node<std::__1::__hash_value_type<void*, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>, void*>>>> std::__1::__hash_table<std::__1::__hash_value_type<void*, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>, std::__1::__unordered_map_hasher<void*, std::__1::pair<void* const, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>, std::__1::hash<void*>, std::__1::equal_to<void*>, true>, std::__1::__unordered_map_equal<void*, std::__1::pair<void* const, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>, std::__1::equal_to<void*>, std::__1::hash<void*>, true>, std::__1::allocator<std::__1::pair<void* const, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>>>::__construct_node<char*, std::__1::__map_iterator<std::__1::__tree_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>&>(char*&&, std::__1::__map_iterator<std::__1::__tree_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>&)+0x2d1)\n>>> referenced by /Users/rkrux/projects/rkrux/bitcoin/build_fuzz/src/util/./support/lockedpool.cpp\n>>>               ../../../lib/libbitcoin_util.a(lockedpool.cpp.o):(symbol std::__1::__hash_table<std::__1::__hash_value_type<void*, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>, std::__1::__unordered_map_hasher<void*, std::__1::pair<void* const, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>, std::__1::hash<void*>, std::__1::equal_to<void*>, true>, std::__1::__unordered_map_equal<void*, std::__1::pair<void* const, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>, std::__1::equal_to<void*>, std::__1::hash<void*>, true>, std::__1::allocator<std::__1::pair<void* const, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>>>::__node_insert_unique(std::__1::__hash_node<std::__1::__hash_value_type<void*, std::__1::__map_const_iterator<std::__1::__tree_const_iterator<std::__1::__value_type<unsigned long, void*>, std::__1::__tree_node<std::__1::__value_type<unsigned long, void*>, void*>*, long>>>, void*>*)+0x116)\n>>> referenced 19 more times\nclang++: error: linker command failed with exit code 1 (use -v to see invocation)\nmake[2]: *** [bin/fuzz] Error 1\nmake[1]: *** [src/test/fuzz/CMakeFiles/fuzz.dir/all] Error 2\nmake: *** [all] Error 2\n```\n</details>",
      "state": "closed",
      "user": "rkrux",
      "created_at": "2025-10-21T11:38:26Z",
      "updated_at": "2025-11-21T14:41:23Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/33667",
      "labels": [
        "Docs",
        "macOS",
        "Tests",
        "Fuzzing"
      ],
      "comment_list": [
        {
          "user": "maflcko",
          "body": "There are some prior issues/pulls/discussions:\n\n* https://github.com/bitcoin/bitcoin/pull/32084\n* https://github.com/bitcoin/bitcoin/issues/32089\n\nThough, this one seems to be a new link-time error.",
          "created_at": "2025-10-21T12:59:01Z"
        },
        {
          "user": "fanquake",
          "body": "Looks like this could be https://github.com/Homebrew/homebrew-core/issues/235411.",
          "created_at": "2025-10-25T10:28:01Z"
        },
        {
          "user": "maflcko",
          "body": "So I guess this can be fixed by using the homebrew libc++?",
          "created_at": "2025-10-25T11:06:40Z"
        },
        {
          "user": "maflcko",
          "body": "Closing for now. If someone finds this to be working at some point, they are welcome to add docs for it. In the meantime, please use libfuzzer-nosan, or other stuff, mentioned in https://github.com/bitcoin/bitcoin/pull/33921",
          "created_at": "2025-11-21T14:41:23Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 6,
    "issues": 3
  }
}