{
  "source": "github",
  "repo": "bitcoin/bitcoin",
  "fetched_at": "2026-01-20T08:24:55.213781+00:00",
  "date_range": {
    "since": "2026-01-13T08:24:55.213710+00:00",
    "until": "2026-01-20T08:24:55.213710+00:00"
  },
  "pull_requests": [
    {
      "id": 2584507258,
      "number": 32729,
      "title": "test,refactor: extract script template helpers & widen sigop count coverage",
      "body": "### Summary\r\n\r\nThis PR extracts a set of cheap, inline helpers for recognizing the most common script templates, clarifies the definition of valid op-codes for pre-Taproot scripts, and splits the existing \"deserialize + check-block\" benchmark into three orthogonal micro-benchmarks.  \r\nThe change is behavior-neutral for consensus and policy - every modified call-site performs the same checks as before, just through clearer helper functions.\r\n\r\n### Context\r\n\r\nWhile working on [`GetSigOpCount` optimizations for known script templates](https://github.com/bitcoin/bitcoin/pull/32532) I noticed that feature-test coverage was [thin for this code path](https://maflcko.github.io/b-c-cov/total.coverage/src/script/script.cpp.gcov.html).  \r\nThis PR therefore adds tests for error cases (malformed push-data encodings) and for the expected sigop totals of the various script templates (including edge cases like a sigop after an `OP_RETURN`).\r\n\r\nGiven the difficulty of reviewing the [original optimizations themselves](https://github.com/bitcoin/bitcoin/pull/32532#issuecomment-2950665350), I split all test / benchmark work into this standalone PR.  \r\nThe recent burst of sigops related refactor activity ([#31624](https://github.com/bitcoin/bitcoin/pull/31624), [#32521](https://github.com/bitcoin/bitcoin/pull/32521), [#32533](https://github.com/bitcoin/bitcoin/pull/32533)) underlines the need for extra safety.\r\n\r\nThe refactors here eliminate magic numbers, deduplicate template checks, and lay groundwork for future performance work.\r\n\r\n### Structure\r\n\r\n* **Benchmarks** - first commits separate deserialization+hashing, validation, and sigop counting so each cost can be measured independently.  \r\n* **Template helpers** - tiny, mechanical commits move each script-template check into `script.h`, replace all ad-hoc byte-checks, and add tests where necessary.  \r\n* **Tests** - a full script-test suite covering malformed `PUSHDATA` sequences and the pre-taproot / accurate sigop totals for every standard template.  \r\n* **pre-taproot opcode ceiling** - documents, enforces, and tests that `OP_CHECKSIGADD` > `MAX_OPCODE`.\r\n* **Extra fuzzing** - enabled all possible opcodes in `ConsumeOpcodeType`",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-06-11T14:44:28Z",
      "updated_at": "2026-01-20T08:22:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32729",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2276,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2203477250,
      "number": 31382,
      "title": "kernel: Flush in ChainstateManager destructor",
      "body": "This simplifies the shutdown code a bit and reduces the amount of extra logic required in kernel/bitcoinkernel.cpp to tear down the chainman.\r\n\r\nMoving the second flush out of the Shutdown function into the ChainstateManager destructor, should be safe since there should be no new events created after the first flush. Tweak the chainman tests to actually exercise this new tear down behaviour.\r\n\r\n---\r\n\r\nThis PR is part of the [libbitcoinkernel project](https://github.com/bitcoin/bitcoin/issues/27587)",
      "state": "open",
      "user": "sedited",
      "created_at": "2024-11-27T13:18:50Z",
      "updated_at": "2026-01-20T07:40:01Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31382",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 549,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3190110147,
      "number": 34349,
      "title": "util: Remove brittle and confusing sp::Popen(std::string)",
      "body": "The subprocess Popen call that accepts a full `std::string` has many issues:\r\n\r\n* It promotes brittle and broken code, where spaces are not properly quoted. Example: https://github.com/bitcoin/bitcoin/pull/33929#discussion_r2590523065\r\n* The internally used `util::split` function does incorrectly split on spaces, instead of using `shlex.split`.\r\n* It is redundant and not needed, because a vector interface already exists.\r\n\r\nFix all issues by removing it and just using the vector interface.\r\n\r\nThis pull request should not change any behavior: Note that the command taken from `gArgs.GetArg(\"-signer\", \"\")` is still passes through the `sp::util::split` helper, just like before. Fixing that is left for a follow-up, so that this change here is basically just a refactor.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-20T07:19:24Z",
      "updated_at": "2026-01-20T07:20:02Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34349",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 832,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3037988791,
      "number": 33929,
      "title": "test: Remove `system_tests/run_command` runtime dependencies",
      "body": "`system_tests` currently rely on `cat`, `echo`, `false` and `sh` being available in `PATH` at runtime.\r\n\r\nThis PR:\r\n1. Removes these dependencies.\r\n2. Reduces the number of platform-specific code paths.\r\n\r\nThe change is primarily motivated by my work on maintaining the [`bitcoin-core`](https://packages.guix.gnu.org/packages/bitcoin-core) package in Guix. It enables the removal of the existing `bash` and `coreutils` native inputs, which in turn makes it possible to drop the implicit dependency on `qtbase@5` (see https://codeberg.org/guix/guix/pulls/4386#issuecomment-8613333).",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-11-23T23:03:10Z",
      "updated_at": "2026-01-20T07:19:41Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33929",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 642,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3177024290,
      "number": 34302,
      "title": "fuzz: Restore SendMessages coverage in process_message(s) fuzz targets",
      "body": "*Found and reported by Crypt-iQ (thanks!)*\r\n\r\nCurrently the process_message(s) fuzz targets do not have any meaningful `SendMessages` code coverage. This is not ideal.\r\n\r\nFix the problem by adding back the coverage, and by hardening the code here, so that the problem hopefully does not happen again in the future.\r\n\r\n### Historic context for this regression\r\n\r\nThe regression was introduced in commit fa11eea4059a608f591db4469c07a341fd33a031, which built a new deterministic peerman object. However, the patch was incomplete, because it was missing one hunk to replace `g_setup->m_node.peerman->SendMessages(&p2p_node);` with `peerman->SendMessages(&p2p_node);`.\r\n\r\nThis means the stale and empty peerman from the node context and not the freshly created and deterministic peerman was used.\r\n\r\nA simple fix would be to just submit the missing patch hunk. However, this still leaves the risk that the issue is re-introduced at any time in the future. So instead, I think the stale and empty peerman should be de-constructed, so that any call to it will lead to a hard sanitizer error and fuzz failure.\r\n\r\nDoing that also uncovered another issue: The connman was holding on to a reference to a stale and empty addrman.\r\n\r\nSo fix all issues by:\r\n\r\n* Allowing the addrman reference in connman to be re-seatable\r\n* Clearing all stale objects, before creating new objects, and then using references to the new objects in all code\r\n\r\n",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-15T11:45:59Z",
      "updated_at": "2026-01-20T07:15:28Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34302",
      "labels": [
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1499,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2217053399,
      "number": 31425,
      "title": "RFC: Riscv bare metal CI job",
      "body": "This adds a CI job for building the static consensus library and linking it to an executable. It uses newlib-cygwin as a C library for the final linking step. This ensure compatibility with this target going forward and can serve as a starting point for enabling bare metal builds for the entire kernel library. This would have also caught the error fixed in #31365.",
      "state": "open",
      "user": "sedited",
      "created_at": "2024-12-05T08:30:01Z",
      "updated_at": "2026-01-20T07:11:23Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31425",
      "labels": [
        "Build system",
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 395,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2272618048,
      "number": 31644,
      "title": "leveldb: show non-default options during init",
      "body": "To help with to debugging and traceability (in alignment with displaying other non-default args such as `Command-line arg: dbcache=\"10000\"`) we can extend the LevelDB opening log with an additional debug message for the used non-default settings.\r\n\r\nTo avoid showing booleans as e.g. `create_if_missing=1`, I've added a local `ToString` lambda for `bool`.\r\nI wanted to use `util::Join` at the end, but couldn't find any way that I liked.\r\n\r\nExample output after the change:\r\n```bash\r\n2025-10-15T02:39:45Z Opened LevelDB successfully\r\n2025-10-15T02:39:45Z [leveldb] startup options: options.compression=NoCompression, options.create_if_missing=true, options.max_file_size=33554432, options.paranoid_checks=true, options.write_buffer_size=524288, readoptions.fill_cache=false, readoptions.verify_checksums=true, writeoptions.sync=true\r\n```",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-01-12T17:30:54Z",
      "updated_at": "2026-01-20T06:17:42Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31644",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 883,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2275111412,
      "number": 31650,
      "title": "refactor: Avoid copies by using const references or by move-construction",
      "body": "Top level `const` in declarations is problematic for many reasons:\r\n\r\n* It is often a typo, where one wanted to denote a const reference. For example `bool PSBTInputSignedAndVerified(const PartiallySignedTransaction psbt, ...` is missing the `&`. This will create a redundant copy of the value.\r\n* In constructors it prevents move construction.\r\n* It can incorrectly imply some data is const, like in an imaginary example `std::span<int> Shuffle(const std::span<int>);`, where the `int`s are *not* const.\r\n* The compiler ignores the `const` from the declaration in the implementation.\r\n* It isn't used consistently anyway, not even on the same line.\r\n\r\nFix some issues by:\r\n\r\n* Using a const reference to avoid a copy, where read-only of the value is intended. This is only done for values that may be expensive to copy.\r\n* Using move-construction to avoid a copy\r\n* Applying `readability-avoid-const-params-in-decls` via clang-tidy",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-01-13T20:41:34Z",
      "updated_at": "2026-01-20T06:04:24Z",
      "merged_at": "2026-01-19T11:04:40Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31650",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1005,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2698741395,
      "number": 33072,
      "title": "[p2p] Fix signed integer overflow in LocalServiceInfo::nScore",
      "body": "The `nScore` field in `LocalServiceInfo` struct was defined as `int` (32-bit signed integer), which could overflow from `INT_MAX` (2,147,483,647) to `INT_MIN` (-2,147,483,648) when incremented by `SeenLocal()` during version handshakes. This is undefined behavior in C++ and could affect address selection logic.\r\n\r\nImplement saturation in `SeenLocal()` to cap `nScore` at `std::numeric_limits<int>::max()` instead of allowing overflow. This prevents undefined behavior while maintaining memory efficiency and logical correctness - after 2 billion connections, the matter is settled.\r\n\r\nFixes #24049\r\n",
      "state": "closed",
      "user": "b-l-u-e",
      "created_at": "2025-07-28T01:33:57Z",
      "updated_at": "2026-01-20T05:06:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33072",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 663,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2294479432,
      "number": 31723,
      "title": "qa: Facilitate debugging bitcoind inside functional tests",
      "body": "Facilitates debugging specific instances of bitcoind *in the context of Python tests, inside of an editor/IDE/debugger*.\r\n\r\nMakes bitcoind spin during startup, waiting for a debugger to be attached, so that breakpoints during process init can be debugged.\r\n\r\n### Example usage\r\n\r\n1. Generate build files with `-DENABLE_WAIT_FOR_DEBUGGER=ON` & build.\r\n   \r\n   ```\r\n   cmake -B build -DCMAKE_BUILD_TYPE=Debug -DENABLE_WAIT_FOR_DEBUGGER=ON && cmake --build build -j$(nproc)\r\n   ```\r\n\r\n2. Set breakpoints in the C++ code in your editor/IDE/debugger.\r\n\r\n3. Start a Python functional test with a debugger command such as:\r\n   - LLDB inside an already started Tmux pane (append ` -o continue` to the LLDB args to have the debugger continue automatically):\r\n     ```\r\n     ./build/test/functional/feature_loadblock.py --debug_runs 2 --debug_cmd \"tmux split-window -h lldb -p \\$PID\\$\"\r\n     ```\r\n   - Sublime Text Debugger, allows a running session to attach:\r\n     ```\r\n     ./build/test/functional/feature_loadblock.py --debug_runs 2 --debug_cmd \"subl --command \\\"debugger {\\\\\\\"action\\\\\\\": \\\\\\\"start\\\\\\\", \\\\\\\"configuration\\\\\\\": {\\\\\\\"name\\\\\\\": \\\\\\\"foo\\\\\\\", \\\\\\\"type\\\\\\\": \\\\\\\"lldb\\\\\\\", \\\\\\\"request\\\\\\\": \\\\\\\"attach\\\\\\\", \\\\\\\"program\\\\\\\": \\\\\\\"dummyprogram\\\\\\\", \\\\\\\"pid\\\\\\\": \\\\\\\"\\$PID\\$\\\\\\\"}}\\\"\"\r\n     ```\r\n   - Don't specify `--debug_cmd ...\\$PID\\$...`, instead have the test framework log which bitcoind PID you should manually attach to:\r\n     ```\r\n     ./build/test/functional/feature_loadblock.py --debug_runs 2\r\n     ```\r\n\r\n5. Experience how debugger hits breakpoints as the functional test executes RPCs.\r\n\r\nUsing `-debug_runs <RUN_INDEX>` often requires doing a dry-run of a functional test with `-ldebug` and examining the log to see which run index is the one we want to debug:\r\n```\r\n2025-...Z TestFramework.node0 (DEBUG): bitcoind started (run #1, node #0), waiting for RPC to come up\r\n``` \r\n\r\n### Alternative usage\r\n\r\nTweak functional test code to specify `wait_for_debugger` when (re)starting a node:\r\n\r\n```diff\r\n-        self.restart_node(0)\r\n+        self.restart_node(0, wait_for_debugger=True)\r\n```\r\nWhile it can be messy to modify files while moving between commits, and cumbersome inside of loops, it might be more straightforward than `-debug_runs <RUN_INDEX>` in a given case.\r\n\r\n### *Needed before merge*\r\n\r\n- [ ] Testing on Mac to confirm -waitfordebugger on the C++ side behaves as expected.",
      "state": "open",
      "user": "hodlinator",
      "created_at": "2025-01-23T13:18:06Z",
      "updated_at": "2026-01-20T05:04:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31723",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2460,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1389230610,
      "number": 27865,
      "title": "wallet: Track no-longer-spendable TXOs separately",
      "body": "In #27286, the wallet keeps track of all of its transaction outputs, even if they are already spent or are otherwise unspendable. This TXO set is iterated for balance checking and coin selection preparation, which can still be slow for wallets that have had a lot of activity. This PR aims to improve the performance of such wallets by moving UTXOs that are definitely no longer spendable to a different map in the wallet so that far fewer TXOs need to be iterated for the aforementioned functions.\r\n\r\nUnspendable TXOs (not to be confused with Unspent TXOs) are those which have a spending transaction that has been confirmed, or are no longer valid due to reorgs. TXOs that are spent in unconfirmed transactions remain in the primary TXO set, and are filtered out of balance and coin selection as before.\r\n\r\nDepends on #27286",
      "state": "open",
      "user": "achow101",
      "created_at": "2023-06-12T18:40:10Z",
      "updated_at": "2026-01-20T04:30:39Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/27865",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 876,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2368554207,
      "number": 31974,
      "title": "Drop testnet3",
      "body": "Testnet3 was deprecated in v28 with the introduction of testnet4. It will be dropped in v30 _or later_, please discuss in #31975.\r\n\r\nThere is no more `[test]` network section. The user is expected to set testnet4 explicitly, which should make future rotation of testnets easier.\r\n\r\nIf a `[test]` or `[testnet3]` section is present in `bitcoin.conf` a warning is issued:\r\n\r\n```\r\nWarning: .../bitcoin.conf:18 Section [test] is not recognized.\r\n```\r\n\r\nStarting with `-testnet3` will be greeted with an error message:\r\n\r\n```\r\nError: Testnet3 was dropped in version 30.0. Consider using '-testnet4' instead.\r\n```\r\n\r\nThis also prevents a fallback to mainnet.\r\n\r\nStarting with `-test` was already not possible with testnet3.\r\n\r\nReview hints:\r\n- make a (Windows) Guix build and test the (un)installer\r\n\r\nGuix hashes:\r\n\r\n```\r\n(todo)\r\n```",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-03-03T16:22:11Z",
      "updated_at": "2026-01-20T03:52:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31974",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 842,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2391882324,
      "number": 32061,
      "title": "Replace libevent with our own HTTP and socket-handling implementation",
      "body": "This is a major component of [removing libevent as a dependency of the project](https://github.com/bitcoin/bitcoin/issues/31194), by replacing the HTTP server used for RPC and REST with one implemented entirely within the Bitcoin Core codebase. The new `HTTPServer` class runs its own I/O thread, handling socket connections with code based on #30988, but tailored specifically for HTTP.\r\n\r\nSome functional tests were added in #32408 to cover libevent behaviors that remain consistent with this branch. \r\n\r\nCommit strategy:\r\n- Implement a few helper functions for strings, timestamps, etc needed by HTTP protocol\r\n- Isolate the existing libevent-based HTTP server in a namespace `http_libevent`\r\n- Implement HTTP in a new namespace `http_bitcoin` (classes like `HTTPRequest`, `HTTPClient`, etc...)\r\n- Switch bitcoind from the libevent server to the new server\r\n- Clean up (delete `http_libevent`)\r\n\r\nI am currently seeing about a 10% speed up in the functional tests on my own arm/macos machine.\r\n\r\n## Integration testing:\r\n\r\nI am testing the new HTTP server by forking projects that integrate with bitcoin via HTTP and running their integration tests with bitcoind built from this branch (on Github actions). I will continue adding integrations over time, and re-running these CI tests as this branch gets rebased:\r\n\r\n- [NodeJS `rpc-bitcoin`](https://github.com/pinheadmz/rpc-bitcoin/pull/1)\r\n- [electrs](https://github.com/pinheadmz/electrs/pull/1)\r\n- [lnd](https://github.com/pinheadmz/lnd/pull/1)\r\n- [eclair](https://github.com/pinheadmz/eclair/pull/1)\r\n- [corepc](https://github.com/pinheadmz/corepc/pull/1)\r\n- [bitcoinjs-lib](https://github.com/pinheadmz/bitcoinjs-lib/pull/1)",
      "state": "open",
      "user": "pinheadmz",
      "created_at": "2025-03-13T19:32:14Z",
      "updated_at": "2026-01-20T03:40:24Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32061",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1752,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2417478258,
      "number": 32138,
      "title": "wallet, rpc: remove settxfee and paytxfee",
      "body": "**Summary**\r\n\r\nThis PR removes the settxfee RPC and paytxfee setting (Bitcoin Core 31.0).\r\nThese two features were deprecated in https://github.com/bitcoin/bitcoin/pull/31278.",
      "state": "open",
      "user": "polespinasa",
      "created_at": "2025-03-25T18:30:56Z",
      "updated_at": "2026-01-20T03:29:03Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32138",
      "labels": [
        "Wallet",
        "RPC/REST/ZMQ",
        "Needs release note"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 217,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2091884190,
      "number": 30972,
      "title": "Wallet: \"listreceivedby*\" fix",
      "body": "Fixes https://github.com/bitcoin/bitcoin/issues/16159, \r\n\r\nThis PR builds on https://github.com/bitcoin/bitcoin/pull/25973, fixing `listreceivedby*` RPCs by filtering out `send` addresses using `IsMine` (see https://github.com/bitcoin/bitcoin/pull/25973#discussion_r1269477246). It also breaks down the `listreceivedby` tests into subtests and adds a test to verify 'listreceivedby*' does not return `send` addresses",
      "state": "open",
      "user": "BrandonOdiwuor",
      "created_at": "2024-09-25T16:59:35Z",
      "updated_at": "2026-01-20T02:42:37Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30972",
      "labels": [
        "Wallet",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 446,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3175030867,
      "number": 34294,
      "title": "test: Remove redundant STRICTENC flag from script_tests",
      "body": "Remove the `STRICTENC` flag from hundreds of `script_tests` cases that have nothing to do with signature or pubkey encoding. It's a readability improvement and it makes it easier to find the actual test cases for `STRICTENC` behavior (those are untouched). Also, `STRICTENC` is a policy flag, we should default to consensus flags in `script_tests`.\r\n\r\nThe diff is large but mechanical as I'm only removing `STRICTENC` from flags. That said, if reviewers feel this cleanup is not worthwhile, I am fine dropping it.\r\n\r\n`script_tests` pass on my end.",
      "state": "open",
      "user": "billymcbip",
      "created_at": "2026-01-14T21:21:03Z",
      "updated_at": "2026-01-20T02:22:41Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34294",
      "labels": [
        "Tests",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 603,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2466171613,
      "number": 32297,
      "title": "bitcoin-cli: Add -ipcconnect option",
      "body": "This implements an idea from sipa in https://github.com/bitcoin/bitcoin/issues/28722#issuecomment-2807026958 to allow `bitcoin-cli` to connect to the node via IPC instead of TCP, if the ENABLE_IPC cmake option is enabled and the node has been started with `-ipcbind`.\r\n\r\nThis feature can be tested with:\r\n\r\n```\r\nbuild/bin/bitcoin-node -regtest -ipcbind=unix -debug=ipc\r\nbuild/bin/bitcoin-cli -regtest -ipcconnect=unix -getinfo\r\n```\r\n\r\nThe -ipconnect parameter can also be omitted, since this change also makes `bitcoin-cli` prefer IPC over HTTP by default, and falling back to HTTP if an IPC connection can't be established.\r\n\r\n---\r\n\r\nThis PR is part of the [process separation project](https://github.com/bitcoin/bitcoin/issues/28722).",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2025-04-17T13:55:32Z",
      "updated_at": "2026-01-20T01:45:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32297",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 772,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2471245988,
      "number": 32317,
      "title": "kernel: Separate UTXO set access from validation functions",
      "body": "The current code makes it hard to call functions for checking the consensus-correctness of a block without having a full UTXO set at hand. This makes implementing features such as Utreexo and non-assumevalid swiftsync, where maintaining a full UTXO set defeats their purpose, through the kernel API difficult. Checks like the coinbase subsidy, or block sigops are only available through `ConnectBlock`, which requires a complete coins cache.\r\n\r\nSolve this by moving accessing coins and the responsibility of spending them out of `ConnectBlock` and into a new separate function called `SpendBlock`. Pass a block's spent coins through the existing `CBlockUndo` data structure to `ConnectBlock`. \r\n\r\nWhile the change is largely a refactor, some smaller behaviour changes were unavoidable. These should be highlighted in the commit messages. The last commit contains the most important part of the coins logic move, the commits before attempt to prepare it piecemeal.\r\n\r\nThis pull request was benchmarked on [benchcoin](https://github.com/bitcoin-dev-tools/benchcoin/pull/162), which showed no performance regression. While discussing this pull request it was noted that pre-fetching and eliminating the need for some additional map lookups might improve performance a bit, but this does not make a measurable difference in the grand scheme of things and was not the motivation for this pull request.\r\n\r\nIn future changes, ConnectBlock could be made even more self contained, accessing the coins from the internal map could be further optimized by consolidating existence checking and spending, and the function eventually exposed in an external kernel API (as done [here](https://github.com/sedited/bitcoin/commit/09e05493010119fc60d310d3e7ffc388de441f9a#diff-f638e65d9278276b2a6ac42ffbbd26d079c3dba752feed5038a25a1ee565d320R947))",
      "state": "open",
      "user": "sedited",
      "created_at": "2025-04-21T13:15:46Z",
      "updated_at": "2026-01-20T01:31:56Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32317",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1886,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2513877394,
      "number": 32471,
      "title": "wallet/rpc: fix listdescriptors RPC fails to return descriptors with private key information when wallet contains descriptors missing any key",
      "body": "_TLDR:\r\nCurrently, `listdescriptors [private=true]` will fail for a non-watch-only wallet if any descriptor has a missing private key(e.g `tr()`, `multi()`, etc.). This PR changes that while making sure `listdescriptors [private=true]` still fails if there no private keys. Closes #32078_ \r\n\r\nIn non-watch-only wallets, it's possible to import descriptors as long as at least one private key is included. It's important that users can still view these descriptors when they need to create a backupâ€”even if some private keys are missing ([#32078 (comment)](https://github.com/bitcoin/bitcoin/issues/32078#issuecomment-2781428475)). This change makes it possible to do so.\r\n\r\nThis change also helps prevent `listdescriptors true` from failing completely, because one descriptor is missing some private keys.\r\n\r\n### Notes\r\n- The new behaviour is applied to all descriptors including miniscript descriptors\r\n- `listdescriptors true` still fails for watch-only wallets to preserve existing behaviour https://github.com/bitcoin/bitcoin/pull/24361#discussion_r920801352\r\n- Wallet migration logic previously used `Descriptor::ToPrivateString()` to determine which descriptor was watchonly. This means that modifying the `ToPrivateString()` behaviour caused descriptors that were previously recognized as \"watchonly\" to be \"non-watchonly\". **In order to keep the scope of this PR limited to the RPC behaviour, this PR uses a different method to determine `watchonly` descriptors for the purpose of wallet migration.** A follow-up PR can be opened to update migration logic to exclude descriptors with some private keys from the `watchonly` migration wallet. \r\n\r\n### Relevant PRs\r\nhttps://github.com/bitcoin/bitcoin/pull/24361\r\nhttps://github.com/bitcoin/bitcoin/pull/32186\r\n\r\n### Testing\r\nFunctional tests were added to test the new behaviour\r\n\r\nEDIT\r\n**`listdescriptors [private=true]` will still fail when there are no private keys because non-watchonly wallets must have private keys and calling `listdescriptors [private=true]` for watchonly wallet returns an error**",
      "state": "open",
      "user": "Eunovo",
      "created_at": "2025-05-12T13:26:20Z",
      "updated_at": "2026-01-20T01:17:16Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32471",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2204,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3141522772,
      "number": 34188,
      "title": "test: Add multiple transactions and error handling tests for getreceivedbyaddress",
      "body": "This PR adds comprehensive functional test coverage for the `getreceivedbyaddress` RPC method.\r\n",
      "state": "closed",
      "user": "b-l-u-e",
      "created_at": "2026-01-02T05:56:38Z",
      "updated_at": "2026-01-20T01:04:10Z",
      "merged_at": "2026-01-20T01:04:10Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34188",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 178,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2418138719,
      "number": 32143,
      "title": "Fix 11-year-old mis-categorized error code in OP_IF evaluation",
      "body": "This was introduced by commit ab9edbd6b6eb3efbca11f16fa467c3c0ef905708.\r\n\r\nIt appears the original author may have gotten tired and pasted the wrong error code into this 1 place. Every other situation where the value stack lacks the required number of arguments for the op-code, SCRIPT_ERR_INVALID_STACK_OPERATION is reported. Not so here.  \r\n\r\nThis commit fixes the situation.\r\n\r\nEDIT: Note this turns out to be a dupe of the abandoned #30359 .  \r\n",
      "state": "closed",
      "user": "cculianu",
      "created_at": "2025-03-26T01:46:27Z",
      "updated_at": "2026-01-20T00:40:01Z",
      "merged_at": "2026-01-20T00:40:01Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32143",
      "labels": [
        "Validation",
        "Consensus"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 512,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2501800868,
      "number": 32427,
      "title": "(RFC) kernel: Replace leveldb-based BlockTreeDB with flat-file based store",
      "body": "Opening this PR mostly to get concept/approach feedback.\r\n\r\nThis is motivated by the kernel library, where the internal usage of leveldb is a limiting factor to its future use cases. Specifically it is not possible to share leveldb databases between two processes. A notable use-case for the kernel library is accessing and analyzing existing block data. Currently this can only be done by first shutting down the node writing this data. Moving away from leveldb opens the door towards doing this in parallel. A flat file based approach was chosen, since the requirements for persistence here are fairly simple (no deletion, constant-size entries). The change also offers better performance by making node startup faster, and has a smaller on-disk footprint, though this is negligible in the grand scheme of things.\r\n\r\nThe BlockTreeStore introduces a new data format for storing block indexes and headers on disk. The class is very similar to the existing CBlockTreeDB, which stores the same data in a leveldb database. Unlike CBlockTreeDB, the data stored through the BlockTreeStore is directly serialized and written to flat .dat files. The storage schema introduced\r\nis simple. It relies on the assumption that no entry is ever deleted and that no duplicate entries are written. These assumptions hold for the current users of CBlockTreeDB.\r\n\r\nA write ahead ahead log and boolean flags as file existence checks ensure write atomicity. Every data entry is also given a crc32c checksum to detect data corruption.\r\n\r\nThe change also opens the door towards getting rid of having to reindex the block tree due to corruption (though switching from pruned -> un-pruned still requires extra logic). This would simplify a lot of kernel/validation code, as can be seen in this [commit](https://github.com/TheCharlatan/bitcoin/commit/bfb2709e1d116d4e613601c3f0140f099530159d#diff-28f178018e05634ee3f8ddce3f4e0cec334ae69915cecf92be8299c749d8d470). The implementation here should be fairly robust against corruption (no parallel read/writes, no background compaction).\r\n\r\nAn alternative to this pull request, that could allow the same kernel feature, would be closing and opening the leveldb database only when reading and writing. This might incur a (negligible) performance penalty, but more importantly requires careful consideration of how to handle any contentions when opening, which might have complex side effects due to our current locking mode. It would also be possible to introduce an existing database with the required features for just the block tree, but that would introduce reliance on a new dependency and come with its own tradeoffs. For these reasons I chose this approach.",
      "state": "open",
      "user": "sedited",
      "created_at": "2025-05-06T14:27:59Z",
      "updated_at": "2026-01-20T00:38:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32427",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2759,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3187823761,
      "number": 34342,
      "title": "cli: Replace libevent usage with simple http client",
      "body": "Part of the effort to remove the libevent dependency altogether, see #31194\r\n\r\nDraft for now since it depends on a few other PRs in varying ways:\r\n- Uses `LineReader` from #34242 (first commit is cherry-picked from there)\r\n- Uses similar approach to #34158 and this has seen limited review so far\r\n- Could potentially reuse `HTTPHeaders` class from #32061 (TODO in code)\r\n\r\nSo, please review the PRs above first since the code here might change depending on review feedback there :)\r\n\r\nThe change itself replaces the libevent-based HTTP client with a simple synchronous implementation which uses the `Sock` class directly.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2026-01-19T13:27:54Z",
      "updated_at": "2026-01-19T23:53:22Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34342",
      "labels": [
        "Scripts and tools",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 674,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2594396603,
      "number": 32757,
      "title": "net: Fix Discover() not running when using -bind=0.0.0.0:port",
      "body": "  This PR fixes two related issues with address discovery when using explicit bind addresses in Bitcoin Core:\r\n\r\n  -  #31293\r\n  -  #31336\r\n\r\nWhen using `-bind=0.0.0.0:port` (or `-bind=::`), the `Discover()` function was not being executed because the code only checked the `bind_on_any` flag. This led to two problems:\r\n- The node would not discover its own local addresses if an explicit \"any\" bind was used.\r\n- The functional test `feature_bind_port_discover.py` would fail, as it expects local addresses to be discovered in these cases.\r\n\r\nThis PR:\r\n1. Checks both `bind_on_any` and any bind addresses using `IsBindAny()`\r\n   Ensures `Discover()` runs when binding to 0.0.0.0 or ::, even if specified explicitly.\r\n2. Ensures correct address discovery\r\n   The node will now discover its own addresses when using explicit \"any\" binds, matching user expectations and fixing the test.\r\n3. Maintains backward compatibility\r\n   The semantic meaning of `bind_on_any` is preserved as defined in `net.h`:  \r\n   > \"True if the user did not specify -bind= or -whitebind= and thus we should bind on 0.0.0.0 (IPv4) and :: (IPv6)\"\r\n4. Updates the test to use dynamic ports\r\n   The functional test `feature_bind_port_discover.py` is updated to use dynamic ports instead of hardcoded ones, improving reliability.\r\n\r\nHow this PR Differs from #31492\r\n\r\n- Preserves the semantic meaning of `bind_on_any` (see `net.h`).\r\n- Uses a simpler approach: checks `IsBindAny()` on bind addresses, without modifying `GetListenPort()`.\r\n- Avoids code duplication with `DefaultOnionServiceTarget()`.\r\n\r\nReferences\r\n\r\n- Implementation follows the approach proposed in my [review comment on #31492](https://github.com/bitcoin/bitcoin/pull/31492#issuecomment-2941773645).\r\n\r\nCloses #31293\r\n\r\nThe #31336 has the overall test failure and requires both this PR and #33362 to be fully resolved.\r\n",
      "state": "open",
      "user": "b-l-u-e",
      "created_at": "2025-06-16T04:28:44Z",
      "updated_at": "2026-01-19T23:23:25Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32757",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1922,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2182611991,
      "number": 31298,
      "title": "rpc: combinerawtransaction now rejects unmergeable transactions",
      "body": "Previously, combinerawtransaction would silently return the first tx when asked to combine unrelated txs. Now, it will check tx mergeability and throws a descriptive error if tx cannot be merged.\r\n\r\nfixes  #25980",
      "state": "open",
      "user": "adamandrews1",
      "created_at": "2024-11-15T21:24:12Z",
      "updated_at": "2026-01-19T23:12:31Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31298",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 276,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2582853972,
      "number": 32724,
      "title": "Musig2 tests",
      "body": "Built on https://github.com/bitcoin/bitcoin/pull/31244\r\n\r\nThis PR adds explicit tests for Bitcoin Core's MuSig2 interface.\r\n\r\nAny issues in musig2.{cpp,h} will likely also be caught by the descriptor tests, but having more detailed tests for the MuSig2 class itself improves test reporting/coverage.\r\n\r\nIt uses BIP 328 test vectors.",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2025-06-11T02:08:39Z",
      "updated_at": "2026-01-19T23:05:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32724",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 345,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2678738082,
      "number": 33014,
      "title": "rpc: Fix internal bug in descriptorprocesspsbt when encountering invalid signatures",
      "body": "Fixes #32849\r\nThe descriptorprocesspsbt RPC was crashing with an internal bug assertion when processing PSBTs with invalid signatures (like invalid Schnorr signatures with SIGHASH_SINGLE | ANYONECANPAY flags). Instead of returning a helpful error message, it would just crash.\r\nThis change replaces the CHECK_NONFATAL call with proper error handling that catches the failure and returns a JSONRPCError with a clear message to the user.\r\nTested with Bitcoin Core v29.0.0 using the exact PSBT from the issue report. The fix now returns proper error messages instead of crashing.",
      "state": "open",
      "user": "b-l-u-e",
      "created_at": "2025-07-19T05:15:00Z",
      "updated_at": "2026-01-19T23:03:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33014",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 660,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2550873429,
      "number": 32636,
      "title": "Split `CWallet::Create()` into `CreateNew` and `LoadExisting`",
      "body": "This PR is mostly a refactor which splits out logic used for creating wallets and for loading wallets, both of which are presently contained in `CWallet::Create()` into `CWallet::CreateNew()` and `CWallet::LoadExisting()`\r\n\r\nThe real win of this PR is that `CWallet::Create()` uses a very bad heuristic for trying to guess whether or not it is supposed to be creating a new wallet or loading an existing wallet:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/370c59261269fd9043674e0f4fd782a89e724473/src/wallet/wallet.cpp#L2882-L2885\r\n\r\nThis heuristic assumes that wallets with no `ScriptPubKeyMans` are being created, which sounds reasonable, but as demonstrated in #32112 and #32111, this can happen when the user tries to load a wallet file that is corrupted, both issues are fixed by this PR and any other misbehavior for wallet files which succeeded the broken heuristic's sniff test for new wallets.\r\n\r\nIt was already the case that every caller of `CWallet::Create()` knows whether it is creating a wallet or loading one, so we can avoid replacing this bad heuristic with another one, and just shift the burden to the caller.",
      "state": "open",
      "user": "davidgumberg",
      "created_at": "2025-05-29T00:37:09Z",
      "updated_at": "2026-01-19T22:14:43Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32636",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1189,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1566486194,
      "number": 28690,
      "title": "build: Introduce internal kernel library",
      "body": "This PR introduces a new `libbitcoin_kernel` internal library. It completes the internal library design as laid out in [doc/design/libraries.md](https://github.com/bitcoin/bitcoin/blob/master/doc/design/libraries.md). Since the `util` library contains a bunch of modules that are not required by the kernel library, a new `kernel_util` library is introduced as well that only consists of the modules required by the kernel library. The external `libbitcoinkernel` library now re-uses the compiled objects from the internal libraries. \r\n\r\nThere is a trade-off to this. Since we don't manually export symbols from the kernel library yet, this would make the library unusable if `REDUCE_EXPORTS=ON`. For now this means that the patch here introduces a separate source file list for the external library that gets populated by the source files of its static dependents.",
      "state": "open",
      "user": "sedited",
      "created_at": "2023-10-20T11:01:03Z",
      "updated_at": "2026-01-19T22:10:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28690",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 906,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2571509113,
      "number": 32685,
      "title": "wallet: Allow read-only database access for info and dump commands",
      "body": "## Problem\r\n\r\nFixes #29559\r\n\r\nThe `bitcoin-wallet info` and `bitcoin-wallet dump` commands currently fail when wallet files are write-protected, throwing \"Database opened in readonly mode but read-write permissions are needed\" errors. This prevents users from safely inspecting write-protected wallet files, which is important for:\r\n\r\n- Security-conscious setups where wallets are stored on read-only filesystems\r\n- Forensic analysis of wallet files without risk of modification\r\n- Backup verification without accidentally corrupting wallet data\r\n- Compliance with principle of least privilege (read-only operations should only require read access)\r\n\r\n## Solution\r\n\r\nThis PR adds comprehensive read-only database support to enable `bitcoin-wallet info` and `dump` commands to work with write-protected wallet files.\r\n\r\n### Key Changes\r\n\r\n**Database Layer (`src/wallet/db.h`, `src/wallet/sqlite.h`, `src/wallet/sqlite.cpp`)**\r\n- Add `read_only` boolean option to `DatabaseOptions` structure  \r\n- Add `IsReadOnly()` virtual method to `WalletDatabase` interface\r\n- Modify `SQLiteDatabase` to properly handle read-only mode:\r\n  - Use `SQLITE_OPEN_READONLY` flag when `read_only=true`\r\n  - Skip write operations (pragma settings, table creation) in read-only mode\r\n  - Maintain full read capability for queries and data retrieval\r\n\r\n**Wallet Tool (`src/wallet/wallettool.cpp`)**\r\n- Update `bitcoin-wallet info` command to use `options.read_only = true`\r\n- Update `bitcoin-wallet dump` command to use `options.read_only = true`\r\n\r\n**Wallet Loading (`src/wallet/walletdb.cpp`)**\r\n- Enhance `LoadWallet()` to detect read-only mode via `database.IsReadOnly()`\r\n- Skip version updates and other write operations when in read-only mode\r\n- Prevent \"Wallet corrupted\" errors during read-only access\r\n\r\n**Legacy Support (`src/wallet/migrate.h`)**\r\n- Add `IsReadOnly()` method to `BerkeleyRODatabase` for consistency\r\n\r\n## Testing\r\n\r\nThe implementation has been thoroughly tested:\r\n\r\n### Manual Testing\r\n- âœ… Created test wallets and made them read-only (`chmod 444`)\r\n- âœ… Verified `bitcoin-wallet info` works with read-only files\r\n- âœ… Verified `bitcoin-wallet dump` works with read-only files\r\n- âœ… Confirmed identical output between read-write and read-only access\r\n- âœ… Verified normal read-write operations remain unaffected\r\n\r\n### Unit Tests\r\nAll existing wallet tests continue to pass, confirming no regression in normal wallet operations.\r\n\r\n### Safety Verification\r\n- File permissions are respected (no writes attempted on read-only files)\r\n- Data integrity maintained (read-only access produces identical results)\r\n- Backwards compatibility preserved (existing workflows unaffected)\r\n\r\n## Security Considerations\r\n\r\nThis change **improves** security by:\r\n- Enabling inspection of wallet files without write access (principle of least privilege)\r\n- Preventing accidental wallet corruption during read-only operations\r\n- Supporting secure forensic analysis workflows\r\n- Reducing attack surface for read-only operations\r\n\r\nThe implementation is conservative and safe:\r\n- Only affects explicitly read-only operations (`info` and `dump` commands)\r\n- No changes to consensus or validation logic\r\n- No impact on normal wallet operations\r\n- Uses SQLite's built-in read-only mode for safety\r\n\r\n## Backwards Compatibility\r\n\r\nFull backwards compatibility is maintained:\r\n- Existing wallet operations work identically\r\n- No API changes for normal use cases  \r\n- No changes to wallet file formats\r\n- No impact on other Bitcoin Core components\r\n\r\n## Related Work\r\n\r\nThis builds upon existing read-only database patterns in Bitcoin Core, particularly the `BerkeleyRODatabase` class used for wallet migration scenarios. \r\n\r\n#28116 ",
      "state": "open",
      "user": "PeterWrighten",
      "created_at": "2025-06-05T20:36:09Z",
      "updated_at": "2026-01-19T21:56:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32685",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 2,
        "text_length": 3773,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3110306931,
      "number": 34090,
      "title": "net: Fix `-Wmissing-braces`",
      "body": "On some non-POSIX platforms, Clang emits `-Wmissing-braces` warnings for the `IN6ADDR_ANY_INIT` and `IN6ADDR_LOOPBACK_INIT` macros. For example, on OpenIndiana / illumos:\r\n```\r\n$ uname -srv\r\nSunOS 5.11 illumos-325e0fc8bb\r\n$ clang --version\r\nclang version 21.1.7 (https://github.com/OpenIndiana/oi-userland.git 36a81bf5e5d307d4e85893422600678d46328010)\r\nTarget: x86_64-pc-solaris2.11\r\nThread model: posix\r\nInstalledDir: /usr/clang/21/bin\r\n$ cmake -B build -DCMAKE_GENERATOR=Ninja -DCMAKE_C_COMPILER=clang -DCMAKE_CXX_COMPILER=clang++ -DENABLE_IPC=OFF -DAPPEND_CXXFLAGS='-Wno-unused-command-line-argument'\r\n$ cmake --build build\r\n[284/573] Building CXX object src/CMakeFiles/bitcoin_node.dir/net.cpp.o\r\n/export/home/hebasto/dev/bitcoin/src/net.cpp:3309:42: warning: suggest braces around initialization of subobject [-Wmissing-braces]\r\n 3309 |         const CService ipv6_any{in6_addr(IN6ADDR_ANY_INIT), GetListenPort()}; // ::\r\n      |                                          ^~~~~~~~~~~~~~~~\r\n/usr/include/netinet/in.h:479:32: note: expanded from macro 'IN6ADDR_ANY_INIT'\r\n  479 | #define IN6ADDR_ANY_INIT            {   0, 0, 0, 0,     \\\r\n      |                                         ^~~~~~~~~~~~~~~~~\r\n  480 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  481 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  482 |                                         0, 0, 0, 0 }\r\n      |                                         ~~~~~~~~~~\r\n1 warning generated.\r\n[467/573] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/i2p_tests.cpp.o\r\n/export/home/hebasto/dev/bitcoin/src/test/i2p_tests.cpp:116:34: warning: suggest braces around initialization of subobject [-Wmissing-braces]\r\n  116 |     const CService addr{in6_addr(IN6ADDR_LOOPBACK_INIT), /*port=*/7656};\r\n      |                                  ^~~~~~~~~~~~~~~~~~~~~\r\n/usr/include/netinet/in.h:484:37: note: expanded from macro 'IN6ADDR_LOOPBACK_INIT'\r\n  484 | #define IN6ADDR_LOOPBACK_INIT       {   0, 0, 0, 0,     \\\r\n      |                                         ^~~~~~~~~~~~~~~~~\r\n  485 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  486 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  487 |                                         0, 0, 0, 0x1U }\r\n      |                                         ~~~~~~~~~~~~~\r\n/export/home/hebasto/dev/bitcoin/src/test/i2p_tests.cpp:159:38: warning: suggest braces around initialization of subobject [-Wmissing-braces]\r\n  159 |         const CService addr{in6_addr(IN6ADDR_LOOPBACK_INIT), /*port=*/7656};\r\n      |                                      ^~~~~~~~~~~~~~~~~~~~~\r\n/usr/include/netinet/in.h:484:37: note: expanded from macro 'IN6ADDR_LOOPBACK_INIT'\r\n  484 | #define IN6ADDR_LOOPBACK_INIT       {   0, 0, 0, 0,     \\\r\n      |                                         ^~~~~~~~~~~~~~~~~\r\n  485 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  486 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  487 |                                         0, 0, 0, 0x1U }\r\n      |                                         ~~~~~~~~~~~~~\r\n2 warnings generated.\r\n[483/573] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/netbase_tests.cpp.o\r\n/export/home/hebasto/dev/bitcoin/src/test/netbase_tests.cpp:505:36: warning: suggest braces around initialization of subobject [-Wmissing-braces]\r\n  505 |         CService(CNetAddr(in6_addr(IN6ADDR_LOOPBACK_INIT)), 0 /* port */),\r\n      |                                    ^~~~~~~~~~~~~~~~~~~~~\r\n/usr/include/netinet/in.h:484:37: note: expanded from macro 'IN6ADDR_LOOPBACK_INIT'\r\n  484 | #define IN6ADDR_LOOPBACK_INIT       {   0, 0, 0, 0,     \\\r\n      |                                         ^~~~~~~~~~~~~~~~~\r\n  485 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  486 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  487 |                                         0, 0, 0, 0x1U }\r\n      |                                         ~~~~~~~~~~~~~\r\n/export/home/hebasto/dev/bitcoin/src/test/netbase_tests.cpp:510:36: warning: suggest braces around initialization of subobject [-Wmissing-braces]\r\n  510 |         CService(CNetAddr(in6_addr(IN6ADDR_LOOPBACK_INIT)), 0x00f1 /* port */),\r\n      |                                    ^~~~~~~~~~~~~~~~~~~~~\r\n/usr/include/netinet/in.h:484:37: note: expanded from macro 'IN6ADDR_LOOPBACK_INIT'\r\n  484 | #define IN6ADDR_LOOPBACK_INIT       {   0, 0, 0, 0,     \\\r\n      |                                         ^~~~~~~~~~~~~~~~~\r\n  485 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  486 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  487 |                                         0, 0, 0, 0x1U }\r\n      |                                         ~~~~~~~~~~~~~\r\n/export/home/hebasto/dev/bitcoin/src/test/netbase_tests.cpp:515:36: warning: suggest braces around initialization of subobject [-Wmissing-braces]\r\n  515 |         CService(CNetAddr(in6_addr(IN6ADDR_LOOPBACK_INIT)), 0xf1f2 /* port */),\r\n      |                                    ^~~~~~~~~~~~~~~~~~~~~\r\n/usr/include/netinet/in.h:484:37: note: expanded from macro 'IN6ADDR_LOOPBACK_INIT'\r\n  484 | #define IN6ADDR_LOOPBACK_INIT       {   0, 0, 0, 0,     \\\r\n      |                                         ^~~~~~~~~~~~~~~~~\r\n  485 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  486 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  487 |                                         0, 0, 0, 0x1U }\r\n      |                                         ~~~~~~~~~~~~~\r\n3 warnings generated.\r\n[573/573] Linking CXX executable bin/test_bitcoin\r\n```\r\n\r\nThe same issue is observed on Windows. For further details, see https://github.com/bitcoin/bitcoin/pull/31507.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-12-17T14:53:51Z",
      "updated_at": "2026-01-19T21:47:42Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34090",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 6596,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3188571369,
      "number": 34345,
      "title": "clang-format: use AngleBracket for main includes",
      "body": "This project uses angle brackets instead of quotes for project-specific headers. Setting [`MainIncludeChar`](https://clang.llvm.org/docs/ClangFormatStyleOptions.html#mainincludechar) enables `clang-format` to automatically detect the main header, so it can be kept as the top group of includes.\r\n\r\nFor example, without this change, `clang-format` would demote `<signet.h>` from being the main header in `src/signet.cpp`. With this change, the order is preserved.\r\n\r\nOn 5e49f5d63c74512c8f46fe7de7deb0341f13244a:\r\n```\r\n% clang-format src/signet.cpp | head -n 15\r\n// Copyright (c) 2019-present The Bitcoin Core developers\r\n// Distributed under the MIT software license, see the accompanying\r\n// file COPYING or http://www.opensource.org/licenses/mit-license.php.\r\n\r\n#include <consensus/merkle.h>\r\n#include <consensus/params.h>\r\n#include <consensus/validation.h>\r\n#include <logging.h>\r\n#include <primitives/block.h>\r\n#include <primitives/transaction.h>\r\n#include <script/interpreter.h>\r\n#include <script/script.h>\r\n#include <signet.h>\r\n#include <streams.h>\r\n#include <uint256.h>\r\n\r\n```\r\n\r\nWith this PR:\r\n```\r\n% clang-format src/signet.cpp | head -n 10\r\n// Copyright (c) 2019-present The Bitcoin Core developers\r\n// Distributed under the MIT software license, see the accompanying\r\n// file COPYING or http://www.opensource.org/licenses/mit-license.php.\r\n\r\n#include <signet.h>\r\n\r\n#include <consensus/merkle.h>\r\n#include <consensus/params.h>\r\n#include <consensus/validation.h>\r\n#include <logging.h>\r\n\r\n```\r\n\r\nNote: `AngleBracket` `requires clang-format 19`, and will cause older versions (including our current minimum llvm version `17`) to fail\r\n",
      "state": "open",
      "user": "stickies-v",
      "created_at": "2026-01-19T17:13:30Z",
      "updated_at": "2026-01-19T21:29:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34345",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1689,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3176742789,
      "number": 34301,
      "title": "wallet: remove outdated `RewriteDB` calls from SPKM & `DBErrors::NEED_REWRITE` enum value",
      "body": "ISTM that there is no implementation left of the `RewriteDB` method in any of the SPKMs, and thus, its call sites can be removed safely.\r\n\r\nAlso remove `DBErrors::NEED_REWRITE` enum value as its usage is outdated now.\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "open",
      "user": "rkrux",
      "created_at": "2026-01-15T10:11:36Z",
      "updated_at": "2026-01-19T21:01:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34301",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 2373,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3189081036,
      "number": 34348,
      "title": "lib: call RandFailure() if RDRAND fails",
      "body": "While the risk of the RDRAND instruction failing in such a fashion is minor, the current implementation allows the process to continue if such an occurrence happens.\r\n\r\nChecking for such an occurrence and calling RandFailure() if it occurs is a safer alternative than failing silently.",
      "state": "open",
      "user": "michaellappas",
      "created_at": "2026-01-19T20:50:55Z",
      "updated_at": "2026-01-19T20:51:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34348",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 325,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2989452954,
      "number": 33822,
      "title": "kernel: Add block header support and validation",
      "body": "Adds a new `btck_BlockHeader` type and associated functions to create, access, and validate block headers. Block headers will have their own type (`btck_BlockHeader`) that can be created from raw data, copied, and queried for all the standard header fields (hash, prev hash, timestamp, bits, version, nonce). We can also extract headers from full blocks or block tree entries.\r\n\r\nThe first commit here refactors `BlockValidationState` to use Handle/View pattern so external code can own them, which is required for the header processing in the API.\r\n\r\n #### New Block Header API\r\n\r\n  - **`btck_BlockHeader` type**: Opaque handle for block headers\r\n  - **Header methods**:\r\n    - `btck_block_header_create()`: Create header from 80-byte serialized data\r\n    - `btck_block_header_copy()`: Copy block headers\r\n    - `btck_block_header_destroy()`: Destroy header object\r\n    - `btck_block_header_get_hash()`: Calculate block hash\r\n    - `btck_block_header_get_prev_hash()`: Get previous block hash\r\n    - `btck_block_header_get_timestamp()`: Get block timestamp\r\n    - `btck_block_header_get_bits()`: Get difficulty target (compact format)\r\n    - `btck_block_header_get_version()`: Get block version\r\n    - `btck_block_header_get_nonce()`: Get proof-of-work nonce\r\n    \r\n    - `btck_block_get_header()`: Extract header from a full block\r\n    - `btck_block_tree_entry_get_block_header()`: Get header associated with a block tree entry\r\n  \r\n  - **Header Processing Methods:**\r\n    - **`btck_chainstate_manager_process_block_header()`**: Validates and processes a block header without requiring the full block. This performs proof-of-work verification, timestamp validation, and updates the internal chain state.\r\n    - **`btck_chainstate_manager_get_best_entry()`**: Returns the block tree entry with the most cumulative proof-of-work.\r\n\r\nWhy `btck_chainstate_manager_get_best_entry()` is included alongside header validation? Just as we have logic to get the tip for block validation (so you can request more blocks extending your best from your peers), we need the equivalent for header validation. To make header validation worthwhile, knowing what the best current header is seems usefulâ€”it tells you what headers to request next from peers.\r\n\r\n\r\n\r\n  ### Testing\r\n\r\n  Added tests in `test_kernel.cpp` that cover creating headers from raw data, extracting all header fields, and processing headers through the chainstate manager.\r\n  \r\n  CC sedited",
      "state": "open",
      "user": "yuvicc",
      "created_at": "2025-11-07T17:16:01Z",
      "updated_at": "2026-01-19T20:44:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33822",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2492,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2683340623,
      "number": 33032,
      "title": "wallet, test: Replace MockableDatabase with in-memory SQLiteDatabase",
      "body": "`MockableDatabase` was introduced for the tests to avoid tying non-database tests to a particular database type. However, since the only database type now is sqlite, and because the mockable behavior is no longer used by the tests, we can replace usage of the `MockabeDatabase` with a SQLite database that lives only in memory.\r\n\r\nThis is particularly useful for future work that has the wallet make use of SQLite's capabilities more, which are less conducive to having a separate mock database implementation.",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-07-21T22:36:32Z",
      "updated_at": "2026-01-19T20:39:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33032",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 579,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2683376326,
      "number": 33034,
      "title": "wallet: Store transactions in a separate sqlite table",
      "body": "The wallet uses SQLite as a key-value store even though SQLite is a powerful relational database engine. This causes us numerous headaches due to the need to serialize multiple fields together, and since record read from the database during loading can come in any order.\r\n\r\nNotably, for transactions, if we were able to load them in the transaction order assigned by the wallet, PRs like #27865 would be a bit simpler and easier to reason about.\r\n\r\nThis PR makes it possible for us to do that by storing transactions in a separate table. This table has a column for each field in `CWalletTx`, which lets us use a SQL statement like `SELECT * FROM transactions ORDER BY pos` which guarantees us the order in which the transactions are loaded into the wallet.\r\n\r\nThe eventual goal is to use SQLite as a relational database with tables that store our keys and other metadata that can reference each other so that the wallet doesn't just use the database as a storage mechanism. But that is still a work in progress.\r\n\r\nThis PR makes use of the last client opened features introduced in #32895 to determine when the old record style needs to be upgraded to the new transactions table. This should give us sufficient upgrade-downgrade-upgrade handling to not lose any funds.\r\n\r\nDepends on #32763, #32895, #32985, #33032, #33033",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-07-21T22:52:54Z",
      "updated_at": "2026-01-19T20:39:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33034",
      "labels": [
        "Wallet",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1377,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2647773300,
      "number": 32895,
      "title": "wallet: Prepare for future upgrades by recording versions of last client to open and decrypt",
      "body": "When a wallet is automatically upgraded, we always do so in a way that allows the user to load their wallet in an older version. When the user loads their wallet into an upgraded version again, the wallet may not perform the automatic upgrade and end up with upgraded and non-upgraded material in the wallet.\r\n\r\nIf we write some information about the last client to open the wallet, we would be able to detect these upgrade-downgrade-upgrade situations and perform another upgrade if so. However, in order for this to work, we need to have implemented writing such information into versions prior to the ones which introduce new automatic upgrades.\r\n\r\nWe are already writing the CLIENT_VERSION into all wallets in a \"version\" record, although this record is not updated in the same way across all previous versions. Since v24.0, we are always updating the record when the client version differs, but prior to that, the record would only be updated when the client version is newer. Even so, we can use this record to store the last client version.\r\n\r\nThe first commit decouples the written client version from the node version. This aids in development of new features. The version is entirely decoupled from previous versions by requiring all versions to have bit 30 set, and the initial version being `0 | (1 << 30)`. The versions just need to be at least 299900, and forcing bit 30 to be set was an easy way to achieve this.\r\n\r\nHowever, using version numbers is not as flexible as feature flags, so the second commit introduces the concept of Wallet Client Features. These flags are distinct from the existing Wallet Feature Flags since they are conceptually different. These are written in a separate record, and the wallet client version is incremented to `(1 << 0) | (1 << 30)`.\r\n\r\nLastly, since some upgrades may need private keys and can only occur after the wallet is decrypted, the third commit also adds a last decrypted features flags record to record the features of the last client to decrypt the wallet.\r\n\r\nThe result is that we will now be able to detect a downgrade down to v24.0 and be able to implement in parallel multiple features that require automatic upgrades.",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-07-07T20:13:08Z",
      "updated_at": "2026-01-19T20:25:01Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32895",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2277,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2224317475,
      "number": 31449,
      "title": "coins,refactor: Reduce `getblockstats` RPC UTXO overhead estimation",
      "body": "The [`getblockstats` RPC](https://github.com/bitcoin/bitcoin/pull/10757) currently overestimates UTXO overhead by treating the `fCoinBase` bitfield as an additional `bool` in `PER_UTXO_OVERHEAD`.\r\nHowever, `fCoinBase` and `nHeight` are stored as bitfields and effectively packed into a single 32-bit value; counting an extra bool in the overhead calculation is unnecessary.\r\n\r\nThis PR introduces the following changes across three commits:\r\n* Store `fCoinBase` as a bool bitfield to reduce implicit conversions at call sites.\r\n* Use a consistent height/coinbase packing style across Coin serialization, undo serialization, and coinstats hashing (casting `nHeight` to `uint32_t` before shifting to avoid signed-promotion UB).\r\n* Adjust UTXO overhead estimation to match the actual Coin layout and update the related tests accordingly.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2024-12-09T17:36:50Z",
      "updated_at": "2026-01-19T20:02:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31449",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 901,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2961054510,
      "number": 33738,
      "title": "log: avoid collecting `GetSerializeSize` data when compact block logging is disabled",
      "body": "### Context\r\n\r\nThe new accounting options introduced in https://github.com/bitcoin/bitcoin/pull/32582 can be quite heavy, and are not needed when debug logging is disabled.\r\n\r\n### Problem\r\n`PartiallyDownloadedBlock::FillBlock()` and `PeerManagerImpl::SendBlockTransactions()` accumulate transaction sizes for debug logging by calling `ComputeTotalSize()` in loops, which invokes expensive `GetSerializeSize()` serializations.\r\nThe block header hash is also only computed for the debug log.\r\n\r\n### Fixes\r\n\r\nGuard the size and hash calculations with `LogAcceptCategory()` checks so the serialization and hashing work only occurs when compact block debug logging is enabled.\r\n\r\nAlso modernized the surrounding code a bit since the change is quite trivial.\r\n\r\n### Reproducer\r\n\r\nYou can test the change by starting an up-to-date `bitcoind` node with `-debug=cmpctblock` and observing compact block log lines such as:\r\n\r\n> [cmpctblock] Successfully reconstructed block 00000000000000000001061eaa6c0fe79258e7f79606e67ac495765cb121a520 with 1 txn prefilled, 3122 txn from mempool (incl at least 3 from extra pool) and 641 txn (352126 bytes) requested\r\n\r\n<details>\r\n<summary>Test patch</summary>\r\n\r\n```patch\r\ndiff --git a/src/blockencodings.cpp b/src/blockencodings.cpp\r\nindex 58620c93cc..f16eb38fa5 100644\r\n--- a/src/blockencodings.cpp\r\n+++ b/src/blockencodings.cpp\r\n@@ -186,6 +186,7 @@ bool PartiallyDownloadedBlock::IsTxAvailable(size_t index) const\r\n\r\n ReadStatus PartiallyDownloadedBlock::FillBlock(CBlock& block, const std::vector<CTransactionRef>& vtx_missing, bool segwit_active)\r\n {\r\n+    LogInfo(\"PartiallyDownloadedBlock::FillBlock called\");\r\n     if (header.IsNull()) return READ_STATUS_INVALID;\r\n\r\n     block = header;\r\n@@ -218,6 +219,7 @@ ReadStatus PartiallyDownloadedBlock::FillBlock(CBlock& block, const std::vector<\r\n     }\r\n\r\n     if (LogAcceptCategory(BCLog::CMPCTBLOCK, BCLog::Level::Debug)) {\r\n+        LogInfo(\"debug log enabled\");\r\n         const uint256 hash{block.GetHash()}; // avoid cleared header\r\n         uint32_t tx_missing_size{0};\r\n         for (const auto& tx : vtx_missing) tx_missing_size += tx->ComputeTotalSize(); // avoid cleared txn_available\r\ndiff --git a/src/net_processing.cpp b/src/net_processing.cpp\r\nindex 5600c8d389..c081825f77 100644\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -2470,6 +2470,7 @@ uint32_t PeerManagerImpl::GetFetchFlags(const Peer& peer) const\r\n\r\n void PeerManagerImpl::SendBlockTransactions(CNode& pfrom, Peer& peer, const CBlock& block, const BlockTransactionsRequest& req)\r\n {\r\n+    LogInfo(\"PeerManagerImpl::SendBlockTransactions called\");\r\n     BlockTransactions resp(req);\r\n     for (size_t i = 0; i < req.indexes.size(); i++) {\r\n         if (req.indexes[i] >= block.vtx.size()) {\r\n@@ -2480,6 +2481,7 @@ void PeerManagerImpl::SendBlockTransactions(CNode& pfrom, Peer& peer, const CBlo\r\n     }\r\n\r\n     if (LogAcceptCategory(BCLog::CMPCTBLOCK, BCLog::Level::Debug)) {\r\n+        LogInfo(\"debug log enabled\");\r\n         uint32_t tx_requested_size{0};\r\n         for (const auto i : req.indexes) tx_requested_size += block.vtx[i]->ComputeTotalSize();\r\n         LogDebug(BCLog::CMPCTBLOCK, \"Peer %d sent us a GETBLOCKTXN for block %s, sending a BLOCKTXN with %u txns. (%u bytes)\\n\", pfrom.GetId(), block.GetHash().ToString(), resp.txn.size(), tx_requested_size);\r\n```\r\n\r\n</details>\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-10-29T22:57:43Z",
      "updated_at": "2026-01-19T19:59:28Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33738",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 3444,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3188672071,
      "number": 34346,
      "title": "test: use IP_PORTRANGE_HIGH on FreeBSD for dynamic port allocation",
      "body": "Reopening #34336. Iâ€™ve now tested it on FreeBSD and confirmed it works.\r\n\r\nOn FreeBSD, the default ephemeral port range (10000-65535) overlaps with the test framework's static port range (11000-26000), possibly causing intermittent \"address already in use\" failures when tests use dynamic port allocation (`port=0`).\r\n\r\nThis PR adds a helper that sets `IP_PORTRANGE_HIGH` via `setsockopt()` before binding, requesting ports from 49152-65535 instead, which avoids the overlap, as suggested in https://github.com/bitcoin/bitcoin/issues/34331#issuecomment-3767161843 by @maflcko .\r\n\r\nFrom FreeBSD's [sys/netinet/in.h](https://cgit.freebsd.org/src/tree/sys/netinet/in.h):                                                          \r\n  ```c\r\n  #define IP_PORTRANGE         19\r\n  #define IP_PORTRANGE_HIGH    1\r\n  #define IPPORT_EPHEMERALFIRST 10000  /* default range start */\r\n  #define IPPORT_HIFIRSTAUTO   49152   /* high range start */\r\n```\r\n\r\nSee also: FreeBSD https://man.freebsd.org/cgi/man.cgi?query=ip&sektion=4 man page.\r\n\r\nFixes #34331",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2026-01-19T17:57:22Z",
      "updated_at": "2026-01-19T19:58:31Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34346",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1105,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2607107167,
      "number": 32784,
      "title": "wallet: derivehdkey RPC to get xpub at arbitrary path",
      "body": "Given a (blank) wallet with an `unused(KEY)` descriptor, `derivehdkey \"m/87h/0h/0h\"` gets the xpub or xpriv at any given path.\r\n\r\nThis is particularly useful for multisig setup where it's not desirable to use our default derivations (e.g. 44h).\r\n\r\nI updated the multisig tutorial and the functional test.\r\n\r\nBased on:\r\n- #29136",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-06-20T11:04:39Z",
      "updated_at": "2026-01-19T19:39:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32784",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 381,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3177133582,
      "number": 34305,
      "title": "log: correct size output in disk space check",
      "body": "The output should be the additional space needed, otherwise we are always warning that 810GB will be stored, even when a user is pruning.\r\n\r\nFor example on machine with ~20GB free disk, pruning to 40GB:\r\n```bash\r\n./build/bin/bitcoind -prune=40000\r\n...\r\n2026-01-15T11:45:33Z [warning] Disk space for \"/root/.bitcoin/blocks\" may not accommodate the block files. Approximately 810 GB of data will be stored in this directory.\r\nWarning: Disk space for \"/root/.bitcoin/blocks\" may not accommodate the block files. Approximately 810 GB of data will be stored in this directory.\r\n```\r\n\r\nThis PR:\r\n```bash\r\n./build/bin/bitcoind -prune=40000\r\n...\r\n2026-01-15T11:41:49Z [warning] Disk space for \"/root/.bitcoin/blocks\" may not accommodate the block files. Approximately 39 GB of data will be stored in this directory.\r\nWarning: Disk space for \"/root/.bitcoin/blocks\" may not accommodate the block files. Approximately 39 GB of data will be stored in this directory.\r\n```",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-15T12:26:05Z",
      "updated_at": "2026-01-19T19:34:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34305",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1005,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3167650906,
      "number": 34269,
      "title": "wallet: disallow creating new or restoring to an unnamed (default) wallet",
      "body": "We've been moving in the direction that all wallets must have a name. Therefore, we shouldn't allow creating new unnamed wallets. `createwallet`, `restorewallet`, and the wallet tool's `create` and `createfromdump` all now require the user to provide a non-empty wallet name when creating/restoring a wallet.\r\n\r\nThe GUI is already enforcing this, but we were not enforcing it for RPCs or in the underlying `CreateWallet` and `RestoreWallet` functions.\r\n\r\nWallet migration does still need to be able to restore unnamed wallets, so there is a new argument to `RestoreWallet` to explicitly allow that behavior for migration only.",
      "state": "open",
      "user": "achow101",
      "created_at": "2026-01-12T23:39:06Z",
      "updated_at": "2026-01-19T19:13:25Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34269",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 700,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3136120149,
      "number": 34179,
      "title": "refactor: Enable transparent lookup for setBlockIndexCandidates to remove const_cast",
      "body": "### Rationale\r\n\r\nThis PR improves code safety by removing a `const_cast` in `src/validation.cpp`.\r\n\r\nCurrently, `setBlockIndexCandidates` stores mutable `CBlockIndex*`. However, validation logic (like `CVerifyDB`) often holds `const CBlockIndex*`. Previously, checking for existence in the set required casting away constness. While currently benign, this bypasses compiler safety checks and could mask accidental modifications in future refactors.\r\n\r\n### Description\r\n\r\n1.  **Enable Heterogeneous Lookup:** Added `using is_transparent = void;` to `CBlockIndexWorkComparator` in `src/node/blockstorage.h`. This allows the `std::set` to natively accept `const CBlockIndex*` for lookup (utilizing C++14 heterogeneous lookup).\r\n2.  **Remove Cast:** Removed the now unnecessary `const_cast<CBlockIndex*>` in `src/validation.cpp`, allowing the compiler to strictly enforce const-correctness.\r\n\r\n### Notes\r\n\r\n- **Refactoring only:** No behavioral change.\r\n- **Verification:** `validation_tests` and `blockmanager_tests` pass.",
      "state": "open",
      "user": "joaonevess",
      "created_at": "2025-12-30T07:40:16Z",
      "updated_at": "2026-01-19T19:05:37Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34179",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1104,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3142897675,
      "number": 34193,
      "title": "wallet: make migration more robust against failures",
      "body": "This is just me finding a few more edge cases after #34156 and #34176\r\n\r\nThe goal of the PR is to handle failures in a controlled way. Just so the process can automatically restore the original wallet without requiring user manual intervention.\r\n\r\nThe covered cases are:\r\n\r\n1. During `DoMigration()`: There are methods that can throw exceptions and abruptly abort the process.â€¨\r\nInstead of crashing (GUI) or returning a generic exception, we now will catch and return the error gracefully. This lets the process restore the original wallet automatically.\r\n\r\n2. Trying to migrate a wallet in a read-only directory throws a filesystem exception and skips cleanup.\r\nâ€¨Now the process will fail gracefully with a clear error msg, and automatically restore the original wallet.\r\n\r\n3. Any failure during `MigrateToSQLite` requires user manual intervention.â€¨\r\nNow the original wallet db will remain untouched, and only be updated once the sqlite db creation fully succeeds.",
      "state": "open",
      "user": "furszy",
      "created_at": "2026-01-02T20:59:40Z",
      "updated_at": "2026-01-19T19:03:05Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34193",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1017,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3132941994,
      "number": 34161,
      "title": "refactor: Avoid UB from `std::distance` with `nullptr` in `PoolAllocator`",
      "body": "### Problem\r\n\r\nCalling `std::distance(nullptr, nullptr)` is undefined behavior per the C++ standard [iterator.requirements.general](https://eel.is/c++draft/iterator.requirements.general#7):\r\n> Iterators can also have singular values that are not associated with any sequence. Results of most expressions are undefined for singular values.\r\n\r\nNull pointers are singular iterators not associated with any sequence, so they cannot form a valid range required by [std::distance](https://eel.is/c++draft/iterator.operations#4):\r\n> Preconditions: last is reachable from first\r\n\r\nWhile [expr.add#5.1](https://eel.is/c++draft/expr.add#5.1) defines pointer subtraction for null pointers:\r\n> If P and Q both evaluate to null pointer values, the value is 0\r\n\r\nThis applies to direct pointer arithmetic (`nullptr - nullptr`), not to `std::distance`, which has additional preconditions requiring non-singular iterators.\r\n\r\n### Fix\r\n\r\nChecked for `nullptr` before calling `std::distance` to avoid this undefined behavior.\r\nThis check only affects the very first call, after which the pointers are initialized.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-12-28T13:01:04Z",
      "updated_at": "2026-01-19T18:41:49Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34161",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1169,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3188763798,
      "number": 34347,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "sparpana",
      "created_at": "2026-01-19T18:38:27Z",
      "updated_at": "2026-01-19T18:39:33Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34347",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2991771825,
      "number": 33828,
      "title": "Check required interfaces before generating manpages",
      "body": "Guard manpage generation by reading CMakeCache.txt and exiting if HAVE_SYSTEM, ENABLE_WALLET, or WITH_ZMQ are off, and provide a short hint so contributors rebuild with the right flags instead of committing incomplete manpages.\r\n\r\nFixes #17506 \r\n\r\nOverride by exporting SKIP_BUILD_OPTIONS_CHECK=1 if you really need a custom-fit manpage (see bitcoin/bitcoin#29457 (comment)).",
      "state": "open",
      "user": "151henry151",
      "created_at": "2025-11-08T20:50:34Z",
      "updated_at": "2026-01-19T18:11:28Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33828",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 428,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3187225590,
      "number": 34336,
      "title": "test: use `IP_PORTRANGE_HIGH` on FreeBSD for dynamic port allocation",
      "body": "On FreeBSD, the default ephemeral port range (10000-65535) overlaps with the test framework's static port range (11000-26000), possibly causing intermittent \"address already in use\" failures when tests use dynamic port allocation (`port=0`).\r\n\r\nThis PR adds a helper that sets `IP_PORTRANGE_HIGH` via `setsockopt()` before binding, requesting ports from 49152-65535 instead, which avoids the overlap, as suggested in https://github.com/bitcoin/bitcoin/issues/34331#issuecomment-3767161843 by @maflcko .\r\n\r\nFrom FreeBSD's [sys/netinet/in.h](https://cgit.freebsd.org/src/tree/sys/netinet/in.h):                                                          \r\n  ```c\r\n  #define IP_PORTRANGE         19\r\n  #define IP_PORTRANGE_HIGH    1\r\n  #define IPPORT_EPHEMERALFIRST 10000  /* default range start */\r\n  #define IPPORT_HIFIRSTAUTO   49152   /* high range start */\r\n```\r\n\r\nSee also: FreeBSD https://man.freebsd.org/cgi/man.cgi?query=ip&sektion=4 man page.\r\n\r\nIâ€™ll leave the PR as a draft since I havenâ€™t tested it on FreeBSD yet and would like to gather feedback on the approach.\r\n\r\nFixes #34331",
      "state": "closed",
      "user": "w0xlt",
      "created_at": "2026-01-19T10:32:44Z",
      "updated_at": "2026-01-19T17:56:59Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34336",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 1156,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2168265902,
      "number": 31252,
      "title": "rpc: print P2WSH and P2SH redem Script in (get/decode)rawtransaction",
      "body": "This PR is motivated by https://github.com/bitcoin/bitcoin/issues/27391.\r\nAnd inspired by a previous PR https://github.com/bitcoin/bitcoin/pull/8849 that proposed something similar. \r\n\r\nThis is an example with a real mainnet transaction (3-5 multisig) and using ``decoderawtransaction`` (also works for ``getrawtransaction 'txid' 2``).\r\n\r\nVerbosity must be set to 2.\r\n\r\n```json\r\n$ bitcoin-cli getrawtransaction 44f5ab666cb9dccef69120fe5b51757a647c1f96882931a9faa0b2b5781ddfd2 2 000000000000000000018fa64b5e32335f7d3ac14b9e5553db20f2909c902c34\r\n{\r\n  \"in_active_chain\": true,\r\n  \"txid\": \"44f5ab666cb9dccef69120fe5b51757a647c1f96882931a9faa0b2b5781ddfd2\",\r\n  \"hash\": \"53836d2a4fb1e14356eac69fe1dad8be5dfd9a1b8101bc8aeb04ea2a320aa398\",\r\n  \"version\": 1,\r\n  \"size\": 382,\r\n  \"vsize\": 192,\r\n  \"weight\": 766,\r\n  \"locktime\": 0,\r\n  \"vin\": [\r\n    {\r\n      \"txid\": \"d15236206fbe06d6f38505656a2006a9a5a1ddf189a2647750091fd218d59581\",\r\n      \"vout\": 2,\r\n      \"scriptSig\": {\r\n        \"asm\": \"\",\r\n        \"hex\": \"\"\r\n      },\r\n      \"txinwitness\": [\r\n        \"\",\r\n        \"304402204d91eb67d798d071278ea0570973f3488d60c3ec98a611856f6a813b2e35df3202200bb36403ebd2dcc96b236efaf07db4f1da26b1031fc854548634ff44a340dc6601\",\r\n        \"3044022046abaa75082c2d1cdef57f8ef59a0046729220eabe2c2a229d1d592b89ccf1b0022028954703f13d836b1b77acd1eb72639a7a918d756fdd3ddef1d42a28567403ed01\",\r\n        \"522102f69779f4bb466a8c0aa7d6bf2a2dde34e44bae29d5186ee0c3bed4d903d57fa7210333c337637453164d5fd0dc31787a614a74d2acca5c08710937b9b831bd41b11f2103be7c86e40ad380b33f9abd653c6d04b95b818abd5653b63402678fcc45a017e753ae\"\r\n      ],\r\n      \"witnessScript\": {\r\n        \"asm\": \"2 02f69779f4bb466a8c0aa7d6bf2a2dde34e44bae29d5186ee0c3bed4d903d57fa7 0333c337637453164d5fd0dc31787a614a74d2acca5c08710937b9b831bd41b11f 03be7c86e40ad380b33f9abd653c6d04b95b818abd5653b63402678fcc45a017e7 3 OP_CHECKMULTISIG\",\r\n        \"desc\": \"multi(2,02f69779f4bb466a8c0aa7d6bf2a2dde34e44bae29d5186ee0c3bed4d903d57fa7,0333c337637453164d5fd0dc31787a614a74d2acca5c08710937b9b831bd41b11f,03be7c86e40ad380b33f9abd653c6d04b95b818abd5653b63402678fcc45a017e7)#sll5t8hh\",\r\n        \"type\": \"multisig\"\r\n      },\r\n      \"prevout\": {\r\n        ... bla bla bla prev output info ...\r\n        }\r\n      },\r\n      \"sequence\": 4294967293\r\n    }\r\n  ],\r\n  \"vout\": [ ... bla bla bla outputs ...  ],\r\n  \"fee\": 0.00000594,\r\n  \"hex\": \"010000000001018195d518d21f09507764a289f1dda1a5a906206a650585f3d606be6f203652d10200000000fdffffff025b730500000000001976a914381d46badae879d1c6037a03da52074e3914812c88ac38088000000000002200205ab691555ede8432ed7765585edb1c9b285532daf639e3e5ccd4843ff3b04cdf040047304402204d91eb67d798d071278ea0570973f3488d60c3ec98a611856f6a813b2e35df3202200bb36403ebd2dcc96b236efaf07db4f1da26b1031fc854548634ff44a340dc6601473044022046abaa75082c2d1cdef57f8ef59a0046729220eabe2c2a229d1d592b89ccf1b0022028954703f13d836b1b77acd1eb72639a7a918d756fdd3ddef1d42a28567403ed0169522102f69779f4bb466a8c0aa7d6bf2a2dde34e44bae29d5186ee0c3bed4d903d57fa7210333c337637453164d5fd0dc31787a614a74d2acca5c08710937b9b831bd41b11f2103be7c86e40ad380b33f9abd653c6d04b95b818abd5653b63402678fcc45a017e753ae00000000\",\r\n  \"blockhash\": \"000000000000000000018fa64b5e32335f7d3ac14b9e5553db20f2909c902c34\",\r\n  \"confirmations\": 1,\r\n  \"time\": 1746727602,\r\n  \"blocktime\": 1746727602\r\n}\r\n\r\n```",
      "state": "open",
      "user": "polespinasa",
      "created_at": "2024-11-07T20:39:24Z",
      "updated_at": "2026-01-19T17:51:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31252",
      "labels": [
        "RPC/REST/ZMQ",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3342,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2930696206,
      "number": 33663,
      "title": "net: Filter addrman during address selection via AddrPolicy to avoid underfill",
      "body": "This PR introduces `AddrMan::AddrPolicy`, a predicate that allows callers to\r\nexclude addresses during selection. The policy returns true to skip a given\r\nentry and is evaluated while holding `AddrMan::cs`.\r\n\r\nThe mechanism is used in `CConnman::GetAddressesUnsafe()` to filter out\r\nbanned and discouraged peers during address selection instead of removing\r\nthem afterward. This prevents P2P responses (`GETADDR`) and RPCs (`getnodeaddresses)` from\r\nreturning fewer results than requested when large portions of the address space are filtered.\r\n\r\nAdditional improvements:\r\n- Logs the number of filtered entries for diagnostics\r\n- Avoids redundant filtering passes in higher-level callers\r\n- Keeps locking behavior unchanged (the policy runs under `AddrMan::cs`)\r\n\r\n**Testing**\r\n- Repro: ban or discourage a large set of addresses, then call\r\n  `getnodeaddresses 1`,  previously underfilled.\r\n- After this change, the RPC returns up to the requested count as expected.\r\n\r\nNo behavior change for unaffected callers.\r\n",
      "state": "open",
      "user": "waketraindev",
      "created_at": "2025-10-20T18:03:51Z",
      "updated_at": "2026-01-19T17:40:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33663",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1094,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2670706297,
      "number": 32993,
      "title": "fuzz: wallet: add target for tx scanning",
      "body": "Tracking issue (#29901)\r\n\r\nThis PR adds a fuzz target for wallet tx scanning (`ScanForWalletTransactions`). Unfortunately, it's not a regression test for the issue #31474 since it would require a more complex scenario/async operations.",
      "state": "open",
      "user": "brunoerg",
      "created_at": "2025-07-16T13:15:08Z",
      "updated_at": "2026-01-19T17:39:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32993",
      "labels": [
        "Tests",
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 276,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2677577590,
      "number": 33008,
      "title": "wallet: support bip388 policy with external signer",
      "body": "External signers such as Ledger, BitBox02 and Jade, when used with multisig, use [BIP388](https://github.com/bitcoin/bips/blob/master/bip-0388.mediawiki) to display (and constrain) descriptor policies to their users.\r\n\r\nAt least in the case of Ledger (no others so far, see https://github.com/bitcoin/bitcoin/pull/33008#issuecomment-3165080503) this requires us to hold on to an hmac, which proves to the device that the user previously reviewed and approved it.\r\n\r\nThis PR adds a new RPC call `registerpolicy` which converts our descriptor(s) into a BIP388 policy (_partially implemented_), calls a new HWI method `register` (_implemented_) and stores the resulting HMAC (_implemented_).\r\n\r\nWhen signing a transaction using HWI's `signtx` it passes the HMAC along with the PSBT (_TODO_).\r\n\r\nFor convenience the HMAC can be retrieved via `getwalletinfo` (_implemented_). This is useful for scenario's where we can't (yet) complete a transaction via HWI calls.\r\n\r\nNote that the HMAC itself is not specified in BIP388 and may be different for different hardware vendors. So we'll store and echo any hex string the device gives us.\r\n\r\nAn alternative approach to directly supporting BIP388 policies would be to pass the involved descriptors to HWI and have it figure out how to derive a policy.\r\n\r\nTesting:\r\n- make a multisig wallet with a Ledger or other [supported device](https://github.com/bitcoin/bips/blob/master/bip-0388.mediawiki#reference-implementation)\r\n  - try https://github.com/Sjors/bitcoin/pull/91 if you're feeling adventurous, it includes this PR\r\n- install https://github.com/bitcoin-core/HWI/pull/791 HWI branch\r\n- call `bitcoin rpc registerpolicy`\r\n- call `bitcoin rpc getwalletinfo` to see the hmac\r\n\r\nTODO:\r\n- [ ] derive policy using `Descriptor` class instead regex madness, implement all constraints\r\n- [ ] pass hmac along when signing\r\n\r\nDepends on:\r\n- [ ] HWI `register` command: https://github.com/bitcoin-core/HWI/pull/791\r\n- [ ] HWI optional `--hmac` argument for `signtx` (if set, bypass the current auto-registration workaround)\r\n\r\nPotential followups:\r\n- pass hmac along when displaying an address. This provides some extra assurance to the user. See https://github.com/bitcoin-core/HWI/pull/647\r\n",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-07-18T15:31:45Z",
      "updated_at": "2026-01-19T17:29:55Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33008",
      "labels": [
        "Wallet",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2277,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3177617343,
      "number": 34308,
      "title": "doc: Document IWYU workaround",
      "body": "This PR addresses the following comments:\r\n- https://github.com/bitcoin/bitcoin/pull/34079#discussion_r2640003086:\r\n  > it would be good to reduce and report this bug upstream. Otherwise, wide-spread use of iwyu in this code-base seems risky.\r\n\r\n- https://github.com/bitcoin/bitcoin/pull/34079#discussion_r2640035350:\r\n  > Would have been good if it was documented, rather than adding undocumented workarounds for buggy tools.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2026-01-15T14:47:47Z",
      "updated_at": "2026-01-19T17:24:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34308",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 456,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3188542853,
      "number": 34344,
      "title": "chore: Update outdated GitHub Actions versions",
      "body": "<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n\r\nThis PR updates outdated GitHub Action versions to ensure compatibility and improve functionality. The following changes are made to the GitHub Actions:\r\n- `actions/upload-artifact` updated from v4 to v6\r\n- `actions/cache` updated from v4 to v5\r\n- `actions/download-artifact` updated from v5 to v7\r\n\r\nThe updates are necessary to support newer environments and features, and ensure consistent behavior across different workflows. The changes will be tested in the CI pipeline of the pull request.\r\n",
      "state": "open",
      "user": "pgoslatara",
      "created_at": "2026-01-19T17:02:36Z",
      "updated_at": "2026-01-19T17:17:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34344",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 2,
        "text_length": 2609,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2986611773,
      "number": 33810,
      "title": "ci: Add IWYU job",
      "body": "This PR separates the IWYU checks into its own CI job to provide faster feedback to developers. No other changes are made to the treatment of IWYU warnings. The existing â€œtidyâ€ CI job will no longer run IWYU.\r\n\r\nSee also the discussion of https://github.com/bitcoin/bitcoin/pull/33779, specifically this [comment](https://github.com/bitcoin/bitcoin/pull/33779#issuecomment-3491515263):\r\n> Maybe a better approach would be to run the enforced sections in a separate, faster job? Some of the linters are already a bit annoying to invoke locally, so I usually just run the lint job. Doing the same for the includes seems fine to me.\r\n\r\nBased on ideas from https://github.com/bitcoin/bitcoin/pull/32953.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-11-06T23:27:52Z",
      "updated_at": "2026-01-19T17:15:57Z",
      "merged_at": "2025-12-22T17:39:46Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33810",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 716,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3187604599,
      "number": 34338,
      "title": "ci, iwyu: Fix warnings in `src/zmq` and treat them as errors",
      "body": "This PR [continues](https://github.com/bitcoin/bitcoin/pull/33725#issuecomment-3466897433) the ongoing effort to enforce IWYU warnings.\r\n\r\nPrevious PRs:\r\n- https://github.com/bitcoin/bitcoin/pull/33810\r\n- https://github.com/bitcoin/bitcoin/pull/31308\r\n- https://github.com/bitcoin/bitcoin/pull/34079\r\n- https://github.com/bitcoin/bitcoin/pull/33779\r\n\r\nFor accompanying documentation, please see https://github.com/bitcoin/bitcoin/pull/34319.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2026-01-19T12:24:27Z",
      "updated_at": "2026-01-19T17:09:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34338",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 502,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3181450896,
      "number": 34319,
      "title": "Drop some `IWYU pragma: export` and document IWYU usage",
      "body": "First two commits address comments from discussion in https://github.com/bitcoin/bitcoin/pull/33779:\r\n- https://github.com/bitcoin/bitcoin/pull/33779#discussion_r2697579248\r\n- https://github.com/bitcoin/bitcoin/pull/33779#discussion_r2697707343\r\n\r\nThe last commit adds a new section to the Developer Notes to document IWYU usage.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2026-01-16T14:19:15Z",
      "updated_at": "2026-01-19T17:08:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34319",
      "labels": [
        "Refactoring",
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 385,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2502815894,
      "number": 32430,
      "title": "test: Add and use ElapseTime helper",
      "body": "Currently mocktime is written to a global, which may leak between sub-tests (albeit some tests try to reset the mocktime on a best-effort basis). Also, when advancing it, one has to keep a counter variable around.\r\n\r\nFix both issues by a new `ElapseTime` helper, which resets the mocktime once it goes out of scope. Also, it has a method to advance the mocktime by a delta.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2025-05-06T22:39:14Z",
      "updated_at": "2026-01-19T17:05:49Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32430",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 409,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3176275662,
      "number": 34296,
      "title": "refactor: [move-only] Merge core_io module, remove from libkernel",
      "body": "Currently the core_io module is split across two translation units. This will confuse code readers and tooling about the real state of the module.\r\n\r\nFix that by merging the module and removing the mapping workarounds.\r\n\r\nAlso, remove the module from the kernel lib, because it is not used there: The kernel does not use any json or string parsing or formatting.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-15T07:31:40Z",
      "updated_at": "2026-01-19T16:57:51Z",
      "merged_at": "2026-01-19T16:45:57Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34296",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 428,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3181350550,
      "number": 34318,
      "title": "contrib: Revert \"verify-commits sha1 exceptions\"",
      "body": "This reverts commit 8ac134be5e57680eb1c6ef596e5de085825e83ee, because it is no longer needed.\r\n\r\nSee https://github.com/bitcoin/bitcoin/pull/34245#issuecomment-3759448369\r\n\r\nAlso, use the shorter pathlib `read_text`, which is available since Python 3.5",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-16T13:49:49Z",
      "updated_at": "2026-01-19T16:38:46Z",
      "merged_at": "2026-01-16T18:02:22Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34318",
      "labels": [
        "Scripts and tools"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 301,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3136708013,
      "number": 34181,
      "title": "refactor: [p2p] Make ProcessMessage private again, Use references when non-null",
      "body": "There is a single unit test, which calls the internal `ProcessMessage` function. This is problematic, because it makes future changes harder, since they will need to carry over this public internal interface each time.\r\n\r\nAlso, there is a mixed use of pointers and references in p2p code, where just based on context, a pointer may sometimes assumed to be null, or non-null. This is confusing when reading the code, or making or reading future changes.\r\n\r\nFix both issues in a series of commits, to:\r\n\r\n* refactor the single unit test to call higher-level functions\r\n* Make `ProcessMessage` private again\r\n* Use references instead of implicit non-null pointers, mostly in a scripted-diff",
      "state": "open",
      "user": "maflcko",
      "created_at": "2025-12-30T12:31:30Z",
      "updated_at": "2026-01-19T16:38:02Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34181",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 767,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3184483208,
      "number": 34328,
      "title": "rpc: make `uptime` monotonic across NTP jumps",
      "body": "Issue: https://github.com/bitcoin/bitcoin/issues/34326\r\n\r\n### Problem\r\n`bitcoin-cli uptime` was derived from wall-clock time, so it could jump by large amounts when the system clock is corrected after `bitcoind` starts (e.g. on RTC-less systems syncing NTP).\r\nThis breaks the expectation that uptime reflects process runtime.\r\n\r\n### Fix\r\nCompute uptime from a [monotonic clock](https://en.cppreference.com/w/cpp/chrono/steady_clock.html) so it is immune to wall-clock jumps, and use that monotonic uptime for the RPC.\r\nGUI startup time is derived from wall clock time minus monotonic uptime so it remains sensible after clock corrections.\r\n\r\n### Reproducer\r\nRevert the fix commit and run the `rpc_uptime` functional test (it should fail with `AssertionError: uptime should not jump with wall clock`):\r\n\r\nOr alternatively:\r\n\r\n```bash\r\ncmake -B build && cmake --build build --target bitcoind bitcoin-cli -j$(nproc)\r\nDATA_DIR=$(mktemp -d)\r\n./build/bin/bitcoind -regtest -datadir=\"$DATA_DIR\" -connect=0 -daemon\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" -rpcwait uptime\r\nsleep 1\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" setmocktime $(( $(date +%s) + 20000000 ))\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" uptime\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" stop\r\n```\r\n\r\n<details>\r\n<summary>Before (uptime jumps with wall clock)</summary>\r\n\r\n```bash\r\nBitcoin Core starting\r\n0\r\n20000001\r\nBitcoin Core stopping\r\n```\r\n\r\n</details>\r\n\r\n<details>\r\n<summary>After (uptime stays monotonic)</summary>\r\n\r\n```bash\r\nBitcoin Core starting\r\n0\r\n1\r\nBitcoin Core stopping\r\n```\r\n</details>",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-17T20:01:46Z",
      "updated_at": "2026-01-19T16:36:43Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34328",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1660,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3173345068,
      "number": 34281,
      "title": "build: Temporarily remove confusing and brittle `-fdebug-prefix-map`",
      "body": "The compiler option `-fdebug-prefix-map` is unconditionally set by the build system. This is problematic for many reasons:\r\n\r\n* Users and devs have no easy way to disable it without modifying the build system source code\r\n* The mapping is broken since the cmake migration, and requires manual fixups such as https://github.com/bitcoin/bitcoin/issues/31204 or https://github.com/bitcoin/bitcoin/issues/31957\r\n\r\nFix all issues by temporarily removing it.\r\n\r\nThough, the option is kept for the guix build, so that no change in behavior is observed for the release binaries.\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/31957\r\nFixes https://github.com/bitcoin/bitcoin/issues/31204\r\n\r\n\r\nThe option can be added back in the future, if there is any need to. Though, adding it back should ideally work out of the box, or at least provide easy workarounds for all commonly used tooling.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-14T12:31:05Z",
      "updated_at": "2026-01-19T16:34:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34281",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 952,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3182337108,
      "number": 34321,
      "title": "3x the same typo (I'm sorry, I don't speak French and I don't know whâ€¦",
      "body": "3x the same typo (I'm sorry, I don't speak French and I don't know where I could comit this in transifex, but I want to report it)",
      "state": "closed",
      "user": "benediktjohannes",
      "created_at": "2026-01-16T19:03:58Z",
      "updated_at": "2026-01-19T16:20:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34321",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 201,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3187756139,
      "number": 34340,
      "title": "[ignore] ci_test_b",
      "body": "",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-19T13:06:47Z",
      "updated_at": "2026-01-19T16:13:18Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34340",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 19,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3187755738,
      "number": 34339,
      "title": "[ignore]  ci_test_a",
      "body": "",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-19T13:06:40Z",
      "updated_at": "2026-01-19T16:12:57Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34339",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 20,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3160483005,
      "number": 34242,
      "title": "Prepare string and net utils for future HTTP operations",
      "body": "This is a component of [removing libevent as a dependency of the project](https://github.com/bitcoin/bitcoin/issues/31194). It is the first six commits of #32061 and provides a string-parsing utility (`LineReader`) that is also consumed by #34158.\r\n\r\nThese are the functions that are added / updated for HTTP and Torcontrol:\r\n\r\n- `GetBindAddress()`: Given a socket, provides the bound address as a CService. Currently used by p2p but moved from `net` to `netbase` so other modules can call it.\r\n- `ToIntegral()`: Already used to parse numbers from strings, added new argument `base = 10` so it can also be used to parse hexadecimal integers. HTTP chunked transfer-encoding uses hex-encoded integers to specify payload size: https://datatracker.ietf.org/doc/html/rfc7230.html#section-4.1\r\n- `AsciiCaseInsensitive` comparators: Needed to store HTTP headers in an `unordered_map`. Headers are key-value pairs that are parsed with case-insensitive keys: https://httpwg.org/specs/rfc9110.html#rfc.section.5.1\r\n- `FormatRFC1123DateTime()`: The required datetime format for HTTP headers (e.g. `Fri, 31 May 2024 19:18:04 GMT`)\r\n- `LineReader`: Fields in HTTP requests are newline-terminated. This struct is given an input buffer and provides methods to read lines as strings.\r\n",
      "state": "open",
      "user": "pinheadmz",
      "created_at": "2026-01-09T18:11:27Z",
      "updated_at": "2026-01-19T16:05:51Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34242",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1325,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2563709776,
      "number": 32672,
      "title": "ci: update pwsh to use custom shell that fails-fast",
      "body": "Github by default sets [fail fast](https://docs.github.com/en/actions/writing-workflows/workflow-syntax-for-github-actions#exit-codes-and-error-action-preference) behaviour on pswh shell which means that if any powershell cmdlet fails the script will stop and exit. The problem is that this behaviour doesn't apply when calling native executables, it only applies to powershell cmdlets.\r\n\r\nI think the safest thing is to whenever we use pwsh to enable `$PSNativeCommandUseErrorActionPreference = $true` which will also fail calling any exe that returns a non-zero exit code.\r\n\r\nTechnically the step `Adjust paths in test/config.ini` only uses cmdlets so this step will not benefit from this change but I feel like it's good practice to still enable this feature in case this script gets modified in the future to call an exe.\r\n\r\nHere is a CI run that has a script that fails silently (look at Windows Native, VS 2022 -> Get tool information): https://github.com/m3dwards/bitcoin/actions/runs/15415032095/job/43375709475\r\nAnd with this change applied, the script correctly fails: https://github.com/m3dwards/bitcoin/actions/runs/15416585565/job/43380685364",
      "state": "open",
      "user": "m3dwards",
      "created_at": "2025-06-03T12:03:44Z",
      "updated_at": "2026-01-19T15:51:32Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32672",
      "labels": [
        "Windows",
        "Tests",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1207,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2776641246,
      "number": 33259,
      "title": "rpc, logging: add backgroundvalidation to getblockchaininfo",
      "body": "`getblockchaininfo` returns `verificationprogress=1` and `initialblockdownload=false` even if there's background validation.\r\nThis PR adds information about background validation to rpc `getblockchaininfo` in a similar way to `validationprogress` does.\r\n\r\nIf assume utxo was used the output of a \"sync\" node performing background validation:\r\n```\r\n$ ./build/bin/bitcoin-cli getblockchaininfo\r\n...\r\n  \"mediantime\": 1756933740,\r\n  \"verificationprogress\": 1,\r\n  \"initialblockdownload\": false,\r\n  \"backgroundvalidation\": true,\r\n  \"background\": {\r\n    \"snapshotheight\": 880000,\r\n    \"blocks\": 527589,\r\n    \"bestblockhash\": \"0000000000000000002326308420fa5ccd28a9155217f4d1896ab443d84148fa\",\r\n    \"mediantime\": 1529076654,\r\n    \"chainwork\": \"0000000000000000000000000000000000000000020c92fab9e5e1d8ed2d8dbc\",\r\n    \"verificationprogress\": 0.2815790617966284\r\n  },\r\n  \"chainwork\": \"0000000000000000000000000000000000000000df97866c410b0302954919d2\",\r\n  \"size_on_disk\": 61198817285,\r\n\r\n...\r\n```\r\n\r\nIf assume utxo was not used the progress is hidden and background validation is set to false:\r\n```\r\n$ ./build/bin/bitcoin-cli getblockchaininfo\r\n...\r\n  \"mediantime\": 1756245700,\r\n  \"verificationprogress\": 1,\r\n  \"initialblockdownload\": false,\r\n  \"backgroundvalidation\": false,\r\n  \"chainwork\": \"00000000000000000000000000000000000000000000000000000656d6bb052b\",\r\n  \"size_on_disk\": 3964972194,\r\n...\r\n```\r\n\r\nThe PR also updates the way we estimate the verification progress returning a 100% on the snapshot block and not on the tip as we will stop doing background validation when reaching it.\r\n",
      "state": "open",
      "user": "polespinasa",
      "created_at": "2025-08-26T23:02:29Z",
      "updated_at": "2026-01-19T15:48:11Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33259",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1639,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3173584131,
      "number": 34284,
      "title": "ipc, test: Add tests for unclean disconnect and thread busy behavior",
      "body": "Upcoming libmultiprocess changes are expected to alter this behavior (https://github.com/bitcoin/bitcoin/issues/34250#issuecomment-3749243782), making test coverage useful for documenting current behavior and validating the intended changes.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2026-01-14T13:46:24Z",
      "updated_at": "2026-01-19T15:12:43Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34284",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 310,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3161681681,
      "number": 34247,
      "title": "security: harden CI actions and subprocess calls",
      "body": "Harden several CI and deployment scripts against potential injection vectors.\n\n### Changes\n\n- **.github/actions/configure-docker/action.yml**: Migrated direct `github` context interpolation to intermediate environment variables to prevent potential script injection from untrusted context data.\n- **contrib/macdeploy/macdeployqtplus**: Refactored the `codesign` subprocess call to use `shell=False` and list-based arguments. Fixed several linting issues (E401, F841).\n- **contrib/verify-binaries/verify.py**:\n    - Replaced `wget` with `urllib.request` for file retrieval, enforcing HTTP(S) protocols to mitigate potential LFI risks.\n    - Fixed a bug in `verify_with_gpg` where an empty string was passed to the `--output` argument when no output file was specified.\n    - Removed unused imports and cleaned up code.\n- **contrib/verify-binaries/test.py**: Updated `run_verify` to execute via `shell=False`.\n\nThese changes reduce the attack surface for command injection in automated environments and local deployment scripts while improving code quality and reliability.",
      "state": "open",
      "user": "RinZ27",
      "created_at": "2026-01-10T07:33:15Z",
      "updated_at": "2026-01-19T14:41:23Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34247",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1120,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3102178109,
      "number": 34075,
      "title": "fees: Introduce Mempool Based Fee Estimation to reduce overestimation",
      "body": "This PR is another attempt to fix #27995 using a better approach.\r\n\r\nFor background and motivation, see #27995 and the discussion in the Delving Bitcoin post [Mempool Based Fee Estimation on Bitcoin Core](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703)\r\nThis PR is currently limited to using the mempool only to lower what is recommended by the Block Policy Estimator.\r\nAccurate and safe fee estimation using the mempool is challenging. There are open questions about how to prevent mempool games that are theoretically possible for miners [(a variant of the Finney attack)](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/6)\r\n\r\nThis is one of the reasons I opted to use the mempool only to lower the Block Policy Estimator, which itself is not gameable, and therefore this mechanism is not susceptible to this attack.\r\n\r\nThe underlying assumption here is that, with the current tools and work done to make RBF and CPFP feasible and guarantee (TRUC transaction relay, ephemeral anchors, cluster size 2 package rbf), it is safer to underestimate rather than overestimate.\r\nWe now assume it is relatively easy to fee-bump later if a transaction does not confirm, whereas once a fee is overestimated there is no way to recover from that.\r\n\r\nAnother open question when using the mempool for fee estimation is how to account for incoming transaction inflow.\r\n[Bitcoin Augur](https://github.com/block/bitcoin-augur) does this by using past inflow plus a constant expected inflow to predict future inflow. I find this unconvincing for fee estimation and potentially prone to more overestimation, as past conditions are not always representative of the future. See my [review of the Augur fee rate estimator and open questions](https://github.com/block/bitcoin-augur/issues/3).\r\n\r\nThis PR uses a much simpler approach based on current user behavior, similar to the widely used method employed by mempool.space: looking at the top block of the mempool and selecting a percentile feerate depending on whether the user is economical or conservative.\r\n\r\nEmpirical data from both myself and Clara Shikhelman shows that the 75th percentile feerate for economical users and the 50th percentile feerate for conservative users provide positive confirmation guarantees, hence this is what is used in this PR.\r\n\r\nParallel research by RenÃ© Pickhardt and his student suggests that using the [average fee per byte of the block template performs well](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/12).\r\n\r\nAll of these are constants that can be adjusted, there is parallel work exploring these constants and running benchmarks across fee estimators to find a sweet spot.\r\n\r\nSee also work in LND, the [LND Budget Sweeper](https://delvingbitcoin.org/t/lnds-deadline-aware-budget-sweeper/1512), which applies this idea successfully. Their approach is to estimate fees initially with bitcoind, then increment gradually as the confirmation deadline approaches, using a fixed fee budget.\r\n\r\nHistorical data indicates that by doing only the approach in this PR, we are able to [reduce overestimation quite significantly (~29%)](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/8).\r\n\r\nThis is particularly useful in scenarios where the Block Policy Estimator recommends a high feerate while the mempool is empty.\r\n<img width=\"1800\" height=\"1090\" alt=\"56f3ba26c0184521c42bb82ec9d8c9f2224d4f8e\" src=\"https://github.com/user-attachments/assets/c035c40c-8ece-42a7-b290-d29f1ac9bf4d\" />\r\n\r\nAs seen in the image above, there is only one remaining unfixed case: when there is a sudden inflow of transactions and the feerate rises, the Block Policy Estimator takes time to reflect this. In that case, users will continue to see a low feerate estimate until it slowly updates. From the historical data linked above, [this occurs about ~26% of the time](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/8)).\r\n\r\nOverall, we observe a **73% success rate with 0% overestimation, and 26% underestimation** with this approach.\r\n\r\nThis PR also includes refactors that enable this work. Rather than splitting the PR and implementing changes incrementally, I opted for an end-to-end implementation:\r\n\r\n### 1. Refactors\r\n\r\n* Separation of feerate format from the fee estimate mode enumerator (separation of concerns, as they are semantically distinct)\r\n* Move logging after fee estimation estimateSmartFee from the wallet to the Block Policy Estimator internal method (also separation of concerns and avoiding leaking fee estimator internals). This change also comes with updating `createTransactionInternal` to log only the fee and its source (fee estimator, fallback fee, etc.), which is more appropriate.\r\n* Separate the fee estimate mode enum from the fee source enumerator (separation of concerns, as they are semantically distinct). This introduces a minor breaking change: the wallet RPCs now return fee *source* instead of fee *reason*, which is more accurate. Let me know if we prefer to keep the field name unchanged while returning the fee source.\r\n* Move the `StringForReason` enum from `common` to the Block Policy Estimator (also separation of concerns)\r\n* Various test file updates and renames for improved accuracy\r\n* Update Block Policy Estimator unit tests to be independent of the mempool and the validation interface\r\n\r\n### 2. Introduce Mempool-Based Fee Estimator and Fee Estimator Manager\r\n\r\n* Introduce a new abstract fee estimator base class that all fee estimators must implement\r\n\r\n* Introduce `FeeRateEstimateResult` as the response type, containing metadata and avoiding the use of out-parameters. This is easily extensible and makes future changes less invasive, as method signatures do not need to change.\r\n\r\n* Add `FeeEstimatorType` enum to identify different fee estimators\r\n\r\n* Make `CBlockPolicyEstimator` derive from the new fee estimator base class\r\n\r\n* Add `FeeRateEstimatorManager`, responsible for managing all fee estimators\r\n\r\n* Update the node context to store a `unique_ptr` to `FeeRateEstimatorManager` instead of `CBlockPolicyEstimator`\r\n\r\n* Update `CBlockPolicyEstimator` to no longer subscribe directly to the validation interface; instead, `FeeRateEstimatorManager` subscribes and forwards relevant notifications\r\n\r\n* Add a percentile calculation function that takes the chunk feerates of a block template and returns feerate percentiles; this can also be reused by the `getblockstats` RPC\r\n\r\n* Add a mempool fee estimator that generates a block template when called, calculates a percentile feerate, and returns the 75th percentile for economical mode or the 50th percentile for conservative mode\r\n\r\n* Add caching to the mempool estimator so that new estimates are generated only every 7 seconds, assuming enough [transactions have propagated](https://bitcoin.stackexchange.com/questions/125776/how-long-does-it-take-for-a-transaction-to-propagate-through-the-network/125777#125777) to make a meaningful difference.\r\n  This heuristic will likely be replaced by requesting block templates via the general-purpose block template cache proposed here: [https://github.com/bitcoin/bitcoin/issues/33389](https://github.com/bitcoin/bitcoin/issues/33389)\r\n\r\n* Update `MempoolTransactionRemovedForBlock` to return the actual block transactions as well\r\n\r\n* Track the weight of block transactions and evicted transactions after each block connection\r\n  This data is tracked for the last 6 mined blocks. A mempool feerate estimate is returned only when the average ratio of mempool transaction weight evicted due to `BLOCK` reasons to block transaction weight is greater than 75%. This heuristic provides rough confidence that the nodeâ€™s mempool matches that of the majority of the hashrate. The 75% threshold is arbitrary and can be adjusted.\r\n\r\nThere is a caveat when transactions in the local mempool are consistently not mined by the network, as described in #27995 (e.g., due to filtering).\r\nAccounting for these transactions during fee estimation is not necessary, as they should be evicted from the mempool itself (see #33510). Handling this again within fee estimation would be redundant.\r\n\r\n* Persist statistics for the 6 most recent blocks to disk during periodic flushes and shutdown, so this data is available after restarts\r\n* Expose this data to users when running `estimatesmartfee` with verbosity > 2\r\n\r\n<details>\r\n<summary>see example output</summary>\r\n\r\n```\r\nbitcoin-cli estimatesmartfee 1 \"conservative\" 2\r\n```\r\n\r\n```\r\n{\r\n  \"feerate\": 0.00002133,\r\n  \"errors\": [],\r\n  \"blocks\": 2,\r\n  \"mempool_health_statistics\": [\r\n    {\r\n      \"block_height\": 927953,\r\n      \"block_weight\": 3991729,\r\n      \"mempool_txs_weight\": 3942409,\r\n      \"ratio\": 0.987644451815241\r\n    },\r\n    ...\r\n  ]\r\n}\r\n```\r\n\r\n</details>",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2025-12-15T11:53:35Z",
      "updated_at": "2026-01-19T14:28:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34075",
      "labels": [
        "TX fees and policy"
      ],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 1,
        "text_length": 8927,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2756065507,
      "number": 33215,
      "title": "Fix compatibility with `-debuglogfile` command-line option",
      "body": "This PR avoids hardcoding the \"debug.log\" filename, ensuring compatibility with custom filenames provided via the `-debuglogfile` command-line option.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-08-19T10:59:57Z",
      "updated_at": "2026-01-19T14:05:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33215",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 209,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2519262912,
      "number": 32497,
      "title": "merkle: preâ€‘reserve leaves to prevent reallocs with odd vtx count",
      "body": "#### Summary\r\n\r\n`ComputeMerkleRoot` [duplicates the last hash](https://github.com/bitcoin/bitcoin/blob/39b6c139bd6be33699af781f1d71f6fed303d468/src/consensus/merkle.cpp#L54-L56) when the input size is odd. If the caller provides a `std::vector` whose capacity equals its size, that extra `push_back` forces a reallocation, doubling its capacity (causing peak memory usage of 3x the necessary size).\r\n\r\nThis affects roughly half of the created blocks (those with odd transaction counts), causing unnecessary memory fragmentation during every block validation.\r\n\r\n#### Fix\r\n\r\n* Pre-reserves vector capacity to account for the odd-count duplication using `(size + 1) & ~1ULL`.\r\n    * This syntax produces [optimal assembly](https://github.com/bitcoin/bitcoin/pull/32497#discussion_r2553107836) across x86/ARM and 32/64-bit platforms for GCC & Clang.\r\n* Eliminates default construction of `uint256` objects that are immediately overwritten by switching from `resize` to `reserve` + `push_back`.\r\n\r\n#### Memory Impact\r\n\r\n[Memory profiling](https://github.com/bitcoin/bitcoin/pull/32497#issuecomment-3563724551) shows **50% reduction in peak allocation** (576KB â†’ 288KB) and elimination of reallocation overhead.\r\n\r\n#### Validation\r\n\r\nThe benchmark was updated to use an odd leaf count to demonstrate the real-world scenario where the reallocation occurs.\r\n\r\nA full `-reindex-chainstate` up to block **896 408** ran without triggering the asserts.\r\n\r\n<details>\r\n<summary>Validation asserts</summary>\r\n\r\nTemporary asserts (not included in this PR) confirm that `push_back` never reallocates and that the coinbase witness hash remains null:\r\n```cpp\r\nif (hashes.size() & 1) {\r\n    assert(hashes.size() < hashes.capacity()); // TODO remove\r\n    hashes.push_back(hashes.back());\r\n}\r\n\r\nleaves.reserve((block.vtx.size() + 1) & ~1ULL); // capacity rounded up to even\r\nleaves.emplace_back();\r\nassert(leaves.back().IsNull()); // TODO remove\r\n```\r\n\r\n</details>\r\n\r\n#### Benchmark Performance\r\n\r\nWhile the main purpose is to improve predictability, the reduced memory operations also improve hashing throughput slightly.\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-05-14T13:01:42Z",
      "updated_at": "2026-01-19T13:43:56Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32497",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2169,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3132300728,
      "number": 34158,
      "title": "torcontrol: Remove libevent usage",
      "body": "This is part of the effort to remove the libevent dependency from our code base: https://github.com/bitcoin/bitcoin/issues/31194\r\n\r\nThere is a dependency on #32061 but it only really needs one commit which is cherry-picked here in first position (add `LineReader`). I hope that a first chunk of that PR can be sliced off and reviewed independently so this PR here is not blocked by it.\r\n\r\nThe current approach tries to reuse existing code and follows roughly similar design decisions. It replaces the libevent-based async I/O with blocking I/O utilizing the existing `Sock` and `CThreadInterrupt`. The controller runs in a dedicated thread.\r\n\r\nThere are some optional code modernizations thrown in made along the way (namings, constexpr etc.). These are not strictly necessary but make the end result with the new code more consistent.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2025-12-27T14:20:31Z",
      "updated_at": "2026-01-19T13:23:49Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34158",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 869,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3187784182,
      "number": 34341,
      "title": "wallet: only log `txid` when `-debug=wallet` is explicit",
      "body": "Extracted from: https://github.com/bitcoin/bitcoin/pull/34267#discussion_r2693741105\r\n\r\n### Problem\r\n\r\nAll wallet logging was written to `debug.log` by default, so it can leak sensitive wallet context (`txids` and full transaction strings) when shared.\r\nAlso, `WalletLogPrintf` is a leftover name from the removed `LogPrintf` API and does not reflect the current behavior (unconditional info-level logging).\r\n\r\n### Fix\r\n\r\nAfter a refactor commit to rename `WalletLogPrintf` to `WalletLogInfo` (`scripted-diff` only) to reflect that it logs unconditionally at info level, redact txids and full transaction strings from info-level wallet logs, and add a new `-debug=wallet` category for sensitive context (txid/full tx string) logged as indented follow-up lines via the new `WalletLogDebug()`.\r\n\r\n### Reproducer\r\n\r\nWe can easily exercises the common create wallet, mine, and send paths to demonstrate the info-level redaction vs `-debug=wallet` behavior.\r\nIt does not attempt to trigger rare error paths (e.g. database write failures, unexpected script types, conflicts/double-spends, broadcast failures, rescans/migrations), which would require additional setup and can be deduced from the code.\r\n\r\nBuild and run this once \"before\" and once \"after\", then compare grepped log output.\r\n\r\n```bash\r\ncmake -B build >/dev/null 2>&1 && cmake --build build --target bitcoind bitcoin-cli -j$(nproc) >/dev/null 2>&1\r\n\r\nDATA_DIR=$(mktemp -d)\r\n\r\n./build/bin/bitcoind -regtest -datadir=\"$DATA_DIR\" -daemon -connect=0 -fallbackfee=0.0002 >/dev/null 2>&1\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" -rpcwait getblockchaininfo >/dev/null\r\n\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" createwallet w0 >/dev/null\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" createwallet w1 >/dev/null\r\nADDR0=$(./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" -rpcwallet=w0 getnewaddress)\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" -rpcwallet=w0 generatetoaddress 101 \"$ADDR0\" >/dev/null\r\nADDR1=$(./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" -rpcwallet=w1 getnewaddress)\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" -rpcwallet=w0 sendtoaddress \"$ADDR1\" 1 >/dev/null\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" -rpcwallet=w1 -rpcwait getbalances >/dev/null\r\n\r\nrg -n \"CommitTransaction|AddToWallet|Submitting wtx|txid=|CTransaction\\\\(\" \"$DATA_DIR/regtest/debug.log\" || true\r\n\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" stop >/dev/null\r\n```\r\n\r\n<details>\r\n<summary>Before (info-level wallet logs include txids and transaction dump)</summary>\r\n\r\n```bash\r\n113:2026-01-19T12:51:04Z [w0] AddToWallet d9a81836a9a2e8158ca6aa49278b70305a07614df420d980abe2028366407731  new Confirmed (block=24fd805ca35464a95530674f8434c3af34111409e5e3477ae4ba4b46f085baac, height=1, index=0)\r\n...\r\n411:2026-01-19T12:51:05Z [w0] AddToWallet 3d72f6d5f6829a070b0d9766a672b158b6a1fd87bea0f6959ab0ec4b44ebb7ef  new Confirmed (block=2e937f886897ccd9345fc859ebedde9be981a831aa55786286dae69b21a36007, height=101, index=0)\r\n417:2026-01-19T12:51:05Z [w0] CommitTransaction:\r\n418:CTransaction(hash=14daa63ec9, ver=2, vin.size=1, vout.size=2, nLockTime=3)\r\n423:2026-01-19T12:51:05Z [w0] AddToWallet 14daa63ec9de552d7260ab2cd3e993ba41cd1eadc2e525eec8e017b26ebd5a4c  newupdate Inactive (abandoned=0)\r\n424:2026-01-19T12:51:05Z [w0] Submitting wtx 14daa63ec9de552d7260ab2cd3e993ba41cd1eadc2e525eec8e017b26ebd5a4c to mempool and for broadcast to peers\r\n425:2026-01-19T12:51:05Z [w0] AddToWallet 14daa63ec9de552d7260ab2cd3e993ba41cd1eadc2e525eec8e017b26ebd5a4c   InMempool\r\n426:2026-01-19T12:51:05Z [w1] AddToWallet 14daa63ec9de552d7260ab2cd3e993ba41cd1eadc2e525eec8e017b26ebd5a4c  new InMempool\r\n```\r\n</details>\r\n\r\n<details>\r\n<summary>After (info-level wallet logs redact txids and transaction dump)</summary>\r\n\r\n```bash\r\n115:2026-01-19T12:52:46Z [w0] AddToWallet new Confirmed (block=7f0cdb7a15da25963eb2276592aefb99596011a3288f08a8598c87046e5d1f2f, height=1, index=0)\r\n...\r\n411:2026-01-19T12:52:47Z [w0] AddToWallet new Confirmed (block=0a02dcb2e58029c5e665bad29ae90f69f813527bb41f6c74e7600ada7194019c, height=101, index=0)\r\n417:2026-01-19T12:52:47Z [w0] CommitTransaction\r\n418:2026-01-19T12:52:47Z [w0] AddToWallet newupdate Inactive (abandoned=0)\r\n419:2026-01-19T12:52:47Z [w0] Submitting wtx to mempool and for broadcast to peers\r\n420:2026-01-19T12:52:47Z [w0] AddToWallet  InMempool\r\n421:2026-01-19T12:52:47Z [w1] AddToWallet new InMempool\r\n```\r\n</details>\r\n\r\n<details>\r\n<summary>After with <code>-debug=wallet</code> (txids and transaction dump only in <code>[wallet]</code> debug lines)</summary>\r\n\r\nAdding wallet debug logging:\r\n```bash\r\n./build/bin/bitcoind -regtest -datadir=\"$DATA_DIR\" -daemon -connect=0 -fallbackfee=0.0002 -debug=wallet >/dev/null 2>&1\r\n```\r\n\r\n```bash\r\n114:2026-01-19T12:54:47Z [w0] AddToWallet new Confirmed (block=511c1230d47d8d70c87f01b1b2274a4c04a8304f826f500af90ac36d3953544d, height=1, index=0)\r\n115:2026-01-19T12:54:47Z [wallet] [w0]   txid=7d8e6900d4f3815291f5c80c24067d71867e605bc1ac96bc302174fc7c22c38f\r\n...\r\n512:2026-01-19T12:54:47Z [w0] AddToWallet new Confirmed (block=2c1aa6e5312f1b0213e5d8a32807baba845e5b1f19998e9ae5366ccc6ffce3b0, height=101, index=0)\r\n513:2026-01-19T12:54:47Z [wallet] [w0]   txid=eb8521e70116f366541ab8202375b3ec145e29e7271779baa4eff066ccd1e9ac\r\n519:2026-01-19T12:54:47Z [w0] CommitTransaction\r\n520:2026-01-19T12:54:47Z [wallet] [w0]   CTransaction(hash=b56f816d0c, ver=2, vin.size=1, vout.size=2, nLockTime=101)\r\n525:2026-01-19T12:54:47Z [w0] AddToWallet newupdate Inactive (abandoned=0)\r\n526:2026-01-19T12:54:47Z [wallet] [w0]   txid=b56f816d0cf7fdc5ae34eb09bcfdfefe66e57e3f76be86e46ffebd046eaa8ed2\r\n527:2026-01-19T12:54:47Z [w0] Submitting wtx to mempool and for broadcast to peers\r\n528:2026-01-19T12:54:47Z [wallet] [w0]   txid=b56f816d0cf7fdc5ae34eb09bcfdfefe66e57e3f76be86e46ffebd046eaa8ed2\r\n529:2026-01-19T12:54:47Z [w0] AddToWallet  InMempool\r\n530:2026-01-19T12:54:47Z [wallet] [w0]   txid=b56f816d0cf7fdc5ae34eb09bcfdfefe66e57e3f76be86e46ffebd046eaa8ed2\r\n531:2026-01-19T12:54:47Z [w1] AddToWallet new InMempool\r\n532:2026-01-19T12:54:47Z [wallet] [w1]   txid=b56f816d0cf7fdc5ae34eb09bcfdfefe66e57e3f76be86e46ffebd046eaa8ed2\r\n```\r\n\r\n</details>\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-19T13:15:38Z",
      "updated_at": "2026-01-19T13:18:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34341",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 6286,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3167372056,
      "number": 34267,
      "title": "net: avoid unconditional `privatebroadcast` logging (+ warn for debug logs)",
      "body": "### Motivation\r\nThe recently merged [private broadcast](https://github.com/bitcoin/bitcoin/pull/29415) is a privacy feature, and users may share `debug.log` with support.\r\nUnconditional `LogInfo()` messages that mention private broadcast and/or include (w)txids can leak sensitive context (e.g. which transactions a user originated).\r\n\r\nFollow up to [#29415 (comment)](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2637012294)\r\n\r\n### Changes\r\n* Move private-broadcast event logs from `LogInfo()` to `LogDebug(BCLog::PRIVBROADCAST, ...)`, so they are only emitted when `-debug=privatebroadcast` was explicitly provided.\r\n* Remove hardcoded `\"[privatebroadcast]\"` log-string prefixes (category logging already adds the prefix).\r\n* Keep warning at the default log level for startup failures.\r\n* Add an init log (not a warning since that would require excessive test framework updates) when any `-debug` categories are enabled that additional logs may contain privacy-sensitive information and should not be shared publicly.\r\n* Update a related startup arg (`-logips`) to clarify that clarify that non-debug logs can also contain IP addresses.\r\n\r\n### Reproducer\r\nThe new warning can be checked with:\r\n```bash\r\n./build/bin/bitcoind -printtoconsole=1 -stopatheight=1 -listen=0 -connect=0 | grep 'Debug logging is enabled' | wc -l\r\n       0\r\n./build/bin/bitcoind -printtoconsole=1 -stopatheight=1 -listen=0 -connect=0 -debug | grep 'Debug logging is enabled' | wc  -l\r\n       1\r\n```\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-12T21:25:29Z",
      "updated_at": "2026-01-19T13:17:32Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34267",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1565,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3143827627,
      "number": 34198,
      "title": "wallet: fix ancient wallets migration",
      "body": "We currently fail migration if the wallet does not contain the best block locator.\r\nThis is a problem for wallets created before https://github.com/bitcoin/bitcoin/pull/152, which are not storing such record.\r\n\r\nMissing this record is not an error. it simply means the wallet will scan the chain prior\r\nto finish migration.\r\n\r\nNote:\r\nOriginally I wrote the test using a BDB library (`bsddb3`) but I wasn't happy with the\r\nnew dependency, and ended up zeroing the record length manually. I'm not sure this\r\nwill work on every platform. If it doesn't, we can just just drop the test as this can be\r\ntested manually on any ancient wallet too.",
      "state": "open",
      "user": "furszy",
      "created_at": "2026-01-03T20:03:34Z",
      "updated_at": "2026-01-19T13:12:43Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34198",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 677,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3187452713,
      "number": 34337,
      "title": "fuzz: Return chrono point from ConsumeTime(), Add ConsumeDuration()",
      "body": "Returning a raw i64 is a bit confusing when it comes to chrono types. For example, in the addrman fuzz tests, the `time_penalty` is not a time point, but a duration.\r\n\r\nAlso, all call-sites assume second resolution right now, so document that better by returning `NodeSeconds` from `ConsumeTime(...)` and `std::chrono::seconds` from `ConsumeDuration(...)`.\r\n\r\n",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-19T11:38:51Z",
      "updated_at": "2026-01-19T13:00:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34337",
      "labels": [
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 428,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1276577083,
      "number": 27260,
      "title": "Enhanced error messages for invalid network prefix during address parsing.",
      "body": "# Improve Address Decoding Error Messages\r\n\r\n## Issue\r\n\r\n`DecodeDestination` does not properly handle errors when a user inputs a valid address for the wrong network (e.g., a testnet address while running the client on mainnet).\r\n\r\nThe previous error messages were misleading. For example, \"Invalid or unsupported Segwit (Bech32) or Base58 encoding\" was displayed for a valid Bech32 address on a different network. This occurred because the `is_bech32` variable only checked if the prefix matched the current network's HRP. If it didn't match, the code would fall through to Base58 decoding logic regardless of whether the string was actually a valid Bech32 address.\r\n\r\n## Solution\r\n\r\n### Implementation Approach\r\n\r\n1. **Decode first, then validate**: Instead of checking the prefix before decoding, we now decode the string using `bech32::Decode(str)` upfront. This takes minimal CPU cycles and is acceptable since address validation is not a frequent operation.\r\n\r\n2. **Gather decoding information**: After Bech32 decoding, we also attempt `DecodeBase58` (with a length of 100) and `DecodeBase58Check`. This provides enough information to properly diagnose errors.\r\n\r\n3. **Provide network-aware error messages**: When an address has an invalid prefix, the error message now includes the expected network values.\r\n\r\n### Changes Made\r\n\r\n#### 1. Add Base58 Encoded Prefixes to ChainParams (`src/kernel/chainparams.cpp`, `src/kernel/chainparams.h`)\r\n\r\n#### 2. Refactor Address Decoding Logic (`src/key_io.cpp`)\r\n\r\n- Decode Bech32 upfront using `bech32::Decode(str)` instead of checking prefix first\r\n- Use structured bindings for cleaner code: `auto [bech32_encoding, bech32_hrp, bech32_chars] = bech32::Decode(str)`\r\n- Improved error handling flow with clearer branching\r\n\r\n#### 3. Improved Error Messages\r\n\r\n| Scenario | Previous Error | New Error |\r\n|----------|---------------|-----------|\r\n| Base58 address with wrong prefix | \"Invalid or unsupported Base58-encoded address.\" | \"Invalid Base58 address. Expected prefix 3, or 1\" |\r\n| Bech32 address with wrong HRP | \"Invalid or unsupported Segwit (Bech32) or Base58 encoding.\" | \"Invalid or unsupported prefix for Segwit (Bech32) address (expected bc, got tb)\" |\r\n| Invalid Base58 checksum | \"Invalid or unsupported Segwit (Bech32) or Base58 encoding.\" | \"Invalid checksum or length of Base58 address (P2PKH or P2SH)\" |\r\n| Ambiguous invalid address | \"Invalid or unsupported Segwit (Bech32) or Base58 encoding.\" | \"Address is not valid Base58 or Bech32\" |\r\n| Bech32 with checksum error | N/A | \"Bech32 address decoded with error: Invalid Bech32 checksum\" |\r\n\r\n#### 4. Test Updates\r\n\r\n- Added `test/functional/data/rpc_validateaddress.json` with comprehensive test vectors for both mainnet and signet\r\n- Updated `test/functional/rpc_validateaddress.py` to use data-driven testing across multiple networks\r\n- Updated `test/functional/rpc_invalid_address_message.py` with new error message expectations\r\n\r\n### Consistency Improvements\r\n\r\n- Removed inconsistent periods at the end of some error messages\r\n- Changed \"Bech32 v0\" to \"SegWit v0\" for clarity\r\n\r\n## Reference\r\n\r\n- Issue: #26290\r\n",
      "state": "open",
      "user": "portlandhodl",
      "created_at": "2023-03-15T10:17:16Z",
      "updated_at": "2026-01-19T12:52:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/27260",
      "labels": [
        "RPC/REST/ZMQ",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 0,
        "text_length": 3213,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2803909911,
      "number": 33324,
      "title": "blocks: add `-reobfuscate-blocks` argument to enable (de)obfuscating existing blocks",
      "body": "### Context\r\n\r\nRecent discussions highlighted that many nodes which synced before Bitcoin Core v28 have their block and undo files stored effectively in the clear (zero XOR key). This patch adds a simple, resumable maintenance tool to obfuscate previously raw block files, rotate an existing key to a fresh random one, or de-obfuscate (set key to zero) if consciously chosen, all without requiring resync. The operation can be cancelled and restarted safely.\r\n\r\n### Implementation\r\n\r\nThe new startup option `-reobfuscate-blocks[=VALUE]` accepts either 16 hex characters as an exact 8-byte XOR key (little-endian in-memory layout) or a boolean to generate a random 64-bit key. e.g. `-reobfuscate-blocks=0000000000000000` sets the key to zero, effectively removing obfuscation.\r\n\r\nIf we detect unobfuscated blocks at start time we suggest this new option in a warning.\r\n\r\nAt startup, we iterate over all undo and block files (grouping the block and undo files for more uniform iteration), read them with the old XOR key and write them back with the new key (`<name>.reobfuscated`). The implementation actually combines the two keys and reads directly into the new obfuscated version to only do a single iteration over the data. This works if the original blocks aren't obfuscated or if the new blocks aren't or if both are.\r\nAfter successful write, we immediately delete the old file. Once all files are staged, we rename them back and atomically swap `xor.dat.reobfuscated` â†’ `xor.dat` and continue operation.\r\n\r\nWe log the old and new keys and print progress roughly per-percent as files complete (i.e. max 100 progress logs).\r\n\r\n### Constraints\r\n\r\n* Re-obfuscation resumes automatically (detected via `xor.dat.reobfuscated`) even without the flag. In worst-case a crash should only force us to redo previous work.\r\n* Single-threaded, processing one file at a time to keep code simple and avoid complexity of interleaving renames and key swaps across threads.\r\n* Fast in practice with sequential read/modify/write per blockfile - after recent obfuscation vectorization, this path is very quick.\r\n\r\n### Reproducer\r\n\r\n```bash\r\ncmake -B build -DENABLE_IPC=ON -DBUILD_GUI=ON\r\ncmake --build build -j$(nproc)\r\n# command line\r\n./build/bin/bitcoind -reobfuscate-blocks -stopatheight=1\r\n# same with GUI\r\n./build/bin/bitcoin-qt -reobfuscate-blocks -stopatheight=1\r\n```\r\n\r\n### Single-threaded Performance\r\n\r\n cpu                 | hdd/ssd | block count | size    | files  | time (min) | blocks/min \r\n---------------------|---------|-------------|---------|--------|------------|------------\r\n Apple M4 Max laptop | SSD     | ~909k       | ~707 GB | 9,982  | 8.4        | 146,613    \r\n Intel Core i9       | SSD     | ~909k       | ~725 GB | 10,238 | 23.1       | 39,351     \r\n Raspberry Pi 5      | SSD     | ~914k       | ~728 GB | 10,276 | 72.78      | 12,558     \r\n Intel Core i7       | HDD     | ~909k       | ~720 GB | 10,156 | 208.7      | 4,356      \r\n Raspberry Pi 4B     | HDD     | ~915k       | ~730 GB | 10,304 | 1467       | 624        \r\n\r\n----\r\n\r\nSimilar work:\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/32451\r\n* https://github.com/andrewtoth/blocks-xor\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-09-05T23:51:29Z",
      "updated_at": "2026-01-19T12:47:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33324",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3246,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3177081870,
      "number": 34303,
      "title": "test: addrman: test self-announcement time penalty handling",
      "body": "This PR adds a test case for addrman that verifies that addresses announcing themselves (addr == source) are exempt from time penalties, while addresses announced by others receive the expected penalty. \r\n\r\nIt fixes the following mutant (https://corecheck.dev/mutation/src/addrman.cpp#L561):\r\n```diff\r\ndiff --git a/src/addrman.cpp b/src/addrman.cpp\r\nindex 206b54118e..c6a045fd8d 100644\r\n--- a/src/addrman.cpp\r\n+++ b/src/addrman.cpp\r\n@@ -558,7 +558,7 @@ bool AddrManImpl::AddSingle(const CAddress& addr, const CNetAddr& source, std::c\r\n     AddrInfo* pinfo = Find(addr, &nId);\r\n\r\n     // Do not set a penalty for a source's self-announcement\r\n-    if (addr == source) {\r\n+    if (addr != source) {\r\n         time_penalty = 0s;\r\n     }\r\n```\r\n",
      "state": "open",
      "user": "brunoerg",
      "created_at": "2026-01-15T12:07:32Z",
      "updated_at": "2026-01-19T12:42:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34303",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 800,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2809021284,
      "number": 33343,
      "title": "help: enrich help text for `-loadblock`",
      "body": "`-loadblock` doesn't support XOR-ed files, mention it in its help text to avoid troubles for users.",
      "state": "open",
      "user": "HowHsu",
      "created_at": "2025-09-08T17:41:11Z",
      "updated_at": "2026-01-19T12:34:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33343",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 139,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2662308871,
      "number": 32958,
      "title": "wallet/refactor: change PSBTError to PSBTResult and remove std::optional<common::PSBTResult> and return common::PSBTResult",
      "body": "### Description\r\nThis is a follow-up to https://github.com/bitcoin/bitcoin/pull/31622#discussion_r2092030045 and https://github.com/bitcoin/bitcoin/pull/31622#discussion_r2092035407\r\n\r\n### What this changes\r\n- Updates `PSBTError` to `PSBTResult`\r\nbecause we now have `PSBTResult::OK`\r\n\r\n- Updates `PSBTErrorString` to `PSBTResultString`\r\n\r\n- Updates `RPCErrorFromPSBTError` to `RPCErrorFromPSBTResult`\r\n\r\n- Removes `std::optional<common::PSBTResult>` and instead returns just `common::PSBTResult`\r\nreplacing when we return `null` with `PSBTResult::OK`\r\n    \r\n    ",
      "state": "open",
      "user": "kevkevinpal",
      "created_at": "2025-07-13T14:06:28Z",
      "updated_at": "2026-01-19T12:11:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32958",
      "labels": [
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 686,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2997112498,
      "number": 33847,
      "title": "kernel: Improve logging API",
      "body": "Simplify kernel logging API and try to connect it to the rest of the kernel API by letting log options be set on `Logger` objects directly and `Logger` objects to be associated with `Context` objects directly. Also drop `logging_disable()` function and avoid having library accumulate log messages in a 1MB buffer by default.\r\n\r\nChanges are intended to make the API a little less surprising and more future proof. Rationale is described in some more detail the commit message.\r\n\r\nThis change is not backwards compatible but I'd expect it to port over pretty smoothly to the language bindings, and offer the same benefits for them as for C/C++ callers.\r\n\r\n",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2025-11-10T23:30:46Z",
      "updated_at": "2026-01-19T12:03:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33847",
      "labels": [
        "Validation",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 683,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2977401488,
      "number": 33779,
      "title": "ci, iwyu: Fix warnings in `src/kernel` and treat them as errors",
      "body": "Now seems like a good time to update the includes in `src/kernel`.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-11-04T17:03:05Z",
      "updated_at": "2026-01-19T11:47:38Z",
      "merged_at": "2026-01-19T11:47:37Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33779",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 130,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2837615883,
      "number": 33421,
      "title": "node: add  `BlockTemplateCache`",
      "body": "This PR implements the first step of #33758 by adding a cache layer for node block templates.\r\n\r\nThe cache stores newly created block templates along with their configuration options. When clients request a block template, they specify the maximum age in `MillisecondsDouble`:\r\n- If a matching template exists in the cache and hasn't exceeded the age limit, the cached version is returned (if multiple exist, the most recent one is returned).\r\n- If no matching template exists or the age limit has been exceeded, a new template is generated, cached, and returned.\r\n\r\nThe cache maintains a configurable maximum size (default: 10 templates). When this limit is exceeded, the oldest template is evicted. This is usually checked after each insertion.\r\n\r\nThe cache subscribes to the validation interface and clears itself when blocks are connected (to non-historical chainstate to avoid clearing during assumeutxo background validation) or disconnected from the active chain (during reorgs), preventing stale or invalid templates from being served.\r\n\r\nWhen `test_block_validity` is set to `true` in the block creation options, any cached template that hasn't been validated will be checked before being returned. We also then update the cached block validity to indicate it has been checked.\r\n\r\nThis PR also removes an unused `node/context.h` import from miner to prevent a potential circular dependency during exposing the block template cache to the node context.\r\n",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2025-09-17T18:47:09Z",
      "updated_at": "2026-01-19T11:41:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33421",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1494,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1010047865,
      "number": 25722,
      "title": "refactor: Use util::Result class for wallet loading",
      "body": "<!-- begin based-on -->\n**This is based on #25665 + #26022.** The non-base commits are:\n\n- [`73a878a4d8a` Add temporary ResultExtract helper for porting to util::Result](https://github.com/bitcoin/bitcoin/pull/25722/commits/73a878a4d8a244260f2832ced426d7854228e3e6)\n- [`e00354ea6a9` refactor: Use util::Result class in wallet/sqlite](https://github.com/bitcoin/bitcoin/pull/25722/commits/e00354ea6a988c5be30f7794eb82a93dfe42f906)\n- [`64f0060ed60` refactor: Use util::Result class in wallet/migrate](https://github.com/bitcoin/bitcoin/pull/25722/commits/64f0060ed60831b20bca3a2c00375b258d1f1835)\n- [`efaf4ae67d4` refactor: Use util::Result class in wallet::MakeDatabase](https://github.com/bitcoin/bitcoin/pull/25722/commits/efaf4ae67d46fa2f18b6e76880fd58392ff7a773)\n- [`b18b069de03` refactor: Use util::Result class in wallet/dump](https://github.com/bitcoin/bitcoin/pull/25722/commits/b18b069de0321b592ef346d4b48e803c3418f078)\n- [`4e488ed72a6` refactor: Use util::Result class in wallet/wallettool](https://github.com/bitcoin/bitcoin/pull/25722/commits/4e488ed72a6a02bc7900b77127134d1fbd46e5af)\n- [`49420333797` refactor: Use util::Result class in wallet/wallet](https://github.com/bitcoin/bitcoin/pull/25722/commits/4942033379714aa37f01aea3af5a786c1c321fd4)\n- [`6bcd21508fc` refactor: Use util::Result class in wallet/load](https://github.com/bitcoin/bitcoin/pull/25722/commits/6bcd21508fc932fd789eb378b5d20f5bdf315cd1)\n- [`77c54af5a42` refactor: Use util::Result class in wallet/rpc](https://github.com/bitcoin/bitcoin/pull/25722/commits/77c54af5a423caf7b81418be2d50d3ab1ffb4e00)\n- [`fc648fbc194` refactor: Use util::Result class in wallet/interfaces](https://github.com/bitcoin/bitcoin/pull/25722/commits/fc648fbc194b7c53719fc808104d64a93f0307f0)\n- [`a96b38a39ff` refactor: Use util::Result class in wallet/test](https://github.com/bitcoin/bitcoin/pull/25722/commits/a96b38a39ff6045a773b012fa1c4392c1ace9e37)\n- [`d10715f06bf` Drop temporary ResultExtract helper for porting to util::Result](https://github.com/bitcoin/bitcoin/pull/25722/commits/d10715f06bf1175209f335d083d9954fa86799c4)\n- [`45da1d9a13b` scripted-diff: replace wallet DatabaseStatus with DatabaseError](https://github.com/bitcoin/bitcoin/pull/25722/commits/45da1d9a13b26d5030354c7d5d874fd59cf35d84)<!-- end -->\n\n---\n\nWallet loading functions up and down the stack have lots of error and warning parameters, and return error information in different ways. This PR makes them uniformly return `util::Result`, without changing behavior.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2022-07-27T19:26:58Z",
      "updated_at": "2026-01-19T11:12:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/25722",
      "labels": [
        "Refactoring",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2555,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2138649533,
      "number": 31132,
      "title": "validation: fetch block inputs on parallel threads 3x faster IBD",
      "body": "_Parts of this PR are isolated in independent smaller PRs to ease review:_\r\n\r\n* [ ] _https://github.com/bitcoin/bitcoin/pull/34164_\r\n* [ ] _https://github.com/bitcoin/bitcoin/pull/34165_\r\n\r\n---\r\n\r\nThis PR parallelizes fetching all input prevouts of a block during block connection, achieving over 3x faster IBD performance in some scenarios[^1][^2][^3][^4][^5].\r\n\r\n### Problem\r\n\r\nCurrently, when fetching inputs in `ConnectBlock`, each input is fetched from the cache sequentially. A cache miss requires a round trip to the disk database to fetch the outpoint and insert it into the cache. Since the database is read-only during `ConnectBlock`, we can fetch all inputs of a block in parallel on multiple threads while connecting.\r\n\r\n### Solution\r\n\r\nWe introduce a new `CoinsViewCacheAsync` `CCoinsViewCache` subclass that manages worker threads to fetch block inputs in parallel. The block is passed to the `CoinsViewCacheAsync` view before entering `ConnectBlock`, which kicks off the worker threads to begin fetching the inputs. The view is then passed to `ConnectBlock` since it provides the same API as `CCoinsViewCache`. The cache returns fetched coins as they become available via the overridden `FetchCoin` method. If not available yet, the main thread also fetches coins as it waits.\r\n\r\n### Implementation Details\r\n\r\nThe `CoinsViewCacheAsync` implements a lock-free MPSC (Multiple Producer, Single Consumer) queue design:\r\n\r\n- **Work Distribution**: Collects all input prevouts into a queue and uses a barrier to start all worker threads simultaneously\r\n- **Synchronization**: Worker threads use an atomic counter to claim which inputs to fetch, and each input has an atomic flag to signal completion to the main thread\r\n- **Main Thread Processing**: The main thread waits for inputs in order and moves their `Coin` into the `cacheCoins` map as they become available.\r\n- **Work Stealing**: If the main thread catches up to the workers, it assists with fetching to maximize parallelism\r\n- **Completion**: All threads synchronize on a barrier via a `Reset` method, which ensures all threads are parked before proceeding\r\n\r\n### Safety and Correctness\r\n\r\n- The `CoinsViewCacheAsync` works on a block that has not been fully validated, but it does not interfere or modify any of the validation during `ConnectBlock`\r\n- It simply fetches inputs in parallel, which must be fetched before a transaction is validated anyways\r\n- **Invalid blocks**: If an invalid block is mined, the temporary cache is reset without being flushed. This is an improvement over the current behavior, where existing inputs are inserted into the main `CoinsTip()` cache when pulled through for an invalid block\r\n\r\n### Performance\r\n\r\nBenchmarks show over 3x faster IBD performance in a cloud environment with network connected storage[^1], 3x faster IBD for an M4 Mac and up to 46% faster with directly connected storage[^2][^3][^4][^5]. The parallelization of expensive disk lookups provides significant speedup.\r\n\r\n[Flamegraphs show how the execution is changed](https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3617315125).\r\n\r\n### Credits\r\n\r\nInspired by [this comment](https://github.com/bitcoin/bitcoin/pull/18941#issuecomment-638553680).\r\n\r\nResolves https://github.com/bitcoin/bitcoin/issues/34121.\r\n\r\n[^1]: https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3678847806\r\n[^2]: https://github.com/bitcoin/bitcoin/pull/31132#pullrequestreview-3515011880\r\n[^3]: https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3463894000\r\n[^4]: https://github.com/bitcoin/bitcoin/pull/31132#pullrequestreview-3347436866\r\n[^5]: https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3488760623",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2024-10-22T14:40:28Z",
      "updated_at": "2026-01-19T11:10:39Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31132",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3751,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1940576733,
      "number": 30342,
      "title": "kernel, logging: Pass Logger instances to kernel objects",
      "body": "Pass `Logger` instances to `BlockManager`, `CCoinsViewDB`, `CDBWrapper`, `Chainstate`, `ChainstateManager`, `CoinsViews`, and `CTxMemPool` classes so libbitcoinkernel applications and tests have the option to control where log output goes instead of having all output sent to the global logger.\n\nThis PR is an alternative to #30338. It is more limited because it only changes kernel code while leaving other parts of the codebase alone. It also takes the opportunity to migrate legacy LogPrint / LogPrintf calls to the new log macros introduced in #28318.\n\n---\n\n<!-- begin based-on -->\n**This is based on #29256 + #33847.** The non-base commits are:\n\n- [`3c210f2aaa8` refactor: Pass Logger instances to kernel objects](https://github.com/bitcoin/bitcoin/pull/30342/commits/3c210f2aaa8fa1b9d05bc373dc1949e06e53e995)\n- [`94b7e242150` refactor: Log kernel output to local log instances](https://github.com/bitcoin/bitcoin/pull/30342/commits/94b7e242150a3811aeefff580d389913d9804642)\n- [`ae8c7f24a2d` refactor: Pass Logger instance to CTxMemPool](https://github.com/bitcoin/bitcoin/pull/30342/commits/ae8c7f24a2d1fdcfbc80da764aa02a42d1488224)\n- [`d6c23d4219b` kernel: Drop global Logger instance](https://github.com/bitcoin/bitcoin/pull/30342/commits/d6c23d4219b30dc8e045f4c6b90a7ad493faf383)<!-- end -->",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-06-26T17:52:24Z",
      "updated_at": "2026-01-19T11:09:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30342",
      "labels": [
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1357,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2876629729,
      "number": 33512,
      "title": "coins: use number of dirty cache entries in flush warnings/logs",
      "body": "Revival of https://github.com/bitcoin/bitcoin/pull/31703 with all outstanding review feedback addressed.\r\n\r\n<details>\r\n<summary>Changes compared to the original</summary>\r\n\r\n* `EmplaceCoinInternalDANGER` is also fuzz tested now\r\n* Warning and logging moved from `FlushStateToDisk` to `CCoinsViewDB::BatchWrite`, ensuring `AssumeUTXO` snapshot writes also display progress warnings\r\n* Removed the redundant changed counter in `BatchWrite` since we now track `dirty_count` directly\r\n* All instances use `dirty_count` (not num_dirty) and parameter alignment is corrected\r\n\r\n</details>\r\n\r\n----\r\n\r\n> Since #28280 and #28233, the percentage of dirty entries in the cache when a flush happens may in practice be far from 100%. The log output, the decision to warn about a large flush (#31534), and the disk-full detection, however always use the entire size of the cache.\r\n>\r\n> Fix this by keeping track of the number of dirty entries in `CCoinsViewCache`, and using that number. We've dropped the usage of `DynamicMemoryUsage` as it's the wrong metric, even before the non-wiping flushes were introduced (if everything is dirty, memory usage is correlated with, but not the same as, the amount of disk space written or used). They could be improved by keeping track of proper write size estimates in a follow-up, but here we're just using a fixed 48 bytes per entry estimate.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-10-01T02:24:51Z",
      "updated_at": "2026-01-19T11:01:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33512",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 2,
        "text_length": 1433,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2015890161,
      "number": 30643,
      "title": "coins: Add move operations to Coin and CCoinsCacheEntry",
      "body": "Related to https://github.com/bitcoin/bitcoin/pull/28280#discussion_r1703187118, the CI build had a Sonar warning, namely:\r\n> \"std::move\" should not be called on an object of a type with neither move constructor nor move-assignment operator.\r\n\r\nAdded defaulted move constructor and move assignment operator to `CCoinsCacheEntry`.\r\n\r\nBased on comments I've also added explicit special member functions to `Coin`.",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2024-08-12T21:14:44Z",
      "updated_at": "2026-01-19T10:56:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30643",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 467,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2041914050,
      "number": 30732,
      "title": "build: improve cxx and linker flag caching",
      "body": "Migration of https://github.com/hebasto/bitcoin/pull/340\r\n\r\n`try_append_cxx_flags` and `try_append_linker_flag` are CMake functions used to test and conditionally apply compiler and linker flags to ensure compatibility with the build environment.\r\n\r\nCurrently the only case when the `SOURCE` parameter was overwritten was [bitcoin/bitcoin@8b6f1c4/CMakeLists.txt#L383-L389](https://github.com/bitcoin/bitcoin/blob/8b6f1c4353836bae6aa683cbc65251165bd031ba/CMakeLists.txt#L383-L389).\r\nSo currently the values would be unique without the hash, but overwriting a source in the future would cause a false hit, so I kept the full (uppercase) hash - and also added the `werror_flag` to the cache key, since the result of the compilation depends on it as well.\r\n\r\nAfter this change we will have logs such as:\r\n```\r\n-- Performing Test CXX_SUPPORTS__FSANITIZE_UNDEFINED_ADDRESS_FUZZER\r\n-- Performing Test CXX_SUPPORTS__FSANITIZE_UNDEFINED_ADDRESS_FUZZER - Success\r\n-- Performing Test LINKER_SUPPORTS__FSANITIZE_UNDEFINED_ADDRESS_FUZZER__WL__FATAL_WARNINGS_A797852B32447D9D3594B7F06EFE65790DAAEFCBEFCE4144D7B1F480F6FA4B6A\r\n-- Performing Test LINKER_SUPPORTS__FSANITIZE_UNDEFINED_ADDRESS_FUZZER__WL__FATAL_WARNINGS_A797852B32447D9D3594B7F06EFE65790DAAEFCBEFCE4144D7B1F480F6FA4B6A - Success\r\n-- Performing Test FUZZ_BINARY_LINKS_WITHOUT_MAIN_FUNCTION\r\n-- Performing Test FUZZ_BINARY_LINKS_WITHOUT_MAIN_FUNCTION - Success\r\n```\r\n\r\nOn top of that, `try_append_cxx_flags` currently doesn't even need a `SOURCE` parameter - I've removed it for now, we can add it back once we need it.",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2024-08-28T13:05:55Z",
      "updated_at": "2026-01-19T10:56:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30732",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1608,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2082789840,
      "number": 30936,
      "title": "doc: Add `nproc` support for Mac through `coreutils`",
      "body": "See: https://www.gnu.org/software/coreutils/manual/html_node/nproc-invocation.html\r\n\r\nRevival of a failed attempt in https://github.com/bitcoin/bitcoin/pull/30619\r\n\r\nYou can test on your mac via:\r\n```bash\r\n% echo $(nproc)\r\ncommand not found: nproc\r\n```\r\n```bash\r\n% brew install coreutils\r\n...\r\n% echo $(nproc)\r\n10\r\n```",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2024-09-20T09:44:04Z",
      "updated_at": "2026-01-19T10:56:25Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30936",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 371,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2887599768,
      "number": 33540,
      "title": "argsman, cli: GNU-style command-line option parsing (allows options after non-option arguments)",
      "body": "This PR simplifies the argument parsing logic and resolves practical issues for `bitcoin-cli` and similar binaries (e.g. `bitcoin-wallet`) making their usage more consistent and predictable, enabling valid patterns such as mixing commands with wallet- or RPC-specific optionsâ€”without relying on argument ordering quirks.\r\n\r\n<details>\r\n<summary>What's changed in ArgsManager that allows the above.</summary>\r\n\r\n- Previously, `ArgsManager` stopped interpreting options once a non-option argument was encountered (non-GNU parsing). For example:\r\n\r\n        bitcoind -a -b param -c\r\n\r\n  would ignore `-c` because it followed the non-option argument `param`. In some cases '-c' is interpreted as an argument for 'param', producing unexpected behavior (eg empty arrays for listtransactions command).\r\n\r\n- This PR changes the behavior so that options following non-option argument are recognized and processed (GNU parsing). This is needed for workflows for tools like CLI where command arguments may be followed by wallet- or RPC-specific\r\noptions, e.g.:\r\n\r\n        bitcoin-cli -rpcwallet=\"\" listtransactions -rpcwallet=mywallet\r\n    \r\n        bitcoin-cli getaddressinfo <address> -rpcwallet=mywallet\r\n\r\n- (other binaries could also benefit from this change,  e.g. `bitcoin-wallet`)\r\n\r\n        bitcoin-wallet create -wallet=newname\r\n\r\n- Invalid options passed after non-options will be treated as RPC arguments that begin with a `-` character (so no\r\nbehavioural change against `master`), e.g.:\r\n\r\n        bitcoin-cli -regtest -datadir=/tmp/btc createwallet -mywallet\r\n        {\r\n            \"name\": \"-mywallet\"\r\n        }\r\n\r\n</details>\r\n\r\n<details><summary>Before and after outputs running RPC commands from <code>CLI</code>/ <code>bitcoin-cli</code>.</summary><ul>\r\n     <li><details><summary>wallet commands using <code>CLI</code>:</summary><ul> \r\n           <li><details><summary><code>getaddressinfo</code></summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc getaddressinfo bcrt1qrnz5xlcwz5d85n3fag6v0vc4lryjc90jhqtpsh -rpcwallet=nonExistent\r\nerror message:\r\ngetaddressinfo \"address\"\r\n...\r\n```\r\n</li>\r\n           <li>after\r\n\r\n```\r\n./build/bin/bitcoin-cli -regtest -datadir=/tmp/btc getaddressinfo bcrt1qrnz5xlcwz5d85n3fag6v0vc4lryjc90jhqtpsh -rpcwallet=nonExistent\r\nerror code: -18\r\nerror message:\r\nRequested wallet does not exist or is not loaded\r\n```\r\n\r\n</li>\r\n           </ul></details></li>\r\n           <li><details><summary><code>listtransactions</code></summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=nonExistent\r\n[\r\n]\r\n```\r\n\r\n</li>\r\n           <li>after\r\n\r\n\r\n```\r\n./build/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=nonExistent\r\nerror code: -18\r\nerror message:\r\nRequested wallet does not exist or is not loaded\r\n```\r\n\r\n</li>\r\n           </ul></details></li>\r\n           <li><details><summary>any command that needs an option to be specifed, it can be added at the end directly instead of before the command</summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions\r\nerror code: -19\r\nerror message:\r\nMultiple wallets are loaded. Please select which wallet to use by requesting the RPC through the /wallet/<walletname> URI path. Or for the CLI, specify the \"-rpcwallet=<walletname>\" option before the command (run \"bitcoin-cli -h\" for help or \"bitcoin-cli listwallets\" to see which wallets are currently loaded).\r\n```\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=\"\"\r\nerror code: -19\r\nerror message:\r\nMultiple wallets are loaded. Please select which wallet to use by requesting the RPC through the /wallet/<walletname> URI path. Or for the CLI, specify the \"-rpcwallet=<walletname>\" option before the command (run \"bitcoin-cli -h\" for help or \"bitcoin-cli listwallets\" to see which wallets are currently loaded).\r\n```\r\n\r\n</li>\r\n           <li>after\r\n\r\n```\r\n/build/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=\"\"\r\n[\r\n  {\r\n    \"address\": \"bcrt1q5pqkrlfrp9rvsg43sxxagrees7r7ul6uyskhs4\",\r\n    \"parent_descs\": [\r\n      \"wpkh([76a11ab0/84h/1h/0h]tpubDCDCuyC1Rtm1weZ5kfBYtdchcmqa2t8db7M68wsPHbWhUrYnzFTrHu7ufVVRydt3FdWQy8iNmKbZYbgpWWcEKPAj896x53UbS6i2xRD1qct/0/*)#kuff3m9t\"\r\n    ],\r\n    \"category\": \"immature\",\r\n    \"amount\": 50.00000000,\r\n    \"label\": \"\",\r\n...\r\n```\r\n\r\n</li>\r\n           </ul></details></li>\r\n     </ul></details></li>\r\n     <li><details><summary>other binaries could benefit from it, e.g. <code>bitcoin-wallet:</code></summary><ul> \r\n           <li><details><summary><code>create</code> command</summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-wallet -regtest -datadir=/tmp/btc create\r\nWallet name must be provided when creating a new wallet.\r\n```\r\n_(`-wallet` option has to be passed before the `create` command in order to work)_\r\n```\r\n./build_master/bin/bitcoin-wallet -regtest -datadir=/tmp/btc create -wallet=newWalletName\r\nError: Additional arguments provided (-wallet=newWalletName). Methods do not take arguments. Please refer to `-help`.\r\n```\r\n\r\n</li>\r\n           <li>after\r\n\r\n```\r\n./build/bin/bitcoin-wallet -regtest -datadir=/tmp/btc create -wallet=newWallet\r\nTopping up keypool...\r\nWallet info\r\n===========\r\nName: newWallet\r\nFormat: sqlite\r\nDescriptors: yes\r\nEncrypted: no\r\nHD (hd seed available): yes\r\nKeypool Size: 8000\r\nTransactions: 0\r\nAddress Book: 0\r\n```\r\n</li>\r\n           </ul></details></li>\r\n     </ul></details></li>\r\n     </ul> <!-- End -->\r\n</details>\r\n\r\n-<ins>_**Notes**_</ins>:\r\n\r\n- <ins>Backwards compatibility</ins>:\r\nThis PR is backward compatible in the sense that it allows new valid invocations that were previously rejected (failed or somehow ignored).\r\nIn `master`, any valid option following a command is treated as a positional argument. This can lead to unexpected RPC errors or help messages due to mismatched argument types. With this PR, those cases are parsed as proper options when applicable.\r\n\r\n- `bitcoin-cli` continues to accept RPC arguments that begin with a `-` character as currently in `master` (check `createwallet` example in _\"What's change in ArgsManager\"_ section above).\r\n\r\n- `bitcoin-cli` could distinguish between options that begin with single and double dashes, and treat options after the RPC method name that begin with double dashes as RPC named parameters (check example in 4th [commit](https://github.com/bitcoin/bitcoin/pull/33540/commits/a101bbb61fdf5563337334d63a10432432ee3625) message body).\r\n\r\n- Refactored both `ArgsManager::ProcessOptionKey` (new function added in this PR) and `ArgsManager::ParseParameters` in separated commits making the code clearer and the PR much easier to follow and review.",
      "state": "open",
      "user": "pablomartin4btc",
      "created_at": "2025-10-04T22:43:06Z",
      "updated_at": "2026-01-19T10:50:50Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33540",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 2,
        "text_length": 6987,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2925411752,
      "number": 33646,
      "title": "log: check fclose() results and report safely in logging.cpp",
      "body": "`fclose()` can report write errors (for example if the disk is full or the filesystem has a problem). Right now, some `fclose()` calls in `src/logging.cpp` ignore the return value. This means errors might go unnoticed and log lines could be lost without warning.\r\n\r\n## What this PR does:\r\n- Add a small helper that prints `fclose()` errors to `stderr` (with path and errno).\r\n- In shutdown: close `m_fileout` safely and report errors.\r\n- In reopen: open the new file, swap it in, close the old one, and report errors if closing fails.\r\n- In shrink/rotate: check all `fclose(file)` calls and report failures.\r\n\r\nNo other behavior changes. Normal logging, rotation, and console output remain unchanged.",
      "state": "open",
      "user": "cedwies",
      "created_at": "2025-10-17T19:06:08Z",
      "updated_at": "2026-01-19T10:23:56Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33646",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 761,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2937452835,
      "number": 33680,
      "title": "validation: do not wipe utxo cache for stats/scans/snapshots",
      "body": "Revival of https://github.com/bitcoin/bitcoin/pull/30610#issuecomment-3432564955 with the remaining comments applied on top\r\n\r\n> Since #28280, the cost of a non-wiping sync of the UTXO cache is only proportional to the number of dirty entries, rather than proportional to the size of the entire cache. Because of that, there is no reason to perform a wiping flush in case the contents of the cache is still useful.\r\n> \r\n> Split the `FlushStateMode::ALWAYS` mode into a FORCE_SYNC (non-wiping) and a FORCE_FLUSH (wiping), and then use the former in `scantxoutset`, `gettxoutsetinfo`, snapshot creation.\r\n\r\n(slightly updated after #30214)",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-10-22T14:46:09Z",
      "updated_at": "2026-01-19T10:11:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33680",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 697,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2940741002,
      "number": 33689,
      "title": "http: replace WorkQueue and single threads handling for ThreadPool",
      "body": "This has been a recent discovery; the general thread pool class created for #26966, cleanly \r\nintegrates into the HTTP server. It simplifies init, shutdown and requests execution logic.\r\nReplacing code that was never unit tested for code that is properly unit and fuzz tested.\r\nAlthough our functional test framework extensively uses this RPC interface (thatâ€™s how\r\nweâ€™ve been ensuring its correct behavior so far - which is not the best).\r\n\r\nThis clearly separates the responsibilities:\r\nThe HTTP server now focuses solely on receiving and dispatching requests, while ThreadPool handles\r\nconcurrency, queuing, and execution.\r\n\r\nThis will also allows us to experiment with further performance improvements at the task queuing and\r\nexecution level, such as a lock-free structure or task prioritization or any other implementation detail\r\nlike coroutines in the future, without having to deal with HTTP code that lives on a different layer.\r\n\r\nNote:\r\nThe rationale behind introducing the ThreadPool first is to be able to easily cherry-pick it across different\r\nworking paths. Some of the ones that are benefited from it are #26966 for the parallelization of the indexes\r\ninitial sync, #31132 for the parallelization of the inputs fetching procedure, #32061 for the libevent replacement,\r\nthe kernel API #30595 (https://github.com/bitcoin/bitcoin/pull/30595#discussion_r2413702370) to avoid blocking validation among others use cases not publicly available.\r\n\r\nNote 2:\r\nI could have created a wrapper around the existing code and replaced the `WorkQueue` in a subsequent\r\ncommit, but it didnâ€™t seem worth the extra commits and review effort. The `ThreadPool` implements\r\nessentially the same functionality in a more modern and cleaner way.",
      "state": "open",
      "user": "furszy",
      "created_at": "2025-10-23T14:36:44Z",
      "updated_at": "2026-01-19T10:09:03Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33689",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1804,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2743753242,
      "number": 33186,
      "title": "wallet, test: Ancient Wallet Migration from v0.14.3 (no-HD and Single Chain)",
      "body": "This PR adds test coverage for migrating legacy Bitcoin Core wallets from v0.14.3 (released in 2017) to the descriptor wallet format. The test validates that users can safely upgrade their wallets while preserving all funds, transaction history, and addresses.\r\n\r\nThis test was originally developed on top of #32977, as it was requested in reviews.\r\nHowever, since it also increases test coverage, it can be merged independently.\r\n\r\nThe test covers two wallet migration scenarios:\r\n\r\n* Non-HD Wallet Migration - Tests migration of non-HD wallets (created with `-usehd=0`)\r\n* Single Chain HD Wallet Migration - Tests migration of HD wallets from v0.14.3 (`VERSION_HD_BASE`)\r\n\r\nThe node v0.14.3 cannot be synced because it doesn't have the `syncwithvalidationinterfacequeue` RPC implemented (required by `test_framework.py`), so the solution is to copy the `block` folder to the modern node and start it with `-reindex-chainstate`. Because of this additional complexity, this testing is best managed in a separate file rather than in the existing migration test files.\r\n\r\n",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2025-08-13T18:50:30Z",
      "updated_at": "2026-01-19T10:02:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33186",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1147,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3057433137,
      "number": 33977,
      "title": "script: Remove dead code from OP_CHECKMULTISIG",
      "body": "The stack size check before the dummy element check in OP_CHECKMULTISIG is redundant. The stack is previously validated to have least *i* elements (where *i* is number of pubkeys + number of signatures + 3), and then *i* - 1 elements are popped off the stack, leaving at least one element still in.\r\n\r\nThe redundant check was added in #3843 (commit 6380180821917c22ecfd89128ee60aae6f4cac33). There it's easy to see why it's redundant â€“ it's inserted into a code path where another `popstack` would previously follow.\r\n\r\nNote the missing code coverage: https://maflcko.github.io/b-c-cov/total.coverage/src/script/interpreter.cpp.gcov.html#L1200",
      "state": "open",
      "user": "vostrnad",
      "created_at": "2025-12-01T02:29:46Z",
      "updated_at": "2026-01-19T09:57:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33977",
      "labels": [
        "Consensus"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 690,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2999254279,
      "number": 33854,
      "title": "fix assumevalid is ignored during reindex",
      "body": "During a reindex, the assumevalid setting may be ignored if the chainwork of the best header is below `minimumchainwork`. This happens when the previous IBD was stopped before connecting enough blocks to reach the required `minimumchainwork`. The assumevalid block will also be missing from the block index because the assumevalid block is set to match the `minimumchainwork`. See [Issue #31494](https://github.com/bitcoin/bitcoin/issues/31494).\r\n\r\nAs a result, `reindex` can take significantly longer to complete than necessary.\r\n\r\nThis PR addresses the issue by modifying reindex behaviour: if the chainwork of the `best_header` is below `minimumchainwork`, the node skips the `ActivateBestChain()` step and proceeds directly to synchronisation.\r\n\r\nThis PR takes a different approach from [PR #31615](https://github.com/bitcoin/bitcoin/pull/31615) to keep the validation path for `reindex` the same as the regular IBD validation path.\r\n\r\nDevelopers benchmarking IBD with `-reindex` may find this behaviour undesirable. In such cases, itâ€™s recommended to use `-reindex-chainstate` instead or ensure that the available blocks have sufficient chainwork.\r\n\r\n`libbitcoinkernel` exposes the `ImportBlocks` function and expects `reindex` to connect blocks, so an attempt was made to preserve the existing behaviour for `libbitcoinkernel`.",
      "state": "open",
      "user": "Eunovo",
      "created_at": "2025-11-11T14:21:14Z",
      "updated_at": "2026-01-19T09:32:57Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33854",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1375,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3013940276,
      "number": 33878,
      "title": "refactor, docs: Embedded ASMap [2/3]: Refactor asmap internals and add documentation",
      "body": "This is a second slice carved out of #28792. It contains the following changes that are crucial for the embedding of asmap data which is added the following PR in the series (probably this will remain in #28792).\r\n\r\nThe changes are:\r\n- Modernizes and simplifies the asmap code by operating on `std::byte` instead of bits\r\n- Unifies asmap version calculation and naming (previously it was called version and checksum interchangeably)\r\n- Operate on a `span` rather than a vector in the asmap internal to prevent holding the asmap data in memory twice\r\n- Add more extensive documentation to the asmap implementation\r\n- Unify asmap casing in implemetation function names\r\n\r\nThe first three commits were already part of #28792, the others are new.\r\n\r\nThe documentation commit came out of feedback gathered at the latest CoreDev. The primary input for the documentation was the documentation that already existed in the Python implementation (`contrib/asmap/asmap.py`) but there are several other comments as well. Please note: I have also asked several LLMs to provide suggestions on how to explain pieces of the implementation and better demonstrate how the parts work together. I have copied bits and pieces that I liked but everything has been edited further by me and obviously all mistakes here are my own. ",
      "state": "open",
      "user": "fjahr",
      "created_at": "2025-11-15T20:50:29Z",
      "updated_at": "2026-01-19T09:21:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33878",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1392,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3090774381,
      "number": 34047,
      "title": "cmake: Add fail pattern to `try_append_cxx_flags`",
      "body": "This PR addresses scenarios where the build environment, such as OSS-Fuzz, provides the `-Wno-error=unknown-warning-option` flag, which undermines our use of `-Werror` when checking compiler flags.\r\n\r\nTo reproduce the issue on the master branch @ c1f0a89d9caeb62a0a5f3462b454746941e626e6:\r\n```\r\n$ env CXX=clang++ CC=clang CXXFLAGS=\"-Wno-error=unknown-warning-option\" cmake -B build 2>&1 | grep WDUPLICATED_BRANCHES\r\n-- Performing Test CXX_SUPPORTS__WDUPLICATED_BRANCHES\r\n-- Performing Test CXX_SUPPORTS__WDUPLICATED_BRANCHES - Success\r\n```\r\n\r\nThis output shows that the `-Wduplicated-branches` flag is incorrectly treated as recognised by the compiler.\r\n\r\nNoticed while working on the [migration](https://github.com/google/oss-fuzz/pull/14457) to Ubuntu 24.04 in OSS-Fuzz.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-12-10T21:14:51Z",
      "updated_at": "2026-01-19T09:05:59Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34047",
      "labels": [
        "Build system",
        "DrahtBot Guix build requested"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 822,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3054115118,
      "number": 33965,
      "title": "mining: fix -blockreservedweight shadows IPC option",
      "body": "Also enforce `MINIMUM_BLOCK_RESERVED_WEIGHT` for IPC clients.\r\n\r\nThe `-blockreservedweight` startup option should only affect RPC code, because IPC clients (currently) do not have a way to signal their intent to use the node default (the `BlockCreateOptions` struct defaults merely document a recommendation for client software).\r\n\r\nBefore this PR however, if the user set `-blockreservedweight` then `ApplyArgsManOptions` would cause the `block_reserved_weight` option passed by IPC clients to be ignored. _Users who don't set this value were not affected._\r\n\r\nFix this by making BlockCreateOptions::block_reserved_weight an\r\nstd::optional.\r\n\r\nInternal interface users, such as the RPC call sites, don't set a\r\nvalue so -blockreservedweight is used. Whereas IPC clients do set\r\na value which is no longer ignored.\r\n\r\nTest coverage is added, with a preliminary commit that refactors the `create_block_template` and `wait_next_template` helpers.\r\n\r\n`mining_basic.py` already ensured `-blockreservedweight` is enforced by mining RPC methods. The second commit adds coverage for Mining interface IPC clients. It also verifies that `-blockreservedweight` has no effect on them.\r\n\r\nThe third commit enforces `MINIMUM_BLOCK_RESERVED_WEIGHT` for IPC clients. Previously lower values were quietly clamped.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-28T13:38:33Z",
      "updated_at": "2026-01-19T08:55:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33965",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1349,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3054407979,
      "number": 33966,
      "title": "refactor: disentangle miner startup defaults from runtime options",
      "body": "The interaction between node startup options like `-blockreservedweight` and runtime options, especially those passed via IPC, is confusing.\r\n\r\nThey're combined in `BlockAssembler::Options`, which this PR gets rid of in favour of two distinct structs:\r\n\r\n1. `BlockCreateOptions`: used by interface clients. As before, IPC clients have access to a safe / sane subset, whereas RPC and test code can use all fields.\r\n2. `MiningArgs`: these are set once during node startup\r\n\r\nBoth structs have a member for the maximum block height, which is not a problem since they're different structs. The one on `MiningArgs` (`block_max_weight`) matches `-maxblockheight` and is left alone. The one on `BlockCreateOptions` (`block_max_weight`) is an optional, it's set by `ApplyMiningDefaults` only if empty. \r\n\r\nThis all happens in the last commit and requires some preparation to keep things easy to review.\r\n\r\nWe get rid of `BlockAssembler::Options` but this is used in many tests. Since large churn is inevitable, we might as well switch all tests, bench and fuzzers over to the Mining interface. The first (non-base) commit does that, dramatically reducing direct use of `BlockAssembler`. Two exceptions are documented in the commit message. Because `test_block_validity` wasn't available via the interface and the block_assemble benchmark needs it, it's moved from `BlockAssembler::Options` to `BlockCreateOptions` (still not exposed via IPC).\r\n\r\nWe need access to mining related defaults and structs from both the miner and node initialization code. To avoid having to pull in all of `BlockAssembler` for the latter, the second commit introduces `node/mining.h` and moves constants and structs there from `src/node/types.h` (`BlockCreateOptions`, `BlockWaitOptions`, `BlockCheckOptions`) and `src/node/miner.h` (`DEFAULT_PRINT_MODIFIED_FEE`).\r\n\r\nI considered also moving `DEFAULT_BLOCK_MAX_WEIGHT`, `DEFAULT_BLOCK_RESERVED_WEIGHT`, `MINIMUM_BLOCK_RESERVED_WEIGHT` and `DEFAULT_BLOCK_MIN_TX_FEE` there from `policy.h`, since they are distinct from relay policy and not needed by the kernel. But this seems more appropriate for a follow-up and requires additional discussion.\r\n\r\nThe meat and potatoes of this PR is split between the three last commits for easier review:\r\n\r\n1. Adds `node/mining_args.{h,cpp}` and move the options checking out of `init.cpp`, without adding storage\r\n2. Add `block_max_weight` to `BlockCreateOptions` as explained above\r\n3. Introduce the `MiningArgs` struct, add it to the `NodeContext`, expand `mining_args.cpp` to store it, pass it to `BlockAssembler`, etc.\r\n\r\nI kept variable renaming and other formatting changes to a minimum to ease review with `--color-moved=dimmed-zebra`.\r\n\r\nThis PR builds on the bug fix in:\r\n- [ ] #33965\r\n\r\nOnce that is merged, this PR should not change behaviour.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-28T15:42:31Z",
      "updated_at": "2026-01-19T08:52:33Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33966",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2878,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3070554287,
      "number": 34004,
      "title": "Implementation of SwiftSync",
      "body": "Link to the original protocol writeup found [here](https://gist.github.com/RubenSomsen/a61a37d14182ccd78760e477c78133cd). See the [Delving Bitcoin post](https://delvingbitcoin.org/t/swiftsync-speeding-up-ibd-with-pre-generated-hints-poc/1562) for initial works and discussion.\r\n\r\n# Motivation\r\n\r\nWhile many coins are available in cache when spent, every cache miss requires a trip to the disk. Memory can be scarce for single board machines, so cache misses are expected to be far more frequent. A trip to disk is all-the-more severe on low end hardware, so any minimization of disk interactions can speed up initial block download for limited resource devices. One such example may be a block template provider serving a home miner.\r\n\r\n# Intuition\r\n\r\nThe vast majority of coins created are later spent. The cost of this observation is many coins will be written to disk, only to be removed later. The SwiftSync protocol alleviates the problem by recording what coins have been added and removed with a small, in-memory aggregate. This allows for the removal of intermediate coin states until SwiftSync has completed. The state of the aggregate is verified at a predetermined chain height, and IBD continues as usual thereafter.\r\n\r\nFor any chain height, we know `all outputs - all inputs = UTXO set`, which is equivalently `all outputs - UTXO set = all inputs`. The goal is to verify the set `all outputs - UTXO set` is equal to `all inputs`. Addition and subtraction modulo a field offers a way to do so. For any set, if we add all elements of the set and subtract them, regardless of ordering, we will arrive at zero. In the current implementation, the set elements being compared are hashed outpoints.\r\n\r\nThe SwiftSync protocol is comprised of two structures. First, the aggregate that will record the state of what outpoints have been added (created) or subtracted (spent). Next, notice that the UTXO set must be reported in order to verify `all outputs - UTXO set = all inputs`. SwiftSync introduces a hints file, which may be provided to the client at startup. This hints file is nothing more than a pointer to each unspent output by recording the block height and the indexes that will remain unspent. By using this file, a client may omit outpoints that will be in the UTXO set when updating the aggregate. Note this file is not trusted. If a malicious actor provides a faulty UTXO set, the set comparison above will fail, and the client may begin a reindex.\r\n# Implementation\r\n\r\n## Aggregate\r\n\r\nThe hash aggregate takes outpoints, hashes them with a salted hasher, and updates 4, 64-bit limbs with wrapping modulo arithmetic. The choice of 4, 64-bit limbs with no carries between limbs was made to: 1. minimize code complexity within the aggregate 2. conform to existing APIs, namely `uint256`. After adding and subtracting some arbitrary list of outpoints, we may poll if the sets were equivalent with `IsZero`.\r\n## Hintsfile\r\n\r\nThe hints file is a map of block height to the indexes of the outputs in that block that _will_ be in the UTXO set. To construct this file for a particular UTXO set state, each block must be read and queried to find the outputs in that block that remain unspent. Because this is a read-only operation, this may be done on parallel threads in the future. To allow for parallelization, the hints file contains a \"contents\" section, which denotes the height and corresponding file position to find the hints for that block.\r\n\r\nTo save space when representing the indexes that remain unspent in a block, an easy choice is to take the difference between the last coin that was unspent and the next one in the block. AFICT this is a version of run-length-encoding. These indexes are encoded using `compactSize` to further save space, the run-lengths should normally fit into at least 16 bits, often 8 bits.\r\n## Parameter Interaction\r\n\r\nA side effect of omitting intermediate UTXO states while performing IBD is the \"undo data\" cannot be derived. There are already configurations that do not have full undo data history, namely pruned nodes. To avoid additional complexity in this PR, this version of accelerated IBD is only made available to pruned nodes, as the undo data would have been removed regardless of the this setting.\r\n\r\nOther parameter interactions, not yet implemented:\r\n- `assumeutxo`: Startup should fail if both are configured. A hints file will have no effect, as the UTXO set is already present.\r\n- `assumevalid`: A natural choice is to only allow SwiftSync when using `assumevalid`, and to only allow a hints file that commits to the `assumevalid` block. Similar to `assumeutxo`, a hash of the hints file may be committed to in the binary, which would be resistant to griefing attacks.\r\n# Testing [Linux example]\r\n\r\nIn your `bitcoin` directory, download the hints from the test server:\r\n\r\n```bash\r\ncurl -o signet.hints http://utxohints.store/hints/signet\r\n```\r\n\r\nVerify the hash of the file:\r\n\r\n```bash\r\necho \"2b625392ecb2adba2b5f9d7b00c8f3a8adca0d3c  signet.hints\" | sha1sum --check -\r\n```\r\n\r\nBuild the branch:\r\n\r\n```bash\r\ncmake -B build && cmake --build build -j $(nproc)\r\n```\r\n\r\nRemove existing chain state:\r\n\r\n```bash\r\nrm -rf ~/.bitcoin/signet/\r\n```\r\n\r\nProvide the file at startup:\r\n\r\n```bash\r\n./build/bin/bitcoind --chain=signet --utxohints=./signet.hints --prune=550\r\n```\r\n\r\n#### Other networks:\r\n- ~Testnet4: endpoint `http://utxohints.store/hints/testnet4`, expected checksum `7acbb25b651ffc5ebc59c46fd065a510c149f00e  testnet4.hints`~\r\n\r\n# Open Questions\r\n\r\n- Given the outcome of SwiftSync is pass/fail, and there is no use of intermediate states, should blocks be persisted to disk at all during the protocol?\r\n- To what degree should a hints file be committed to in the binary. No commitment allows for a server to provide hints for an arbitrary height, providing a convenience for the client, but opens up the possibility of a grief attack. Of course the server risks losing reputation for serving faulty files.\r\n\r\n# Future Iteration\r\n\r\nThis is the first iteration of the SwiftSync proposal, however more optimizations may be made. Namely, because set elements may be added or subtracted from the aggregate in any order, blocks may be downloaded in parallel from multiple peers. If you are interested in benchmarking the performance of a fully-parallel version, see the [Rust implementation](https://github.com/2140-dev/swiftsync).\r\n",
      "state": "open",
      "user": "rustaceanrob",
      "created_at": "2025-12-04T09:50:39Z",
      "updated_at": "2026-01-19T08:38:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34004",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 1,
        "text_length": 6426,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3087630130,
      "number": 34037,
      "title": "wallet, doc: clarify the coin selection filters that enforce cluster count",
      "body": "Followup to #33629.\r\n\r\nFix misleading docs and variable names. Namely, `getTransactionAncestry` returns the cluster count, not max descendant count of ancestor set (not worth reimplementing as it is merely a heuristic). No behavior changes - I donâ€™t think much needs to be changed for the first release containing cluster mempool. \r\n\r\nCurrent `CoinEligibilityFilter`s enforce a maximum ancestor count (summed across all outputs, potentially overestimating) and max descendant count across ancestors of the output.\r\n\r\nSince #33629, these filters have started using cluster count instead of max desc count across ancestors. The change isnâ€™t dangerous, as the cluster count bounds descendant count as well. Currently, the wallet is essentially enforcing a mixture of both limits - this is good while we are transitioning. Note that the cluster count enforced is 25, not 64, since it's grabbing the node's descendant count limit. While it is not an apples-to-apples comparison, a cluster count limit of 25 helps us avoid busting legacy descendant limits (which will be common on the network for a while).\r\n\r\nPotential things for the future, out of scope for this PR:\r\n- When we get rid of the ancestor/descendant config options, `getPackageLimits` can probably be replaced with hard-coded values.\r\n- Change the `OutputGroup`s to track the actual cluster count that results from spending these outputs and merging their clusters.\r\n- Loosen from 25 after that policy is no longer common.\r\n- Clean up `getPackageLimits`.",
      "state": "open",
      "user": "glozow",
      "created_at": "2025-12-10T01:28:11Z",
      "updated_at": "2026-01-19T08:21:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34037",
      "labels": [
        "Docs",
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1588,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3088060609,
      "number": 34038,
      "title": "logging: API improvements",
      "body": "A few changes:\r\n\r\n * Provide `STDLOCK(m_cs)` instead of `StdLockGuard g(m_cs)` for the logging mutexes, so that we can get better warnings from clang if annotations have been missed\r\n * Allow writing `LogInfo(BCLog::NO_RATE_LIMIT, \"log message\")` to avoid rate limiting, rather than having to supply a false argument to `LogPrintLevel_(...)`\r\n * Replace the `-loglevel` parameter with a new `-trace` parameter that works the same as `-debug`\r\n * Change the `logging` RPC to allow enabling trace debugging, and to differentiate trace vs debug levels\r\n ",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2025-12-10T05:56:20Z",
      "updated_at": "2026-01-19T08:18:24Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34038",
      "labels": [
        "Needs release note"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 577,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3139411374,
      "number": 34186,
      "title": "test: use dynamic port allocation in proxy tests",
      "body": "Use `port=0` for dynamic port allocation in test framework components to avoid intermittent \"address already in use\" errors when running tests concurrently or when ports are stuck in TIME_WAIT state. Example: https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2634509304\r\n\r\nChanges:\r\n\r\n  - Update `socks5.py` and `p2p.py` to support dynamic port allocation\r\n  - Convert `feature_proxy.py` and `feature_anchors.py` to use `port=0`",
      "state": "closed",
      "user": "w0xlt",
      "created_at": "2025-12-31T17:03:39Z",
      "updated_at": "2026-01-19T08:18:02Z",
      "merged_at": "2026-01-14T22:40:20Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34186",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 485,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3119599294,
      "number": 34124,
      "title": "refactor: make `CCoinsView` a purely virtual abstract base class",
      "body": "### Problem\r\n`CCoinsView` serves as the interface for the coins database layer, but historically had a dual nature that caused confusion:\r\n\r\n* It provided default noop implementations (returning `std::nullopt`, `uint256()`, `false`, `nullptr`) instead of being pure virtual\r\n* Callers could instantiate a bare `CCoinsView` and get silent no-op behavior\r\n* Mixing the interface definition with a built-in dummy implementation blurred the abstraction boundary\r\n\r\n### Context\r\n\r\nThis is part of ongoing coins caching cleanup efforts such as #34132, #33866, #33018, and #33512.\r\n\r\n### Fix\r\n\r\nThis PR makes `CCoinsView` a pure abstract interface and introduces an explicit noop implementation, in tiny incremental steps to ease review:\r\n\r\n* Add `CCoinsViewEmpty` as an explicit noop coins view for tests, benchmarks, and dummy backends\r\n* Replace all direct `CCoinsView` instantiations with `CCoinsViewEmpty`\r\n* Incrementally make all `CCoinsView` methods pure virtual (`GetCoin`, `GetBestBlock`, `BatchWrite`, `EstimateSize`, `Cursor`, `GetHeadBlocks`, `HaveCoin`)\r\n* Remove the legacy default implementations from `coins.cpp`\r\n* Update the coins view fuzzer to switch between a real database-backed view and `CCoinsViewEmpty`\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-12-20T08:47:33Z",
      "updated_at": "2026-01-19T07:38:35Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34124",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1289,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3120160595,
      "number": 34132,
      "title": "refactor: inline `CCoinsViewErrorCatcher` into `CCoinsViewDB`",
      "body": "### Problem\r\n\r\nThe current coins database read-error handling adds unnecessary complexity to the critical path:\r\n\r\n- `CCoinsViewErrorCatcher` sits between the cache and database views, wrapping every read operation with a generic error handler\r\n- `ExecuteBackedWrapper` adds another function call layer with lambda captures on each database read\r\n-  Uses `std::vector<std::function<void()>>` for callbacks when there's only ever one callback registered\r\n-  The error callback is set after database initialization rather than during construction (requiring a `cs_main` lock)\r\n\r\nThis adds unnecessary stack depth and bookkeeping overhead on every coins database read operation (`GetCoin`). Also note that `CCoinsViewDB::HaveCoin` isn't even called from production code as far as I can tell.\r\n\r\n### Context\r\n\r\nThis is part of ongoing coins caching cleanup efforts like #34124, #33866, #33018, and #33512.\r\n\r\n### Fix\r\n\r\nThis PR collapses the `CCoinsViewErrorCatcher` layer entirely and moves error handling directly into `CCoinsViewDB`:\r\n\r\n- Remove `ExecuteBackedWrapper` and `CCoinsViewErrorCatcher`, placing try-catch blocks directly in `CCoinsViewDB::GetCoin` and `CCoinsViewDB::HaveCoin`\r\n- Replace `std::vector<std::function<void()>>` with a single `std::function<void()>` member, initialized in the constructor\r\n- The read error callback is now passed to `Chainstate::InitCoinsDB` and forwarded to `CCoinsViewDB` constructor\r\n\r\nA new test is also added to reproduce the behavior in case of database corruption. It's added as a first commit to demonstrate that the behavior stays unchanged.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-12-20T22:56:45Z",
      "updated_at": "2026-01-19T07:32:57Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34132",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1653,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3185742901,
      "number": 34334,
      "title": "fix: check event loop state before stopping in NetworkThread.close()",
      "body": "Fixes #34248\r\n\r\nAdd is_running() check in NetworkThread.close() to prevent timeout when event loop is already stopped on NetBSD.",
      "state": "open",
      "user": "forkfury",
      "created_at": "2026-01-18T20:43:41Z",
      "updated_at": "2026-01-19T07:21:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34334",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 197,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3182466003,
      "number": 34322,
      "title": "node: Persist private broadcast transactions over node restarts",
      "body": "Follow-up from #29415 \r\n\r\nCurrently private broadcast transactions are stored in peer manager and do not persist over restarts. A submitted transaction can be lost if the node restarts before it is privately broadcast.\r\n\r\nThis change dumps the set of private broadcast transactions to a `privatebroadcast.dat` file on shutdown, and adds the transactions back to the private broadcast data structure on restart.",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2026-01-16T19:37:05Z",
      "updated_at": "2026-01-19T06:20:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34322",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 474,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3163366332,
      "number": 34253,
      "title": "validation: cache tip recency for lock-free `IsInitialBlockDownload()`",
      "body": "### Context\r\nThis PR is a follow-up to the stale #32885.\r\n\r\n### Problem\r\n`ChainstateManager::IsInitialBlockDownload()` currently acquires `cs_main` internally, even though most existing call sites already hold the lock. This becomes relevant for proposals like #34054, which would call `IsInitialBlockDownload()` from the scheduler thread without holding `cs_main`, potentially introducing lock contention.\r\n\r\n### Fix\r\nMake `ChainstateManager::IsInitialBlockDownload()` lock-free by caching its result in a single atomic `m_cached_is_ibd` (true while in IBD, latched to false on exit).\r\nMove the IBD exit checks out of `IsInitialBlockDownload()` (reader-side) into a new `ChainstateManager::UpdateIBDStatus()` (writer-side, called under cs_main).\r\n\r\nCall UpdateIBDStatus() at strategic points where IBD exit conditions may change, after active chain tip updates in `ConnectTip()`, `DisconnectTip()`, and `LoadChainTip()`, and after `ImportBlocks()` returns.\r\n\r\nWith this, `IsInitialBlockDownload()` becomes a lock-free atomic read, avoiding internal `cs_main` acquisition on hot paths.\r\n\r\n### Testing and Benchmarks\r\nThis isn't strictly an optimization - though some usecases might benefit from it -, so rather as a sanity check I ran a reindex-chainstate and an AssumeUTXO load (without background validation).\r\n\r\n<details>\r\n<summary>assumeutxo load | 910000 blocks | dbcache 4500 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | xfs | SSD</summary>\r\n\r\n```\r\nCOMMITS=\"595504a43209bead162da54a204df7d140a25f0e 63e822b637f67242e3689adedc0155b34100e651\"; \\\r\nCC=gcc; CXX=g++; \\\r\nBASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/ShallowBitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; UTXO_SNAPSHOT_PATH=\"$BASE_DIR/utxo-910000.dat\"; \\\r\n(echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done; echo \"\") && \\\r\nfor DBCACHE in 4500; do \\\r\n  (echo \"assumeutxo load | 910000 blocks | dbcache ${DBCACHE} | $(hostname) | $(uname -m) | $(lscpu | grep 'Model name' | head -1 | cut -d: -f2 | xargs) | $(nproc) cores | $(free -h | awk '/^Mem:/{print $2}') RAM | $(df -T $BASE_DIR | awk 'NR==2{print $2}') | $(lsblk -no ROTA $(df --output=source $BASE_DIR | tail -1) | grep -q 0 && echo SSD || echo HDD)\";) &&\\\r\n  hyperfine \\\r\n  --sort command \\\r\n  --runs 3 \\\r\n  --export-json \"$BASE_DIR/assumeutxo-$(sed -E 's/(\\w{8})\\w+ ?/\\1-/g;s/-$//'<<<\"$COMMITS\")-$DBCACHE-$CC-$(date +%s).json\" \\\r\n  --parameter-list COMMIT ${COMMITS// /,} \\\r\n  --prepare \"killall -9 bitcoind 2>/dev/null; rm -rf $DATA_DIR/blocks $DATA_DIR/chainstate $DATA_DIR/chainstate_snapshot $DATA_DIR/debug.log; git clean -fxd; git reset --hard {COMMIT} && \\\r\n             cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=RelWithDebInfo && ninja -C build bitcoind bitcoin-cli -j2 && \\\r\n             ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=1 -printtoconsole=0; sleep 20 && \\\r\n             ./build/bin/bitcoind -datadir=$DATA_DIR -daemon -blocksonly -connect=0 -dbcache=$DBCACHE -printtoconsole=0; sleep 20\" \\\r\n   --conclude \"build/bin/bitcoin-cli -datadir=$DATA_DIR stop || true; killall bitcoind || true; sleep 10; \\\r\n               echo '{COMMIT} | dbcache=$DBCACHE | chainstate: $(find $DATA_DIR/chainstate_snapshot -type f 2>/dev/null | wc -l) files, $(du -sb $DATA_DIR/chainstate_snapshot 2>/dev/null | cut -f1) bytes' >> $DATA_DIR/debug.log; \\\r\n               cp $DATA_DIR/debug.log $LOG_DIR/debug-assumeutxo-{COMMIT}-dbcache-$DBCACHE-$(date +%s).log\" \\\r\n    \"COMPILER=$CC DBCACHE=$DBCACHE ./build/bin/bitcoin-cli -datadir=$DATA_DIR -rpcclienttimeout=0 loadtxoutset $UTXO_SNAPSHOT_PATH\"; \\\r\ndone\r\n\r\n595504a432 Merge bitcoin/bitcoin#34236: Add sedited to trusted-keys\r\n63e822b637 validation: make `IsInitialBlockDownload()` lock-free\r\n\r\nassumeutxo load | 910000 blocks | dbcache 4500 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | xfs | SSD\r\n\r\nBenchmark 1: COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 595504a43209bead162da54a204df7d140a25f0e)\r\n  Time (mean Â± Ïƒ):     418.452 s Â±  0.461 s    [User: 0.001 s, System: 0.001 s]\r\n  Range (min â€¦ max):   418.070 s â€¦ 418.964 s    3 runs\r\n \r\nBenchmark 2: COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 63e822b637f67242e3689adedc0155b34100e651)\r\n  Time (mean Â± Ïƒ):     415.994 s Â±  0.294 s    [User: 0.001 s, System: 0.001 s]\r\n  Range (min â€¦ max):   415.788 s â€¦ 416.330 s    3 runs\r\n \r\nRelative speed comparison\r\n        1.01 Â±  0.00  COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 595504a43209bead162da54a204df7d140a25f0e)\r\n        1.00          COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 63e822b637f67242e3689adedc0155b34100e651)\r\n```\r\n\r\n</details>\r\n\r\n<details>\r\n<summary>2026-01-12 | reindex-chainstate | 931139 blocks | dbcache 4500 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | SSD</summary>\r\n\r\n```\r\nfor DBCACHE in 4500; do \\                                                                                                                           \r\n  COMMITS=\"595504a43209bead162da54a204df7d140a25f0e 63e822b637f67242e3689adedc0155b34100e651\"; \\\r\n  STOP=931139; CC=gcc; CXX=g++; \\\r\n  BASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/BitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; \\\r\n  (echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done) && \\\r\n  (echo \"\" && echo \"$(date -I) | reindex-chainstate | ${STOP} blocks | dbcache ${DBCACHE} | $(hostname) | $(uname -m) | $(lscpu | grep 'Model name' | head -1 | cut -d: -f2 | xargs) | $(nproc) cores | $(free -h | awk '/^Mem:/{print $2}') RAM | SSD\"; echo \"\") &&\\\r\n  hyperfine \\\r\n    --sort command \\\r\n    --runs 1 \\\r\n    --export-json \"$BASE_DIR/rdx-$(sed -E 's/(\\w{8})\\w+ ?/\\1-/g;s/-$//'<<<\"$COMMITS\")-$STOP-$DBCACHE-$CC.json\" \\\r\n    --parameter-list COMMIT ${COMMITS// /,} \\\r\n    --prepare \"killall -9 bitcoind 2>/dev/null; rm -f $DATA_DIR/debug.log; git clean -fxd; git reset --hard {COMMIT} && \\\r\n      cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=Release -DENABLE_IPC=OFF && ninja -C build bitcoind -j1 && \\\r\n      ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=1000 -printtoconsole=0; sleep 20; rm -f $DATA_DIR/debug.log\" \\\r\n    --conclude \"killall bitcoind || true; sleep 5; grep -q 'height=0' $DATA_DIR/debug.log && grep -q 'Disabling script verification at block #1' $DATA_DIR/debug.log && grep -q 'height=$STOP' $DATA_DIR/debug.log; \\\r\n                cp $DATA_DIR/debug.log $LOG_DIR/debug-{COMMIT}-$(date +%s).log\" \\\r\n    \"COMPILER=$CC ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=$DBCACHE -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0\";\r\ndone\r\n\r\n595504a432 Merge bitcoin/bitcoin#34236: Add sedited to trusted-keys\r\n63e822b637 validation: make `IsInitialBlockDownload()` lock-free\r\n\r\n2026-01-12 | reindex-chainstate | 931139 blocks | dbcache 4500 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | SSD\r\n\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=931139 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 595504a43209bead162da54a204df7d140a25f0e)\r\n  Time (abs â‰¡):        17187.310 s               [User: 33104.415 s, System: 937.548 s]\r\n \r\nBenchmark 2: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=931139 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 63e822b637f67242e3689adedc0155b34100e651)\r\n  Time (abs â‰¡):        17240.300 s               [User: 33164.803 s, System: 976.485 s]\r\n \r\nRelative speed comparison\r\n        1.00          COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=931139 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 595504a43209bead162da54a204df7d140a25f0e)\r\n        1.00          COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=931139 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 63e822b637f67242e3689adedc0155b34100e651)\r\n```\r\n\r\n</details>",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-11T15:15:32Z",
      "updated_at": "2026-01-19T06:13:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34253",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 8695,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3163535277,
      "number": 34254,
      "title": "validation: Prevent duplicate logging and looping in invalid block handling",
      "body": "`InvalidChainFound()` is called from 3 spots:\r\n1. from `InvalidBlockFound()`\r\n2. from `ActivateBestChain()`, with the highest connectable block of the chain\r\nas an arg (after having called `InvalidBlockFound()` already for the block that failed in `ConnectTip()`)\r\n3. from `InvalidateBlock()` (rpc-only)\r\n\r\nMost of the logic in `InvalidChainFound()` is not required for 2) and 3):\r\nIn `ActivateBestChain()`, the previous call to `InvalidChainFound()` before via `InvalidBlockFound` did the flag updates, best header calculation and logging, so only `m_best_invalid` could need additional updating.\r\nIn `InvalidateBlock()` (which doesn't call `InvalidBlockFound()`), we do most of the accounting manually.\r\n\r\nTherefore move of all logic but the `m_best_invalid` update into `InvalidBlockFound()`, avoiding duplicate logging and unnecessary work (the loops over the block index in `SetBlockFailureFlags()` and `RecalculateBestHeader()`\r\nwere done twice before).\r\n\r\nThe second commit renames `InvalidChainFound` to `UpdateBestInvalid` to adjust to its remaining role.\r\n\r\nThis addresses past discussions about repeated work in `InvalidateBlock()` (https://github.com/bitcoin/bitcoin/pull/31405#discussion_r2135717500) and `ActivateBestChain()` (https://github.com/bitcoin/bitcoin/pull/31533#discussion_r2607189790)",
      "state": "open",
      "user": "mzumsande",
      "created_at": "2026-01-11T16:59:21Z",
      "updated_at": "2026-01-19T06:10:42Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34254",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1386,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3181018875,
      "number": 34317,
      "title": "fuzz: Exclude too expensive inputs in descriptor_parse targets",
      "body": "Accepting \"expensive\" fuzz inputs which have no real use-case is problematic, because it prevents the fuzz engine from spending time on the next useful fuzz input.\r\n\r\nFor example, those will take several seconds (!) and the flamegraph shows that base58 encoding is the cause:\r\n\r\n```\r\ncurl -fLO 'https://github.com/bitcoin-core/qa-assets/raw/b5ad78e070e4cf36beb415d7b490d948d70ba73f/fuzz_corpora/mocked_descriptor_parse/f5abf41608addcef3538da61d8096c2050235032'\r\ncurl -fLO 'https://github.com/bitcoin-core/qa-assets/raw/b5ad78e070e4cf36beb415d7b490d948d70ba73f/fuzz_corpora/descriptor_parse/78cb3175467f53b467b949883ee6072e92dbb267'\r\n\r\nFUZZ=mocked_descriptor_parse ./bld-cmake/bin/fuzz ./f5abf41608addcef3538da61d8096c2050235032\r\nFUZZ=descriptor_parse ./bld-cmake/bin/fuzz ./78cb3175467f53b467b949883ee6072e92dbb267\r\n```\r\n\r\nThis will also break 32-bit fuzzing, see https://github.com/bitcoin/bitcoin/issues/34110#issuecomment-3759461248.\r\n\r\nFix all issues by checking for `HasTooLargeLeafSize`.\r\n\r\nSorry for creating several pull requests to fix this class of issue, but I think this one should be the last one. :sweat_smile: ",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-16T12:00:14Z",
      "updated_at": "2026-01-19T05:23:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34317",
      "labels": [
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1188,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3181854676,
      "number": 34320,
      "title": "coins: replace remaining `HaveCoin` calls with `GetCoin`",
      "body": "Split out of https://github.com/bitcoin/bitcoin/pull/34132#discussion_r2692307054.\r\n\r\n### Problem\r\n\r\nWe have two ways to check a coin exists in the db. One tries to deserialize, the other just returns whether any value is associated with the key. But we usually need the full value we probed for, and `HaveCoin` cannot cache the returned value, so it can trigger an extra lookup if `HaveCoin` uses `Exists` and the caller later needs the actual value.\r\nWe're already delegating most `HaveCoin` calls to `GetCoin` anyway for the above reasons, so the current implementation of `HaveCoin` is redundant.\r\n\r\n### Fix\r\n\r\nReplace `HaveCoin` calls with `GetCoin`, reuse `ReadRaw` in `dbwrapper`, stop ignoring deserialization failures, and readjust tests to this simpler state.\r\n\r\nSee https://github.com/bitcoin/bitcoin/blob/cd0959ce9b7c5b80ebd45b652d557630b4dc604b/src/dbwrapper.cpp#L304-L331 and https://github.com/bitcoin/bitcoin/blob/\r\na9b7f5614c24fe6f386448604c325ec4fa6c98a5/src/dbwrapper.h#L206-L241.\r\n\r\n### Notes\r\n* It seems https://github.com/bitcoin/bitcoin/pull/26331 did not fix https://github.com/bitcoin/bitcoin/issues/26112.\r\n* After this PR deserialization failures will crash the app, see https://github.com/bitcoin/bitcoin/pull/33866 for similar cleanups. This is deliberate to fail early instead of trying to recover.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-16T16:17:29Z",
      "updated_at": "2026-01-19T04:42:37Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34320",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1385,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3185680005,
      "number": 34333,
      "title": "fuzz:wallet: add target for wallet receive",
      "body": "Tracking issue (https://github.com/bitcoin/bitcoin/issues/29901)\r\n\r\nthis add fuzz target for wallet receive...\r\n\r\nAlso,  for block height handling for unknown heights\r\n\r\nAllowing `-1` for `conflicting_block_height` in `TxStateBlockConflicted` which is a valid state when deserializing old wallet data where block heights weren't stored. This helps sorting an assertion failure that would occur when `GetTxDepthInMainChain()` encounters transactions with unknown conflicting block heights.\r\n\r\n discovered that `GetTxDepthInMainChain()` would crash with `assert(conf->conflicting_block_height >= 0)` when handling transactions with `-1` (unknown height), even though this is used elsewhere in the codebase.\r\n\r\n**Code inconsistency here below:**\r\n\r\nIn `src/wallet/transaction.h:94`, `-1` is  used for unknown heights:\r\n\r\n```cpp\r\n} else if (data.index == -1) {\r\n    return TxStateBlockConflicted{data.block_hash, /*height=*/-1};  \r\n}\r\n```\r\n\r\nIn `src/wallet/wallet.cpp:1320`, negative heights are handled \r\n\r\n```cpp\r\n// If number of conflict confirms cannot be determined, this means\r\n// that the block is still unknown or not yet part of the main chain,\r\n// for example when loading the wallet during a reindex. Do nothing in that\r\n// case.\r\nif (m_last_block_processed_height < 0 || conflicting_height < 0) {\r\n    return; \r\n}\r\n```\r\n\r\nBut in `src/wallet/wallet.cpp:3299`, the assertion requires `>= 0`:\r\n\r\n```cpp\r\n} else if (auto* conf = wtx.state<TxStateBlockConflicted>()) {\r\n    assert(conf->conflicting_block_height >= 0);  // here it crashes\r\n    return -1 * (GetLastBlockHeight() - conf->conflicting_block_height + 1);\r\n}\r\n```\r\n",
      "state": "open",
      "user": "b-l-u-e",
      "created_at": "2026-01-18T19:38:24Z",
      "updated_at": "2026-01-19T04:28:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34333",
      "labels": [
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1672,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 112846431,
      "number": 10102,
      "title": "Multiprocess bitcoin",
      "body": "<!-- begin based-on -->\n**This is based on #29409.** The non-base commits are:\n\n- [`93f471464dd` test: Increase feature_block.py and feature_taproot.py timeouts](https://github.com/bitcoin/bitcoin/pull/10102/commits/93f471464dda67bf59ec474979e5e04989616ff2)\n- [`9c2f8ce25b2` test: Fix multiprocess test for unclean shutdown on kill](https://github.com/bitcoin/bitcoin/pull/10102/commits/9c2f8ce25b263eddcd5e33986626e98d5f391430)\n- [`3582e4a12a3` util: Add util::Result workaround to be compatible with libmultiprocess](https://github.com/bitcoin/bitcoin/pull/10102/commits/3582e4a12a341376e0fcb1d67cda5cc510bb1ae9)\n- [`f1d2d87c6d8` multiprocess: Add capnp serialization code for bitcoin types](https://github.com/bitcoin/bitcoin/pull/10102/commits/f1d2d87c6d87c58749f0f2fb100e184a3ab11303)\n- [`65e4390dcaa` interfaces, refactor: Change WalletLoader::restoreWallet parameter order](https://github.com/bitcoin/bitcoin/pull/10102/commits/65e4390dcaa23ab347a832e3f1ff130650efd2be)\n- [`0e436699c59` multiprocess: Add capnp wrapper for Wallet interface](https://github.com/bitcoin/bitcoin/pull/10102/commits/0e436699c59b537a5948389613dacb5c68fc2872)\n- [`0381cc5dc99` multiprocess: Add capnp wrapper for Node interface](https://github.com/bitcoin/bitcoin/pull/10102/commits/0381cc5dc999795aa1f5bcb77e8d429a9f5221e6)\n- [`88f3246ae7f` multiprocess: Make bitcoin-gui spawn a bitcoin-node process](https://github.com/bitcoin/bitcoin/pull/10102/commits/88f3246ae7f2c0cf79c3f22ba002967dda7a0b16)\n- [`aebc163451b` multiprocess: Make bitcoin-node spawn a bitcoin-wallet process](https://github.com/bitcoin/bitcoin/pull/10102/commits/aebc163451bc8c5fa8cbbcc66b553e17e06e1d82)\n- [`c5b9fe54c9c` multiprocess: Add debug.log .wallet/.gui suffixes](https://github.com/bitcoin/bitcoin/pull/10102/commits/c5b9fe54c9cc367b81487f5c9a4574243e33e7f8)\n- [`a73f70fac8d` doc: Multiprocess misc doc and comment updates](https://github.com/bitcoin/bitcoin/pull/10102/commits/a73f70fac8d396a8d719cafe10853390c53f687b)\n- [`2503f57e93c` combine_logs: Handle multiprocess wallet log files](https://github.com/bitcoin/bitcoin/pull/10102/commits/2503f57e93c32158f837e1c9f0dc9f1061b84346)<!-- end -->\n\n---\n\nThis PR adds an `--enable-multiprocess` configure option which builds new `bitcoin-node`, `bitcoin-wallet`, and `bitcoin-gui` executables with relevant functionality isolated into different processes. See [doc/design/multiprocess.md](https://github.com/ryanofsky/bitcoin/tree/pr/ipc/doc/design/multiprocess.md) for usage details and future plans.\n\nThe change is implemented by adding a new [`Init`](https://github.com/ryanofsky/bitcoin/blob/pr/ipc/src/interfaces/init.h) interface that spawns new wallet and node subprocesses that can be controlled over a [socketpair](http://man7.org/linux/man-pages/man2/socketpair.2.html) by calling [`Node`](https://github.com/ryanofsky/bitcoin/blob/pr/ipc/src/interfaces/node.h), [`Wallet`](https://github.com/ryanofsky/bitcoin/blob/pr/ipc/src/interfaces/wallet.h), and [`ChainClient`](https://github.com/ryanofsky/bitcoin/blob/pr/ipc/src/interfaces/chain.h) methods. When running with split processes, you can see the IPC messages going back and forth in `-debug=1` output. Followup PR's #19460 and #19461 add `-ipcbind` and `-ipcconnect` options that allow more flexibility in how processes are connected.\n\nThe IPC protocol used is Cap'n Proto, but this could be swapped out for another protocol. Cap'n Proto types and libraries are only accessed in the [src/ipc/capnp/](https://github.com/ryanofsky/bitcoin/tree/pr/ipc/src/ipc/capnp) directory, and not in any public headers or other parts of bitcoin code.\n\nSlides from a presentation describing this change are available on [google drive](https://docs.google.com/presentation/d/1AeJ-7gD-dItUgs5yH-HoEzLvXaEWe_2ZiGUUxYIXcws/edit). Demo code used in the presentation was from an older version this PR (tag [ipc.21](https://github.com/ryanofsky/bitcoin/releases/tag/pr%2Fipc.21), [commits](https://github.com/ryanofsky/bitcoin/compare/master...pr/ipc.21)).\n\n---\n\nThis PR is part of the [process separation project](https://github.com/bitcoin/bitcoin/issues/28722).",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2017-03-27T21:48:26Z",
      "updated_at": "2026-01-19T01:38:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/10102",
      "labels": [
        "GUI",
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 4142,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 445592053,
      "number": 19460,
      "title": "multiprocess: Add bitcoin-wallet -ipcconnect option",
      "body": "<!-- begin based-on -->\n**This is based on #29409 + #10102.** The non-base commits are:\n\n- [`5124e765ad6` multiprocess: Add bitcoin-wallet -ipcconnect option](https://github.com/bitcoin/bitcoin/pull/19460/commits/5124e765ad63cfa8e6ae2dec27d427e4f9012018)<!-- end -->\n\n---\n\nBuilding on #10102, this adds an `-ipcconnect` option to `bitcoin-wallet` and an `-ipcbind` option to `bitcoin-node` (both enabled by default in multiprocess builds) so bitcoin node will listen on a `<datadir>/sockets/node.sock` unix socket, and `bitcoin-wallet` will connect to it.\n\nThe idea is that `bitcoin-wallet` can be extended in the future to have some online functionality. For example, there could be a `bitcoin-wallet sync` command that will update balances and sync latest transactions to an unloaded wallet, or a `bitcoin-wallet serve` subcommand that loads a wallet and serves RPC requests, or a `bitcoin-wallet shell` subcommand that allows running RPC methods interactively like the GUI console, or just general support for `bitcoin-wallet <rpc method> <rpc params>` invocations suggested https://github.com/bitcoin/bitcoin/pull/13926#issuecomment-455187379.\n\nThis PR is small and doesn't do much. The only visible change is that `bitcoin-wallet` now checks whether a node socket exists on startup and prints \"Connected to IPC address\" if it can connect it it.\n\nThe default `bitcoin-wallet` connect option is `-ipcconnect=auto`, which connects if possible as described above, and proceeds offline if not possible. Other supported options are `-noipcconnect` to disable ipc, `-ipcconnect` to require a connection and fail if it can't be established, and `-ipcconnect=unix:<socket>` to require a connection and use a custom socket path.\n\nThese changes require multiprocess support and this PR has no effect unless bitcoin is configured with `--enable-multiprocess` as described in [doc/multiprocess.md](https://github.com/bitcoin/bitcoin/blob/master/doc/multiprocess.md)\n\n---\n\nThis PR is part of the [process separation project](https://github.com/bitcoin/bitcoin/issues/28722).",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2020-07-07T18:53:19Z",
      "updated_at": "2026-01-19T01:20:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/19460",
      "labels": [
        "Wallet",
        "Build system",
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2117,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 445595297,
      "number": 19461,
      "title": "multiprocess: Add bitcoin-gui -ipcconnect option",
      "body": "<!-- begin based-on -->\n**This is based on #29409 + #10102 + #19460.** The non-base commits are:\n\n- [`86eb8268426` multiprocess: Add bitcoin-gui -ipcconnect option](https://github.com/bitcoin/bitcoin/pull/19461/commits/86eb826842691ed52057a1aada702a5c1eb7c262)<!-- end -->\n\n---\n\nBuilding on #10102, this adds an `-ipcconnect` option to `bitcoin-gui` that connects the GUI to an existing `bitcoin-node` process already running in the background instead of spawning a new `bitcoin-node` process. This allows the GUI to be started and stopped independently of the node. By default with this change, `bitcoin-gui` will check if a `<datadir>/sockets/node.sock` socket exists and try to connect to that. If that doesn't work, it will spawn a new node process and start up the same way it did before this PR.\n\nThe default `bitcoin-gui` connect option is `-ipcconnect=auto`, which tries to connect if possible as described above, and spawns a new `bitcoin-node` process if not possible. Other supported options are `-noipcconnect` to never connect to an existing node and always spawn a new one, `-ipcconnect` to require a connection and fail if it can't be established, and `-ipcconnect=unix:<socket>` to require a connection and use a custom socket path.\n\nWith this PR, basic functionality works and gui instances can connect and disconnect from a running node. But there are rough edges: If a gui process doesn't shut down cleanly, the node can see unhandled IpcExceptions, and if node command line options are passed to `bitcoin-gui` and `bitcoin-gui` connects to an exiting bitcoin-node process instead of spawning a new one, the node options will be silently ignored. \n\nThese changes require multiprocess support and this PR has no effect unless bitcoin is configured with `--enable-multiprocess` as described in [doc/multiprocess.md](https://github.com/bitcoin/bitcoin/blob/master/doc/multiprocess.md)\n\n---\n\nThis PR is part of the [process separation project](https://github.com/bitcoin/bitcoin/issues/28722).",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2020-07-07T19:00:11Z",
      "updated_at": "2026-01-19T01:17:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/19461",
      "labels": [
        "GUI",
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2057,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1487286408,
      "number": 28333,
      "title": "wallet: Construct ScriptPubKeyMans with all data rather than loaded progressively",
      "body": "Instead of constructing ScriptPubKeyMans with no data, and then loading data as we find it, we should gather everything first and then load it all on construction. If there actually is no data and we want to setup generation, then that should also occur in a constructor rather than afterwards.\r\n\r\nThis change is only applied to DescriptorScriptPubKeyMan and ExternalSignerScriptPubKeyMan, and should be done for any ScriptPubKeyMans added in the future. I don't think it's really worth it to do this for LegacyScriptPubKeyMan since it would make loading performance worse (or cause layer violations) and it's (supposed to be) going away soon.",
      "state": "open",
      "user": "achow101",
      "created_at": "2023-08-24T02:55:39Z",
      "updated_at": "2026-01-19T00:40:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28333",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 725,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 344944113,
      "number": 17581,
      "title": "refactor: Remove settings merge reverse precedence code",
      "body": "<!-- begin based-on -->\n**This is based on #16545 + #17580 + #17493.** The non-base commits are:\n\n- [`f50e5fe9bed` refactor: Remove settings merge reverse precedence code](https://github.com/bitcoin/bitcoin/pull/17581/commits/f50e5fe9bedcb6f4a204d9e46812d506ae1f3533)<!-- end -->\n\n---\n\nThis has no effect on behavior because as of https://github.com/bitcoin/bitcoin/pull/17493 it's not possible to specify multiple values for single value settings in the config file.\n\nThis change implements one of the settings simplifications listed in #17508",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2019-11-24T20:17:13Z",
      "updated_at": "2026-01-19T00:28:31Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/17581",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 600,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2452084628,
      "number": 32247,
      "title": "BIP-348 (OP_CHECKSIGFROMSTACK) (regtest only)",
      "body": "This implements [BIP-348 (`OP_CHECKSIGFROMSTACK`)](https://github.com/bitcoin/bips/blob/master/bip-0348.md), but only specifies a regtest deployment. There is no effective policy change, since the SCRIPT_VERIFY_* flags (as used) result in the same OP_SUCCESS-like behavior.\r\n\r\nThis change can be composed with other opcode specifications (e.g. CTV, see #31989) and bundled into the same deployment (yet to be specified).\r\n\r\nI encourage more general, conceptual discussion to happen on [Delving Bitcoin](https://delvingbitcoin.org/) and not on this pull request.\r\n\r\nSome related discussion on Delving Bitcoin here:\r\n- https://delvingbitcoin.org/t/ctv-csfs-can-we-reach-consensus-on-a-first-step-towards-covenants/\r\n\r\nSee also:\r\n- https://bitcoinops.org/en/topics/op_checksigfromstack/",
      "state": "open",
      "user": "jamesob",
      "created_at": "2025-04-10T19:41:43Z",
      "updated_at": "2026-01-19T00:25:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32247",
      "labels": [
        "Consensus",
        "Needs rebase",
        "Needs Conceptual Review"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 829,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1300349444,
      "number": 27409,
      "title": "Make GUI and CLI tools use the same datadir",
      "body": "**This is based on #27302.** The non-base commits are:\r\n\r\n- [`ae5fc323b24` bitcoin-wallet: make bitcoin-wallet tool load config file](https://github.com/bitcoin/bitcoin/pull/27409/commits/ae5fc323b2441bc45c38737f1ffb40d777b134d8)\r\n- [`b091d9b0762` init: Allow bitcoin default datadir to point at an external datadir](https://github.com/bitcoin/bitcoin/pull/27409/commits/b091d9b076204f69cc814353139d5bf0df412bae)\r\n- [`5855150efae` Make GUI and CLI tools use the same datadir](https://github.com/bitcoin/bitcoin/pull/27409/commits/5855150efae74d10e0eaf3bd08b06e8655a0f1ba)\r\n\r\n---\r\n\r\nCurrently if your choose a non-default datadir in the GUI intro screen, the datadir is ignored by CLI tools.\r\n\r\nThis PR makes GUI and CLI tools the same datadir setting by default. It is followup to https://github.com/bitcoin-core/gui/pull/602 which made GUI and CLI tools use the same settings as long as they loaded the same datadir.\r\n\r\nThe reason GUI and CLI tools use inconsistent datadirs is that GUI stores the datadir path in a `strDataDir` field in `.config/Bitcoin/Bitcoin-Qt.conf`[^1] which CLI tools ignore. This PR changes the GUI to instead store the datadir path at the default datadir location `~/.bitcoin`[^2] as a symlink that CLI tools will already follow, or as a text file if the filesystem does not support symlinks.\r\n\r\nIf upgrading from a previous version of the GUI and there is only a GUI datadir, the `strDataDir` setting will be automatically migrated to a symlink so CLI tools will start using it as well.\r\n\r\nIf upgrading and GUI and CLI tools are using different datadirs, the GUI will show a prompt allowing either of the datadirs to be loaded on startup, with an option to set one as the default going forward.\r\n\r\n[^1]: `strDataDir` value is stored in `.config/Bitcoin/Bitcoin-Qt.conf` on linux, in property list files on macos, and in registry keys on windows.\r\n[^2]: The default datadir location is `~/.bitcoin` on linux, `~/Library/Application Support/Bitcoin` on macos, and `%APPDATA%\\Bitcoin` on windows",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2023-04-03T16:21:47Z",
      "updated_at": "2026-01-19T00:25:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/27409",
      "labels": [
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2064,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2528993305,
      "number": 32566,
      "title": "Use subprocess library for notifications",
      "body": "Builds on #29868 (to have windows support).\r\n\r\nThis switches the `-*notify` options to use the subprocess library, which is currently used for only the external signer. The main advantage of this is that file descriptor leaks are avoided (#32343). This could also add future flexibility in notifications, for example to bypass the shell (and launch commands with their arguments directly[1]), or do something with command output (like log it). But for now, this is meant to be one-to-one.\r\n\r\n- Generalize `ENABLE_EXTERNAL_SIGNER` build option to `ENABLE_SUBPROCESS`.\r\n- Unify everything dealing with external commands in `common/run_command.cpp`. Use the new functions `RunShell` and `RunShellInThread`.\r\n- Remove `HAVE_SYSTEM`.\r\n\r\n--------------------------\r\n\r\n[1] There's a long-running issue on Windows where it can't pass the wallet name because there's no way to escape it for the shell.",
      "state": "open",
      "user": "laanwj",
      "created_at": "2025-05-19T14:55:35Z",
      "updated_at": "2026-01-19T00:25:52Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32566",
      "labels": [
        "Build system",
        "Utils/log/libs",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 933,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 341661607,
      "number": 17493,
      "title": "util: Forbid ambiguous multiple assignments in config file",
      "body": "<!-- begin based-on -->\n**This is based on #16545 + #17580.** The non-base commits are:\n\n- [`d8dd3ef3144` util: Forbid ambiguous multiple assignments in config file](https://github.com/bitcoin/bitcoin/pull/17493/commits/d8dd3ef314407b1c13f2b5d6e8c7608878736ca5)\n- [`24078e372fa` test: Extend util_ArgsMerge test to check for \"Multiple values specified\" errors](https://github.com/bitcoin/bitcoin/pull/17493/commits/24078e372fa35717e3330721914136ab14a19834)<!-- end -->\n\n---\n\nEnable error \"Multiple values specified for -setting in same section of config file.\", for ALLOW_ANY settings that don't specify ALLOW_LIST.\n\nInstead of silently ignoring settings, this change makes it an error to provide an ambiguous config file that provides assigns multiple values to a single-value setting. Change includes release notes.\n\nPart of the motivation for this change is to improve usability and prevent settings that look valid from being silently ignored. Another motivation is to be able to remove confusing \"reverse precedence\" logic in #17581",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2019-11-15T22:11:44Z",
      "updated_at": "2026-01-19T00:23:25Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/17493",
      "labels": [
        "Refactoring",
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1096,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1681972231,
      "number": 29256,
      "title": "log, refactor: Allow log macros to accept context arguments",
      "body": "Allow `LogDebug()`, `LogTrace()`, `LogInfo()`, `LogWarning()`, and `LogError()` macros to accept context arguments to provide more information in log messages and more control over logging to callers.\r\n\r\nThis functionality is used in followup PRs:\r\n\r\n- [#30342](https://github.com/bitcoin/bitcoin/pull/30342) - To let libbitcoinkernel send output to specfic `BCLog::Logger` instances instead of a global instance, so output can be disambiguated and applications can have more control over logging.\r\n\r\n- [#30343](https://github.com/bitcoin/bitcoin/pull/30343) - To replace custom `WalletLogPrintf` calls with standard logging calls that automatically include wallet names and don't log everything at info level.\r\n\r\nThis PR does not change behavior of current log prints or require them to be updated. It includes tests and documentation covering the new functionality.\r\n\r\n---\r\n\r\nNote: Originally this PR also removed some restrictions around passing category constants to log macros to try to make them more consistent, but these changes were too controversial and have been dropped.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-01-16T22:09:35Z",
      "updated_at": "2026-01-19T00:18:33Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29256",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1142,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 355780577,
      "number": 17783,
      "title": "common: Disallow calling IsArgSet() on ALLOW_LIST options",
      "body": "<!-- begin based-on -->\n**This is based on #16545 + #17580.** The non-base commits are:\n\n- [`e327e592703` Normalize inconsistent -noonlynet behavior with -privatebroadcast and -listenonion](https://github.com/bitcoin/bitcoin/pull/17783/commits/e327e592703602a4d4faf2d1c135836c7d709b2a)\n- [`bf609a93e61` common: Disallow calling IsArgSet() on ALLOW_LIST options](https://github.com/bitcoin/bitcoin/pull/17783/commits/bf609a93e61feb55b77996c324cfb6e70ca49b9f)<!-- end -->\n\n---\n\nDisallow calling IsArgSet() function on ALLOW_LIST options. Code that uses IsArgSet() with list options is confusing and leads to bugs when IsArgSet() returns true, but GetArgs() returns an empty list, so the option is considered enabled even though it is empty. This led to a number of bugs which are fixed in #30529",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2019-12-20T15:36:53Z",
      "updated_at": "2026-01-19T00:15:37Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/17783",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 851,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 344943058,
      "number": 17580,
      "title": "refactor: Add ALLOW_LIST flags and enforce usage in CheckArgFlags",
      "body": "<!-- begin based-on -->\n**This is based on #16545.** The non-base commits are:\n\n- [`5e3583b295d` common: Add support for combining ArgsManager flags](https://github.com/bitcoin/bitcoin/pull/17580/commits/5e3583b295d3b47466bff325b49ee6219cc88a3a)\n- [`2d9f706e7ab` scripted-diff: Add ALLOW_LIST flag to arguments retrieved with GetArgs](https://github.com/bitcoin/bitcoin/pull/17580/commits/2d9f706e7ab09f6c21bf9e080616a1c607a3aea9)\n- [`482989ddee6` refactor: Fix more ALLOW_LIST arguments](https://github.com/bitcoin/bitcoin/pull/17580/commits/482989ddee6c0f0be0cb1184930c5a675da61728)\n- [`ef344f8b706` Always reject empty -blockfilterindex=\"\" arguments](https://github.com/bitcoin/bitcoin/pull/17580/commits/ef344f8b70640f8ebc179e09943f654f54b8756b)\n- [`07bdd5ac3e5` refactor: Stop calling GetArg/IsArgSet on ALLOW_LIST options](https://github.com/bitcoin/bitcoin/pull/17580/commits/07bdd5ac3e541e2c8f40c91de24cdbd8d5a8d179)\n- [`6f506623804` refactor: Always enforce ALLOW_LIST in CheckArgFlags](https://github.com/bitcoin/bitcoin/pull/17580/commits/6f5066238047501d3d9d9f8eb2da7f55f6c32dd7)<!-- end -->\n\n---\n\nExcept for two `rpcauth` and `blockfilterindex` fixes (update: rpcauth fix was merged separately in #30401) this PR does not change any behavior outside of tests. It is just supposed to enforce internal consistency and prevent bugs by ensuring that list arguments are always retrieved with GetArgs() and non-list arguments are always retrieved with GetArg(). Followup PRs could use the ALLOW_LIST flags for better documentation and error checking in the future. For example, #17493 builds on this to disallow conflicting config values. \n\nThis change was originally made as part of #17493",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2019-11-24T20:05:39Z",
      "updated_at": "2026-01-18T22:52:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/17580",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1763,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 304070624,
      "number": 16545,
      "title": "refactor: Implement missing error checking for ArgsManager flags",
      "body": "Trigger startup errors if bitcoin is configured with bad setting values according to flags. Also raise internal errors if settings are registered and retrieved with inconsistent flags.\n\nThis change has no effect on behavior because the new ArgsManager flags added here are not used outside of tests yet.\n\nIt'll probably be easier to start applying type checking flags to _new_ options than _existing_ options. But for examples of how type checking flags can make sense applied to existing options, see the new [example_options unit test](https://github.com/ryanofsky/bitcoin/blob/pr/argcheck/src/test/argsman_tests.cpp#L27) added in this PR.\n\n---\n\nFollowups:\n\n- Support for flag combinations is possible and is added in commit c919f51c044f0e80ecd301f9c9d396ddff2331ba ([branch](https://github.com/ryanofsky/bitcoin/commits/pr/argcomb))\n- ALLOW_LIST flags are added and enforced in [#17580](https://github.com/bitcoin/bitcoin/pull/17580)\n- Bad IsArgSet usages with ALLOW_LIST are removed in [#30529](https://github.com/bitcoin/bitcoin/pull/30529) and prevented in [#17783](https://github.com/bitcoin/bitcoin/pull/17783)\n- Confusing and ignored multiple assignments in config files are disallowed in [#17493](https://github.com/bitcoin/bitcoin/pull/17493)\n- Confusing reverse-precedence settings merging code is removed in [#17581](https://github.com/bitcoin/bitcoin/pull/17581)\n- Type flags added in this PR implement runtime part of a change to add more compile-time checking in [#22978](https://github.com/bitcoin/bitcoin/pull/22978)\n",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2019-08-04T14:13:12Z",
      "updated_at": "2026-01-18T21:54:37Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/16545",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1600,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2170572223,
      "number": 31260,
      "title": "scripted-diff: Type-safe settings retrieval",
      "body": "This PR changes the way settings are registered and retrieved to provide more compile-time safety. Currently settings are [registered](https://github.com/ryanofsky/bitcoin/blob/03cff2c1421e5db59963eba1a845ef5dd318c275/src/init.cpp#L504) and [retrieved](https://github.com/ryanofsky/bitcoin/blob/03cff2c1421e5db59963eba1a845ef5dd318c275/src/init.cpp#L173) like:\n\n```c++\n// Register setting\nargsman.AddArg(\"-pid=<file>\", strprintf(\"Specify pid file. Relative paths will be prefixed by a net-specific datadir location. (default: %s)\", BITCOIN_PID_FILENAME), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n\n// Retrieve setting\nargs.GetPathArg(\"-pid\", BITCOIN_PID_FILENAME)\n```\n\nBut this is not ideal because nothing checks that setting names are spelled correctly, or that default values (`BITCOIN_PID_FILENAME`) are used consistently in the help string and retrieval sites, or that settings are retrieved with consistent types (bool, int, string, path, or list). This PR addresses these issues by adding setting [declarations](https://github.com/ryanofsky/bitcoin/blob/416860fc360b3d5aa1a0782ab8f8454b46e6d657/src/init_settings.h#L267-L270) which allow settings to be [registered](https://github.com/ryanofsky/bitcoin/blob/416860fc360b3d5aa1a0782ab8f8454b46e6d657/src/init.cpp#L484) and [retrieved](https://github.com/ryanofsky/bitcoin/blob/416860fc360b3d5aa1a0782ab8f8454b46e6d657/src/init.cpp#L164C38-L164C59) like:\n\n```c++\n// Declare setting\nusing PidSetting = common::Setting<\n    \"-pid=<file>\", fs::path, {.legacy = true},\n    \"Specify pid file. Relative paths will be prefixed by a net-specific datadir location. (default: %s)\">\n    ::DefaultFn<[] { return BITCOIN_PID_FILENAME; }>;\n\n// Register setting\nPidSetting::Register(argsman);\n\n// Retrieve setting\nPidSetting::Get(args)\n```\n\n---\n\n#### Suggestions for review\n\nAll the real changes in this PR are in the last scripted-diff commit:\n\n- [scripted-diff: Replace AddArgs / GetArgs calls with Setting Register / Get calls](https://github.com/bitcoin/bitcoin/pull/31260/commits/fc2591a35b0640adc0df686b0f8bed5f50ada9ce)\n\nIf you take a few minutes to look at the changes applied in this scripted-diff commit, you'll understand everything this PR is doing. A good place to start looking around in this commit is the generated [`src/init_settings.h`](https://github.com/ryanofsky/bitcoin/blob/pr/scripty/src/init_settings.h) file which declares the settings that get registered in [src/init.cpp](https://github.com/ryanofsky/bitcoin/blob/pr/scripty/src/init.cpp). Then you can look at the surrounding diffs and see they are just replacing `AddArg` and `GetArg` calls.\n\nThe other notable commit is second commit, which implements the `Setting` class:\n\n- [common: Add Setting class to support typed Settings](https://github.com/bitcoin/bitcoin/pull/31260/commits/e1f016180746db0eebc2c2e1e0786f0cc5da8a43)\n\nThe other commits do minor things like moving code or updating linters. The python script that implements the scripted diff is a temporary artifact that gets deleted. The python script is complicated because it does things like parsing c++ code to extract help strings, and figuring out the right types to declare settings with so code compiles. But the entire scope of the script is to (1) generate Setting type definitions, (2) add #includes, and (3) replace `AddArg()` calls with `Register()` calls and `GetArg()` calls with `Get()` calls. So there is not much the script can actually do wrong without triggering build and test failures.\n\n---\n\n#### Extensions\n\nThis PR only adds the ability to declare individual settings with built-in types. It doesn't provide any new runtime behavior, but a branch in issue #22978 extends the `Setting` class implemented here to support runtime setting validation, additional types like `std::variant`, additional conversion options, custom types, custom validation, and groups of settings declared as options structs.\n\nThis change is mostly orthogonal to #16545. #16545 only provides runtime type checking while this PR only provides compile-time checking with no new runtime behavior. But this change does allow a nicer way of declaring types in #16545, using c++ types like `int` instead of flags like `ALLOW_INT`, or`std::vector<std::string>` instead of `ALLOW_STRING | ALLOW_LIST`.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-11-08T22:34:46Z",
      "updated_at": "2026-01-18T20:18:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31260",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 4326,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2683353492,
      "number": 33033,
      "title": "wallet, sqlite: Encapsulate SQLite statements in a RAII class",
      "body": "SQLite statements are C objects which can be long lived, so having them be initialized in a constructor, and cleanup everything in a destructor, makes the sqlite code cleaner and easier to read. This also lets us have the various functions needed to interact with sqlite statements be member functions.\r\n\r\nThis will be particularly useful in future work which makes use of more complicated SQL statements.",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-07-21T22:43:08Z",
      "updated_at": "2026-01-18T19:31:32Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33033",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 467,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2712708880,
      "number": 33112,
      "title": "wallet: relax external_signer flag constraints",
      "body": "The `external_signer` indicates that an external signer device may be called via [HWI](https://github.com/bitcoin-core/HWI) or [equivalent](https://github.com/bitcoin/bitcoin/blob/master/doc/external-signer.md#signer-api) application.\r\n\r\nWhen it was initially introduced some additional constraints were placed on wallets with this flag: it had to be a descriptor wallet and watch-only. Also the flag could not be added or removed later.\r\n\r\nThe constraints aren't a problem for the main supported and documented use case of connecting a single hardware wallet and using it just like a normal single sig Bitcoin Core wallet.\r\n\r\nBut they get in the way of more advanced constructions, which are becoming increasingly practical especially once MuSig2 support lands with #29675. See https://github.com/Sjors/bitcoin/pull/91 and https://github.com/bitcoin-core/HWI/pull/794 for a collection of changes on top of that which facilitate MuSig2 with a hardware wallet. And see #24861.\r\n\r\nThis pull requests drops the following constraints:\r\n\r\n- `disable_private_keys` is no longer mandatory (but still default)\r\n- `external_signer` flag is now mutable\r\n\r\nAdditionally it does the following:\r\n\r\n- make the `blank` option for `createwallet` consistent with regular wallets by _not_ importing keys from the connected signer\r\n- avoid going through `createTransaction` for external signers (otherwise the GUI breaks)\r\n- update `external-signer.md` mainly to use named arguments and point out a GUI setting\r\n\r\n\r\nThis should no noticeable effect on the default single sig use case described above.\r\n\r\n \r\n",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-08-01T10:11:18Z",
      "updated_at": "2026-01-18T19:18:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33112",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1635,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1940584116,
      "number": 30343,
      "title": "wallet, logging: Replace WalletLogPrintf() with LogInfo()",
      "body": "Make new logging macros `LogDebug()`, `LogTrace()`, `LogInfo()`, `LogWarning()`, and `LogError()` compatible with wallet code and drop custom WalletLogPrintf() function. The new logging macros introduced in #28318 weren't previously useful in wallet code because wallet code prefixes most log messages with the wallet names to be be able to distinguish log output from multiple wallets. Fix this by introducing a new `WalletLogSource` class inheriting from `BCLog::Source` which can include the wallet name in log messages.\n\n---\n\n<!-- begin based-on -->\n**This is based on #29256.** The non-base commits are:\n\n- [`2d5c5f0e905` wallet, logging: Replace WalletLogPrintf() with LogInfo()](https://github.com/bitcoin/bitcoin/pull/30343/commits/2d5c5f0e90514e4ef4b6343124c827aea1d0eeab)\n- [`4fb99c22c1c` wallet, logging: Switch LogInfo to LogWarning/LogError](https://github.com/bitcoin/bitcoin/pull/30343/commits/4fb99c22c1c0f242dfdda38832a4814b421273d4)\n- [`a08c9bc808e` wallet, logging: Switch LogInfo to LogError in AddWalletDescriptor](https://github.com/bitcoin/bitcoin/pull/30343/commits/a08c9bc808ef19accc90335fb115f791a66e0158)<!-- end -->",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-06-26T17:57:15Z",
      "updated_at": "2026-01-18T18:11:55Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30343",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1201,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3091431534,
      "number": 34049,
      "title": "rpc: Disallow captures in RPCMethodImpl",
      "body": "When defining `RPCHelpMan` objects, we usually return a lambda, and mostly we define those via `[&](...) { ... }` which explicitly captures any parameters or local variables by reference. If we were to actually use any of those captures (we don't), we would invoke undefined behaviour. So instead, convert all the `[&]` to `[]` to avoid capturing, and as part of `RPCHelpMan` check that the function we provide is convertible to a bare function pointer, so that any attempts to capture anything (even if it's by-copy, which is safe) results in an error.\r\n\r\nWhile we're at it, rename `RPCHelpMan` to `RPCMethod`, reflecting it's greater responsibility since #19386.",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2025-12-11T03:25:25Z",
      "updated_at": "2026-01-18T15:06:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34049",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 704,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3184839812,
      "number": 34329,
      "title": "rpc,net: Add private broadcast RPCs",
      "body": "Follow up from #29415 \r\n\r\nSending a transaction via private broadcast does not have any way for a user to track the status of the transaction before it gets returned by another peer. The default logs will likely be removed as well in #34267. Nor is there any way to abort a transaction once it has been added to the private broadcast queue.\r\n\r\nThis adds two new RPCs:\r\n- `getprivatebroadastinfo` returns information about what transactions are in the private broadcast queue, including how many times and how recently the transactions have been sent and acknowledged by peers.\r\n- `abortprivatebroadcast` removes a transaction from the private broadcast queue.",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2026-01-18T01:46:20Z",
      "updated_at": "2026-01-18T14:46:32Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34329",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 695,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2999849822,
      "number": 33856,
      "title": "kernel, validation: Refactor ProcessNewBlockHeaders to return BlockValidationState",
      "body": "## Motivation\r\n\r\nThis PR refactors `ProcessNewBlockHeaders()` to return `BlockValidationState` by value instead of using out-parameters or boolean returns. This follows the pattern established in #31981 (commit 74690f4) which refactored `TestBlockValidity()` in a similar manner.\r\n\r\n### Current Issues\r\n **ProcessNewBlockHeaders()**: Uses an out-parameter `BlockValidationState& state`, making the API less intuitive.\r\n\r\nAs noted by @theCharlatan in #33822 [comment](https://github.com/bitcoin/bitcoin/pull/33822#discussion_r2508065115) and can be a fix for that too:\r\n> One thing that could be considered here is returning the BlockValidationState directly instead of having an in/out param. To safely do that I think we'd need to refactor ProcessNewBlockHeaders though, similarly to what was done in 74690f4.\r\n\r\nThe changes are split into two commits, see individual commit message for more info.",
      "state": "open",
      "user": "yuvicc",
      "created_at": "2025-11-11T17:23:59Z",
      "updated_at": "2026-01-18T14:43:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33856",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 981,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3086363450,
      "number": 34036,
      "title": "contrib: update macOS SDK to Xcode-26.1.1-17B100",
      "body": "Would close #34034.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2025-12-09T16:45:55Z",
      "updated_at": "2026-01-18T11:26:23Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34036",
      "labels": [
        "Scripts and tools",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 68,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2282546380,
      "number": 31675,
      "title": "[test] fix p2p_orphan_handling.py empty orphanage check",
      "body": "Fix CI: https://cirrus-ci.com/task/4584274617171968?logs=ci#L2784",
      "state": "closed",
      "user": "glozow",
      "created_at": "2025-01-16T18:58:24Z",
      "updated_at": "2026-01-18T10:55:58Z",
      "merged_at": "2025-01-17T09:37:30Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31675",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 121,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 578665495,
      "number": 21283,
      "title": "Implement BIP 370 PSBTv2",
      "body": "BIP 370 PSBTv2 introduces several new fields and different invariants for PSBT. This PR implements those new fields and restructures the PSBT implementation to match PSBTv2 but still remain compatible with PSBTv0.",
      "state": "open",
      "user": "achow101",
      "created_at": "2021-02-23T18:29:20Z",
      "updated_at": "2026-01-18T08:08:39Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/21283",
      "labels": [
        "Wallet",
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 238,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1047758233,
      "number": 26022,
      "title": "Add util::ResultPtr class",
      "body": "<!-- begin based-on -->\n**This is based on #25665.** The non-base commits are:\n\n- [`5142f017eaa` Add util::ResultPtr class](https://github.com/bitcoin/bitcoin/pull/26022/commits/5142f017eaa3b3f6d0109fc9f836e6243349d541)\n- [`8ef747c80fc` Use ResultPtr<unique_ptr> instead of Result<unique_ptr>](https://github.com/bitcoin/bitcoin/pull/26022/commits/8ef747c80fc3e39ecb2bb5856a489cbfc5737f48)<!-- end -->\n\n---\n\nThe `util::ResultPtr` class is a wrapper for `util::Result` providing syntax sugar to make it less awkward to use with returned pointers. Instead of needing to be deferenced twice with `**result` or `(*result)->member`, it only needs to be dereferenced once with `*result` or `result->member`. Also when it is used in a boolean context, instead of evaluating to true when there is no error and the pointer is null, it evaluates to false so it is straightforward to determine whether the result points to something.\n\nThis PR is only partial a solution to #26004 because while it makes it easier to check for null pointer values, it does not make it impossible to return a null pointer value inside a successful result. It would be possible to enforce that successful results always contain non-null pointers by using a `not_null` type (https://github.com/bitcoin/bitcoin/issues/24423) in combination with `ResultPtr`, though.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2022-09-06T15:57:14Z",
      "updated_at": "2026-01-18T07:57:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/26022",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1358,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1640676570,
      "number": 29060,
      "title": "Policy: Report debug message why inputs are non standard",
      "body": "This PR is another attempt at  #13525.\r\n\r\nTransactions that fail `PreChecks` Validation due to non-standard inputs now  returns invalid validation state`TxValidationResult::TX_INPUTS_NOT_STANDARD` along with a debug error message.\r\n\r\nPreviously, the debug error message for non-standard inputs do not specify why the inputs were considered non-standard. \r\nInstead, the same error string, `bad-txns-nonstandard-inputs`, used for all types of non-standard input scriptSigs.\r\n\r\nThis PR updates the `AreInputsStandard`  to include the reason why inputs are non-standard in the debug message.\r\nThis improves the `Precheck` debug message to be more descriptive.\r\n\r\nFurthermore, I have addressed all remaining comments from #13525 in this PR.\r\n",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2023-12-12T13:16:05Z",
      "updated_at": "2026-01-18T07:27:23Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29060",
      "labels": [
        "TX fees and policy"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 794,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1655695603,
      "number": 29136,
      "title": "wallet: `addhdkey` RPC to add just keys to wallets via new `unused(KEY)` descriptor",
      "body": "It is sometimes useful for the wallet to have keys that it can sign with but are not (initially) involved in any scripts, e.g. for setting up a multisig. Ryanofsky [suggested](https://github.com/bitcoin/bitcoin/pull/26728#issuecomment-1867721948) A `unused(KEY)` descriptor which allows for a key to be specified, but produces no scripts. These can be imported into the wallet, and subsequently retrieved with `gethdkeys`. Additionally, `listdescriptors` will output these descriptors so that they can be easily backed up.\r\n\r\nIn order to make it easier for people to add HD keys to their wallet, and to generate a new one if they want to rotate their descriptors, an `addhdkey` RPC is also added. Without arguments, it will generate a new HD key and add it to the wallet via a `unused(KEY)` descriptor. If provided a private key, it will construct the descriptor and add it to the wallet.\r\n\r\nSee also: https://github.com/bitcoin/bitcoin/pull/26728#issuecomment-1866961865\r\n\r\nBased on #29130 as `gethdkeys` is useful for testing this.",
      "state": "open",
      "user": "achow101",
      "created_at": "2023-12-22T23:40:15Z",
      "updated_at": "2026-01-18T07:24:22Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29136",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1117,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1785565107,
      "number": 29700,
      "title": "kernel, refactor: return error status on all fatal errors",
      "body": "Return util::Result objects from all functions that can trigger fatal errors.\n\nThere are many validation functions that handle failures by calling `AbortNode` and triggering shutdowns, without returning error information to their callers. This makes error handling in libbitcoinkernel application code difficult, because the only way to handle these errors is to register for [notification callbacks](https://github.com/bitcoin/bitcoin/blob/master/src/kernel/notifications_interface.h). Improve this by making all functions that trigger fatal errors return util::Result objects with the error information.\n\nThis PR is a pure refactoring that returns extra result information from functions without changing their behavior. It's a possible alternative to and subset of #29642, which adds similar return information but also makes behavior changes and exposes a FatalError type.\n\n---\n\n<!-- begin based-on -->\n**This is based on #25665.** The non-base commits are:\n\n- [`c58e61f9911` refactor, kernel: Add FlushStatus / FlushResult types](https://github.com/bitcoin/bitcoin/pull/29700/commits/c58e61f9911dbbf2e1e7b43896cccad3e4c07bc1)\n- [`be34dd34d3f` refactor: Add InfoType field to util::Result](https://github.com/bitcoin/bitcoin/pull/29700/commits/be34dd34d3f62f86a2bd742795d12fd645ab32fd)\n- [`b9f6a3666d5` refactor, blockstorage: Return FlushResult from flush methods](https://github.com/bitcoin/bitcoin/pull/29700/commits/b9f6a3666d5f64a0ada4092b507e8fe5fddbbe08)\n- [`ca795bf4b17` refactor, blockstorage: Return fatal errors from block writes](https://github.com/bitcoin/bitcoin/pull/29700/commits/ca795bf4b1740df978f586b353fe308dc9b01ac3)\n- [`85078c8dbfe` refactor, validation: Switch to result.Update](https://github.com/bitcoin/bitcoin/pull/29700/commits/85078c8dbfe5631f735d1f58b78c79900d29e857)\n- [`431621bde28` refactor, blockstorage: Return fatal error from LoadBlockIndex](https://github.com/bitcoin/bitcoin/pull/29700/commits/431621bde2822b216926988699441837b14b5cb4)\n- [`8f2d7139167` refactor, validation: Return fatal errors from FlushStateToDisk](https://github.com/bitcoin/bitcoin/pull/29700/commits/8f2d7139167e5162ca45988ff844cd58becc78c8)\n- [`b5686de0da5` refactor, validation: Return fatal errors from mempool accept functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/b5686de0da5540acb2aec035f5dfbf0f554283fe)\n- [`9eeab948953` refactor, validation: Return fatal errors from assumeutxo snapshot functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/9eeab948953330050fc10b044a9bc4cf3eff16cf)\n- [`08200e60968` refactor, validation: Return fatal errors from block connect functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/08200e6096878b85f3150d033bb9f9f9ed133ffb)\n- [`1910899d0b1` refactor, validation: Return fatal errors from activate best chain functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/1910899d0b13fa7d3db7358c1150cd9ed80d4dba)\n- [`7cefb824939` refactor, validation: Return fatal errors from new block functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/7cefb824939c3d114176f21b515520d8646a4991)\n- [`7cd8dac6b81` refactor, blockstorage: Return fatal error from ImportBlocks](https://github.com/bitcoin/bitcoin/pull/29700/commits/7cd8dac6b815636b5ffab9d4a5c309e058c3854a)\n- [`01ea9da0f4e` refactor, validation: Return more errors from VerifyDB](https://github.com/bitcoin/bitcoin/pull/29700/commits/01ea9da0f4e991e683a65ee2ebcd2164764feeaa)\n- [`f81a1a468d8` ci: Avoid -Wno-error=maybe-uninitialized false positives](https://github.com/bitcoin/bitcoin/pull/29700/commits/f81a1a468d89689524a37a27384110aa69257386)\n- [`871651378ca` tidy: Set bugprone-unused-return-value.AllowCastToVoid](https://github.com/bitcoin/bitcoin/pull/29700/commits/871651378ca0af03365040f60858a2939e4bdf68)<!-- end -->",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-03-21T23:11:56Z",
      "updated_at": "2026-01-18T07:09:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29700",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3844,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1939750059,
      "number": 30341,
      "title": "Permit Combiner to strip bip32_deriv information",
      "body": "Closes: #30294\r\n\r\nLooking for approach (N)ACK.\r\n\r\nPreviously setting the `bip32derivs` flag to false with the `walletprocesspsbt` RPC correctly does not include `bip32_derivs` for inputs in the PSBT, but does include `bip32_derivs` for outputs.\r\n\r\nUser may want to actively strip all bip32 derivation paths from a PSBT for privacy reasons however. It may make sense to do this after signing your inputs and outputs during a manual coinjoin as demonstrated in the [BIP174 example](https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki#manual-coinjoin-workflow).\r\n\r\nTo me, this makes more sense to include in the [`Combiner`](https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki#combiner) PSBT role. It's then separated from signing done by the `Signers`. \r\n\r\nTherefore add functionality to `combinepsbt` permitting stripping of **all** `bip32_derivation` paths found in all provided psbts' inputs and outputs.\r\n\r\nAs this RPC can be called with a single PSBT, it can be used to strip derivation paths from a PSBT with any number of participants.\r\n",
      "state": "open",
      "user": "willcl-ark",
      "created_at": "2024-06-26T11:01:47Z",
      "updated_at": "2026-01-18T06:57:30Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30341",
      "labels": [
        "PSBT"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1113,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2250366940,
      "number": 31560,
      "title": "rpc: allow writing UTXO set to a named pipe, introduce dump_to_sqlite.sh script",
      "body": "This PR slightly modifies the `dumptxoutset` RPC to allow writing the UTXO set dump into a [named pipe](https://askubuntu.com/a/449192), so that the output data can be consumed by another process, see #31373. Taking use of this with the utxo-to-sqlite.py tool (introduced in #27432), creating an UTXO set in SQLite3 format is possible on the fly and becomes a one-liner with a newly introduced script `dump_to_sqlite.sh`. E.g. for signet:\r\n```\r\n$ ./contrib/utxo-tools/dump_to_sqlite.sh \"./build/src/bitcoin-cli -signet\" ~/utxos.sqlite3\r\nUTXO Snapshot for Signet at block hash 000000ddc3b251483cf1ebb23e2750ba..., contains 5705634 coins\r\n1048576 coins converted [18.38%], 4.474s passed since start\r\n2097152 coins converted [36.76%], 8.793s passed since start\r\n3145728 coins converted [55.13%], 13.146s passed since start\r\n4194304 coins converted [73.51%], 17.478s passed since start\r\n5242880 coins converted [91.89%], 21.832s passed since start\r\n{\r\n  \"coins_written\": 5705634,\r\n  \"base_hash\": \"000000ddc3b251483cf1ebb23e2750ba2490701d0c547241b247a9beb85498d0\",\r\n  \"base_height\": 227678,\r\n  \"path\": \"/tmp/tmp.MFHEVqetv0/utxos.fifo\",\r\n  \"txoutset_hash\": \"f29e524c999487cbd0cfca5201dce67c2c5e5c5eb115c63ad48c2239f23eea4c\",\r\n  \"nchaintx\": 8272649\r\n}\r\nTOTAL: 5705634 coins written to /home/thestack/utxos.sqlite3, snapshot height is 227678.\r\n```\r\nNote that the `dumptxoutset` RPC calculates an UTXO set hash as a first step before any data is emitted, so especially on mainnet it takes quite a while until the conversion starts and something is happening visibly.\r\n\r\nThe new script is quite minimal and PoC-y at this point, there are some potential improvement ideas:\r\n- better error handling (e.g. detect if bitcoin-cli exists, clean up tmpdir if bitcoin-cli execution fails etc.)\r\n- allow to pass through the rollback option (now we always dump at the current height, i.e. \"latest\" parameter)",
      "state": "open",
      "user": "theStack",
      "created_at": "2024-12-24T02:42:27Z",
      "updated_at": "2026-01-18T06:09:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31560",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1968,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2285701879,
      "number": 31682,
      "title": "[IBD] specialize CheckBlock's input & coinbase checks",
      "body": "This change is part of [[IBD] - Tracking PR for speeding up Initial Block Download](https://github.com/bitcoin/bitcoin/pull/32043)\r\n\r\n### Summary\r\n`CheckBlock`'s latency is critical for efficiently validating correct inputs during transaction validation, including mempool acceptance and new block creation.\r\n\r\nThis PR improves performance and maintainability by introducing the following changes:\r\n* Simplified checks for the most common cases (1 or 2 inputs - [70-90% of transactions have a single input](https://transactionfee.info/charts/transactions-1in)).\r\n* Optimized the general case by replacing `std::set` with sorted `std::vector` for improved locality.\r\n* Simplified Null prevout checks from linear to constant time.\r\n\r\n### Context, concerns\r\n\r\nAs noted by Sipa in https://github.com/bitcoin/bitcoin/pull/31682#pullrequestreview-2570273162, this is consensus-critical code (especially since we've had an actual inflation bug related to duplicate checking).\r\nHowever, the changes here are very confined to a single function, easily reviewed, and I have a general preference for avoiding `std::set` when sorted `std::vector` works too as well.\r\n\r\nThe goal of this change is to [make block validation faster](https://github.com/bitcoin/bitcoin/pull/14387#issuecomment-442748969) via a low-risk alternative.\r\n\r\n### Measurements\r\n\r\n<details>\r\n<summary>C++ compiler .......................... AppleClang 16.0.0.16000026</summary>\r\n\r\n> Before:\r\n\r\n|            ns/block |             block/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|          372,743.63 |            2,682.81 |    1.1% |     10.99 | `CheckBlockBench`\r\n\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|        3,304,694.54 |              302.60 |    0.5% |     11.05 | `DuplicateInputs`\r\n|            9,585.10 |          104,328.55 |    0.1% |     11.03 | `ProcessTransactionBench`\r\n\r\n> After:\r\n\r\n|            ns/block |             block/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|          179,971.00 |            5,556.45 |    0.3% |     11.02 | `CheckBlockBench`\r\n\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|          963,177.98 |            1,038.23 |    1.7% |     10.92 | `DuplicateInputs`\r\n|            9,410.90 |          106,259.75 |    0.3% |     11.01 | `ProcessTransactionBench`\r\n\r\n</details>\r\n\r\n* 2.07x faster `CheckBlockBench`\r\n* 3.4x faster `DuplicateInputs`\r\n* 1.8% faster `ProcessTransactionBench`\r\n\r\n-----\r\n\r\n<details>\r\n<summary>C++ compiler .......................... GNU 13.3.0</summary>\r\n\r\n> Before:\r\n\r\n|            ns/block |             block/s |    err% |       ins/block |       cyc/block |    IPC |      bra/block |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|        1,096,261.84 |              912.19 |    0.1% |    7,963,390.88 |    3,487,375.26 |  2.283 |   1,266,941.00 |    1.8% |     11.03 | `CheckBlockBench`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|        8,366,309.48 |              119.53 |    0.0% |   23,865,177.67 |   26,620,160.23 |  0.897 |   5,972,887.41 |    4.0% |     10.78 | `DuplicateInputs`\r\n|           56,199.57 |           17,793.73 |    0.1% |      229,263.01 |      178,766.31 |  1.282 |      15,509.97 |    0.5% |     10.91 | `ProcessTransactionBench`\r\n\r\n> After:\r\n\r\n|            ns/block |             block/s |    err% |       ins/block |       cyc/block |    IPC |      bra/block |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|          834,855.94 |            1,197.81 |    0.0% |    6,518,548.86 |    2,656,039.78 |  2.454 |     919,160.84 |    1.5% |     10.78 | `CheckBlockBench`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|        4,261,492.75 |              234.66 |    0.0% |   17,379,823.40 |   13,559,793.33 |  1.282 |   4,265,714.28 |    3.4% |     11.00 | `DuplicateInputs`\r\n|           55,819.53 |           17,914.88 |    0.1% |      227,828.15 |      177,520.09 |  1.283 |      15,184.36 |    0.4% |     10.91 | `ProcessTransactionBench`\r\n\r\n</details>\r\n\r\n* 31% faster `CheckBlockBench`\r\n* 2x faster `DuplicateInputs`\r\n* 0.5% faster `ProcessTransactionBench`\r\n\r\n----\r\n\r\nWhile the point of the change isn't necessarily to speed up IBD, but you can see the measurements at https://github.com/bitcoin/bitcoin/pull/31682#issuecomment-2606765689\r\n\r\n----\r\n\r\nRelated PRs: \r\n* https://github.com/bitcoin/bitcoin/pull/14397 - very similar solution, I only found it after pushing the PR (was closed for inactivity)\r\n* https://github.com/bitcoin/bitcoin/pull/14837 - a faster, but a lot more complex alternative (was closed for complexity and inactivity).",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-01-18T15:03:56Z",
      "updated_at": "2026-01-18T05:54:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31682",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 5734,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2336649960,
      "number": 31868,
      "title": "[IBD] specialize block serialization",
      "body": "This change is part of [[IBD] - Tracking PR for speeding up Initial Block Download](https://github.com/bitcoin/bitcoin/pull/32043)\r\n\r\n---\r\n\r\nThis PR is drafted until I remeasure everything after the recent merges and I need to find a way to simplify the 1 byte writes more nicely, I don't like all the specializations.\r\n\r\n---\r\n\r\n### Summary\r\n\r\nThis PR contain a few different optimization I found by IBD profiling, and via the newly added block seralization benchmarks. It also takes advantage of the recently merged [`std::span` changes](https://github.com/bitcoin/bitcoin/pull/31519) enabling propagating static extents.\r\n\r\nThe commits merge similar (de)serialization methods, and separates them internally with  `if constexpr` - similarly to how it has been [done here before](https://github.com/bitcoin/bitcoin/pull/28203). This enabled further `SizeComputer` optimizations as well.\r\n\r\n### Context\r\nOther than these, since single byte writes are used very often (used for every `(u)int8_t` or `std::byte` or `bool` and for every `VarInt`'s first byte which is also needed for every `(pre)Vector`), it makes sense to avoid the generalized serialization infrastructure that isn't needed:\r\n* `AutoFile` write doesn't need to allocate 4k buffer for a single byte now;\r\n* `VectorWriter` and `DataStream` avoids memcpy/insert calls;\r\n* `CSHA256::Write` can avoid `memcpy`.\r\n\r\n`DeserializeBlock` is dominated by the hash calculations so the optimizations barely affect it.\r\n\r\n### Measurements\r\n\r\n<details>\r\n<summary>C compiler ............................ AppleClang 16.0.0.16000026</summary>\r\n\r\n> Before:\r\n\r\n|            ns/block |             block/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|          195,610.62 |            5,112.20 |    0.3% |     11.00 | `SerializeBlock`\r\n|           12,061.83 |           82,906.19 |    0.1% |     11.01 | `SizeComputerBlock`\r\n\r\n> After:\r\n\r\n|            ns/block |             block/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|          174,569.19 |            5,728.39 |    0.6% |     10.89 | `SerializeBlock`\r\n|           10,241.16 |           97,645.21 |    0.0% |     11.00 | `SizeComputerBlock`\r\n\r\n</details>\r\n\r\n> `SerializeBlock` - ~12.% faster\r\n> `SizeComputerBlock` - ~17.7% faster\r\n\r\n-----\r\n\r\n\r\n<details>\r\n<summary>C++ compiler .......................... GNU 13.3.0</summary>\r\n\r\n> Before:\r\n\r\n|            ns/block |             block/s |    err% |       ins/block |       cyc/block |    IPC |      bra/block |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|          867,857.55 |            1,152.26 |    0.0% |    8,015,883.90 |    3,116,099.08 |  2.572 |   1,517,035.87 |    0.5% |     10.81 | `SerializeBlock`\r\n|           30,928.27 |           32,332.88 |    0.0% |      221,683.03 |      111,055.84 |  1.996 |      53,037.03 |    0.8% |     11.03 | `SizeComputerBlock`\r\n\r\n> After:\r\n\r\n|            ns/block |             block/s |    err% |       ins/block |       cyc/block |    IPC |      bra/block |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|          615,000.56 |            1,626.01 |    0.0% |    8,015,883.64 |    2,208,340.88 |  3.630 |   1,517,035.62 |    0.5% |     10.56 | `SerializeBlock`\r\n|           25,676.76 |           38,945.72 |    0.0% |      159,390.03 |       92,202.10 |  1.729 |      42,131.03 |    0.9% |     11.00 | `SizeComputerBlock`\r\n\r\n</details>\r\n\r\n> `SerializeBlock` - ~41.1% faster\r\n> `SizeComputerBlock` - ~20.4% faster\r\n\r\n----\r\n\r\nWhile this wasn't the main motivation for the change, IBD on Ubuntu/GCC on SSD with i9 indicates a 2% speedup as well:\r\n\r\n<details>\r\n<summary>Details</summary>\r\n\r\n```bash\r\nCOMMITS=\"05314bde0b06b820225f10c6529b5afae128ff81 1cd94ec2511874ec68b92db34ad7ec7d9534fed1\"; \\\r\nSTOP_HEIGHT=880000; DBCACHE=10000; \\\r\nC_COMPILER=gcc; CXX_COMPILER=g++; \\\r\nhyperfine \\\r\n--export-json \"/mnt/my_storage/ibd-${COMMITS// /-}-${STOP_HEIGHT}-${DBCACHE}-${C_COMPILER}.json\" \\\r\n--runs 3 \\\r\n--parameter-list COMMIT ${COMMITS// /,} \\\r\n--prepare \"killall bitcoind || true; rm -rf /mnt/my_storage/BitcoinData/*; git checkout {COMMIT}; git clean -fxd; git reset --hard; cmake -B build -DCMAKE_BUILD_TYPE=Release -DENABLE_WALLET=OFF -DCMAKE_C_COMPILER=$C_COMPILER -DCMAKE_CXX_COMPILER=$CXX_COMPILER && cmake --build build -j$(nproc) --target bitcoind && ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=1 -printtoconsole=0 || true\" \\\r\n--cleanup \"cp /mnt/my_storage/BitcoinData/debug.log /mnt/my_storage/logs/debug-{COMMIT}-$(date +%s).log || true\" \\\r\n\"COMPILER=$C_COMPILER COMMIT={COMMIT} ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=$STOP_HEIGHT -dbcache=$DBCACHE -prune=550 -printtoconsole=0\"\r\nBenchmark 1: COMPILER=gcc COMMIT=05314bde0b06b820225f10c6529b5afae128ff81 ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=880000 -dbcache=10000 -prune=550 -printtoconsole=0\r\n  Time (mean Â± Ïƒ):     33647.918 s Â± 508.655 s    [User: 71503.409 s, System: 4404.899 s]\r\n  Range (min â€¦ max):   33283.439 s â€¦ 34229.026 s    3 runs\r\n \r\nBenchmark 2: COMPILER=gcc COMMIT=1cd94ec2511874ec68b92db34ad7ec7d9534fed1 ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=880000 -dbcache=10000 -prune=550 -printtoconsole=0\r\n  Time (mean Â± Ïƒ):     33062.491 s Â± 183.335 s    [User: 71246.532 s, System: 4318.490 s]\r\n  Range (min â€¦ max):   32888.211 s â€¦ 33253.706 s    3 runs\r\n \r\nSummary\r\n  COMPILER=gcc COMMIT=1cd94ec2511874ec68b92db34ad7ec7d9534fed1 ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=880000 -dbcache=10000 -prune=550 -printtoconsole=0 ran\r\n    1.02 Â± 0.02 times faster than COMPILER=gcc COMMIT=05314bde0b06b820225f10c6529b5afae128ff81 ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=880000 -dbcache=10000 -prune=550 -printtoconsole=0\r\n```\r\n\r\n</details>",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-02-14T16:48:23Z",
      "updated_at": "2026-01-18T05:42:43Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31868",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 6242,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2498563333,
      "number": 32420,
      "title": "miner: drop dummy extraNonce in coinbase scriptSig for templates requested via IPC",
      "body": "Our miner code adds `OP_0` as a dummy `extraNonce` to the coinbase `scriptSig`. This has been in place since v0.1.0 and removing it entirely would trigger the `bad-cb-length` consensus error on test networks for blocks 1 through 16 (`OP1` through `OP_16`).\r\n\r\nPreviously the coinbase transaction generated by our miner code was not used downstream, because the `getblocktemplate` RPC excludes it. Since the Mining IPC interface was introduced in #30200 we do expose this dummy coinbase transaction. In Stratum v2 several parts of it are communicated downstream, including the `scriptSig`.\r\n\r\nThis PR adds a `include_dummy_extranonce` option which is `false` by default, but for the time being all test code opts in to it. This avoids churning hardcoded block and transaction hashes.\r\n\r\nThe effect of having the default `false` for IPC callers is that we remove the dummy `extraNonce` from the coinbase `scriptSig` in block templates requested that way. This limits the `scriptSig` to what is essential for consensus (BIP34) and removes the need for external mining software to remove the dummy, or even ignore the `scriptSig` we provide and generate it some other way. This could cause problems if a future soft fork requires additional data to be committed here.\r\n\r\n`test/functional/interface_ipc.py` is expanded to verify the new IPC behavior.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-05-05T12:01:31Z",
      "updated_at": "2026-01-18T04:47:43Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32420",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1428,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2527184806,
      "number": 32554,
      "title": "bench: replace embedded raw block with configurable block generator",
      "body": "### Problem\r\n\r\nThe [hardcoded benchmark block 413567](https://mempool.space/block/413567) has several issues:\r\n- embeds 1.1MB of binary data in the repository\r\n- mined in 2016, predates SegWit v0, Taproot, and modern script types\r\n- benchmarks cannot test different transaction patterns or script mixes\r\n- updating to a newer block (e.g., [#32457](https://github.com/bitcoin/bitcoin/pull/32457)) would still add binary bloat and would remain inflexible\r\n\r\n### Fix\r\n\r\nAdded configurable `bench/block_generator.{h,cpp}` that builds fully valid blocks at runtime providing blocks or raw serialized stream.\r\n\r\nNote that `HexStrBench` was simplified to work with random data - it doesn't need to be block-related.\r\n\r\n---\r\n\r\nThis supersedes #32457 by eliminating the need for any hardcoded block data while enabling flexible benchmark scenarios.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-05-18T21:39:14Z",
      "updated_at": "2026-01-18T04:23:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32554",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 907,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2545149066,
      "number": 32621,
      "title": "contrib: utxo_to_sqlite.py: add option to store txid/spk as BLOBs",
      "body": "This PR is a late follow-up to https://github.com/bitcoin/bitcoin/pull/27432, introducing an option for the utxo-to-sqlite script to store the txid/scriptPubKey columns as bytes (= `BLOB` storage class in sqlite, see e.g. https://www.sqlite.org/datatype3.html in sqlite) rather than hex strings. This was proposed in earlier reviews (https://github.com/bitcoin/bitcoin/pull/27432#issuecomment-1516857024, https://github.com/bitcoin/bitcoin/pull/27432#issuecomment-1653739351) and has the obvious advantage of a significantly smaller size of the resulting database (and with that, faster conversion) and the avoidance of hex-to-bytes conversion for further processing of the data [1]. The rationale on why hex strings were chosen back then (and still stays the default, if only for compatibility reasons) is laid out in https://github.com/bitcoin/bitcoin/pull/27432#issuecomment-1516922824 [2].\r\n\r\nThe approach taken is introducing new parameters `--spk` and `--txid` which can either have the values \"hex\", \"raw\" (for scriptpubkey) and \"hex\", \"raw\", \"rawle\" (for txid). Thanks to ajtowns for providing this suggestion. Happy to take further inputs on naming and thoughts on future extensibility etc.\r\n\r\n[1] For a concrete example, I found that having these columns as bytes would be nice while working on a SwiftSync hints generator tool (https://github.com/theStack/swiftsync-hints-gen), which takes the result of the utxo-to-sqlite tool as input.\r\n[2] note that in contrast what I wrote back then, I think there is no ambiguity on byte-string-serialization of txids; they are ultimately just hash results and hence, they should be stored as such, and adding a big/little endian knob wouldn't make much sense. The drawback of not being able to immediately show txid-strings (as one would need to do the bytes-reversal step first, which is not possible in sqlite, see e.g. https://github.com/bitcoin/bitcoin/pull/24952#issuecomment-1165499803) still remains though.",
      "state": "open",
      "user": "theStack",
      "created_at": "2025-05-27T03:03:35Z",
      "updated_at": "2026-01-18T04:12:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32621",
      "labels": [
        "Scripts and tools"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2031,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2635595853,
      "number": 32857,
      "title": "wallet: allow skipping script paths",
      "body": "While testing MuSig2 integration in #29675 I ran into a Ledger bug https://github.com/LedgerHQ/app-bitcoin-new/issues/329 that was triggered because we signed for a script path in addition to the key path. The bug itself will be fixed, but it seems useful in general to be able to skip script path signing.\r\n\r\nFor example, you may have a 2-of-2 musig() descriptor with some sort of fallback after coins are N blocks old. For both on chain privacy and fee reasons, you don't want to use this path unless absolutely necessary. But our wallet can't know if our co-signer still has their key, so we sign the script path at all times. This could lead to accidental broadcast.\r\n\r\nThis PR introduces a `keypath_only` option (default `false` for now) to:\r\n- the `send` RPC \r\n- the `walletprocesspsbt` RPC.\r\n\r\nThe resulting PSBT won't include `taproot_script_path_sigs`. It does still have `taproot_bip32_derivs` and `musig2_participant_pubkeys`.\r\n\r\nThe `wallet_taproot.py` tests are expanded to cover this behavior.\r\n\r\nIt can also be tested with https://github.com/Sjors/bitcoin/pull/91 and a slightly modified [Moosig](https://github.com/LedgerHQ/moosig). See https://github.com/LedgerHQ/app-bitcoin-new/issues/329 for the rough steps.\r\n\r\nBased on:\r\n- [ ] #32876\r\n\r\nTODO:\r\n- [ ] maybe refactor `MutableTransactionSignatureCreator`\r\n- [ ] add test coverage for `send`\r\n\r\nPotential followups:\r\n- make this default for `musig()` (after #29675)",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-07-02T14:13:31Z",
      "updated_at": "2026-01-18T03:27:50Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32857",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 1469,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2637847621,
      "number": 32861,
      "title": "Have createwalletdescriptor auto-detect an unused(KEY)",
      "body": "The `createwalletdescriptor` was introduced in #29130 to let users add a `tr()` descriptor to an existing SegWit wallet. The new `addhdkey` method from #29136 introduces a new potential workflow: start from a blank wallet, generate an HD and then add only the descriptors you need, e.g.:\r\n\r\n```sh\r\nbitcoin rpc createwallet TaprootMaxi blank=true\r\nbitcoin rpc addhdkey\r\nbitcoin rpc createwalletdescriptor bech32m\r\n```\r\n\r\nBefore this PR the last line would fail, requiring the user to call `gethdkeys` and copy-paste the xpub.\r\n\r\nThis PR makes `createwalletdescriptor` a bit smarter so it just finds the `unused(KEY)` generated by `hdkey` and uses that.\r\n\r\nIf multiple `unused(KEY)` descriptors are present the user still has to pick one.\r\n\r\nA potential followup is to make our [multisig tutorial](https://github.com/bitcoin/bitcoin/blob/master/doc/multisig-tutorial.md) slightly safer to use. Rather than creating a full wallet, the instruction could be changed to start with a blank wallet and only generate the default legacy descriptor. This avoids accidental use of single sig `p2sh-segwit` and `bech32` addresses.\r\n\r\n(I might do that in #32784, which introduces some other improvements to the tutorial. The situation is still not great; ideally the `importdescriptors` RPC is enhanced to detect when an `xpub` is a child of an hd key and then treats it as if an xpriv was imported.)\r\n\r\nBuilds on #29136.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-07-03T08:55:40Z",
      "updated_at": "2026-01-18T03:24:28Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32861",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1462,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2641394506,
      "number": 32876,
      "title": "refactor: use options struct for signing and PSBT operations",
      "body": "Replace the `sign`, `finalize` , `bip32derivs` and `sighash_type` arguments that are passed to `FillPSBT()` and `SignPSBTInput()` with a `PSBTFillOptions` struct.\r\n\r\n```cpp\r\nstruct PSBTFillOptions {\r\n    bool sign{true};\r\n    std::optional<int> sighash_type{std::nullopt};\r\n    bool finalize{true};\r\n    bool bip32_derivs{true};\r\n};\r\n```\r\n\r\nAdditionally this PR introduces:\r\n\r\n```cpp\r\nstruct SignOptions {\r\n    int sighash_type{SIGHASH_DEFAULT};\r\n};\r\n```\r\n\r\nThis is used by `SignTransaction` and the `MutableTransactionSignatureCreator` constructor.\r\n\r\nThese changes make it easier to add additional options later without large code churn, such as `avoid_script_path` proposed in #32857. It also makes the use of default boolean options safer compared to positional arguments that can easily get mixed up.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-07-04T12:40:44Z",
      "updated_at": "2026-01-18T03:18:25Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32876",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 866,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2871349366,
      "number": 33500,
      "title": "p2p: implement sender-initiated package relay",
      "body": "[BIP 331](https://github.com/bitcoin/bips/blob/master/bip-0331.mediawiki) implements receiver-initiated package relay, where receivers can request missing information about packages. However, this requires excessive round trips. If the sender knows that it is giving the receiver a transaction for which it doesn't have the ancestors, it should be able to just send a package (containing the transaction and the unknown ancestor(s)) instead. \r\n\r\nThis PR could potentially reduce some bandwidth, and could also reduce the number of transactions in the orphanage. However, if a node is sending packages that the receiver already knows about, this could increase significant bandwidth. As a result, this PR needs more testing. I did some initial testing between two nodes with `sendpackages` enabled, and it showed that no redundant packages were sent, which indicates that this may be a useful feature. \r\n\r\nThis PR implements the following:\r\n- signaling support for `sendpackages` and the corresponding negotiation logic\r\n- a node will send a `pkgtxns` message to the receiver node if the ancestor of a transaction that has been requested is not in the receiver node's `m_tx_inventory_known_filter`\r\n- nodes can process `pkgtxns` messages\r\n- the maximum number of transactions that can be sent through sender-initialized package relay has been set to 2, although this can be changed in the future\r\n- adds logging, functional tests, and fuzzing (for `ReceivedPackage`)\r\n\r\nThank you to glozow for her help with this PR! ",
      "state": "open",
      "user": "ishaanam",
      "created_at": "2025-09-29T16:47:55Z",
      "updated_at": "2026-01-18T01:16:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33500",
      "labels": [
        "P2P",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1562,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2919092278,
      "number": 33637,
      "title": "refactor: optimize block index comparisons (1.4-6.8x faster)",
      "body": "### Context\r\nThe comparator is often called either directly or for the sorting of [setBlockIndexCandidates](https://github.com/bitcoin/bitcoin/blob/master/src/validation.h#L637), a red-black tree-set containing valid block headers where the comparator is invoked extensively.\r\nBesided the sorted set usages, the comparator is used directly in `Chainstate` in `FindMostWorkChain`, `PruneBlockIndexCandidates`, `ActivateBestChain` and `InvalidateBlock`; and in `ChainstateManager` in `LoadBlockIndex`, `CheckBlockIndex`, `ActivateSnapshot` and `PopulateAndValidateSnapshot`.\r\n\r\nIt was profiled during the investigation of https://github.com/bitcoin/bitcoin/issues/33618#issuecomment-3402229976. \r\n\r\n### Testing\r\nTo ensure the optimized implementations are both fast and correct, the first commit adds a dedicated benchmark to measure `CBlockIndexWorkComparator` performance, and the second commit adds randomized tests comparing the new implementation with the original one.\r\n\r\n### Results\r\n\r\n> GCC 15.0.1:\r\n\r\n* `CBlockIndexWorkComparator`: 100,772,511 cmp/s â†’ 656,674,205 cmp/s = 6.51x faster\r\n* `CheckBlockIndex`: 9,091 ops/s â†’ 14,765 ops/s = 1.62x faster\r\n\r\n> Clang 22.0.0:\r\n\r\n* `CBlockIndexWorkComparator`: 100,451,893 cmp/s â†’ 683,414,234 cmp/s = 6.8x faster\r\n* `CheckBlockIndex`: 10,322 ops/s â†’ 14,376 ops/s = 1.39x faster\r\n\r\nSee https://corecheck.dev/bitcoin/bitcoin/pulls/33637 for the CI's `CheckBlockIndex` performance.\r\n\r\n<details>\r\n<summary>gcc and clang measurements</summary>\r\n\r\n> Compiler: gcc 15.0.1\r\nb60450fae8 bench: add benchmark to measure `CBlockIndexWorkComparator` performance\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                9.92 |      100,772,511.62 |    0.0% |           63.98 |           35.64 |  1.795 |          14.17 |    1.9% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|          109,996.46 |            9,091.20 |    0.2% |    1,014,421.11 |      394,979.29 |  2.568 |     313,025.11 |    0.0% |      5.50 | `CheckBlockIndex`\r\n\r\ne2e02177ba refactor: inline `arith_uint256` comparison operator\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                6.48 |      154,439,491.66 |    0.0% |           31.01 |           23.25 |  1.334 |           7.16 |    3.8% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|          105,754.86 |            9,455.83 |    0.1% |      913,130.11 |      379,588.20 |  2.406 |     276,692.11 |    0.0% |      5.50 | `CheckBlockIndex`\r\n\r\n85b74b01de refactor: optimize `arith_uint256` comparison with spaceship operator\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                6.37 |      156,990,488.06 |    0.0% |           28.85 |           22.87 |  1.261 |           8.61 |    3.2% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           83,803.10 |           11,932.73 |    0.0% |      743,565.09 |      300,824.84 |  2.472 |     232,646.08 |    0.0% |      5.56 | `CheckBlockIndex`\r\n\r\ndeb58eea2f refactor: optimize `CBlockIndexWorkComparator` with std::tie\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                1.52 |      656,674,205.98 |    0.0% |           13.18 |            5.47 |  2.410 |           3.06 |    0.1% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           67,726.84 |           14,765.19 |    0.2% |      585,826.07 |      243,155.90 |  2.409 |     181,920.07 |    0.0% |      5.54 | `CheckBlockIndex`\r\n\r\n> Compiler: clang 22.0.0\r\n\r\nb60450fae8 bench: add benchmark to measure `CBlockIndexWorkComparator` performance\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                9.96 |      100,451,893.46 |    0.0% |           61.28 |           35.75 |  1.714 |          13.62 |    2.1% |      5.52 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           96,878.70 |           10,322.19 |    0.1% |      802,827.10 |      347,679.01 |  2.309 |     234,823.10 |    0.0% |      5.50 | `CheckBlockIndex`\r\n\r\ne2e02177ba refactor: inline `arith_uint256` comparison operator\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                6.13 |      163,183,693.10 |    0.0% |           25.74 |           22.01 |  1.170 |           6.10 |    4.6% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           86,307.94 |           11,586.42 |    1.2% |      646,229.09 |      309,785.33 |  2.086 |     195,119.09 |    0.0% |      5.54 | `CheckBlockIndex`\r\n\r\n85b74b01de refactor: optimize `arith_uint256` comparison with spaceship operator\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                6.36 |      157,330,900.16 |    1.0% |           26.20 |           22.61 |  1.159 |           6.55 |    4.4% |      5.53 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           75,031.66 |           13,327.71 |    1.0% |      650,604.15 |      266,934.04 |  2.437 |     149,967.14 |    0.0% |      5.54 | `CheckBlockIndex`\r\n\r\ndeb58eea2f refactor: optimize `CBlockIndexWorkComparator` with std::tie\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                1.46 |      683,414,234.14 |    0.0% |           16.12 |            5.25 |  3.067 |           4.02 |    0.1% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           69,559.70 |           14,376.14 |    0.1% |      559,208.07 |      249,654.28 |  2.240 |     132,342.07 |    0.0% |      5.51 | `CheckBlockIndex`\r\n\r\n</details>\r\n\r\n### Reproducer\r\n\r\nRun the equivalence tests with:\r\n```bash\r\ncmake -B build && cmake --build build && ./build/bin/test_bitcoin --run_test=arith_uint256_tests,blockchain_tests\r\n```\r\n\r\nEach commit shows how it changes the relevant benchmarks.\r\n\r\n<details>\r\n<summary>Benchmark script</summary>\r\n\r\n```bash\r\nfor compiler in gcc clang; do \\\r\n  if [ \"$compiler\" = \"gcc\" ]; then CC=gcc; CXX=g++; COMP_VER=$(gcc -dumpfullversion); \\\r\n  else CC=clang; CXX=clang++; COMP_VER=$(clang -dumpversion); fi && \\\r\n  echo \"> Compiler: $compiler $COMP_VER\" && \\\r\n  for commit in b60450fae83970daa9dc2da0706bf126a2f41515 e2e02177ba6f7fac34eda9696dad2e8ecd44e6cd 85b74b01de7e914d07630138eaa78f09a083b85b deb58eea2fdd2712a28aa6b81417087426b19f5b; do \\\r\n    git fetch origin $commit >/dev/null 2>&1 && git checkout $commit >/dev/null 2>&1 && git log -1 --pretty='%h %s' && \\\r\n    rm -rf build && \\\r\n    cmake -B build -DBUILD_BENCH=ON -DENABLE_IPC=OFF -DCMAKE_BUILD_TYPE=RelWithDebInfo -DCMAKE_C_COMPILER=$CC -DCMAKE_CXX_COMPILER=$CXX >/dev/null 2>&1 && \\\r\n    cmake --build build -j$(nproc) >/dev/null 2>&1 && \\\r\n    for i in 1; do \\\r\n      build/bin/bench_bitcoin -filter='CBlockIndexWorkComparator|CheckBlockIndex' -min-time=5000; \\\r\n    done; \\\r\n  done; \\\r\ndone\r\n```\r\n\r\n</details>\r\n\r\nNote: something similar was already started in https://github.com/bitcoin/bitcoin/pull/33334, but this is a broader optimization that doesn't use the same technique: added as coauthor regardless.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-10-16T01:54:31Z",
      "updated_at": "2026-01-18T00:58:58Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33637",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 11203,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2925353202,
      "number": 33645,
      "title": "refactor: optimize: avoid allocations in script & policy verification",
      "body": "Currently, some policy and script related methods are inefficiently allocating/reallocating containers where it is completely unnecessary. \r\n\r\nThis PR aims at optimizing policy verifications by reducing redundant heap allocations without losing performance even in worst case scenarios, effectively reducing the overall memory footprint.",
      "state": "open",
      "user": "Raimo33",
      "created_at": "2025-10-17T18:43:21Z",
      "updated_at": "2026-01-18T00:56:24Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33645",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 407,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3078106843,
      "number": 34023,
      "title": "Optimized SFL cluster linearization",
      "body": "Follow-up to #32545, part of #30289.\r\n\r\nThis contains many of the optimizations that were originally part of #32545 itself.",
      "state": "open",
      "user": "sipa",
      "created_at": "2025-12-06T20:21:44Z",
      "updated_at": "2026-01-17T23:08:31Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34023",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 159,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3084582953,
      "number": 34032,
      "title": "util: Add some more Unexpected and Expected methods",
      "body": "Reviewers requested more member functions In https://github.com/bitcoin/bitcoin/pull/34006.\r\n\r\nThey are currently unused, but bring the port closer to the original `std::expected` implementation:\r\n\r\n* Make `Expected::value()` throw when no value exists\r\n* Add `Unexpected::error()` methods\r\n* Add `Expected<void, E>` specialization\r\n* Add `Expected::value()&&` and `Expected::error()&&` methods\r\n* Add `Expected::swap()`\r\n\r\nAlso, include a tiny tidy fixup:\r\n\r\n* tidy: Set `AllowCastToVoid` in the `bugprone-unused-return-value` check",
      "state": "open",
      "user": "maflcko",
      "created_at": "2025-12-09T08:01:34Z",
      "updated_at": "2026-01-17T22:58:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34032",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 585,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3123216401,
      "number": 34138,
      "title": "Cluster mempool: more accurate cost model for SFL",
      "body": "Builds on top of #34023, part of #30289.\r\n\r\nThis introduces a more accurate cost model for SFL, to control how much CPU time is spent inside the algorithm for clusters that cannot be linearized perfectly within a reasonable amount of time.\r\n\r\nThe goal is having a metric for the amount of work performed, so that txmempool can impose limits on that work: a lower bound that is always performed (unless optimality is reached before that point, of course), and an upper bound to limit the latency and total CPU time spent on this. There are conflicting design goals here:\r\n* On the one hand, it seems ideal if this metric is closely correlated to actual CPU time, because otherwise the limits become inaccurate.\r\n* On the other hand, it seems a nightmare to have the metric be platform/system dependent, as it makes network-wide reasoning nearly impossible. It's expected that slower systems take longer to do the same thing; this holds for everything, and we don't need to compensate for this.\r\n\r\nThere are multiple solutions to this:\r\n* One extreme is just measuring the time. This is very accurate, but extremely platform dependent, and also non-deterministic due to random scheduling/cache effects.\r\n* The other extreme is using a very abstract metric like counting how many times certain loops/function inside the algorithm run. That is what is implemented as of #32545 and #34023, just counting the sum of the numbers of transactions updated across all `UpdateChunks()` calls. It however necessarily fails to account for significant portions of runtime spent elsewhere, resulting in a rather wide range of \"ns per cost\" values.\r\n* This PR takes a middle ground, counting many function calls / branches / loops, with weights that were determined through benchmarking on a reference system (Zen 4 based).\r\n\r\nThis is draft because:\r\n* The weights used are outdated, as several non-trivial improvements were made to #32545 and #34023 since.\r\n* I don't know if it is the right middle ground, and it seems good to have some conceptual discussion first:\r\n  * Using benchmarks on a reference system inherently captures some platform specifics, making it possible that the metric is not very accurate on other systems.\r\n  * A benchmark-based metric is nontrivial to maintain.",
      "state": "open",
      "user": "sipa",
      "created_at": "2025-12-22T14:57:53Z",
      "updated_at": "2026-01-17T21:56:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34138",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2320,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3022278484,
      "number": 33902,
      "title": "doc: Document compiler configuration for native depends packages",
      "body": "Fixes: #33859\r\n\r\nPreviously one had to read the Makefile (and various *.mk configuration\r\nfiles) to see how to correctly override CC and CXX when building native\r\ndepends packages.\r\n\r\nDetail this in README.md to make it clearer.",
      "state": "open",
      "user": "willcl-ark",
      "created_at": "2025-11-18T15:23:18Z",
      "updated_at": "2026-01-17T21:55:04Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33902",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 293,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3133089501,
      "number": 34162,
      "title": "net: Avoid undershooting in GetAddressesUnsafe",
      "body": "This is demonstrating an alternative approach to #33663. The author didn't seem to like by suggestion so I am putting it here to be considered by reviewers. I personally prefer this approach due to it's simplicity.\r\n\r\n`GetAddressesUnsafe` filters banned and discouraged addresses if those exist. If addresses are filtered the returned list of addresses can be shorter than originally requested because the list isn't backfilled with more valid addresses. These results end up in `GETADDR` responses as well as the `getnodeaddresses` RPC.\r\n\r\nFix this by requesting all available addresses and filter them, then only trim them to the requested `max_addresses` afterwards. Also adds a functional test which checks the new behavior via `getnodeaddresses` RPC.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2025-12-28T17:01:53Z",
      "updated_at": "2026-01-17T21:38:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34162",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 802,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3133196135,
      "number": 34164,
      "title": "validation: add reusable coins view for ConnectBlock",
      "body": "This is the first commit of #31132, which can be merged as an independent change. It has a small benefit on its own, but will help in moving the parent PR forward.\r\n\r\nAdd a `Reset()` method to `CCoinsViewCache` that clears `cacheCoins`, `cachedCoinsUsage`, and `hashBlock` without flushing to the `base` view. This allows efficiently reusing a cache instance across multiple blocks.\r\n\r\nIntroduce `CoinsViewCacheController` to wrap a `CCoinsViewCache` and provide scoped access through a `Handle`. The `Handle` dereferences to the cache and automatically calls `Reset()` on destruction. This RAII pattern ensures the cache is always properly reset between blocks.\r\n\r\nAdd `m_connect_block_controller` as a persistent controller for `ConnectBlock`, avoiding repeated memory allocations.",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2025-12-28T20:05:04Z",
      "updated_at": "2026-01-17T21:35:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34164",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 836,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3133212525,
      "number": 34165,
      "title": "coins: don't mutate main cache when connecting block",
      "body": "This is a slightly modified version of the second commit of #31132, which can be merged as an independent change. It has a small benefit on its own, but will help in moving the parent PR forward.\r\n\r\nWhen accessing coins via the `CCoinsViewCache`, the const methods like `GetCoin` actually mutate `cacheCoins` internally to cache entries when they are pulled from the backing db. This is generally a performance improvement for single threaded access patterns, but it precludes us from accessing entries in a `CCoinsViewCache` from multiple threads without a lock.\r\n\r\nAnother aspect is that when we add an ephemeral `CCoinsViewCache` view backed by the main cache for use in `ConnectBlock()`, we will insert entries into the main cache even if the block is determined to be invalid. This is not the biggest concern, since an invalid block requires proof-of-work. But, an attacker could craft multiple invalid blocks to fill the main cache. This would make us `Flush` the cache more often than necessary. Obviously this would be very expensive to do on mainnet.\r\n\r\nIntroduce `CoinsViewCacheNonMutating`, a `CCoinsViewCache` subclass that reads coins without mutating the underlying cache via `FetchCoin()`.\r\n\r\nAdd `PeekCoin()` to look up a Coin through a stack of `CCoinsViewCache` layers without populating parent caches. This prevents the main cache from caching inputs pulled from disk for a block that has not yet been fully validated. Once `Flush()` is called on the view, these inputs will be added as spent to `coinsCache` in the main cache via `BatchWrite()`.\r\n\r\nThis is the foundation for async input fetching, where worker threads must not mutate shared state.\r\n",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2025-12-28T20:32:34Z",
      "updated_at": "2026-01-17T21:32:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34165",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1723,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3149207404,
      "number": 34208,
      "title": "bench: add fluent API for untimed `setup` steps in nanobench",
      "body": "### Context\r\nAs described in https://github.com/martinus/nanobench/issues/130, we have a few benchmarks where we have to reset the state between runs, otherwise the repetitions will do something else than the first iteration.\r\n\r\n### Upstream\r\nI have opened a PR to `nanobench` to introduce an untimed setup phase, see: https://github.com/martinus/nanobench/pull/136\r\nUnfortunately the author has health issues and couldn't contribute to it in the past 2 years.\r\n\r\n### Tests\r\n\r\nTests were only added upstream, would be a bit awkward to wire in `nanobench.h` outside the benchmarking setup:\r\nhttps://github.com/martinus/nanobench/pull/136/changes/58350cfe5912d7e0533ccfcd759eea5d62eb55bb#diff-88160f647ce57661afe7d755fa70a5fa342a2b79d72d3511596878e69ed5cdc3\r\n\r\n### Fix\r\nI have moved the changes here as well and applied it to a few simple benchmarks as demonstration.\r\nWe can revert ones that are controversial and add other ones in follow-ups, this PR is mostly meant to add the `setup` feature.\r\n\r\n### Benchmarks\r\nMost benchmarks show a modest \"speedup\", others a \"slowdown\" - but it's only the effect of the setup that's not measured anymore - and a `run` phase which does the same operation in each epoch iteration (wallet benchmark changes were reverted since for simplicity):\r\n<img width=\"1496\" height=\"882\" alt=\"image\" src=\"https://github.com/user-attachments/assets/34c14565-f3df-41e5-9a86-95b2ca21703a\" />\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-06T11:45:35Z",
      "updated_at": "2026-01-17T21:06:32Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34208",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1475,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3164120126,
      "number": 34257,
      "title": "txgraph: deterministic optimal transaction order",
      "body": "Part of #30289.\r\n\r\nTxGraph's fundamental responsibility is deciding the order of transactions in the mempool. It relies on the `cluster_linearize.h` code to optimize it, but there can and often will be many different orderings that are essentially equivalent from a quality perspective, so we have to pick one. At a high level, the solution will involve one or more of:\r\n* Deciding based on **internal identifiers** (`Cluster::m_sequence`, `DepGraphIndex`). This is very simple, but risks leaking information about transaction receive order.\r\n* Deciding **randomly**, which is private, but may interfere with relay expectations, block propagation, and ability to monitor network behavior.\r\n* Deciding **based on txid**, which is private and deterministic, but risks incentivizing grinding to get an edge (though we haven't really seen such behavior).\r\n* Deciding **based on size** (e.g. prefer smaller transactions), which is somewhat related to quality, but not unconditionally (depending on mempool layout, the ideal ordering might call for smaller transactions first, last, or anywhere in between). It's also not a strong ordering as there can be many identically-sized transactions. However, if it were to encourage grinding behavior, incentivizing smaller transactions is probably not a bad thing.\r\n\r\nAs of #32545, the current behavior is primarily picking randomly, though inconsistently, as some code paths also use internal identifiers and size. #33335 sought to change it to use random (preferring size in a few places), with the downsides listed above.\r\n\r\nThis PR is an alternative to that, which changes the order to tie-break based on size everywhere possible, and use lowest-txid-first as final fallback. This is fully deterministic: for any given set of mempool transactions, if all linearized optimally, the transaction order exposed by TxGraph is deterministic.\r\n\r\nThe order of transactions within a chunk is tie-broken using:\r\n1. The output of `PostLinearize` (which improves sub-chunk order), using an initial linearization created using the rules 2-4 below.\r\n2. Individual transaction feerate (high to low)\r\n3. Individual transaction weight (small to large)\r\n4. Txid (low to high txid)\r\n\r\nThe order of chunks within a cluster is tie-broken using:\r\n1. Chunk feerate (high to low)\r\n2. Chunk weight (small to large)\r\n3. Max-txid (chunk with lowest maximum-txid first)\r\n\r\nThe order of chunks across clusters is tie-broken using:\r\n1. Feerate (high to low)\r\n2. Equal-feerate-chunk-prefix weight (small to large)\r\n3. Max-txid (chunk with lowest maximum-txid first)\r\n\r\nThe equal-feerate-chunk-prefix weight of a chunk C is defined as the sum of the weights of all chunks in the same cluster as C, with the same feerate as C, up to and including C itself, in linearization order (but excluding such chunks that appear after C). This is a well-defined approximation of sorting chunks from small to large across clusters, while remaining consistent with intra-cluster linearization order.\r\n",
      "state": "open",
      "user": "sipa",
      "created_at": "2026-01-11T23:56:09Z",
      "updated_at": "2026-01-17T20:28:58Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34257",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3047,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3169361001,
      "number": 34271,
      "title": "net_processing: make m_tx_for_private_broadcast optional",
      "body": "Make `PeerManagerImpl::m_tx_for_private_broadcast` optional because it is needed for in private broadcast mode (`-privatebroadcast=1`).\r\n\r\nA followup to #29415, requested in:\r\nhttps://github.com/bitcoin/bitcoin/pull/29415#discussion_r2620864832\r\nhttps://github.com/bitcoin/bitcoin/pull/29415/files#r2620864832",
      "state": "open",
      "user": "vasild",
      "created_at": "2026-01-13T11:32:27Z",
      "updated_at": "2026-01-17T20:17:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34271",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 366,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3184472862,
      "number": 34327,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "rami-mahdi647",
      "created_at": "2026-01-17T19:53:47Z",
      "updated_at": "2026-01-17T19:54:35Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34327",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3176493415,
      "number": 34298,
      "title": "ci: Add and use ci/test/modernize-deprecated-headers.py",
      "body": "Fixes https://github.com/bitcoin/bitcoin/issues/34237\r\n\r\nCurrently, there is a massive iwyu patch to try to implement `modernize-deprecated-headers`.\r\n\r\nHowever, it does not work. For example https://github.com/bitcoin/bitcoin/actions/runs/21012214401/job/60409645985#step:11:35548:\r\n\r\n```diff\r\n\r\n+#include <assert.h>\r\n #include <bench/bench.h>\r\n```\r\n\r\nFix all issues by removing the patch and using a trivial and fast `modernize-deprecated-headers.py` instead.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-15T08:52:45Z",
      "updated_at": "2026-01-17T19:45:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34298",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 517,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3178134777,
      "number": 34310,
      "title": "iwyu: Add missed line to IWYU patch",
      "body": "This PR makes IWYU suggest `<cassert>` over `<assert.h>`.\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/34237.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2026-01-15T17:23:58Z",
      "updated_at": "2026-01-17T19:23:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34310",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 151,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3180151419,
      "number": 34314,
      "title": "wallet: Fix MaxSatisfactionWeight calculation for Taproot descriptors",
      "body": "This PR fixes a bug in the `MaxSatisfactionWeight` calculation for Taproot descriptors. Previously, the implementation contained a FIXME comment and only calculated keypath spend weight, leading to significant underestimations for script path spending.\r\n\r\n### What Changed:\r\n\r\n**1. TaprootDescriptor::MaxSatisfactionWeight** - Replaced the placeholder implementation with proper script path weight calculation:\r\n   - Now iterates through all subdescriptors to find the heaviest script path\r\n   - Uses `MaxSatSize()` instead of `MaxSatisfactionWeight()` for subdescriptors (Taproot SegWit v1 has a 1:1 ratio between witness bytes and weight units, unlike the 4:1 ratio in legacy SegWit v0)\r\n   - Accounts for satisfaction size, script size, and control block size\r\n   - Returns the maximum of keypath (66 weight units) and all script paths\r\n\r\n**2. PKDescriptor::MaxSatSize** - Corrected Schnorr signature size from 65 to 64 bytes (SIGHASH_DEFAULT is omitted in Schnorr signatures)\r\n\r\n**3. MultiADescriptor::MaxSatSize** - Corrected Schnorr signature size from 65 to 64 bytes\r\n\r\n**4. Added comprehensive unit tests** - New test case `descriptor_tr_max_satisfaction_weight` with:\r\n   - Test for `tr(key, pk(key))` verifying script path weight (134) exceeds keypath weight (66)\r\n   - Test for `tr(key, sortedmulti_a(2, K1, K2))` verifying complex script path calculation (235 weight units)\r\n   - Detailed comments explaining the weight calculations for each component\r\n\r\n### Why:\r\n\r\nAccurate weight estimation for Taproot descriptors is critical for:\r\n- **Fee calculation** - Underestimated weights lead to insufficient fees and transaction rejection\r\n- **Transaction size estimation** - Affects PSBT construction and validation\r\n- **Wallet coin selection** - Incorrect weights cause suboptimal UTXO selection\r\n\r\nThe tests demonstrate the bug (old code would return 66 for both cases) and prove the fix produces correct weight estimates.",
      "state": "open",
      "user": "tboy1337",
      "created_at": "2026-01-16T07:17:28Z",
      "updated_at": "2026-01-17T19:17:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34314",
      "labels": [
        "Wallet",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 3,
        "positive_keywords": 0,
        "text_length": 2003,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3182788993,
      "number": 34324,
      "title": "Add utxo_to_csv.py tool",
      "body": "This adds a new conversion tool, heavily based on `utxo_to_sqlite.py`, to produce a CSV file for the UTXO set.\r\n\r\nI created this because I wanted something that produced a greppable UTXO set, and am upstreaming it as it may benefit others.\r\n\r\nUnlike the sqlite version, it also dumps addresses/descriptors for the outputs.",
      "state": "open",
      "user": "sipa",
      "created_at": "2026-01-16T21:37:36Z",
      "updated_at": "2026-01-17T19:02:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34324",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 346,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 991865101,
      "number": 25573,
      "title": "guix: produce a `-static-pie` bitcoind",
      "body": "Use Guix to produce a `-static-pie` bitcoind using GCC 14.3.0 and glibc 2.42. Using glibc for static builds, would be less of a leap compared to switching to musl libc (POC in #23203).\r\n\r\n[`-static-pie`](https://gcc.gnu.org/onlinedocs/gcc/Link-Options.html)\r\n> Produce a static position independent executable on targets that support it.\r\nA static position independent executable is similar to a static executable,\r\nbut can be loaded at any address without a dynamic linker.\r\n\r\n```bash\r\n# file bitcoind\r\n\tELF 64-bit LSB pie executable, x86-64, version 1 (GNU/Linux), static-pie linked, for GNU/Linux 3.2.0, stripped\r\n\r\n# ldd bitcoind\r\n\tstatically linked\r\n```\r\n\r\n`x86_64-linux-gnu` size comparison:\r\nmaster (a7e80676104b5c90c5b5e3bfab815d55a9061052) `bitcoind` is `15.35` megabytes.\r\nThis PR (597b5296d3adc693001ce39626fe32b9545eb604) `bitcoind` is `17.45` megabytes.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2022-07-08T16:49:48Z",
      "updated_at": "2026-01-17T13:44:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/25573",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 905,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1587218477,
      "number": 28792,
      "title": "build: Embedded ASMap [3/3]: Build binary dump header file",
      "body": "Depends on https://github.com/bitcoin/bitcoin/pull/33878. This is the third in a tripled of PRs that implement the necessary changes for embedding of asmap data into the binary. This last part add the initial asmap data, implements the build changes and adds further documentation.\r\n\r\nCurrently an asmap file needs to be acquired by there user from some location or the user needs to generate one themselves. Then they need to move the file to the right place in datadir or pass the path to the file as `-asmap=PATH` in order to use the asmap feature. The change here allows for builds to embed asmap data into the bitcoind binary which makes it possible to use the feature without handling of the asmap file by the user. If the user starts bitcoind with `-asmap` the embedded data will be used for bucketing of nodes.\r\n\r\nThe data lives in the repository at `src/node/data/ip_asn.dat` and can be replaced with a new version at any time. The idea is that the data should be updated with every release. By default the data at that location is embedded into the binary but there is also a build option to prevent this (`-DWITH_EMBEDDED_ASMAP=OFF`). In this case the original behavior of the `-asmap` option is maintained.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2023-11-04T22:13:31Z",
      "updated_at": "2026-01-17T11:49:16Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28792",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1277,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2208562627,
      "number": 31397,
      "title": "p2p: track and use all potential peers for orphan resolution",
      "body": "Part of #27463.\r\n\r\n(Transaction) **orphan resolution** is a process that kicks off when we are missing UTXOs to validate an unconfirmed transaction. We currently request missing parents by txid; BIP 331 also defines a way to [explicitly request ancestors](https://github.com/bitcoin/bips/blob/master/bip-0331.mediawiki#handle-orphans-better).\r\n\r\nCurrently, when we find that a transaction is an orphan, we only try to resolve it with the peer who provided the `tx`. If this doesn't work out (e.g. they send a `notfound` or don't respond), we do not try again. We actually can't, because we've already forgotten who else could resolve this orphan (i.e. all the other peers who announced the transaction).\r\n\r\nWhat is wrong with this? It makes transaction download less reliable, particularly for 1p1c packages which must go through orphan resolution in order to be downloaded.\r\n\r\nCan we fix this with BIP 331 / is this \"duct tape\" before the real solution?\r\nBIP 331 (receiver-initiated ancestor package relay) is also based on the idea that there is an orphan that needs resolution, but it's just a new way of communicating information. It's not inherently more honest; you can request ancestor package information and get a `notfound`. So ancestor package relay still requires some kind of procedure for retrying when an orphan resolution attempt fails. See the #27742 implementation which builds on this orphan resolution tracker to keep track of what packages to download (it just isn't rebased on this exact branch). The difference when using BIP 331 is that we request `ancpkginfo` and then `pkgtxns` instead of the parent txids.\r\n\r\nZooming out, we'd like orphan handling to be:\r\n- Bandwidth-efficient: don't have too many requests out at once. As already implemented today, transaction requests for orphan parents and regular download both go through the `TxRequestTracker` so that we don't have duplicate requests out.\r\n- Not vulnerable to censorship: don't give up too easily, use all candidate peers. See e.g. https://bitcoincore.org/en/2024/07/03/disclose_already_asked_for/\r\n- Load-balance between peers: don't overload peers; use all peers available. This is also useful for when we introduce per-peer orphan protection, since each peer will have limited slots.\r\n\r\nThe approach taken in this PR is to think of each peer who announces an orphan as a potential \"orphan resolution candidate.\" These candidates include:\r\n- the peer who sent us the orphan tx\r\n- any peers who announced the orphan prior to us downloading it\r\n- any peers who subsequently announce the orphan after we have started trying to resolve it\r\nFor each orphan resolution candidate, we treat them as having \"announced\" all of the missing parents to us at the time of receipt of this orphan transaction (or at the time they announced the tx if they do so after we've already started tracking it as an orphan). We add the missing parents as entries to `m_txrequest`, incorporating the logic of typical txrequest processing, which means we prefer outbounds, try not to have duplicate requests in flight, don't overload peers, etc.",
      "state": "closed",
      "user": "glozow",
      "created_at": "2024-11-30T21:06:45Z",
      "updated_at": "2026-01-17T10:55:39Z",
      "merged_at": "2025-01-16T13:42:39Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31397",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 1,
        "text_length": 3166,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2259629686,
      "number": 31601,
      "title": "refactor: modernize recent `ByteType` usages and read/write functions",
      "body": "Follow-up to https://github.com/bitcoin/bitcoin/pull/31524, applying a few of the review suggestions to the affected code, while enabling more trivial reads/writes to use the new `std::byte` interface.",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2025-01-03T18:24:46Z",
      "updated_at": "2026-01-17T10:55:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31601",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 271,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2245377079,
      "number": 31543,
      "title": "cmake: Always provide `RPATH` on NetBSD",
      "body": "Apparently, runtime paths cannot be skipped on NetBSD, even for system-wide packages.\r\n\r\nOn NetBSD 10.0:\r\n- on the master branch @ bb57017b2945d5e0bbd95c7f1a9369a8ab7c6fcd:\r\n```\r\n$ cmake -B build -DCMAKE_C_COMPILER=\"/usr/pkg/gcc14/bin/gcc\" -DCMAKE_CXX_COMPILER=\"/usr/pkg/gcc14/bin/g++\"\r\n$ cmake --build build\r\n$ ./build/src/bitcoin-wallet -version\r\n./build/src/bitcoin-wallet: Shared object \"libsqlite3.so.0\" not found\r\n$ cmake --install build --prefix /home/hebasto/INSTALL\r\n$ /home/hebasto/INSTALL/bin/bitcoin-wallet -version \r\n/home/hebasto/INSTALL/bin/bitcoin-wallet: Shared object \"libsqlite3.so.0\" not found\r\n```\r\n- with this PR:\r\n```\r\n$ cmake -B build -DCMAKE_C_COMPILER=\"/usr/pkg/gcc14/bin/gcc\" -DCMAKE_CXX_COMPILER=\"/usr/pkg/gcc14/bin/g++\"\r\n$ cmake --build build\r\n$ ./build/src/bitcoin-wallet -version | head -1\r\nBitcoin Core bitcoin-wallet utility version v28.99.0-11115e9aa845\r\n$ cmake --install build --prefix /home/hebasto/INSTALL\r\n$ /home/hebasto/INSTALL/bin/bitcoin-wallet -version | head -1\r\nBitcoin Core bitcoin-wallet utility version v28.99.0-11115e9aa845\r\n```",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2024-12-19T19:37:24Z",
      "updated_at": "2026-01-17T10:55:38Z",
      "merged_at": "2025-01-17T14:11:38Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31543",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1118,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2268263664,
      "number": 31626,
      "title": "depends: Use base system's `sha256sum` utility on FreeBSD",
      "body": "On FreeBSD, the `shasum` utility is provided by the [`perl5`](https://ports.freebsd.org/cgi/ports.cgi?query=%5Eperl5&stype=all&sektion=all) port, which is not part of the base system and must be [installed](https://github.com/hebasto/bitcoin-core-nightly/blob/0e3518579a02e6c79bafc67817136220579a0d5c/.github/workflows/freebsd.yml#L104) separately. Note that this requirement is currently not documented in [`depends/README.md`](https://github.com/bitcoin/bitcoin/blob/master/depends/README.md).\r\n\r\nThis PR switches to using the [`sha256sum`](https://man.freebsd.org/cgi/man.cgi?query=sha256sum&apropos=0&sektion=0&manpath=FreeBSD+14.2-RELEASE+and+Ports&arch=default&format=html) utility, which is included in the base system.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-01-09T12:22:40Z",
      "updated_at": "2026-01-17T10:55:37Z",
      "merged_at": "2025-01-17T14:02:09Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31626",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 784,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2267358513,
      "number": 31621,
      "title": "doc: Update dependency installation for Debian/Ubuntu",
      "body": "This is similar to the recently-pushed 8d20348 and results in slightly cleaner systems for future Debian/Ubuntu builds. \r\n\r\nAccording to the description for pkg-config, \"pkgconf is a replacement for pkg-config, providing additional functionality while also maintaining compatibility. This package only provides a dependency link to the pkgconf package to help with package upgrades. It can be safely removed.\"\r\n\r\nThus the relevant sections of `doc/build-unix.md` and `depends/README.md` are updated.",
      "state": "closed",
      "user": "adlai",
      "created_at": "2025-01-09T02:05:34Z",
      "updated_at": "2026-01-17T10:55:37Z",
      "merged_at": "2025-01-17T11:03:22Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31621",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 553,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2275403328,
      "number": 31651,
      "title": "ci: Turn CentOS task into native one",
      "body": "Cross-compiling to `i686-pc-linux-gnu` on CentOS in the CI is mostly redundant with the `ci/test/00_setup_env_i686_multiprocess.sh` task (albeit it using clang):\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/35bf426e02210c1bbb04926f4ca2e0285fbfcd11/ci/test/00_setup_env_i686_multiprocess.sh#L9-L12\r\n\r\nOne task seems sufficient as a sanity check, given that there seems to be no real demand for this architecture anyway.\r\n\r\nTurning the task into a native one makes it possible to run the task natively on aarch64 or any other supported architecture.\r\n\r\nAlso, remove the install of the `lbzip2` package, which is unused since commit a46065e36cf868265c909dc5edf29dc17be53c1f\r\n\r\nAlso, remove the `CONFIG_SHELL` env var, which is unused since the cmake migration. (`CONFIG_SHELL` in depends is still kept).",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-01-13T22:55:45Z",
      "updated_at": "2026-01-17T10:55:36Z",
      "merged_at": "2025-01-17T11:42:54Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31651",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 835,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2277569883,
      "number": 31655,
      "title": "refactor: Avoid UB in SHA3_256::Write",
      "body": "It is UB to apply a distance to a pointer or iterator further than the\r\nend itself, even if the distance is (partially) revoked later on.\r\n\r\nFix the issue by advancing the data pointer at most to the end.\r\n\r\nThis fix is required to adopt C++ safe buffers https://github.com/bitcoin/bitcoin/issues/31272.\r\n\r\nAlso included is a somewhat unrelated commit.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-01-14T18:46:07Z",
      "updated_at": "2026-01-17T10:55:35Z",
      "merged_at": "2025-01-16T12:20:13Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31655",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 390,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1780312050,
      "number": 29678,
      "title": "Bugfix: Correct first-run free space checks",
      "body": "It's not clear what `m_assumed_*_size` are actually set based on, but historically it was in GB, not GiB, and that's still used in the GUI which is more user-facing.\r\n\r\nCould just as easily change the GUI if GiB is preferred.",
      "state": "open",
      "user": "luke-jr",
      "created_at": "2024-03-19T16:36:10Z",
      "updated_at": "2026-01-17T10:28:59Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29678",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 269,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3174053537,
      "number": 34286,
      "title": "test: verify node state after restart in assumeutxo",
      "body": "## Summary\n\nThis PR replaces the TODO comment in `wallet_assumeutxo.py` (line 242) with actual test assertions that verify node and wallet behavior after a restart during assumeutxo background sync.\n\n## Changes\n\nThe new tests verify:\n- Two chainstates exist (background validation not complete)\n- Background chainstate is still at `START_HEIGHT`\n- Snapshot chainstate has synced to at least `PAUSE_HEIGHT`\n- Wallets cannot be loaded after restart (expected behavior)\n- Wallet backup from before snapshot height cannot be restored\n\n## Motivation\n\nDuring implementation, I discovered that **wallets cannot be loaded after a node restart during assumeutxo background sync**. This is expected behavior because:\n- The wallet loading code checks if required blocks are available for rescanning\n- During assumeutxo background sync, blocks before the snapshot are not available\n- This applies to all wallets, including watch-only wallets created at the snapshot height\n\nThis is a valuable test addition because it documents this expected behavior and ensures it doesn't regress. Users should be aware that if they restart their node during assumeutxo background sync, they won't be able to load their wallets until the background sync completes.\n\n## Related\n\nrefs #28648\n\nAddresses the TODO comment that was originally added as part of the assumeutxo wallet test implementation.",
      "state": "open",
      "user": "yashbhutwala",
      "created_at": "2026-01-14T15:55:59Z",
      "updated_at": "2026-01-17T10:25:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34286",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1422,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3183402461,
      "number": 34325,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "maximtea64",
      "created_at": "2026-01-17T06:06:31Z",
      "updated_at": "2026-01-17T06:07:02Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34325",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2426922942,
      "number": 32162,
      "title": "depends: Switch from multilib to platform-specific toolchains",
      "body": "Using the multilib GCC toolchain, as currently documented in [`depends/README.md`](https://github.com/bitcoin/bitcoin/blob/4c1906a500cacab385b09e780b54271b0addaf4b/depends/README.md), has several issues, such as:\r\n\r\n1. The [`g++-multilib`](https://packages.ubuntu.com/noble/g++-multilib) package conflicts with platform-specific cross-compiler packages. This means it is not possible to cross compile for `i686` and other platforms using the same set of installed packages.\r\n\r\n2. The [`g++-multilib`](https://packages.ubuntu.com/noble/g++-multilib) package is not available for `arm64`:\r\n```sh\r\n$ sudo apt install g++-multilib\r\nReading package lists... Done\r\nBuilding dependency tree... Done\r\nReading state information... Done\r\nE: Unable to locate package g++-multilib\r\n```\r\n\r\n3. Managing the multilib GCC toolchain requires additional code in both depends and Guix scripts.\r\n\r\nThis PR addresses all the issues mentioned above by switching from multilib to platform-specific toolchains.\r\n\r\nAlso see https://github.com/bitcoin/bitcoin/pull/22456.\r\n\r\n---\r\n\r\nHere are examples of building for different scenarions:\r\n\r\n- Linux, `x86_64` or `arm64`, building with depends natively:\r\n```sh\r\n$ gmake -C depends -j $(nproc)\r\n$ cmake -B build --toolchain depends/$(./depends/config.sub $(./depends/config.guess))/toolchain.cmake\r\n$ cmake --build build -j $(nproc)\r\n```\r\n\r\n- Linux, `x86_64` or `arm64`, cross compiling for `i686-pc-linux-gnu`:\r\n```sh\r\n$ sudo apt install g++-i686-linux-gnu binutils-i686-linux-gnu\r\n$ export HOST=i686-linux-gnu\r\n$ gmake -C depends -j $(nproc)\r\n$ cmake -B build-${HOST} --toolchain depends/${HOST}/toolchain.cmake\r\n$ cmake --build build-${HOST} -j $(nproc)\r\n```\r\n\r\n- Linux, `x86_64`, cross compiling for `arm64`:\r\n```sh\r\n$ sudo apt install g++-aarch64-linux-gnu binutils-aarch64-linux-gnu\r\n$ export HOST=aarch64-linux-gnu\r\n$ gmake -C depends -j $(nproc)\r\n$ cmake -B build-${HOST} --toolchain depends/${HOST}/toolchain.cmake\r\n$ cmake --build build-${HOST} -j $(nproc)\r\n```\r\n\r\n- Linux, `arm64`, cross compiling for `x86_64`:\r\n```sh\r\n$ sudo apt install g++-x86-64-linux-gnu binutils-x86-64-linux-gnu\r\n$ export HOST=x86_64-linux-gnu\r\n$ gmake -C depends -j $(nproc)\r\n$ cmake -B build-${HOST} --toolchain depends/${HOST}/toolchain.cmake\r\n$ cmake --build build-${HOST} -j $(nproc)\r\n```\r\n",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-03-29T13:34:59Z",
      "updated_at": "2026-01-17T03:35:16Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32162",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2364,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2511642895,
      "number": 32468,
      "title": "rpc: generateblock to allow multiple outputs",
      "body": "## Generatetomany\r\n\r\nFirst approach was to create a `generatetomany` rpc call. That approach can be seen here https://github.com/polespinasa/bitcoin/pull/3\r\n\r\n## Generateblock\r\nModifies `generateblock` to allow a user to set multiple outputs in the coinbase transaction. If an empty set is provided, the block will be empty. If no set of transactions is provided, the block will mine the mempool. If a set of transactions is provided only that set of txs will be mined.\r\n\r\n```\r\n$./bitcoin-cli -rpcport=18443 generateblock bcrt1qw6qkj8wtw5hraxwxjp08m4aymkntms3yhqyacj\r\n{\r\n  \"hash\": \"7359a3ed7af0f18f4016e6cb29193bd787a2452c584781135c585d5204b9ec5b\"\r\n}\r\n\r\n$ ./bitcoin-cli -rpcport=18443 generateblock '[\"bcrt1qal6p633hvwz2yp5mav0qy7u2az8gkn2xywnj6v\", \"bcrt1qvr3qgyhw6y0e0zj97v0j5yc40xtpea4wqj0g43\"]'\r\n{\r\n  \"hash\": \"6db028454b26d6667dd6df45be2772844121fb44f86433f6bbfbafa429974684\"\r\n}\r\n\r\n$ ./bitcoin-cli -rpcport=18443 generateblock '[\"bcrt1qal6p633hvwz2yp5mav0qy7u2az8gkn2xywnj6v\", \"bcrt1qvr3qgyhw6y0e0zj97v0j5yc40xtpea4wqj0g43\"]' []\r\n\r\n{\r\n  \"hash\": \"33e2ddc52546ddb0edf28bef5b295ee8fbd487b8aca19c97018467e2477877df\"\r\n}\r\n\r\n```\r\n\r\n### Motivation\r\nhttps://x.com/SuperTestnet/status/1921220086645342550\r\n\r\nCitating @supertestnet \r\n> When mining a block on regtest, the command \"generatetoaddress\" is available if you want to send the entire coinbase to 1 address. Let's add generatetomany in case you want to split up the coinbase among multiple addresses, similar to how the \"sendtoaddress\" and \"sendmany\" commands both exist and let you send money to (1) one address or (2) multiple addresses. The generatetomany command would be particularly useful for simulating protocols that send money to multiple recipients directly from a coinbase, as several pools do now, like ocean and braidpool.\r\n\r\n### Notes\r\n- ~Needs release note~\r\n- ~Changes on `generateblock` are not backwards compatible as now it takes an array of outputs instead a single output. This should not be critical as it is a test RPC.~ ",
      "state": "open",
      "user": "polespinasa",
      "created_at": "2025-05-10T17:34:29Z",
      "updated_at": "2026-01-17T01:18:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32468",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2041,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3182778687,
      "number": 34323,
      "title": "test: Add comprehensive tests for GetNewChangeDestination",
      "body": "Add comprehensive tests for GetNewChangeDestination\r\n\r\nMotivation\r\n\r\nThis PR adds test coverage for `CWallet::GetNewChangeDestination()`, which currently lacks dedicated unit tests despite being called during every transaction creation.\r\n\r\n**Test improvements:**\r\n- Adds comprehensive coverage for a previously untested function\r\n- Tests all 4 Bitcoin address output types (BECH32, LEGACY, P2SH_SEGWIT, BECH32M)\r\n- Verifies privacy-critical behavior for (address uniqueness, keypool separation)",
      "state": "closed",
      "user": "b-l-u-e",
      "created_at": "2026-01-16T21:34:12Z",
      "updated_at": "2026-01-16T23:00:25Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34323",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 2,
        "text_length": 552,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2598874149,
      "number": 32764,
      "title": "guix: Build for macOS using Clang only",
      "body": "This PR makes macOS builds Clang-only by switching the build compiler in depends to `clang` + `libc++`.\r\n\r\nSee: https://github.com/bitcoin/bitcoin/issues/30206.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-06-17T13:39:41Z",
      "updated_at": "2026-01-16T22:07:10Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32764",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 199,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3176419903,
      "number": 34297,
      "title": "p2p: add validation checks for initial self-announcement",
      "body": "This is a follow up to #34146 . Adds validation check to the initial self-announcement code path. `IsAddrCompatible()` check can prevent sending non-routable addresses to peers that don't support addrv2.",
      "state": "open",
      "user": "frankomosh",
      "created_at": "2026-01-15T08:26:00Z",
      "updated_at": "2026-01-16T21:15:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34297",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 260,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3156512426,
      "number": 34233,
      "title": "test: fix Windows CI failures in wallet_multiwallet and old binary tests (ancient wallets)",
      "body": "Currently, the `wallet_multiwallet.py` and `feature_unsupported_utxo_db.py` functional tests are disabled on CI because they rely on legacy wallet binaries that do not correctly handle Unicode paths. \r\n\r\nThis is tracked as a `TODO` in `.github/workflows/ci.yml`. The limitation also blocks efforts to expand ancient wallet test coverage (e.g. bitcoin/bitcoin#33186).\r\n\r\nThis PR restores functional test coverage on Windows CI by addressing two root causes:\r\n\r\n1. **Skip Windows-incompatible tests in `wallet_multiwallet`**: Several test cases depend on Unix-specific filesystem behavior that is not supported on Windows:\r\n     - Directory permission tests using chmod (Windows ignores `os.chmod(path, 0)`)\r\n     - Recursive directory symlink tests (unsupported by listwalletdir)\r\n     - File symlink detection tests (Windows handles file symlinks differently)\r\n\r\n  2. **Use ASCII-only tmpdir for old binary tests**: When running tests against previous releases (`feature_unsupported_utxo_db`, `wallet_multiwallet`) on Windows, an ASCII-only temporary directory name (`test_runner_btc_run_`) is used instead of `test_runner_â‚¿_ðŸƒ_`. This avoids failures caused by older binaries lacking proper Unicode path support.",
      "state": "closed",
      "user": "w0xlt",
      "created_at": "2026-01-08T15:17:11Z",
      "updated_at": "2026-01-16T19:35:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34233",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1303,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3134270217,
      "number": 34170,
      "title": "fuzz: Extend `scriptpubkeyman` coverage",
      "body": "Add fuzzing coverage for several missing `DescriptorScriptPubKeyMan` methods.",
      "state": "open",
      "user": "Chand-ra",
      "created_at": "2025-12-29T12:04:50Z",
      "updated_at": "2026-01-16T18:20:41Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34170",
      "labels": [
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 117,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2410059028,
      "number": 32116,
      "title": "contrib: refactor: dedup deserialization routines in utxo-to-sqlite script",
      "body": "The compact-size/varint/amount deserialization routines already exist in the functional test framework (with the advantage of having proper unit tests executed in CI), so we can just import them from there instead of leaving duplicated code in the repository.",
      "state": "closed",
      "user": "theStack",
      "created_at": "2025-03-21T17:10:17Z",
      "updated_at": "2026-01-16T17:15:37Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32116",
      "labels": [
        "Scripts and tools"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 334,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3170621319,
      "number": 34276,
      "title": "Remove empty caption from user interface (noui, gui)",
      "body": "Currently, the user interface (noui, gui) has a caption for each message. However, the caption has many issues:\r\n\r\n* It is always hard-coded to the empty string.\r\n* This is confusing and tedious when reading or maintaining the code.\r\n* It is redundant, because `noui` will ignore the caption and set the logging prefix (error, warning, info) based on the `style`.\r\n* The gui does prefer to set the title based on the caption, but since it the caption is always empty, the fallback will always be used.\r\n\r\nFix all issues by removing it.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-13T17:34:40Z",
      "updated_at": "2026-01-16T17:04:32Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34276",
      "labels": [
        "Utils/log/libs",
        "interfaces"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 588,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3154286083,
      "number": 34225,
      "title": "refactor, key: move `CreateMuSig2{Nonce,PartialSig}` functions to `musig.{h,cpp}` module",
      "body": "This PR is a follow-up of #29675, see https://github.com/bitcoin/bitcoin/pull/29675#discussion_r2265077463. It moves all MuSig2 functions that currently live in `CKey` and call secp256k1 musig module API functions (i.e. `secp256k1_musig_...`) to the `musig.{h,cpp}` module, as this seems to be a better place. One small drawback of doing this is that the `secp256k1_context_signing` object needs to be accessed from the outside; this is currently solved by changing the linkage from `static` to `extern` to expose the symbol globally [1]. Happy to add an access function if that is preferred instead. \r\n\r\nAs the patch is mostly move-only, it can be best reviewed via the git option `--color-moved=dimmed-zebra`\r\n\r\n[1] note that the same approach is used in the Silent Payments sending PR #28201, though having a TODO comment added, see https://github.com/bitcoin/bitcoin/pull/28201/commits/a4ebd7da5aaaa567fa9c613666513341f2aea241#diff-e5cbd40011e760f175b82d7ec44ad512bdb3d9108068b660642204da9c9187b1R25",
      "state": "open",
      "user": "theStack",
      "created_at": "2026-01-07T23:45:38Z",
      "updated_at": "2026-01-16T17:02:56Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34225",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1092,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3177864654,
      "number": 34309,
      "title": "guix: stop passing depends sources to codesigning",
      "body": "I think this is just a copy-pasta from the build container (which has existed since this file was introduced in 38eb91eb0616ed6dbe34c23e11588d130fef07f8). I don't see why we'd need the depends sources available when performing codesigning.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-15T15:58:51Z",
      "updated_at": "2026-01-16T16:03:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34309",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 289,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3149157644,
      "number": 34207,
      "title": "coins/refactor: enforce `GetCoin()` returns only unspent coins",
      "body": "### Summary \r\n`::GetCoin()` is an interface for querying the UTXO set, so production implementations should only ever return unspent coins. Tests should mimic this to provide useful feedback.\r\n\r\n### Context\r\nThis PR is split out from #33018 to keep that PR focused on removing the `FRESH-but-not-DIRTY` cache state.\r\n\r\n### Changes:\r\n* Add a fail-fast assertion that `CCoinsViewDB::GetCoin()` never returns a spent coin.\r\n* Align unit tests and fuzz simulations with the production `GetCoin()` contract by never returning spent coins.\r\n* Replace the unreachable â€œspent coin returned by parentâ€ handling in `CCoinsViewCache::FetchCoin()` with `Assert(!coin.IsSpent())`, drop outdated `spent+FRESH` docs, and tighten `SanityCheck()` invariants.\r\n\r\nBehavior is unchanged, it just aligns our tests to exercise valid states.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-06T11:24:58Z",
      "updated_at": "2026-01-16T15:02:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34207",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 881,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3095820892,
      "number": 34054,
      "title": "net processing: Add ibd check before processing block for txdownloadman",
      "body": "Calculating the rolling bloom filters for the txorphanage takes some CPU time from the scheduler thread. This can be observed for example in [this flamegraph](https://bitcoin-dev-tools.github.io/benchcoin/results/pr-172/20066462508/mainnet-default-instrumented-base-flamegraph.svg?x=920203898521&y=780), where handling the filter takes about 2.6% of total time (and most of the scheduler thread's time). \r\n\r\nDuring ibd the entries in the tx download bloom filter are just continuously rolled over and aren't consumed, since no mempool entries are created by incoming transactions from peers during ibd. The mempool does accept transactions via RPC, or the wallet at the time, however these don't interact with the orphanage and the txdownloadman, because adding anything to those is guarded by IsInitialBlockDownload() checks as well.\r\n\r\nWe're usually latching ibd to false a few blocks before catching up to the tip, so this should also not significantly degrade the performance of the filter once fully caught up.",
      "state": "open",
      "user": "sedited",
      "created_at": "2025-12-12T09:06:28Z",
      "updated_at": "2026-01-16T15:00:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34054",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1087,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2640910930,
      "number": 32875,
      "title": "index: handle case where pindex_prev equals chain tip in NextSyncBlock()",
      "body": "When pindex_prev is the chain tip, return early rather than mixing it\r\nwith the reorg case.\r\n",
      "state": "open",
      "user": "HowHsu",
      "created_at": "2025-07-04T10:03:17Z",
      "updated_at": "2026-01-16T14:10:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32875",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 166,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3163940035,
      "number": 34256,
      "title": "test: support `get_bind_addrs` and `feature_bind_extra` on macOS",
      "body": "### Problem\r\n\r\nSome functional tests are shown as skipped when running on macOS because `test_framework/netutil.py` only implemented the Linux-specific logic for checking which TCP sockets a node is listening on.\r\n\r\n### Fix\r\n\r\nAdd macOS implementations in `test/functional/test_framework/netutil.py` so tests can query:\r\n\r\n* which TCP sockets a node is listening on (`get_bind_addrs()`, via `lsof`)\r\n* a non-loopback interface address (`all_interfaces()`, via `ifconfig`)\r\n\r\nThen enable the previously Linux-only tests by switching to a shared platform guard.\r\n\r\n### Commands\r\n<details>\r\n<summary><code>get_bind_addrs()</code> (<code>lsof</code> + regex)</summary>\r\n\r\n> Command used\r\n```bash\r\nlsof -nP -a -p <pid> -iTCP -sTCP:LISTEN -Ftn\r\n```\r\n\r\n> Flags\r\n\r\n- -n: no hostname resolution\r\n- -P: no service/port-name resolution\r\n- -a: AND all conditions\r\n- -p <pid>: filter by process ID\r\n- -iTCP: TCP sockets only\r\n- -sTCP:LISTEN: listening sockets only\r\n- -Ftn: machine-readable output (fields: type t, name n)\r\n\r\n> Regex parser\r\n\r\n```regex\r\nt(IPv[46])\\nn(\\*|\\[.+?]|[^:]+):(\\d+)\r\n```\r\n> Captured groups\r\n\r\n- group 1: IPv4 / IPv6 (used to disambiguate *)\r\n- group 2: host (*, [::1], 127.0.0.1, â€¦)\r\n- group 3: port\r\n</details>\r\n\r\n<details>\r\n<summary><code>all_interfaces()</code> (<code>ifconfig</code> + regex)</summary>\r\n\r\n> Command used\r\n\r\n```bash\r\nifconfig -au\r\n```\r\n\r\n> Regex parsing\r\n\r\nInterface blocks:\r\n```regex\r\n(?m)^(?P<iface>\\S+):(?P<block>[^\\n]*(?:\\n[ \\t]+[^\\n]*)*)\r\n```\r\n\r\nIPv4 extraction within each block:\r\n```regex\r\ninet (\\S+)\r\n```\r\n</details>\r\n\r\n### Notes\r\n\r\nThe only remaining platform skips on macOS are the USDT/BPF tracing tests (interface_usdt_*.py).\r\n\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-11T21:42:11Z",
      "updated_at": "2026-01-16T12:24:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34256",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1738,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3174426479,
      "number": 34288,
      "title": "fuzz: Exclude too expensive inputs in miniscript_string target",
      "body": "Fixes https://github.com/bitcoin/bitcoin/issues/30498\r\n\r\nAccepting \"expensive\" fuzz inputs which have no real use-case is problematic, because it prevents the fuzz engine from spending time on the next useful fuzz input.\r\n\r\nFor example this one will take several seconds (the flamegraph shows the time is spent in minscipt `NoDupCheck`):\r\n\r\n```\r\ncurl -fLO 'https://raw.githubusercontent.com/bitcoin-core/qa-assets/eac1c57614d7823bcd6079814749f72018aea438/fuzz_corpora/miniscript_string/41bae50cffd1741150a1b330d02ab09f46ff8cd1'\r\nFUZZ=miniscript_string /usr/bin/time   ./bld-cmake/bin/fuzz  ./41bae50cffd1741150a1b330d02ab09f46ff8cd1\r\n```\r\n\r\nInspecting the inputs shows that it has many sub frags, so rejecting based on `HasTooManySubFrag` should be sufficient.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-14T17:49:39Z",
      "updated_at": "2026-01-16T12:01:58Z",
      "merged_at": "2026-01-15T13:55:33Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34288",
      "labels": [
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 823,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2902093523,
      "number": 33593,
      "title": "guix: Use UCRT runtime for Windows release binaries",
      "body": "This PR:\r\n1. Switches Windows release binaries to UCRT.\r\n2. Update docs.\r\n3. Drops MSVCRT workarounds.\r\n\r\nCloses https://github.com/bitcoin/bitcoin/issues/30210.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-10-09T21:46:43Z",
      "updated_at": "2026-01-16T11:55:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33593",
      "labels": [
        "Windows",
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 213,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3161187473,
      "number": 34245,
      "title": "verify-commits: temporarily allow sha1 signatures for merge commits",
      "body": "This is to unbreak CI after a merge commit (aeaa67a9eac0decb89c60a67f9755ca10cbcc1d9) with a signature indirectly involving SHA1 was pushed to master.",
      "state": "closed",
      "user": "darosior",
      "created_at": "2026-01-09T23:37:35Z",
      "updated_at": "2026-01-16T11:51:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34245",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 218,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 705964116,
      "number": 22663,
      "title": "dbwrapper: properly destroy objects in case CDBWrapper ctor throws",
      "body": "There are two main changes: introduce LevelDbOptions to manage the leveldb::Options struct and changing CDBWrapper's penv member to a unique_ptr. The first allows LevelDbOptions to destroy leveldb::Options members without CDBWrapper having to directly. The second change allows the leveldb::Env to be managed by penv. Both of these changes prevent a LeakSanitizer exception if the CDBWrapper ctor throws.\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/22592\r\n",
      "state": "closed",
      "user": "Crypt-iQ",
      "created_at": "2021-08-08T00:42:24Z",
      "updated_at": "2026-01-16T11:42:42Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/22663",
      "labels": [
        "UTXO Db and Indexes",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 530,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2081209565,
      "number": 30928,
      "title": "tinyformat: refactor: increase compile-time checks and don't throw for tfm::format_error",
      "body": "Avoid unexpected run-time crashes from string formatting by enforcing compile-time format string checks for most* `tfm::format` and `strprintf` usage, and by returning an error string instead of throwing for a run-time tfm::format_error so callsites don't need to implement this error handling.\r\n\r\nThis PR should introduce no behaviour change.\r\nThe main changes are:\r\n- remove the `const std::string&` `tfm::format` overload since it's not necessary. Usage of this overload is removed by one of:\r\n  - replacing string concatenation in the format string with just an extra parameter\r\n  - using the `bilingual_str` overload\r\n  - using the `tfm::format_raw` functions (only for tinyformat implementation or tests)\r\n- rename the non-compile-time-validated `tfm::format` overloads to `tfm::format_raw`, so existing callsites by default use the safer `util::ConstevalFormatString` `tfm::format` overloads. Callsites that for some reason don't pass the compile-time checks (such as in `bitcoin-cli.cpp`) can use `tfm::format_raw`.\r\n- make `tfm::format_error` internal to `tinyformat` and just return error strings instead, so callsites don't need to implement error handling to prevent crashing. \r\n\r\n*The `bilingual_str format(const bilingual_str& fmt, const Args&... args)` is not yet compile-time checked, which means the `lint-format-strings.py` test can't be removed yet.\r\n\r\n Follow-up on https://github.com/bitcoin/bitcoin/pull/30889#discussion_r1766633746, an alternative to #15926.",
      "state": "closed",
      "user": "stickies-v",
      "created_at": "2024-09-19T14:45:20Z",
      "updated_at": "2026-01-16T10:55:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30928",
      "labels": [
        "Utils/log/libs",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1570,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2115066966,
      "number": 31061,
      "title": "refactor: Check translatable format strings at compile-time",
      "body": "All translatable format strings are fixed. This change surfaces errors in them at compile-time.\r\n\r\nThe implementation achieves this by allowing to delay the translation (or `std::string` construction) that previously happened in `_()` by returning a new type from this function. The new type can be converted to `bilingual_str` where needed.\r\n\r\nThis can be tested by adding a format string error in an original string literal and observing a new compile-time failure.\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/30530",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2024-10-09T11:35:14Z",
      "updated_at": "2026-01-16T10:55:06Z",
      "merged_at": "2025-01-15T15:47:19Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31061",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 584,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2167882014,
      "number": 31242,
      "title": "wallet, desc spkm: Return SigningProvider only if we have the privkey",
      "body": "If we know about a pubkey that's in our descriptor, but we don't have the private key, don't return a SigningProvider for that pubkey.\r\n\r\nThis is specifically an issue for Taproot outputs that use the H point as the resulting PSBTs may end up containing irrelevant information because the H point was detected as a pubkey each unrelated descriptor knew about.\r\n\r\nSplit from #29675",
      "state": "closed",
      "user": "achow101",
      "created_at": "2024-11-07T16:52:10Z",
      "updated_at": "2026-01-16T10:55:05Z",
      "merged_at": "2025-01-16T17:31:18Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31242",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 450,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2273355015,
      "number": 31646,
      "title": "test: avoid internet traffic",
      "body": "Avoid generating outbound traffic on a non-loopback interface during tests. Fix all tests, including ones that generate DNS traffic.\r\n\r\n---\r\n\r\nThis is a subset of https://github.com/bitcoin/bitcoin/pull/31349 containing only the changes to the tests, without the CI changes to detect future regressions.",
      "state": "closed",
      "user": "vasild",
      "created_at": "2025-01-13T09:24:28Z",
      "updated_at": "2026-01-16T10:55:04Z",
      "merged_at": "2025-01-14T21:02:01Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31646",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 332,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2282170133,
      "number": 31673,
      "title": "doc: fix minor typos in comments",
      "body": "In the unrelated PR #31621 the linter reported a few typos, that are fixed in this commit. I used the \"doc\" prefix as it only modifies comments, so none of the more significant prefixes seem appropriate.",
      "state": "closed",
      "user": "adlai",
      "created_at": "2025-01-16T15:39:20Z",
      "updated_at": "2026-01-16T10:55:03Z",
      "merged_at": "2025-01-16T16:21:20Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31673",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 236,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3173535621,
      "number": 34282,
      "title": "qa: Fix Windows logging bug",
      "body": "The regex `(.*)` was capturing `\\r` from subprocess output on Windows, causing the closing parenthesis in logs to wrap to the next line.\r\n\r\nFor [example](https://github.com/hebasto/bitcoin/actions/runs/20993438084/job/60350204808):\r\n```\r\n208/454 - feature_bip68_sequence.py passed, Duration: 10 s\r\n209/454 - rpc_bind.py --ipv4 skipped (not on a Linux system\r\n)\r\n210/454 - rpc_bind.py --ipv6 skipped (not on a Linux system\r\n)\r\n211/454 - rpc_packages.py passed, Duration: 8 s\r\n212/454 - rpc_bind.py --nonloopback skipped (not on a Linux system\r\n)\r\n213/454 - p2p_feefilter.py passed, Duration: 4 s\r\n```\r\n\r\nStripping whitespace from the regex match fixes the formatting. [See](https://github.com/hebasto/bitcoin/actions/runs/20993564177/job/60350024373):\r\n```\r\n208/454 - feature_bip68_sequence.py passed, Duration: 9 s\r\n209/454 - rpc_bind.py --ipv4 skipped (not on a Linux system)\r\n210/454 - rpc_bind.py --ipv6 skipped (not on a Linux system)\r\n211/454 - rpc_bind.py --nonloopback skipped (not on a Linux system)\r\n212/454 - rpc_packages.py passed, Duration: 7 s\r\n```",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-01-14T13:29:56Z",
      "updated_at": "2026-01-16T09:31:19Z",
      "merged_at": "2026-01-15T15:12:12Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34282",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1089,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3178421415,
      "number": 34313,
      "title": "Update bitcoin_de.ts",
      "body": "Fixes #34312\r\n\r\n\"Bitte mit der neueste Softwareversion auszufÃ¼hren.\" is wrong in two senses, it has to be \"neuesten\" and \"ausfÃ¼hren\", I'm from Germany.",
      "state": "closed",
      "user": "benediktjohannes",
      "created_at": "2026-01-15T19:03:59Z",
      "updated_at": "2026-01-16T09:30:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34313",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 172,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3178153988,
      "number": 34311,
      "title": "test: add unit tests for wallet interface getter basic method",
      "body": "This PR adds a unit test for basic wallet interface getter methods in `src/wallet/interfaces.cpp`  test verifies that `WalletImpl` correctly returns wallet properties and configuration values.\r\n\r\nAdded test case `wallet_interface_getters_basic` in `src/wallet/test/wallet_tests.cpp` that tests the following methods:\r\n\r\n1. **`getWalletName()`** \r\n2. **`isCrypted()`** \r\n3. **`isLocked()`**\r\n4. **`getDefaultAddressType()`**\r\n5. **`getDefaultMaxTxFee()`** \r\n6. **`getConfirmTarget()`**\r\n\r\ngetter methods are  untested. regressions in these methods could go undetected. The test catches the following types of bugs:\r\n\r\n```\r\n./bin/test_bitcoin --run_test=wallet_tests/wallet_interface_getters_basic\r\nRunning 1 test case...\r\n./wallet/test/wallet_tests.cpp(745): error: in \"wallet_tests/wallet_interface_getters_basic\": check wallet_name == \"test_wallet\" has failed [default != test_wallet]\r\n./wallet/test/wallet_tests.cpp(747): error: in \"wallet_tests/wallet_interface_getters_basic\": check wallet_interface->isCrypted() == false has failed [true != false]\r\n./wallet/test/wallet_tests.cpp(749): error: in \"wallet_tests/wallet_interface_getters_basic\": check wallet_interface->isLocked() == false has failed [true != false]\r\n./wallet/test/wallet_tests.cpp(752): error: in \"wallet_tests/wallet_interface_getters_basic\": check default_type == OutputType::BECH32 || default_type == OutputType::LEGACY || default_type == OutputType::P2SH_SEGWIT || default_type == OutputType::BECH32M has failed\r\n./wallet/test/wallet_tests.cpp(756): error: in \"wallet_tests/wallet_interface_getters_basic\": check max_fee > 0 has failed\r\n./wallet/test/wallet_tests.cpp(759): error: in \"wallet_tests/wallet_interface_getters_basic\": check confirm_target > 0 has failed\r\n\r\n*** 6 failures are detected in the test module \"Bitcoin Core Test Suite\"\r\n```\r\n",
      "state": "open",
      "user": "b-l-u-e",
      "created_at": "2026-01-15T17:30:22Z",
      "updated_at": "2026-01-16T08:22:59Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34311",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1885,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3180205533,
      "number": 34315,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "maximtea64",
      "created_at": "2026-01-16T07:40:13Z",
      "updated_at": "2026-01-16T07:40:43Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34315",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3034182041,
      "number": 33922,
      "title": "mining: add getMemoryLoad() and track template non-mempool memory footprint",
      "body": "Implements a way to track the memory footprint of all non-mempool transactions that are still being referenced by block templates, see discussion in  #33899. It does not impose a limit.\r\n\r\nIPC clients can query this footprint (total, across all clients) using the `getMemoryLoad()` IPC method. Its client-side usage is demonstrated here:\r\n- https://github.com/stratum-mining/sv2-tp/pull/63\r\n\r\nAdditionally, the functional test in `interface_ipc.py` is expanded to demonstrate how template memory management works: templates are not released until the client drops references to them, or calls the template destroy method, or disconnects. The destroy method is called automatically by clients using [libmultiprocess](https://github.com/bitcoin-core/libmultiprocess), as [sv2-tp](https://github.com/stratum-mining/sv2-tp) does. In the Python tests it also happens when references are destroyed or go out of scope.\r\n\r\nThe PR starts with preparation refactor commits:\r\n\r\n1. Tweaks `interface_ipc.py` so `destroy()` calls happen in an order that's useful to later demonstrate memory management\r\n2. Change `std::unique_ptr<BlockTemplate> block_template` from a `static` defined in `rpc/mining.cpp` to `NodeContext`. This prevents a crash when we switch to a non-trivial destructor later (which uses `m_node`).\r\n\r\nThen the main commits:\r\n\r\n3. Add `template_tx_refs` to `NodeContext` to track how many templates contain any given transaction. This map is updated by the `BlockTemplate` constructor and destructor.\r\n4. Add `GetTemplateMemoryUsage()` which loops over this map and sums up the memory footprint for transactions outside the mempool\r\n5. Expose this information to IPC clients via `getMemoryLoad()` and add test coverage\r\n",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-21T15:34:14Z",
      "updated_at": "2026-01-16T06:50:35Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33922",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1801,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3039837291,
      "number": 33936,
      "title": "mining: pass missing context to createNewBlock() and checkBlock()",
      "body": "Adding a `context` parameter ensures that these methods are run in their own thread and don't block other calls.\r\n\r\nFor `createNewBlock()` this is not expected to have much impact, because block template creation is fast.\r\n\r\nFor `checkBlock()` this ensures that if we receive a slow to validate block from an untrusted origin (the IPC connection itself is assumed to trusted), it will not block the IPC server. But since validation itself blocks `cs_main` this is also not a huge performance win.\r\n\r\nThis is a breaking change both ways:\r\n- clients must use the updated capnp file\r\n- updated clients can't call these methods on an unupgraded node\r\n\r\n---\r\n\r\nBecause it's a breaking change, but not really important, this PR is marked pending some other more important breaking change. See #33777.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-24T12:36:43Z",
      "updated_at": "2026-01-16T06:24:59Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33936",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 860,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3059986313,
      "number": 33986,
      "title": "doc: improvements to doc/descriptors.md",
      "body": "This brings doc/descriptors.md up to date:\r\n* Stop trying to exhaustively list all RPCs that involve descriptors. They're used everywhere.\r\n* Stop trying to give the history of descriptor support, we have release notes for that.\r\n* Mention that wallets are now built around descriptors (especially with legacy wallets gone).\r\n* Mention `musig()` KEY expressions in the specification part.\r\n* Reference the relevant output descriptor BIPs in the text.",
      "state": "open",
      "user": "sipa",
      "created_at": "2025-12-01T16:25:09Z",
      "updated_at": "2026-01-16T05:04:33Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33986",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 490,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3167553868,
      "number": 34268,
      "title": "[29.x] backports + final changes for 29.3",
      "body": "Backports:\r\n\r\n- #34227 \r\n- #33723 \r\n- #33475 \r\n- #33268 \r\n\r\nAnd final changes for 29.3rc1",
      "state": "closed",
      "user": "glozow",
      "created_at": "2026-01-12T22:47:22Z",
      "updated_at": "2026-01-16T03:14:31Z",
      "merged_at": "2026-01-15T10:23:14Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34268",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 131,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2806431312,
      "number": 33335,
      "title": "txgraph: randomize order of same-feerate distinct-cluster transactions",
      "body": "Part of #30289.\r\n\r\nBefore, the implicit ordering of transactions in a TxGraph's main graph is sorted by:\r\n- feerate, high to low\r\n- `Cluster`, low to high `m_sequence`\r\n- linearization order within clusters\r\n\r\nHowever, since `m_sequence` values are assigned deterministically and predictably, the ordering of same-feerate distinct-Cluster transactions can reveal something about the order they were inserted into `TxGraph`.\r\n\r\nIn #28676, this ordering (through `TxGraph::CompareMainOrder`) is used to decide the order of to-be-announced transactions. These should not expose information about insertion order.\r\n\r\nTo deal with this, do not compare the `m_sequence` values directly, but hash them with a fixed but random key first. In case this yields a collision (which needs ~192000 clusters to have a probability of 10^-9 of existing), fall back to comparing the `m_sequence` values directly.\r\n\r\nAlternatives: we could instead use the pre-cluster-mempool approach of sorting by wtxid in case of ties, which is equally non-revealing, and deterministic. I find it cleaner to have a randomized internal total ordering rather than needing a partial ordering within `TxGraph` that needs to be complemented by tie-breaking logic inside the mempool, however, and I don't think the determinism is that valuable.\r\n\r\nFor context: https://github.com/bitcoin/bitcoin/pull/28676#discussion_r2328804847\r\n",
      "state": "closed",
      "user": "sipa",
      "created_at": "2025-09-07T23:43:53Z",
      "updated_at": "2026-01-16T02:11:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33335",
      "labels": [
        "Mempool"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1462,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1444867984,
      "number": 28122,
      "title": "Silent Payments: Implement BIP352",
      "body": "This PR is part of integrating silent payments into Bitcoin Core. The project is tracked in https://github.com/bitcoin/bitcoin/issues/28536\r\n\r\nBased on https://github.com/bitcoin-core/secp256k1/pull/1698\r\n\r\n## BIP352\r\n\r\nThis PR focuses strictly on the BIP logic and attempts to separate it from the wallet and transaction implementation details. This is accomplished by working directly with public and private keys, instead of needing a wallet backend and transactions for testing. Labels for the receiver are optional and thus deferred for a later PR.\r\n\r\nTest vectors from the BIP are included as unit tests.\r\n",
      "state": "open",
      "user": "josibake",
      "created_at": "2023-07-21T18:36:37Z",
      "updated_at": "2026-01-16T02:00:10Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28122",
      "labels": [
        "Wallet",
        "Privacy",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 646,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1746125849,
      "number": 29491,
      "title": "[EXPERIMENTAL] Schnorr batch verification for blocks",
      "body": "This is a simple draft implementation of Schnorr signature batch verification in blocks, put here for conceptual discussion, and collaborative benchmarking. Most of code added here is from the `secp256k1` implementation.\r\n\r\nThe `secp256k1` code is still under review itself, please spend some time giving feedback on the API etc. if you can:\r\n- [Original PR](https://github.com/bitcoin-core/secp256k1/pull/1134)\r\n- [My rebase used here including fixes and adds cmake support](https://github.com/fjahr/secp256k1/tree/pr1134-rebase-2024)\r\n\r\nTODOs\r\n- [ ] Fix `functional/feature_taproot.py`\r\n- [x] Extensive benchmarking using `ConnectBlock()` tracing\r\n- [x] Add unit tests\r\n- [ ] Batch taproot tweak verification as well\r\n- [ ] Conceptual discussion in what form this realistically could be introduced into the code base, and later, a release",
      "state": "open",
      "user": "fjahr",
      "created_at": "2024-02-27T17:06:26Z",
      "updated_at": "2026-01-16T02:00:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29491",
      "labels": [
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 893,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1460109729,
      "number": 28201,
      "title": "Silent Payments: sending",
      "body": "This PR is part of integrating silent payments into Bitcoin Core. Status and tracking for the project is managed in https://github.com/bitcoin/bitcoin/issues/28536\r\n\r\nThis PR depends on #28122 and is marked as a draft until it is merged. If interested in those commits, please review on #28122\r\n\r\n## Sending \r\n### Silent Payments logic\r\n\r\nThe main focus of this PR is:\r\n\r\n* Applying the Taptweak to a taproot internal private key (this is a copy-paste of the code for applying the taptweak in the signing process)\r\n* Getting a private key from a given `scriptPubKey`\r\n* Creating silent payment outputs\r\n* Applying the created scriptPubKeys back to the vector of `CRecipients`\r\n\r\nThe functions are then used together to create silent payment outputs during `CreateTransactionInternal`.\r\n\r\n### Final steps\r\n\r\nThe last commits ensure that:\r\n\r\n* Coin selection is silent payments aware and knows to exclude taproot script path spends and inputs with unknown witness when funding a transaction which pays to a silent payment address\r\n* The change output type is correctly chosen when paying to a silent payment address\r\n* Functional tests\r\n",
      "state": "open",
      "user": "josibake",
      "created_at": "2023-08-02T16:37:04Z",
      "updated_at": "2026-01-16T02:00:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28201",
      "labels": [
        "Wallet",
        "Privacy",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1160,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2961135803,
      "number": 33740,
      "title": "RFC: bench: Add multi thread benchmarking",
      "body": "This adds a rough way to run specific benchmarks with different numbers of worker threads to see how these impact performance. This is useful for me in the batch validation context and for potential refactorings of checkqueue but I am not sure if this is useful in many other contexts so I am leaving this as a RFC draft for now to see if there is any interest in merging something like this.\r\n\r\nExample output:\r\n\r\n```\r\n$ build/bin/bench_bitcoin -filter=ConnectBlockAllSchnorr -min-time=1000 -scale-threads\r\nRunning benchmarks with worker threads from 1 to 15\r\n\r\n|            ns/block |             block/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|       43,118,187.50 |               23.19 |    0.1% |      0.99 | `ConnectBlockAllSchnorr_1_threads`\r\n|       29,015,444.33 |               34.46 |    0.2% |      1.10 | `ConnectBlockAllSchnorr_2_threads`\r\n|       22,241,437.50 |               44.96 |    0.1% |      1.09 | `ConnectBlockAllSchnorr_3_threads`\r\n|       17,893,361.00 |               55.89 |    0.3% |      1.09 | `ConnectBlockAllSchnorr_4_threads`\r\n|       15,105,819.50 |               66.20 |    0.2% |      1.09 | `ConnectBlockAllSchnorr_5_threads`\r\n|       13,145,510.38 |               76.07 |    0.2% |      1.08 | `ConnectBlockAllSchnorr_6_threads`\r\n|       11,646,614.62 |               85.86 |    0.2% |      1.06 | `ConnectBlockAllSchnorr_7_threads`\r\n|       10,476,425.89 |               95.45 |    0.2% |      1.07 | `ConnectBlockAllSchnorr_8_threads`\r\n|        9,547,125.00 |              104.74 |    0.2% |      1.08 | `ConnectBlockAllSchnorr_9_threads`\r\n|        9,574,246.27 |              104.45 |    0.6% |      1.08 | `ConnectBlockAllSchnorr_10_threads`\r\n|        9,557,633.40 |              104.63 |    1.1% |      1.08 | `ConnectBlockAllSchnorr_11_threads`\r\n|        9,495,175.00 |              105.32 |    0.8% |      1.08 | `ConnectBlockAllSchnorr_12_threads`\r\n|        9,297,012.50 |              107.56 |    0.3% |      1.07 | `ConnectBlockAllSchnorr_13_threads`\r\n|        9,775,795.45 |              102.29 |    0.7% |      1.11 | `ConnectBlockAllSchnorr_14_threads`\r\n|        9,776,140.18 |              102.29 |    0.9% |      1.06 | `ConnectBlockAllSchnorr_15_threads`\r\n```\r\n",
      "state": "closed",
      "user": "fjahr",
      "created_at": "2025-10-29T23:36:13Z",
      "updated_at": "2026-01-15T22:11:11Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33740",
      "labels": [
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2335,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3124280596,
      "number": 34141,
      "title": "miniscript: Use Func and Expr when parsing keys, hashes, and locktimes",
      "body": "The miniscript parser currently only looks for the next `)` when parsing key, hash, and locktime expressions. This fails to parse when the expressions contain a nested expression. Currently, this is only possible with `musig()` inside of key expressions. However, this pattern can be generalized to handling hashes and locktimes, so I implemented those too.\r\n\r\nFixes #34076",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-12-22T21:36:58Z",
      "updated_at": "2026-01-15T19:26:41Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34141",
      "labels": [
        "Descriptors"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 444,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3139279316,
      "number": 34185,
      "title": "test: fix `feature_pruning` when built without wallet",
      "body": "Fixes #34175\r\n\r\nIn `feature_pruning`, the`wallet_test` doesn't require any specific wallet functionality and this test is important for one of next ones (`test_scanblocks_pruned`). The reason is that it synchronizes the node 5 and, without this sync, `test_scanblocks_pruned` will fail since we expect `scanblocks` to fail due to `Block not available (pruned data)` and it doesn't happen without this sync.",
      "state": "closed",
      "user": "brunoerg",
      "created_at": "2025-12-31T15:14:05Z",
      "updated_at": "2026-01-15T19:15:14Z",
      "merged_at": "2026-01-14T20:58:58Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34185",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 460,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1042507625,
      "number": 25968,
      "title": "Optimizations & simplifications following #25717",
      "body": "This contains a list of most-unrelated simplifications and optimizations to the code merged in #25717:\r\n* **Make `ProcessNextHeaders` replace the headers argument**: this allows reusing the same vector storage for input and output headers to `HeadersSync::ProcessNextHeaders`. I find it also natural in the sense that this argument just represents the headers-to-be-processed, both in the caller and the callee, and both before and after the calls.\r\n* **Make `ProcessNextHeaders` support empty headers message**: remove the special case in `ProcessHeadersMessage` dealing with empty headers messages, and instead let `HeadersSync` deal with it correctly.\r\n* **Simplify `TryLowWorkHeadersSync` invocation**: make use of the fact that now `TryLowWorkHeadersSync` is (like `IsContinuationOfLowWorkHeadersSync`) an operation that partially processes headers, it can be invoked in a similar way, bailing out when there is nothing left to do.\r\n* **Avoid an `IsAncestorOfBestHeaderOrTip` call**: just don't call this function when it won't have any effect\r\n* **Compute work from headers without `CBlockIndex`**: avoid the need to construct a `CBlockIndex` object just to compute work for a header, when its `nBits` value suffices for that. Also use some `Span`s where possible.\r\n* **Remove useless `CBlock::GetBlockHeader` (it inherits from it)**: There is no need for a function to convert a `CBlock` to a `CBlockHeader`, as it's a child class of it.\r\n\r\nThese are not reactions to review feedback, and isn't intended for 24.0.",
      "state": "closed",
      "user": "sipa",
      "created_at": "2022-08-31T14:59:06Z",
      "updated_at": "2026-01-15T18:45:47Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/25968",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1569,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3174906348,
      "number": 34293,
      "title": "Bugfix: net_processing: Restore missing comma between peer and peeraddr in \"receive version message\"",
      "body": "Versions prior to 29.x all included a comma here, and the general format of the message still includes commas between all other fields\r\n",
      "state": "open",
      "user": "luke-jr",
      "created_at": "2026-01-14T20:34:00Z",
      "updated_at": "2026-01-15T17:37:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34293",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 237,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3173543618,
      "number": 34283,
      "title": "[30.x] More backports",
      "body": "Backports:\r\n* #34185\r\n* #34272\r\n* #34252\r\n* #34282",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-14T13:32:45Z",
      "updated_at": "2026-01-15T15:23:58Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34283",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 72,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3176535463,
      "number": 34299,
      "title": "wallet: re-activate \"AmountWithFeeExceedsBalance\" error",
      "body": "picks up https://github.com/bitcoin/bitcoin/pull/25269.\r\n\r\n`AmountWithFeeExceedsBalance`Â error insideÂ `WalletModel::prepareTransaction`Â is never thrown and remains an unused code path. This is becauseÂ `createTransaction`Â does not retrieve the fee when the process fails. The fee return arg is set only at the end of the process, when the transaction is successfully created. Therefore, if the transaction creation fails, the fee is not available insideÂ `WalletModel::prepareTransaction`Â to trigger theÂ `AmountWithFeeExceedsBalance`Â error.\r\n\r\nThis PR re-implements the feature insideÂ `CreateTransactionInternal`Â and adds test coverage for it.\r\n\r\n| on master | on PR |\r\n|-----------|-------|\r\n| <img src=\"https://github.com/user-attachments/assets/a903e687-2466-42c7-b898-5dec24bfe515\" width=\"750\" alt=\"Insufficient funds\" /> | <img src=\"https://github.com/user-attachments/assets/74bb3c83-6132-4c09-91f0-0a446618b3c8\" width=\"750\" alt=\"AmountWithFeeExceedsBalance\" /> |\r\n\r\nthe unreachable code path is removed in https://github.com/bitcoin-core/gui/pull/807 which requires this PR.\r\n",
      "state": "open",
      "user": "stratospher",
      "created_at": "2026-01-15T09:06:21Z",
      "updated_at": "2026-01-15T14:48:56Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34299",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1137,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3104076541,
      "number": 34079,
      "title": "kernel: Remove non-kernel module includes",
      "body": "Found these while attempting to isolate the kernel library sources into their own repository. There still is no mechanism for preventing including headers into the kernel library that don't belong to kernel modules, but it is also fairly straight forward to correct manually for now. However, the changes here might be incomplete.",
      "state": "closed",
      "user": "sedited",
      "created_at": "2025-12-15T21:30:55Z",
      "updated_at": "2026-01-15T14:32:17Z",
      "merged_at": "2025-12-22T14:07:41Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34079",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 372,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3176622068,
      "number": 34300,
      "title": "test: use ephemeral ports in p2p_private_broadcast.py",
      "body": "The test `p2p_private_broadcast.py` gets some Python P2P nodes to listen and instructs the SOCKS5 proxy to redirect connections to them instead of to the requested addresses. This way the `bitcoind` which uses the proxy is tricked to think it has connected to real routable internet IP addresses or `.onion` addresses.\r\n\r\nPicking the ports where to Python P2P nodes to listen however is tricky to be done in a non-conflicting way, given that other tests may run in parallel. https://github.com/bitcoin/bitcoin/pull/34186 made it possible to let the OS select a free port, so use that in\r\n`p2p_private_broadcast.py`.\r\n\r\n---\r\n\r\n_Suggested in https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2654849875_",
      "state": "closed",
      "user": "vasild",
      "created_at": "2026-01-15T09:33:16Z",
      "updated_at": "2026-01-15T14:29:21Z",
      "merged_at": "2026-01-15T14:29:20Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34300",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 763,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3175286711,
      "number": 34295,
      "title": "test: Improve STRICTENC/DERSIG unit tests",
      "body": "488550a74f67877e4c09aabeb97505bacbffb76c: Fix a test that isn't implemented as intended. The idea is to test execution order by providing a signature that would cause script failure when parsed. An empty signature does not cause script failure in `CHECKMULTISIG`. Use `OP_1` for the second signature instead of `OP_0`. Also remove a comment referencing a file that no longer exists in the codebase: `script_invalid.json`.\r\n\r\n63ff7c4158a46ff5d726a576e3ac1f384e6cc2b7: Copy existing `STRICTENC` tests and change the flag to `DERSIG`. `DERSIG` is a consensus flag (unlike `STRICTENC`), so it'd be good to have dedicated test cases.\r\n\r\n`script_tests` pass on my end.",
      "state": "open",
      "user": "billymcbip",
      "created_at": "2026-01-14T22:46:49Z",
      "updated_at": "2026-01-15T14:21:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34295",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 704,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3159715494,
      "number": 34238,
      "title": "wallet: remove erroneous-on-reorg Assume()",
      "body": "Resolves https://github.com/bitcoin/bitcoin/issues/34206\r\n\r\nI'm not certain the test is worth keeping, but included it for now to show minimal example that crashes without fix. Can be removed.",
      "state": "closed",
      "user": "instagibbs",
      "created_at": "2026-01-09T13:43:27Z",
      "updated_at": "2026-01-15T14:17:31Z",
      "merged_at": "2026-01-15T14:17:31Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34238",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 235,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3177410699,
      "number": 34307,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "AmberMarie4444",
      "created_at": "2026-01-15T13:42:40Z",
      "updated_at": "2026-01-15T13:43:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34307",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3177101890,
      "number": 34304,
      "title": "ci: remove `Valgrind fuzz` from CI matrix",
      "body": "### Problem definition\r\nThe `Valgrind fuzz` job was introduced in e4b04630bcf59ea03c1373777a0167af699f92a4.\r\nSince then, `ci/test/00_setup_env_native_fuzz_with_valgrind.sh` seems to regularly time out on forked repositories (which fall back to GitHub-hosted runners), hitting the 240 minute job timeout.\r\n\r\nThis means that every PR I push on my own branch (I do that sometimes to make sure it passes CI before I push to `bitcoin/bitcoin`) will always fail.\r\n\r\n### Fix\r\nRemove it from the CI matrix, similar to how the valgrind no-fuzz task is handled.\r\nThe setup script remains available for local testing.",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2026-01-15T12:14:32Z",
      "updated_at": "2026-01-15T13:42:11Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34304",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 648,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3177395444,
      "number": 34306,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "AmberMarie4444",
      "created_at": "2026-01-15T13:38:49Z",
      "updated_at": "2026-01-15T13:39:16Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34306",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3174345401,
      "number": 34287,
      "title": "[RFC] test: integrate secp256k1lab as subtree and use it for low-level EC ops",
      "body": "This PR adds [secp256k1lab](https://github.com/secp256k1lab/secp256k1lab) as a subtree and uses it for low-level secp256k1 field and group arithmetic (i.e. replacing the contents of secp256k1.py) as a first step, primarily for demonstration purposes. Keeping it as a draft right now, to assess if there is conceptual support. The goal would be to keep the test framework code maintained here to Bitcoin Core specific parts and develop secp256k1-specific parts (e.g. MuSig, Silent Payments, FROST etc., to name a few upcoming ones) in secp256k1lab. I'm not sure if that's a clear win from a maintenance perspective (it could e.g. add friction, having to depend on and coordinate with secp256k1lab maintainers), but I'm curious to hear opinions. Suggested e.g. in https://github.com/bitcoin/bitcoin/pull/32642#pullrequestreview-2881144268.\r\n\r\nAlso, there are still some problems and open questions:\r\n* CI for \"Windows native\" job is failing (didn't check in detail yet, but I assume the secp256k1lab folder is not found due to failing Path.resolve() symlink resolution, i.e. the library is searched within the build folder)\r\n* BIP340 signing/verification can't be fully replaced yet (the test framework's Schnorr signing in `key.py`uses special testing parameters like `flip_p` and `flip_r` that aren't available in secp256k1lab)\r\n* Where to place the subtree? Originally I added it in `test_framework/crypto` but moved it up directly to `test`, for not having to add a linter mypy exception, as it only targets `test/functional/*`; maybe adding the subtree to a new folder like `test/libs` would be better for clarity",
      "state": "open",
      "user": "theStack",
      "created_at": "2026-01-14T17:27:37Z",
      "updated_at": "2026-01-15T13:28:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34287",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1694,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3128861568,
      "number": 34146,
      "title": "p2p: send first addr self-announcement in separate message ðŸŽ„",
      "body": "This makes sure the initial address self-announcement a node sends to a peer happends in a separate P2P message. This has benefits for both inbound and outbound connections:\r\n\r\nFor inbound connections from a peer to us, previously, we might send the self-announcement along with our response to a GETADDR request. However, the self-announcement might replace an address from the GETADDR response. This isn't clean.\r\n\r\nFor outbound connections from us to a peer, previously, it could have happend that we send the self-announcement along with other addresses. Since shortly after connection open, the peer might only have one rate-limiting token for us, and the addresses are shuffeld on arrival, it's possible that the self-announcement gets rate-limited. However, note that these rate-limitings seem to be rare in practice.\r\n\r\nThis is inspired by and based on https://github.com/bitcoin/bitcoin/pull/33699#issuecomment-3462287763. The discussion there should be helpful for reviewers. ",
      "state": "closed",
      "user": "0xB10C",
      "created_at": "2025-12-24T15:38:31Z",
      "updated_at": "2026-01-15T12:34:16Z",
      "merged_at": "2026-01-14T22:16:49Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34146",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1047,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3164539279,
      "number": 34259,
      "title": "Find minimal chunks in SFL",
      "body": "Part of #30289.\r\n\r\nThis was split off from #34023, because it's not really an optimization but a feature. The feature existed pre-SFL, so this brings SFL to parity in terms of functionality with the old code.\r\n\r\nThe idea is that while optimality - as achieved by SFL before this PR - guarantees a linearization whose feerate diagram is optimal, it may be possible to split chunks into smaller equal-feerate parts. This is desirable because even though it doesn't change the diagram, it provides more flexibility for optimization (binpacking is easier when the pieces are smaller).\r\n\r\nThus, this PR introduces the stronger notion of \"minimality\": optimal chunks, which are also split into their smallest possible pieces. To accomplish that, an additional step in the SFL algorithm is added which aims to split chunks into minimal equal-feerate parts where possible, without introducing circular dependencies between them. It works based on the observation that if an (already otherwise optimal) chunk has a way of being split into two equal-feerate parts, and T is a given transaction in the chunk, then we can find the split in two steps:\r\n* One time, pretend T has $\\epsilon$ higher feerate than it really has. If a split exists with T in the top part, this will find it.\r\n* The other time, pretend T has $\\epsilon$ lower feerate than it really has. If a split exists with T in the bottom part, this will find it.\r\n\r\nSo we try both on each found optimal chunk. If neither works, the chunk is minimal. If one works, recurse into the split chunks to split them further.",
      "state": "closed",
      "user": "sipa",
      "created_at": "2026-01-12T05:17:26Z",
      "updated_at": "2026-01-15T10:07:28Z",
      "merged_at": "2026-01-15T10:07:27Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34259",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1595,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3170618932,
      "number": 34274,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "EricGrill",
      "created_at": "2026-01-13T17:33:43Z",
      "updated_at": "2026-01-15T10:01:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34274",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3170621269,
      "number": 34275,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "EricGrill",
      "created_at": "2026-01-13T17:34:39Z",
      "updated_at": "2026-01-15T10:01:41Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34275",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3170627073,
      "number": 34277,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "EricGrill",
      "created_at": "2026-01-13T17:36:55Z",
      "updated_at": "2026-01-15T10:01:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34277",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3170631798,
      "number": 34278,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "EricGrill",
      "created_at": "2026-01-13T17:38:45Z",
      "updated_at": "2026-01-15T10:01:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34278",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3174819934,
      "number": 34292,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "Niharikajakkula",
      "created_at": "2026-01-14T20:02:41Z",
      "updated_at": "2026-01-15T10:01:18Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34292",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3174813910,
      "number": 34291,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "Niharikajakkula",
      "created_at": "2026-01-14T20:00:10Z",
      "updated_at": "2026-01-15T10:01:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34291",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3174802498,
      "number": 34290,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "Niharikajakkula",
      "created_at": "2026-01-14T19:55:47Z",
      "updated_at": "2026-01-15T10:01:02Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34290",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3149999731,
      "number": 34210,
      "title": "bench: Remove -priority-level= option",
      "body": "The option was added in https://github.com/bitcoin/bitcoin/pull/26158, when the project was using an autotools-based build system. However, in the meantime this option is unused:\r\n\r\n* First, commit 27f11217ca63e0f8f78f14db139150052dcd9962 removed the option from one CI task\r\n* Then https://github.com/bitcoin/bitcoin/pull/32310 removed the option from CMakeList.txt, because:\r\n \r\n  * they only run as a sanity check (fastest version)\r\n  * no one otherwise runs them, not even CI\r\n  * issues have been missed due to this\r\n\r\nFinally, after commit 0ad4376a49fae6f705128b326ba92317cb8e0639, I don't see a single reason to keep this option, so remove it.\r\n\r\nAlso, there is a commit to turn a silent ignore of duplicate bench names into an error.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-06T16:43:15Z",
      "updated_at": "2026-01-15T09:52:12Z",
      "merged_at": "2026-01-14T22:49:17Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34210",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 779,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3160679481,
      "number": 34243,
      "title": "doc: validation: fix `PackageMempoolChecks` incorrect comment",
      "body": "This is a simple PR that fixes the incorrect description of what is done in `PackageMempoolChecks`\r\n    \r\n>  // Enforce package mempool ancestor/descendant limits (distinct from individual\r\n> // ancestor/descendant limits done in PreChecks) and run Package RBF checks.\r\n    \r\nAfter cluster mempool, we no longer enforce ancestor/descendant limits in both `PreChecks` and  `PackageMempoolChecks`; instead, cluster limit is enforced in `PackageMempoolChecks`.\r\n This PR fixes the incorrect comment  by;\r\n   - Making it clear why it is necessary to have two calls of  `CheckMempoolPolicyLimts` in both `PackageMempoolChecks` and after in `AcceptMultipleTransactionsInternal` by executing `PackageMempoolChecks` only during package RBF only. No need to jump into the next subroutine when there is no conflict. \r\n   - Renames `PackageMempoolChecks` to `PackageRBFChecks`; the method name is self-explanatory now, hence no need for a description comment.",
      "state": "closed",
      "user": "ismaelsadeeq",
      "created_at": "2026-01-09T19:25:31Z",
      "updated_at": "2026-01-15T09:51:47Z",
      "merged_at": "2026-01-14T16:31:20Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34243",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1010,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1719386983,
      "number": 29415,
      "title": "Broadcast own transactions only via short-lived Tor or I2P connections",
      "body": "_Parts of this PR are isolated in independent smaller PRs to ease review:_\r\n\r\n* [x] _https://github.com/bitcoin/bitcoin/pull/29420_\r\n* [x] _https://github.com/bitcoin/bitcoin/pull/33454_\r\n* [x] _https://github.com/bitcoin/bitcoin/pull/33567_\r\n* [x] _https://github.com/bitcoin/bitcoin/pull/33793_\r\n\r\n---\r\n\r\nTo improve privacy, broadcast locally submitted transactions (from the `sendrawtransaction` RPC) to the P2P network only via Tor or I2P short-lived connections, or to IPv4/IPv6 peers but through the Tor network.\r\n\r\n* Introduce a new connection type for private broadcast of transactions with the following properties:\r\n  * started whenever there are local transactions to be sent\r\n  * opened to Tor or I2P peers or IPv4/IPv6 via the Tor proxy\r\n  * opened regardless of max connections limits\r\n  * after handshake is completed one local transaction is pushed to the peer, `PING` is sent and after receiving `PONG` the connection is closed\r\n  * ignore all incoming messages after handshake is completed (except `PONG`)\r\n\r\n* Broadcast transactions submitted via `sendrawtransaction` using this new mechanism, to a few peers. Keep doing this until we receive back this transaction from one of our ordinary peers (this takes about 1 second on mainnet).\r\n\r\n* The transaction is stored in peerman and does not enter the mempool.\r\n\r\n* Once we get an `INV` from one of our ordinary peers, then the normal flow executes: we request the transaction with `GETDATA`, receive it with a `TX` message, put it in our mempool and broadcast it to all our existent connections (as if we see it for the first time).\r\n\r\n* After we receive the full transaction as a `TX` message, in reply to our `GETDATA` request, only then consider the transaction has propagated through the network and remove it from the storage in peerman, ending the private broadcast attempts.\r\n\r\nThe messages exchange should look like this:\r\n\r\n```\r\ntx-sender >--- connect -------> tx-recipient\r\ntx-sender >--- VERSION -------> tx-recipient (dummy VERSION with no revealing data)\r\ntx-sender <--- VERSION -------< tx-recipient\r\ntx-sender <--- WTXIDRELAY ----< tx-recipient (maybe)\r\ntx-sender <--- SENDADDRV2 ----< tx-recipient (maybe)\r\ntx-sender <--- SENDTXRCNCL ---< tx-recipient (maybe)\r\ntx-sender <--- VERACK --------< tx-recipient\r\ntx-sender >--- VERACK --------> tx-recipient\r\ntx-sender >--- INV/TX --------> tx-recipient\r\ntx-sender <--- GETDATA/TX ----< tx-recipient\r\ntx-sender >--- TX ------------> tx-recipient\r\ntx-sender >--- PING ----------> tx-recipient\r\ntx-sender <--- PONG ----------< tx-recipient\r\ntx-sender disconnects\r\n```\r\n\r\nWhenever a new transaction is received from `sendrawtransaction` RPC, the node will send it to a few (`NUM_PRIVATE_BROADCAST_PER_TX`) recipients right away. If after some time we still have not heard anything about the transaction from the network, then it will be sent to 1 more peer (see `PeerManagerImpl::ReattemptPrivateBroadcast()`).\r\n\r\nA few considerations:\r\n* The short-lived private broadcast connections are very cheap and fast wrt network traffic. It is expected that some of those peers could blackhole the transaction. Just one honest/proper peer is enough for successful propagation.\r\n* The peers that receive the transaction could deduce that this is initial transaction broadcast from the transaction originator. This is ok, they can't identify the sender.\r\n\r\n---\r\n\r\n<details>\r\n<summary>How to test this?</summary>\r\n\r\nThank you, @stratospher and @andrewtoth!\r\n\r\nStart `bitcoind` with `-privatebroadcast=1 -debug=privatebroadcast`.\r\n\r\nCreate a wallet and get a new address, go to the Signet faucet and request some coins to that address:\r\n```bash\r\nbuild/bin/bitcoin-cli -chain=\"signet\" createwallet test\r\nbuild/bin/bitcoin-cli -chain=\"signet\" getnewaddress\r\n```\r\n\r\nGet a new address for the test transaction recipient:\r\n```bash\r\nbuild/bin/bitcoin-cli -chain=\"signet\" loadwallet test\r\nnew_address=$(build/bin/bitcoin-cli -chain=\"signet\" getnewaddress)\r\n```\r\n\r\nCreate the transaction:\r\n```bash\r\n# Option 1: `createrawtransaction` and `signrawtransactionwithwallet`:\r\n\r\ntxid=$(build/bin/bitcoin-cli -chain=\"signet\" listunspent | jq -r '.[0] | .txid')\r\nvout=$(build/bin/bitcoin-cli -chain=\"signet\" listunspent | jq -r '.[0] | .vout')\r\necho \"txid: $txid\"\r\necho \"vout: $vout\"\r\n\r\ntx=$(build/bin/bitcoin-cli -chain=\"signet\" createrawtransaction \"[{\\\"txid\\\": \\\"$txid\\\", \\\"vout\\\": $vout}]\" \"[{\\\"$new_address\\\": 0.00001000}]\" 0 false)\r\necho \"tx: $tx\"\r\n\r\nsigned_tx=$(build/bin/bitcoin-cli -chain=\"signet\" signrawtransactionwithwallet \"$tx\" | jq -r '.hex')\r\necho \"signed_tx: $signed_tx\"\r\n\r\n# OR Option 2: `walletcreatefundedpsbt` and `walletprocesspsbt`:\r\n# This makes it not have to worry about inputs and also automatically sends back change to the wallet.\r\n# Start `bitcoind` with `-fallbackfee=0.00003000` for instance for 3 sat/vbyte fee.\r\n\r\npsbt=$(build/bin/bitcoin-cli -chain=\"signet\" walletcreatefundedpsbt \"[]\" \"[{\\\"$new_address\\\": 0.00001000}]\" | jq -r '.psbt')\r\necho \"psbt: $psbt\"\r\n\r\nsigned_tx=$(build/bin/bitcoin-cli -chain=\"signet\" walletprocesspsbt \"$psbt\" | jq -r '.hex')\r\necho \"signed_tx: $signed_tx\"\r\n```\r\n\r\nFinally, send the transaction:\r\n```bash\r\nraw_tx=$(build/bin/bitcoin-cli -chain=\"signet\" sendrawtransaction \"$signed_tx\")\r\necho \"raw_tx: $raw_tx\"\r\n```\r\n\r\n</details>\r\n\r\n---\r\n\r\n<details>\r\n<summary>High-level explanation of the commits</summary>\r\n\r\n* New logging category and config option to enable private broadcast\r\n  * `log: introduce a new category for private broadcast`\r\n  * `init: introduce a new option to enable/disable private broadcast`\r\n\r\n* Implement the private broadcast connection handling on the `CConnman` side:\r\n  * `net: introduce a new connection type for private broadcast`\r\n  * `net: implement opening PRIVATE_BROADCAST connections`\r\n\r\n* Prepare `BroadcastTransaction()` for private broadcast requests:\r\n  * `net_processing: rename RelayTransaction to better describe what it does`\r\n  * `node: extend node::TxBroadcast with a 3rd option`\r\n  * `net_processing: store transactions for private broadcast in PeerManager`\r\n\r\n* Implement the private broadcast connection handling on the `PeerManager` side:\r\n  * `net_processing: reorder the code that handles the VERSION message`\r\n  * `net_processing: move the debug log about receiving VERSION earlier`\r\n  * `net_processing: modernize PushNodeVersion()`\r\n  * `net_processing: move a debug check in VERACK processing earlier`\r\n  * `net_processing: handle ConnectionType::PRIVATE_BROADCAST connections`\r\n  * `net_processing: stop private broadcast of a transaction after round-trip`\r\n  * `net_processing: retry private broadcast`\r\n\r\n* Engage the new functionality from `sendrawtransaction`:\r\n  * `rpc: use private broadcast from sendrawtransaction RPC if -privatebroadcast is ON`\r\n\r\n* New tests:\r\n  * `test: add functional test for private broadcast`\r\n  * `test: add unit test for the private broadcast storage`\r\n\r\n</details>\r\n\r\n---\r\n\r\n**This PR would resolve the following issues:**\r\nhttps://github.com/bitcoin/bitcoin/issues/3828 Clients leak IPs if they are recipients of a transaction\r\nhttps://github.com/bitcoin/bitcoin/issues/14692 Can't configure bitocoind to only send tx via Tor but receive clearnet transactions\r\nhttps://github.com/bitcoin/bitcoin/issues/19042 Tor-only transaction broadcast onlynet=onion alternative\r\nhttps://github.com/bitcoin/bitcoin/issues/24557 Option for receive events with all networks, but send transactions and/or blocks only with anonymous network[s]?\r\nhttps://github.com/bitcoin/bitcoin/issues/25450 Ability to broadcast wallet transactions only via dedicated oneshot Tor connections\r\nhttps://github.com/bitcoin/bitcoin/issues/32235 Tor: TX circuit isolation\r\n\r\n**Issues that are related, but (maybe?) not to be resolved by this PR:**\r\nhttps://github.com/bitcoin/bitcoin/issues/21876 Broadcast a transaction to specific nodes\r\nhttps://github.com/bitcoin/bitcoin/issues/28636 new RPC: sendrawtransactiontopeer\r\n\r\n---\r\n\r\nFurther extensions:\r\n* Have the wallet do the private broadcast as well, https://github.com/bitcoin/bitcoin/issues/11887 would have to be resolved.\r\n* Have the `submitpackage` RPC do the private broadcast as well, [draft diff in the comment below](https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2972293733), thanks ismaelsadeeq!\r\n* Add some stats via RPC, so that the user can better monitor what is going on during and after the broadcast. Currently this can be done via the debug log, but that is not convenient.\r\n* Make the private broadcast storage, currently in peerman, persistent over node restarts.\r\n* Add (optional) random delay before starting to broadcast the transaction in order to avoid correlating unrelated transactions based on the time when they were broadcast. Suggested independently of this PR [here](https://github.com/bitcoin/bitcoin/issues/30471).\r\n* Consider periodically sending transactions that did not originate from the node as decoy, discussed [here](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035414972).\r\n* Consider waiting for peer's FEEFILTER message and if the transaction that was sent to the peer is below that threshold, then assume the peer is going to drop it. Then use this knowledge to retry more aggressively with another peer, instead of the current 10 min. See [comment below](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3258611648).\r\n* It may make sense to be able to override the default policy -- eg so submitrawtransaction can go straight to the mempool and relay, even if txs are normally privately relayed. See [comment below](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3427086681).\r\n* As a side effect we have a new metric available - the time it takes for a transaction to reach a random node in the network (from the point of view of the private broadcast recipient the tx originator is a random node somewhere in the network). This can be useful for monitoring, unrelated to privacy characteristics of this feature.\r\n\r\n---\r\n\r\n_A previous incarnation of this can be found at https://github.com/bitcoin/bitcoin/pull/27509. It puts the transaction in the mempool and (tries to) hide it from the outside observers. This turned out to be too error prone or maybe even impossible._\r\n",
      "state": "closed",
      "user": "vasild",
      "created_at": "2024-02-09T13:39:10Z",
      "updated_at": "2026-01-15T09:35:35Z",
      "merged_at": "2026-01-12T20:02:22Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29415",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 10312,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 955967479,
      "number": 25269,
      "title": "wallet: re-activate  \"AmountWithFeeExceedsBalance\" error",
      "body": "During a talk with theStack, it was noted that the `AmountWithFeeExceedsBalance` error inside `WalletModel::prepareTransaction` is never thrown.\r\n\r\nThis is because `createTransaction` does not retrieve the fee when the process fails due to insufficient funds since #20640. The fee return arg is set only at the end of the process, when the transaction is successfully created. Therefore, if the transaction creation fails, the fee is not available inside `WalletModel::prepareTransaction` to trigger the `AmountWithFeeExceedsBalance` error.\r\n\r\nThis PR re-implements the feature inside `createTransaction` and adds test coverage for it.",
      "state": "closed",
      "user": "furszy",
      "created_at": "2022-06-02T14:17:15Z",
      "updated_at": "2026-01-15T09:12:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/25269",
      "labels": [
        "Wallet",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 692,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2591037188,
      "number": 32747,
      "title": "Introduce SockMan (\"lite\"): low-level socket handling for HTTP",
      "body": "Introduces a new low-level socket manager `SockMan` as an abstract class with virtual functions for implementing higher-level networking protocols like HTTP. This is the next step in https://github.com/bitcoin/bitcoin/issues/31194\r\n\r\nThis is a minimal, alternative version of #30988 (\"Split CConnman\") without any changes to working code (P2P is not affected). It adds a stripped-down version of the `SockMan` introduced in that pull request that implements only what is needed for the HTTP server implemented in #32061 (i.e. no I2P stuff and for now, no outbound connection stuff). Exclusions from the original `SockMan` pull request can be checked with:\r\n\r\n```\r\ngit diff vasild/sockman \\\r\nsrc/common/sockman.h \\\r\nsrc/common/sockman.cpp\r\n```\r\n\r\nThe commit order has been flipped quite a bit because the original PR incrementally pulls logic out of `net` wheras this PR builds a new system from the bottom-up. Otherwise I tried to keep all the `SockMan` code in order so reviewers of the original PR would be familiar with it.\r\n\r\nIt also adds unit tests by introducing a `SocketTestingSetup` which mocks network sockets by returning a queue of `DynSock` from `CreateSock()`. HTTP server tests in #32061 will be rebased on this framework as well.\r\n\r\n",
      "state": "closed",
      "user": "pinheadmz",
      "created_at": "2025-06-13T18:36:49Z",
      "updated_at": "2026-01-15T08:56:02Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32747",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1312,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2696299919,
      "number": 33067,
      "title": "test: refactor mempool_accept_wtxid",
      "body": "This PR improves `mempool_accept_wtxid.py` by using a pre-mined chain instead of generating new blocks, switching to MiniWallet to avoid RPC calls for signing transactions, replacing class `ValidWitnessMalleatedTx `with `valid_witness_malleate_tx() `  function, and simplifying the code by using txid.hex directly. These changes reduce test complexity and improve overall test runtime.\r\n\r\n\r\n",
      "state": "open",
      "user": "naiyoma",
      "created_at": "2025-07-26T00:34:36Z",
      "updated_at": "2026-01-15T07:43:30Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33067",
      "labels": [
        "Refactoring",
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 427,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3154093541,
      "number": 34223,
      "title": "[28.x] Backport wallets directory deletion fixes",
      "body": "Backports #34222 to 28.x",
      "state": "open",
      "user": "achow101",
      "created_at": "2026-01-07T22:03:05Z",
      "updated_at": "2026-01-15T04:03:10Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34223",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 73,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1004149182,
      "number": 25665,
      "title": "refactor: Add util::Result failure types and ability to merge result values",
      "body": "Add `util::Result` support for returning more error information and make use of it in [LoadChainstate method](https://github.com/bitcoin/bitcoin/pull/25665/commits/0263614685582fed2290494f5233dbe038fc350c) as an initial application. Followup PRs [#25722](https://github.com/bitcoin/bitcoin/pull/25722) and [#29700](https://github.com/bitcoin/bitcoin/pull/29700) use it more broadly to return errors and warnings from wallet and kernel functions as well.\r\n\r\nThis change adds two major features to the result class:\r\n\r\n- For better error handling, adds the ability to return a value on failure, not just a value on success. This is a key missing feature that makes the result class not useful for functions like `LoadChainstate()` which produce different errors that need to be handled differently [^1].\r\n\r\n[^1]: Ability to return error values was actually present in the original implementation of [#25218](https://github.com/bitcoin/bitcoin/pull/25218), but unfortunately removed in later iterations. See [design notes](https://github.com/bitcoin-core/bitcoin-devwiki/wiki/util::Result-design-notes).\r\n\r\n- For better error reporting, adds the ability to return warning messages and multiple errors, not just a single error string. This provides a way for functions to report errors and warnings in a standard way, and simplifies interfaces:\r\n\r\n    ```diff\r\n    -virtual std::unique_ptr<Wallet> loadWallet(const std::string& name, bilingual_str& error, std::vector<bilingual_str>& warnings) = 0;\r\n    +virtual util::Result<std::unique_ptr<Wallet>> loadWallet(const std::string& name) = 0;\r\n    ```\r\n\r\n    ```diff\r\n    -std::unique_ptr<WalletDatabase> MakeDatabase(const fs::path& path, const DatabaseOptions& options, DatabaseStatus& status, bilingual_str& error);\r\n    +util::Result<std::unique_ptr<WalletDatabase>, DatabaseError> MakeDatabase(const fs::path& path, const DatabaseOptions& options);\r\n   ```\r\n\r\nThis change also makes some more minor improvements:\r\n\r\n- Smaller type size. `util::Result<int>` is 16 bytes, and `util::Result<void>` is 8 bytes. Previously both were 72 bytes.\r\n\r\n- Broader type compatibility. Supports noncopyable and nonmovable success and error types.\r\n\r\n### Comparison with `std::expected`\r\n\r\nCurrently, the `util::Result` class is useful for error reportingâ€”returning translated, user-facing error stringsâ€”but not as useful for error handling, where callers need structured failure information to decide how to proceed. By contrast, `std::expected` / `util::Expected` (#34005, #34006) is good for error handling but less helpful for reporting. This PR closes the gap between the two classes.\r\n\r\nWith this PR, `std::expected` remains a good choice for lower-level functions or simple functions that fail in only a few well-defined ways. Meanwhile,\r\n\r\n- `Result` becomes a better choice for operations that can fail in many different waysâ€”loading a wallet, connecting a block, etc.â€”where callers may want complete error traces, not just low-level errors without context or high-level errors without detail. (Followup [#25722](https://github.com/bitcoin/bitcoin/pull/25722) applies this to wallet-loading functions.) \r\n- `Result` can also be more useful than `expected` when merging status information from multiple calls. (Followup [#29700](https://github.com/bitcoin/bitcoin/pull/29700) uses this to reliably propagate flush and fatal-error status from validation code that can internally trigger flushes or shutdowns.)\r\n- `Result` may also be a better choice than `std::expected` when returning pointer values. (Followup [#26022](https://github.com/bitcoin/bitcoin/pull/26022) adds a `ResultPtr` specialization that avoids double dereferencing.) \r\n- `Result` can be more efficient than `std::expected` when failures are rare but failure objects are large, since failure values are heap-allocated.\r\n\r\nThis PR effectively makes `Result` a superset of `expected`, making the representations compatible and allowing them to be used together.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2022-07-21T12:46:09Z",
      "updated_at": "2026-01-15T04:01:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/25665",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 4045,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1230883419,
      "number": 27052,
      "title": "test: rpc: add last block announcement time to getpeerinfo result",
      "body": "This PR adds `last_block_announcement` to the per-peer `getpeerinfo` RPC result. This is the most recent time that this peer was the first to notify our node of a new block (one that we didn't already know about), or zero if this peer has never been the first to notify us of a new block. This timestamp already exists internally and is used for stale-tip eviction logic; this PR exposes it at the RPC layer.\r\n\r\nThis PR started out as a suggestion for additional test coverage, see https://github.com/bitcoin/bitcoin/pull/26172#issuecomment-1259678260. It turned out that the easiest way to test (already-merged) #26172 is to add this field to `getpeerinfo` and have a functional test verify its value. But it may also be useful to have this result in its own right, similar to that RPC's existing `last_block` field -- it indicates something about the quality of our peers. It allows one to predict which peer will be evicted when the stale tip logic activates. (I'm not sure if that would be useful, but it may be.)\r\n\r\nThe functional test added here fails without #26172, which is the main goal.\r\n\r\nThis PR does not test the actual stale-tip eviction logic; that's difficult to do with a functional test. But it does test the correctness of the timestamp that the eviction logic depends on. #23352 is an attempt to test the eviction logic using a unit test, it's not ready to be merged yet. I think having both kinds of tests would be beneficial.",
      "state": "open",
      "user": "LarryRuane",
      "created_at": "2023-02-06T18:32:56Z",
      "updated_at": "2026-01-15T03:24:42Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/27052",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1514,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3048643652,
      "number": 33954,
      "title": "test: add functional test for outbound connection management",
      "body": "For #29415, vasild added the possibility to have outbound connections made \"naturally\" by the node using addrman entries, by redirecting them via a SOCKS5 proxy to python p2ps or other full nodes, so that the node under test behaves as if it is connected to normal non-local peers from arbitrary networks, while we have full control over the peers.\r\n\r\nI think this feature is really cool and want to suggest to integrate it more prominently into the test framework (\"`auto_outbound_mode`\") in the first commit because it allows to test the code in which the node decides to make connections - in contrast to the existing `add_outbound_p2p_connection` where the functional test intiates the connections.\r\n\r\nThe second commit uses it to add functional test coverage for the following features of outbound connection management:\r\n- extra full outbound connections due to a stale tip (#11560)\r\n- periodic block-relay-only connections (#19858)\r\n- full outbound connection management with respect to networks (#27213)\r\n\r\nThis should work well with the test from #29415 (which would keep its own `destinations_factory` but can call `_create_auto_outbound_listener` to avoid much of code duplication). \r\n\r\nOther possible uses for `auto_outbound_mode` I could think of are more detailed testing of anchors (`feature_anchors.py`), feeler connections, or any other p2p logic that uses the network of peers.",
      "state": "open",
      "user": "mzumsande",
      "created_at": "2025-11-26T19:01:42Z",
      "updated_at": "2026-01-14T23:11:02Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33954",
      "labels": [
        "Tests",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1456,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2956878299,
      "number": 33728,
      "title": "test: Add bitcoin-chainstate test for assumeutxo functionality",
      "body": "This PR adds functional test coverage for the bitcoin-chainstate tool loading a datadir initialized with an assumeutxo snapshot.\r\n\r\nThe PR also includes:\r\n- Fix for assertion crash in `ChainstateManager::AddChainstate()` when `prev_chainstate` has no initialized mempool (required for the test to pass)\r\n- `-regtest` flag support for bitcoin-chainstate to enable the testing\r\n\r\nThis work started while experimenting with the bitcoin-chainstate tool and how the kernel API (#30595) behaved when loading a datadir containing assumeutxo data, during the time that PR was still under review. sedited suggested opening a PR to add this test coverage.",
      "state": "closed",
      "user": "stringintech",
      "created_at": "2025-10-28T21:44:26Z",
      "updated_at": "2026-01-14T22:30:57Z",
      "merged_at": "2026-01-14T22:30:57Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33728",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 708,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3150717332,
      "number": 34213,
      "title": "net: do not read/dump anchors if network is not active",
      "body": "We currently save 2 block-relay-only (anchor) connections when stopping a node and connect to them right after starting it. However, if you start a node with network disabled (setting -networkactive=0 or disabling using the RPC), it will read the anchors, obviously will not be able to connect to them and then, when stopping the node, considering it will have 0 block-relay-only connections, it will save 0 anchors, basically deleting the previous ones. With this PR, we will only read and write the anchors if the network is active. It will avoid losing the anchors when using the node without network activity and also avoid unecessary actions (like reading the anchors even knowing we have no network activity).",
      "state": "open",
      "user": "brunoerg",
      "created_at": "2026-01-06T21:26:09Z",
      "updated_at": "2026-01-14T22:11:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34213",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 770,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3155796504,
      "number": 34230,
      "title": "fuzz: Reject too large descriptor leaf sizes in scriptpubkeyman target",
      "body": "Accepting \"expensive\" fuzz inputs which have no real use-case is problematic, because it prevents the fuzz engine from spending time on the next useful fuzz input.\r\n\r\nAlso, this may lead to problems, where the fuzz target can not be run at all on some platforms. See https://github.com/bitcoin/bitcoin/issues/34110.\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/34110 by rejecting those useless and expensive inputs (via the third commit)\r\n\r\nCan be tested by running the input and checking the time before and after the changes here:\r\n\r\n```\r\ncurl -fLO 'https://github.com/bitcoin-core/qa-assets/raw/b5ad78e070e4cf36beb415d7b490d948d70ba73f/fuzz_corpora/scriptpubkeyman/1cf91e0c6bfff9dafcd4db5b0ba36b1e906f4cf5'\r\nFUZZ=scriptpubkeyman time ./bld-cmake/bin/fuzz ./1cf91e0c6bfff9dafcd4db5b0ba36b1e906f4cf5\r\n```\r\n\r\nAlso, the second commit fixes https://github.com/bitcoin/bitcoin/issues/31066.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-08T11:23:25Z",
      "updated_at": "2026-01-14T21:35:44Z",
      "merged_at": "2026-01-13T23:28:48Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34230",
      "labels": [
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 964,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2309959380,
      "number": 31774,
      "title": "crypto: Use secure_allocator for `AES256_ctx`",
      "body": "Fixes #31744 \r\n\r\nReuse `secure_allocator` for `AES256_ctx` in the aes 256 encrypters and decrypters and the `iv` of `AES256CBC` encrypters and decrypters. These classes are relevant to `CCrypter`, used for encrypting wallets, and my understanding is that if an attacker knows some or all of the contents of these data structures (`AES256_ctx` & `iv`) they might be able to decrypt a user's wallet.\r\n\r\n Presently the `secure_allocator` tries to protect sensitive data with `mlock()` on POSIX systems and `VirtualLock()` on Windows to prevent memory being paged to disk, and by zero'ing out memory contents on deallocation with `memory_cleanse()` which is similar to `OPENSSL_cleanse()` by scaring compilers away from optimizing `memset` calls on non-Windows systems, and using `SecureZeroMemory()` on Windows.",
      "state": "open",
      "user": "davidgumberg",
      "created_at": "2025-01-31T20:10:56Z",
      "updated_at": "2026-01-14T21:01:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31774",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 854,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3174797474,
      "number": 34289,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "Niharikajakkula",
      "created_at": "2026-01-14T19:54:25Z",
      "updated_at": "2026-01-14T19:54:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34289",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2588407950,
      "number": 32740,
      "title": "refactor: Header sync optimisations & simplifications",
      "body": "This is a partial* revival of #25968\r\n\r\nIt contains a list of most-unrelated simplifications and optimizations to the code merged in #25717:\r\n\r\n- Avoid an IsAncestorOfBestHeaderOrTip call: Just don't call this function when it won't have any effect.\r\n- Compute work from headers without CBlockIndex: Avoid the need to construct a CBlockIndex object just to compute work for a header, when its nBits value suffices for that. Also use some Spans where possible.\r\n- Remove useless CBlock::GetBlockHeader: There is no need for a function to convert a CBlock to a CBlockHeader, as it's a child class of it.\r\n\r\nIt also contains the following code cleanups, which were suggested by reviewers in #25968:\r\n- Remove redundant parameter from CheckHeadersPoW: No need to pass consensusParams, as CheckHeadersPow already has access to m_chainparams.GetConsensus()\r\n- Remove unused parameter in ReportHeadersPresync\r\n- Use initializer list in CompressedHeader, also make GetFullHeader const\r\n- Use reference for chain_start in HeadersSyncState: chain_start can never be null, so it's better to pass it as a reference rather than a raw pointer\r\n\r\n*I decided to leave out three commits that were in #25968 (4e7ac7b94d04e056e9994ed1c8273c52b7b23931, ab52fb4e95aa2732d1a1391331ea01362e035984, 7f1cf440ca1a9c86085716745ca64d3ac26957c0), since they're a bit more involved, and I'm a new contributor. If this PR gets merged, I'll comment under #25968 to note that these three commits are still up for grabs :)\r\n",
      "state": "closed",
      "user": "danielabrozzoni",
      "created_at": "2025-06-12T20:20:06Z",
      "updated_at": "2026-01-14T19:38:45Z",
      "merged_at": "2026-01-14T19:38:44Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32740",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1544,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2461160143,
      "number": 32278,
      "title": "doc: better document NetEventsInterface and the deletion of \"CNode\"s",
      "body": "Document the requirements around the `NetEventsInterface`'s methods and the lifetime of `CNode` objects in `CConnman::m_nodes`.",
      "state": "open",
      "user": "vasild",
      "created_at": "2025-04-15T16:06:05Z",
      "updated_at": "2026-01-14T18:34:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32278",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 196,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2063125967,
      "number": 30861,
      "title": "build: Enhance Ccache performance across worktrees and build trees",
      "body": "To maximize performance, it is essential to follow the [recommendations](https://github.com/bitcoin/bitcoin/blob/master/doc/productivity.md#cache-compilations-with-ccache) in the Productivity Notes: set the `base_dir` Ccache configuration option or use the `CCACHE_BASEDIR` environment variable:\r\n```\r\n$ export CCACHE_BASEDIR=$HOME\r\n```\r\n\r\nHere are examples of usage on Ubuntu 24.04:\r\n\r\n1. Across different worktrees:\r\n```\r\n$ export CCACHE_DIR=$(mktemp -d)\r\n$ git worktree add ../wt_1 4d3f360e2af94f4ed46dc0943196d548da82003e\r\n$ pushd ../wt_1\r\n$ cmake -B build -DWITH_CCACHE=ON\r\n$ cmake --build build -t bitcoind -j $(nproc)\r\n$ popd\r\n$ git worktree add ../wt_2 4d3f360e2af94f4ed46dc0943196d548da82003e\r\n$ pushd ../wt_2\r\n$ cmake -B build -DWITH_CCACHE=ON\r\n$ ccache --zero-stats\r\n$ cmake --build build -t bitcoind -j $(nproc)\r\n$ popd\r\n$ ccache --show-stats\r\nCacheable calls:    302 / 302 (100.0%)\r\n  Hits:             302 / 302 (100.0%)\r\n    Direct:         302 / 302 (100.0%)\r\n    Preprocessed:     0 / 302 ( 0.00%)\r\n  Misses:             0 / 302 ( 0.00%)\r\nLocal storage:\r\n  Cache size (GiB): 0.2 / 5.0 ( 3.31%)\r\n  Hits:             302 / 302 (100.0%)\r\n  Misses:             0 / 302 ( 0.00%)\r\n```\r\n\r\n2. Across different build trees:\r\n```\r\n$ export CCACHE_DIR=$(mktemp -d)\r\n$ cmake -B build_1 -DWITH_CCACHE=ON\r\n$ cmake --build build_1 -t bitcoind -j $(nproc)\r\n$ cmake -B build_2 -DWITH_CCACHE=ON\r\n$ ccache --zero-stats\r\n$ cmake --build build_2 -t bitcoind -j $(nproc)\r\n$ ccache --show-stats\r\nCacheable calls:    302 / 302 (100.0%)\r\n  Hits:             302 / 302 (100.0%)\r\n    Direct:         302 / 302 (100.0%)\r\n    Preprocessed:     0 / 302 ( 0.00%)\r\n  Misses:             0 / 302 ( 0.00%)\r\nLocal storage:\r\n  Cache size (GiB): 0.2 / 5.0 ( 3.31%)\r\n  Hits:             302 / 302 (100.0%)\r\n  Misses:             0 / 302 ( 0.00%)\r\n```\r\n\r\nThis PR addresses this [comment](https://github.com/bitcoin/bitcoin/pull/30811#issuecomment-2331096969):\r\n> However, ccache does _not_ hit across two different build dirs, compiling the same commit.\r\n\r\n---\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/31771.\r\n\r\nForm https://github.com/bitcoin/bitcoin/actions/runs/13215680798/job/36894673006:\r\n```\r\n...\r\nTreat compiler warnings as errors ..... ON\r\nUse ccache for compiling .............. Built-in ccache support for the 'Visual Studio 17 2022' generator is not available.\r\n\r\n\r\n-- Configuring done (300.1s)\r\n-- Generating done (1.2s)\r\n-- Build files have been written to: D:/a/bitcoin/bitcoin/build\r\n```",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2024-09-10T11:56:54Z",
      "updated_at": "2026-01-14T18:10:30Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30861",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2558,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3169448484,
      "number": 34272,
      "title": "psbt: Fix `PSBTInputSignedAndVerified` bounds `assert`",
      "body": "This PR fixes an off-by-one in a debug assertion in `PSBTInputSignedAndVerified`.\r\nThe function indexes `psbt.inputs[input_index]`, so the assertion must not allow indexing at `psbt.inputs.size()`.\r\n\r\nFound during review: https://github.com/bitcoin/bitcoin/pull/31650#discussion_r2685892867\r\n",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2026-01-13T12:01:13Z",
      "updated_at": "2026-01-14T17:27:05Z",
      "merged_at": "2026-01-14T00:24:45Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34272",
      "labels": [
        "Refactoring",
        "PSBT"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 347,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3163213750,
      "number": 34252,
      "title": "doc: add 433 (Pay to Anchor) to bips.md",
      "body": "See PR https://github.com/bitcoin/bips/pull/1982 (merged recently) and #30352 (first released in v28.0).",
      "state": "closed",
      "user": "theStack",
      "created_at": "2026-01-11T13:16:55Z",
      "updated_at": "2026-01-14T17:26:53Z",
      "merged_at": "2026-01-11T22:44:31Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34252",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 144,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3128323880,
      "number": 34145,
      "title": "test: Add unit test for OP_NUMEQUALVERIFY",
      "body": "Add coverage for the error branch of `OP_NUMEQUALVERIFY`: https://github.com/bitcoin/bitcoin/blob/d861c3820528fad2e17a45549bec70b6ba434dcc/src/script/interpreter.cpp#L997\r\n\r\nNote the code coverage miss: https://maflcko.github.io/b-c-cov/total.coverage/src/script/interpreter.cpp.gcov.html (around line 997)\r\n\r\nI ran: `cmake -B build -DENABLE_WALLET=OFF && cmake --build build -j 8 && ctest --test-dir build -j 8`",
      "state": "closed",
      "user": "billymcbip",
      "created_at": "2025-12-24T10:47:53Z",
      "updated_at": "2026-01-14T17:23:50Z",
      "merged_at": "2026-01-14T16:16:04Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34145",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 454,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2882266509,
      "number": 33522,
      "title": "guix: use LIEF 0.17.1",
      "body": "Update LIEF in Guix & the CI to 0.17.1: https://lief.re/doc/stable/changelog.html#october-25th-2025.\r\n\r\nGuix Build:\r\n```bash\r\n64adb8b9b944ef3de68dbe0d8baa45f688b0d3fa0914448ac331a5339575d697  guix-build-98a6d95a0a0a/output/aarch64-linux-gnu/SHA256SUMS.part\r\n704f85c222bfb6bd80f2253d5b9892451f932162377c1ecf7288457ad6c15aba  guix-build-98a6d95a0a0a/output/aarch64-linux-gnu/bitcoin-98a6d95a0a0a-aarch64-linux-gnu-debug.tar.gz\r\n6ab1b8070f3c7addeaee76780cdba27b7ff4c65f6b6fc53402e3863cb94abf77  guix-build-98a6d95a0a0a/output/aarch64-linux-gnu/bitcoin-98a6d95a0a0a-aarch64-linux-gnu.tar.gz\r\n5a8a30b6ea069f61d2f1373217a654f0f8883cd0c291d92837c85259e9552317  guix-build-98a6d95a0a0a/output/arm-linux-gnueabihf/SHA256SUMS.part\r\ncc771236cbd4a013e27a30ea215ea153bbb919862356358431c7aff3789ed745  guix-build-98a6d95a0a0a/output/arm-linux-gnueabihf/bitcoin-98a6d95a0a0a-arm-linux-gnueabihf-debug.tar.gz\r\n1cc32c3d361dc3fd53241c9a5749b27640186310cc74f1646f7c39f2326f4d6b  guix-build-98a6d95a0a0a/output/arm-linux-gnueabihf/bitcoin-98a6d95a0a0a-arm-linux-gnueabihf.tar.gz\r\n765ad83372fde56601c69d582da0e88e6b957e03738c2349a586dc69472a8e80  guix-build-98a6d95a0a0a/output/arm64-apple-darwin/SHA256SUMS.part\r\n4f60db487fa6b53e4876878be0849a207b1a4ccfc31a49a0a2b12c275f15d5db  guix-build-98a6d95a0a0a/output/arm64-apple-darwin/bitcoin-98a6d95a0a0a-arm64-apple-darwin-codesigning.tar.gz\r\n274cd2843ae6518c9ebc4d82e6f1e9038c1057fb923125cc484b88502f0653cc  guix-build-98a6d95a0a0a/output/arm64-apple-darwin/bitcoin-98a6d95a0a0a-arm64-apple-darwin-unsigned.tar.gz\r\nf83f12bb83cbdac89dd5d82ed9888f382506f24e0c5c5d8afaa69ac002a7820c  guix-build-98a6d95a0a0a/output/arm64-apple-darwin/bitcoin-98a6d95a0a0a-arm64-apple-darwin-unsigned.zip\r\n29c30dfc1192cafb34313921aa9329c77358914b1ab5ea6c572afeeb3a0cf791  guix-build-98a6d95a0a0a/output/dist-archive/bitcoin-98a6d95a0a0a.tar.gz\r\nd8b3d18093607cf7e54557d6701b612aea320b12f4c5750278ea8e9df98e84e8  guix-build-98a6d95a0a0a/output/powerpc64-linux-gnu/SHA256SUMS.part\r\n5cafe7a3232a25721bbd6e137327e8885cbc2dde0ad31149210be35ee63940c3  guix-build-98a6d95a0a0a/output/powerpc64-linux-gnu/bitcoin-98a6d95a0a0a-powerpc64-linux-gnu-debug.tar.gz\r\n02adb5302d4ec684e68a18de50f86c7ad7209953c293813b2366eb237290556a  guix-build-98a6d95a0a0a/output/powerpc64-linux-gnu/bitcoin-98a6d95a0a0a-powerpc64-linux-gnu.tar.gz\r\nd1d8a3a48f244095c94c03d541bea04a424b9b419fd46f924309d5a3960a4b9b  guix-build-98a6d95a0a0a/output/riscv64-linux-gnu/SHA256SUMS.part\r\nb94bb2d5ac5cc4d4e39086185d6195caba061a2a2cd783bcefadde3686f011de  guix-build-98a6d95a0a0a/output/riscv64-linux-gnu/bitcoin-98a6d95a0a0a-riscv64-linux-gnu-debug.tar.gz\r\nb372f4fab761e8a2fd3bcf65a53ca3780ba31295fe4e06118ed6c4157cf3b79f  guix-build-98a6d95a0a0a/output/riscv64-linux-gnu/bitcoin-98a6d95a0a0a-riscv64-linux-gnu.tar.gz\r\nb13b8cda5240d0b77acc41c1d313d8935af419179f6e960f574a402812efd73f  guix-build-98a6d95a0a0a/output/x86_64-apple-darwin/SHA256SUMS.part\r\nf093b5db8aefa0d2f5fa9121fdf61679cd3abe0709c888e260f0193c6377ba27  guix-build-98a6d95a0a0a/output/x86_64-apple-darwin/bitcoin-98a6d95a0a0a-x86_64-apple-darwin-codesigning.tar.gz\r\n7cf5b518b4bf11da7f865c72d356869d338054ac450e3d67c8e557d1055b556f  guix-build-98a6d95a0a0a/output/x86_64-apple-darwin/bitcoin-98a6d95a0a0a-x86_64-apple-darwin-unsigned.tar.gz\r\n69e9d0e2b75439ba687bc387002cf9b8d9e634dd1d99d74c0d2105853751214a  guix-build-98a6d95a0a0a/output/x86_64-apple-darwin/bitcoin-98a6d95a0a0a-x86_64-apple-darwin-unsigned.zip\r\n80d12585a20c593c25b389be03abf62c4a7aa64f82a192250e0d7134b8d42ee2  guix-build-98a6d95a0a0a/output/x86_64-linux-gnu/SHA256SUMS.part\r\n18d84260035542953cba39299a6f6a022ff8a652739f9fd4207f0ca8bdeed703  guix-build-98a6d95a0a0a/output/x86_64-linux-gnu/bitcoin-98a6d95a0a0a-x86_64-linux-gnu-debug.tar.gz\r\n32c5fff612ea33ce9b3a79641ba6e228713b6fe546dd1db7c4580b0798282466  guix-build-98a6d95a0a0a/output/x86_64-linux-gnu/bitcoin-98a6d95a0a0a-x86_64-linux-gnu.tar.gz\r\nf1a8d8d8c8271c7c462ff1150c47986a9b55adc701037a178eb065242e3be90f  guix-build-98a6d95a0a0a/output/x86_64-w64-mingw32/SHA256SUMS.part\r\n1959bd2e96784c71f53750a40bc0e2f90c7fe05d3bf3b4090e22b4830763ac00  guix-build-98a6d95a0a0a/output/x86_64-w64-mingw32/bitcoin-98a6d95a0a0a-win64-codesigning.tar.gz\r\n4f299e92122829810d9e75901d689682455a2500329483381524115ef4dc8c99  guix-build-98a6d95a0a0a/output/x86_64-w64-mingw32/bitcoin-98a6d95a0a0a-win64-debug.zip\r\na6864c11dadcdbc91fabec44f6c3fc17928df7c65ee8360254e4a530ce4ba344  guix-build-98a6d95a0a0a/output/x86_64-w64-mingw32/bitcoin-98a6d95a0a0a-win64-setup-unsigned.exe\r\ne5628bbed9444fe1d490688fd993ce65d9af67d584f5371fef0f92f1cc2375ed  guix-build-98a6d95a0a0a/output/x86_64-w64-mingw32/bitcoin-98a6d95a0a0a-win64-unsigned.zip\r\n```",
      "state": "open",
      "user": "fanquake",
      "created_at": "2025-10-02T15:57:55Z",
      "updated_at": "2026-01-14T17:16:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33522",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 4696,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3173931844,
      "number": 34285,
      "title": "ci: Install `pyzmq` for functional tests on Windows",
      "body": "This PR enables `interface_zmq.py` on Windows by installing the required `pyzmq` package.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-01-14T15:23:08Z",
      "updated_at": "2026-01-14T17:02:31Z",
      "merged_at": "2026-01-14T16:52:46Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34285",
      "labels": [
        "Windows",
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 141,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3172818667,
      "number": 34279,
      "title": "test: Fail on self-check warnings in test_runner.py",
      "body": "I don't see a reason to start running the tests, if the test_runner detects warnings during the self-check.\r\n\r\nUsually, this will just lead to a possibly confusing test failure after some wasted time anyway.\r\n\r\nSo just fail fast before even running any tests.\r\n\r\nIf there was a reason to ignore the warnings, a new option could trivially be added:\r\n\r\n```py\r\n    parser.add_argument(\"--ignore-self-check-warnings\", dest=\"ignore_warnings\", default=False, action=\"store_true\",\r\n                        help=\"Ignore test runner warnings about self-checks before running the tests\")\r\n```\r\n\r\nHowever, I don't see the need.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-14T09:50:09Z",
      "updated_at": "2026-01-14T16:42:17Z",
      "merged_at": "2026-01-14T16:28:18Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34279",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 668,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2543342215,
      "number": 32617,
      "title": "[Draft/POC] Add secp256k1-based HPKE (Hybrid Public Key Encryption) For Payjoin v2",
      "body": "This PR introduces an implementation of Hybrid Public Key Encryption (HPKE) using a secp256k1-based Diffie-Hellman KEM (per RFC 9180 and \"secp256k1-based DHKEM for HPKE\" specification). It provides the core cryptographic component needed to enable the Payjoin v2 protocol.\r\n\r\nThis is an exploratory PR intended to kickstart discussion on adding Payjoin v2 support to Bitcoin Core â€“ feedback and reviews are very welcome.\r\n\r\nPayjoin v2 makes use of a protocol called Oblivious HTTP (OHTTP) to strip client-identifying metadata from the request. This protocol use a binary-encoded HTTP message encapsulated through HPKE.\r\n\r\nThe core implementation is contained in the new files `src/dhkem_secp256k1.h` and `src/dhkem_secp256k1.cpp`:\r\n\r\n* Full HPKE Modes: All four HPKE modes are supported â€“ `Base`, `PSK`, `Auth`, and `AuthPSK`.\r\n* Secp256k1 DHKEM: Uses secp256k1 for Diffie-Hellman key exchange. The `Encap()` and `Decap()` functions perform the base mode KEM (ephemeral ECDH using the receiverâ€™s public key), while `AuthEncap()` and `AuthDecap()` extend this to authenticated mode (including the senderâ€™s static key in the shared secret derivation). Internally, the shared secret is derived as specified by HPKE using HKDF (SHA256) extraction and expansion.\r\n* Key Schedule & Nonce Derivation: After KEM, the implementation runs the HPKE key schedule to derive the `encryption key`, `base nonce`, and `exporter secret`. It follows RFC 9180 Â§7.1, hashing the `info` and `psk_id` contexts and deriving the AEAD key and nonce. Per-message nonces are computed by XOR-ing the base nonce with a message sequence number as specified in RFC 9180 Â§5.2.\r\n* AEAD Encryption (ChaCha20-Poly1305): The HPKE context uses `ChaCha20-Poly1305` as the authenticated encryption scheme. The code provides `Seal()` and `Open()` functions to encrypt and decrypt data using the derived context key and a given nonce. It uses Bitcoin Coreâ€™s existing ChaCha20Poly1305 implementation.\r\n\r\nThe test file validates all the functions mentioned above: Encapsulation/Decapsulation, Encryption/Decryption, Nonce and Key Schedule Logic. This uses the PDK (Payjoin Dev Kit) test vectors. The tests also show how to use the HPKE functions.\r\n\r\nThis implementation only uses HKDF-SHA256 as Key Derivation Functions and ChaCha20-Poly1305 as AEAD, since these already exist in the Bitcoin Core codebase. It does not support other KDFs (such as HKDF-SHA384 and HKDF-SHA512) or other AEADs (such as AES-128-GCM and AES-256-GCM).\r\n\r\nTo run the tests:\r\n`build/bin/test_bitcoin --log_level=all --run_test=dhkem_secp256k1_tests`",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2025-05-26T08:04:21Z",
      "updated_at": "2026-01-14T16:38:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32617",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2664,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 877751403,
      "number": 24539,
      "title": "Add a \"tx output spender\" index",
      "body": "This PR adds a new \"tx output spender\" index, which allows users to query which tx spent a given outpoint with the `gettxspendingprevout` RPC call that was added by https://github.com/bitcoin/bitcoin/pull/24408.\r\n\r\nSuch an index would be extremely useful for Lightning, and probably for most layer-2 protocols that rely on chains of unpublished transactions.\r\n\r\nUPDATE: this PR is ready for review and issues have been addressed:\r\n- using a watch-only wallet instead would not work if there is a significant number of outpoints to watch (see https://github.com/bitcoin/bitcoin/pull/24539#issuecomment-1276595646)\r\n- this PR does not require `-txindex` anymore\r\n\r\nWe use a composite key with 2 parts (suggested by @romanz): hash(spent outpoint) and tx position, with an empty value. Average composite key size is 15 bytes.\r\n\r\nThe spending tx can optionally be returned by `gettxspendingprevout` (even it `-txindex is not set`).",
      "state": "open",
      "user": "sstone",
      "created_at": "2022-03-11T19:32:41Z",
      "updated_at": "2026-01-14T15:20:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/24539",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 958,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3118113953,
      "number": 34117,
      "title": "net: reduce log level for PCP/NAT-PMP NOT_AUTHORIZED failures",
      "body": "Users running Bitcoin Core on home networks with routers that don't support PCP (Port Control Protocol) or NAT-PMP port mapping receive frequent warning-level log messages every few minutes:\r\n\r\n  \"pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\"\r\n\r\nThis is expected behavior for many consumer routers that have PCP disabled by default, not an actionable error. The repeated warnings create unnecessary log noise.\r\n\r\nThis change:\r\n- Adds explicit constants for NOT_AUTHORIZED result code (value 2) for both NAT-PMP and PCP protocols\r\n- Downgrades NOT_AUTHORIZED failures from LogWarning to LogDebug since this is an expected condition on many networks\r\n- Keeps LogWarning for other failure types that may indicate actual configuration or network issues\r\n\r\nThe NOT_AUTHORIZED message will still be visible when running with -debug=net for users who need to troubleshoot port mapping issues.\r\n\r\nFixes #34114\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "closed",
      "user": "ANAVHEOBA",
      "created_at": "2025-12-19T16:35:45Z",
      "updated_at": "2026-01-14T15:11:05Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34117",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 3040,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3113678434,
      "number": 34100,
      "title": "doc: Use multipath descriptors in descriptors.md and linked test",
      "body": "Updates documentation and `wallet_miniscript_decaying_multisig_descriptor_psbt.py` to use single multipath descriptors with `<0;1>` syntax instead of separate external/internal descriptors.\n\n## Changes\n- **doc/descriptors.md**: Update examples (lines 70-71) to use `/<0;1>/*` multipath syntax\n- **doc/descriptors.md**: Update Basic Multisig Example instructions (line 179) to use single multipath descriptor\n- **test/functional/wallet_miniscript_decaying_multisig_descriptor_psbt.py**: Refactor to use single multipath descriptor pattern matching `wallet_multisig_descriptor_psbt.py`\n\n## Implementation\n- `_get_xpub()` now extracts external descriptor and converts to multipath format\n- `create_multisig()` imports single descriptor that expands to receive and change addresses\n- Removed fake checksums from documentation examples\n- Added clear comments documenting multipath convention\n\nFixes #34086",
      "state": "open",
      "user": "anuragchvn-blip",
      "created_at": "2025-12-18T12:59:17Z",
      "updated_at": "2026-01-14T15:08:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34100",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 965,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2713577873,
      "number": 33117,
      "title": "Interfaces: Expose UTXO Snapshot Loading and Add Progress Notifications",
      "body": "# Add UTXO Snapshot Loading Interface and Progress Notifications\r\n\r\nThis PR implements a complete interface for loading UTXO snapshots through the GUI, including progress notifications to provide user feedback during the loading process.\r\n\r\n---\r\n\r\n## Changes\r\n\r\n### Commit 1: `interfaces: expose UTXO snapshot loading in node interface`\r\n\r\n- Added a new virtual method `loadSnapshot` to the node interface for loading UTXO snapshots.\r\n- Updated the implementation in `interfaces.cpp` to activate the snapshot using the provided file and metadata.\r\n- This change enhances the user's ability to load UTXO snapshots through the GUI.\r\n\r\n### Commit 2: `notifications: Implement snapshot load progress notifications`\r\n\r\n- Added a new signal `SnapshotLoadProgress` for snapshot load progress in the UI interface.\r\n- Updated the notifications interface to include a method for reporting snapshot loading progress.\r\n- Enhanced the `ChainstateManager` to report progress during snapshot loading.\r\n- Implemented the necessary handler in the kernel notifications to relay progress updates.\r\n- This change improves user feedback during the snapshot loading process.\r\n\r\n### Commit 3: `rpc: refactor loadtxoutset to use snapshot interface`\r\n\r\n- Updated the loadtxoutset RPC to call the new snapshot interface instead of directly working with chainstate internals.\r\n- Added getMetadata and getActivationResult methods to the snapshot interface to provide parity with the legacy RPC.\r\n- Improves modularity by consolidating snapshot handling through the interface layer.\r\n\r\n---\r\n\r\n## Technical Details\r\n\r\nThe implementation includes:\r\n\r\n- **UI Interface Enhancement**\r\n  Added `SnapshotLoadProgress` signal to `CClientUIInterface` with corresponding signal declaration and implementation.\r\n\r\n- **Node Interface**\r\n  Added `loadSnapshot` virtual method to the node interface with implementation in `interfaces.cpp`.\r\n\r\n- **Progress Notifications**\r\n  Implemented `snapshotLoadProgress` method in `KernelNotifications` class to relay progress updates to the UI.\r\n\r\n- **Base Interface**\r\n  Added `snapshotLoadProgress` virtual method to the kernel notifications interface.\r\n\r\n---\r\n\r\n## Benefits\r\n\r\n- **User Experience**\r\n  Provides real-time feedback during UTXO snapshot loading operations.\r\n\r\n- **GUI Integration**\r\n  Enables loading UTXO snapshots directly through the Bitcoin Core GUI.\r\n\r\n- **Progress Tracking**\r\n  Users can monitor the progress of snapshot loading operations.\r\n\r\n- **Consistent Interface**\r\n  Follows the existing pattern for progress notifications in the codebase.\r\n\r\n## Testing\r\n\r\n- **Daemon** build and launch `bitcoind` then with `bitcoin-cli` load a snapshot using:\r\n```bash\r\n./bitcoin-cli -rpcclienttimeout=0 -signet loadtxoutset /path/to/utxo-snapsshot.dat\r\n```\r\n- **QT Widgets**: build and run [this](https://github.com/bitcoin-core/gui/pull/870) draft PR in legacy gui repo \r\n- **QML** version: for a modern look build and run [this](https://github.com/bitcoin-core/gui-qml/pull/488) PR in the newly updated gui-qml repo \r\n",
      "state": "open",
      "user": "D33r-Gee",
      "created_at": "2025-08-01T15:31:46Z",
      "updated_at": "2026-01-14T14:52:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33117",
      "labels": [
        "interfaces"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 3107,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3160080067,
      "number": 34240,
      "title": "ci: Run feature_unsupported_utxo_db.py on Windows",
      "body": "The feature_unsupported_utxo_db.py test is skipped on Windows, because the ancient exe used in the test does not support UTF-8.\r\n\r\nOne way to fix this could be to rework the test_runner to supply an ASCII temp dir. However, this is tedious and probably not worth it for a test that is close to being deleted: The test only checks that a `-reindex-chainstate` is sufficient, but at this point, it seems fine to accept users having to go through a full `-reindex`, or even full re-download.\r\n\r\nI am not deleting it just yet, because it is still minimally useful: E.g. https://github.com/bitcoin/bitcoin/pull/31674#issuecomment-2599106040. Though, I think the next time an issue pops up with this test, it can be considered for deletion.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-09T15:45:36Z",
      "updated_at": "2026-01-14T14:26:48Z",
      "merged_at": "2026-01-14T12:08:03Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34240",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 784,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3118009680,
      "number": 34116,
      "title": "cmake: Fix debugging info",
      "body": "https://github.com/bitcoin/bitcoin/pull/30811 was intended to address https://github.com/bitcoin/bitcoin/issues/30799. However, it introduced several unforeseen consequences, including https://github.com/bitcoin/bitcoin/issues/31957 and https://github.com/bitcoin/bitcoin/issues/31204.\r\n\r\nThis PR takes an alternative approach to resolving https://github.com/bitcoin/bitcoin/pull/30799 and reverts https://github.com/bitcoin/bitcoin/pull/30811.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-12-19T15:57:19Z",
      "updated_at": "2026-01-14T13:17:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34116",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 470,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2318382567,
      "number": 31807,
      "title": "kernel: Avoid duplicating symbols in the kernel and downstream users",
      "body": "The possibility of this happening came up in the discussion here: https://github.com/bitcoin/bitcoin/pull/31158#issuecomment-2635223309, and it turned that we already had a case of it in our code.\r\n\r\ntl;dr: Certain symbols when defined in headers may end up existing in both the shared lib and the application using it, leading to subtle bugs. More info can be found [here](https://www.mail-archive.com/cfe-commits@lists.llvm.org/msg503669.html).\r\n\r\nThe solution is generally to avoid defining static/inline vars in headers if they aren't meant to be shared with downstream kernel users.\r\n\r\nClang has recently added a warning for this (see link above), so this PR enables that too. It adds a new place to specify warnings which only apply to the kernel. In this case, it's warnings that only apply to shared libs. But I can also imagine wanting to enable more aggressive warnings for the kernel than the rest of the code.\r\n\r\nThe warning is only enabled by clang 21 (which is not yet released), and only useful when our [kernel symbol visibility hack](https://github.com/bitcoin/bitcoin/blob/master/src/kernel/CMakeLists.txt#L100) is disabled, which we can't do yet. So it's mostly a placeholder for the future. In the meantime it can be used manually by building clang from git and disabling our hack, which I've done, and can confirm that after this change there are no more warnings.",
      "state": "open",
      "user": "theuni",
      "created_at": "2025-02-05T19:32:42Z",
      "updated_at": "2026-01-14T13:12:18Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31807",
      "labels": [
        "Build system",
        "Validation",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1454,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3113555305,
      "number": 34099,
      "title": "test: Improve code coverage for pubkey checks",
      "body": "Cover these branches in `IsCompressedOrUncompressedPubKey` and `IsCompressedPubKey`:\r\n- `Non-canonical public key: invalid length for uncompressed key`\r\n- `Non-canonical public key: invalid length for compressed key`\r\n- `Non-canonical public key: invalid prefix for compressed key`\r\n\r\nSee the missed branches here: https://maflcko.github.io/b-c-cov/total.coverage/src/script/interpreter.cpp.gcov.html\r\n\r\n`script_tests` succeed on my end.",
      "state": "closed",
      "user": "billymcbip",
      "created_at": "2025-12-18T12:25:49Z",
      "updated_at": "2026-01-14T13:05:46Z",
      "merged_at": "2026-01-13T23:24:38Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34099",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 483,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3125987114,
      "number": 34142,
      "title": "policy: Check Taproot control block size correctly in `IsWitnessStandard`",
      "body": "I'd like to improve the Taproot [control size check](https://github.com/bitcoin/bitcoin/blob/d861c3820528fad2e17a45549bec70b6ba434dcc/src/policy/policy.cpp#L321) in `IsWitnessStandard`. Rather than just checking emptiness, we should perform all three checks implemented in `VerifyTaprootControlBlockSize` (see below). This way we can invalidate the transaction earlier when it's clear that the control size is incompatible with consensus rules (saving compute).\r\n\r\nOld checks:\r\n-  `control.size() > 0`\r\n\r\nNew checks:\r\n- `control.size() >= TAPROOT_CONTROL_BASE_SIZE`\r\n- `control.size() <= TAPROOT_CONTROL_MAX_SIZE`\r\n- `(control.size() - TAPROOT_CONTROL_BASE_SIZE) % TAPROOT_CONTROL_NODE_SIZE == 0`\r\n\r\nFor example, a single byte control block wouldn't be empty, but it would be invalid because it's shorter than `TAPROOT_CONTROL_BASE_SIZE` (33). `IsWitnessStandard` should return false in that case.\r\n\r\nThis PR also adds a helper function for the control block size check to reduce repetition and to improve readability of the (rather heavy) functions that call it. We have four instances of the same check.\r\n\r\nI ran:\r\n`cmake -B build -DENABLE_WALLET=OFF && cmake --build build -j 8 && ctest --test-dir build -j 8`\r\n\r\nLooking forward to your feedback.",
      "state": "open",
      "user": "billymcbip",
      "created_at": "2025-12-23T12:43:00Z",
      "updated_at": "2026-01-14T12:53:59Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34142",
      "labels": [
        "TX fees and policy"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1323,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3169202433,
      "number": 34270,
      "title": "[28.x] Backports",
      "body": "Backports:\r\n* #33723\r\n* #34227",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-01-13T10:41:53Z",
      "updated_at": "2026-01-14T12:01:00Z",
      "merged_at": "2026-01-14T12:00:23Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34270",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 47,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3160217990,
      "number": 34241,
      "title": "test: Check that interrupt results in EXIT_SUCCESS",
      "body": "This is a test for https://github.com/bitcoin/bitcoin/pull/34224. The test can be tested by reverting that pull request and observing the test failure.\r\n\r\n\r\nAlso, includes a small test cleanup/refactor.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-09T16:30:25Z",
      "updated_at": "2026-01-14T11:11:59Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34241",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 253,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1571888838,
      "number": 28724,
      "title": "wallet: Cleanup accidental encryption keys in watchonly wallets",
      "body": "An earlier version allowed users to create watchonly wallets (wallets without private keys) that were \"encrypted\". Such wallets would have a stored encryption keys, but nothing would actually be encrypted with them. This can cause unexpected behavior such as https://github.com/bitcoin-core/gui/issues/772.\r\n\r\nWe can detect such wallets as they will have the disable private keys flag set, no encrypted keys, and encryption keys. For such wallets, we can remove those encryption keys thereby avoiding any issues that may result from this unexpected situation.",
      "state": "closed",
      "user": "achow101",
      "created_at": "2023-10-24T23:02:08Z",
      "updated_at": "2026-01-14T10:53:41Z",
      "merged_at": "2025-01-10T15:30:07Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28724",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 623,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2268130280,
      "number": 31625,
      "title": "miner: always treat SegWit as active",
      "body": "The `getblocktemplate` RPC would check if SegWit has activated yet at the tip. This has been the case for more than seven years.",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2025-01-09T11:16:37Z",
      "updated_at": "2026-01-14T10:53:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31625",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 165,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1829527835,
      "number": 29904,
      "title": "refactor: Use our own implementation of urlDecode",
      "body": "Fixes #29654 (as a side-effect)\r\n\r\nRemoving dependencies is a general goal of the project and the xz backdoor has been an additional wake up call recently. Libevent shows many of the same symptoms, few maintainers and slow releases. While libevent can not be removed completely over night we should start removing itâ€™s usage where it's possible, ideally with the end goal to removing it completely.\r\n\r\nThis is a pretty easy win in that direction. The [`evhttp_uridecode` function from libevent](https://github.com/libevent/libevent/blob/e0a4574ba2cbcdb64bb2b593e72be7f7f4010746/http.c#L3542) we were using in `urlDecode` could be easily emulated in fewer LOC. This also ports the [applicable test vectors over from libevent](https://github.com/libevent/libevent/blob/master/test/regress_http.c#L3430).",
      "state": "closed",
      "user": "fjahr",
      "created_at": "2024-04-18T13:06:19Z",
      "updated_at": "2026-01-14T10:53:40Z",
      "merged_at": "2024-04-25T17:06:27Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29904",
      "labels": [
        "Refactoring",
        "Wallet",
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 851,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2269062036,
      "number": 31630,
      "title": "doc: Archive 28.1 release notes",
      "body": "",
      "state": "closed",
      "user": "achow101",
      "created_at": "2025-01-09T19:05:44Z",
      "updated_at": "2026-01-14T10:53:39Z",
      "merged_at": "2025-01-14T21:06:48Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31630",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 32,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2388629186,
      "number": 32043,
      "title": "[IBD] Tracking PR for speeding up Initial Block Download",
      "body": "During the last Core Dev meeting, it was proposed to create a tracking PR aggregating the individual IBD optimizations - to illustrate how these changes contribute to the broader performance improvement efforts.\r\n\r\n## Summary: **>20%** full IBD speedup\r\nWe don't have many low-hanging fruits anymore, but big speed improvements can also be achieved by many small, focused changes.\r\nMany optimization opportunities are hiding in consensus critical code - this tracking PR provides justification for why those should also be considered.\r\nThe unmerged changes here collectively achieve a **>20%** speedup for full IBD (measured by multiple real runs until 886'000 blocks using 5GiB in-memory cache): from **8.59 hours** on master to **7.25 hours** for the PR.\r\n\r\nAnyone can (and is encouraged to) reproduce the results by following this guide: https://gist.github.com/l0rinc/83d2bdfce378ad7396610095ceb7bed5\r\n\r\n## Related issues:\r\n* https://github.com/bitcoin/bitcoin/issues/32832\r\n* https://github.com/bitcoin/bitcoin/issues/31494\r\n\r\n## PRs included here (in review priority order):\r\n* [x] https://github.com/bitcoin/bitcoin/pull/31490\r\n* [x] https://github.com/bitcoin/bitcoin/pull/31551\r\n* [x] https://github.com/bitcoin/bitcoin/pull/32487\r\n* [x] https://github.com/bitcoin/bitcoin/pull/31144\r\n* [x] https://github.com/bitcoin/bitcoin/pull/32827\r\n* [x] https://github.com/bitcoin/bitcoin/pull/32279\r\n* [x] https://github.com/bitcoin/bitcoin/pull/31645\r\n* [x] https://github.com/bitcoin/bitcoin/pull/33602\r\n* [x] https://github.com/bitcoin/bitcoin/pull/30442\r\n* [ ] https://github.com/bitcoin/bitcoin/pull/32497\r\n* [ ] https://github.com/bitcoin/bitcoin/pull/31132\r\n* [ ] https://github.com/bitcoin/bitcoin/pull/31682\r\n* [ ] https://github.com/bitcoin/bitcoin/pull/31868\r\n\r\n## Changing trends\r\nThe UTXO count and average block size have drastically increased in the past few years, providing a better overall picture of how Bitcoin behaves under real load.\r\n[<img width=\"500\" alt=\"image\" src=\"https://github.com/user-attachments/assets/d257b864-d9de-4f9d-b61b-acc6835f384f\" />](https://www.blockchain.com/explorer/charts/avg-block-size)\r\nProfiling IBD, given these circumstances, revealed many new optimization opportunities.\r\n\r\n## Similar efforts in the past years\r\n\r\nThere were many efforts to make sure Bitcoin Core remains performant in light of these new trends, a few recent notable examples include:\r\n* https://github.com/bitcoin/bitcoin/pull/25325 - use specialized pool allocator for in-memory cache (~21% faster IBD)\r\n* https://github.com/bitcoin/bitcoin/pull/28358 - allow the full UTXO set to fit into memory\r\n* https://github.com/bitcoin/bitcoin/pull/28280#issuecomment-2273368482 - fine-grained in-memory cache eviction for pruned nodes (~30% IBD speedup on pruned nodes)\r\n* https://github.com/bitcoin/bitcoin/pull/30039#issuecomment-2397229720 - reduce LevelDB writes, compactions and open files (~30% faster IBD for small in-memory cache)\r\n* https://github.com/bitcoin/bitcoin/pull/31490, https://github.com/bitcoin/bitcoin/pull/30849, https://github.com/bitcoin/bitcoin/pull/30906 - refactors derisking/enabling follow-up optimizations\r\n* https://github.com/bitcoin/bitcoin/pull/30326 - favor the happy path for cache misses (~2% IBD speedup)\r\n* https://github.com/bitcoin/bitcoin/pull/30884 - Windows regression fix\r\n\r\n## Reliable macro benchmarks\r\n\r\nThe measurements here were done on a high-end Intel i9-9900K CPU (8 cores/16 threads, 3.6GHz base, 5.0GHz boost), 64GB RAM, and a RAID configuration with multiple NVMe drives (total ~1.4TB fast storage), a dedicated Hetzner Auction box running latest Ubuntu. Sometimes a lower-end i7 was used with an HDD for comparison.\r\n\r\nTo make sure the setup reflected a real user's experience, we ran multiple full IBDs per commit (connecting to real nodes), until block 886'000 with a 5GiB in-memory cache where hyperfine was used to measure the final time (assuming normal distribution, stabilizing the final result via statistical methods), producing reliable results even when individual measurements varied (when hyperfine indicated that the measurements were all over the place we reran the whole benchmark).\r\nTo reduce the instability of headers synchronization and peer acquisition, we first started `bitcoind` until block 1, followed by the actual benchmarks until block 886'000.\r\n\r\nThe top 2 PRs (https://github.com/bitcoin/bitcoin/pull/31551 and https://github.com/bitcoin/bitcoin/pull/31144) were measured together by multiple people with different settings (and varying results):\r\n* @andrewtoth in https://github.com/bitcoin/bitcoin/pull/31144#issuecomment-2585403343 - 9% speedup with GCC\r\n* @hodlinator in https://github.com/bitcoin/bitcoin/pull/31144#issuecomment-2588220255 - 11.9% speedup with GCC\r\n* @mlori in https://github.com/bitcoin/bitcoin/pull/31144#issuecomment-2664077362 - 12% faster with GCC\r\n* @Sjors in https://github.com/bitcoin/bitcoin/pull/31144#issuecomment-2575279833 - 3% speedup with Clang\r\n\r\nAlso note that there is a separate effort to [add a reliable macro-benchmarking suite](https://github.com/bitcoin/bitcoin/pull/31996) to track the performance of the most critical usecases end-to-end (including IBD, compact blocks, UTXO iteration) - still WIP, not yet used here.\r\n\r\n## Current changes (in order of importance, reviews and reproducers are welcome):\r\n\r\nPlotting the performance of the blocks from the produced `debug.log` files (taken from the last run for each commit - can differ slightly from the normalized average shown below) visualizing the effect of each commit:\r\n\r\n<details>\r\n<summary>debug.log visualizer</summary>\r\n\r\n```python\r\nimport os\r\nimport sys\r\nimport re\r\nfrom datetime import datetime\r\nimport matplotlib.pyplot as plt\r\nimport numpy as np\r\n\r\n\r\ndef process_log_files_and_plot(log_dir, output_file=\"block_height_progress.png\"):\r\n    if not os.path.exists(log_dir) or not os.path.isdir(log_dir):\r\n        print(f\"Error: '{log_dir}' is not a valid directory\", file=sys.stderr)\r\n        return\r\n\r\n    debug_files = [f for f in os.listdir(log_dir) if\r\n                   f.startswith('debug-') and os.path.isfile(os.path.join(log_dir, f))]\r\n    if not debug_files:\r\n        print(f\"Warning: No debug files found in '{log_dir}'\", file=sys.stderr)\r\n        return\r\n\r\n    height_pattern = re.compile(r'UpdateTip:.*height=(\\d+)')\r\n    results = {}\r\n\r\n    for filename in debug_files:\r\n        filepath = os.path.join(log_dir, filename)\r\n        print(f\"Processing {filename}...\", file=sys.stderr)\r\n\r\n        update_tips = []\r\n        first_timestamp = None\r\n        line_count = tip_count = 0\r\n        found_shutdown_done = False\r\n\r\n        try:\r\n            with open(filepath, 'r', errors='ignore') as file:\r\n                for line_number, line in enumerate(file, 1):\r\n                    line_count += 1\r\n                    if line_count % 100000 == 0:\r\n                        print(f\"  Processed {line_count} lines, found {tip_count} UpdateTips...\", file=sys.stderr)\r\n\r\n                    if not found_shutdown_done:\r\n                        if \"Shutdown: done\" in line:\r\n                            found_shutdown_done = True\r\n                            print(f\"  Found 'Shutdown: done' at line {line_number}, starting to record\",\r\n                                  file=sys.stderr)\r\n                        continue\r\n\r\n                    if len(line) < 20 or \"UpdateTip:\" not in line:\r\n                        continue\r\n\r\n                    try:\r\n                        timestamp = datetime.strptime(line[:20], \"%Y-%m-%dT%H:%M:%SZ\")\r\n                        height_match = height_pattern.search(line)\r\n                        if not height_match:\r\n                            continue\r\n\r\n                        height = int(height_match.group(1))\r\n                        if first_timestamp is None:\r\n                            first_timestamp = timestamp\r\n\r\n                        update_tips.append((int((timestamp - first_timestamp).total_seconds()), height))\r\n                        tip_count += 1\r\n                    except ValueError:\r\n                        continue\r\n        except Exception as e:\r\n            print(f\"Error processing {filename}: {e}\", file=sys.stderr)\r\n            continue\r\n\r\n        print(f\"Finished processing {filename}: {line_count} lines, {tip_count} UpdateTips\", file=sys.stderr)\r\n\r\n        if update_tips:\r\n            time_dict = {}\r\n            for time, height in update_tips:\r\n                time_dict[time] = height\r\n            results[filename[6:14]] = sorted(time_dict.items())\r\n\r\n    if not results:\r\n        print(\"No valid data found in any files.\", file=sys.stderr)\r\n        return\r\n\r\n    print(f\"Creating plots with data from {len(results)} files\", file=sys.stderr)\r\n\r\n    sorted_results = []\r\n    for name, pairs in results.items():\r\n        if pairs:\r\n            sorted_results.append((name, pairs[-1][0] / 3600, pairs))\r\n\r\n    sorted_results.sort(key=lambda x: x[1], reverse=True)\r\n    colors = plt.cm.tab10(np.linspace(0, 1, len(sorted_results)))\r\n\r\n    # Plot 1: Height vs Time\r\n    plt.figure(figsize=(12, 8))\r\n\r\n    final_points = []\r\n    for idx, (name, last_time, pairs) in enumerate(sorted_results):\r\n        times = [t / 3600 for t, _ in pairs]\r\n        heights = [h for _, h in pairs]\r\n        plt.plot(heights, times, label=f\"{name} ({last_time:.2f}h)\", color=colors[idx], linewidth=1)\r\n        if pairs:\r\n            final_points.append((last_time, pairs[-1][1], colors[idx]))\r\n\r\n    for time, height, color in final_points:\r\n        plt.axhline(y=time, color=color, linestyle='--', alpha=0.3)\r\n        plt.axvline(x=height, color=color, linestyle='--', alpha=0.3)\r\n\r\n    plt.title('Sync Time by Block Height')\r\n    plt.xlabel('Block Height')\r\n    plt.ylabel('Elapsed Time (hours)')\r\n    plt.grid(True, linestyle='--', alpha=0.7)\r\n    plt.legend(loc='center left')\r\n    plt.tight_layout()\r\n\r\n    plt.savefig(output_file.replace('.png', '_reversed.png'), dpi=300)\r\n\r\n    # Plot 2: Performance Ratio by Time\r\n    if len(sorted_results) > 1:\r\n        plt.figure(figsize=(12, 8))\r\n\r\n        baseline = sorted_results[0]\r\n        baseline_time_by_height = {h: t for t, h in baseline[2]}\r\n\r\n        for idx, (name, _, pairs) in enumerate(sorted_results[1:], 1):\r\n            time_by_height = {h: t for t, h in pairs}\r\n\r\n            common_heights = [h for h in baseline_time_by_height.keys()\r\n                              if h >= 400000 and h in time_by_height]\r\n            common_heights.sort()\r\n\r\n            ratios = []\r\n            base_times = []\r\n\r\n            for h in common_heights:\r\n                base_t = baseline_time_by_height[h]\r\n                result_t = time_by_height[h]\r\n\r\n                if result_t > 0:\r\n                    ratios.append(base_t / result_t)\r\n                    base_times.append(base_t / 3600)\r\n\r\n            plt.plot(base_times, ratios,\r\n                     label=f\"{name} vs {baseline[0]}\",\r\n                     color=colors[idx], linewidth=1)\r\n\r\n        plt.axhline(y=1, color='gray', linestyle='--', alpha=0.7)\r\n\r\n        plt.title('Performance Improvement Over Time (Higher is Better)')\r\n        plt.xlabel('Baseline Elapsed Time (hours)')\r\n        plt.ylabel('Speedup Ratio (baseline_time / commit_time)')\r\n        plt.grid(True, linestyle='--', alpha=0.7)\r\n        plt.legend(loc='best')\r\n        plt.tight_layout()\r\n\r\n        plt.savefig(output_file.replace('.png', '_time_ratio.png'), dpi=300)\r\n\r\n    with open(output_file.replace('.png', '.csv'), 'w') as f:\r\n        for name, _, pairs in sorted_results:\r\n            f.write(f\"{name},{','.join(f'{t}:{h}' for t, h in pairs)}\\n\")\r\n\r\n    plt.show()\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    log_dir = sys.argv[1] if len(sys.argv) > 1 else \".\"\r\n    output_file = sys.argv[2] if len(sys.argv) > 2 else \"block_height_progress.png\"\r\n    process_log_files_and_plot(log_dir, output_file)\r\n\r\n```\r\n\r\n</details>\r\n\r\n<img width=\"1000\" alt=\"image\" src=\"https://github.com/user-attachments/assets/a43b43da-209c-4736-b1ef-d4d57f838d74\" />\r\n\r\n\r\n<img width=\"1000\" alt=\"image\" src=\"https://github.com/user-attachments/assets/2d43d867-0c9e-4daf-9d47-bd1148c48b55\" />\r\n\r\n\r\n### Baseline\r\nBase commit was 88debb3e42.\r\n\r\n<details>\r\n<summary>8.59 hour IBD time</summary>\r\n\r\n```bash\r\nCOMPILER=gcc COMMIT=88debb3e4297ef4ebc8966ffe599359bc7b231d0 ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=886000 -dbcache=5000 -blocksonly -printtoconsole=0\r\n  Time (mean Â± Ïƒ):     30932.610 s Â± 156.891 s    [User: 58248.505 s, System: 2142.974 s]\r\n  Range (min â€¦ max):   30821.671 s â€¦ 31043.549 s    2 runs\r\n  ```\r\n\r\n</details>\r\n\r\n-----\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/31551\r\n\r\n<details>\r\n<summary>7.91 hour IBD time</summary>\r\n\r\n```bash\r\nCOMPILER=gcc COMMIT=6a8ce46e32dae2ffef2a73d2314ca33a2039186e ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=886000 -dbcache=5000 -blocksonly -printtoconsole=0\r\n  Time (mean Â± Ïƒ):     28501.588 s Â± 119.886 s    [User: 56419.060 s, System: 1833.126 s]\r\n  Range (min â€¦ max):   28416.815 s â€¦ 28586.361 s    2 runs\r\n```\r\n\r\nWe can serialize the blocks and undos to any `Stream` which implements the appropriate read/write methods.\r\n`AutoFile` is one of these, writing the results \"directly\" to disk (through the OS file cache). Batching these in memory first and reading/writing these to disk is measurably faster (likely because of fewer native fread calls or less locking, as [observed](https://github.com/bitcoin/bitcoin/pull/28226#issuecomment-1666842501) by @martinus in a similar change).\r\n\r\nDifferential flame graphs indicate that the before/after speed change is because of fewer `AutoFile` reads and writes:\r\n![writes](https://github.com/user-attachments/assets/c5e45ddf-3a94-4c5b-999a-94a139d5776d)\r\n![reads](https://github.com/user-attachments/assets/f11982ea-f2dc-4fc6-afce-faa132724658)\r\n</details>\r\n\r\n-----\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/31144\r\n\r\n<details>\r\n<summary>7.60 hour IBD time</summary>\r\n\r\n```bash\r\nCOMPILER=gcc COMMIT=c5cc54d10187c9cb3a6cba8cc10f652b4f882e2a ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=886000 -dbcache=5000 -blocksonly -printtoconsole=0\r\n  Time (mean Â± Ïƒ):     27394.210 s Â± 565.877 s    [User: 54902.315 s, System: 1891.951 s]\r\n  Range (min â€¦ max):   26994.075 s â€¦ 27794.346 s    2 runs\r\n```\r\n</details>\r\n\r\nCurrent block obfuscations are done byte-by-byte, this PR batches them to 64 bit primitives to speed up obfuscating bigger memory batches.\r\nThis is especially relevant after https://github.com/bitcoin/bitcoin/pull/31551 where we end up with bigger obfuscatable chunks.\r\n\r\n![obfuscation calls during IBD without batching](https://github.com/user-attachments/assets/b521e3fc-f8cd-42d8-9068-a9b23f65b45b)\r\n\r\n-----\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/31645\r\n\r\n<details>\r\n<summary>7.50 hour IBD time</summary>\r\n\r\n```bash\r\nCOMPILER=gcc COMMIT=9b4be912d20222b3b275ef056c1494a15ccde3f5 ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=886000 -dbcache=5000 -blocksonly -printtoconsole=0\r\n  Time (mean Â± Ïƒ):     27019.086 s Â± 112.340 s    [User: 54927.344 s, System: 1652.376 s]\r\n  Range (min â€¦ max):   26939.649 s â€¦ 27098.522 s    2 runs\r\n```\r\n\r\n</details>\r\n\r\nWhen the in-memory UTXO set is [flushed](https://github.com/bitcoin/bitcoin/blob/master/src/txdb.cpp#L130-L133) to LevelDB (after IBD or AssumeUTXO load), it does so in batches to manage memory usage during the flush.\r\nWhile a hidden [-dbbatchsize](https://github.com/bitcoin/bitcoin/blob/master/src/init.cpp#L490) config option exists to modify this value, this PR introduces dynamic calculation of the batch size based on the -dbcache setting. By using larger batches when more memory is available (i.e., higher -dbcache), we can reduce the overhead from numerous small writes, minimize constant overhead per batch, improve I/O efficiency (especially on HDDs), and potentially allow LevelDB to optimize writes more effectively (e.g. by sorting the keys before write).\r\n\r\n<img width=\"1000\" alt=\"image\" src=\"https://github.com/user-attachments/assets/0a99e32e-6a9b-481e-a08a-7216c82fe722\" />\r\n\r\nNote that this PR mainly optimizes a critical section of IBD (memory to disk dump) - even if the effect on overall speed is modest:\r\n<img width=\"1000\" alt=\"image\" src=\"https://github.com/user-attachments/assets/8b56674b-b3e3-43cf-a19b-574e66948e72\" />\r\n\r\n<img width=\"1000\" alt=\"image\" src=\"https://github.com/user-attachments/assets/ce56cfba-a59f-4360-a6d7-2cc3e74959a3\" />\r\n\r\n<img width=\"1000\" alt=\"image\" src=\"https://github.com/user-attachments/assets/e346414c-b009-47c5-92ff-a264b1e2c6c4\" />\r\n\r\n<img width=\"1000\" alt=\"image\" src=\"https://github.com/user-attachments/assets/4db30a70-1ca9-401c-8c9c-2ddecd0d7516\" />\r\n\r\n-----\r\n\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/31868\r\n\r\n<details>\r\n<summary>7.41 hour IBD time</summary>\r\n\r\n```bash\r\nCOMPILER=gcc COMMIT=817d7ac0767a3984295aa3cf6c961dcc5f29d571 ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=886000 -dbcache=5000 -blocksonly -printtoconsole=0\r\n  Time (mean Â± Ïƒ):     26711.460 s Â± 244.118 s    [User: 54654.348 s, System: 1652.087 s]\r\n  Range (min â€¦ max):   26538.843 s â€¦ 26884.077 s    2 runs\r\n```\r\n</details>\r\n\r\nThe commits merge similar (de)serialization methods, and separates them internally with if constexpr - similarly to how it has been https://github.com/bitcoin/bitcoin/pull/28203. This enabled further SizeComputer optimizations as well.\r\n\r\nOther than these, since single byte writes are used very often (used for every (u)int8_t or std::byte or bool and for every VarInt's first byte which is also needed for every (pre)Vector), it makes sense to avoid unnecessary generalized serialization infrastructure.\r\n\r\n-----\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/31682\r\n\r\n<details>\r\n<summary>7.31 hour IBD time</summary>\r\n\r\n```bash\r\nCOMPILER=gcc COMMIT=182745cec4c0baf2f3c8cff2f74f847eac3c4330 ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=886000 -dbcache=5000 -blocksonly -printtoconsole=0\r\n  Time (mean Â± Ïƒ):     26326.867 s Â± 45.887 s    [User: 54367.156 s, System: 1619.348 s]\r\n  Range (min â€¦ max):   26294.420 s â€¦ 26359.314 s    2 runs\r\n```\r\n</details>\r\n\r\n`CheckBlock`'s latency is critical for efficiently validating correct inputs during transaction validation, including mempool acceptance and new block creation.\r\n\r\nThis PR improves performance and maintainability by introducing the following changes:\r\n* Simplified checks for the most common cases (1 or 2 inputs - [70-90% of transactions have a single input](https://transactionfee.info/charts/transactions-1in)).\r\n* Optimized the general case by replacing `std::set` with sorted `std::vector` for improved locality.\r\n* Simplified Null prevout checks from linear to constant time.\r\n\r\n-----\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/30442\r\n\r\n<details>\r\n<summary>7.25 hour IBD time</summary>\r\n\r\n```bash\r\nCOMPILER=gcc COMMIT=47d377bd0bb88dae6b34553a7789400170e0ccf6 ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=886000 -dbcache=5000 -blocksonly -printtoconsole=0\r\n  Time (mean Â± Ïƒ):     26084.429 s Â± 473.611 s    [User: 54310.780 s, System: 1815.967 s]\r\n  Range (min â€¦ max):   25749.536 s â€¦ 26419.323 s    2 runs\r\n```\r\n\r\n</details>\r\n\r\nThe in-memory representation of the UTXO set uses [(salted) SipHash](https://github.com/bitcoin/bitcoin/blob/master/src/coins.h#L226) for avoiding key collision attacks.\r\n\r\nHashing a `uint256` key is done so often that a specialized optimization was extracted to [SipHashUint256Extra](https://github.com/bitcoin/bitcoin/blob/master/src/crypto/siphash.cpp#L135). The constant salting operations were already extracted in the [general case](https://github.com/bitcoin/bitcoin/blob/master/src/crypto/siphash.cpp#L20-L23), this PR adjusts the main specialization similarly.\r\n\r\n\r\n-----\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/32279\r\n\r\nThe current `prevector` size of 28 bytes (chosen to fill the `sizeof(CScript)` aligned size) was introduced in 2015 (https://github.com/bitcoin/bitcoin/pull/6914) before SegWit and TapRoot.\r\nHowever, the increasingly common P2WSH and P2TR scripts are both 34 bytes, and are forced to use heap (re)allocation rather than efficient inline storage.\r\n\r\nThe core trade-off of this change is to eliminate heap allocations for common 29-36 byte scripts at the cost of increasing the base memory footprint of all `CScript` objects by 8 bytes (while still respecting peak memory usage defined by -dbcache).\r\n\r\n![image](https://github.com/user-attachments/assets/284ce2ab-32b8-4c85-9ada-11aae0e2ff39)\r\n\r\n-----\r\n\r\n## Other similar efforts waiting for reviews or revives (not included in this tracking PR):\r\n* https://github.com/bitcoin/bitcoin/pull/30611 - for very big in-memory caches make sure we still flush to disk regularly (no significant IBD speed change)\r\n* https://github.com/bitcoin/bitcoin/pull/28945 - was meant to preallocate the memory of recreated caches (~6% IBD speedup for small caches)\r\n* https://github.com/bitcoin/bitcoin/pull/31102 - was meant to try to evict entries selectively instead of dropping the whole cache when full\r\n* https://github.com/bitcoin/bitcoin/pull/32128 - draft PR showcasing a few other possible caching speedups\r\n\r\n-----\r\n\r\nThis PR is meant to stay in draft (not meant to be merged directly), to continually change based on comments received here and in the PRs.\r\nComments, reproducers and high-level discussions are welcome here - code reviews should rather be done in the individual PRs.\r\n",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2025-03-12T16:20:16Z",
      "updated_at": "2026-01-14T10:24:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32043",
      "labels": [
        "P2P",
        "Block storage",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 3,
        "positive_keywords": 3,
        "text_length": 21580,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3116637069,
      "number": 34109,
      "title": "refactor: Use uint64_t over size_t for serialize corruption check in fees.dat",
      "body": "Serialization should not behave differently on different architectures. See also the related commit 3789215f73466606eb111714f596a2a5e9bb1933.\r\n\r\nHowever, on fees.dat file corruption, 32-bit builds may run into an unsigned integer overflow and report the wrong corruption reason, or may even silently continue after the corruption.\r\n\r\nThis is a bit hard to reproduce, because 32-bit platforms are rare and most of them don't support running the unsigned integer overflow sanitizer. So the possible options to reproduce are:\r\n\r\n* Run on armhf and manually annotate the code to detect the overflow\r\n* Run on i386 with the integer sanitizer (possibly via `podman run -it --rm --platform linux/i386 'debian:trixie'`)\r\n* Run the integer sanitizer on any 64-bit platform and manually replace type in the affected line by `uint32_t`\r\n\r\nAfterwards, the steps to reproduce are:\r\n\r\n```\r\nexport DEBIAN_FRONTEND=noninteractive && apt update && apt install curl wget htop git vim ccache -y && git clone https://github.com/bitcoin/bitcoin.git  --depth=1 ./b-c && cd b-c && apt install build-essential cmake pkg-config  python3-zmq libzmq3-dev libevent-dev libboost-dev libsqlite3-dev  systemtap-sdt-dev  libcapnp-dev capnproto  libqrencode-dev qt6-tools-dev qt6-l10n-tools qt6-base-dev  clang llvm libc++-dev libc++abi-dev   -y\r\n\r\ncmake -B ./bld-cmake -DCMAKE_BUILD_TYPE=Debug -DCMAKE_C_COMPILER='clang' -DCMAKE_CXX_COMPILER='clang++' -DSANITIZERS=undefined,integer,float-divide-by-zero --preset=dev-mode\r\n\r\ncmake --build ./bld-cmake --parallel  $(nproc)\r\n\r\ncurl -fLO 'https://github.com/bitcoin-core/qa-assets/raw/b5ad78e070e4cf36beb415d7b490d948d70ba73f/fuzz_corpora/policy_estimator_io/607473137013139e3676e30ec4b29639e673fa9b'\r\n\r\nUBSAN_OPTIONS=\"suppressions=$(pwd)/test/sanitizer_suppressions/ubsan:print_stacktrace=1:halt_on_error=1:report_error_type=1\" FUZZ=policy_estimator_io ./bld-cmake/bin/fuzz ./607473137013139e3676e30ec4b29639e673fa9b \r\n```\r\n\r\nThe output will be something like:\r\n\r\n```\r\n/b-c/src/policy/fees/block_policy_estimator.cpp:448:25: runtime error: unsigned integer overflow: 346685954 * 219 cannot be represented in type 'unsigned int'\r\n    #0 0x5b0b1bbe in TxConfirmStats::Read(AutoFile&, unsigned int) /b-c/bld-cmake/src/./policy/fees/block_policy_estimator.cpp:448:25\r\n    #1 0x5b0b7d3f in CBlockPolicyEstimator::Read(AutoFile&) /b-c/bld-cmake/src/./policy/fees/block_policy_estimator.cpp:1037:29\r\n    #2 0x592a9783 in policy_estimator_io_fuzz_target(std::span<unsigned char const, 4294967295u>) /b-c/bld-cmake/src/test/fuzz/./test/fuzz/policy_estimator_io.cpp:32:32\r\n    #3 0x5896ba8e in void std::__invoke_impl<void, void (*&)(std::span<unsigned char const, 4294967295u>), std::span<unsigned char const, 4294967295u>>(std::__invoke_other, void (*&)(std::span<unsigned char const, 4294967295u>), std::span<unsigned char const, 4294967295u>&&) /usr/lib/gcc/i686-linux-gnu/14/../../../../include/c++/14/bits/invoke.h:61:14\r\n    #4 0x5896b8eb in std::enable_if<is_invocable_r_v<void, void (*&)(std::span<unsigned char const, 4294967295u>), std::span<unsigned char const, 4294967295u>>, void>::type std::__invoke_r<void, void (*&)(std::span<unsigned char const, 4294967295u>), std::span<unsigned char const, 4294967295u>>(void (*&)(std::span<unsigned char const, 4294967295u>), std::span<unsigned char const, 4294967295u>&&) /usr/lib/gcc/i686-linux-gnu/14/../../../../include/c++/14/bits/invoke.h:111:2\r\n    #5 0x5896b44b in std::_Function_handler<void (std::span<unsigned char const, 4294967295u>), void (*)(std::span<unsigned char const, 4294967295u>)>::_M_invoke(std::_Any_data const&, std::span<unsigned char const, 4294967295u>&&) /usr/lib/gcc/i686-linux-gnu/14/../../../../include/c++/14/bits/std_function.h:290:9\r\n    #6 0x59845c95 in std::function<void (std::span<unsigned char const, 4294967295u>)>::operator()(std::span<unsigned char const, 4294967295u>) const /usr/lib/gcc/i686-linux-gnu/14/../../../../include/c++/14/bits/std_function.h:591:9\r\n    #7 0x5983a0da in test_one_input(std::span<unsigned char const, 4294967295u>) /b-c/bld-cmake/src/test/fuzz/util/./test/fuzz/fuzz.cpp:88:5\r\n    #8 0x5983cb80 in main /b-c/bld-cmake/src/test/fuzz/util/./test/fuzz/fuzz.cpp:271:13\r\n    #9 0xf75aecc2  (/lib/i386-linux-gnu/libc.so.6+0x24cc2) (BuildId: 2dc5f2945fad35c1b07d1a5a32520b3c41afaa75)\r\n    #10 0xf75aed87 in __libc_start_main (/lib/i386-linux-gnu/libc.so.6+0x24d87) (BuildId: 2dc5f2945fad35c1b07d1a5a32520b3c41afaa75)\r\n    #11 0x58932db6 in _start (/b-c/bld-cmake/bin/fuzz+0x235ddb6) (BuildId: 7d8d83a77923f14e99c0de64acbc5f5bfc2cce9b)\r\n\r\nSUMMARY: UndefinedBehaviorSanitizer: unsigned-integer-overflow /b-c/src/policy/fees/block_policy_estimator.cpp:448:25 \r\n```\r\n\r\nNote: This is marked a \"refactor\", because the code change does not affect 64-bit builds, and on the still remaining rare 32-bit builds today it is extremely unlikely to happen in production.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-12-19T07:18:48Z",
      "updated_at": "2026-01-14T09:26:13Z",
      "merged_at": "2026-01-14T09:18:41Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34109",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 4956,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3135104327,
      "number": 34176,
      "title": "wallet: improve error msg when db directory is not writable",
      "body": "Make wallet creation and load fail with a clear error when the db directory isnâ€™t writable.\r\n\r\n#### 1) For Wallet Creation\r\n\r\nBefore: creating a wallet would return a generic error:\r\n\"SQLiteDatabase: Failed to open database: unable to open database file\"\r\n\r\nAfter: creating a wallet returns:\r\n\"SQLiteDatabase: Failed to open database in directory <dir_path>: directory is not writable\"\r\n\r\n#### 2) For Wallet Loading\r\n\r\nWe currently allow the load of wallets located on non-writable directories. This is problematic\r\nbecause the node crashes on any subsequent write; generating a block is enough to trigger it.\r\nCan be verified just by running the following test on master: https://github.com/furszy/bitcoin-core/commit/85fa4e2910f0a8f43d4ee5a1322cbb69656d85e9 \r\n\r\n\r\nAlso, to check directory writability, this creates a tmp file rather than relying on the\r\n`permissions()` functions, since perms bits alone may not reliably reflect actual writability\r\nin some systems.\r\n\r\nTesting Note:\r\nPushed the tests in separate commits so they can be cherry-picked on master for comparison.",
      "state": "open",
      "user": "furszy",
      "created_at": "2025-12-29T19:44:56Z",
      "updated_at": "2026-01-14T09:25:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34176",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1137,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2976587253,
      "number": 33775,
      "title": "guix: use GCC 14.3.0 over 13.3.0",
      "body": "Switching to using GCC 14.x for release builds has come up multiple times recently. It will eventually be needed for #25573, and could also be useful for #30210.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-11-04T13:12:58Z",
      "updated_at": "2026-01-14T08:51:18Z",
      "merged_at": "2026-01-13T23:34:03Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33775",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 194,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3164894382,
      "number": 34260,
      "title": "contrib: Remove unused functions",
      "body": "* `remove_files` is unused since 5668c6473a01528ac7d66b325b18b1cd2bd93063\r\n* `download_lines_with_urllib` is unused since it was introduced in 37c9fb7a59a3179b90ed1deaebaabb539976504b\r\n* `determine_wellknown_cmd` is unused since 76c090145e9bb64fe4ef6a663723dd0e9028ed10",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-12T08:14:07Z",
      "updated_at": "2026-01-14T07:22:09Z",
      "merged_at": "2026-01-13T23:36:00Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34260",
      "labels": [
        "Scripts and tools"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 302,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3161130502,
      "number": 34244,
      "title": "test: Prevent loop from running out of utxos in bip68 test",
      "body": "This tries to fix #34205\r\n\r\nI stared at the test code quite a bit and initially suspected some `MiniWallet` internals to be the issue but I think that was the wrong direction and there is simply a very small chance that the loop in `test_sequence_lock_confirmed_inputs` runs out of available utxos: We are starting out with 200-250 utxos and run the loop 400 times. If a transaction is accepted it could have up to 10 inputs but it always has only one output, so the pool is depleting in this case. And it's actually even worse because the output produced is not recognized as spendable by the `MiniWallet` because it is not using the correct output script. However, only a small fraction of transactions are actually accepted, which is why this issue almost never occurs. I did some extra printing and usually we end up with >100 utxos still available by the end of the test. But there is a small chance that too many transactions are accepted and then we can run out of utxos.\r\n\r\nI considered two fixes: The first was a break at the beginning of the loop `if available_utxos == 0: break`, this would work fine but I went with the second option: Simply creating the output with the correct output script so that `MiniWallet` recognizes it as spendable. This minimal replentishment of available utxos ensures that at worst we should get a few 1 input, 1 ouput transactions by the end but we should never run out of available utxos. I didn't look back in history but I suspect that this is how it was intended before `MiniWallet` introduced.\r\n\r\nAlso moves the `random` import in the same function to the top of the file.",
      "state": "closed",
      "user": "fjahr",
      "created_at": "2026-01-09T23:08:10Z",
      "updated_at": "2026-01-13T23:30:08Z",
      "merged_at": "2026-01-13T23:30:08Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34244",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1678,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3154145737,
      "number": 34224,
      "title": "init: Return EXIT_SUCCESS on interrupt",
      "body": "Reported by dergoegge on irc.\r\n\r\nAn interrupt does not create a failure exit code during normal operation. This should also be the case when interrupt is triggered during initialization. However a failure exit code is currently returned if an interrupt occurs during init. Fix this by making `AppInitMain` return true instead of false on interrupt, which further up the call stack currently sets the `EXIT_FAILURE` code. Also add a check for the interrupt condition during GUI startup. Returning `EXIT_SUCCESS` seems to be the usual behaviour for daemons, see the discussion on IRC for this: https://www.erisian.com.au/bitcoin-core-dev/log-2026-01-08.html#l-146 .\r\n\r\nBest reviewed with `--color-moved=dimmed-zebra --color-moved-ws=ignore-all-space`.",
      "state": "closed",
      "user": "sedited",
      "created_at": "2026-01-07T22:24:55Z",
      "updated_at": "2026-01-13T23:23:28Z",
      "merged_at": "2026-01-13T23:23:28Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34224",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 788,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3161267008,
      "number": 34246,
      "title": "verify-commits: Allow specific commits to allow sha1",
      "body": "Allow specific commits to not require the sha1 check.\r\n\r\nFixes the CI for aeaa67a9eac0decb89c60a67f9755ca10cbcc1d9 which uses SHA1 somewhere in the key's self signatures.",
      "state": "closed",
      "user": "achow101",
      "created_at": "2026-01-10T00:29:36Z",
      "updated_at": "2026-01-13T23:02:44Z",
      "merged_at": "2026-01-13T23:02:44Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34246",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 223,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3134156084,
      "number": 34168,
      "title": "qa: Require `--exclude` for each excluded test",
      "body": "This PR allows a long `--exclude ...` argument in the `test/functional/test_runner.py` invocation to be split across multiple lines, with optional per-line explanatory comments. I found this useful for the CI scripts in https://github.com/hebasto/bitcoin-core-nightly.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-12-29T11:02:05Z",
      "updated_at": "2026-01-13T22:42:30Z",
      "merged_at": "2026-01-13T22:41:01Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34168",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 315,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3107664562,
      "number": 34083,
      "title": "Add initial vectorized chacha20 implementation for 2-3x speedup",
      "body": "Exploit modern simd to calculate 2/4/6/8/16 states at a time depending on the size of the input.\r\n\r\nThis demonstrates a 2x speedup on x86-64 and 3x for arm+neon. Platforms which require runtime detection (avx2/avx512) improve performance even further, and will come as a follow-up.\r\n\r\nRather than hand-writing assembly or using arch-specific intrinsics, this is written using compiler built-ins understood by gcc and clang.\r\n\r\nIn practice (at least on x86_64 and armv8), the compilers are able to produce assembly that's not much worse than hand-written.\r\n\r\nThis means that every architecture can benefit from its own vectorized instructions without having to write/maintain an implementation for each one. But because each will vary in ability to exploit the parallelism, we allow (via ifdefs) each architecture to opt-out of some or all multi-state calculation at compile-time..\r\n\r\nHere, as a starting point, x86-64 and arm+neon have been defined based on local benchmarks.\r\n\r\nLocal profiling revealed that chacha20 accounts for a substantial amount of the network thread's time. It's not clear to me if speeding up chacha20 will improve network performance/latency, but it will definitely make it more efficient.\r\n\r\nThis is part 1 of a series of PR's for chacha20. I think it makes sense to take a look at the generic implementation and tune the architecture-specific defines for parallel blocks before adding the runtime-dependent platforms.\r\n\r\nMy WIP branch which includes avx2/avx512 can be seen here: https://github.com/theuni/bitcoin/commits/chacha20-vectorized/\r\n\r\nI've been hacking on this for quite a while, trying every imaginable tweak and comparing lots of resulting asm/ir. I'm happy to answer any questions about any choices made which aren't immediately obvious.\r\n\r\nEdit: some more impl details:\r\n\r\nI wrestled with gcc/clang a good bit, tweaking something and comparing the generated code output. A few things I found, which may explain some of the decisions I made:\r\n\r\n- gcc really wanted to inline some of the helpers, which comes at a very substantial performance cost due to register clobbering (and with avx2, `vzeroupper`). Hence, all helpers are decorated with `ALWAYS_INLINE`.\r\n- gcc/clang do well with the vec256 loads/stores with minimal fussing. Though loading each element with `[]` is clumsy and verbose, it avoids compiler-specific layout assumptions. Other things I tried (which produced the same asm):\r\n  - casting directly to `using unaligned_vec256 __attribute__((aligned (1))) = vec256`\r\n  - memcpy into ^^\r\n  - clang's `__builtin_masked_load`\r\n- Loop unrolling was hit-or-miss without `#pragma GCC unroll n`, and I tried to avoid macros for loops, hence the awkward recursive inline template loops. But in practice, I see those unrolled 100% of the time.\r\n- I used `std::get` in the helpers for some extra compile-time safety (this actually pointed out some off-by-one's that would've been annoying to track down)\r\n- I avoided using any lambdas or classes for fear of compilers missing obvious optimizations\r\n- All `vec256` are passed by reference to avoid an annoying clang warning about returning a vector changing the abi (this is specific to x86 when not compiling with `-avx`). Even though our functions are all inlined, I didn't see any harm in making that adjustment.",
      "state": "open",
      "user": "theuni",
      "created_at": "2025-12-16T20:42:37Z",
      "updated_at": "2026-01-13T19:34:47Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34083",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 3375,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3166250753,
      "number": 34264,
      "title": "fuzz: Extend `spend` coverage",
      "body": "Make the `wallet/spend` fuzz target stateful and extend coverage for several missing methods.",
      "state": "open",
      "user": "Chand-ra",
      "created_at": "2026-01-12T15:12:26Z",
      "updated_at": "2026-01-13T17:45:28Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34264",
      "labels": [
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 123,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2955799270,
      "number": 33723,
      "title": "chainparams: remove dnsseed.bitcoin.dashjr-list-of-p2p-nodes.us",
      "body": "The DNS seed `dnsseed.bitcoin.dashjr-list-of-p2p-nodes.us.` is not returning a representative sample of bitcoin nodes. It currently returns nothing later than 28.1.0, breaching the policy.\r\n\r\nThis PR removes that seed from the list of DNS seeds\r\n\r\n### Rationale\r\n\r\nThe [policy for seeds](https://github.com/bitcoin/bitcoin/blob/master/doc/dnsseed-policy.md) includes this:\r\n\r\n> The DNS seed results must consist exclusively of fairly selected and functioning Bitcoin nodes from the public network\r\n\r\nA number of comments below, in response to this PR, include apparent breaches of this policy: [1](https://github.com/bitcoin/bitcoin/pull/33723#issuecomment-3458071231) [2](https://github.com/bitcoin/bitcoin/pull/33723#issuecomment-3457655364), [3](https://github.com/bitcoin/bitcoin/pull/33723#issuecomment-3457712557), in particular the first linked comment ([1](https://github.com/bitcoin/bitcoin/pull/33723#issuecomment-3458071231)) comparing the distribution at this seed to other seeds. This seed is not including anything later than 28.2.0, breaching this policy.\r\n\r\nTo ensure the policy is followed, and the seeds include a representative sample of Bitcoin nodes, this PR removes this seed from the list\r\n\r\n### Data\r\n\r\nI ran this:\r\n```\r\n# Get some ip address from that seed:\r\n# Repeated multiple times, to get many different IPs:\r\ndig +short dnsseed.bitcoin.dashjr-list-of-p2p-nodes.us >> dnsseed.bitcoin.dashjr-list-of-p2p-nodes.us\r\n# For each distinct ip gathered from the seed, get basic info about the node, including it's User Agent string:\r\ncat dnsseed.bitcoin.dashjr-list-of-p2p-nodes.us | sort -u | while read ip; do echo ===; echo $ip; nmap -p 8333 --script bitcoin-info \"$ip\"; done > seed_versions.txt\r\n```\r\n\r\nand then summarized the agents with `egrep 'User Agent' seed_versions.txt  | sort | uniq -c` and got:\r\n```\r\n      1   User Agent: /Satoshi:22.0.0/\r\n      1   User Agent: /Satoshi:22.1.0/\r\n      5   User Agent: /Satoshi:24.0.1/\r\n      1   User Agent: /Satoshi:25.1.0/\r\n     30  User Agent: /Satoshi:27.0.0/\r\n      1   User Agent: /Satoshi:27.1.0/\r\n      1   User Agent: /Satoshi:27.1.0/Knots:20240801/\r\n      1   User Agent: /Satoshi:28.0.0/\r\n      7   User Agent: /Satoshi:28.1.0/\r\n      2   User Agent: /Satoshi:28.1.0/Knots:20250305/\r\n\r\n```",
      "state": "closed",
      "user": "SatsAndSports",
      "created_at": "2025-10-28T15:53:59Z",
      "updated_at": "2026-01-13T17:11:15Z",
      "merged_at": "2025-12-04T16:44:26Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33723",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2334,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3154448671,
      "number": 34227,
      "title": "guix: Fix `osslsigncode` tests",
      "body": "This PR aims to improve the experience for Guix builders when creating new Guix profiles after 2025. In particular, it should be helpful for those who are new to building with Guix.\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/34220.\r\n\r\nOther possible alternatives to consider include:\r\n1. Applying a workaround as suggested [here](https://github.com/bitcoin/bitcoin/issues/34220#issuecomment-3718991398).\r\n\r\n2. Updating the package as suggested [here](https://github.com/bitcoin/bitcoin/issues/34220#issuecomment-3719022287).\r\n\r\n3. Disabling tests as suggested [here](https://github.com/bitcoin/bitcoin/issues/34220#issuecomment-3719538660).",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-01-08T01:41:56Z",
      "updated_at": "2026-01-13T17:11:03Z",
      "merged_at": "2026-01-09T11:11:47Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34227",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 679,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3166772862,
      "number": 34265,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "Niharikajakkula",
      "created_at": "2026-01-12T17:51:56Z",
      "updated_at": "2026-01-13T15:47:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34265",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2988877111,
      "number": 33819,
      "title": "mining: getCoinbase() returns struct instead of raw tx",
      "body": "The first commit renames `getCoinbaseTx()` to `getCoinbaseRawTx()` to reflect that it returns a serialised transaction. This does not impact IPC clients, because they do not use the function name.\r\n\r\nThe second commit then introduces a replacement `getCoinbase()` that provides a struct with everything clients need to construct a coinbase. This avoids clients having to parse and manipulate our dummy transaction.\r\n\r\nDeprecate but don't remove `getCoinbaseRawTx()`, `getCoinbaseCommitment()` and `getWitnessCommitmentIndex()`.\r\n\r\nAfter this change we can drop these deprecated methods, which in turn would allow us to clear the dummy transaction from the `getBlock()` result. But that is left for a followup to keep this PR focussed. See https://github.com/Sjors/bitcoin/pull/106 for an approach.\r\n\r\nExpand the `interface_ipc.py` functional test to document its usage.\r\n\r\nCan be tested using:\r\n- https://github.com/stratum-mining/sv2-tp/pull/59",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2025-11-07T14:30:41Z",
      "updated_at": "2026-01-13T15:19:19Z",
      "merged_at": "2026-01-13T13:02:04Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33819",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1000,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2982372791,
      "number": 33795,
      "title": "test: Ignore error message give from python because of PYTHON_GIL",
      "body": "### Description\r\nI was able to reproduce this issue https://github.com/bitcoin/bitcoin/issues/33582\r\nWe should ignore the warning message if `PYTHON_GIL` is not set, instead of the test being abruptly stopped\r\n\r\n### When `PYTHON_GIL` is `0` or `1` or not set\r\n```\r\nPYTHON_GIL=1 ./build_dev_mode/test/functional/test_runner.py interface_ipc.py\r\nor \r\nPYTHON_GIL=0 ./build_dev_mode/test/functional/test_runner.py interface_ipc.py\r\nor\r\n./build_dev_mode/test/functional/test_runner.py interface_ipc.py\r\n\r\nTemporary test directory at /tmp/test_runner_â‚¿_ðŸƒ_20251105_180523\r\nWARNING! There is already a bitcoind process running on this system. Tests may fail unexpectedly due to resource contention!\r\nRemaining jobs: [interface_ipc.py]\r\n1/1 - interface_ipc.py passed, Duration: 13 s\r\n\r\nTEST             | STATUS    | DURATION\r\n\r\ninterface_ipc.py | âœ“ Passed  | 13 s\r\n\r\nALL              | âœ“ Passed  | 13 s (accumulated)\r\nRuntime: 13 s\r\n```",
      "state": "open",
      "user": "kevkevinpal",
      "created_at": "2025-11-05T23:13:29Z",
      "updated_at": "2026-01-13T13:17:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33795",
      "labels": [
        "Tests",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 994,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3138438378,
      "number": 34184,
      "title": "mining: add cooldown to createNewBlock() immediately after IBD",
      "body": "At startup `isInitialBlockDownload()` stops returning true once thereâ€™s less than a day of blocks left to sync. Connected mining clients will receive a flood of new templates as these last blocks are connected.\r\n\r\nFix this by briefly pausing block template creation while the best header chain is ahead of the tip. If no tip update happens for one second, we stop waiting.\r\n\r\nIt's not safe to keep waiting, because a malicious miner could announce a header and delay revealing the block, causing all other miners using this software to stall.\r\n\r\nThe cooldown only applies to `createNewBlock()`, which is typically called once per connected client; `waitNext()` remains unchanged.\r\n\r\nFixes #33994\r\n\r\n",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-12-31T05:17:32Z",
      "updated_at": "2026-01-13T13:12:05Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34184",
      "labels": [
        "Mining",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 762,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3152436690,
      "number": 34219,
      "title": "psbt: validate pubkeys in MuSig2 pubnonce/partial sig deserialization",
      "body": "The previous fix for invalid MuSig2 pubkeys (bitcoin/bitcoin#34010) only\r\naddressed the PSBT_IN_MUSIG2_PARTICIPANT_PUBKEYS field. However, the\r\nPSBT_IN_MUSIG2_PUB_NONCE and PSBT_IN_MUSIG2_PARTIAL_SIG fields also\r\ndeserialize pubkeys without validation, which could lead to crashes when\r\ninvalid pubkeys are processed.\r\n\r\nThis commit adds validation to the DeserializeMuSig2ParticipantDataIdentifier\r\nfunction to ensure all pubkeys in MuSig2 pubnonce and partial signature\r\nfields are fully valid elliptic curve points.\r\n\r\nThe fix:\r\n- Validates both aggregate and participant pubkeys in MuSig2 pubnonce and\r\n  partial signature deserialization\r\n- Throws std::ios_base::failure with descriptive error messages for invalid\r\n  pubkeys\r\n- Prevents potential crashes from invalid elliptic curve points\r\n- Maintains backward compatibility for valid PSBTs\r\n\r\nThis completes the fix for issues [#33999](https://github.com/bitcoin/bitcoin/issues/33999) and [#34201](https://github.com/bitcoin/bitcoin/issues/34201).",
      "state": "open",
      "user": "tboy1337",
      "created_at": "2026-01-07T12:41:30Z",
      "updated_at": "2026-01-13T13:10:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34219",
      "labels": [
        "PSBT"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1075,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3167302998,
      "number": 34266,
      "title": "release note: cpfp carveout removed in 31.0",
      "body": "Seems it was overlooked for release notes, so let's add something",
      "state": "closed",
      "user": "instagibbs",
      "created_at": "2026-01-12T20:56:46Z",
      "updated_at": "2026-01-13T12:11:29Z",
      "merged_at": "2026-01-12T23:12:00Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34266",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 109,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2076876366,
      "number": 30918,
      "title": "fuzz: Add check in `p2p_headers_presync` that chain work never exceeds minimum work",
      "body": "A followup to https://github.com/bitcoin/bitcoin/pull/30661\r\n\r\nThe added assertion just makes sure that the fuzz test is working as intended. If we're sure that the total work of the test chain is never more than minimum chain work, then we can be sure that the later assertion failure would actually mean that a bug in the headers presync logic was found.\r\n\r\nThis PR also addresses:\r\nhttps://github.com/bitcoin/bitcoin/pull/30661#discussion_r1746614616\r\nhttps://github.com/bitcoin/bitcoin/pull/30661#discussion_r1764943665\r\nhttps://github.com/bitcoin/bitcoin/pull/30661#discussion_r1764961991\r\n",
      "state": "closed",
      "user": "marcofleon",
      "created_at": "2024-09-17T17:21:12Z",
      "updated_at": "2026-01-13T10:53:17Z",
      "merged_at": "2024-09-20T18:35:13Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30918",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 679,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1715098924,
      "number": 29396,
      "title": "rpc: getdescriptorinfo also returns normalized descriptor",
      "body": "This pull request introduces enhancements to the getdescriptorinfo RPC command, specifically by incorporating the functionality to return the `normalized_descriptor` alongside the original `descriptor` information. This improvement addresses the need for a standardized format that facilitates the use of descriptors in public key operations, especially important for scenarios requiring the derivation of addresses without access to private keys.\r\n\r\nRelated issue: https://github.com/bitcoin/bitcoin/issues/29320",
      "state": "closed",
      "user": "leo-aa88",
      "created_at": "2024-02-07T07:41:51Z",
      "updated_at": "2026-01-13T10:53:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29396",
      "labels": [
        "RPC/REST/ZMQ",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 571,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2106109102,
      "number": 31028,
      "title": "fuzz: Add fuzz-only build mode option for targets",
      "body": "Addresses https://github.com/bitcoin/bitcoin/issues/30950.\r\n\r\nAny targets that require BUILD_ON_FUZZING=ON (currently only `p2p_headers_presync`) to work properly can now set `require_build_for_fuzzing` as an option. If BUILD_FOR_FUZZING is not on and you try to run a target that has this option, then there's a message printed upon exit.\r\n\r\nWith this change, the CI will be able to run the fuzz test runner without any timeouts/failures.\r\n\r\n\r\n\r\n\r\n",
      "state": "closed",
      "user": "marcofleon",
      "created_at": "2024-10-03T17:55:51Z",
      "updated_at": "2026-01-13T10:53:16Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31028",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 499,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2243261746,
      "number": 31537,
      "title": "qa: Limit `-maxconnections` in tests",
      "body": "On systems such as NetBSD, the `bitcoind` typically prints the following warning:\r\n```\r\nWarning: Reducing -maxconnections from 125 to 96, because of system limitations.\r\n```\r\n\r\nThis breaks the functional test framework (see https://github.com/bitcoin/bitcoin/issues/23968).\r\n\r\nThis PR limits the `-maxconnections` to mitigate the issue and enable functional tests on NetBSD.\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/23968.\r\n\r\nHere is CI log from the [`bitcoin-core-nightly`](https://github.com/hebasto/bitcoin-core-nightly) repository: https://github.com/hebasto/bitcoin-core-nightly/actions/runs/12415868523/job/34663207030",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2024-12-18T23:27:38Z",
      "updated_at": "2026-01-13T10:53:15Z",
      "merged_at": "2024-12-30T19:34:30Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31537",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 671,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2161111715,
      "number": 31213,
      "title": "fuzz: Fix difficulty target generation in `p2p_headers_presync`",
      "body": "In the `p2p_headers_presync` fuzz target, this assertion failed:\r\n```\r\n assert(total_work < chainman.MinimumChainWork());\r\n ```\r\nInput that triggered the failure: [p2ppresync_crash.txt](https://github.com/user-attachments/files/17620203/p2ppresync_crash.txt)\r\n\r\nThe test previously used `ConsumeIntegralInRange` to generate header difficulty targets within a hardcoded range. The fuzzer found specific values in that range that correspond to very low thresholds due to how [`SetCompact`][setcompact-link] works. The total work of a long enough test chain ended up exceeding `MinimumChainWork`.\r\n\r\nFix this by adding a new `ConsumeArithUInt256InRange` helper function and use it in the fuzz test to generate target values within the originally intended range. The target is then converted to an `nBits` value using `GetCompact()`.\r\n\r\nFor some more context, see https://github.com/bitcoin/bitcoin/pull/30918.\r\n\r\n[setcompact-link]: https://github.com/bitcoin/bitcoin/blob/6463117a29294f6ddc9fafecfd1e9023956cc41b/src/arith_uint256.h#L251-L271",
      "state": "closed",
      "user": "marcofleon",
      "created_at": "2024-11-04T15:00:05Z",
      "updated_at": "2026-01-13T10:53:15Z",
      "merged_at": "2024-11-20T11:46:28Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31213",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1103,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2261853195,
      "number": 31611,
      "title": "doc: upgrade license to 2025.",
      "body": "",
      "state": "closed",
      "user": "kehiy",
      "created_at": "2025-01-06T12:24:13Z",
      "updated_at": "2026-01-13T10:53:14Z",
      "merged_at": "2025-01-10T11:03:12Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31611",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 30,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2783139679,
      "number": 33268,
      "title": "wallet: Identify transactions spending 0-value outputs, and add tests for anchor outputs in a wallet",
      "body": "One of the ways that the wallet would determine if a transaction was sent from the wallet was by checking if the total amount being spent by a transaction from outputs known to the wallet was greater than 0. This has worked fine until recently since there was no reason for 0-value outputs to be created. However, with ephemeral dust and P2A, it is possible to create standard 0-value outputs, and the wallet was not correctly identifying the spends of such outputs. This PR updates `IsFromMe` to only check whether the wallet knows any of the inputs, rather than checking the debit amount of a transaction.\r\n\r\nAdditionally, a new functional test is added to test for this case, as well as a few other anchor output related scenarios. This also revealed a bug in `sendall` which would cause an assertion error when trying to spend all of the outputs in a wallet that has anchor outputs.\r\n\r\nFixes #33265 ",
      "state": "closed",
      "user": "achow101",
      "created_at": "2025-08-28T22:28:48Z",
      "updated_at": "2026-01-13T09:44:45Z",
      "merged_at": "2025-09-12T13:42:14Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33268",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1004,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2857448557,
      "number": 33475,
      "title": "bugfix: miner: fix `addPackageTxs` unsigned integer overflow",
      "body": "This PR fixes an unsigned integer overflow in the `addPackageTxs` method of the `BlockAssembler`.\r\n\r\nThe overflow is a rare edge case that might occur on master when a miner reserves 2000 WU and wants to create an block to be empty.\r\n\r\ni.e, by starting with `-blockmaxweight=2000`, `-blockreservedweight=2000`, or just `blockmaxweight=2000`, and then calling the mining interface `createNewBlock` with `blockReservedWeight` set to `2000`.\r\n\r\nInstead of bailing out after going through transactions equivalent to `MAX_CONSECUTIVE_FAILURES`, the loop never breaks until all mempool transactions are visited.\r\n\r\nSee https://github.com/bitcoin/bitcoin/pull/33421#issuecomment-3324859282\r\n\r\nThe fix avoids the overflow by using addition instead adding `BLOCK_FULL_ENOUGH_WEIGHT_DELTA` to the block weight and comparing it with `m_options.nBlockMaxWeight`.\r\n\r\nAnother alternative that preserves the same structure is to use `static_cast`. See https://github.com/bitcoin/bitcoin/pull/33421/commits/c9530cf35d351628eea4992c66fc1df548d1b580.\r\n\r\nThis fix can be tested by cherry-picking the commits from #33421 without the static cast fix and running:\r\n\r\n```bash\r\necho \"AQAAAAAAA\r\nAAnJycnAAAAAAAAAAAAAAAAAA\" | base64 --decode > miner.crash\r\n\r\nFUZZ=block_template_cache ./build_fuzz/bin/fuzz miner.crash\r\n```\r\n\r\n\r\n---\r\n\r\nThis is part of a larger inconsistency in how size/weight is represented in the codebase. It may be worth defining a dedicated type for size/weight.\r\n",
      "state": "closed",
      "user": "ismaelsadeeq",
      "created_at": "2025-09-24T15:41:18Z",
      "updated_at": "2026-01-13T09:44:37Z",
      "merged_at": "2025-09-25T12:18:25Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33475",
      "labels": [
        "Bug"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 1521,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3150016853,
      "number": 34211,
      "title": "build: Alt restore cross-compilation for Android",
      "body": "# build, qt, doc: Add Android GUI support and APK packaging\r\n\r\nThis PR restores cross-compilation for Android (previously removed in #30049 and proposed in #32262) and extends it to support the Bitcoin-Qt GUI and Android Application Package (APK) generation.\r\n\r\nUnlike #32262, which focused on restoring the base cross-compilation, this PR provides a complete path to a functional Android application. It achieves this by updating the `depends` system to handle Android-specific requirements (shared Qt libraries, JNI support), integrating `androiddeployqt` into the CMake build system, and providing a standard Android entry point.\r\n\r\n### Alternatives\r\nThis PR is offered as an alternative to #32262. It incorporates and builds upon the `depends` fixes introduced there while adding the necessary components for a full GUI application and automated APK packaging.\r\n\r\n### Key Changes (mostly from #32262)\r\n- **build**: Restored and updated Android cross-compilation support in the `depends` system. This includes handling Android ABIs and mapping them to Bitcoin Core's `HOST` triples.\r\n- **build**: Added APK generation support via a new `apk_package` CMake target. This target automates the generation of `deploy.json` and the execution of `androiddeployqt` to produce ready-to-install `.apk` files.\r\n- **qt**: Added Android-specific GUI configurations, including a Java entry point (`BitcoinQtActivity.java`), high-resolution icons, and a manifest template.\r\n- **doc**: Added `doc/build-android.md` with detailed instructions for setting up the Android SDK/NDK and building the GUI.\r\n- **util**: Added a deduction guide for `util::Overloaded` to ensure compatibility with modern Android C++ toolchains.\r\n- **depends**: Applied several patches to Qt to fix JNI static linking issues and duplicate symbols encountered during Android builds.\r\n\r\n### Testing\r\nThe changes have been tested on Ubuntu 22.04 targeting `x86_64-linux-android` (API level 34) with NDK r26b and Qt 6.7.3. The resulting APK has been verified to install and run correctly on an Android emulator (see screenshot at the bottom).\r\nAlso it has been tested on a real devices with Android 13 (API level 33) for both abis `arm64-v8a` (aarch64) and `armv7a`.\r\n\r\n**Build Example:**\r\n```bash\r\n# Set environment\r\nexport ANDROID_SDK_ROOT=/path/to/Android/Sdk\r\nexport ANDROID_NDK_ROOT=$ANDROID_SDK_ROOT/ndk/26.1.10909125\r\n\r\n# Build dependencies\r\ngmake -C depends HOST=x86_64-linux-android ANDROID_SDK=$ANDROID_SDK_ROOT ANDROID_NDK=$ANDROID_NDK_ROOT ANDROID_API_LEVEL=34 NO_IPC=1  -j$(nproc)\r\n\r\n# Configure and build APK\r\ncmake -G Ninja -B build --toolchain depends/x86_64-linux-android/toolchain.cmake \\\r\n      -DBUILD_GUI=ON -DANDROID_API_LEVEL=34  -j$(nproc)\r\ncmake --build build --target apk_package  -j$(nproc)\r\n```\r\n\r\n### Note for Reviewers\r\n- Android does not support the system-wide IPC mechanisms used by Bitcoin Core's multiprocess support, so `NO_IPC=1` is currently required.\r\n- CI integration for the Android build is not included in this PR and will be addressed in a follow-up task if deemed necessary.\r\n\r\n### Emulator Screenshot\r\n<details>\r\n  <summary>Click to expand</summary>\r\n  \r\n<img width=\"968\" height=\"2187\" alt=\"Screenshot 2026-01-06 082824\" src=\"https://github.com/user-attachments/assets/9d7b0130-b624-4817-adf4-f5825c8e4c9d\" />\r\n\r\n</details>\r\n\r\n",
      "state": "open",
      "user": "D33r-Gee",
      "created_at": "2026-01-06T16:48:55Z",
      "updated_at": "2026-01-13T09:33:28Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34211",
      "labels": [
        "Build system",
        "Android"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 3378,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3162249228,
      "number": 34249,
      "title": "doc: archive v30.2 release notes",
      "body": "Archive v30.2 release notes.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-01-10T16:15:36Z",
      "updated_at": "2026-01-13T08:44:53Z",
      "merged_at": "2026-01-12T23:37:08Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34249",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 61,
        "has_nack": false,
        "has_ack": false
      }
    }
  ],
  "issues": [
    {
      "id": 854937077,
      "number": 21647,
      "title": "RPC importprunedfunds doesn't allow importing spending txs, only receiving txs",
      "body": "I noticed one of my wallets shows that I own funds that I really don't. I identified the spending transaction and tried to import it using 'importprunedfunds' but was told:\r\n\r\n`No addresses in wallet correspond to included transaction`\r\n\r\nIt turns out that 'importprunedfunds' only allows you to import txs which credit an address owned by your wallet. It won't let you import txs which spend from addresses owned by your wallet.\r\n\r\nI made the following change and then was able to import the missing transaction:\r\n\r\n    --- a/src/wallet/rpcdump.cpp\r\n    +++ b/src/wallet/rpcdump.cpp\r\n    @@ -372,7 +372,7 @@ RPCHelpMan importprunedfunds()\r\n         CWalletTx::Confirmation confirm(CWalletTx::Status::CONFIRMED, height, merkleBlock.header.GetHash(), txnIndex);\r\n     \r\n         CTransactionRef tx_ref = MakeTransactionRef(tx);\r\n    -    if (pwallet->IsMine(*tx_ref)) {\r\n    +    if (pwallet->IsMine(*tx_ref) || pwallet->IsFromMe(*tx_ref)) {\r\n             pwallet->AddToWallet(std::move(tx_ref), confirm);\r\n             return NullUniValue;\r\n         }",
      "state": "open",
      "user": "dooglus",
      "created_at": "2021-04-10T00:36:28Z",
      "updated_at": "2026-01-20T07:49:57Z",
      "closed_at": null,
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/21647",
      "labels": [
        "Wallet",
        "RPC/REST/ZMQ",
        "good first issue"
      ],
      "comment_data": [
        {
          "id": 3771502686,
          "user": "crackedhandle",
          "body": "Iâ€™d like to work on this. Is anyone currently working on it?",
          "created_at": "2026-01-20T07:49:57Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 60,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1130,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3653223188,
      "number": 33923,
      "title": "should concurrent IPC requests directed to the same thread cause a crash?",
      "body": "recently I reported https://github.com/bitcoin/bitcoin/issues/33554, which was fixed by the introduction of `interruptWait` via #33575\n\nthen I noticed crashes for similar reasons (although unrelated to `waitNext`), which I explain in detail here: https://github.com/stratum-mining/sv2-apps/issues/88#issuecomment-3558003166\n\nTLDR: I was trying to do a `getBlock` while a `submitSolution` was happening at the same time, both against the same Bitcoin Core thread\n\nthis made me realize that regardless of whether the call is going to block for a long time (like `waitNext`), I simply cannot leave room for concurrent calls against the same Bitcoin Core thread\n\nwhich feels a bit contradictory to what @ryanofsky suggested here: https://github.com/bitcoin/bitcoin/issues/33554#issuecomment-3382354366\n\n> More broadly, I think I'd try just having a c++ \"waiter\" thread dedicated to running waitNext calls, and a c++ \"worker\" thread to run all other IPC operations besides waitNext. The \"waiter\" thread should be mostly blocked monitoring mempool and network, and the \"worker\" thread should be available to do anything else you might need like fetching and submitting block data.\n\nand it's making me re-evaluate some assumptions I had when I started https://github.com/stratum-mining/sv2-apps/pull/59\n\noverall, I'm getting to a place where I'm having to go great lengths in terms of defensive programming just to avoid crashing Bitcoin Core\n\nI'm still evaluating the trade-offs of potential defensive strategies, namely:\n- having synchronization primitives that avoid overlapping requests against the same Bitcoin Core thread\n- instantiating multiple Bitcoin Core threads, one dedicated for each potentially concurrent request\n\nbut I digress... the main point I wanted to articulate here was: shouldn't Bitcoin Core simply not crash if two requests arrive for the same thread?\n\nideally, a naive client should simply be forced to wait a bit longer if they send concurrent requests against the same Bitcoin Core thread, instead of being forced to avoid doing this at all cost because it could cause havoc on the other side of the IPC connection",
      "state": "open",
      "user": "plebhash",
      "created_at": "2025-11-21T22:05:01Z",
      "updated_at": "2026-01-19T22:47:32Z",
      "closed_at": null,
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/issues/33923",
      "labels": [
        "Brainstorming",
        "Bug",
        "interfaces"
      ],
      "comment_data": [
        {
          "id": 3768263258,
          "user": "ismaelsadeeq",
          "body": "re https://github.com/bitcoin/bitcoin/issues/34250#issuecomment-3749243782\n\nI agree with @Sjors that we should just expose those values in one call to avoid the round trip, @plebhash it would also be nice to benchmark what @Sjors suggests.\n\nI also agree on the potential of throttling if we allow an arbitrary number of threads. It should definitely be rate-limited.",
          "created_at": "2026-01-19T13:09:25Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 366,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3770320747,
          "user": "plebhash",
          "body": "> > to be honest, we could have gotten away with only 2 by forcing `getHeader`, `getCoinbaseTx`, `getCoinbaseMerklePath` and waitNext to be done sequentially under the same server thread\n> \n> I think you should bench this before deciding if it needs optimising and also check whether it's _actually_ faster and not e.g. slowing the node responses down with overhead.\n\n---\n\n> I agree with @Sjors that we should just expose those values in one call to avoid the round trip, @plebhash it would also be nice to benchmark what @Sjors suggests.\n\n---\n\nhere's a benchmarking suite: https://github.com/plebhash/sv2-bitcoin-core/tree/2026-01-19-benchmark-fetch-template-strategies\n\nthe methodology consists of:\n\ncollect 100 samples of fetching template data under two different strategies:\n- sequentially execute `getHeader`, then `getCoinbaseTx`, then `getCoinbaseMerklePath`, all against the same pre-allocated server thread\n- concurrently execute `getHeader`, `getCoinbaseTx`, and `getCoinbaseMerklePath`, against 3 different pre-allocated server threads\n\nnotes:\n- node was Bitcoin Core `v30.2` running on `mainnet`\n- all requests were done against the same `BlockTemplate` (I wonder if that could skew or bias the results in any meaningful way?)\n\nhere's the results:\n\n```\nfetch_template/sequential/single_thread\n                        time:   [505.89 Âµs 507.80 Âµs 509.73 Âµs]\nFound 5 outliers among 100 measurements (5.00%)\n  4 (4.00%) high mild\n  1 (1.00%) high severe\nfetch_template/concurrent/multiple_threads\n                        time:   [367.33 Âµs 368.71 Âµs 370.15 Âµs]\nFound 4 outliers among 100 measurements (4.00%)\n  3 (3.00%) high mild\n  1 (1.00%) high severe\n```\n\n<img width=\"1024\" height=\"1086\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/666e5d7a-d30f-4cfb-bda5-bf002d569ba5\" />",
          "created_at": "2026-01-19T22:32:37Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 1802,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2211,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3724650829,
      "number": 34064,
      "title": "Wallet: gettransaction(txid).details changes after confirmation of RBF replacement",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nFor a replaced transaction (txA), the output of gettransaction(txA, true).details\nchanges after the replacement transaction (txB) is confirmed.\n\nSpecifically, a 'receive' entry present after bumpfee disappears once txB is\nconfirmed, even though the queried txid remains txA.\n\nAfter confirmation, repeated calls are stable.\n\n\n### Expected behaviour\n\nFor a given txid, gettransaction(txid).details should be stable once the\nreplacement transaction has been confirmed, or at minimum should not\nretroactively add or remove details entries in a way that changes accounting\ninterpretation for the same transaction id.\n\n\n### Steps to reproduce\n\n1. Create a transaction (txA) from a descriptor wallet.\n2. Replace txA using bumpfee, creating txB.\n3. Query gettransaction(txA, true) and record details.\n4. Mine blocks to confirm txB.\n5. Query gettransaction(txA, true) again and compare details.\n\nA minimal reproduction package and proof artifacts are attached below.\n\n[x3_mini_package.tar.gz](https://github.com/user-attachments/files/24134210/x3_mini_package.tar.gz)\n\nSHA-256 (x3_mini_package.tar.gz):\n47413632eab190a2c2477b0d2f8128bc956326ae3765d8fbf6b2a9da5046a617\n\n### Relevant log output\n\nNo debug.log output is required; the issue is observable via wallet RPC output.\n\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\n27.0\n\n### Operating system and version\n\nUbuntu 22.04 LTS (regtest environment)\n\n### Machine specifications\n\nStandard x86_64 Linux host, SSD storage, regtest environment.",
      "state": "closed",
      "user": "husstege-e",
      "created_at": "2025-12-12T19:53:39Z",
      "updated_at": "2026-01-19T19:14:17Z",
      "closed_at": "2026-01-19T19:14:17Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34064",
      "labels": [
        "Wallet",
        "RPC/REST/ZMQ"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1735,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3826722076,
      "number": 34331,
      "title": "qa: Failure in `p2p_fingerprint.py`",
      "body": "On FreeBSD 15.0, https://github.com/hebasto/bitcoin-core-nightly/actions/runs/21105606197/job/60696569283:\n```\n386/456 - p2p_fingerprint.py failed, Duration: 0 s\n\nstdout:\n2026-01-18T04:34:49.101209Z TestFramework (INFO): PRNG seed is: 4679507874993432966\n2026-01-18T04:34:49.102528Z TestFramework (INFO): Initializing test directory /tmp/test_runner_â‚¿_ðŸƒ_20260118_042715/p2p_fingerprint_63\n2026-01-18T04:34:49.360239Z TestFramework (ERROR): Unexpected exception\nTraceback (most recent call last):\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 138, in main\n    self.setup()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 269, in setup\n    self.setup_network()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 360, in setup_network\n    self.setup_nodes()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 382, in setup_nodes\n    self.start_nodes()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 528, in start_nodes\n    node.wait_for_rpc_connection()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_node.py\", line 316, in wait_for_rpc_connection\n    raise FailedToStartError(self._node_msg(\ntest_framework.test_node.FailedToStartError: [node 0] bitcoind exited with status 1 during initialization. Error: Unable to bind to 127.0.0.1:11756 on this computer. Bitcoin Core is probably already running.\nError: Failed to listen on any port. Use -listen=0 if you want this.\n************************\n\n2026-01-18T04:34:49.423831Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n2026-01-18T04:34:49.424142Z TestFramework (WARNING): Not cleaning up dir /tmp/test_runner_â‚¿_ðŸƒ_20260118_042715/p2p_fingerprint_63\n2026-01-18T04:34:49.424336Z TestFramework (ERROR): Test failed. Test logging available at /tmp/test_runner_â‚¿_ðŸƒ_20260118_042715/p2p_fingerprint_63/test_framework.log\n2026-01-18T04:34:49.424671Z TestFramework (ERROR): \n2026-01-18T04:34:49.425017Z TestFramework (ERROR): Hint: Call /home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/combine_logs.py '/tmp/test_runner_â‚¿_ðŸƒ_20260118_042715/p2p_fingerprint_63' to consolidate all logs\n2026-01-18T04:34:49.425220Z TestFramework (ERROR): \n2026-01-18T04:34:49.425516Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\n2026-01-18T04:34:49.425685Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\n2026-01-18T04:34:49.425795Z TestFramework (ERROR): \n\n\n```",
      "state": "open",
      "user": "hebasto",
      "created_at": "2026-01-18T12:22:44Z",
      "updated_at": "2026-01-19T18:07:51Z",
      "closed_at": null,
      "comments": 8,
      "url": "https://github.com/bitcoin/bitcoin/issues/34331",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "comment_data": [
        {
          "id": 3767024448,
          "user": "maflcko",
          "body": "From the netinet/in.h:\n\n\n```\n/*\n * Local port number conventions:\n *\n * When a user does a bind(2) or connect(2) with a port number of zero,\n * a non-conflicting local port address is chosen.\n * The default range is IPPORT_HIFIRSTAUTO through\n * IPPORT_HILASTAUTO, although that is settable by sysctl.\n *\n * A user may set the IPPROTO_IP option IP_PORTRANGE to change this\n * default assignment range.\n *\n * The value IP_PORTRANGE_DEFAULT causes the default behavior.\n *\n * The value IP_PORTRANGE_HIGH changes the range of candidate port numbers\n * into the \"high\" range.  These are reserved for client outbound connections\n * which do not want to be filtered by any firewalls.\n *\n * The value IP_PORTRANGE_LOW changes the range to the \"low\" are\n * that is (by convention) restricted to privileged processes.  This\n * convention is based on \"vouchsafe\" principles only.  It is only secure\n * if you trust the remote host to restrict these ports.\n *\n * The default range of ports and the high range can be changed by\n * sysctl(3).  (net.inet.ip.portrange.{hi,low,}{first,last})\n *\n * Changing those values has bad security implications if you are\n * using a stateless firewall that is allowing packets outside of that\n * range in order to allow transparent outgoing connections.\n *\n * Such a firewall configuration will generally depend on the use of these\n * default values.  If you change them, you may find your Security\n * Administrator looking for you with a heavy object.\n *\n * For a slightly more orthodox text view on this:\n *\n *            ftp://ftp.isi.edu/in-notes/iana/assignments/port-numbers\n *\n *    port numbers are divided into three ranges:\n *\n *                0 -  1023 Well Known Ports\n *             1024 - 49151 Registered Ports\n *            49152 - 65535 Dynamic and/or Private Ports\n *\n */\n\n/*\n * Ports < IPPORT_RESERVED are reserved for\n * privileged processes (e.g. root).         (IP_PORTRANGE_LOW)\n */\n#define\tIPPORT_RESERVED\t\t1024\n\n/*\n * Default local port range, used by IP_PORTRANGE_DEFAULT\n */\n#define IPPORT_EPHEMERALFIRST\t10000\n#define IPPORT_EPHEMERALLAST\t65535\n\n/*\n * Dynamic port range, used by IP_PORTRANGE_HIGH.\n */\n#define\tIPPORT_HIFIRSTAUTO\t49152\n#define\tIPPORT_HILASTAUTO\t65535\n```\n\n\nSo I guess this may have been broken after https://github.com/bitcoin/bitcoin/pull/34186?",
          "created_at": "2026-01-19T08:17:19Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 2316,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3767119641,
          "user": "w0xlt",
          "body": "Yes, possibly. FreeBSDâ€™s ephemeral port range (10000â€“65535) overlaps with the test frameworkâ€™s static port range (11000â€“26000).\nSetting `TEST_RUNNER_PORT_MIN=2000` in the external bitcoin-core-nightly FreeBSD CI workflow should mitigate this.",
          "created_at": "2026-01-19T08:42:15Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 242,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3767161843,
          "user": "maflcko",
          "body": "An alternative could be to set `IP_PORTRANGE_HIGH`, but I don't know how to do this on freebsd.",
          "created_at": "2026-01-19T08:53:30Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 95,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3767580324,
          "user": "hebasto",
          "body": "cc @vasild ",
          "created_at": "2026-01-19T10:26:32Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 11,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3767612122,
          "user": "w0xlt",
          "body": "A suggestion: https://github.com/bitcoin/bitcoin/pull/34336",
          "created_at": "2026-01-19T10:33:22Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 59,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3768512788,
          "user": "vasild",
          "body": "Is it correct that the failing test `p2p_fingerprint.py` (ran as 386/456) is not using `port=0` which was introduced in https://github.com/bitcoin/bitcoin/pull/34186?\n\nSo, it is probably because `feature_proxy.py` (280/456) ran before it and used port `11756` and left it in `TIME_WAIT` state (`p2p_private_broadcast.py` was 398/456 and `feature_anchors.py` was 425/456, after the failure of `p2p_fingerprint.py`), right?",
          "created_at": "2026-01-19T14:07:23Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 421,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3768753363,
          "user": "maflcko",
          "body": "> So, it is probably because `feature_proxy.py` (280/456) ran before it and used port `11756` and left it in `TIME_WAIT` state (`p2p_private_broadcast.py` was 398/456 and `feature_anchors.py` was 425/456, after the failure of `p2p_fingerprint.py`), right?\n\nAh, good observation. I'd presume that the port was still in use, but it being in `TIME_WAIT` sounds plausible.\n\n> `root# sysctl net.inet.ip.portrange.first=32768`\n\n>  Setting TEST_RUNNER_PORT_MIN=2000 ...\n\nI think if this only affects freebsd, and all freebsd people are fine to use one of the workarounds, this seems fine. However, I think ideally the tests work out of the box as-is.",
          "created_at": "2026-01-19T15:01:01Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 643,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3769590197,
          "user": "w0xlt",
          "body": "> ideally the tests work out of the box as-is.\n\nUpdated the solution in #34346 to cover IPv6 sockets used by  `feature_proxy.py`.",
          "created_at": "2026-01-19T18:07:51Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 129,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2957,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 29027200,
      "number": 3828,
      "title": "Clients leak IPs if they are recipients of a transaction",
      "body": "So, this paper http://ifca.ai/fc14/papers/fc14_submission_71.pdf got me thinking about the current rules for transaction rebroadcasting:\n\nOnce a transaction has been broadcast, you stop rebroadcasting. Unless you own txins or txouts in the transaction. \n\nSo, you use the paper's techniques. But you can be much more speculative than they are, and get a low-likelihood but possible IP match for an address, connect your client up, and issue a transaction paying yourself and a small amount to the address you're interested in, just over the dust amount.\n\nThe transaction should be constructed so it's unlikely to be mined.\n\nThe transaction traverses the network, then it stops being rebroadcast, _except_ by the recipient and you. If your client is connected to the wallet that owns the address, it will see rebroadcasting for some time, providing a very strong link between the two.\n\nThis seems like a bad outcome. \n\nI speculate that the 1Sochi transactions may have this motivation -- mapping addresses to determine IPs at large in Bitcoin. \n\nIt seems like the simplest thing would be to not re-re-broadcast to clients you've already spoken to, but I'll wait for smarter people than me to work out the right fix.\n",
      "state": "open",
      "user": "vessenes",
      "created_at": "2014-03-08T18:36:48Z",
      "updated_at": "2026-01-19T16:57:25Z",
      "closed_at": null,
      "comments": 24,
      "url": "https://github.com/bitcoin/bitcoin/issues/3828",
      "labels": [
        "Wallet",
        "Privacy"
      ],
      "comment_data": [
        {
          "id": 3755336550,
          "user": "vasild",
          "body": "> The transaction traverses the network, then it stops being rebroadcast, _except_ by the recipient and you [<sup>1</sup>](https://github.com/bitcoin/bitcoin/issues/3828#issue-29027200)\n\n> I don't think most people expect that having the qt wallet turned on means they are broadcasting IP-Address linkages to the world [<sup>2</sup>](https://github.com/bitcoin/bitcoin/issues/3828#issuecomment-39191055)\n\nI am not sure when this was changed, but it is not how it works nowadays. In other words, the wallet will not rebroadcast or treat specially a transaction received over the P2P network just because it recognizes some of its outputs as spendable (own). So, I guess this issue can be closed as resolved (by which change?).\n\nThe discussion here drifted from revealing the IP address of the owner of a given bitcoin address (privacy of bitcoin address owner) to the privacy of the source of a transaction on the P2P network. That last one is addressed in #29415, for the `sendrawtransaction` RPC at least.",
          "created_at": "2026-01-15T15:11:34Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 1006,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3756979679,
          "user": "maflcko",
          "body": "> I am not sure when this was changed, but it is not how it works nowadays. In other words, the wallet will not rebroadcast or treat specially a transaction received over the P2P network just because it recognizes some of its outputs as spendable (own). So, I guess this issue can be closed as resolved (by which change?).\n\nThere is `./test/functional/wallet_resendwallettransactions.py`, so this behavior still exists in all versions and commits since this issue was opened, until today.",
          "created_at": "2026-01-15T21:34:08Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 488,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3759965110,
          "user": "vasild",
          "body": "Yes, I was wrong. I was looking at `CTxMemPool::m_unbroadcast_txids`.",
          "created_at": "2026-01-16T13:11:14Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 0,
            "text_length": 69,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3765598040,
          "user": "mzumsande",
          "body": "> There is `./test/functional/wallet_resendwallettransactions.py`, so this behavior still exists in all versions and commits since this issue was opened, until today.\n\nWhat changed is the frequency of rebroadcast, from every 15 minutes to ~1/day (#18038).\nThis is not perfect, but it makes it more practical to avoid leaking IPs through own transactions by choosing an appropriate fee, such that rebroadcast never happens (or implement special measures such as onion-only if it hasn't confirmed after 11 hours or so).\n\nHowever, I had never realized that txns where the wallet is not the originator but is getting paid are also affected. I think this makes things much worse, because it allows third parties (who can choose the fee) to trigger the rebroadcasts of our nodes.\nThis case is also missing from `wallet_resendwallettransactions.py`, I am working on adding test coverage for that.\n\nTo prevent this, we could revive #21061 or do something similar - a simpler option would be to completely delegate the task of rebroadcasting to the sender and just disable rebroadcast of transactions where our wallet controls no inputs.\nThis would have the downside that nodes getting paid would no longer rebroadcast, which might be against their interest, but it would prevent the privacy issues.",
          "created_at": "2026-01-18T18:46:42Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 1290,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3769366743,
          "user": "maflcko",
          "body": "There's also https://github.com/bitcoin/bips/pull/1937, which IIUC was proposed after the recent divergence of mempool policies, but it may also allow to drop wallet re-broadcast.",
          "created_at": "2026-01-19T16:57:25Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 179,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1271,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3830414066,
      "number": 34343,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "deallanem-oss",
      "created_at": "2026-01-19T16:22:40Z",
      "updated_at": "2026-01-19T16:22:54Z",
      "closed_at": "2026-01-19T16:22:51Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34343",
      "labels": [],
      "comment_data": [
        {
          "id": 3769191163,
          "user": "DrahtBot",
          "body": "\nLLM spam detection (âœ¨ experimental): SPAM. The submission contains only a one-word/placeholder title and template boilerplate with no substantive description, requirements, or actionable details, indicating a non-legitimate or filler post rather than a real issue or contribution.\n\nâ™»ï¸ Automatically wiping, closing, and locking for now based on heuristics.\nGenerally, please focus on creating high-quality, original content that demonstrates a clear\nunderstanding of the project's requirements and goals.\n",
          "created_at": "2026-01-19T16:22:51Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 506,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3827821755,
      "number": 34335,
      "title": "Request: Support for Vietnamese localization of Bitcoin Core source/documents",
      "body": "Hi Bitcoin Core community ðŸ‘‹\n\nIâ€™m a developer and member of the Vietnamese Bitcoin community. We greatly appreciate all the work done by the contributors of Bitcoin Core and the open-source ecosystem.\n\nWe would like to help make Bitcoin more accessible to Vietnamese speakers by providing Vietnamese translations of:\n\nUser-facing strings in the Bitcoin Core UI (translation of menu items, labels, messages, etc.)\n\nEnd-user documentation (README, Bitcoin.org docs, guides)\n\nDeveloper documentation (API docs, examples)\n\nVietnamese is spoken by over 95 million people, and having localized docs and UI would make Bitcoin more useful and easier to adopt for Vietnamese developers and users.\n\nBefore starting work, we would like to ask for guidance and community support:\n\nIs there an existing localization process for Bitcoin Core that we should follow?\n\nShould translations be maintained in a specific format/tool (e.g., gettext .po, Crowdin, Weblate, etc.)?\n\nAre there maintainers willing to review and merge Vietnamese translations?\n\nDo you recommend guidelines for terminology (e.g., how to translate technical terms like UTXO, fee bumping, mempool, PSBT)?\n\nWe are happy to start a working group and coordinate the translation effort. Any pointers, best practices, or existing localization infrastructure would be very helpful.\n\nThanks so much for your time and for all the contributions to Bitcoin! â¤ï¸\n\nBest,\n\nLong Ngo",
      "state": "open",
      "user": "adminvsrm",
      "created_at": "2026-01-19T03:20:35Z",
      "updated_at": "2026-01-19T13:06:26Z",
      "closed_at": null,
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34335",
      "labels": [
        "Docs"
      ],
      "comment_data": [
        {
          "id": 3767381375,
          "user": "maflcko",
          "body": "> End-user documentation (README, Bitcoin.org docs, guides)\n\nThis seems the wrong place to discuss third-party translations. `bitcoin.org` is a separate website, tracked in another repo. You'll have to reach out to the respective other places to discuss translations with them.\n\n\n\n> User-facing strings in the Bitcoin Core UI (translation of menu items, labels, messages, etc.)\n\nThe GUI translations are tracked on transifex, see the docs. They also contain a \"glossary\" with terminology. \n\nAs for Bitcoin Core RPC doc translations and markdown files, I don't think there is currently any infra to support this.",
          "created_at": "2026-01-19T09:42:29Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 1,
            "text_length": 611,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1497,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3826801758,
      "number": 34332,
      "title": "BTC Node Sync time",
      "body": "I am currently trying once again to do a BTC core sync. This is proceeding at a pace of around 2% per day and after around 40 days has reached 80% - is this normal. ",
      "state": "closed",
      "user": "pcliff069",
      "created_at": "2026-01-18T13:45:29Z",
      "updated_at": "2026-01-19T12:42:27Z",
      "closed_at": "2026-01-19T00:01:26Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/34332",
      "labels": [],
      "comment_data": [
        {
          "id": 3765320058,
          "user": "l0rinc",
          "body": "Can you please provide more details?\nWhat are your specs (CPU, memory, number of processing units available, backing storage (SSD/HDD/SD/Network-attached storage) and its connection type (USB/PCIe), operating system, Core version, command line options, internet connection speed, etc)?\nAre you using a node-in-a-box solution (Umbrel, RaspiBlitz, Start9, NODL, etc.)?\nIs Tor enabled?\nWhat's your dbcache setting?\nAre any other services running simultaneously (Electrs, Fulcrum, Lightning indexing)?\nIf possible, could you share your `debug.log` file (or relevant portions) - just check it first for any private information like IP addresses you'd prefer not to share.",
          "created_at": "2026-01-18T13:59:43Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 666,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3765358473,
          "user": "pcliff069",
          "body": "It's a Start9 OS on a BMAX dedicated mini computer. I have never done one of these before and am unsure of the information you are after. Bitcoin Core has service logs - but I have no idea where they are stored when I dowbload them. It's a 2TB SSD, my internet is 1TB down. There are TOR logs so I guess Tor is enabled. Every time I check progress it seems to be Synced Timed out. REtrying soon. I moved from a 1TB SSD system because afrer  spent over a month syncing it I got nothing - Electrs just failed to load. DBcache 5000 Batch 33554432 - not touched by me. I'll try and load whatever logs I can from my main machine tomorrow..\nAnd thanks for the response.",
          "created_at": "2026-01-18T14:33:50Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 663,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3765366638,
          "user": "l0rinc",
          "body": "I have pinged Matt from Start9, maybe he can help you get the details for us, otherwise this is too vague.\nIt would help if you could paste the relevant parts of the `debug.log` for us here.",
          "created_at": "2026-01-18T14:42:39Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 190,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3766038703,
          "user": "MattDHill",
          "body": "This can only be a hardware issue, either extremely slow disk or not enought RAM. There are no known issues related to Bitcoin sync on StartOS. To confirm you can flash the hardware with another other Linux distro and sync.",
          "created_at": "2026-01-19T01:35:13Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 223,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3768153373,
          "user": "yancyribbens",
          "body": "> This can only be a hardware issue, either extremely slow disk or not enought RAM.\n\nSlowness could also be a software problem, and in this case, it seems not unlikely if Start9 uses TOR by default.  It would be best to investigate the fork of startos https://github.com/Start9Labs/start-os since this seems like a custom configuration of OS and software, including Bitcoin.",
          "created_at": "2026-01-19T12:42:27Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 374,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 184,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3629644627,
      "number": 33882,
      "title": "Standardness policy rules for legacy Multisig script is incoherent",
      "body": "Over the years policy surrounding multisig scripts, particularly for legacy multisig scripts, has evolved in a haphazard way with various PRs affecting  legacy multisig script policy without considering the ramifications.\n\nThe current status of legacy multisig script policy is as follows:\n\n* Legacy multisig outputs in transactions can be at most *m*-of-3.  All pubkeys in such outputs must be of the form of a compressed pubkey, or uncompressed pubkey, or a hybrid pubkey.\n* Legacy multisig inputs being redeemed in transaction can be *m*-of-*n* with *m* and *n* 20 or less.  Any public keys processed by OP_CHECKMULTISIG must be compressed or uncompressed pubkeys.  hybrid or other data blobs are only allowed in the unprocessed part of the public key list.\n\nWhile it is acceptable for legacy multisig output creation policy to be stricter than redemption policy, it makes no sense to allow hybrid keys in outputs by policy, but then to disallow them as inputs by policy.\n\nHowever, there are further issues. Legacy multisig policy has evolved over time.  In the beginning when legacy multisig outputs were introduced as standard by BIP 11, \"pubkeys\" were allowed by policy to be any value between 33 and 120 bytes.  Some Bitcoin users have taken advantage of those liberal policies and created legacy multisig script UTXOs that were redeemable by policy at the time they were created, but are no longer redeemable by policy today.  The UTXO 4dacd03d73cb497229dbfe2e7209adc4221540efe0e4c57f408b09b2fd36ece6:1 from 2014-01-12 is but one example.  @ajtowns's analysis in #33755 suggests there are at least 147,470 such UTXOs that have become *soft-confiscated* over time, meaning that when they were created they were redeemable by policy, but become no longer redeemable by policy and would require direct miner assistance to be spent.\n\nBased on my research, I believe there are 4 tasks that need to be done to make legacy Multisig policy coherent again.\n\n### 1. Ban hybrid keys in legacy outputs\n\nWe should strengthen the rules surrounding creating legacy multisig (and legacy single sig) to ban the use of hybrid keys.  Such keys are nearly irredeemable.  However, we should only strengthen policy around the creating new legacy script outputs without further restricting policy around redeeming legacy script UTXOs.\n\n### 2. Bring legacy script redemption policy in line with P2SH redeem script policy.\n\nP2SH redeem script policy has also evolved over time.  Current policy for P2SH redemption allow any scripts so long as they have a limited number of CHECKSIG related operations.  I see no reason why legacy script should be subject to significantly more stringent constraints than P2SH redeem scripts are.\n\n### 3. Relax `SCRIPT_VERIFY_STRICTENC` policy to only ban hybrid keys.\n\nPR #5247 went unnecessarily overboard in its quest to stomp out uses of hybrid keys and made UTXOs that already existed at the time unspendable.  PR #33755 partially reverts this change so that only hybrid keys are excluded from processing in  CHECKMULTISIG.\n\n### 4. Bring `SCRIPT_VERIFY_WITNESS_PUBKEYTYPE` policy in line with BIP 143 requirements.\n\nThis task is technically unrelated to legacy multisig policy, being instead about Segwit V0 multisig policy.  However the policy implemented in Bitcoin Core does not match the policy stated in BIP 143, and they ought to be brought into agreement. Either by implementing the policy correctly (as #33759 does), or by amending BIP 143 to describe the current policy as implemented.\n\nIn particular, both tasks 2 and 3 need to be completed in order to make stuck UTXOs, such as 4dacd03d73cb497229dbfe2e7209adc4221540efe0e4c57f408b09b2fd36ece6:1 spendable by policy again.\n\nI want to make it clear that UTXOs such as the above are not particularly abusive.  They were simply caught up incidentally in the policy changes of PR #5247, which was only about banning the use of hybrid keys.  4dacd03d73cb497229dbfe2e7209adc4221540efe0e4c57f408b09b2fd36ece6:1 has no hybrid nor hybrid looking pubkeys in it.\n\n```\t\nOP_PUSHNUM_1\nOP_PUSHBYTES_33 035bceeb417f25beaa28d133ee7b28faa1e4f5c2f76b8daf12c3fab18261718790\nOP_PUSHBYTES_33 1c434e545250525459000000000000000000000001000000004190ab0000000000\nOP_PUSHNUM_2\nOP_CHECKMULTISIG\n```\n*The script from UTXO 4dacd03d73cb497229dbfe2e7209adc4221540efe0e4c57f408b09b2fd36ece6:1*",
      "state": "open",
      "user": "roconnor-blockstream",
      "created_at": "2025-11-16T02:09:46Z",
      "updated_at": "2026-01-19T12:05:50Z",
      "closed_at": null,
      "comments": 15,
      "url": "https://github.com/bitcoin/bitcoin/issues/33882",
      "labels": [
        "Brainstorming",
        "TX fees and policy"
      ],
      "comment_data": [
        {
          "id": 3765612745,
          "user": "151henry151",
          "body": "So, have I got this right?\n\nKeeping strict template matching reserves legacy script space for future upgrades but leaves soft-confiscated UTXOs unsolvable by policy.\n\nUsing sigop-based checks, as implemented in my PR, accepts scripts when Solver() recognizes them or when they have acceptable sigop counts. This uses more of that reserved space but allows those UTXOs to be spent.\n\nThe third option is separating the \"can we parse this\" and \"is this stupid\" parts of Solver(). This would require more refactoring but could improve separation.",
          "created_at": "2026-01-18T19:02:19Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 542,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3768003259,
          "user": "ajtowns",
          "body": "We do template matching for three things: (a) figuring out known address types that the wallet can/should spend, (b) verifying newly created outputs are sane, (c) verifying existing outputs are spendable. For (a), using uncompressed/hybrid keys for a new change address would be nuts, eg, and that's also true to some (much lesser) extent for (b). But (c) is a very different case, and code reuse there has led us a bit astray, IMO anyway.\n\nI'm supportive of allowing existing utxos to be spent, particularly if they were once easily spendable using Bitcoin Core (or the satoshi client prior to the name change), and there's no ambiguity as to the validity of spending them; but outside of that, I think it makes more sense to deprecate/discourage legacy script and bare multisig (ie, scriptPubKeys for which there's no address format) rather than to support/encourage it further.\n\nFor stuff encoded in p2sh, p2wsh or tapscript, I think the only reason to make consensus-valid things unspendable is the same motive as for making inscriptions unspendable. I don't think it makes much sense to do that by default (having it be a configurable behaviour is another matter), so I guess that means I don't think BIP 143's policy-level prohibition on uncompressed/hybrid keys makes sense in the first place. The [original discussion](https://github.com/bitcoin/bitcoin/pull/8499#issuecomment-250497587) included the comment \"If we don't use this opportunity now to get rid of them, we probably won't ever be until a new script revision entirely.\" but we do have a new script revision now without them (ie, tapscript), so maintaining the difference between policy and consensus there doesn't seem to have much value to me. Likewise it doesn't really seem worth it to propose a consensus change at this point to upgrade 143's default policy to being enforced as consensus. Maybe others mileage varies? Changing the policy rule while still diverging from consensus doesn't make much sense to me. It would probably be good if someone ran a reindex with both the current and proposed policies for non-compressed keys in p2wsh enforced as a consensus rule, to see if there are any transactions in the blockchain violating those rules...\n\nAnyway, that's my (current) take, for whatever that's worth.",
          "created_at": "2026-01-19T12:05:50Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 2285,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 4407,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3826622158,
      "number": 34330,
      "title": "Contributor Retention and Participation Metrics in Bitcoin Core (Project Health Observability)",
      "body": "Note: Iâ€™m approaching this from a research and analysis perspective rather than as a code contributor.\n\nThis issue shares descriptive, non-normative metrics related to contributor retention and participation patterns in the Bitcoin Core repository, derived from publicly observable GitHub activity over time.\n\nLong-lived open-source projects commonly track indicators such as review latency, bus factor, CI reliability, and test coverage. Contributor retention and participation depth are complementary project-health signals, particularly for repositories with high review load and long-lived maintenance requirements.\n\nRecent longitudinal analysis of participation data suggests:\nA large fraction of historical participants become inactive within a year of their last recorded activity.\nLong-term active contributors represent a small fraction of total historical participants.\nHigh exit rates are observable even among contributors whose pull requests were frequently merged.\n\nThese observations are purely descriptive and do not assert intent, motivation, or off-repository contribution. â€œInactiveâ€ refers only to the absence of observable GitHub activity within a defined time window.\n\nThis issue does not propose:\nChanges to Bitcoin Core policy or consensus rules\nModifications to maintainership or decision authority\nNormative claims about how governance should function\n\nThe purpose is limited to:\n1. Assessing whether retention and participation metrics are useful additions to existing project-health observability.\n2. Determining if existing tooling already captures these signals adequately, or if gaps exist.\n3. Enabling reproducible discussion around contributor lifecycle dynamics that may affect review capacity, onboarding, and long-term maintenance load.\n\nIf this repository considers contributor retention metrics out of scope, that clarification would itself be useful for aligning expectations around which project-health signals are tracked here versus elsewhere.\n\nMethodology, assumptions, and raw aggregation logic can be shared or adjusted for comparison if helpful.\nThank you.",
      "state": "closed",
      "user": "Conrad8910",
      "created_at": "2026-01-18T10:41:47Z",
      "updated_at": "2026-01-19T11:03:30Z",
      "closed_at": "2026-01-19T08:09:14Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34330",
      "labels": [],
      "comment_data": [
        {
          "id": 3766997226,
          "user": "maflcko",
          "body": "Usually the issue tracker is used to track technical issues related to the Bitcoin Core code base.\n\nMeta tracking of meta metrics seems ideal to do elsewhere.\n\n\nThere is https://groups.google.com/g/bitcoindev, or https://delvingbitcoin.org/, or any other place that you feel is well suited.\n",
          "created_at": "2026-01-19T08:09:14Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 291,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3767744433,
          "user": "maflcko",
          "body": "<img width=\"767\" height=\"805\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/c9ab4538-59df-495c-ad22-cfe55d36d2d2\" />\n\nAlso, looking at the LFX retention metric, it seems mostly stable over the last decade, and at least this (highly volatile) metric did not seem to worsen over the timespan.",
          "created_at": "2026-01-19T11:03:30Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 304,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2197,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2797621842,
      "number": 31685,
      "title": "Let's go to PoUW!!!",
      "body": "### Please describe the feature you'd like to see added.\n\nRather than PoW (Proof of Work), why not go on PoUW (Proof of Useful Work)??? If bitcoin should do something useful, then why not? \n\n### Is your feature related to a problem, if so please describe it.\n\n_No response_\n\n### Describe the solution you'd like\n\n_No response_\n\n### Describe any alternatives you've considered\n\n_No response_\n\n### Please leave any additional context\n\n_No response_",
      "state": "closed",
      "user": "sojoyork",
      "created_at": "2025-01-19T13:17:55Z",
      "updated_at": "2026-01-19T10:56:24Z",
      "closed_at": "2025-01-19T13:26:10Z",
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/31685",
      "labels": [
        "Feature"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 466,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3804432320,
      "number": 34262,
      "title": "rpc: Assertion 'block_template' failed in `getblocktemplate` (during shutdown or startup)",
      "body": "The `CHECK_NONFATAL`  check [here](https://github.com/bitcoin/bitcoin/blob/abc6a3a4eb9814a7f17e40f7a4d330cbef86bff0/src/rpc/mining.cpp#L875) may fail when `getblocktemplate` is called during shutdown or during startup.\n\n```\nrpc/mining.cpp:875 auto getblocktemplate()::(anonymous class)::operator()(const RPCHelpMan &, const JSONRPCRequest &) const: Assertion `block_template' failed.\n```\n\nSee attached debug logs of two examples.\n\n[getblocktemplate_during_startup.log](https://github.com/user-attachments/files/24565879/getblocktemplate_during_startup.log)\n[getblocktemplate_during_shutdown.log](https://github.com/user-attachments/files/24565880/getblocktemplate_during_shutdown.log)\n\n*This was found with a test running on [Antithesis](https://antithesis.com/).*",
      "state": "open",
      "user": "dergoegge",
      "created_at": "2026-01-12T13:55:10Z",
      "updated_at": "2026-01-19T10:41:57Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34262",
      "labels": [
        "RPC/REST/ZMQ",
        "Mining"
      ],
      "comment_data": [
        {
          "id": 3763836134,
          "user": "DevPatel-11",
          "body": "I'd like to work on this. Looking at the code now.",
          "created_at": "2026-01-17T14:04:43Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 50,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3766580269,
          "user": "DevPatel-11",
          "body": "I tried reproducing this locally by spamming `getblocktemplate` calls during startup and shutdown, but couldn't trigger the race condition (given the timing window).\n\nLooking at the debug logs:\n- Shutdown case: \"Shutdown in progress...\" message appears right before the assertion failure\n- Startup case: Assertion fails while node is still initializing (network threads just starting)\n\nBoth show `Assertion 'block_template' failed`, which means `createNewBlock()` returned nullptr when the mining subsystem wasn't available.\n\nThe issue is that `CHECK_NONFATAL` assumes this should never happen, but nullptr is actually a valid return during these states. The fix is to replace the assertion with a proper null check and return an RPC error instead.\n\nI'll open a PR with the fix.",
          "created_at": "2026-01-19T06:14:07Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 778,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 854,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3775045982,
      "number": 34187,
      "title": "Intermittent issue in rpc_misc.py:                                    test_framework.authproxy.JSONRPCException: 'echoipc' RPC took longer than 1200.000000 seconds.",
      "body": "Not sure why this hits this long timeout. The logs are https://github.com/bitcoin/bitcoin/actions/runs/20618562716/job/59216177088?pr=33775#step:11:3901:\n\n```\ntest  2025-12-31T12:48:06.476897Z TestFramework (INFO): test echoipc (testing spawned process in multiprocess build) \n node0 2025-12-31T12:48:06.477022Z [http] [httpserver.cpp:307] [http_request_cb] [http] Received a POST request for / from 127.0.0.1:50326 \n node0 2025-12-31T12:48:06.477055Z [httpworker.0] [rpc/request.cpp:243] [parse] [rpc] ThreadRPCServer method=echoipc user=__cookie__ \n node0 2025-12-31T12:48:06.478285Z [httpworker.0] [ipc/interfaces.cpp:64] [spawnProcess] [ipc] Process bitcoin-node pid 17479 launched \n node0 2025-12-31T12:48:06.478605Z [httpworker.0] [ipc/capnp/protocol.cpp:53] [IpcLogFn] ipc: {bitcoin-node-17465/b-httpworker.0-17468} IPC client first request from current thread, constructing waiter \n node0 2025-12-31T12:48:06.478652Z [capnp-loop] [ipc/capnp/protocol.cpp:50] [IpcLogFn] [ipc] {bitcoin-node-17465/b-httpworker.0-17468} IPC client send Init.construct$Params \n node0 2025-12-31T12:48:06.478677Z [capnp-loop] [ipc/capnp/protocol.cpp:47] [IpcLogFn] [ipc:trace] send data: (threadMap = <external capability>) \n node0 2025-12-31T12:48:50.987744Z [scheduler] [net.cpp:2439] [StartExtraBlockRelayPeers] [net] enabling extra block-relay-only peers \n node0 2025-12-31T12:52:04.064058Z [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention m_nodes_mutex, ./net.cpp:1919 started \n node0 2025-12-31T12:52:04.064130Z [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention m_nodes_mutex, ./net.cpp:1919 completed (7Î¼s) \n node0 2025-12-31T12:52:42.016032Z [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention m_nodes_mutex, ./net.cpp:1919 started \n node0 2025-12-31T12:52:42.016107Z [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention m_nodes_mutex, ./net.cpp:1919 completed (8Î¼s) \n node0 2025-12-31T12:53:06.019385Z [addcon] [logging/timer.h:58] [Log] [lock] Enter: lock contention m_nodes_mutex, ./net.cpp:2924 started \n node0 2025-12-31T12:53:06.019463Z [addcon] [logging/timer.h:58] [Log] [lock] Enter: lock contention m_nodes_mutex, ./net.cpp:2924 completed (7Î¼s) \n node0 2025-12-31T12:59:30.084915Z [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention m_nodes_mutex, ./net.cpp:1919 started \n node0 2025-12-31T12:59:30.084991Z [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention m_nodes_mutex, ./net.cpp:1919 completed (7Î¼s) \n node0 2025-12-31T13:01:13.165088Z [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention m_nodes_mutex, ./net.cpp:1919 started \n node0 2025-12-31T13:01:13.165160Z [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention m_nodes_mutex, ./net.cpp:1919 completed (7Î¼s) \n node0 2025-12-31T13:03:05.989149Z [scheduler] [net.cpp:2401] [DumpAddresses] [net] Flushed 0 addresses to peers.dat  1ms \n node0 2025-12-31T13:04:09.110919Z [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention m_nodes_mutex, ./net.cpp:1919 started \n node0 2025-12-31T13:04:09.110995Z [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention m_nodes_mutex, ./net.cpp:1919 completed (7Î¼s) \n node0 2025-12-31T13:04:39.009903Z [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention m_nodes_mutex, ./net.cpp:1919 started \n node0 2025-12-31T13:04:39.009991Z [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention m_nodes_mutex, ./net.cpp:1919 completed (8Î¼s) \n test  2025-12-31T13:08:06.577668Z TestFramework (ERROR): Unexpected exception \n                                   Traceback (most recent call last):\n                                     File \"/home/admin/actions-runner/_work/_temp/test/functional/test_framework/authproxy.py\", line 174, in _get_response\n                                       http_response = self.__conn.getresponse()\n                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/usr/lib/python3.12/http/client.py\", line 1430, in getresponse\n                                       response.begin()\n                                     File \"/usr/lib/python3.12/http/client.py\", line 331, in begin\n                                       version, status, reason = self._read_status()\n                                                                 ^^^^^^^^^^^^^^^^^^^\n                                     File \"/usr/lib/python3.12/http/client.py\", line 292, in _read_status\n                                       line = str(self.fp.readline(_MAXLINE + 1), \"iso-8859-1\")\n                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/usr/lib/python3.12/socket.py\", line 720, in readinto\n                                       return self._sock.recv_into(b)\n                                              ^^^^^^^^^^^^^^^^^^^^^^^\n                                   TimeoutError: timed out\n                                   During handling of the above exception, another exception occurred:\n                                   Traceback (most recent call last):\n                                     File \"/home/admin/actions-runner/_work/_temp/test/functional/test_framework/test_framework.py\", line 142, in main\n                                       self.run_test()\n                                     File \"/home/admin/actions-runner/_work/_temp/build/test/functional/rpc_misc.py\", line 96, in run_test\n                                       assert_equal(node.echoipc(\"hello\"), \"hello\")\n                                                    ^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/home/admin/actions-runner/_work/_temp/test/functional/test_framework/coverage.py\", line 50, in __call__\n                                       return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\n                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/home/admin/actions-runner/_work/_temp/test/functional/test_framework/authproxy.py\", line 137, in __call__\n                                       response, status = self._request('POST', self.__url.path, postdata.encode('utf-8'))\n                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/home/admin/actions-runner/_work/_temp/test/functional/test_framework/authproxy.py\", line 111, in _request\n                                       return self._get_response()\n                                              ^^^^^^^^^^^^^^^^^^^^\n                                     File \"/home/admin/actions-runner/_work/_temp/test/functional/test_framework/authproxy.py\", line 176, in _get_response\n                                       raise JSONRPCException({\n                                   test_framework.authproxy.JSONRPCException: 'echoipc' RPC took longer than 1200.000000 seconds. Consider using larger timeout for calls that take longer to return. (-344)\n",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-01T19:00:59Z",
      "updated_at": "2026-01-19T09:48:46Z",
      "closed_at": null,
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/34187",
      "labels": [
        "CI failed"
      ],
      "comment_data": [
        {
          "id": 3767407092,
          "user": "maflcko",
          "body": "> [bitcoin-core/libmultiprocess#237](https://github.com/bitcoin-core/libmultiprocess/pull/237) probably fixes this\n\nI guess the subtree would have to be bumped ",
          "created_at": "2026-01-19T09:48:46Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 160,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 7241,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 378920700,
      "number": 14692,
      "title": "Can't configure bitocoind to only send tx via Tor but receive clearnet transactions",
      "body": "<!-- Describe the issue -->\r\nThere does not seen to be a way to enable onlynet=onion for sending only and regular clearnet for receiving only.\r\n\r\n<!--- What behavior did you expect? -->\r\nI expected that onlynet=onion would mean outbound connections from only onion nodes. This sort of works but I need to manually add nodes and then if a node is not open also to the outside I am in an isolate Bitcoin network. I also do not seem to be getting any inbound connections with onlynet=onion is this because my IP is always different under Tor and I need to post my .onion domain somewhere for people to find?\r\n\r\n<!--- What was the actual behavior (provide screenshots if the issue is GUI-related)? -->\r\n\r\n<!--- How reliably can you reproduce the issue, what are the steps to do so? -->\r\n\r\n<!-- What version of Bitcoin Core are you using, where did you get it (website, self-compiled, etc)? -->\r\n0.17\r\n<!-- What type of machine are you observing the error on (OS/CPU and disk type)? -->\r\nUbuntu 18.04\r\n<!-- Any extra information that might be useful in the debugging process. -->\r\n<!--- This is normally the contents of a `debug.log` or `config.log` file. Raw text or a link to a pastebin type site are preferred. -->\r\n",
      "state": "open",
      "user": "ultimatevert",
      "created_at": "2018-11-08T21:17:55Z",
      "updated_at": "2026-01-19T09:23:17Z",
      "closed_at": null,
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/issues/14692",
      "labels": [
        "Feature",
        "Wallet"
      ],
      "comment_data": [
        {
          "id": 3755757200,
          "user": "vasild",
          "body": "Implemented in https://github.com/bitcoin/bitcoin/pull/29415 for the `sendrawtransaction` RPC. Not for the wallet yet. For the wallet, one could create unsigned PSBT from the GUI and then use the `walletprocesspsbt` and `sendrawtransaction` RPCs.",
          "created_at": "2026-01-15T16:36:13Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 246,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1298,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1280635065,
      "number": 25450,
      "title": "Ability to broadcast wallet transactions only via dedicated oneshot Tor connections",
      "body": "It would be nice to have an option to never add your own transactions to the mempool directly and/or broadcast them individually only via a oneshot Tor connection.\r\n\r\nThis is essentially important for users who need blocksonly mode, who would otherwise be forced to choose between being unable to send transactions at all or harming their privacy by only broadcasting their own.\r\n\r\nRelated Twitter thread: https://twitter.com/alpacasw/status/1539660524543045633?t=5DSn3bUEb-AvQ-pPb0GXXg&s=19",
      "state": "closed",
      "user": "luke-jr",
      "created_at": "2022-06-22T17:46:21Z",
      "updated_at": "2026-01-19T09:22:56Z",
      "closed_at": "2026-01-19T09:22:56Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/25450",
      "labels": [
        "Feature",
        "Wallet",
        "P2P"
      ],
      "comment_data": [
        {
          "id": 3755800621,
          "user": "vasild",
          "body": "Implemented in https://github.com/bitcoin/bitcoin/pull/29415 for the `sendrawtransaction` RPC. Not for the wallet yet. For the wallet, one could create unsigned PSBT from the GUI and then use the `walletprocesspsbt` and `sendrawtransaction` RPCs.",
          "created_at": "2026-01-15T16:41:45Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 246,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3767292474,
          "user": "maflcko",
          "body": "> duplicate of [#24557 (comment)](https://github.com/bitcoin/bitcoin/issues/24557#issuecomment-1066663937) ?\n\nClosing as duplicate of https://github.com/bitcoin/bitcoin/issues/14692",
          "created_at": "2026-01-19T09:22:56Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 181,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 575,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2978404475,
      "number": 32235,
      "title": "Tor: TX circuit isolation",
      "body": "Create an option that would forcefully terminate any connection that just sent a locally originating transaction.\n\n-proxyrandomize ensures that each connection corresponds to a tor circuit, therefore terminating connection = terminating circuit\n\nthe same circuit will not send more than 1 transaction. achieving desirable privacy properties.\n\nthis is a preferable solution to the proposed overengineered mess of https://github.com/bitcoin/bitcoin/pull/29415\n",
      "state": "closed",
      "user": "learnwayback",
      "created_at": "2025-04-08T02:08:42Z",
      "updated_at": "2026-01-19T09:15:01Z",
      "closed_at": "2026-01-19T09:15:01Z",
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/issues/32235",
      "labels": [
        "Feature"
      ],
      "comment_data": [
        {
          "id": 3755854458,
          "user": "vasild",
          "body": "Implemented in https://github.com/bitcoin/bitcoin/pull/29415.",
          "created_at": "2026-01-15T16:51:00Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 61,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 484,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3812548980,
      "number": 34280,
      "title": "Coins Cache Cleanup checklist",
      "body": "The coins cache (the `CCoinsView*` stack, `CCoinsViewCache`, and friends) is a correctness- and performance-critical part of validation, IBD, and assumeutxo.\nOver time it has accumulated subtle invariants and legacy states (around cache entry flags, spent coin handling, and error catching), and we have been chipping away at it through focused refactors, bugfixes, tests, and performance work.\n\nThis issue tracks the related PRs to help reviewers see how they fit together.\nThe overall aim is fewer error cases, cleaner cache layering, and parallel validation.\n\n## PRs needing review\n\n### Remove invalid cache states\n\n* [ ] https://github.com/bitcoin/bitcoin/pull/34207 - ensure `GetCoin()` only returns unspent coins, align tests with production.\n* [ ] https://github.com/bitcoin/bitcoin/pull/33018 - remove unreachable FRESH-but-not-DIRTY state.\n\n### Simplify view hierarchy\n\n* [ ] https://github.com/bitcoin/bitcoin/pull/34124 - make `CCoinsView` purely virtual, add explicit `CCoinsViewEmpty`.\n* [ ] https://github.com/bitcoin/bitcoin/pull/34320 - replace `HaveCoin()` with `GetCoin()`.\n* [ ] https://github.com/bitcoin/bitcoin/pull/34132 - inline error catcher into `CCoinsViewDB`, simplify hot path.\n\n### Isolate block connection\n\n* [ ] https://github.com/bitcoin/bitcoin/pull/34165 - add non-mutating `PeekCoin()` to avoid polluting the main cache.\n* [ ] https://github.com/bitcoin/bitcoin/pull/34164 - add `Reset()` and reusable view to discard failed connects cheaply.\n\n### Flush behavior\n\n* [ ] https://github.com/bitcoin/bitcoin/pull/34125 - consistent `Sync()` vs `Flush()` decision (no behavior change).\n* [ ] https://github.com/bitcoin/bitcoin/pull/33680 - split `FORCE_SYNC`/`FORCE_FLUSH`, keep cache warm for `scantxoutset`/`gettxoutsetinfo`/snapshots.\n* [ ] https://github.com/bitcoin/bitcoin/pull/33512 - track dirty entries so flush progress reflects actual writes.\n\n### Parallel coin fetching\n\n* [ ] https://github.com/bitcoin/bitcoin/pull/31132 - async input prefetch during `ConnectBlock`.\n\n### Other\n\n* [ ] https://github.com/bitcoin/bitcoin/pull/33854 - fix assumevalid ignored during reindex (see #31494).\n* [ ] https://github.com/bitcoin/bitcoin/pull/32317 - move UTXO access to `SpendBlock` (kernel API, Utreexo, SwiftSync).\n\n## Recently merged\n\n* https://github.com/bitcoin/bitcoin/pull/33866 - remove always-true return from `BatchWrite`.\n* https://github.com/bitcoin/bitcoin/pull/33657 - allow reading partial block data (useful for bindex).\n* https://github.com/bitcoin/bitcoin/pull/33602 - reduce map lookups in `BatchWrite`.\n* https://github.com/bitcoin/bitcoin/pull/33333 - warn when `-dbcache` exceeds RAM cap.\n\nIRC context: https://bitcoin-irc.chaincode.com/bitcoin-core-dev/2026-01-08",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-14T10:23:16Z",
      "updated_at": "2026-01-18T18:27:22Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34280",
      "labels": [
        "Tracking Issue"
      ],
      "comment_data": [
        {
          "id": 3765542029,
          "user": "sedited",
          "body": "The issue seems a bit overladen - I don't think listing all these PRs is useful. Maybe distill this down to just the coins-related PRs? The benefit I would expect from this issue is that I can connect the various PRs touching the coins and see how they relate to each other. Maybe to add to the benefits in the opening paragraph a bit: Fewer error cases, more ergonomic cache layering, and preparation for asynchronous operations. ",
          "created_at": "2026-01-18T17:48:54Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 431,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3765578555,
          "user": "l0rinc",
          "body": "Thanks for the suggestions @sedited and @andrewtoth.\nUpdated the tracker and grouped the PRs - hopefully this helps reviewers see the structure (though many conflict or overlap depending on merge order).\nI put cleanups first since they'd let us avoid ugly hacks in the larger PRs, culminating in the parallel input fetcher.\nLet me know what else to adjust.\n",
          "created_at": "2026-01-18T18:27:02Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 357,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2752,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3825454472,
      "number": 34326,
      "title": "node uptime wrong",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nSystem is freshly booted but bitcoind show wrong uptime:\n\n```\nroot@raspberrypi5-c8-bf-64:~# bitcoin-cli -conf=/etc/bitcoin/bitcoin.conf uptime\n20120688\n\n```\n\nMy real uptime:\n```\nroot@raspberrypi5-c8-bf-64:~# uptime \n 15:53:22 up 10 min,  0 user,  load average: 0.61, 0.56, 0.31\n```\nversion:\n```\nroot@raspberrypi5-c8-bf-64:~# bitcoind --version\nBitcoin Core daemon version v30.2.0 bitcoind\nCopyright (C) 2009-2026 The Bitcoin Core developers\n\nPlease contribute if you find Bitcoin Core useful. Visit\n<https://bitcoincore.org/> for further information about the software.\nThe source code is available from <https://github.com/bitcoin/bitcoin>.\n\nThis is experimental software.\nDistributed under the MIT software license, see the accompanying file COPYING\nor <https://opensource.org/license/MIT>\n\n```\nbitcoin conf file:\n```\nroot@raspberrypi5-c8-bf-64:~# cat /etc/bitcoin/bitcoin.conf \n#############################################################\n# Bitcoin configuration file\n#############################################################\npid=/run/bitcoin/bitcoind.pid\nnodebuglogfile=1\ndatadir=/var/bitcoin\nloglevel=info\nproxy=127.0.0.1:9050\nsigner=/usr/bin/hwi\n\n# Settings for signet Network\nsignet=1\n\n[signet]\nwalletdir=/var/wallets\nlisten=1\nbind=127.0.0.1\nport=38333\n\n# RPC Settings\nrpcuser=satobox\nrpcport=38332\nrpcbind=127.0.0.1\nrpcallowip=127.0.0.1\nrpcauth=satobox:3381456077fa06cabce053c62a368693$263f4f1cbdc1b4b25233385b931807508f5d8bd59d2c46dc418e4ea2b23dfd09\nrpccookiefile=/run/bitcoin/cookie\nrpccookieperms=group\nserver=1\ndeprecatedrpc=warnings\n```\n\n### Expected behaviour\n\nshould show correct uptime\n\n### Steps to reproduce\n\njust build new bitcoin core and test with commands above\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nv30.2\n\n### Operating system and version\n\nlinux \n\n### Machine specifications\n\nraspberrypi5",
      "state": "open",
      "user": "embetrix",
      "created_at": "2026-01-17T15:56:13Z",
      "updated_at": "2026-01-17T20:02:23Z",
      "closed_at": null,
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/34326",
      "labels": [],
      "comment_data": [
        {
          "id": 3764064658,
          "user": "pinheadmz",
          "body": "Just to be sure... is the clock on your system correct?",
          "created_at": "2026-01-17T16:10:20Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 55,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3764069251,
          "user": "embetrix",
          "body": "@pinheadmz correct the rpi5 does not have an RTC backed up with a battery so if `bitcoind` start before the NTP is synchronized the` bitcoin-cli uptime` shows incorrect uptime",
          "created_at": "2026-01-17T16:15:39Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 175,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3764108689,
          "user": "pinheadmz",
          "body": "What happens if the clock is correct when you start Bitcoin and still correct when you make the RPC?",
          "created_at": "2026-01-17T17:02:09Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 100,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3764113111,
          "user": "l0rinc",
          "body": "I was able to reproduce the reported behavior on an RPi5 by simulating a large clock correction using regtest `setmocktime` (and also via explicit `timedatectl set-ntp false`)\n\n```bash\n$ cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=Release && ninja -C build bitcoind bitcoin-cli -j$(nproc)\n# ...\n$ DATA_DIR=$(mktemp -d)\n$ ./build/bin/bitcoind -regtest -datadir=\"$DATA_DIR\" -connect=0 -daemon\nBitcoin Core starting\n$ ./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" -rpcwait uptime\n1\n$ ./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" setmocktime $(( $(date +%s) + 20000000 ))\n$ ./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" uptime\n20000001\n$ ./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" stop\nBitcoin Core stopping\n```\n\nI will push a fix for this to use a `std::chrono::steady_clock` instead.",
          "created_at": "2026-01-17T17:07:04Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 816,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3764276602,
          "user": "l0rinc",
          "body": "Thanks for the report, fixed it in https://github.com/bitcoin/bitcoin/pull/34328 - if you can, please try it out locally to confirm",
          "created_at": "2026-01-17T20:02:23Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 131,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 2053,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 957290337,
      "number": 22592,
      "title": "LeakSanitizer detects memory leak if CDBWrapper ctor fails",
      "body": "While running the functional tests under LSAN and 8 parallel jobs, `CDBWrapper` ctor would regularly throw via `HandleError` because of low disk space.  This would make LSAN error because the destructor for `CDBWrapper` was never called and so the `options.block_cache` and some other parameters wouldn't be destructed.\r\n\r\nLSAN output (I deleted the file, but managed to take a picture of it, so log is kind of truncated):\r\n```\r\n==1204791==ERROR:  LeakSanitizer: detected memory leaks\r\n\r\nDirect leak of 3520 byte(s) in 1 object(s) allocated from:\r\n       #0 0x55f632912679 in operator new(unsigned long)\r\n       #1 0x55f6342936d6 in leveldb::NewLRUCache(unsigned long)\r\n       #2 0x55f6335f66f8 in GetOptions(unsigned long)\r\n       #3 0x55f6335f4ec7 in CDBWrapper::CDBWrapper(boost::filesystem::path const&, unsigned long, bool, bool, bool)\r\n       #4 0x55f6332e32cf in std::_MakeUniq<CDBWrapper>::__single_object std::make_unique<CoinsViews ...truncated...\r\n       #5 0x55f6332d2781 in CCoinsViewDB::CCoinsViewDB(boost::filesystem::path, unsigned long, bool, bool)\r\n       #6 0x55f6333ec6e2 in CoinsViews::CoinsViews(std::__cxx11::basic_string<char, std::char_traits<char>, ...truncated...\r\n       #7 0x55f63346a111 in std::_MakeUniq<CoinsViews>::__single_object std::make_unique<CoinsViews, ...truncated...\r\n       #8 0x55f6333ed379 in CChainState::InitCoinsDB(unsigned long, bool, bool, std::__cxx11::basic_string ...truncated...\r\n       #9 0x55f6329699e0 in AppInitMain(NodeContext&, interfaces::BlockAndHeaderTipInfo*)\r\n       #10 0x55f63291868e in AppInit(NodeContext&, int, char**)\r\n       #11 0x55f632915e2f in main\r\n       #12 0x7f86b6f7fb24 in __libc_start_main\r\n```",
      "state": "open",
      "user": "Crypt-iQ",
      "created_at": "2021-07-31T17:44:31Z",
      "updated_at": "2026-01-16T18:14:44Z",
      "closed_at": null,
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/issues/22592",
      "labels": [
        "Bug"
      ],
      "comment_data": [
        {
          "id": 3759572369,
          "user": "willcl-ark",
          "body": "@Crypt-iQ do you think this is likely still an issue? It seems to be difficult to hit (I can't reproduce on a few tries locally), and the PR didn't get enough time dedicated to it to see it through.\n\nDo you think it's worth keeping open to see if someone else will pick it up? ",
          "created_at": "2026-01-16T11:19:11Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 277,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3759661609,
          "user": "maflcko",
          "body": "> It seems to be difficult to hit (I can't reproduce on a few tries locally)\n\nI think IO fault injection could help here as well, ignoring any program state and program exit code, and only looking for sanitizer issues.\n\nI wanted to implement this for a long time. cc @dergoegge you may also want to try this in your infra?",
          "created_at": "2026-01-16T11:41:59Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 322,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3759666248,
          "user": "maflcko",
          "body": "(also removed the 'up for grabs' from the pull, as this issue is open, so it is clear that this may be up-for-grabs, as long as the issue is open)",
          "created_at": "2026-01-16T11:43:29Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 146,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3761238495,
          "user": "Crypt-iQ",
          "body": "> [@Crypt-iQ](https://github.com/Crypt-iQ) do you think this is likely still an issue? It seems to be difficult to hit (I can't reproduce on a few tries locally), and the PR didn't get enough time dedicated to it to see it through.\n> \n> Do you think it's worth keeping open to see if someone else will pick it up?\n\nI'm still able to reproduce by running under address sanitizer and `ASAN_OPTIONS=\"detect_leaks=1\"` with the following diff on top of 0ffb20dee17858e0f13b23fce3dd0ec06cbeb9a2 (latest commit should work as well):\n\n<details>\n<summary>Diff</summary>\n\n```\ndiff --git a/src/dbwrapper.cpp b/src/dbwrapper.cpp\nindex b3f08cb20d..ebee13d120 100644\n--- a/src/dbwrapper.cpp\n+++ b/src/dbwrapper.cpp\n@@ -240,7 +240,8 @@ CDBWrapper::CDBWrapper(const DBParams& params)\n     // on Windows it converts from UTF-8 to UTF-16 before calling ::CreateFileW\n     // (see env_posix.cc and env_windows.cc).\n     leveldb::Status status = leveldb::DB::Open(DBContext().options, fs::PathToString(params.path), &DBContext().pdb);\n-    HandleError(status);\n+    const std::string errmsg = \"Fatal!\";\n+    throw dbwrapper_error(errmsg);\n     LogInfo(\"Opened LevelDB successfully\");\n \n     if (params.options.force_compact) {\n```\n</details>\n\nI think it's pretty benign but it's good to not have false positives so I think this should stay open?",
          "created_at": "2026-01-16T18:14:44Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 1325,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1735,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3515047935,
      "number": 33628,
      "title": "Minor Release 29.3",
      "body": "ðŸš§ Milestone: https://github.com/bitcoin/bitcoin/milestone/80\n\nBackports and other changes\n- #33623\n- #33611\n- #34222\n- #33788\n- #34268\n\n\nRC 1\n- [x] final changes #34268\n- [x] tag\n- [] upload binaries\n- [] announcements\n\n\nSee [release process docs](https://github.com/bitcoin/bitcoin/blob/master/doc/release-process.md) for more details. This issue can be used to track status updates. Please feel free to suggest backports in the comments.",
      "state": "open",
      "user": "glozow",
      "created_at": "2025-10-14T18:35:27Z",
      "updated_at": "2026-01-16T18:05:47Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/33628",
      "labels": [
        "Tracking Issue"
      ],
      "comment_data": [
        {
          "id": 3750878303,
          "user": "glozow",
          "body": "Reviewers: please take a look at #34268 so we can have an RC1",
          "created_at": "2026-01-14T17:55:56Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 61,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3761208349,
          "user": "glozow",
          "body": "rc1 has been tagged https://github.com/bitcoin/bitcoin/releases/tag/v29.3rc1",
          "created_at": "2026-01-16T18:05:36Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 76,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 458,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3746547140,
      "number": 34110,
      "title": "scriptpubkeyman fuzz target creates Base58 too large; Fails on 32-bit (armhf, ...)",
      "body": "Decoding should not behave differently on different architectures. See also the related commit 3789215f73466606eb111714f596a2a5e9bb1933.\n\nHowever, the `scriptpubkeyman` fuzz target seems to create base58 strings so large that `uint32_t` overflows for calculations in base58.cpp.\n\nThis is a bit hard to reproduce, because 32-bit platforms are rare and most of them don't support running the unsigned integer overflow sanitizer. So the possible options to reproduce are:\n\n* Run on armhf and manually annotate the code to detect the overflow\n* Run on i386 with the integer sanitizer (possibly via `podman run -it --rm --platform linux/i386 'debian:trixie'`)\n* Run the integer sanitizer on any 64-bit platform and manually replace type in the affected line by `uint32_t`\n\nAfterwards, the steps to reproduce are:\n\n```\nexport DEBIAN_FRONTEND=noninteractive && apt update && apt install curl wget htop git vim ccache -y && git clone https://github.com/bitcoin/bitcoin.git  --depth=1 ./b-c && cd b-c && apt install build-essential cmake pkg-config  python3-zmq libzmq3-dev libevent-dev libboost-dev libsqlite3-dev  systemtap-sdt-dev  libcapnp-dev capnproto  libqrencode-dev qt6-tools-dev qt6-l10n-tools qt6-base-dev  clang llvm libc++-dev libc++abi-dev   -y\n\ncmake -B ./bld-cmake -DCMAKE_BUILD_TYPE=Debug -DCMAKE_C_COMPILER='clang' -DCMAKE_CXX_COMPILER='clang++' -DSANITIZERS=undefined,integer,float-divide-by-zero --preset=dev-mode\n\ncmake --build ./bld-cmake --parallel  $(nproc)\n\ncurl -fLO 'https://github.com/bitcoin-core/qa-assets/raw/b5ad78e070e4cf36beb415d7b490d948d70ba73f/fuzz_corpora/scriptpubkeyman/1cf91e0c6bfff9dafcd4db5b0ba36b1e906f4cf5'\n\nUBSAN_OPTIONS=\"suppressions=$(pwd)/test/sanitizer_suppressions/ubsan:print_stacktrace=1:halt_on_error=1:report_error_type=1\" FUZZ=scriptpubkeyman ./bld-cmake/bin/fuzz ./1cf91e0c6bfff9dafcd4db5b0ba36b1e906f4cf5\n```\n\nThe output will be something like:\n\n```\n/b-c/src/base58.cpp:54:28: runtime error: unsigned integer overflow: 8744655 * 733 cannot be represented in type 'size_t' (aka 'unsigned int')\n    #0 0x5985f849 in DecodeBase58(char const*, std::vector<unsigned char, std::allocator<unsigned char>>&, int) /b-c/bld-cmake/src/./base58.cpp:54:28\n    #1 0x59860a8b in DecodeBase58Check(char const*, std::vector<unsigned char, std::allocator<unsigned char>>&, int) /b-c/bld-cmake/src/./base58.cpp:148:10\n    #2 0x5986093b in DecodeBase58Check(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>> const&, std::vector<unsigned char, std::allocator<unsigned char>>&, int) /b-c/bld-cmake/src/./base58.cpp:168:12\n    #3 0x599c4fc8 in DecodeSecret(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>> const&) /b-c/bld-cmake/src/./key_io.cpp:217:9\n    #4 0x59b05478 in (anonymous namespace)::ParsePubkeyInner(unsigned int, std::span<char const, 4294967295u> const&, (anonymous namespace)::ParseScriptContext, FlatSigningProvider&, bool&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>>&) /b-c/bld-cmake/src/./script/descriptor.cpp:1789:20\n    #5 0x59af4256 in (anonymous namespace)::ParsePubkey(unsigned int&, std::span<char const, 4294967295u> const&, (anonymous namespace)::ParseScriptContext, FlatSigningProvider&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>>&) /b-c/bld-cmake/src/./script/descriptor.cpp:1978:16\n    #6 0x59adc3af in (anonymous namespace)::ParseScript(unsigned int&, std::span<char const, 4294967295u>&, (anonymous namespace)::ParseScriptContext, FlatSigningProvider&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>>&) /b-c/bld-cmake/src/./script/descriptor.cpp:2148:24\n    #7 0x59adbc65 in Parse(std::basic_string_view<char, std::char_traits<char>>, FlatSigningProvider&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>>&, bool) /b-c/bld-cmake/src/./script/descriptor.cpp:2751:16\n    #8 0x597ad5de in wallet::(anonymous namespace)::CreateWalletDescriptor(FuzzedDataProvider&) /b-c/bld-cmake/src/test/fuzz/./wallet/test/fuzz/scriptpubkeyman.cpp:73:61\n    #9 0x597ac489 in wallet::(anonymous namespace)::scriptpubkeyman_fuzz_target(std::span<unsigned char const, 4294967295u>) /b-c/bld-cmake/src/test/fuzz/./wallet/test/fuzz/scriptpubkeyman.cpp:104:22\n    #10 0x58950a8e in void std::__invoke_impl<void, void (*&)(std::span<unsigned char const, 4294967295u>), std::span<unsigned char const, 4294967295u>>(std::__invoke_other, void (*&)(std::span<unsigned char const, 4294967295u>), std::span<unsigned char const, 4294967295u>&&) /usr/lib/gcc/i686-linux-gnu/14/../../../../include/c++/14/bits/invoke.h:61:14\n    #11 0x589508eb in std::enable_if<is_invocable_r_v<void, void (*&)(std::span<unsigned char const, 4294967295u>), std::span<unsigned char const, 4294967295u>>, void>::type std::__invoke_r<void, void (*&)(std::span<unsigned char const, 4294967295u>), std::span<unsigned char const, 4294967295u>>(void (*&)(std::span<unsigned char const, 4294967295u>), std::span<unsigned char const, 4294967295u>&&) /usr/lib/gcc/i686-linux-gnu/14/../../../../include/c++/14/bits/invoke.h:111:2\n    #12 0x5895044b in std::_Function_handler<void (std::span<unsigned char const, 4294967295u>), void (*)(std::span<unsigned char const, 4294967295u>)>::_M_invoke(std::_Any_data const&, std::span<unsigned char const, 4294967295u>&&) /usr/lib/gcc/i686-linux-gnu/14/../../../../include/c++/14/bits/std_function.h:290:9\n    #13 0x5982ac95 in std::function<void (std::span<unsigned char const, 4294967295u>)>::operator()(std::span<unsigned char const, 4294967295u>) const /usr/lib/gcc/i686-linux-gnu/14/../../../../include/c++/14/bits/std_function.h:591:9\n    #14 0x5981f0da in test_one_input(std::span<unsigned char const, 4294967295u>) /b-c/bld-cmake/src/test/fuzz/util/./test/fuzz/fuzz.cpp:88:5\n    #15 0x59821b80 in main /b-c/bld-cmake/src/test/fuzz/util/./test/fuzz/fuzz.cpp:271:13\n    #16 0xf75a8cc2  (/lib/i386-linux-gnu/libc.so.6+0x24cc2) (BuildId: 2dc5f2945fad35c1b07d1a5a32520b3c41afaa75)\n    #17 0xf75a8d87 in __libc_start_main (/lib/i386-linux-gnu/libc.so.6+0x24d87) (BuildId: 2dc5f2945fad35c1b07d1a5a32520b3c41afaa75)\n    #18 0x58917db6 in _start (/b-c/bld-cmake/bin/fuzz+0x235ddb6) (BuildId: 7d8d83a77923f14e99c0de64acbc5f5bfc2cce9b)\n\nSUMMARY: UndefinedBehaviorSanitizer: unsigned-integer-overflow /b-c/src/base58.cpp:54:28 \n```\n\n\nObviously, it would be trivial to fix this by using the same type on 64-bit and 32-bit:\n\n```diff\n    refactor: Use uint64_t over size_t for multiplications in DecodeBase58\n\ndiff --git a/src/base58.cpp b/src/base58.cpp\nindex 19a5bd3e55..5364b8276b 100644\n--- a/src/base58.cpp\n+++ b/src/base58.cpp\n@@ -51,7 +51,7 @@ static const int8_t mapBase58[256] = {\n         psz++;\n     }\n     // Allocate enough space in big-endian base256 representation.\n-    int size = strlen(psz) * 733 /1000 + 1; // log(58) / log(256), rounded up.\n+    int size(uint64_t{std::strlen(psz)} * 733 / 1000 + 1); // log(58) / log(256), rounded up.\n     std::vector<unsigned char> b256(size);\n     // Process the characters.\n     static_assert(std::size(mapBase58) == 256, \"mapBase58.size() should be 256\"); // guarantee not out of range\n```\n\nHowever, this seems like the wrong fix. A string of size `8744655` seems a bit large and should probably be rejected by the wallet code (if applicable), or by the fuzz target, if the condition is unreachable in  a production wallet.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-12-19T08:12:11Z",
      "updated_at": "2026-01-16T11:57:00Z",
      "closed_at": "2026-01-13T23:28:47Z",
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/issues/34110",
      "labels": [
        "Wallet"
      ],
      "comment_data": [
        {
          "id": 3759461248,
          "user": "maflcko",
          "body": "Same for `mocked_descriptor_parse`: \n\n```\nINFO: Running with entropic power schedule (0xFF, 100).\nINFO: Seed: 1714490762\nINFO: Loaded 1 modules   (657270 inline 8-bit counters): 657270 [0x6387296c, 0x639130e2), \nINFO: Loaded 1 PC tables (657270 PCs): 657270 [0x639130e4,0x63e16c94), \nINFO:     5257 files found in /ci_container_base/ci/scratch/qa-assets/fuzz_corpora/mocked_descriptor_parse\nINFO: -max_len is not provided; libFuzzer will not generate inputs larger than 974352 bytes\nINFO: seed corpus: files: 5257 min: 1b max: 974352b total: 9424368b rss: 107Mb\n#512\tpulse  cov: 20310 ft: 76934 corp: 456/6161b exec/s: 128 rss: 127Mb\n#1024\tpulse  cov: 22356 ft: 110101 corp: 892/17Kb exec/s: 51 rss: 150Mb\n#2048\tpulse  cov: 23009 ft: 140010 corp: 1708/60Kb exec/s: 18 rss: 267Mb\nSlowest unit: 10 s:\nartifact_prefix='./'; Test unit written to ./slow-unit-ae69994a5ca2f513b9be415b80a63c2bec327907\nSlowest unit: 14 s:\nartifact_prefix='./'; Test unit written to ./slow-unit-56da48177d25572299ddf60d57a42d7bce5e317b\n#4096\tpulse  cov: 23542 ft: 163125 corp: 3119/324Kb exec/s: 2 rss: 692Mb\nSlowest unit: 19 s:\nartifact_prefix='./'; Test unit written to ./slow-unit-692b9a7c56b3023f2d1ae3cd2a2e262c063ca1d0\nSlowest unit: 22 s:\nartifact_prefix='./'; Test unit written to ./slow-unit-7f143ed30724b1f950b1effcac76186fb0c2316e\nSlowest unit: 27 s:\nartifact_prefix='./'; Test unit written to ./slow-unit-f7551d1ab2f84f2272498105ddc4846698084e91\nSlowest unit: 30 s:\nartifact_prefix='./'; Test unit written to ./slow-unit-48e2486446d2af625b8da9509e58e367431961fc\nSlowest unit: 37 s:\nartifact_prefix='./'; Test unit written to ./slow-unit-d08c06428a2372c0b2a66de0904f87676fef8b5a\nSlowest unit: 49 s:\nartifact_prefix='./'; Test unit written to ./slow-unit-aacf8a4bfdedd7722dfcb9018cc1ff35eef35081\nSlowest unit: 59 s:\nartifact_prefix='./'; Test unit written to ./slow-unit-cbbf542b2ab8048d07baf5b4f6c0b7d8f669f68e\nSlowest unit: 85 s:\nartifact_prefix='./'; Test unit written to ./slow-unit-8d1c813c5535443d942e829beb3b0d5665556d02\nSlowest unit: 96 s:\nartifact_prefix='./'; Test unit written to ./slow-unit-80b3d5daccb3bb0dfc7b4e03dd0b50d36e59b6de\nSlowest unit: 109 s:\nartifact_prefix='./'; Test unit written to ./slow-unit-01a60537d94e3dd0d5e51c1f8a6ade5128760511\nSlowest unit: 206 s:\nartifact_prefix='./'; Test unit written to ./slow-unit-3e2a547e30dcd94a988ce20e8f632f1f75443626\nSlowest unit: 294 s:\nartifact_prefix='./'; Test unit written to ./slow-unit-53c9e6f4c21acda451de97231976f05ea46d6c35\n/ci_container_base/src/base58.cpp:54:28: runtime error: unsigned integer overflow: 8388989 * 733 cannot be represented in type 'size_t' (aka 'unsigned int')\n    #0 0x6035da73 in DecodeBase58(char const*, std::vector<unsigned char, std::allocator<unsigned char>>&, int) /ci_container_base/ci/scratch/build-i686-pc-linux-gnu/src/./base58.cpp:54:28\n    #1 0x6035e8c8 in DecodeBase58Check(char const*, std::vector<unsigned char, std::allocator<unsigned char>>&, int) /ci_container_base/ci/scratch/build-i686-pc-linux-gnu/src/./base58.cpp:148:10\n    #2 0x6035e8c8 in DecodeBase58Check(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>> const&, std::vector<unsigned char, std::allocator<unsigned char>>&, int) /ci_container_base/ci/scratch/build-i686-pc-linux-gnu/src/./base58.cpp:168:12\n    #3 0x604b34c4 in DecodeSecret(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>> const&) /ci_container_base/ci/scratch/build-i686-pc-linux-gnu/src/./key_io.cpp:217:9\n    #4 0x60617343 in (anonymous namespace)::ParsePubkeyInner(unsigned int, std::span<char const, 4294967295u> const&, (anonymous namespace)::ParseScriptContext, FlatSigningProvider&, bool&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>>&) /ci_container_base/ci/scratch/build-i686-pc-linux-gnu/src/./script/descriptor.cpp:1818:20\n    #5 0x605f5a2b in (anonymous namespace)::ParsePubkey(unsigned int&, std::span<char const, 4294967295u> const&, (anonymous namespace)::ParseScriptContext, FlatSigningProvider&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>>&) /ci_container_base/ci/scratch/build-i686-pc-linux-gnu/src/./script/descriptor.cpp:2007:16\n    #6 0x605dfbf2 in (anonymous namespace)::ParseScript(unsigned int&, std::span<char const, 4294967295u>&, (anonymous namespace)::ParseScriptContext, FlatSigningProvider&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>>&) /ci_container_base/ci/scratch/build-i686-pc-linux-gnu/src/./script/descriptor.cpp:2363:30\n    #7 0x605d981d in Parse(std::basic_string_view<char, std::char_traits<char>>, FlatSigningProvider&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>>&, bool) /ci_container_base/ci/scratch/build-i686-pc-linux-gnu/src/./script/descriptor.cpp:2780:16\n    #8 0x5fad4625 in mocked_descriptor_parse_fuzz_target(std::span<unsigned char const, 4294967295u>) /ci_container_base/ci/scratch/build-i686-pc-linux-gnu/src/test/fuzz/./test/fuzz/descriptor_parse.cpp:97:27\n    #9 0x5f6b965a in void std::__invoke_impl<void, void (*&)(std::span<unsigned char const, 4294967295u>), std::span<unsigned char const, 4294967295u>>(std::__invoke_other, void (*&)(std::span<unsigned char const, 4294967295u>), std::span<unsigned char const, 4294967295u>&&) /usr/lib/gcc/i686-linux-gnu/14/../../../../include/c++/14/bits/invoke.h:61:14\n    #10 0x5f6b965a in std::enable_if<is_invocable_r_v<void, void (*&)(std::span<unsigned char const, 4294967295u>), std::span<unsigned char const, 4294967295u>>, void>::type std::__invoke_r<void, void (*&)(std::span<unsigned char const, 4294967295u>), std::span<unsigned char const, 4294967295u>>(void (*&)(std::span<unsigned char const, 4294967295u>), std::span<unsigned char const, 4294967295u>&&) /usr/lib/gcc/i686-linux-gnu/14/../../../../include/c++/14/bits/invoke.h:111:2\n    #11 0x5f6b965a in std::_Function_handler<void (std::span<unsigned char const, 4294967295u>), void (*)(std::span<unsigned char const, 4294967295u>)>::_M_invoke(std::_Any_data const&, std::span<unsigned char const, 4294967295u>&&) /usr/lib/gcc/i686-linux-gnu/14/../../../../include/c++/14/bits/std_function.h:290:9\n    #12 0x6032e266 in std::function<void (std::span<unsigned char const, 4294967295u>)>::operator()(std::span<unsigned char const, 4294967295u>) const /usr/lib/gcc/i686-linux-gnu/14/../../../../include/c++/14/bits/std_function.h:591:9\n    #13 0x6032e266 in test_one_input(std::span<unsigned char const, 4294967295u>) /ci_container_base/ci/scratch/build-i686-pc-linux-gnu/src/test/fuzz/util/./test/fuzz/fuzz.cpp:88:5\n    #14 0x6032e266 in LLVMFuzzerTestOneInput /ci_container_base/ci/scratch/build-i686-pc-linux-gnu/src/test/fuzz/util/./test/fuzz/fuzz.cpp:216:5\n    #15 0x5f5b7b28 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned int) (/ci_container_base/ci/scratch/build-i686-pc-linux-gnu/bin/fuzz+0xe1ab28) (BuildId: 4a3bad9138f9ac2be12a27f4001cebe27687bcce)\n    #16 0x5f5b7092 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned int, bool, fuzzer::InputInfo*, bool, bool*) (/ci_container_base/ci/scratch/build-i686-pc-linux-gnu/bin/fuzz+0xe1a092) (BuildId: 4a3bad9138f9ac2be12a27f4001cebe27687bcce)\n    #17 0x5f5b8f59 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/ci_container_base/ci/scratch/build-i686-pc-linux-gnu/bin/fuzz+0xe1bf59) (BuildId: 4a3bad9138f9ac2be12a27f4001cebe27687bcce)\n    #18 0x5f5b9482 in fuzzer::Fuzzer::Loop(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/ci_container_base/ci/scratch/build-i686-pc-linux-gnu/bin/fuzz+0xe1c482) (BuildId: 4a3bad9138f9ac2be12a27f4001cebe27687bcce)\n    #19 0x5f5a5adb in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned int)) (/ci_container_base/ci/scratch/build-i686-pc-linux-gnu/bin/fuzz+0xe08adb) (BuildId: 4a3bad9138f9ac2be12a27f4001cebe27687bcce)\n    #20 0x5f5d1ee7 in main (/ci_container_base/ci/scratch/build-i686-pc-linux-gnu/bin/fuzz+0xe34ee7) (BuildId: 4a3bad9138f9ac2be12a27f4001cebe27687bcce)\n    #21 0xf3b39cc2  (/lib/i386-linux-gnu/libc.so.6+0x24cc2) (BuildId: fe186cb7d4de911234b23072a67be9931a6e562e)\n    #22 0xf3b39d87 in __libc_start_main (/lib/i386-linux-gnu/libc.so.6+0x24d87) (BuildId: fe186cb7d4de911234b23072a67be9931a6e562e)\n    #23 0x5f59a406 in _start (/ci_container_base/ci/scratch/build-i686-pc-linux-gnu/bin/fuzz+0xdfd406) (BuildId: 4a3bad9138f9ac2be12a27f4001cebe27687bcce)\n\nSUMMARY: UndefinedBehaviorSanitizer: unsigned-integer-overflow /ci_container_base/src/base58.cpp:54:28 \nMS: 0 ; base unit: 0000000000000000000000000000000000000000\nartifact_prefix='./'; Test unit written to ./crash-f5abf41608addcef3538da61d8096c2050235032\n\nâš ï¸ Failure generated from target with exit code 1: ['/ci_container_base/ci/scratch/build-i686-pc-linux-gnu/bin/fuzz', '-runs=1', PosixPath('/ci_container_base/ci/scratch/qa-assets/fuzz_corpora/mocked_descriptor_parse')]\n```\n\nSame for ",
          "created_at": "2026-01-16T10:56:12Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 2,
            "text_length": 8971,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3759708490,
          "user": "maflcko",
          "body": "Can be reproduced locally with a 32-bit \"simulation patch\":\n\n```diff\ndiff --git a/src/base58.cpp b/src/base58.cpp\nindex 19a5bd3e55..bce2994db0 100644\n--- a/src/base58.cpp\n+++ b/src/base58.cpp\n@@ -53,3 +53,3 @@ static const int8_t mapBase58[256] = {\n     // Allocate enough space in big-endian base256 representation.\n-    int size = strlen(psz) * 733 /1000 + 1; // log(58) / log(256), rounded up.\n+    int size(uint32_t(std::strlen(psz)) * 733 / 1000 + 1); // log(58) / log(256), rounded up.\n     std::vector<unsigned char> b256(size);\n```\n\nAnd then:\n\n```\ncurl -fLO 'https://github.com/bitcoin-core/qa-assets/raw/b5ad78e070e4cf36beb415d7b490d948d70ba73f/fuzz_corpora/mocked_descriptor_parse/f5abf41608addcef3538da61d8096c2050235032'\n\nFUZZ=mocked_descriptor_parse UBSAN_OPTIONS=\"suppressions=$(pwd)/test/sanitizer_suppressions/ubsan:print_stacktrace=1:halt_on_error=1:report_error_type=1\" ./bld-cmake/bin/fuzz ./f5abf41608addcef3538da61d8096c2050235032\n```\n\n",
          "created_at": "2026-01-16T11:57:00Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 957,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 1,
        "text_length": 7488,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 484836881,
      "number": 16712,
      "title": "Signature must be zero for failed CHECK(MULTI)SIG operation",
      "body": "## start bicoind\r\n```\r\nbitcoind -rpcuser=test -rpcpassword=test -rpcport=18443 -rpcbind=0.0.0.0 -datadir=btc_private -txindex -regtest=1 -listenonion=0 -debug -daemon\r\n```\r\n```\r\nalias btccli=\"bitcoin-cli -regtest -rpcuser=test -rpcpassword=test\"\r\n```\r\n\r\n## get 3 new address \r\n```\r\naddress: 2N8VaTaHNq4GPt1rbvaEAEPFwoSZ8CgDUM9\r\npubkey: 0355479b300b217d781cf058941cc1677283c24460665d27dbfced339b29428c93\r\nprivatekey: cPZdtTsenRcKbmthFBcQB4QerVSut6Z9hMPyKo6zMeGRBGSxDGMM\r\n\r\naddress: 2N3yHeRmfNaqsR5rBVUk4fZhmfmiZswH5Rh\r\npubkey: 021e2ef4e12c9d13fc45e709469de0ea8fe556bdbd436f13e936346f6dd267455c\r\nprivatekey: cQxcb3foiTWKBfKT1B8fxWALzgD1SpS2QM6JcsCdFnXM5ebY5zNX\r\n\r\naddress: 2N7T4f6CAEHPyV4RfUD6NUz36AzT7J48nrz\r\npubkey: 033bebbfa8539df7d9b381d6bb34fabe3fc660c3c7a2f69047ac850575597ee8de\r\nprivatekey: cNpLyk4X6PSyUDiJ7tPwQXRHzYPXsVCzg72g47ZW5yVyfVkmqWSt\r\n```\r\n## get multisig address\r\n```\r\nbtccli addmultisigaddress 2 '[\"2N8VaTaHNq4GPt1rbvaEAEPFwoSZ8CgDUM9\",\"2N3yHeRmfNaqsR5rBVUk4fZhmfmiZswH5Rh\",\"2N7T4f6CAEHPyV4RfUD6NUz36AzT7J48nrz\"]'\r\n\r\n{\r\n  \"address\": \"2MwabVCD88Uz7gBWyUd4mA2cXyEBMuN7w93\",\r\n  \"redeemScript\": \"52210355479b300b217d781cf058941cc1677283c24460665d27dbfced339b29428c9321021e2ef4e12c9d13fc45e709469de0ea8fe556bdbd436f13e936346f6dd267455c21033bebbfa8539df7d9b381d6bb34fabe3fc660c3c7a2f69047ac850575597ee8de53ae\"\r\n}\r\n```\r\n\r\n```\r\nbtccli listunspent 1 99999999 '[\"2MwabVCD88Uz7gBWyUd4mA2cXyEBMuN7w93\"]'\r\n\r\n[\r\n  {\r\n    \"txid\": \"66a370cb1fa86f706d3c1ff581ee80ab0c6ef69403cb09ba2eb262a27e4c0643\",\r\n    \"vout\": 0,\r\n    \"address\": \"2MwabVCD88Uz7gBWyUd4mA2cXyEBMuN7w93\",\r\n    \"label\": \"\",\r\n    \"redeemScript\": \"0020e4a6d84b97591a2812a4909e6cfc35429975957e674c4e92ad9054b3cca445bd\",\r\n    \"witnessScript\": \"52210355479b300b217d781cf058941cc1677283c24460665d27dbfced339b29428c9321021e2ef4e12c9d13fc45e709469de0ea8fe556bdbd436f13e936346f6dd267455c21033bebbfa8539df7d9b381d6bb34fabe3fc660c3c7a2f69047ac850575597ee8de53ae\",\r\n    \"scriptPubKey\": \"a9142f8a5a37a7ff99fd8671d2dcd7e62d7b4d0fd97b87\",\r\n    \"amount\": 50.00000000,\r\n    \"confirmations\": 102,\r\n    \"spendable\": true,\r\n    \"solvable\": true,\r\n    \"desc\": \"sh(wsh(multi(2,[696a000f/0'/0'/0']0355479b300b217d781cf058941cc1677283c24460665d27dbfced339b29428c93,[696a000f/0'/0'/1']021e2ef4e12c9d13fc45e709469de0ea8fe556bdbd436f13e936346f6dd267455c,[696a000f/0'/0'/2']033bebbfa8539df7d9b381d6bb34fabe3fc660c3c7a2f69047ac850575597ee8de)))#3cvzvrcg\",\r\n    \"safe\": true\r\n  },\r\n  {\r\n    \"txid\": \"9eaa9439244b18def82abd3f85aca817126653d20add52ad2208aaa4e4f43891\",\r\n    \"vout\": 0,\r\n    \"address\": \"2MwabVCD88Uz7gBWyUd4mA2cXyEBMuN7w93\",\r\n    \"label\": \"\",\r\n    \"redeemScript\": \"0020e4a6d84b97591a2812a4909e6cfc35429975957e674c4e92ad9054b3cca445bd\",\r\n    \"witnessScript\": \"52210355479b300b217d781cf058941cc1677283c24460665d27dbfced339b29428c9321021e2ef4e12c9d13fc45e709469de0ea8fe556bdbd436f13e936346f6dd267455c21033bebbfa8539df7d9b381d6bb34fabe3fc660c3c7a2f69047ac850575597ee8de53ae\",\r\n    \"scriptPubKey\": \"a9142f8a5a37a7ff99fd8671d2dcd7e62d7b4d0fd97b87\",\r\n    \"amount\": 50.00000000,\r\n    \"confirmations\": 101,\r\n    \"spendable\": true,\r\n    \"solvable\": true,\r\n    \"desc\": \"sh(wsh(multi(2,[696a000f/0'/0'/0']0355479b300b217d781cf058941cc1677283c24460665d27dbfced339b29428c93,[696a000f/0'/0'/1']021e2ef4e12c9d13fc45e709469de0ea8fe556bdbd436f13e936346f6dd267455c,[696a000f/0'/0'/2']033bebbfa8539df7d9b381d6bb34fabe3fc660c3c7a2f69047ac850575597ee8de)))#3cvzvrcg\",\r\n    \"safe\": true\r\n  }\r\n]\r\n```\r\n\r\n```\r\nbtccli createrawtransaction '[{\"txid\":\"9eaa9439244b18def82abd3f85aca817126653d20add52ad2208aaa4e4f43891\",\"vout\":0,\"scriptPubKey\":\"a9142f8a5a37a7ff99fd8671d2dcd7e62d7b4d0fd97b87\",\"redeemScript\":\"52210355479b300b217d781cf058941cc1677283c24460665d27dbfced339b29428c9321021e2ef4e12c9d13fc45e709469de0ea8fe556bdbd436f13e936346f6dd267455c21033bebbfa8539df7d9b381d6bb34fabe3fc660c3c7a2f69047ac850575597ee8de53ae\"}]' '{\"2MzycLC1fr83bHGiGhARtYbkaQ8iXoULN76\":49.999}'\r\n\r\n02000000019138f4e4a4aa0822ad52dd0ad253661217a8ac853fbd2af8de184b243994aa9e0000000000ffffffff01606b042a0100000017a91454cd00871f090949693d111080b290b18db4637e8700000000\r\n```\r\n\r\n```\r\nbtccli signrawtransactionwithkey '02000000019138f4e4a4aa0822ad52dd0ad253661217a8ac853fbd2af8de184b243994aa9e0000000000ffffffff01606b042a0100000017a91454cd00871f090949693d111080b290b18db4637e8700000000' '[\"cPZdtTsenRcKbmthFBcQB4QerVSut6Z9hMPyKo6zMeGRBGSxDGMM\"]' '[{\"txid\":\"9eaa9439244b18def82abd3f85aca817126653d20add52ad2208aaa4e4f43891\",\"vout\":0,\"scriptPubKey\":\"a9142f8a5a37a7ff99fd8671d2dcd7e62d7b4d0fd97b87\",\"redeemScript\":\"52210355479b300b217d781cf058941cc1677283c24460665d27dbfced339b29428c9321021e2ef4e12c9d13fc45e709469de0ea8fe556bdbd436f13e936346f6dd267455c21033bebbfa8539df7d9b381d6bb34fabe3fc660c3c7a2f69047ac850575597ee8de53ae\",\"amount\":50}]'\r\n\r\n{\r\n  \"hex\": \"020000000001019138f4e4a4aa0822ad52dd0ad253661217a8ac853fbd2af8de184b243994aa9e0000000023220020e4a6d84b97591a2812a4909e6cfc35429975957e674c4e92ad9054b3cca445bdffffffff01606b042a0100000017a91454cd00871f090949693d111080b290b18db4637e87040047304402205ac40d5e704b78d044798e0b8b7f8bc7afb259fb5806bf0e4cb387f3d2d2dfd2022052c39670918c38cf3d5815f4d6c50af88b84614715043b3f92e4fcbce29a228201006952210355479b300b217d781cf058941cc1677283c24460665d27dbfced339b29428c9321021e2ef4e12c9d13fc45e709469de0ea8fe556bdbd436f13e936346f6dd267455c21033bebbfa8539df7d9b381d6bb34fabe3fc660c3c7a2f69047ac850575597ee8de53ae00000000\",\r\n  \"complete\": false,\r\n  \"errors\": [\r\n    {\r\n      \"txid\": \"9eaa9439244b18def82abd3f85aca817126653d20add52ad2208aaa4e4f43891\",\r\n      \"vout\": 0,\r\n      \"witness\": [\r\n        \"\",\r\n        \"304402205ac40d5e704b78d044798e0b8b7f8bc7afb259fb5806bf0e4cb387f3d2d2dfd2022052c39670918c38cf3d5815f4d6c50af88b84614715043b3f92e4fcbce29a228201\",\r\n        \"\",\r\n        \"52210355479b300b217d781cf058941cc1677283c24460665d27dbfced339b29428c9321021e2ef4e12c9d13fc45e709469de0ea8fe556bdbd436f13e936346f6dd267455c21033bebbfa8539df7d9b381d6bb34fabe3fc660c3c7a2f69047ac850575597ee8de53ae\"\r\n      ],\r\n      \"scriptSig\": \"220020e4a6d84b97591a2812a4909e6cfc35429975957e674c4e92ad9054b3cca445bd\",\r\n      \"sequence\": 4294967295,\r\n      \"error\": \"Signature must be zero for failed CHECK(MULTI)SIG operation\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n```\r\nbtccli signrawtransactionwithkey '020000000001019138f4e4a4aa0822ad52dd0ad253661217a8ac853fbd2af8de184b243994aa9e0000000023220020e4a6d84b97591a2812a4909e6cfc35429975957e674c4e92ad9054b3cca445bdffffffff01606b042a0100000017a91454cd00871f090949693d111080b290b18db4637e87040047304402205ac40d5e704b78d044798e0b8b7f8bc7afb259fb5806bf0e4cb387f3d2d2dfd2022052c39670918c38cf3d5815f4d6c50af88b84614715043b3f92e4fcbce29a228201006952210355479b300b217d781cf058941cc1677283c24460665d27dbfced339b29428c9321021e2ef4e12c9d13fc45e709469de0ea8fe556bdbd436f13e936346f6dd267455c21033bebbfa8539df7d9b381d6bb34fabe3fc660c3c7a2f69047ac850575597ee8de53ae00000000' '[\"cQxcb3foiTWKBfKT1B8fxWALzgD1SpS2QM6JcsCdFnXM5ebY5zNX\"]' '[{\"txid\":\"9eaa9439244b18def82abd3f85aca817126653d20add52ad2208aaa4e4f43891\",\"vout\":0,\"scriptPubKey\":\"a9142f8a5a37a7ff99fd8671d2dcd7e62d7b4d0fd97b87\",\"redeemScript\":\"52210355479b300b217d781cf058941cc1677283c24460665d27dbfced339b29428c9321021e2ef4e12c9d13fc45e709469de0ea8fe556bdbd436f13e936346f6dd267455c21033bebbfa8539df7d9b381d6bb34fabe3fc660c3c7a2f69047ac850575597ee8de53ae\",\"amount\":50}]'\r\n\r\n{\r\n  \"hex\": \"020000000001019138f4e4a4aa0822ad52dd0ad253661217a8ac853fbd2af8de184b243994aa9e0000000023220020e4a6d84b97591a2812a4909e6cfc35429975957e674c4e92ad9054b3cca445bdffffffff01606b042a0100000017a91454cd00871f090949693d111080b290b18db4637e87040047304402205ac40d5e704b78d044798e0b8b7f8bc7afb259fb5806bf0e4cb387f3d2d2dfd2022052c39670918c38cf3d5815f4d6c50af88b84614715043b3f92e4fcbce29a228201473044022072d263ac076bb5647c9cbcefc7fda411a9208cd1a8a75148b090a24b929ac590022034a230442504d91fe561004e64b0eba403b80e42afb12afaa7808b916ff3e54a016952210355479b300b217d781cf058941cc1677283c24460665d27dbfced339b29428c9321021e2ef4e12c9d13fc45e709469de0ea8fe556bdbd436f13e936346f6dd267455c21033bebbfa8539df7d9b381d6bb34fabe3fc660c3c7a2f69047ac850575597ee8de53ae00000000\",\r\n  \"complete\": true\r\n}\r\n```\r\n\r\n```\r\nbtccli sendrawtransaction 020000000001019138f4e4a4aa0822ad52dd0ad253661217a8ac853fbd2af8de184b243994aa9e0000000023220020e4a6d84b97591a2812a4909e6cfc35429975957e674c4e92ad9054b3cca445bdffffffff01606b042a0100000017a91454cd00871f090949693d111080b290b18db4637e87040047304402205ac40d5e704b78d044798e0b8b7f8bc7afb259fb5806bf0e4cb387f3d2d2dfd2022052c39670918c38cf3d5815f4d6c50af88b84614715043b3f92e4fcbce29a228201473044022072d263ac076bb5647c9cbcefc7fda411a9208cd1a8a75148b090a24b929ac590022034a230442504d91fe561004e64b0eba403b80e42afb12afaa7808b916ff3e54a016952210355479b300b217d781cf058941cc1677283c24460665d27dbfced339b29428c9321021e2ef4e12c9d13fc45e709469de0ea8fe556bdbd436f13e936346f6dd267455c21033bebbfa8539df7d9b381d6bb34fabe3fc660c3c7a2f69047ac850575597ee8de53ae00000000\r\nerror code: -26\r\nerror message:\r\nnon-mandatory-script-verify-flag (Signature must be zero for failed CHECK(MULTI)SIG operation) (code 64)\r\n```\r\n\r\nwhy i got a error like above? i need help, thanks!\r\n",
      "state": "open",
      "user": "xiangjianmeng",
      "created_at": "2019-08-24T15:56:58Z",
      "updated_at": "2026-01-16T11:45:07Z",
      "closed_at": null,
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/16712",
      "labels": [
        "Wallet",
        "RPC/REST/ZMQ"
      ],
      "comment_data": [
        {
          "id": 3759663977,
          "user": "willcl-ark",
          "body": "I dont' think this happens any more when using descriptor wallets using the `createmultisig` flow.\n\n@achow101 perhaps you could confirm whether we want to keep this open any longer?",
          "created_at": "2026-01-16T11:42:45Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 181,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 9077,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3821539981,
      "number": 34316,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "Fleinsopp",
      "created_at": "2026-01-16T11:02:00Z",
      "updated_at": "2026-01-16T11:05:57Z",
      "closed_at": "2026-01-16T11:05:48Z",
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/34316",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1642095164,
      "number": 27343,
      "title": "-Wmaybe-uninitialized warnings under LTO",
      "body": "Building under GCC `14.0.1` with `-flto` (Fedora Rawhide) currently results in a number of `-Wmaybe-uninitialized` warnings. Some of these are things we might not want to \"fix\", i.e in test code. Some come from leveldb etc. Open this issue to document them, as some exist with current versions of GCC, and GCC 14.0 will be released soon:\r\n\r\n```bash\r\nleveldb/db/memtable.cc: In function 'GetLengthPrefixedSlice':\r\nleveldb/db/memtable.cc:18:22: warning: 'len' may be used uninitialized [-Wmaybe-uninitialized]\r\n   18 |   return Slice(p, len);\r\n      |                      ^\r\nleveldb/db/memtable.cc:15:12: note: 'len' was declared here\r\n   15 |   uint32_t len;\r\n      |            ^\r\nIn function 'GetLengthPrefixedSlice',\r\n    inlined from 'operator()' at leveldb/db/memtable.cc:32:35,\r\n    inlined from 'KeyIsAfterNode' at ./leveldb/db/skiplist.h:257:37,\r\n    inlined from 'FindGreaterOrEqual' at ./leveldb/db/skiplist.h:268:23:\r\nleveldb/db/memtable.cc:18:22: warning: 'len' may be used uninitialized [-Wmaybe-uninitialized]\r\n   18 |   return Slice(p, len);\r\n      |                      ^\r\nleveldb/db/memtable.cc: In member function 'FindGreaterOrEqual':\r\nleveldb/db/memtable.cc:15:12: note: 'len' was declared here\r\n   15 |   uint32_t len;\r\n      |            ^\r\nleveldb/db/memtable.cc: In member function 'Get':\r\nleveldb/db/memtable.cc:119:39: warning: 'key_length' may be used uninitialized [-Wmaybe-uninitialized]\r\n  119 |             Slice(key_ptr, key_length - 8), key.user_key()) == 0) {\r\n      |                                       ^\r\nleveldb/db/memtable.cc:116:14: note: 'key_length' was declared here\r\n  116 |     uint32_t key_length;\r\n      |              ^\r\nIn member function 'operator=',\r\n    inlined from '__ct ' at test/prevector_tests.cpp:215:49,\r\n    inlined from 'test_method.isra' at test/prevector_tests.cpp:222:34:\r\nrandom.cpp:749:19: warning: 'D.58376.bitbuf' is used uninitialized [-Wuninitialized]\r\n  749 |     bitbuf = from.bitbuf;\r\n      |                   ^\r\ntest/prevector_tests.cpp: In function 'test_method.isra':\r\ntest/prevector_tests.cpp:215:22: note: '<anonymous>' declared here\r\n  215 |         rand_cache = FastRandomContext(rand_seed);\r\n      |                      ^\r\nleveldb/db/memtable.cc: In function 'GetLengthPrefixedSlice':\r\nleveldb/db/memtable.cc:18:22: warning: 'len' may be used uninitialized [-Wmaybe-uninitialized]\r\n   18 |   return Slice(p, len);\r\n      |                      ^\r\nleveldb/db/memtable.cc:15:12: note: 'len' was declared here\r\n   15 |   uint32_t len;\r\n      |            ^\r\nleveldb/db/memtable.cc: In function 'GetLengthPrefixedSlice':\r\nleveldb/db/memtable.cc:18:22: warning: 'len' may be used uninitialized [-Wmaybe-uninitialized]\r\n   18 |   return Slice(p, len);\r\n      |                      ^\r\nleveldb/db/memtable.cc:15:12: note: 'len' was declared here\r\n   15 |   uint32_t len;\r\n      |            ^\r\nIn function 'GetLengthPrefixedSlice',\r\n    inlined from 'operator()' at leveldb/db/memtable.cc:32:35,\r\n    inlined from 'KeyIsAfterNode' at ./leveldb/db/skiplist.h:257:37,\r\n    inlined from 'FindGreaterOrEqual' at ./leveldb/db/skiplist.h:268:23:\r\nleveldb/db/memtable.cc:18:22: warning: 'len' may be used uninitialized [-Wmaybe-uninitialized]\r\n   18 |   return Slice(p, len);\r\n      |                      ^\r\nleveldb/db/memtable.cc: In member function 'FindGreaterOrEqual':\r\nleveldb/db/memtable.cc:15:12: note: 'len' was declared here\r\n   15 |   uint32_t len;\r\n      |            ^\r\nIn function 'GetLengthPrefixedSlice',\r\n    inlined from 'operator()' at leveldb/db/memtable.cc:32:35,\r\n    inlined from 'KeyIsAfterNode' at ./leveldb/db/skiplist.h:257:37,\r\n    inlined from 'FindGreaterOrEqual' at ./leveldb/db/skiplist.h:268:23:\r\nleveldb/db/memtable.cc:18:22: warning: 'len' may be used uninitialized [-Wmaybe-uninitialized]\r\n   18 |   return Slice(p, len);\r\n      |                      ^\r\nleveldb/db/memtable.cc: In member function 'FindGreaterOrEqual':\r\nleveldb/db/memtable.cc:15:12: note: 'len' was declared here\r\n   15 |   uint32_t len;\r\n      |            ^\r\nleveldb/db/memtable.cc: In member function 'Get':\r\nleveldb/db/memtable.cc:119:39: warning: 'key_length' may be used uninitialized [-Wmaybe-uninitialized]\r\n  119 |             Slice(key_ptr, key_length - 8), key.user_key()) == 0) {\r\n      |                                       ^\r\nleveldb/db/memtable.cc:116:14: note: 'key_length' was declared here\r\n  116 |     uint32_t key_length;\r\n      |              ^\r\nIn member function 'operator=',\r\n    inlined from 'Seed.constprop' at test/util/random.cpp:32:33:\r\nrandom.cpp:749:19: warning: 'D.69037.bitbuf' may be used uninitialized [-Wmaybe-uninitialized]\r\n  749 |     bitbuf = from.bitbuf;\r\n      |                   ^\r\ntest/util/random.cpp: In function 'Seed.constprop':\r\ntest/util/random.cpp:32:33: note: '<anonymous>' declared here\r\n   32 |     ctx = FastRandomContext(seed);\r\n      |                                 ^\r\nleveldb/db/memtable.cc: In member function 'Get':\r\nleveldb/db/memtable.cc:119:39: warning: 'key_length' may be used uninitialized [-Wmaybe-uninitialized]\r\n  119 |             Slice(key_ptr, key_length - 8), key.user_key()) == 0) {\r\n      |                                       ^\r\nleveldb/db/memtable.cc:116:14: note: 'key_length' was declared here\r\n  116 |     uint32_t key_length;\r\n      |              ^\r\nIn member function 'operator=',\r\n    inlined from 'Seed' at test/util/random.cpp:32:33,\r\n    inlined from 'SeedInsecureRand' at ./test/util/random.h:41:13,\r\n    inlined from '__ct_base ' at test/util/setup_common.cpp:184:21:\r\nrandom.cpp:749:19: warning: 'D.40691.bitbuf' may be used uninitialized [-Wmaybe-uninitialized]\r\n  749 |     bitbuf = from.bitbuf;\r\n      |                   ^\r\ntest/util/random.cpp: In member function '__ct_base ':\r\ntest/util/random.cpp:32:33: note: '<anonymous>' declared here\r\n   32 |     ctx = FastRandomContext(seed);\r\n      |                                 ^\r\nleveldb/db/memtable.cc: In function 'GetLengthPrefixedSlice':\r\nleveldb/db/memtable.cc:18:22: warning: 'len' may be used uninitialized [-Wmaybe-uninitialized]\r\n   18 |   return Slice(p, len);\r\n      |                      ^\r\nleveldb/db/memtable.cc:15:12: note: 'len' was declared here\r\n   15 |   uint32_t len;\r\n      |            ^\r\nIn function 'GetLengthPrefixedSlice',\r\n    inlined from 'operator()' at leveldb/db/memtable.cc:32:35,\r\n    inlined from 'KeyIsAfterNode' at ./leveldb/db/skiplist.h:257:37,\r\n    inlined from 'FindGreaterOrEqual' at ./leveldb/db/skiplist.h:268:23:\r\nleveldb/db/memtable.cc:18:22: warning: 'len' may be used uninitialized [-Wmaybe-uninitialized]\r\n   18 |   return Slice(p, len);\r\n      |                      ^\r\nleveldb/db/memtable.cc: In member function 'FindGreaterOrEqual':\r\nleveldb/db/memtable.cc:15:12: note: 'len' was declared here\r\n   15 |   uint32_t len;\r\n      |            ^\r\nleveldb/db/memtable.cc: In member function 'Get':\r\nleveldb/db/memtable.cc:119:39: warning: 'key_length' may be used uninitialized [-Wmaybe-uninitialized]\r\n  119 |             Slice(key_ptr, key_length - 8), key.user_key()) == 0) {\r\n      |                                       ^\r\nleveldb/db/memtable.cc:116:14: note: 'key_length' was declared here\r\n  116 |     uint32_t key_length;\r\n      |              ^\r\ntest/fuzz/float.cpp: In function 'float_fuzz_target':\r\ntest/fuzz/float.cpp:49:40: warning: 'tmp' may be used uninitialized [-Wmaybe-uninitialized]\r\n   49 |         uint64_t encoded = EncodeDouble(d);\r\n      |                                        ^\r\ntest/fuzz/float.cpp:21:20: note: 'tmp' was declared here\r\n   21 |             double tmp;\r\n      |                    ^\r\nIn member function 'operator=',\r\n    inlined from 'operator()' at test/fuzz/addrman.cpp:127:9,\r\n    inlined from '__ct ' at test/fuzz/addrman.cpp:127:9,\r\n    inlined from 'addrman_serdeser_fuzz_target' at test/fuzz/addrman.cpp:295:69:\r\nrandom.cpp:749:19: warning: 'D.36455.bitbuf' may be used uninitialized [-Wmaybe-uninitialized]\r\n  749 |     bitbuf = from.bitbuf;\r\n      |                   ^\r\ntest/fuzz/addrman.cpp: In function 'addrman_serdeser_fuzz_target':\r\ntest/fuzz/addrman.cpp:127:9: note: '<anonymous>' declared here\r\n  127 |         WITH_LOCK(m_impl->cs, m_impl->insecure_rand = FastRandomContext{ConsumeUInt256(fuzzed_data_provider)});\r\n      |         ^\r\nIn member function 'operator=',\r\n    inlined from 'operator()' at test/fuzz/addrman.cpp:127:9,\r\n    inlined from '__ct ' at test/fuzz/addrman.cpp:127:9,\r\n    inlined from 'addrman_serdeser_fuzz_target' at test/fuzz/addrman.cpp:296:69:\r\nrandom.cpp:749:19: warning: 'D.36632.bitbuf' may be used uninitialized [-Wmaybe-uninitialized]\r\n  749 |     bitbuf = from.bitbuf;\r\n      |                   ^\r\ntest/fuzz/addrman.cpp: In function 'addrman_serdeser_fuzz_target':\r\ntest/fuzz/addrman.cpp:127:9: note: '<anonymous>' declared here\r\n  127 |         WITH_LOCK(m_impl->cs, m_impl->insecure_rand = FastRandomContext{ConsumeUInt256(fuzzed_data_provider)});\r\n      |         ^\r\nIn member function 'operator=',\r\n    inlined from 'SeedInsecureRand' at ./test/util/random.h:39:72,\r\n    inlined from 'SeedInsecureRand' at ./test/util/random.h:36:20,\r\n    inlined from 'test_method' at test/cuckoocache_tests.cpp:40:21,\r\n    inlined from 'test_cuckoocache_no_fakes_invoker' at test/cuckoocache_tests.cpp:38:1:\r\nrandom.cpp:749:19: warning: 'D.46810.bitbuf' may be used uninitialized [-Wmaybe-uninitialized]\r\n  749 |     bitbuf = from.bitbuf;\r\n      |                   ^\r\n./test/util/random.h: In function 'test_cuckoocache_no_fakes_invoker':\r\n./test/util/random.h:39:72: note: '<anonymous>' declared here\r\n   39 |         g_insecure_rand_ctx = FastRandomContext(/*fDeterministic=*/true);\r\n      |                                                                        ^\r\nIn member function 'operator=',\r\n    inlined from 'SeedInsecureRand' at ./test/util/random.h:39:72,\r\n    inlined from 'SeedInsecureRand' at ./test/util/random.h:36:20,\r\n    inlined from 'test_cache' at test/cuckoocache_tests.cpp:58:21,\r\n    inlined from 'test_method' at test/cuckoocache_tests.cpp:117:84,\r\n    inlined from 'cuckoocache_hit_rate_ok_invoker' at test/cuckoocache_tests.cpp:109:1:\r\nrandom.cpp:749:19: warning: 'D.48398.bitbuf' may be used uninitialized [-Wmaybe-uninitialized]\r\n  749 |     bitbuf = from.bitbuf;\r\n      |                   ^\r\n./test/util/random.h: In function 'cuckoocache_hit_rate_ok_invoker':\r\n./test/util/random.h:39:72: note: '<anonymous>' declared here\r\n   39 |         g_insecure_rand_ctx = FastRandomContext(/*fDeterministic=*/true);\r\n      |                                                                        ^\r\nIn member function 'operator=',\r\n    inlined from 'SeedInsecureRand' at ./test/util/random.h:39:72,\r\n    inlined from 'SeedInsecureRand' at ./test/util/random.h:36:20,\r\n    inlined from 'test_cache_erase' at test/cuckoocache_tests.cpp:129:21,\r\n    inlined from 'test_method' at test/cuckoocache_tests.cpp:185:72,\r\n    inlined from 'cuckoocache_erase_ok_invoker' at test/cuckoocache_tests.cpp:182:1:\r\nrandom.cpp:749:19: warning: 'D.50490.bitbuf' may be used uninitialized [-Wmaybe-uninitialized]\r\n  749 |     bitbuf = from.bitbuf;\r\n      |                   ^\r\n./test/util/random.h: In function 'cuckoocache_erase_ok_invoker':\r\n./test/util/random.h:39:72: note: '<anonymous>' declared here\r\n   39 |         g_insecure_rand_ctx = FastRandomContext(/*fDeterministic=*/true);\r\n      |                                                                        ^\r\nIn function '__fill_a1',\r\n    inlined from '__fill_a1' at /usr/include/c++/14/bits/stl_algobase.h:981:21,\r\n    inlined from '__fill_a' at /usr/include/c++/14/bits/stl_algobase.h:998:21,\r\n    inlined from 'fill' at /usr/include/c++/14/bits/stl_algobase.h:1029:20,\r\n    inlined from 'PollutePubKey' at wallet/test/wallet_tests.cpp:503:14:\r\n/usr/include/c++/14/bits/stl_algobase.h:952:18: warning: '__builtin_memset' specified bound 18446744073709551615 exceeds maximum object size 9223372036854775807 [-Wstringop-overflow=]\r\n  952 |         *__first = __tmp;\r\n      |                  ^\r\nIn member function 'operator=',\r\n    inlined from 'SeedInsecureRand' at ./test/util/random.h:39:0,\r\n    inlined from 'test_method' at test/util_tests.cpp:448:21,\r\n    inlined from 'util_seed_insecure_rand_invoker' at test/util_tests.cpp:446:1:\r\nrandom.cpp:749:19: warning: 'D.49511.bitbuf' may be used uninitialized [-Wmaybe-uninitialized]\r\n  749 |     bitbuf = from.bitbuf;\r\n      |                   ^\r\n./test/util/random.h: In function 'util_seed_insecure_rand_invoker':\r\n./test/util/random.h:39: note: '<anonymous>' declared here\r\n   39 |         g_insecure_rand_ctx = FastRandomContext(/*fDeterministic=*/true);\r\nIn member function 'operator=',\r\n    inlined from 'operator()' at test/fuzz/addrman.cpp:127:9,\r\n    inlined from '__ct ' at test/fuzz/addrman.cpp:127:9,\r\n    inlined from 'make_unique' at /usr/include/c++/14/bits/unique_ptr.h:1076:30,\r\n    inlined from 'addrman_fuzz_target' at test/fuzz/addrman.cpp:228:97:\r\nrandom.cpp:749:19: warning: 'D.38104.bitbuf' may be used uninitialized [-Wmaybe-uninitialized]\r\n  749 |     bitbuf = from.bitbuf;\r\n      |                   ^\r\ntest/fuzz/addrman.cpp: In function 'addrman_fuzz_target':\r\ntest/fuzz/addrman.cpp:127:9: note: '<anonymous>' declared here\r\n  127 |         WITH_LOCK(m_impl->cs, m_impl->insecure_rand = FastRandomContext{ConsumeUInt256(fuzzed_data_provider)});\r\n      |         ^\r\nIn member function 'operator=',\r\n    inlined from 'operator()' at test/fuzz/addrman.cpp:127:9,\r\n    inlined from '__ct ' at test/fuzz/addrman.cpp:127:9,\r\n    inlined from 'make_unique' at /usr/include/c++/14/bits/unique_ptr.h:1076:30,\r\n    inlined from 'addrman_fuzz_target' at test/fuzz/addrman.cpp:235:66:\r\nrandom.cpp:749:19: warning: 'D.41251.bitbuf' may be used uninitialized [-Wmaybe-uninitialized]\r\n  749 |     bitbuf = from.bitbuf;\r\n      |                   ^\r\ntest/fuzz/addrman.cpp: In function 'addrman_fuzz_target':\r\ntest/fuzz/addrman.cpp:127:9: note: '<anonymous>' declared here\r\n  127 |         WITH_LOCK(m_impl->cs, m_impl->insecure_rand = FastRandomContext{ConsumeUInt256(fuzzed_data_provider)});\r\n      |         ^\r\nIn member function 'operator=',\r\n    inlined from 'Seed' at test/util/random.cpp:32:33,\r\n    inlined from 'SeedInsecureRand' at ./test/util/random.h:41:13,\r\n    inlined from '__ct_base ' at test/util/setup_common.cpp:184:21:\r\nrandom.cpp:749:19: warning: 'D.39055.bitbuf' may be used uninitialized [-Wmaybe-uninitialized]\r\n  749 |     bitbuf = from.bitbuf;\r\n      |                   ^\r\ntest/util/random.cpp: In member function '__ct_base ':\r\ntest/util/random.cpp:32:33: note: '<anonymous>' declared here\r\n   32 |     ctx = FastRandomContext(seed);\r\n      |                                 ^\r\nIn member function 'operator=',\r\n    inlined from 'test_method' at test/orphanage_tests.cpp:57:56,\r\n    inlined from 'DoS_mapOrphans_invoker' at test/orphanage_tests.cpp:49:1:\r\nrandom.cpp:749:19: warning: 'D.45887.bitbuf' may be used uninitialized [-Wmaybe-uninitialized]\r\n  749 |     bitbuf = from.bitbuf;\r\n      |                   ^\r\ntest/orphanage_tests.cpp: In function 'DoS_mapOrphans_invoker':\r\ntest/orphanage_tests.cpp:57:56: note: '<anonymous>' declared here\r\n   57 |     g_insecure_rand_ctx = FastRandomContext{uint256{33}};\r\n      |                                                        ^\r\nIn member function '__ct ',\r\n    inlined from 'construct_at' at /usr/include/c++/14/bits/stl_construct.h:97:14,\r\n    inlined from 'construct' at /usr/include/c++/14/bits/alloc_traits.h:536:21,\r\n    inlined from '_M_realloc_append' at /usr/include/c++/14/bits/vector.tcc:634:26,\r\n    inlined from 'emplace_back' at /usr/include/c++/14/bits/vector.tcc:123:21,\r\n    inlined from 'test_method' at test/logging_tests.cpp:166:45,\r\n    inlined from 'logging_LogPrintMacros_CategoryName_invoker' at test/logging_tests.cpp:156:1:\r\n/usr/include/c++/14/bits/stl_pair.h:444:11: warning: 'category' may be used uninitialized [-Wmaybe-uninitialized]\r\n  444 |         : first(std::forward<_U1>(__x)), second(std::forward<_U2>(__y))\r\n      |           ^\r\ntest/logging_tests.cpp: In function 'logging_LogPrintMacros_CategoryName_invoker':\r\ntest/logging_tests.cpp:163:25: note: 'category' was declared here\r\n  163 |         BCLog::LogFlags category;\r\n      |                         ^\r\n\r\n```",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2023-03-27T13:43:17Z",
      "updated_at": "2026-01-16T11:05:40Z",
      "closed_at": "2026-01-16T11:05:40Z",
      "comments": 10,
      "url": "https://github.com/bitcoin/bitcoin/issues/27343",
      "labels": [
        "Build system",
        "Upstream"
      ],
      "comment_data": [
        {
          "id": 3759305276,
          "user": "willcl-ark",
          "body": "Is this still an issue worth keeping open? I have tried using:\n\n```dockerfile\nFROM fedora:rawhide\n\nRUN dnf install -y \\\n    gcc14 \\\n    gcc14-c++ \\\n    cmake \\\n    make \\\n    python3 \\\n    libevent-devel \\\n    boost-devel \\\n    sqlite-devel \\\n    git \\\n    && dnf clean all\n\nENV CC=gcc-14\nENV CXX=g++-14\n\nRUN git clone --depth=1 https://github.com/bitcoin/bitcoin.git /bitcoin\n\nWORKDIR /bitcoin\n\nRUN cmake -B build -DENABLE_IPC=FALSE -DCMAKE_C_FLAGS=\"-flto\" -DCMAKE_CXX_FLAGS=\"-flto\" \\\n    && cmake --build build --parallel\n```\n\n...which installs gcc 14.3.1:\n\n```log\n#8 9.737 C++ compiler .......................... GNU 14.3.1, /usr/sbin/g++-14\n#8 9.737 CMAKE_BUILD_TYPE ...................... RelWithDebInfo\n#8 9.738 Preprocessor defined macros ...........\n#8 9.738 C++ compiler flags .................... -flto -O2 -g -std=c++20 -fPIC -fno-extended-identifiers -fdebug-prefix-map=/bitcoin/src=. -fmacro-prefix-map=/bitcoin/src=. -fstack-reuse=none -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=3 -Wstack-protector -fstack-protector-all -fcf-protection=full -fstack-clash-protection -Wall -Wextra -Wformat -Wformat-security -Wvla -Wredundant-decls -Wdate-time -Wduplicated-branches -Wduplicated-cond -Wlogical-op -Woverloaded-virtual -Wsuggest-override -Wimplicit-fallthrough -Wunreachable-code -Wbidi-chars=any -Wundef -Wno-unused-parameter\n#8 9.738 Linker flags .......................... -flto -O2 -g -fstack-reuse=none -fstack-protector-all -fcf-protection=full -fstack-clash-protection -Wl,-z,relro -Wl,-z,now -Wl,-z,separate-code -fPIE -pie\n```\n\nand, with the exception of some lto warnings:\n\n```log\n#8 100.0 [ 99%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/wallet_transaction_tests.cpp.o\n#8 119.5 lto-wrapper: warning: using serial compilation of 20 LTRANS jobs\n#8 119.5 lto-wrapper: note: see the '-flto' option documentation for more information\n#8 126.5 [ 99%] Built target bitcoin\n#8 148.5 [ 99%] Linking CXX executable ../bin/bitcoind\n#8 151.0 [ 99%] Built target bitcoin-util\nc#8 163.9 [100%] Linking CXX executable ../bin/bitcoin-wallet\n#8 168.9 [100%] Built target bitcoin-cli\n#8 169.1 lto-wrapper: warning: using serial compilation of 37 LTRANS jobs\n#8 169.1 lto-wrapper: note: see the '-flto' option documentation for more information\n#8 169.8 [100%] Linking CXX executable ../../bin/test_bitcoin\n#8 173.3 lto-wrapper: warning: using serial compilation of 128 LTRANS jobs\n#8 173.3 lto-wrapper: note: see the '-flto' option documentation for more information\n#8 184.8 [100%] Built target bitcoin-tx\n#8 186.0 lto-wrapper: warning: using serial compilation of 128 LTRANS jobs\n#8 186.0 lto-wrapper: note: see the '-flto' option documentation for more information\n#8 212.3 [100%] Built target bitcoin-wallet\n#8 334.0 [100%] Built target bitcoind\n#8 485.2 [100%] Built target test_bitcoin\n#8 DONE 485.3s\n```\n\nI don't see the `-Wmaybe-uninitialized` warnings any more.\n\nunrelated: whew lto really takes a long while!",
          "created_at": "2026-01-16T10:26:14Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 2947,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3759362621,
          "user": "maflcko",
          "body": "https://gcc.gnu.org/bugzilla/show_bug.cgi?id=24639 is pretty filled, so I don't expect those warnings to generally go away any time soon. I think we can just point to https://gcc.gnu.org/bugzilla/show_bug.cgi?id=24639 if someone complains, but I'd presume that no user is using LTO, is there one?",
          "created_at": "2026-01-16T10:37:14Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 296,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3759509599,
          "user": "fanquake",
          "body": "Yea I think it's fine to close. There are still various warnings, depending on the target, but not much for us to do. FWIW I am building with LTO fairly often.",
          "created_at": "2026-01-16T11:05:40Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 159,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 16310,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1027271193,
      "number": 23285,
      "title": "Missing CheckMinimalPush check in MatchMultisig: largest IsStandard multisig n-of-3 is 12 bytes too large?",
      "body": "The following four equivalent scripts all pass standardness check (`IsStandard`):\r\n\r\n* `1 0x21 0x020000000000000000000000000000000000000000000000000000000000000000 1 CHECKMULTISIG`\r\n* `1 0x4c21 0x020000000000000000000000000000000000000000000000000000000000000000 1 CHECKMULTISIG`\r\n* `1 0x4d2100 0x020000000000000000000000000000000000000000000000000000000000000000 1 CHECKMULTISIG`\r\n* `1 0x4e21000000 0x020000000000000000000000000000000000000000000000000000000000000000 1 CHECKMULTISIG`\r\n\r\nWhere `0x4c == OP_PUSHDATA1`, `0x4d == OP_PUSHDATA2` and `0x4e == OP_PUSHDATA4`.\r\n\r\nOnly the first one would pass the standardness check if minimal representation was enforced.\r\n\r\nAFAICT we check for minimal representation in all other `IsStandard` standardness checks. Is there any particular reason we're not doing it for `CHECKMULTISIG` in `MatchMultisig`? :)",
      "state": "open",
      "user": "practicalswift",
      "created_at": "2021-10-15T09:44:55Z",
      "updated_at": "2026-01-16T11:00:48Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/23285",
      "labels": [
        "Validation",
        "Needs Conceptual Review"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 958,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1096320067,
      "number": 24003,
      "title": "Derive individual index descriptor",
      "body": "Given a `Descriptor` of the form `tr(xpub/0/*)#checksumA`, derive  `tr(xpub/0/i)#checksumB`. Currently this requires either string manipulation or inferring a fresh descriptor from a wallet script. The latter is not a 1-to-1 mapping, so e.g. a `sorted_multi` descriptor can't be inferred this way.\r\n\r\nThis can create a problem when trying to display an address on an external signer device:\r\nhttps://github.com/bitcoin/bitcoin/blob/a0988140b71485ad12c3c3a4a9573f7c21b1eff8/src/wallet/external_signer_scriptpubkeyman.cpp#L51-L57\r\n\r\nSome devices, e.g. the Blockstream Jade https://github.com/bitcoin-core/HWI/pull/559#issuecomment-1007399463, can't display an address based on just the derivation info and a public key, they need the `xpub` too.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2022-01-07T13:31:16Z",
      "updated_at": "2026-01-16T11:00:30Z",
      "closed_at": null,
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/24003",
      "labels": [
        "Wallet",
        "Descriptors"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 778,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1205500556,
      "number": 24861,
      "title": "Awesome multisig PR labyrinth guide",
      "body": "@ryanofsky recently suggested that I should write an overview of how the various pull requests spread over different repositories relate to some bigger picture view.\n\nSee the [multisig tutorial](https://github.com/bitcoin/bitcoin/blob/master/doc/multisig-tutorial.md) for how things currently work.\n\nI typically have the following future multisig wallet in mind to guide my thinking:\n1. a computer running Bitcoin Core holding one master key (key 1)\n2. one or more hardware wallets with additional keys, via HWI (keys 2 ... n)\n3. taproot keypath using n-of-n MuSig2\n4. a fallback with fewer keys after some time elapsed\n5. a GUI wizard to set this up (simple Python command line tool until then)\n\nThe descriptors for this could be hand crafted, but it would be nice to have:\n6. Miniscript compiler that can generate this\n\n**What's Missing?**\n\n- Taproot support for external signers:\n  - [x] #22558 (PSBT fields)\n  - [x] #23578 (External signer support)\n- [x] Timelock support for descriptors: this will be added along with full [MiniScript](https://bitcoin.sipa.be/miniscript/) support in #24148 & #24149 (@darosior).\n- [ ] Ability to handle descriptors for which we have 1-of-N keys. Descriptor wallets currently expect the wallet to be either watch-only and have no keys, or to have all the keys.\n  - [x] #29130 makes it possible to create a wallet _with_ a seed, but without any descriptors.\n  - [ ] The user would grab an xpub from it (#22341,#32784) to construct a multisig descriptor and then import that.\n    - [x] #29130 added `gethdkeys`, helpful but doesn't support arbitrary derivation paths\n- [ ] MuSig2 setup and signing support, which requires:\n  - [x] a BIP to specify new PSBT fields (tracked in #23326)\n  - [ ] #31247\n  - [ ] Bitcoin Core MuSig2 support: #29675\n  - [ ] At least one other (hardware) wallet to support it\n    - [ ] Ledger demo app, see [#29675](https://github.com/bitcoin/bitcoin/pull/29675#issuecomment-2152172999)\n  - HWI changes: probably none needed\n- [ ] a simple Python setup wizard\n   * right now [Specter Desktop](https://github.com/cryptoadvance/specter-desktop) is by far the easiest way to setup a multisig wallet. But it's a huge dependency (including a bunch of NPM packages for their web interface). A simple Python script in contrib/ could call HWI to get a list of signers, ask what threshold to use, call `createwallet` to generate a blank wallet, fetch an xpub from it, and then call `importdescriptors`.\n   * the script could use [BIP 129 / BSMS](https://github.com/bitcoin/bips/blob/master/bip-0129.mediawiki) (perhaps initially without encryption)\n   * Specter doesn't set the external_signer wallet flag, so I have a trivial PR to do that manually: #21928 (up for grabs)\n- [ ] a GUI setup wizard: once we have an established work flow, we would implement that in the GUI\n\n**Misc**\n\nI have a PR that improves address display handling on the device:\n\n- [x] https://github.com/bitcoin/bitcoin/pull/24313\n\nEven better would be if we had a feature to ask the wallet for a signature to prove it has the private key (without passing that information to the outside world of course, see #24186). This requires BIP-322 support on our end (#24058), at least one hardware wallet to support it, and a new HWI `signmessage` command. Perhaps this can later be expanded to allow your device to prove that it (still) has the keys it needs as a co-signer.\n\nMiniscript compilers currently doesn't support Taproot (e.g. to find the optimal tree structure), but I'm assuming you can still hand craft a leaf containing MiniScript. ",
      "state": "open",
      "user": "Sjors",
      "created_at": "2022-04-15T11:17:53Z",
      "updated_at": "2026-01-16T11:00:14Z",
      "closed_at": null,
      "comments": 20,
      "url": "https://github.com/bitcoin/bitcoin/issues/24861",
      "labels": [
        "Docs",
        "Wallet",
        "Tracking Issue"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3601,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1361257796,
      "number": 26004,
      "title": "util::Result has confusing interface for std::*_ptr T",
      "body": "`util::Result<std::unique_ptr<...>>` treats a nullptr as a `true` value. This has caused at least one bug so far.\r\n\r\nCan we easily forbid passing nullptr in this way? Is there a better/safer solution?",
      "state": "open",
      "user": "luke-jr",
      "created_at": "2022-09-04T21:31:49Z",
      "updated_at": "2026-01-16T10:59:45Z",
      "closed_at": null,
      "comments": 10,
      "url": "https://github.com/bitcoin/bitcoin/issues/26004",
      "labels": [
        "interfaces"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 254,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 996573480,
      "number": 22978,
      "title": "RFC: ArgsManager type and range checking",
      "body": "This issue exists to explore ways of improving the ArgsManager interface to be more convenient and add compile-time type safety.\r\n\r\n#16545 adds runtime type checking for ArgsManager options, but it isn't changing ArgsManager `AddArg` / `GetArg` interface, only adding new flags and behaviors to the existing interface, so it is not taking advantage of C++'s type safety to enforce at compile time that options are always retrieved with the same types they were registered with. A branch that implements this feature is being developed at:\r\n\r\n- https://github.com/ryanofsky/bitcoin/commits/pr/argtype\r\n\r\nAnd is described in [(comment)](https://github.com/bitcoin/bitcoin/issues/22978#issuecomment-2265757710) and [(comment)](https://github.com/bitcoin/bitcoin/issues/22978#issuecomment-2273576739).\r\n\r\nPlanned additional features are:\r\n\r\n- Dropping dependency on [#16545](https://github.com/bitcoin/bitcoin/pull/16545) and making new interface backwards compatible with existing arguments.\r\n- Writing a scripted diff to port all current ArgsManager AddArg and GetArg calls to use the new interface and be backwards compatible, without changing any behavior\r\n- Adding helpers to read arguments directly into Options structs like BlockManager::Options MemPoolOptions without needing to list types or struct members more than once.\r\n- Adding support for custom types (enums, structs, and classes) so Options structs are not limited to reading bool, int, and string options.\r\n- Adding documentation about the implementation and how to use the interface.\r\n\r\n---\r\n\r\nThis issue description has been edited since the issue was opened. The original description was:\r\n\r\n_Originally posted by @ryanofsky in https://github.com/bitcoin/bitcoin/pull/22766#discussion_r694969613_:\r\n\r\nThe way I would like range checking to work in the future would be to rely more on C++ types and `std::numeric_limits`. The idea is arguments would be registered using explicit C++ types:\r\n\r\n```c++\r\nconst Setting<int> SETTING_myint(\"-myint\", \"description\");\r\nconst Setting<std::string> SETTING_mystring(\"-mystring\", \"description\");\r\nconst Setting<std::vector<std::string>> SETTING_mylist(\"-mylist\", \"description\");\r\nconst Setting<std::optional<std::uint16_t>> SETTING_myopt(\"-myopt\", \"description\");\r\nconst Setting<SettingsValue> SETTING_mylegacy(\"-mylegacy\", \"description\");\r\n\r\nvoid RegisterArgs(ArgsManager& args)\r\n{\r\n    args.Register({SETTING_myint, SETTING_mystring, SETTING_mylist, SETTING_myopt, SETTING_mylegacy});\r\n}\r\n```\r\n\r\nand then they could be retrieved in a type safe way:\r\n\r\n```\r\nargs.Get(SETTING_myint);    // returns int\r\nargs.Get(SETTING_mystring); // returns std::string\r\nargs.Get(SETTING_mylist);   // returns std::vector<std::string>\r\nargs.Get(SETTING_myopt);    // returns std::optional<uint16_t>\r\nargs.GetArg/GetArgs/GetIntArg/GetBoolArg(SETTING_mylegacy); // returns requested type\r\n```\r\n\r\nTo get to this point, this PR cleans up existing misused flags and misnamed functions. PR #16545 adds type validation and runtime semantics without changing the ArgsManager API, and a followup PR can improve the API and update call sites without changing the semantics. (There is a direct correspondence between the `ALLOW_` flags from #16545 and the useful C++ settings types `bool`/`int`/`std::string`/`std::optional`/`std::variant`/`std::vector`)\r\n\r\n_Originally posted by @ajtowns https://github.com/bitcoin/bitcoin/pull/22766#discussion_r701448785_:\r\n\r\nI think I finally figured out how you can go a little bit further than the above, ending up with something like:\r\n\r\n```c++\r\nstruct NetSettings\r\n{\r\n    int64_t blockreconstructionextratxn;\r\n    int64_t maxorphantx;\r\n    bool capturemessages;\r\n\r\n    template<typename C, typename... Args>\r\n    static inline void F(Args&... args) {\r\n        return C::Do(args...,\r\n            C::Defn( &NetSettings::blockreconstructionextratxn, \"-blockreconstructionextratxn=<n>\", strprintf(\"Extra transactions to keep in memory for compact block reconstructions (default: %u)\", DEFAULT_BLOCK_RECONSTRUCTION_EXTRA_TXN), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS, DEFAULT_BLOCK_RECONSTRUCTION_EXTRA_TXN ),\r\n            C::Defn( &NetSettings::maxorphantx, \"-maxorphantx=<n>\", strprintf(\"Keep at most <n> unconnectable transactions in memory (default: %u)\", DEFAULT_MAX_ORPHAN_TRANSACTIONS), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS, DEFAULT_MAX_ORPHAN_TRANSACTIONS ),\r\n            C::Defn( &NetSettings::capturemessages, \"-capturemessages\", \"Capture all P2P messages to disk\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST, false )\r\n        );\r\n    }\r\n};\r\n\r\nvoid RegisterNetProcessingArgs(ArgsManager& args)\r\n{\r\n    SettingsRegister<NetSettings>::Register(args);\r\n}\r\n\r\nNetSettings GetNetSettings(const ArgsManager& args)\r\n{\r\n    return SettingsRegister<NetSettings>::Get(args);\r\n}\r\n\r\nclass PeerManagerImpl\r\n{\r\nprivate:\r\n    const NetSettings m_settings;\r\n    PeerManagerImpl(..., const ArgsManager& args) : m_settings{GetNetSettings(args)), ... { ... }\r\n    ...\r\n};\r\n```\r\n\r\nThe idea being that this way:\r\n * it can infer the argument type directly from the type of the struct member so that you can't accidentally specify different types between `args.AddArg<int>` and `Get<bool>`\r\n  * that the settings are const at runtime so can be accessed without any additional locks\r\n  * you only have to access the ArgsManager (and do string parsing) at setup time\r\n  * you don't have to make up lots of new names for everything or add too much boilerplate\r\n\r\nBranch built on top of this PR that has the above working at https://github.com/ajtowns/bitcoin/tree/202109-settings_struct",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2021-09-15T01:42:09Z",
      "updated_at": "2026-01-16T10:59:23Z",
      "closed_at": null,
      "comments": 10,
      "url": "https://github.com/bitcoin/bitcoin/issues/22978",
      "labels": [
        "Needs Conceptual Review",
        "interfaces"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 5680,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2432345503,
      "number": 30530,
      "title": "Nuke format linter",
      "body": "The linter is impossible to maintain, because it is not possible to parse C++ with a simple regex. When it produces nonsense, like https://github.com/bitcoin/bitcoin/runs/27958379841, it is mostly annoying, because the code is perfectly fine, but the red CI is a blocker for the pull request. Also, fixing it isn't trivially possible, so the only solution is to juggle with the code until the regex in the linter is pleased.\r\n\r\nIt would be better to write it as a clang-tidy plugin, however that isn't ideal either, because that will (normally) only run in CI and takes a long time.\r\n\r\nIdeally, it is implemented in `consteval` C++, directly in the source code. (Similar to Rust `std::fmt` or C++20 `std::format`, but they aren't available yet on supported compilers and would be a breaking change in all format strings anyway) \r\n\r\n\r\n\r\n<!-- https://github.com/bitcoin/bitcoin/pull/30386#discussion_r1684380835",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2024-07-26T14:18:05Z",
      "updated_at": "2026-01-16T10:55:08Z",
      "closed_at": "2025-01-15T15:47:13Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/30530",
      "labels": [],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 928,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2789211485,
      "number": 31660,
      "title": "The 28.1 release is not tagged in github",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nIn GitHub releases, 28.0 is still marked as latest. We are holding from updating in Homebrew until this is resolved: https://github.com/Homebrew/homebrew-core/pull/204066\n\n### Expected behaviour\n\n28.1 should be marked as latest release, to confirm it is authentic.\n\n### Steps to reproduce\n\n1. Go to https://github.com/bitcoin/bitcoin\n2. Observe that latest release is 28.0\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\n28.1\n\n### Operating system and version\n\nmacOS 15\n\n### Machine specifications\n\n_No response_",
      "state": "closed",
      "user": "fxcoudert",
      "created_at": "2025-01-15T08:58:12Z",
      "updated_at": "2026-01-16T10:55:04Z",
      "closed_at": "2025-01-15T10:45:44Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/31660",
      "labels": [],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 762,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1237690862,
      "number": 25150,
      "title": "Coin Selection tracepoint overreports use of APS",
      "body": "> > I'm not sure about the original intention (maybe also the documentation is imprecise?), but if `aps_create_tx_internal` is called irrespective of the second `CreateTransactionInternal` result now, I don't see a point in having the `attempting_aps_create_tx` tracepoint anymore.\r\n> \r\n> It helps us know whether the selected_coins tracepoint (that will happen within CreateTransactionInternal) is for the APS CreateTransactionInternal without having to look backwards when `aps_create_tx_internal` is seen.\r\n\r\nIf I understand this correctly, the way this tracepoint is activated, it would log a result as having been produced per APS, whenever the APS result is preferred. Among other things, this would include if there are two equivalent (or even matching) solutions, or if there wasn't any partial-spend concern with the original solution in the first place.\r\nThis results in three different concerns:\r\n1. This feels like a potential footgun for someone trying to understand coin selection outcomes. They might want to know a) how often partial-spends even occurred in the first place, and b) how often the opportunistic APS protected them from it. From what I understand, they cannot actually learn either of these numbers. Instead, a subscriber of the tracepoint would get an inflated sense of how often they were protected from partial spends.\r\n2. Since the APS solution is preferred even when it has a slightly worse fee, when the general coin selection result and the opportunistic APS result differ, the APS result may actually have a worse waste score and get preferred for the transaction building, disimproving the outcome for the user _even when there was no partial-spend in the original solution_.\r\n3. The coin selection is run twice while that might be completely unnecessary in many cases.\r\n\r\nAll together, I think both the design for this tracepoint and the design for the opportunistic APS may have the same solution: only run the opportunistic APS if the original selection result _includes a partial  spend_: this would speed up coin selection, remove the potential for disimproving the selection result, and give useful numbers to the subscribers of the tracepoint.\r\n\r\nWhile I think this PR improves over the original deployment, if I got the above right, it might be better to remove this tracepoint due to not providing a clear signal instead.\r\n\r\n_Originally posted by @Xekyo in https://github.com/bitcoin/bitcoin/issues/25003#issuecomment-1122685021_",
      "state": "open",
      "user": "murchandamus",
      "created_at": "2022-05-16T20:37:48Z",
      "updated_at": "2026-01-16T10:29:48Z",
      "closed_at": null,
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/25150",
      "labels": [
        "Wallet",
        "Scripts and tools"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2526,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1637683536,
      "number": 27315,
      "title": "tidy: enable `cppcoreguidelines-pro-type-member-init`",
      "body": "https://clang.llvm.org/extra/clang-tidy/checks/cppcoreguidelines/pro-type-member-init.html\r\n> The check flags user-defined constructor definitions that do not initialize all fields that would be left in an undefined state by default construction, e.g. builtins, pointers and record types without user-provided default constructors containing at least one such type. If these fields arenâ€™t initialized, the constructor will leave some of the memory in an undefined state.\r\n\r\nHave been multiple calls to add this, i.e https://github.com/bitcoin/bitcoin/pull/26762#issuecomment-1409699173.\r\n\r\nAlso related to #26296.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2023-03-23T14:42:34Z",
      "updated_at": "2026-01-16T10:26:51Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/27315",
      "labels": [
        "Feature",
        "Scripts and tools"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 667,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1681671983,
      "number": 27526,
      "title": "wallet coin selection: don't mixup coins with absolute timelocks of different types",
      "body": "We now support spending from coins containing `CHECKLOCKTIMEVERIFY` instructions. `CLTV` is a check on the value of the `nLockTime` field of the spending transaction. There are two types of timelocks possible: by timestamp and by block. Both are incompatible, the `nLockTime` field cannot satisfy both a timestamp and a block timelock.\r\n\r\nThe coin selection is at the moment completely unaware of timelocks. If we have two coins for two different descriptors, one with a timestamp absolute timelock and the other with a block count absolute timelock, the coin selection algorithm may select both of them in a single transaction.\r\n\r\nTo be clear i don't think this should be treated as a bug that needs resolving for 25.0. As mentioned in #24149 the wallet needs a lot more logic to correctly handle managing coins with more complex scripts. (For instance, the wallet doesn't know what timelocked coins would be spendable at the next block, let alone set the `nSequence`, `nLockTime` according to the required value.)\r\n\r\nFrom a conversation with @sanket1729. Also cc @ishaanam.",
      "state": "open",
      "user": "darosior",
      "created_at": "2023-04-24T16:48:24Z",
      "updated_at": "2026-01-16T10:08:33Z",
      "closed_at": null,
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/27526",
      "labels": [
        "Feature",
        "Wallet"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1159,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1647446127,
      "number": 27369,
      "title": "Fix net grouping of non-IP networks",
      "body": "### Current behaviour\r\n\r\n`NetGroupManager::GetGroup()` was designed with IP networks in mind, where for example `10.20.30.40` and `10.20.30.45` are \"close\" and likely to belong to the same entity, while `100.20.30.40` is \"distant\" from them. This does not apply however for Tor, I2P and CJDNS where the address is \"random\" bytes. Actually, Tor, I2P and CJDNS addresses that have common prefix are _harder_ to obtain than ones that don't have a common prefix (the opposite compared to IP).\r\n\r\nCurrently `NetGroupManager::GetGroup()` is doing prefixing on Tor, I2P and CJDNS addresses and assumes same properties apply as for IP addresses. This magically \"works\" to some extent but has drawbacks. Some serious changes are needed to remove that assumption from the code.\r\n\r\nSee\r\nhttps://github.com/bitcoin/bitcoin/pull/22563\r\nhttps://github.com/bitcoin/bitcoin/pull/27264#issuecomment-1481322628\r\n\r\n### Expected behaviour\r\n\r\n* Don't do prefixing on Tor, I2P and CJDNS and don't assume proximity based on that.\r\n* Treat all addresses from Tor as one group (because it is very easy to obtain huge amount of them). Same for I2P and CJDNS.\r\n* Make sure addrman can still store enough addresses from those networks.\r\n* Make sure a single source from Tor, I2P and CJDNS cannot flood addrman with junk due to the previous point.\r\n",
      "state": "open",
      "user": "vasild",
      "created_at": "2023-03-30T11:39:20Z",
      "updated_at": "2026-01-16T10:08:29Z",
      "closed_at": null,
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/27369",
      "labels": [
        "Net"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1356,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1750050240,
      "number": 27843,
      "title": "ThreadI2PAcceptIncoming temporarily bypasses 125 connection ceiling",
      "body": "- The i2p accept code is in `ThreadI2PAcceptIncoming`, instead of in `ThreadSocketHandler` like the non-i2p accept code.\r\n- When accepting non-i2p connections, a connection is accepted in `AcceptConnection` and if there are more than `maxInbound` outstanding connections, one is marked for disconnect. The next iteration of the loop in `ThreadSocketHandler` will call `DisconnectNodes` and remove it.\r\n-  Since the i2p code resides in its own thread, it's possible for i2p connections to stack up past 125 (I was able to hit 190 outstanding connections when running a local script to connect to my bitcoind i2p address). I think the higher numbered fd's could cause a slight slowdown in `select`.\r\n- How many connections it can go past 125 is a race between `DisconnectNodes` and `ThreadI2PAcceptIncoming`.\r\n\r\n<details>\r\n<summary>Local test</summary>\r\n<br>\r\n\r\n```\r\ndiff --git a/src/test/i2p_tests.cpp b/src/test/i2p_tests.cpp\r\nindex b2e1ae43b..f1f0b2a60 100644\r\n--- a/src/test/i2p_tests.cpp\r\n+++ b/src/test/i2p_tests.cpp\r\n@@ -10,14 +10,52 @@\r\n #include <test/util/net.h>\r\n #include <test/util/setup_common.h>\r\n #include <util/threadinterrupt.h>\r\n+#include <netbase.h>\r\n+#include <protocol.h>\r\n+\r\n+#include <chrono>\r\n+#include <thread>\r\n \r\n #include <boost/test/unit_test.hpp>\r\n \r\n #include <memory>\r\n #include <string>\r\n+#include <stdio.h>\r\n \r\n BOOST_FIXTURE_TEST_SUITE(i2p_tests, BasicTestingSetup)\r\n \r\n+BOOST_AUTO_TEST_CASE(spam)\r\n+{\r\n+    CThreadInterrupt interrupt;\r\n+\r\n+    in_addr ipv4Addr;\r\n+    ipv4Addr.s_addr = inet_addr(\"127.0.0.1\");\r\n+\r\n+    Proxy p = Proxy(CService(ipv4Addr, 7656), false);\r\n+\r\n+    auto i2p_transient_session = std::make_unique<i2p::sam::Session>(p.proxy, &interrupt);\r\n+\r\n+    const char* pszDest = \"tfshhokzifn2g46dc6dxwrwwxwbeo4l5eeepequ52kpvrflm3foq.b32.i2p\";\r\n+\r\n+    const std::vector<CService> resolved{Lookup(pszDest, 0, false, 256)};\r\n+\r\n+    CAddress addrConnect = CAddress(resolved[0], NODE_NONE);\r\n+\r\n+    std::vector<std::unique_ptr<Sock>> v;\r\n+    v.reserve(1000);\r\n+\r\n+    for (int i = 0; i < 1000; i++) {\r\n+        i2p::Connection conn;\r\n+        bool proxy_error;\r\n+        auto connected = i2p_transient_session->Connect(addrConnect, conn, proxy_error);\r\n+        if (connected) {\r\n+            v.push_back(std::move(conn.sock));\r\n+        }\r\n+    }\r\n+\r\n+    std::this_thread::sleep_for(std::chrono::milliseconds(50000));\r\n+}\r\n+\r\n BOOST_AUTO_TEST_CASE(unlimited_recv)\r\n {\r\n     const auto prev_log_level{LogInstance().LogLevel()};\r\n```\r\n\r\nI then called it from a script:\r\n```\r\n#!/bin/bash\r\n#\r\nfor i in {1..10}\r\ndo\r\n\t./src/test/test_bitcoin --log_level=all --run_test=i2p_tests/spam &\r\ndone\r\n```\r\n\r\n</details>\r\n\r\nWhen testing this, I also ran into a reproducible error when simultaneously using `bitcoin-cli`:\r\n```\r\nerror: timeout on transient error: Could not connect to the server 127.0.0.1:18443 (error code 1 - \"EOF reached\")\r\n\r\nMake sure the bitcoind server is running and that you are connecting to the correct RPC port.\r\n```\r\n\r\nWireshark showed that a TCP port was reused which led to a RST being sent back to bitcoin-cli. It happened when the i2p sam bridge ran out of memory, but as far as I can tell the rpc server should be totally unaffected by that. This error message also appeared in bitcoind's logs at the same time:\r\n `2023-06-09T15:02:58Z connect() to 127.0.0.1:7656 failed: Can't assign requested address (49)`",
      "state": "open",
      "user": "Crypt-iQ",
      "created_at": "2023-06-09T14:52:59Z",
      "updated_at": "2026-01-16T10:07:25Z",
      "closed_at": null,
      "comments": 15,
      "url": "https://github.com/bitcoin/bitcoin/issues/27843",
      "labels": [
        "Bug",
        "Net"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3445,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2947965588,
      "number": 32142,
      "title": "Feature Request: testmempoolaccept with an argument to ignore nLocktime/nSequence time-locking",
      "body": "### Please describe the feature you'd like to see added.\n\nExecute `testmempoolaccept` in a way that will ignore the time/block-height validations of the transactions' `nSequence` and `nLocktime`.\n\n### Is your feature related to a problem, if so please describe it.\n\n`testmempoolaccept` is a very useful tool to verify transactions that aren't supposed to be broadcasted immediately - for example, for emergency recovery in case the seed is lost.\n`nLocktime` is also useful in such case, to prevent the recovery transaction from being broadcasted too early. However, after signing a transaction with a future `nLocktime`, I couldn't be sure that it is indeed valid: `testmempoolaccept` considers this transaction as `non-final` because of its future `nLocktime`, without explaining whether it has other problems (i.e. invalid signatures etc.).\n\n### Describe the solution you'd like\n\nA third optional parameter to `testmempoolaccept` (after `rawtxs` and `maxfeerate`) called `ignoretimelocks`, that will be a boolean.\n\n### Describe any alternatives you've considered\n\nI've tried writing code that would parse the transaction and, given the current mempool utxos, verify its scripts. This becomes complicated to implement in multisig and segwit transactions, and doesn't give me the guarantees that I want for such long-term transaction.\n\nAnother suggestion is that `testmempoolaccept` will accumulate all the reasons a transaction is unacceptable, and not exit after the first reason.\n\n### Please leave any additional context\n\n`nSequence` is a bitfield with multiple purposes, like RBF, and possibly other features in the future. My suggestion only regards BIP-68 validations of `nSequence` and not other features.",
      "state": "open",
      "user": "oren-z0",
      "created_at": "2025-03-25T23:07:46Z",
      "updated_at": "2026-01-16T03:59:18Z",
      "closed_at": null,
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/32142",
      "labels": [
        "Feature",
        "RPC/REST/ZMQ",
        "Mempool"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1807,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3818770788,
      "number": 34312,
      "title": "Double wrong grammatic usage in German locale",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\n\"Bitte mit der neueste Softwareversion auszufÃ¼hren.\" is wrong in two senses, it has to be \"neuesten\" and \"ausfÃ¼hren\", I'm from Germany.\n\n### Expected behaviour\n\nIt has to be \"neuesten\" and \"ausfÃ¼hren\", I'm from Germany.\n\n### Steps to reproduce\n\nOpen the file bitcoin_de.ts or trigger the message in usage\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nOther\n\n### What version of Bitcoin Core are you using?\n\nLatest\n\n### Operating system and version\n\nLatest\n\n### Machine specifications\n\n_No response_",
      "state": "closed",
      "user": "benediktjohannes",
      "created_at": "2026-01-15T19:02:39Z",
      "updated_at": "2026-01-15T23:21:26Z",
      "closed_at": "2026-01-15T19:07:31Z",
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/issues/34312",
      "labels": [
        "GUI"
      ],
      "comment_data": [
        {
          "id": 3756423138,
          "user": "fanquake",
          "body": "Please send translation fixes upstream to our transifex.",
          "created_at": "2026-01-15T19:07:17Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 56,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3756601851,
          "user": "maflcko",
          "body": "> ### What version of Bitcoin Core are you using?\n> \n> Latest\n\nNo, you are not. This was already fixed more than a year ago:\n\n```\n$ git grep 'Softwareversion'\nsrc/qt/locale/bitcoin_de.ts:Bitte mit der neuesten Softwareversion versuchen.\n",
          "created_at": "2026-01-15T19:53:02Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 237,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3756609657,
          "user": "benediktjohannes",
          "body": "Thanks for the question, but yes, I used the latest because it was fixed a year ago with \"Bitte mit der neuesten Softwareversion versuchen.\", but then it was changed again to a wrong version, see in bitcoin_de.ts",
          "created_at": "2026-01-15T19:55:02Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 0,
            "text_length": 212,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3756627027,
          "user": "maflcko",
          "body": "Oh, right. It was just fixed 40 minutes ago in transifex. It'll be fixed in the next version, hopefully.",
          "created_at": "2026-01-15T20:00:05Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 104,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3756631683,
          "user": "benediktjohannes",
          "body": "No problem! And by the way: I fixed it on transifex ðŸ¤£ ",
          "created_at": "2026-01-15T20:01:20Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 54,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3756865286,
          "user": "hebasto",
          "body": "cc @Emzy as German translation coordinator.",
          "created_at": "2026-01-15T21:06:44Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 43,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3757349782,
          "user": "Emzy",
          "body": "> No problem! And by the way: I fixed it on transifex ðŸ¤£\n\nI already accepted the fix on transifex.\nThank you for helping!",
          "created_at": "2026-01-15T23:21:26Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 120,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 684,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 622632548,
      "number": 19042,
      "title": "Tor-only transaction broadcast onlynet=onion alternative",
      "body": "It would be nice if there was a way to tell core to only broadcast transactions over Tor, but use clearnet for everything else.\r\n\r\nAs far as I can tell the only way to guarantee transaction broadcast over Tor is to use onlynet=onion, which means that all network traffic goes over Tor. The problem is that this introduces latency for blocks/confirmations and transactions. Some users might only want to use Tor to try to protect \"first broadcast\" transaction origin analysis which can be a problem with sybil attacking clearnet nodes. This can still be a problem on Tor as well, but can be more difficult to pull off.\r\n\r\nSome bitcoin software such as wasabi and joinmarket already implement this by establishing a new Tor circuit, broadcasting the transaction, and then disconnecting. Perhaps bitcoin could do this as well?\r\n\r\nSome things that were brought up when I mentioned this on IRC by @naumenkogs, @luke-jr  and others:\r\n\r\nFor the resistance to first-broadcast analysis to be effective, the node should treat the transaction as if it wasn't theirs to begin with. I'm not familiar with the network code, so I'm not sure if anything would have to change relay policy-wise.\r\n\r\nWould be happy to hear other thoughts on what would be required to implement this, or if there's something I'm missing, as it's something I would be interested in implementing if there are enough concept acks.\r\n\r\n\r\nTL;DR rationale:\r\n\r\n- A nodes wants to recieve blocks/confirmations/transactions as soon as possible with the lowest latency\r\n\r\n- A node wants increased broadcast privacy without paying the full cost of onlynet=tor latency\r\n",
      "state": "closed",
      "user": "jb55",
      "created_at": "2020-05-21T16:42:35Z",
      "updated_at": "2026-01-15T21:03:54Z",
      "closed_at": "2026-01-15T21:03:54Z",
      "comments": 13,
      "url": "https://github.com/bitcoin/bitcoin/issues/19042",
      "labels": [
        "Feature"
      ],
      "comment_data": [
        {
          "id": 3755783269,
          "user": "vasild",
          "body": "Implemented in https://github.com/bitcoin/bitcoin/pull/29415 for the `sendrawtransaction` RPC. Not for the wallet yet. For the wallet, one could create unsigned PSBT from the GUI and then use the `walletprocesspsbt` and `sendrawtransaction` RPCs.",
          "created_at": "2026-01-15T16:39:58Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 246,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3755944509,
          "user": "Nonthawat100iQ",
          "body": "NONTHAWAT PHUPHASIT",
          "created_at": "2026-01-15T17:04:25Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 19,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3756855679,
          "user": "jb55",
          "body": "amazing, thanks guys!",
          "created_at": "2026-01-15T21:03:54Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 21,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 2,
        "text_length": 1677,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3796644705,
      "number": 34237,
      "title": "ci: IWYU job giving incorrect suggestions",
      "body": "As pointed out here: https://github.com/bitcoin/bitcoin/pull/33810#discussion_r2672640164:\n> +#include <assert.h>\n\nSuggesting `<assert.h>` is incorrect, and if the dev applied that diff, `clang-tidy` will fail with `modernize-deprecated-headers`.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-09T11:45:31Z",
      "updated_at": "2026-01-15T18:29:15Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34237",
      "labels": [
        "Tests"
      ],
      "comment_data": [
        {
          "id": 3756290266,
          "user": "hebasto",
          "body": "> cc [@hebasto](https://github.com/hebasto)\n\nFixed in https://github.com/bitcoin/bitcoin/pull/34310.",
          "created_at": "2026-01-15T18:29:15Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 100,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 288,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2353376259,
      "number": 30289,
      "title": "Cluster mempool tracking issue",
      "body": "What to review next:\n\n* #34257 \n\n---\n\nPlan:\n* Lowest level: generic utilities:\n  * [x] [#29242 FeeFrac type](https://github.com/bitcoin/bitcoin/pull/29242)\n    * [x] [#30535 Add FeeFrac::EvaluateFee](https://github.com/bitcoin/bitcoin/pull/30535)\n      * [x] [#32240 Fix integer overflow in FeeFrac fuzz test](https://github.com/bitcoin/bitcoin/pull/32240)\n      * [x] [#32300 Fix different overflow in FeeFrac fuzz test](https://github.com/bitcoin/bitcoin/pull/32300)\n  * [x] [#30160 BitSet type](https://github.com/bitcoin/bitcoin/pull/30160)\n  * [x] [#30161 VecDeque type](https://github.com/bitcoin/bitcoin/pull/30161)\n* Low level: operations on `DepGraph` type (dependencies/linearizations for a single cluster)\n  * [x] [#30126 Base linearization algorithm](https://github.com/bitcoin/bitcoin/pull/30126)\n    * [x] [#30605 Split tests from tests-of-tests](https://github.com/bitcoin/bitcoin/pull/30605)\n    * [x] [#30857 Extend `DepGraph` functionality](https://github.com/bitcoin/bitcoin/pull/30857)\n  * [x] [#30285 Merging and postprocessing of linearizations](https://github.com/bitcoin/bitcoin/pull/30285)\n  * [x] [#30286 Optimized candidate search](https://github.com/bitcoin/bitcoin/pull/30286)\n  * [x] [#32545 Replace linearization with SFL](https://github.com/bitcoin/bitcoin/pull/32545)\n    * [x] [#34259 SFL chunk minimization](https://github.com/bitcoin/bitcoin/pull/34259)\n  * [ ] [#34023 SFL optimizations](https://github.com/bitcoin/bitcoin/pull/34023)\n    * [ ] [#34138 SFL cost model](https://github.com/bitcoin/bitcoin/pull/34138)\n* Intermediate level: operations on `TxGraph` type (dependencies/linearizations for the entire mempool)\n  * [x] [#31363 TxGraph basics](https://github.com/bitcoin/bitcoin/pull/31363)\n    * [x] [#32151 TxGraph basics follow-up](https://github.com/bitcoin/bitcoin/pull/32151)\n    * [x] [#32177 TxGraph increase fuzz coverage](https://github.com/bitcoin/bitcoin/pull/32177)\n    * [x] [#32191 Make TxGraph fuzzing more deterministic](https://github.com/bitcoin/bitcoin/pull/32191)\n    * [x] [#33354 Use enum Level instead of bool main_only](https://github.com/bitcoin/bitcoin/pull/33354)\n    * [x] [#33862 Drop support for `TxGraph::Ref` move assignment](https://github.com/bitcoin/bitcoin/pull/33862)\n    * ~~[#33335 Randomize order of transactions](https://github.com/bitcoin/bitcoin/pull/33335)~~\n    * [ ] [#34257 Deterministic order of transactions](https://github.com/bitcoin/bitcoin/pull/34257)\n  * [x] [#31444 TxGraph mining/eviction](https://github.com/bitcoin/bitcoin/pull/31444)\n    * [x] [#33469 Use `std::unordered_set` for skipped clusters](https://github.com/bitcoin/bitcoin/pull/33469)\n  * [x] [#31553 TxGraph reorgs](https://github.com/bitcoin/bitcoin/pull/31553)\n  * [x] [#32263 TxGraph work controls](https://github.com/bitcoin/bitcoin/pull/32263)\n  * [x] [#33157 TxGraph memory usage](https://github.com/bitcoin/bitcoin/pull/33157)\n  * [x] [#34085 TxGraph exploiting SFL better](https://github.com/bitcoin/bitcoin/pull/34085)\n* High level: changes to mempool/validation\n  * [x] [#31122 Changesets for mempool](https://github.com/bitcoin/bitcoin/pull/31122)\n  * [x] [#33629 Cluster mempool implementation](https://github.com/bitcoin/bitcoin/pull/33629)\n    * ~~[#28676 Old version](https://github.com/bitcoin/bitcoin/pull/28676)~~\n  * [x] [#33591 Cluster mempool optimizations and cleanups](https://github.com/bitcoin/bitcoin/pull/33591)\n",
      "state": "open",
      "user": "sipa",
      "created_at": "2024-06-14T13:21:36Z",
      "updated_at": "2026-01-15T14:57:06Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/30289",
      "labels": [
        "Tracking Issue"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3437,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3784743931,
      "number": 34206,
      "title": "wallet: Assertion `!wtx.truc_child_in_mempool.has_value()' failed",
      "body": "The following `Assume` in the wallet will fail (triggered through rpc) under certain reorg conditions:\nhttps://github.com/bitcoin/bitcoin/blob/114901c0655d1dea3024a1daa362716c948bbde3/src/wallet/spend.cpp#L413\n\n\n<details>\n\n<summary>Vibe coded functional test patch to demonstrate (`-DABORT_ON_FAILED_ASSUME` is required):</summary>\n\n\n```patch\nFrom 54aea28e6439be5645267f0344a6337d9798ba14 Mon Sep 17 00:00:00 2001\nFrom: dergoegge <n.goeggi@gmail.com>\nDate: Tue, 6 Jan 2026 10:49:02 +0000\nSubject: [PATCH] truc wallet reorg bug\n\n---\n test/functional/mempool_truc.py | 163 +++++++++++++++++++++++++-------\n 1 file changed, 127 insertions(+), 36 deletions(-)\n\ndiff --git a/test/functional/mempool_truc.py b/test/functional/mempool_truc.py\nindex 2586308e4d..a155d57b68 100755\n--- a/test/functional/mempool_truc.py\n+++ b/test/functional/mempool_truc.py\n@@ -47,6 +47,36 @@ class MempoolTRUC(BitcoinTestFramework):\n         self.extra_args = [[]]\n         self.setup_clean_chain = True\n\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def create_tx(self, wallet, inputs, outputs, version, prevtxs=None):\n+        \"\"\"Create a signed transaction using the real wallet.\n+\n+        Args:\n+            wallet: The wallet RPC to use\n+            inputs: List of inputs (empty to let fundrawtransaction pick)\n+            outputs: Dict of address -> amount\n+            version: Transaction version\n+            prevtxs: Optional list of previous transaction info for signing\n+                     unbroadcast transactions. Each entry should have:\n+                     {\"txid\": ..., \"vout\": ..., \"scriptPubKey\": ..., \"amount\": ...}\n+        \"\"\"\n+        raw_tx = wallet.createrawtransaction(inputs=inputs, outputs=outputs, version=version)\n+        if inputs == []:\n+            raw_tx = wallet.fundrawtransaction(raw_tx, {'include_unsafe': True})[\"hex\"]\n+        if prevtxs:\n+            signed_tx = wallet.signrawtransactionwithwallet(raw_tx, prevtxs)\n+        else:\n+            signed_tx = wallet.signrawtransactionwithwallet(raw_tx)\n+        return signed_tx[\"hex\"]\n+\n+    def send_tx(self, wallet, inputs, outputs, version, prevtxs=None):\n+        \"\"\"Create and broadcast a transaction using the real wallet.\"\"\"\n+        tx_hex = self.create_tx(wallet, inputs, outputs, version, prevtxs)\n+        txid = wallet.sendrawtransaction(tx_hex)\n+        return txid\n+\n     def check_mempool(self, txids):\n         \"\"\"Assert exact contents of the node's mempool (by txid).\"\"\"\n         mempool_contents = self.nodes[0].getrawmempool()\n@@ -173,41 +203,102 @@ class MempoolTRUC(BitcoinTestFramework):\n     @cleanup()\n     def test_truc_reorg(self):\n         node = self.nodes[0]\n+        self.log.info(\"Test TRUC transactions survive reorg correctly\")\n+\n+        # Create a wallet for this test\n+        node.createwallet(\"truc_reorg_wallet\")\n+        wallet = node.get_wallet_rpc(\"truc_reorg_wallet\")\n+\n+        # Fund the wallet\n+        funding_addr = wallet.getnewaddress()\n+        self.generatetoaddress(node, 1, funding_addr)\n+        self.generate(node, 100)  # Mature the coinbase\n\n         # Prep for fork\n         fork_blocks = create_empty_fork(node)\n-        self.log.info(\"Test that, during a reorg, TRUC rules are not enforced\")\n         self.check_mempool([])\n\n-        # Testing 2<-3 versions allowed\n-        tx_v2_block = self.wallet.create_self_transfer(version=2)\n+        # tx_chain_1: v2 transaction with 2 outputs\n+        addr1 = wallet.getnewaddress()\n+        addr2 = wallet.getnewaddress()\n+        tx_chain_1_hex = self.create_tx(wallet, [], {addr1: 10, addr2: 10}, version=2)\n+        tx_chain_1_decoded = node.decoderawtransaction(tx_chain_1_hex)\n+        tx_chain_1_txid = tx_chain_1_decoded[\"txid\"]\n+\n+        # Find which vout corresponds to which address and get scriptPubKey info\n+        vout_for_addr1 = None\n+        vout_for_addr2 = None\n+        scriptpubkey_addr1 = None\n+        scriptpubkey_addr2 = None\n+        for vout in tx_chain_1_decoded[\"vout\"]:\n+            if vout[\"scriptPubKey\"].get(\"address\") == addr1:\n+                vout_for_addr1 = vout[\"n\"]\n+                scriptpubkey_addr1 = vout[\"scriptPubKey\"][\"hex\"]\n+            elif vout[\"scriptPubKey\"].get(\"address\") == addr2:\n+                vout_for_addr2 = vout[\"n\"]\n+                scriptpubkey_addr2 = vout[\"scriptPubKey\"][\"hex\"]\n+\n+        # tx_chain_2: v3 transaction spending first output of tx_chain_1\n+        addr3 = wallet.getnewaddress()\n+        prevtxs_chain_2 = [{\n+            \"txid\": tx_chain_1_txid,\n+            \"vout\": vout_for_addr1,\n+            \"scriptPubKey\": scriptpubkey_addr1,\n+            \"amount\": Decimal(\"10\")\n+        }]\n+        tx_chain_2_hex = self.create_tx(\n+            wallet,\n+            [{\"txid\": tx_chain_1_txid, \"vout\": vout_for_addr1}],\n+            {addr3: Decimal(\"9.99999\")},\n+            version=3,\n+            prevtxs=prevtxs_chain_2\n+        )\n+        tx_chain_2_decoded = node.decoderawtransaction(tx_chain_2_hex)\n+        tx_chain_2_txid = tx_chain_2_decoded[\"txid\"]\n+\n+        # Get scriptPubKey for tx_chain_2 output\n+        scriptpubkey_addr3 = tx_chain_2_decoded[\"vout\"][0][\"scriptPubKey\"][\"hex\"]\n+\n+        # tx_chain_3: v3 transaction spending output of tx_chain_2\n+        addr4 = wallet.getnewaddress()\n+        prevtxs_chain_3 = [{\n+            \"txid\": tx_chain_2_txid,\n+            \"vout\": 0,\n+            \"scriptPubKey\": scriptpubkey_addr3,\n+            \"amount\": Decimal(\"9.99999\")\n+        }]\n+        tx_chain_3_hex = self.create_tx(\n+            wallet,\n+            [{\"txid\": tx_chain_2_txid, \"vout\": 0}],\n+            {addr4: Decimal(\"9.99998\")},\n+            version=3,\n+            prevtxs=prevtxs_chain_3\n+        )\n+        tx_chain_3_decoded = node.decoderawtransaction(tx_chain_3_hex)\n+        tx_chain_3_txid = tx_chain_3_decoded[\"txid\"]\n\n-        # Testing 3<-2 versions allowed\n-        tx_v3_block = self.wallet.create_self_transfer(version=3)\n+        tx_to_mine = [tx_chain_1_hex, tx_chain_2_hex, tx_chain_3_hex]\n+        self.generateblock(node, output=\"raw(42)\", transactions=tx_to_mine)\n\n-        # Testing overly-large child size\n-        tx_v3_block2 = self.wallet.create_self_transfer(version=3)\n+        self.check_mempool([])\n\n-        # Also create a linear chain of 3 TRUC transactions that will be directly mined, followed by one v2 in-mempool after block is made\n-        tx_chain_1 = self.wallet.create_self_transfer(version=3)\n-        tx_chain_2 = self.wallet.create_self_transfer(utxo_to_spend=tx_chain_1[\"new_utxo\"], version=3)\n-        tx_chain_3 = self.wallet.create_self_transfer(utxo_to_spend=tx_chain_2[\"new_utxo\"], version=3)\n+        self.trigger_reorg(fork_blocks)\n\n-        tx_to_mine = [tx_v3_block[\"hex\"], tx_v2_block[\"hex\"], tx_v3_block2[\"hex\"], tx_chain_1[\"hex\"], tx_chain_2[\"hex\"], tx_chain_3[\"hex\"]]\n-        self.generateblock(node, output=\"raw(42)\", transactions=tx_to_mine)\n+        self.check_mempool([tx_chain_1_txid, tx_chain_2_txid, tx_chain_3_txid])\n\n-        self.check_mempool([])\n+        # tx_chain_4: v2 transaction funded by the wallet (spending unconfirmed outputs from tx_chain_1)\n+        addr5 = wallet.getnewaddress()\n+        self.log.info(\"Creating tx_chain_4 spending from unconfirmed tx_chain_1\")\n+        tx_chain_4_txid = self.send_tx(\n+            wallet,\n+            [],  # Let fundrawtransaction pick inputs\n+            {addr5: Decimal(\"9.99\")},\n+            version=2\n+        )\n\n-        tx_v2_from_v3 = self.wallet.send_self_transfer(from_node=node, utxo_to_spend=tx_v3_block[\"new_utxo\"], version=2)\n-        tx_v3_from_v2 = self.wallet.send_self_transfer(from_node=node, utxo_to_spend=tx_v2_block[\"new_utxo\"], version=3)\n-        tx_v3_child_large = self.wallet.send_self_transfer(from_node=node, utxo_to_spend=tx_v3_block2[\"new_utxo\"], target_vsize=1250, version=3)\n-        assert_greater_than(node.getmempoolentry(tx_v3_child_large[\"txid\"])[\"vsize\"], TRUC_CHILD_MAX_VSIZE)\n-        tx_chain_4 = self.wallet.send_self_transfer(from_node=node, utxo_to_spend=tx_chain_3[\"new_utxo\"], version=2)\n-        self.check_mempool([tx_v2_from_v3[\"txid\"], tx_v3_from_v2[\"txid\"], tx_v3_child_large[\"txid\"], tx_chain_4[\"txid\"]])\n+        self.check_mempool([tx_chain_1_txid, tx_chain_2_txid, tx_chain_3_txid, tx_chain_4_txid])\n\n-        # Reorg should have all block transactions re-accepted, ignoring TRUC enforcement\n-        self.trigger_reorg(fork_blocks)\n-        self.check_mempool([tx_v3_block[\"txid\"], tx_v2_block[\"txid\"], tx_v3_block2[\"txid\"], tx_v2_from_v3[\"txid\"], tx_v3_from_v2[\"txid\"], tx_v3_child_large[\"txid\"], tx_chain_1[\"txid\"], tx_chain_2[\"txid\"], tx_chain_3[\"txid\"], tx_chain_4[\"txid\"]])\n+        wallet.unloadwallet()\n\n     @cleanup(extra_args=[\"-limitclustercount=1\"])\n     def test_nondefault_package_limits(self):\n@@ -658,20 +749,20 @@ class MempoolTRUC(BitcoinTestFramework):\n         node = self.nodes[0]\n         self.wallet = MiniWallet(node)\n         self.generate(self.wallet, 200)\n-        self.test_truc_max_vsize()\n-        self.test_truc_acceptance()\n-        self.test_truc_replacement()\n+        #self.test_truc_max_vsize()\n+        #self.test_truc_acceptance()\n+        #self.test_truc_replacement()\n         self.test_truc_reorg()\n-        self.test_nondefault_package_limits()\n-        self.test_truc_ancestors_package()\n-        self.test_truc_ancestors_package_and_mempool()\n-        self.test_sibling_eviction_package()\n-        self.test_truc_package_inheritance()\n-        self.test_truc_in_testmempoolaccept()\n-        self.test_reorg_2child_rbf()\n-        self.test_truc_sibling_eviction()\n-        self.test_reorg_sibling_eviction_1p2c()\n-        self.test_minrelay_in_package_combos()\n+        #self.test_nondefault_package_limits()\n+        #self.test_truc_ancestors_package()\n+        #self.test_truc_ancestors_package_and_mempool()\n+        #self.test_sibling_eviction_package()\n+        #self.test_truc_package_inheritance()\n+        #self.test_truc_in_testmempoolaccept()\n+        #self.test_reorg_2child_rbf()\n+        #self.test_truc_sibling_eviction()\n+        #self.test_reorg_sibling_eviction_1p2c()\n+        #self.test_minrelay_in_package_combos()\n\n\n if __name__ == \"__main__\":\n--\n2.50.1\n```\n\n</details>\n\nAssertion was added in #32896\n\n*This was found with a test running on [Antithesis](https://antithesis.com/).*",
      "state": "closed",
      "user": "dergoegge",
      "created_at": "2026-01-06T11:02:14Z",
      "updated_at": "2026-01-15T14:17:30Z",
      "closed_at": "2026-01-15T14:17:30Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/34206",
      "labels": [
        "Wallet"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 10405,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3776297465,
      "number": 34190,
      "title": "bitcoind shouldn't perform network activity if the option networkactive=0, e.g. [addrman] Selected IP:PORT from tried",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nThere are many logs like the examples below despite networkactive=0:\n1. `2025-12-31T12:24:47Z [addrman] Selected 34.75.109.94:8333 from tried`\n2. `2025-12-31T12:24:47Z [tor] Error connecting to Tor control socket`\n`2025-12-31T12:24:47Z [tor] Not connected to Tor control port 127.0.0.1:9051, retrying in 25.63 s\n`\n3. `2025-12-31T12:28:43Z [net:error] Could not get best interface for default route: Element not found.  (1168)`\n`2025-12-31T12:28:43Z [net] portmap: Could not determine IPv4 default gateway`\n\n\n\n\n### Expected behaviour\n\nThere isn't any network activity and so no such logs.\n\n### Steps to reproduce\n\n1. Start `bitcoind.exe -networkactive=0` \n\n### Relevant log output\n\n[bitcoind_addrman_win.txt](https://github.com/user-attachments/files/24407482/bitcoind_addrman_win.txt)\n\n### How did you obtain Bitcoin Core\n\nPre-built binaries\n\n### What version of Bitcoin Core are you using?\n\nv29\n\n### Operating system and version\n\nWindows 11\n\n### Machine specifications\n\n_No response_",
      "state": "open",
      "user": "GregTonoski",
      "created_at": "2026-01-02T12:43:54Z",
      "updated_at": "2026-01-15T13:59:05Z",
      "closed_at": null,
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/34190",
      "labels": [
        "Bug",
        "Needs Conceptual Review"
      ],
      "comment_data": [
        {
          "id": 3743302568,
          "user": "willcl-ark",
          "body": "If you interpret \"networkactive\" to mean \"this program will not perform any network-related activity\" then \"fixing\" this would make sense. However of your interpretation is \"toggle a connection to the bitcoin p2p network\" then the current behaviour seems fine:\n\n- If you have networkactive and toggle it, then all bitcoin p2p connections are dropped\n- Toggle it again to re-enable connections\n\nConfiguring pmp, running the addrman loop and making a connection to the tor control port in _readiness_ for future connections doesn't seem completely untoward, in my opinion.\n\nCurious what others think here though, as giving `torControlThread` and `mapport_thread` knowledge of the state of `networkactive` is pretty easy. I didn't have a look at addrman yet though...\n\nedit: I did end up taking a look at what an implementation for this would look like for mapport and torcontroller here: https://github.com/bitcoin/bitcoin/compare/master...willcl-ark:bitcoin:refs/heads/respect-networkactive\n\nSeems to work ok.",
          "created_at": "2026-01-13T09:51:09Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 1008,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3751188353,
          "user": "davidgumberg",
          "body": ">Configuring pmp, running the addrman loop and making a connection to the tor control port in readiness for future connections doesn't seem completely untoward, in my opinion.\n\nI agree, but I don't think there is much advantage in doing those things when disconnected from the P2P network, no one will be surprised that Bitcoin Core *isn't* doing those things when `networkactive` is set to false. https://github.com/bitcoin/bitcoin/compare/master...willcl-ark:bitcoin:refs/heads/respect-networkactive seems simple enough... ",
          "created_at": "2026-01-14T19:16:59Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 525,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3755019277,
          "user": "brunoerg",
          "body": "> Curious what others think here though, as giving torControlThread and mapport_thread knowledge of the state of networkactive is pretty easy. I didn't have a look at addrman yet though...\n\nI think these many selections from addrman is because we verify if the network is active at `OpenNetworkConnection`, so this addrman interation might come from `ThreadOpenConnections`. ",
          "created_at": "2026-01-15T13:59:05Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 375,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1210,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2422557514,
      "number": 30498,
      "title": "fuzz: Apply HasTooManySubFrag (et al) to miniscript_string (et al)",
      "body": "Should the check be applied to miniscript_string, for example the `miniscript_string/ae395bdc087e233d7f8e1844d4814b2c00cc9d21` input, as well?\r\n\r\n_Originally posted by @maflcko in https://github.com/bitcoin/bitcoin/issues/30197#issuecomment-2233404249_\r\n            \r\n\r\nSeems useful to at least apply to that fuzz target as well. In theory it could be applied to parse_univalue as well (reverting commit a1b8a917b176ee36961203ccee96457d85102e60).",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2024-07-22T10:47:51Z",
      "updated_at": "2026-01-15T13:55:32Z",
      "closed_at": "2026-01-15T13:55:32Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/30498",
      "labels": [
        "Tests",
        "Fuzzing"
      ],
      "comment_data": [
        {
          "id": 3750548386,
          "user": "maflcko",
          "body": "Looks like the `ae395bdc087e233d7f8e1844d4814b2c00cc9d21` input was nuked from git history in the meantime. The current reproducer is:\n\n```\ncurl -fLO 'https://raw.githubusercontent.com/bitcoin-core/qa-assets/eac1c57614d7823bcd6079814749f72018aea438/fuzz_corpora/miniscript_string/41bae50cffd1741150a1b330d02ab09f46ff8cd1'\nFUZZ=miniscript_string perf record -g --call-graph fp  ./bld-cmake/bin/fuzz ./41bae50cffd1741150a1b330d02ab09f46ff8cd1\nhotspot ./perf.data",
          "created_at": "2026-01-14T16:55:59Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 460,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3750886278,
          "user": "maflcko",
          "body": "Fix in https://github.com/bitcoin/bitcoin/pull/34288",
          "created_at": "2026-01-14T17:57:50Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 52,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 513,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2125507739,
      "number": 29410,
      "title": "p2p: lingering entries in `mapBlockSource`",
      "body": "Opening an issue per https://github.com/bitcoin/bitcoin/pull/28235#issuecomment-1927184068\r\n\r\nIf we receive a valid block that passes the anti-DoS threshold but doesn't advance the tip, the `BlockChecked` callback won't be called. This is because `ActivateBestChain` will return early since `pindexMostWork` is equal to `m_chain.Tip()`. Since the `BlockChecked` callback isn't called, `mapBlockSource` won't be removed from.",
      "state": "open",
      "user": "Crypt-iQ",
      "created_at": "2024-02-08T15:51:21Z",
      "updated_at": "2026-01-15T11:51:38Z",
      "closed_at": null,
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/29410",
      "labels": [
        "Validation",
        "Net"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 467,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3748120761,
      "number": 34118,
      "title": "[feature] Scheduled Transaction Broadcast",
      "body": "### Please describe the feature you'd like to see added.\n\n## Overview\n\nIn certain cases the user creating a transaction would like to broadcast it to the bitcoin network delayed, not immediately. It's practical to implement scheduling in the node, as it is a software component designed to be always-on.\n\nWith Scheduled Transaction Broadcast the bitcoin node accepts a transaction for later broadcast, stores it, and broadcasts automatically at the specified target time.\n\n### Is your feature related to a problem, if so please describe it.\n\n_No response_\n\n### Describe the solution you'd like\n\n## Details / Caveats\n\nUses. Delayed transaction broadcast can be useful for/when (among others):\n\n- hiding the real time of transaction creation (with random delay; for non-urgent transactions; typically in the range of few hours -- few days)\n- broadcasting a transaction at a future date\n\nResult, error check. As the actual broadcast happens later, the broadcast result -- success or some error -- is not available at acceptance time. Only parsing checks are done at acceptance time. The client can check the result only by monitoring the bitcoin network. Note: some checks are not possible to be done at acceptance time, as conditions may change (e.g. inputs with timelocks). (Note: it could be possible to offer an API to query for broadcast result, but that's not planned.)\n\nAbsolute time vs. block time. The target time can be specified as an absolute time or a block height.\n\nNo guarantees. Delayed broadcast is best-effort, there is no delivery guarantee.\n\nFee. The transaction fee is contained in the scheduled transaction, and it is not possible to be changed. In case the network fee rate goes up by the time of submission, the fee may be insufficient. CFCP can be used to bump the fee if needed.\n\nRetries. It is possible to specify a number of retries, and a retry period. Then the scehduled broadcast is retried accordingly in case of failure.\n\n\n### Describe any alternatives you've considered\n\nThe following alternatives are identified, though they are outside of the scope of the node software:\n \n- Scheduling implemented in the wallet software. The drawback is that wallets are typically active (running) only for a short period, while there is user interaction. Running in the background may impose some design issues.\n- Implemented in a separate component sitting along the bitcoin node, proxying all RPC API calls, and implementing scheduled (delayed) transaction broadcast.\n\n## Miscellaneous\n\nNote (added Jan 15): earlier feature request #30471 also includes delayed broadcast.\n\nThis could interfere with the feature \"Broadcast own transactions only via short-lived Tor or I2P connections\" (PR ##29415).\nThis feature could be combined with this feature, to further mask the real transaction creation time, by creating the dedicated sending connection sometimes between the scheduling time and target time (randomized). \n\nAn APIs for cancelling an unsent scheduled TX would be possible to offer as well.\n\n\n### Please leave any additional context\n\n## Implementation Details\n\nScheduled transactions are kept in a separate memory structure, and are persisted to a separate file (for persistence accross restarts). The file is read at startup, and written whenever there is a relevant change to its content, and at shutdown.\n\nA new RPC 'schedulerawtransaction' is proposed, with syntax very similar to 'sendrawtransaction'. However, the transaction is not sent rigth away, but stored for later broadcast.\n\n\n## Status\n\nDelving discussion:\nhttps://delvingbitcoin.org/t/scheduled-delayed-transaction-broadcast/2148\n\nPrototype:\nhttps://github.com/optout21/sched-tx-ptoto/\nhttps://github.com/optout21/bitcoin/tree/sched-tx-proto1\nhttps://github.com/optout21/bitcoin/tree/sched-tx-proto0\n\n## History\n\nJan 14: Added ref to #30471, @craigraw .\nJan 5, 2026: Edits w.r.t. to the alternative of implementing in the client; removing speculative fuzzy use case; in response to comments by @ismaelsadeeq .\nDec 19, 2025: Created. ",
      "state": "open",
      "user": "optout21",
      "created_at": "2025-12-19T16:44:42Z",
      "updated_at": "2026-01-15T11:05:51Z",
      "closed_at": null,
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/34118",
      "labels": [
        "Feature"
      ],
      "comment_data": [
        {
          "id": 3753250222,
          "user": "craigraw",
          "body": "This functionality has already been proposed in #30471 (although I am happy to see further support for this feature).",
          "created_at": "2026-01-15T07:33:34Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 117,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3754181590,
          "user": "optout21",
          "body": "Thanks for the info, I was not aware of it! My proposal here deals only with delayed broadcast, and it is a subset of #30471.\nThere are several different things considered:\n\n- Mitigation for the case when a submitted transaction gets lost (when it is dropped from the node mempool and does not live on in any other mempool). Done by keeping pending local transactions and periodically resubmitting.\n- Mitigation for disappearing/reappearing pending transaction (when a tx is dropped from the node mempool but later it gets confirmed; this is mostly a UX issue). Done by providing info about txs stored in the local pool (and also periodical resubmit)\n- Delayed tx broadcast, for extra privacy\n- Using more private means (connection) when broadcasting, for extra privacy -- #29415 \n\nAll of these are related, but have different goal and technical issues.\n\nExcept for the last, which has to be handled inside the node, the rest could be handled:\n\n- in the wallet software -- here the main issue is that wallets are not designed/used in an 'always-on' mode\n- inside indexer (electrum) implementation (I have no idea how much of these different electrum implementations do)\n- as an add-on next to the bitcoin core node (think RPC proxy style with enhancement)\n- inside the node\n",
          "created_at": "2026-01-15T11:00:40Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 1274,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 4066,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1937231095,
      "number": 28635,
      "title": "Test calling addnode more than once (and MAX_ADDNODE_CONNECTIONS)",
      "body": "While reviewing #28331 we noticed a crash that wasn't caught by the test suite, but would very quickly happen on a real node. See https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342450439\r\n\r\nI was able to reproduce it by calling `addnode` twice and having the test suite wait a little bit. But this also involved hacking `ThreadOpenAddedConnections` to wait 1 second instead of a full minute. See https://github.com/Sjors/bitcoin/commit/bc3995c66300fb3139c5360e8f6ee807b02ea86e\r\n\r\nIf the test suite could mock the delay in `ThreadOpenAddedConnections` we can add a regular test for this.\r\n\r\nIt would also be a good idea to test `MAX_ADDNODE_CONNECTIONS`, which should be a simple matter of spinning up ~10 test nodes.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2023-10-11T08:56:02Z",
      "updated_at": "2026-01-15T10:44:41Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/28635",
      "labels": [
        "Bug",
        "RPC/REST/ZMQ"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 794,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2134858540,
      "number": 29435,
      "title": "wallet: Unrelated conflicted parent txs do not cause child txs to be marked as conflicted",
      "body": "### Is there an existing issue for this?\n\n- [X] I have searched the existing issues\n\n### Current behaviour\n\nIf we receive a transaction which spends from an unconfirmed parent, and that parent is replaced, the child does not get marked as conflicted but rather only as inactive. If the child contains an input from our wallet, that input cannot be reused until the child is abandoned.\r\n\r\nSee also https://github.com/ACINQ/eclair/pull/2818\n\n### Expected behaviour\n\nWe should try to detect if a such a child transaction becomes conflicted due to a parent becoming conflicted and mark it as such.\n\n### Steps to reproduce\n\nA (failing) test for this behavior can be found at https://github.com/achow101/bitcoin/commit/213fa91d5c289204e3f1e01194b1fccd08a69c6c\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nmaster@128b4a80387d322a7810d8716eccdac95ff9b8cd\n\n### Operating system and version\n\nArch\n\n### Machine specifications\n\n_No response_",
      "state": "open",
      "user": "achow101",
      "created_at": "2024-02-14T17:45:47Z",
      "updated_at": "2026-01-15T10:29:42Z",
      "closed_at": null,
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/issues/29435",
      "labels": [
        "Wallet"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1123,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2353360477,
      "number": 30288,
      "title": "RFC: Assumeutxo and large forks and reorgs",
      "body": "(tl;dr This is mainly a question about when an assumeutxo snapshot is loaded, if it makes more sense for the original chainstate to continue downloading and attaching blocks in the normal way, or if it should only download and attach blocks leading up to the snapshot block.)\r\n\r\n---\r\n\r\nIt seems unclear how validation code should behave when an assumeutxo snapshot is loaded, and then new headers are received pointing to a forked chain with more proof of work than any known chain including the snapshot block. This question come up in https://github.com/bitcoin/bitcoin/pull/29519#discussion_r1628436308.\r\n\r\nThis is not an urgent question, because if this situation arose on the network there would be bigger issues to confront than assumeutxo behavior, but it's worth raising because there seem to be different ways of dealing with it that impact that design of validation code, and maybe also have implications in other cases like eclipse attacks.\r\n\r\n### Background\r\n\r\nWhen an assumeutxo snapshot is loaded, a new chainstate object is created. A chainstate is just a UTXO database and a pointer to the last block added to the database.\r\n\r\nSo immediately after the assumeutxo snapshot is loaded there are two chainstates:\r\n\r\n- The original chainstate pointing at the most-work block which has been locally validated. (This block should normally be an ancestor of the snapshot block, but doesn't have to be.)\r\n\r\n- A new snapshot chainstate pointing at the snapshot block, which has been not been locally validated and probably not downloaded, but is assumed-valid.\r\n\r\nAfter this point, because of missing block and undo data before the snapshot, the snapshot chainstate is constrained to only sync to chains including the snapshot block. If headers for chains with more work not including the snapshot block are found, the snapshot chainstate needs to ignore them, because even if it downloaded blocks on those chains, it would lack the undo data needed to reorg and actually validate them.\r\n\r\nIt is less clear whether the original chainstate should also ignore chains not including the snapshot block.\r\n\r\n### Possible behavior: Original chainstate targets the most-work chain\r\n\r\nThis is not what currently happens, but simplest approach might be for the original chainstate to be unaffected by the snapshot chainstate, and to continue to download and attach the same blocks it otherwise would have if no snapshot were loaded. It would just do it more slowly due to a reduced cache size and lower priority for block requests compared to the snapshot chainstate.\r\n\r\n### Current behavior: Original chainstate targets the snapshot block\r\n\r\nCurrently, instead of the original chainstate being unaffected by the snapshot chainstate, it's constrained to only download and blocks that are ancestors of the snapshot block, and ignore other chains.\r\n\r\n### Tradeoffs\r\n\r\nPossible advantages of original chainstate targeting the most work chain:\r\n\r\n- Probably simpler implemenation. If original chainstate behaves the same way whether or not a snapshot is loaded, fewer special cases need to exist when a snapshot is loaded.\r\n- Would sync to most-work chain faster if most-work chain did not include the snapshot block and turned out to be valid (i.e. not a hard fork)\r\n- Maybe more philosophically neutral, because the node continues normal behavior of syncing to the most-work chain, instead of ignoring any chain not including the snapshot block.\r\n\r\nPossible advantages of original chainstate targeting the snapshot block:\r\n\r\n- This what code currently does so would not require further changes.\r\n- Maybe could provide resilience against hard forks that contain more work? If loading a snapshot makes a node temporarily ignore any chain not containing a snapshot block, maybe that is a useful feature if the chain with more work turns out to be invalid.\r\n- Could help in an eclipse attack? If headers or blocks after the snapshot block were withheld, this could temporarily stop the node from syncing to a undesirable fork excluding the snapshot block that seemed to have more work.\r\n- [Maybe other reasons? Personally I'm more inclined towards the first approach, and have a weak understanding of things like forks and eclipse attacks, so I'm struggling to think of advantages to this approach.]\r\n  \r\n### Questions\r\n\r\nAs long as the most-work header chain includes the snapshot block, there should be no real differences in behavior between the two approaches described above. But if the most-work header chain doesn't include the snapshot block, it raises questions about which approach might be preferable. It also raises questions about what other behaviors we should consider implementing if this state is detected, like warning the user, shutting down, changing sync behavior, maybe adjusting relative priorities of the two chainstates. The main question is if we should be doing anything different than we are doing now.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-06-14T13:14:57Z",
      "updated_at": "2026-01-15T09:28:49Z",
      "closed_at": null,
      "comments": 10,
      "url": "https://github.com/bitcoin/bitcoin/issues/30288",
      "labels": [
        "Brainstorming",
        "Validation"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 1,
        "text_length": 4963,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2398671777,
      "number": 30416,
      "title": "Send RPC calls performance",
      "body": "### Is there an existing issue for this?\n\n- [X] I have searched the existing issues\n\n### Current behaviour\n\nI want to report performance changes of `sendmany` and `sendtoaddress` RPC calls.\r\n\r\nWe use fresh-new wallet for more than an year. There are 24 descriptors in the wallet from which 12 were imported from about a month older wallet. We generated circa 300 k addresses from these imported descriptors and hundreds of addresses from the new ones. We had send about 1500 transactions from this wallet which probably generated hundreds of change addresses.\r\n\r\nDuring the operation of that wallet, the time of RPC `send*` calls degraded a lot. From several seconds at start to almost 3 minutes.\r\n\r\n![Screenshot from 2024-07-09 17-19-55](https://github.com/bitcoin/bitcoin/assets/11145995/d7bc7ff1-cc2e-45c4-a43a-cdaf9b1d81dc)\r\n\r\nGraph of RPC call duration during last monts. yellow `sendmany` and blue `sendtoaddress`.\r\n\r\nThe significant drop to cca 25 seconds appears just after update to version 27.0.\r\n\r\nBTW, during that time of performance degradation, I monitored number of UTXOs as well and the performance didn't correlate. We have 1-10 k of UTXOs in the wallet and even if I consolidate these to only tens of UTXOs, the performance didn't improve, as you may notice on the graph.\r\n\r\n![Screenshot from 2024-07-09 17-29-10](https://github.com/bitcoin/bitcoin/assets/11145995/75148214-7bd6-4dc7-a9df-32dd07e78ee9)\r\n \r\nThe same graph for last few weeks after update to version 27.0\r\n\r\n**So, big kudos and many thanks to this perfomance improvement!** :clap:  I notice the new coin-selection algorithm in the changelog, but â€“ according to documentation â€“ this new algorithm should apply only with high fees, which does not apply during last weeks. So I am not sure what could have caused this improvement change and so I am posting this report.\r\n\r\nWe notice only minor degradation during last days â€“ from 24 seconds to 26 seconds. I will monitor the performance further and report if it get worse or not.\r\n\n\n### Expected behaviour\n\nBitcoin core performance of `send*` RPC calls will not degrade over time.\n\n### Steps to reproduce\n\nI am not sure how to reproduce. For short: generate hundreds of thousands of addresses, receive ten thousands of UTXOs, send thousand of UTXOs. \n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nPre-built binaries\n\n### What version of Bitcoin Core are you using?\n\n27.1\n\n### Operating system and version\n\nDebian 11\n\n### Machine specifications\n\nAmazon AWS EC2 instances. Mainly `t3a` and `c6a` instance types (AMD EPYC 7571). Instance type change didn't have significant impact on performance.",
      "state": "closed",
      "user": "VojtechMyslivec",
      "created_at": "2024-07-09T16:36:03Z",
      "updated_at": "2026-01-15T09:25:58Z",
      "closed_at": "2026-01-15T09:25:58Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/30416",
      "labels": [
        "Wallet",
        "RPC/REST/ZMQ"
      ],
      "comment_data": [
        {
          "id": 3753738613,
          "user": "willcl-ark",
          "body": "Going to close this now, as I don't think there's anything actionable in here.\n\nThanks for the report.",
          "created_at": "2026-01-15T09:25:57Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 102,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2682,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2426887625,
      "number": 30518,
      "title": "Unexpected behaviour when using `sortedmulti_a` descriptor",
      "body": "### Is there an existing issue for this?\n\n- [X] I have searched the existing issues\n\n### Current behaviour\n\nCurrently running:\r\n```\r\ngetdescriptorinfo \"tr(50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0,and_v(v:pk(b6df9cc452123b137ae8ad15927ff78b7e4e010a97b8ef6732d6d9d692abd993),multi_a(1,0153089cb23a34755aeba2737cb2134add1708e09dca8ae128ccdb1f035f3197,572706d9cf6b553f179daaf22f456b8e31200f59f51d9dcef936cde61918220e)))\"\r\n```\r\nwill respond with success for such descriptor:\r\n```\r\n{\r\n  \"descriptor\": \"tr(50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0,and_v(v:pk(b6df9cc452123b137ae8ad15927ff78b7e4e010a97b8ef6732d6d9d692abd993),multi_a(1,0153089cb23a34755aeba2737cb2134add1708e09dca8ae128ccdb1f035f3197,572706d9cf6b553f179daaf22f456b8e31200f59f51d9dcef936cde61918220e)))#dy2rfhga\",\r\n  \"checksum\": \"dy2rfhga\",\r\n  \"isrange\": false,\r\n  \"issolvable\": true,\r\n  \"hasprivatekeys\": false\r\n}\r\n```\r\nThough running the same command with the same data but with `sortedmulti_a` instead of `multi_a` will generate error:\r\n```\r\ngetdescriptorinfo \"tr(50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0,and_v(v:pk(b6df9cc452123b137ae8ad15927ff78b7e4e010a97b8ef6732d6d9d692abd993),sortedmulti_a(1,0153089cb23a34755aeba2737cb2134add1708e09dca8ae128ccdb1f035f3197,572706d9cf6b553f179daaf22f456b8e31200f59f51d9dcef936cde61918220e)))\"\r\n```\r\nand error:\r\n```\r\n'and_v(v:pk(b6df9cc452123b137ae8ad15927ff78b7e4e010a97b8ef6732d6d9d692abd993),sortedmulti_a(1,0153089cb23a34755aeba2737cb2134add1708e09dca8ae128ccdb1f035f3197,572706d9cf6b553f179daaf22f456b8e31200f59f51d9dcef936cde61918220e))' is not a valid descriptor function\r\n```\r\n\r\n\r\n\n\n### Expected behaviour\n\nI would expect that the call \r\n```\r\ngetdescriptorinfo \"tr(50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0,and_v(v:pk(b6df9cc452123b137ae8ad15927ff78b7e4e010a97b8ef6732d6d9d692abd993),sortedmulti_a(1,0153089cb23a34755aeba2737cb2134add1708e09dca8ae128ccdb1f035f3197,572706d9cf6b553f179daaf22f456b8e31200f59f51d9dcef936cde61918220e)))\"\r\n```\r\nwill also succeed\n\n### Steps to reproduce\n\ncall command\r\n```\r\ngetdescriptorinfo \"tr(50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0,and_v(v:pk(b6df9cc452123b137ae8ad15927ff78b7e4e010a97b8ef6732d6d9d692abd993),sortedmulti_a(1,0153089cb23a34755aeba2737cb2134add1708e09dca8ae128ccdb1f035f3197,572706d9cf6b553f179daaf22f456b8e31200f59f51d9dcef936cde61918220e)))\"\r\n```\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nOther\n\n### What version of Bitcoin Core are you using?\n\nv27.0\n\n### Operating system and version\n\nMacOs Sonoma 14.5\n\n### Machine specifications\n\n_No response_",
      "state": "open",
      "user": "KonradStaniec",
      "created_at": "2024-07-24T08:12:56Z",
      "updated_at": "2026-01-15T09:25:00Z",
      "closed_at": null,
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/issues/30518",
      "labels": [
        "Wallet",
        "Descriptors"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2716,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2960274990,
      "number": 32173,
      "title": "validation: `CheckBlockIndex` crashes during block reconsideration",
      "body": "Functional test to reproduce:\n\n```python\nfrom test_framework.test_framework import BitcoinTestFramework\n\nclass CheckBlockIndexBug(BitcoinTestFramework):\n    def set_test_params(self):\n        self.setup_clean_chain = True\n        self.num_nodes = 1\n\n    def run_test(self):\n        self.generatetoaddress(self.nodes[0], 1, \"2N9hLwkSqr1cPQAPxbrGVUjxyjD11G2e1he\");\n        hashes = self.generatetoaddress(self.nodes[0], 1, \"2N9hLwkSqr1cPQAPxbrGVUjxyjD11G2e1he\");\n        self.generatetoaddress(self.nodes[0], 1, \"2N2CmnxjBbPTHrawgG2FkTuBLcJtEzA86sF\");\n\n        res = self.nodes[0].gettxoutsetinfo()\n        self.generatetoaddress(self.nodes[0], 3, \"2N9hLwkSqr1cPQAPxbrGVUjxyjD11G2e1he\");\n        self.log.info(self.nodes[0].invalidateblock(res[\"bestblock\"]))\n        self.generatetoaddress(self.nodes[0], 3, \"2N9hLwkSqr1cPQAPxbrGVUjxyjD11G2e1he\");\n        self.nodes[0].reconsiderblock(hashes[0])\n        self.nodes[0].invalidateblock(hashes[0])\n        self.log.info(self.nodes[0].reconsiderblock(res[\"bestblock\"]))\n\nif __name__ == '__main__':\n    CheckBlockIndexBug(__file__).main()\n```\n\nStack trace:\n```\nbitcoind: validation.cpp:5392: void ChainstateManager::CheckBlockIndex(): Assertion `(pindex->nStatus & BLOCK_FAILED_MASK) == 0' failed.\nAddressSanitizer:DEADLYSIGNAL\n=================================================================\n==3423379==ERROR: AddressSanitizer: ABRT on unknown address 0x000000343c93 (pc 0x7fb83abf0eec bp 0x7fb8348f16c0 sp 0x7fb8348efc30 T6)\n    #0 0x7fb83abf0eec  (/lib/x86_64-linux-gnu/libc.so.6+0x8aeec) (BuildId: 79005c16293efa45b441fed45f4f29b138557e9e)\n    #1 0x7fb83aba1fb1 in raise (/lib/x86_64-linux-gnu/libc.so.6+0x3bfb1) (BuildId: 79005c16293efa45b441fed45f4f29b138557e9e)\n    #2 0x7fb83ab8c471 in abort (/lib/x86_64-linux-gnu/libc.so.6+0x26471) (BuildId: 79005c16293efa45b441fed45f4f29b138557e9e)\n    #3 0x7fb83ab8c394  (/lib/x86_64-linux-gnu/libc.so.6+0x26394) (BuildId: 79005c16293efa45b441fed45f4f29b138557e9e)\n    #4 0x7fb83ab9aec1 in __assert_fail (/lib/x86_64-linux-gnu/libc.so.6+0x34ec1) (BuildId: 79005c16293efa45b441fed45f4f29b138557e9e)\n    #5 0x5578f6306f64 in ChainstateManager::CheckBlockIndex() /bitcoin/build_fuzz/src/./validation.cpp:5392:13\n    #6 0x5578f62fe81a in Chainstate::ActivateBestChain(BlockValidationState&, std::shared_ptr<CBlock const>) /bitcoin/build_fuzz/src/./validation.cpp:3627:16\n    #7 0x5578f5d03436 in ReconsiderBlock(ChainstateManager&, uint256) /bitcoin/build_fuzz/src/./rpc/blockchain.cpp:1669:33\n    #8 0x5578f5e3fbc7 in reconsiderblock()::$_0::operator()(RPCHelpMan const&, JSONRPCRequest const&) const /bitcoin/build_fuzz/src/./rpc/blockchain.cpp:1694:5\n    #9 0x5578f5e3fbc7 in UniValue std::__invoke_impl<UniValue, reconsiderblock()::$_0&, RPCHelpMan const&, JSONRPCRequest const&>(std::__invoke_other, reconsiderblock()::$_0&, RPCHelpMan const&, JSONRPCRequest const&) /usr/lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/invoke.h:61:14\n    #10 0x5578f5e3fbc7 in std::enable_if<is_invocable_r_v<UniValue, reconsiderblock()::$_0&, RPCHelpMan const&, JSONRPCRequest const&>, UniValue>::type std::__invoke_r<UniValue, reconsiderblock()::$_0&, RPCHelpMan const&, JSONRPCRequest const&>(reconsiderblock()::$_0&, RPCHelpMan const&, JSONRPCRequest const&) /usr/lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/invoke.h:114:9\n    #11 0x5578f5e3fbc7 in std::_Function_handler<UniValue (RPCHelpMan const&, JSONRPCRequest const&), reconsiderblock()::$_0>::_M_invoke(std::_Any_data const&, RPCHelpMan const&, JSONRPCRequest const&) /usr/lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/std_function.h:290:9\n    #12 0x5578f717fe3a in std::function<UniValue (RPCHelpMan const&, JSONRPCRequest const&)>::operator()(RPCHelpMan const&, JSONRPCRequest const&) const /usr/lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/std_function.h:591:9\n    #13 0x5578f717fe3a in RPCHelpMan::HandleRequest(JSONRPCRequest const&) const /bitcoin/build_fuzz/src/./rpc/util.cpp:684:20\n    #14 0x5578f5dc8455 in CRPCCommand::CRPCCommand(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>>, RPCHelpMan (*)())::'lambda'(JSONRPCRequest const&, UniValue&, bool)::operator()(JSONRPCRequest const&, UniValue&, bool) const /bitcoin/build_fuzz/src/./rpc/server.h:101:91\n    #15 0x5578f5dc8455 in bool std::__invoke_impl<bool, CRPCCommand::CRPCCommand(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>>, RPCHelpMan (*)())::'lambda'(JSONRPCRequest const&, UniValue&, bool)&, JSONRPCRequest const&, UniValue&, bool>(std::__invoke_other, CRPCCommand::CRPCCommand(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>>, RPCHelpMan (*)())::'lambda'(JSONR\nPCRequest const&, UniValue&, bool)&, JSONRPCRequest const&, UniValue&, bool&&) /usr/lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/invoke.h:61:14\n    #16 0x5578f5dc8455 in std::enable_if<is_invocable_r_v<bool, CRPCCommand::CRPCCommand(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>>, RPCHelpMan (*)())::'lambda'(JSONRPCRequest const&, UniValue&, bool)&, JSONRPCRequest const&, UniValue&, bool>, bool>::type std::__invoke_r<bool, CRPCCommand::CRPCCommand(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>>, RPCHelpMan\n(*)())::'lambda'(JSONRPCRequest const&, UniValue&, bool)&, JSONRPCRequest const&, UniValue&, bool>(CRPCCommand::CRPCCommand(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>>, RPCHelpMan (*)())::'lambda'(JSONRPCRequest const&, UniValue&, bool)&, JSONRPCRequest const&, UniValue&, bool&&) /usr/lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/invoke.h:114:9\n    #17 0x5578f5dc8455 in std::_Function_handler<bool (JSONRPCRequest const&, UniValue&, bool), CRPCCommand::CRPCCommand(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>>, RPCHelpMan (*)())::'lambda'(JSONRPCRequest const&, UniValue&, bool)>::_M_invoke(std::_Any_data const&, JSONRPCRequest const&, UniValue&, bool&&) /usr/lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/std_function.h:290:\n9\n    #18 0x5578f6177d47 in std::function<bool (JSONRPCRequest const&, UniValue&, bool)>::operator()(JSONRPCRequest const&, UniValue&, bool) const /usr/lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/std_function.h:591:9\n    #19 0x5578f6177d47 in ExecuteCommand(CRPCCommand const&, JSONRPCRequest const&, UniValue&, bool) /bitcoin/build_fuzz/src/./rpc/server.cpp:512:20\n    #20 0x5578f6177d47 in ExecuteCommands(std::vector<CRPCCommand const*, std::allocator<CRPCCommand const*>> const&, JSONRPCRequest const&, UniValue&) /bitcoin/build_fuzz/src/./rpc/server.cpp:477:13\n    #21 0x5578f6176b16 in CRPCTable::execute(JSONRPCRequest const&) const /bitcoin/build_fuzz/src/./rpc/server.cpp:497:13\n    #22 0x5578f61759e6 in JSONRPCExec(JSONRPCRequest const&, bool) /bitcoin/build_fuzz/src/./rpc/server.cpp:353:31\n    #23 0x5578f6512301 in HTTPReq_JSONRPC(std::any const&, HTTPRequest*) /bitcoin/build_fuzz/src/./httprpc.cpp:217:21\n    #24 0x5578f653449f in std::function<bool (HTTPRequest*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>> const&)>::operator()(HTTPRequest*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>> const&) const /usr/lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/std_function.h:591:9\n    #25 0x5578f653449f in HTTPWorkItem::operator()() /bitcoin/build_fuzz/src/./httpserver.cpp:60:9\n    #26 0x5578f653c305 in WorkQueue<HTTPClosure>::Run() /bitcoin/build_fuzz/src/./httpserver.cpp:115:13\n    #27 0x5578f6526470 in HTTPWorkQueueRun(WorkQueue<HTTPClosure>*, int) /bitcoin/build_fuzz/src/./httpserver.cpp:417:12\n    #28 0x7fb83af2c4a2  (/lib/x86_64-linux-gnu/libstdc++.so.6+0xd44a2) (BuildId: 0c47cec75226c7736517d5acb61e373d541a5023)\n    #29 0x5578f56a1b06 in asan_thread_start(void*) asan_interceptors.cpp.o\n    #30 0x7fb83abef1f4  (/lib/x86_64-linux-gnu/libc.so.6+0x891f4) (BuildId: 79005c16293efa45b441fed45f4f29b138557e9e)\n    #31 0x7fb83ac6f89b  (/lib/x86_64-linux-gnu/libc.so.6+0x10989b) (BuildId: 79005c16293efa45b441fed45f4f29b138557e9e)\n```",
      "state": "open",
      "user": "dergoegge",
      "created_at": "2025-03-31T11:50:20Z",
      "updated_at": "2026-01-15T09:24:32Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/32173",
      "labels": [
        "Bug",
        "Validation"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 8254,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2966945793,
      "number": 32201,
      "title": "BIP32: Maximal length of derivation paths and depth of extended keys",
      "body": "Hi folks,\nI have started to notice and report an overflow of the depth of extended keys (as described in BIP32) and some confusion regarding the depth came up. On one hand, the depth is, I'd say indirectly, limited to the range [0 , 255] due to the serialization into a [single byte](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki#serialization-format). On the other hand, I don't see an inherent technical reason(s) that would prevent deriving even _lower_ keys (with depth 255+).\n\nThe list of libraries, where I see the depth overflowing is increasing:  https://github.com/libbitcoin/libbitcoin-system/pull/1624, https://github.com/bitcoinj/bitcoinj/pull/3693, https://github.com/tyler-smith/go-bip32/issues/27, https://github.com/MetacoSA/NBitcoin/issues/1260, https://github.com/piotrnar/gocoin/issues/71,...\n\nIn bitcoin repository, the overflow is caught [here](https://github.com/bitcoin/bitcoin/blob/639279e86a6edd6cb68e8cf077d14337bcd13959/src/key.cpp#L360) (and also [here](https://github.com/bitcoin/bitcoin/blob/639279e86a6edd6cb68e8cf077d14337bcd13959/src/pubkey.cpp#L407)) and there is also a [test case](https://github.com/bitcoin/bitcoin/blob/449e2eb7e40f7e14300af92bce8e70a9fde91e1b/src/test/bip32_tests.cpp#L187-L203) for it. But the [derivation paths](https://github.com/bitcoin/bitcoin/blob/449e2eb7e40f7e14300af92bce8e70a9fde91e1b/src/util/bip32.cpp#L18) themselves aren't restricted in the size. Due to the variety of implementations and libraries APIs' for the derivation paths and key derivation (priv -> priv, priv -> pub, pub -> pub), there are also a few different ways how to possibly hit the overflow.\n\nKeys that overflow could be _hiding_ coins (as they would appear to live at different levels), but the valid parents are likely still identifiable via the fingerprints. (Possibly, in some edge-cases, overflown keys could be invalid in such a way that the coins would get locked.) I am not familiar with how the depth is used later on, e.g., after key deserialization, and if it could cause other issues.\n\nAre there any legitimate reasons to allow longer paths and keys with depth > 255? Or shall any such overflow be considered a bug? Not sure, if I can tag Pieter Wuille, to get his thoughts regarding the depth validity and if there is more to it.",
      "state": "open",
      "user": "quapka",
      "created_at": "2025-04-02T16:20:19Z",
      "updated_at": "2026-01-15T09:23:49Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/32201",
      "labels": [
        "Bug",
        "Questions and Help"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2365,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3028380194,
      "number": 32377,
      "title": "Verify AssumeUTXO snapshot hashes during full validation as well",
      "body": "### Summary\n\nWe already hardâ€‘code the AssumeUTXO height/UTXO-snapshot-hash/tx-count pairs (e.g. for mainnet we have heights **840,000** and **880,000**) in https://github.com/bitcoin/bitcoin/blob/master/src/kernel/chainparams.cpp#L170-L183.\nCurrently, this commitment is enforced only when a node explicitly activates a snapshot via `loadtxoutset`.\n\nDuring a regular initial block download, `-reindex`, or `-reindex-chainstate`, the node never crossâ€‘checks the live chainstate against these values.\n\n### Proposal\n\nSince the expected UTXO set hash is known at the snapshot heights, we could verify it during full validation to cover both IBD and stored AssumeUTXO data.\nThis selfâ€‘consistency check would synchronize the outcomes of both seeding approaches.\nWhile iterating transactions we'd compute the current hash, and when reaching a snapshot height, we'd assert that the UTXO set hash and transaction count match the hardcoded values.\n\nThis crossâ€‘reference would increase confidence in both mechanisms.\n\nOptionally, we could gate this behavior behind the `assumevalid` flag.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-04-29T13:34:28Z",
      "updated_at": "2026-01-15T09:21:56Z",
      "closed_at": null,
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/32377",
      "labels": [
        "Feature",
        "Brainstorming",
        "Validation"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1142,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3035389227,
      "number": 32401,
      "title": "rfc: separate relay from mining policy",
      "body": "Greg Maxwell brought up an idea on the mailinglist that I think is worth preserving here, although I don't think it's currently needed:\n\n> That said, Bitcoin core has generally not \nhad knobs to adjust relay policy as distinct from mining policy in large \npart because of the design assumption that the two need to be the same.  \nBut in this case if there were a knob here I think would make more sense \nfor it to control **mining policy rather than relay policy**, since it would \nactually have some effect in the mining context (in excluding the txn from \nyour own blocks) while as a relay only thing it is impotent.\n\n(emphasis mine)\n\nRelay policy should generally \"admit all transactions which are reliably being mined\", in order to not to break compact block relay. But having a more restrictive _mining_ policy doesn't hurt this relay.\n\nThe email uses the example scenario of a setting that we as project believe is useless - and when used as relay policy becomes harmful.\n\nI agree with him that's still not a good idea. Additionally this use case alone is not worth the implementation complexity (extra test coverage, thinking through attack scenario's, explaining the nuances in documentation, etc).\n\nBut here's another scenario, where I do think we should consider it:\n\n> But if it were the case that transactions misusing a \nparticular forward compatibility feature were reliably getting mined then \nthat feature would just no longer be useful for forward compatibility \nregardless of what relay policy says about it and it would be better to \nrelay them than have the downsides of not doing so.\n\nBy having the (default) miner still not include things that break forward compatibility, there remains hope of returning to a status quo where the forward compatibility hook is restored.\n\nThough not much if they're incentivised to just change the default once and forget about it. So maybe this isn't a good example.\n\nA third scenario, in retrospect, we could have used it with `-mempoolfullrbf`. We could have had an extra step (3) there:\n\n1. Add the setting, off by default\n2. Notice that it was getting mined by >10% of hash rate\n3. Relay it regardless of the setting, but still not mine it\n4. Drop the setting (maybe have it on by default first, to match the majority mining usage)\n\nAgain I'm not sure how big of a difference that would have made.\n\n[0] https://gnusha.org/pi/bitcoindev/9c50244f-0ca0-40a5-8b76-01ba0d67ec1bn@googlegroups.com/",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-05-02T07:37:53Z",
      "updated_at": "2026-01-15T09:20:43Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/32401",
      "labels": [
        "Brainstorming",
        "TX fees and policy"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 2,
        "text_length": 2490,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3159505351,
      "number": 32775,
      "title": "Distinguish between vsize and sigop-adjusted mempool vsize",
      "body": "I was going through the up for grabs PR, and got interested in working on [this](https://github.com/bitcoin/bitcoin/pull/27591) but,  bitcoin locked and limited conversation to collaborators 2 weeks ago, so I couldn't comment directly there. \n\nBased on the previous discussions, here's my understanding of what needs to be done (if the change is still relavant) :\n\nKeep the existing vsize field as the sigop-adjusted size and the new vsize_bip141 field to clearly represent the BIP141 virtual size (non-sigop-adjusted)for mempool-related RPCs.\n\nAdd optional sigopsize (sigopsize = nSigOpCost * bytes_per_sigop, please correct me if am wrong)  getrawtransaction transaction when the transaction is in the mempool and the data is available.\n\nWrite additional documentation under doc/policy/ to explain the different vsize definitions, fee rates, and mining score heuristics.\n\nThanks!!!",
      "state": "open",
      "user": "musaHaruna",
      "created_at": "2025-06-19T08:49:02Z",
      "updated_at": "2026-01-15T09:20:01Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/32775",
      "labels": [
        "RPC/REST/ZMQ",
        "Mempool"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 942,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3272542232,
      "number": 33084,
      "title": "wallet: control which taproot script path to spend",
      "body": "When there's multiple script paths we can spend, the wallet just (partially) signs all of them. We then pick the one with the lowest fees:\n\nhttps://github.com/bitcoin/bitcoin/blob/321984705dbcc5982013c8cfb52389cf3f2e75f6/src/script/sign.cpp#L373-L389\n\nThe user may want to override this, e.g.:\n\n1. For privacy reasons they don't wish to reveal the less secure (but cheaper) fallback condition. \n2. Their co-signer software trips up if it sees something in the `taproot_script_path_sigs` it  can't handle (similar to e.g. https://github.com/LedgerHQ/app-bitcoin-new/pull/340)\n\n#32857 lets the user avoid script path spending altogether. Similarly it would be good if they can manually pick one. ",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-07-29T07:49:30Z",
      "updated_at": "2026-01-15T09:17:19Z",
      "closed_at": null,
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/33084",
      "labels": [
        "Wallet",
        "Descriptors"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 745,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3328247189,
      "number": 33208,
      "title": "Indexes stuck on unknown best block after unclean shutdown",
      "body": "I was contacted by someone who runs a lot of nodes that they see the following issue happen very often: After an unclean shutdown an index reports that it is at an unknown best block and the node can not be restarted unless the index is deactivated or resynced.\n\n```\n2025-08-16T12:34:43Z Verification progress: 99%\n2025-08-16T12:34:43Z Verification: No coin database inconsistencies in last 6 blocks (6 transactions)\n2025-08-16T12:34:43Z Block index and chainstate loaded\n2025-08-16T12:34:43Z Opening LevelDB in /bitcoin/testnet3/indexes/txindex\n2025-08-16T12:34:43Z Opened LevelDB successfully\n2025-08-16T12:34:43Z Using obfuscation key for /bitcoin/testnet3/indexes/txindex: 0000000000000000\n2025-08-16T12:34:43Z Opening LevelDB in /bitcoin/testnet3/indexes/coinstats/db\n2025-08-16T12:34:43Z Opened LevelDB successfully\n2025-08-16T12:34:43Z Using obfuscation key for /bitcoin/testnet3/indexes/coinstats/db: 0000000000000000\n2025-08-16T12:34:43Z [error] txindex: best block of the index not found. Please rebuild the index.\n2025-08-16T12:34:43Z Shutdown: In progress...\n2025-08-16T12:34:43Z scheduler thread exit\n2025-08-16T12:34:43Z Flushed fee estimates to fee_estimates.dat.\n2025-08-16T12:34:44Z Shutdown: done\n```\n\nI didn't find an issue on this problem here but it seems to indeed be happening more widely since I could find similar reports on several forums for node runners:\n\nhttps://community.umbrel.com/t/bitcoin-core-stuck-starting-rebuild-index/18715\nhttps://community.umbrel.com/t/can-anyone-explain-how-to-rebuild-an-index/23288\nhttps://community.start9.com/t/bitcoin-restart-loop-with-error-txindex-best-block-of-the-index-not-found-please-rebuild-the-index/1589\nhttps://community.start9.com/t/knots-is-looping-in-running-erroring-restarting/3522 (This is knots but I don't think knots changes much on the indexes)\nhttps://bitcoin.stackexchange.com/questions/126304/bitcoind-testnet3-node-fails-with-txindex-best-block-of-the-index-not-found\n\nSo far I haven't been able to reproduce the issue though. I tried through applying targeted asserts and sleeps but either I haven't found the right spot or this is some deeper issue. I'm waiting to receive more infos/logs that might be helpful for triaging.\n\nIn the PR that added this code @mzumsande [already anticipated that this could be an issue](https://github.com/bitcoin/bitcoin/pull/25193#issuecomment-1135154066). From taking a look and considering/sketching out some ideas I think the simplest way to fix this might be to go back to the old behavior in `Init` and give the `CustomInit` in coinstatsindex the ability to roll back if it is initialized with an older block. It seems like fixing this was the motivation behind #25193 but I haven't read through all the old conversations yet.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2025-08-17T11:29:44Z",
      "updated_at": "2026-01-15T09:15:25Z",
      "closed_at": null,
      "comments": 16,
      "url": "https://github.com/bitcoin/bitcoin/issues/33208",
      "labels": [
        "Bug",
        "UTXO Db and Indexes"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2814,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3348060065,
      "number": 33246,
      "title": "tracing: test `interface_usdt_net.py` fails due to garbage message type in `net:outbound_message` tracepoint",
      "body": "The functional test `interface_usdt_net.py` currently fails on master (commit 73220fc0f958f9b65f66cf0cf042af220b312fc6) on my aarch64 machine, running Ubuntu 25.04:\n```\n$ cmake -B build -DWITH_USDT=ON\n$ cmake --build build -j12\n# ./build/test/functional/interface_usdt_net.py\n2025-08-23T10:53:12.137229Z TestFramework (INFO): PRNG seed is: 2587673157417500984\n2025-08-23T10:53:12.137976Z TestFramework (INFO): Initializing test directory /tmp/bitcoin_func_test_iem787yt\n2025-08-23T10:53:12.415409Z TestFramework (INFO): hook into the net:inbound_message and net:outbound_message tracepoints\n2025-08-23T10:53:13.229315Z TestFramework (INFO): connect a P2P test node to our bitcoind node\n2025-08-23T10:53:13.336504Z TestFramework (INFO): check receipt and content of in- and outbound version messages\n2025-08-23T10:53:13.336668Z TestFramework (INFO): check_p2p_message(): inbound P2PMessage(peer=0, addr=127.0.0.1:54608, conn_type=inbound, msg_type=version, msg_size=111)\n2025-08-23T10:53:13.341459Z TestFramework (ERROR): Unexpected exception\nTraceback (most recent call last):\n  File \"/home/thestack/bitcoin/test/functional/test_framework/test_framework.py\", line 195, in main\n    self.run_test()\n    ~~~~~~~~~~~~~^^\n  File \"/home/thestack/bitcoin/./build/test/functional/interface_usdt_net.py\", line 260, in run_test\n    self.p2p_message_tracepoint_test()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/thestack/bitcoin/./build/test/functional/interface_usdt_net.py\", line 334, in p2p_message_tracepoint_test\n    check_p2p_message(event, is_inbound)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^\n  File \"/home/thestack/bitcoin/./build/test/functional/interface_usdt_net.py\", line 300, in check_p2p_message\n    if event.msg_type.decode(\"utf-8\") == \"version\":\n       ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xa8 in position 0: invalid start byte\n.....\n```\n\nThe message type parameter in the `net:outbound_message` tracepoint seems to point to garbage at the time it is evaluated in the probe, as printing out the `event.msg_type` contents over a few test runs shows:\n```\nevent.msg_type == b'\\xa8\\xc2\\xffG\\xff\\xff'\nevent.msg_type == b'\\xa8\\xb2\\xfbt\\xff\\xff'\nevent.msg_type == b'\\xa8\\xb2|i\\xff\\xff'\nevent.msg_type == b'\\xa8\\xc2\\xffo\\xff\\xff'\nevent.msg_type == b'\\xa8\\xc2~S\\xff\\xff'\n.....\n```\n\nIt looks like a potential life-time issue, but it's unclear to me how this could be possible at all  (see also e.g. https://github.com/bitcoin/bitcoin/issues/27380#issuecomment-2286970765), given that probes should be executed synchronously and the relevant msgtype object is clearly still alive after the tracepoint call (`msg` gets `std::move`d later in the function though):\nhttps://github.com/bitcoin/bitcoin/blob/73220fc0f958f9b65f66cf0cf042af220b312fc6/src/net.cpp#L3885\n\nOS / compiler / packages:\n```\n$ head -1 /etc/issue\nUbuntu 25.04 \\n \\l\n$ uname -s -r -v -m\nLinux 6.16.0-21-qcom-x1e #21-Ubuntu SMP PREEMPT_DYNAMIC Sun Aug 10 00:54:48 UTC 2025 aarch64\n$ gcc --version | head -1\ngcc (Ubuntu 14.2.0-19ubuntu2) 14.2.0\n$ apt info systemtap-sdt-dev | grep Version\nVersion: 5.1-4.1\n```",
      "state": "open",
      "user": "theStack",
      "created_at": "2025-08-23T11:25:21Z",
      "updated_at": "2026-01-15T09:14:29Z",
      "closed_at": null,
      "comments": 8,
      "url": "https://github.com/bitcoin/bitcoin/issues/33246",
      "labels": [
        "Tests",
        "Scripts and tools",
        "interfaces"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3231,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3373829732,
      "number": 33276,
      "title": "InitError() doesn't always halt node startup when blockchain state exists",
      "body": "As described in https://github.com/bitcoin/bitcoin/pull/33231#discussion_r2305592114, when `InitError()` is triggered during initialization, the node prints the error but sometimes continues running, if blockchain data already exists in the datadir.\n\n```bash\nrm -rfd demo build && mkdir -p demo && cmake -B build && cmake --build build -j$(nproc)\n# empty state fails with error\nbuild/bin/bitcoind -datadir=demo -stopatheight=100 -i2psam=invalid_addr\n# init state with 10 blocks\nbuild/bin/bitcoind -datadir=demo -stopatheight=1000\n# error is shown but doesn't stop execution\nbuild/bin/bitcoind -datadir=demo -i2psam=invalid_addr\n```\n\nthe last command does usually stop, but it seems that if the validation is happening too late, it doesn't prevent startup:\n```\n2025-09-01T21:46:54Z Bitcoin Core version v29.99.0-7cc9a087069b (release build)\n2025-09-01T21:46:54Z Using the 'arm_shani(1way,2way)' SHA256 implementation\n2025-09-01T21:46:54Z Default data directory /Users/lorinc/Library/Application Support/Bitcoin\n2025-09-01T21:46:54Z Using data directory /Users/lorinc/IdeaProjects/bitcoin/demo\n2025-09-01T21:46:54Z Config file: /Users/lorinc/IdeaProjects/bitcoin/demo/bitcoin.conf (not found, skipping)\n2025-09-01T21:46:54Z Command-line arg: datadir=\"demo\"\n2025-09-01T21:46:54Z Command-line arg: i2psam=\"invalid_addr\"\n2025-09-01T21:46:54Z Using at most 125 automatic connections (1024 file descriptors available)\n2025-09-01T21:46:54Z Warning: relative datadir option 'demo' specified, which will be interpreted relative to the current working directory '/Users/lorinc/IdeaProjects/bitcoin'. This is fragile, because if bitcoin is started in the future from a different location, it will be unable to locate the current data files. There could also be data loss if bitcoin is started while in a temporary directory.\n2025-09-01T21:46:54Z scheduler thread start\n2025-09-01T21:46:54Z Binding RPC on address ::1 port 8332\n2025-09-01T21:46:54Z Binding RPC on address 127.0.0.1 port 8332\n2025-09-01T21:46:54Z Generated RPC authentication cookie /Users/lorinc/IdeaProjects/bitcoin/demo/.cookie\n2025-09-01T21:46:54Z Permissions used for cookie: rw-------\n2025-09-01T21:46:54Z Using random cookie authentication.\n2025-09-01T21:46:54Z Starting HTTP server with 16 worker threads\n2025-09-01T21:46:54Z Using wallet directory /Users/lorinc/IdeaProjects/bitcoin/demo\n2025-09-01T21:46:54Z init message: Verifying wallet(s)â€¦\n2025-09-01T21:46:54Z Using /16 prefix for IP bucketing\n2025-09-01T21:46:54Z init message: Loading P2P addressesâ€¦\n2025-09-01T21:46:54Z Loaded 7172 addresses from peers.dat  9ms\n2025-09-01T21:46:54Z init message: Loading banlistâ€¦\n2025-09-01T21:46:54Z SetNetworkActive: true\n2025-09-01T21:46:54Z Cache configuration:\n2025-09-01T21:46:54Z * Using 2.0 MiB for block index database\n2025-09-01T21:46:54Z * Using 8.0 MiB for chain state database\n2025-09-01T21:46:54Z * Using 440.0 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\n2025-09-01T21:46:54Z Script verification uses 15 additional threads\n2025-09-01T21:46:54Z Using obfuscation key for blocksdir *.dat files (/Users/lorinc/IdeaProjects/bitcoin/demo/blocks): 'b3658ca56bdb3f0c'\n2025-09-01T21:46:54Z Opening LevelDB in /Users/lorinc/IdeaProjects/bitcoin/demo/blocks/index\n2025-09-01T21:46:54Z Opened LevelDB successfully\n2025-09-01T21:46:54Z Using obfuscation key for /Users/lorinc/IdeaProjects/bitcoin/demo/blocks/index: 0000000000000000\n2025-09-01T21:46:54Z Using 16 MiB out of 16 MiB requested for signature cache, able to store 524288 elements\n2025-09-01T21:46:54Z Using 16 MiB out of 16 MiB requested for script execution cache, able to store 524288 elements\n2025-09-01T21:46:54Z init message: Loading block indexâ€¦\n2025-09-01T21:46:54Z Assuming ancestors of block 00000000000000000001b658dd1120e82e66d2790811f89ede9742ada3ed6d77 have valid signatures.\n2025-09-01T21:46:54Z Setting nMinimumChainWork=0000000000000000000000000000000000000000b1f3b93b65b16d035a82be84\n2025-09-01T21:46:56Z Loading block index db: last block file = 0\n2025-09-01T21:46:56Z Loading block index db: last block file info: CBlockFileInfo(blocks=1030, size=236546, heights=0...1041, time=2009-01-03...2009-01-19)\n2025-09-01T21:46:56Z Checking all blk files are present...\n2025-09-01T21:46:57Z Initializing chainstate Chainstate [ibd] @ height -1 (null)\n2025-09-01T21:46:57Z Opening LevelDB in /Users/lorinc/IdeaProjects/bitcoin/demo/chainstate\n2025-09-01T21:46:57Z Opened LevelDB successfully\n2025-09-01T21:46:57Z Using obfuscation key for /Users/lorinc/IdeaProjects/bitcoin/demo/chainstate: 49bb7fb91842528b\n2025-09-01T21:46:57Z Loaded best chain: hashBestChain=00000000c937983704a73af28acdec37b049d214adbda81d7e2a3dd146f6ed09 height=1000 date=2009-01-19T06:34:42Z progress=0.000001\n2025-09-01T21:46:57Z init message: Verifying blocksâ€¦\n2025-09-01T21:46:57Z Verifying last 6 blocks at level 3\n2025-09-01T21:46:57Z Verification progress: 0%\n2025-09-01T21:46:57Z Verification progress: 16%\n2025-09-01T21:46:57Z Verification progress: 33%\n2025-09-01T21:46:57Z Verification progress: 50%\n2025-09-01T21:46:57Z Verification progress: 66%\n2025-09-01T21:46:57Z Verification progress: 83%\n2025-09-01T21:46:57Z Verification progress: 99%\n2025-09-01T21:46:57Z Verification: No coin database inconsistencies in last 6 blocks (6 transactions)\n2025-09-01T21:46:57Z Block index and chainstate loaded\n2025-09-01T21:46:57Z Setting NODE_NETWORK on non-prune mode\n2025-09-01T21:46:57Z block tree size = 912759\n2025-09-01T21:46:57Z nBestHeight = 1000\n2025-09-01T21:46:57Z initload thread start\n2025-09-01T21:46:57Z mapport thread start\n2025-09-01T21:46:57Z torcontrol thread start\n2025-09-01T21:46:57Z Disabling signature validations at block #1001 (00000000a2887344f8db859e372e7e4bc26b23b9de340f725afbf2edb265b4c6).\n2025-09-01T21:46:57Z UpdateTip: new best=00000000a2887344f8db859e372e7e4bc26b23b9de340f725afbf2edb265b4c6 height=1001 version=0x00000001 log2_work=41.968689 tx=1021 date='2009-01-19T06:49:46Z' progress=0.000001 cache=0.3MiB(1txo)\n2025-09-01T21:46:57Z UpdateTip: new best=00000000430a20b3f4f658c153168b6615512dfe1a8362602e44a5e11e83011a height=1002 version=0x00000001 log2_work=41.970128 tx=1022 date='2009-01-19T07:08:26Z' progress=0.000001 cache=0.3MiB(2txo)\n2025-09-01T21:46:57Z UpdateTip: new best=000000002d5d8c3264d9c6e352b76430cda7a1edac661a515dd1445c15168de5 height=1003 version=0x00000001 log2_work=41.971566 tx=1023 date='2009-01-19T07:26:12Z' progress=0.000001 cache=0.3MiB(3txo)\n2025-09-01T21:46:57Z UpdateTip: new best=00000000aded3a9953bb6acd0f51a99ac433369696116a6b72754c672a350a65 height=1004 version=0x00000001 log2_work=41.973002 tx=1024 date='2009-01-19T07:29:12Z' progress=0.000001 cache=0.3MiB(4txo)\n2025-09-01T21:46:57Z UpdateTip: new best=000000006659f6eed8840da4336211802af29eb04453e7e92d0f80a98f3e833c height=1005 version=0x00000001 log2_work=41.974437 tx=1025 date='2009-01-19T07:52:03Z' progress=0.000001 cache=0.3MiB(5txo)\n2025-09-01T21:46:57Z UpdateTip: new best=00000000c88cb61c8093f11df65dbc6633ae783e6f51be9aa8bbc6c624a994e2 height=1006 version=0x00000001 log2_work=41.975870 tx=1026 date='2009-01-19T08:11:43Z' progress=0.000001 cache=0.3MiB(6txo)\n2025-09-01T21:46:57Z UpdateTip: new best=0000000037b9be6143407617d34d7dd70a09aeb68e5da5a092bf5d19d7a06da6 height=1007 version=0x00000001 log2_work=41.977302 tx=1027 date='2009-01-19T08:27:46Z' progress=0.000001 cache=0.3MiB(7txo)\n2025-09-01T21:46:57Z UpdateTip: new best=000000005f7e442c07d918a1f2cd4f594f5e1946c22b06ffd7dfe378f59f70e8 height=1008 version=0x00000001 log2_work=41.978732 tx=1028 date='2009-01-19T08:40:20Z' progress=0.000001 cache=0.3MiB(8txo)\n2025-09-01T21:46:57Z UpdateTip: new best=000000008bb80b928343bc65ea33b2c97b722d7b85f0470d32a7519d2b7e5550 height=1009 version=0x00000001 log2_work=41.980162 tx=1029 date='2009-01-19T08:52:17Z' progress=0.000001 cache=0.3MiB(9txo)\n2025-09-01T21:46:57Z UpdateTip: new best=0000000074679515061a7e8272f315ca6735ee18105e3d4e867cbc87988e2759 height=1010 version=0x00000001 log2_work=41.981589 tx=1030 date='2009-01-19T08:55:07Z' progress=0.000001 cache=0.3MiB(10txo)\n2025-09-01T21:46:57Z UpdateTip: new best=00000000bbafcd3677dc5f3c713f464996e0253a2457828d3e775c83191abefc height=1011 version=0x00000001 log2_work=41.983016 tx=1031 date='2009-01-19T09:09:28Z' progress=0.000001 cache=0.3MiB(11txo)\n2025-09-01T21:46:57Z UpdateTip: new best=000000002048a8c44e5fcc9b0f19b2ed1fe2c63842ef88c9a29f54607087dc32 height=1012 version=0x00000001 log2_work=41.984440 tx=1032 date='2009-01-19T09:31:02Z' progress=0.000001 cache=0.3MiB(12txo)\n2025-09-01T21:46:57Z UpdateTip: new best=00000000f9c20fdda7029f3d5eda156b6b7d4d2b3b8b850b9dea839483e145b6 height=1013 version=0x00000001 log2_work=41.985864 tx=1033 date='2009-01-19T09:46:28Z' progress=0.000001 cache=0.3MiB(13txo)\n2025-09-01T21:46:57Z Loading 0 mempool transactions from file...\n2025-09-01T21:46:57Z Imported mempool transactions from file: 0 succeeded, 0 failed, 0 expired, 0 already there, 0 waiting for initial broadcast\n2025-09-01T21:46:57Z initload thread exit\n2025-09-01T21:46:57Z [error] Invalid -i2psam address or hostname: 'invalid_addr'\nError: Invalid -i2psam address or hostname: 'invalid_addr'\n2025-09-01T21:46:57Z tor: Thread interrupt\n2025-09-01T21:46:57Z Shutdown in progress...\n2025-09-01T21:46:57Z torcontrol thread exit\n2025-09-01T21:47:00Z mapport thread exit\n2025-09-01T21:47:00Z scheduler thread exit\n2025-09-01T21:47:00Z Writing 0 mempool transactions to file...\n2025-09-01T21:47:00Z Writing 0 unbroadcast transactions to file.\n2025-09-01T21:47:00Z Dumped mempool: 0.000s to copy, 0.009s to dump, 27 bytes dumped to file\n2025-09-01T21:47:00Z Flushed fee estimates to fee_estimates.dat.\n2025-09-01T21:47:00Z Shutdown done\n```",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-09-01T21:54:52Z",
      "updated_at": "2026-01-15T09:10:30Z",
      "closed_at": null,
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/33276",
      "labels": [
        "Validation"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 9754,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3730153407,
      "number": 34076,
      "title": "tapscript with time-locked musig2",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nTrying to import descriptor with time-locked musig fragment in tapscript returns:\n```\nerror code: -5\nerror message:\nInvalid musig() expression\n```\n\n### Expected behaviour\n\nImport should work.\n\n### Steps to reproduce\n\ntry `getdescriptorinfo` with following BIP-388 policy:\n\n`tr(musig(@0,@1,@2)/**,{and_v(v:pk(musig(@0,@1)/**),older(12960)),{and_v(v:pk(musig(@0,@2)/**),older(12960)),and_v(v:pk(musig(@1,@2)/**),older(12960))}})`\n\nwhich translates (for example) to following descriptor:\n\n```\ntr(musig([a471be2d/88h/1h/0h]tpubDCyTVDMyRxsEeAf7KLPRfUZkSCCjsZPqZoM2Ay3FqtH55CxvTchpK2DSbTgVRziFGesGGibdsfC4BktGNUMwb4VjGwu2KuzDCp9A97rVH8q,[0f056943/88h/1h/0h]tpubDD8WTkCBJwj5WHR8S1gr2y64LcFSwEic38zGRKEuHXUUPRacZyTREJp9vZ5fayGVqEzzBacffrkK1g4CJRA5PgXE7MkrsLcUWbeixkLaNM6,[6b69e5e9/88h/1h/0h]tpubDCMSPy71rEscssSimZNZ3S1Z2aguLeeLbguzDUXJVfwiCxuAE88omLcd95895x9au5Tw81bCuPhNcmSCzp2Yz13EReNHduoFKc4f1VNs7VG)/<0;1>/*,{and_v(v:pk(musig([6b69e5e9/88h/1h/0h]tpubDCMSPy71rEscssSimZNZ3S1Z2aguLeeLbguzDUXJVfwiCxuAE88omLcd95895x9au5Tw81bCuPhNcmSCzp2Yz13EReNHduoFKc4f1VNs7VG,[a471be2d/88h/1h/0h]tpubDCyTVDMyRxsEeAf7KLPRfUZkSCCjsZPqZoM2Ay3FqtH55CxvTchpK2DSbTgVRziFGesGGibdsfC4BktGNUMwb4VjGwu2KuzDCp9A97rVH8q)/<0;1>/*),older(12960)),{and_v(v:pk(musig([6b69e5e9/88h/1h/0h]tpubDCMSPy71rEscssSimZNZ3S1Z2aguLeeLbguzDUXJVfwiCxuAE88omLcd95895x9au5Tw81bCuPhNcmSCzp2Yz13EReNHduoFKc4f1VNs7VG,[0f056943/88h/1h/0h]tpubDD8WTkCBJwj5WHR8S1gr2y64LcFSwEic38zGRKEuHXUUPRacZyTREJp9vZ5fayGVqEzzBacffrkK1g4CJRA5PgXE7MkrsLcUWbeixkLaNM6)/<0;1>/*),older(12960)),and_v(v:pk(musig([a471be2d/88h/1h/0h]tpubDCyTVDMyRxsEeAf7KLPRfUZkSCCjsZPqZoM2Ay3FqtH55CxvTchpK2DSbTgVRziFGesGGibdsfC4BktGNUMwb4VjGwu2KuzDCp9A97rVH8q,[0f056943/88h/1h/0h]tpubDD8WTkCBJwj5WHR8S1gr2y64LcFSwEic38zGRKEuHXUUPRacZyTREJp9vZ5fayGVqEzzBacffrkK1g4CJRA5PgXE7MkrsLcUWbeixkLaNM6)/<0;1>/*),older(12960))}})\n```\n\n(imo) error is caused by the first leaf where `expr` after split is missing terminating parentheses of musig expression https://github.com/bitcoin/bitcoin/blob/2210feb4466eff1455468f0a25045fce4b89c55d/src/script/descriptor.cpp#L1844-L1847\n\nOR use below patch to add test case to musig functional tests:\n\n```\nSubject: [PATCH] test\n---\nIndex: test/functional/wallet_musig.py\nIDEA additional info:\nSubsystem: com.intellij.openapi.diff.impl.patch.CharsetEP\n<+>UTF-8\n===================================================================\ndiff --git a/test/functional/wallet_musig.py b/test/functional/wallet_musig.py\n--- a/test/functional/wallet_musig.py\t(revision 2210feb4466eff1455468f0a25045fce4b89c55d)\n+++ b/test/functional/wallet_musig.py\t(date 1765796643152)\n@@ -236,6 +236,7 @@\n         self.do_test(\"tr(H,{pk(musig/*), pk(same keys different musig/*)})\", \"tr($H,{pk(musig($0,$1,$2)/<0;1>/*),pk(musig($1,$2)/0/*)})\", scriptpath=True)\n         self.do_test(\"tr(musig/*,{pk(partial keys diff musig-1/*),pk(partial keys diff musig-2/*)})}\", \"tr(musig($0,$1,$2)/<3;4>/*,{pk(musig($0,$1)/<5;6>/*),pk(musig($1,$2)/7/*)})\")\n         self.do_test(\"tr(musig/*,{pk(partial keys diff musig-1/*),pk(partial keys diff musig-2/*)})} script-path\", \"tr(musig($0,$1,$2)/<3;4>/*,{pk(musig($0,$1)/<5;6>/*),pk(musig($1,$2)/7/*)})\", scriptpath=True, nosign_wallets=[0])\n+        self.do_test(\"time-locked musig\", \"tr(musig($0,$1,$2)/<0;1>/*,{and_v(v:pk(musig($0,$1)/<0;1>/*),older(12960)),{and_v(v:pk(musig($0,$2)/<0;1>/*),older(12960)),and_v(v:pk(musig($1,$2)/<0;1>/*),older(12960))}})\", scriptpath=True)\n \n \n if __name__ == '__main__':\n```\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nmaster@2210feb4466eff1455468f0a25045fce4b89c55d\n\n### Operating system and version\n\nLinux ... 6.14.0-37-generic #37~24.04.1-Ubuntu ... x86_64 x86_64 x86_64 GNU/Linux\n\n### Machine specifications\n\n_No response_",
      "state": "open",
      "user": "scgbckbone",
      "created_at": "2025-12-15T12:14:26Z",
      "updated_at": "2026-01-15T09:07:55Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34076",
      "labels": [
        "Wallet",
        "Descriptors"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3948,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3189243686,
      "number": 32838,
      "title": "Shallow invalid forks + ActivateBestChainStep result in overly aggressive mempool filtering",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nUpon reorgs, the mempool has its transactions filtered near the end of every call of `ActivateBestChainStep` via  `MaybeUpdateMempoolForReorg` : https://github.com/bitcoin/bitcoin/blob/a763497b1d6661bc5a7b8943d8f04a4459fd6827/src/validation.cpp#L3403\n\nIf the fork being activated is actually invalid this can happen:\n\n1. Chain at height `T`, with transaction in mempool which relies on height T or higher for lock validity (nsequence f.e.)\n2. Alternative chain to height `T+1`, forking at `T-1` is encountered.\n3. `ActivateBestChainStep` fires once, rolling back to height `T-1`, then stopping when it attempts to validate the invalid block fork at height `T`.\n4. Since `fBlocksDisconnected` is true, `MaybeUpdateMempoolForReorg` is called at height `T-1`\n5. Transaction is filtered due to non-final locks at height `T-1`, and function returns\n6. Next `ActivateBestChainStep` is called, but with an empty disconnect pool, getting back to height `T` with original chain tip at step (1)\n\nI think this can also happen if a valid reorg is longer than 32 blocks: https://github.com/bitcoin/bitcoin/blob/a763497b1d6661bc5a7b8943d8f04a4459fd6827/src/validation.cpp#L3360\n\n### Expected behaviour\n\nIdeally, the disconnectpool would not be re-applied until the known reorg is complete.\n\n### Steps to reproduce\n\nAn example causing this was found during debugging a related fuzzing crash: https://github.com/bitcoin/bitcoin/pull/28676#issuecomment-3018572194\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nhttps://github.com/dergoegge/bitcoin/commit/6329ce979f63b396aa036a1ad39798bb83fa4ade\n\n### Operating system and version\n\nUbuntu\n\n### Machine specifications\n\n_No response_",
      "state": "open",
      "user": "instagibbs",
      "created_at": "2025-06-30T17:05:42Z",
      "updated_at": "2026-01-15T09:07:23Z",
      "closed_at": null,
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/32838",
      "labels": [
        "Mempool"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1965,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3322502078,
      "number": 33188,
      "title": "asan: GCC warning about use-after-free",
      "body": "GCC is warning about use-after-free in the recently added ASAN unpoisoning:\n```bash\n# gcc (GCC) 15.2.1 20250808 (Red Hat 15.2.1-1)\n# cmake -B build -DSANITIZERS=address\nIn file included from /root/bitcoin/src/util/check.h:131,\n                 from /root/bitcoin/src/random.h:13,\n                 from /root/bitcoin/src/test/util/random.h:9,\n                 from /root/bitcoin/src/test/util/setup_common.h:19,\n                 from /root/bitcoin/src/test/util/setup_common.cpp:5:\nIn destructor â€˜PoolResource<MAX_BLOCK_SIZE_BYTES, ALIGN_BYTES>::~PoolResource() [with long unsigned int MAX_BLOCK_SIZE_BYTES = 152; long unsigned int ALIGN_BYTES = 8]â€™,\n    inlined from â€˜virtual CCoinsViewCache::~CCoinsViewCache()â€™ at /root/bitcoin/src/coins.h:362:7,\n    inlined from â€˜std::pair<CMutableTransaction, long int> TestChain100Setup::CreateValidTransaction(const std::vector<std::shared_ptr<const CTransaction> >&, const std::vector<COutPoint>&, int, const std::vector<CKey>&, const std::vector<CTxOut>&, const std::optional<CFeeRate>&, const std::optional<unsigned int>&)â€™ at /root/bitcoin/src/test/util/setup_common.cpp:486:1:\n/root/bitcoin/src/support/allocators/pool.h:210:13: warning: pointer â€˜chunkâ€™ used after â€˜void operator delete(void*, std::align_val_t)â€™ [-Wuse-after-free]\n  210 |             ASAN_UNPOISON_MEMORY_REGION(chunk, m_chunk_size_bytes);\n      |             ^~~~~~~~~~~~~~~~~~~~~~~~~~~\nIn file included from /root/bitcoin/src/memusage.h:10,\n                 from /root/bitcoin/src/core_memusage.h:10,\n                 from /root/bitcoin/src/kernel/mempool_entry.h:10,\n                 from /root/bitcoin/src/test/util/setup_common.cpp:18:\n/root/bitcoin/src/support/allocators/pool.h:209:31: note: call to â€˜void operator delete(void*, std::align_val_t)â€™ here\n  209 |             ::operator delete ((void*)chunk, std::align_val_t{ELEM_ALIGN_BYTES});\n      |             ~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nIn destructor â€˜PoolResource<MAX_BLOCK_SIZE_BYTES, ALIGN_BYTES>::~PoolResource() [with long unsigned int MAX_BLOCK_SIZE_BYTES = 152; long unsigned int ALIGN_BYTES = 8]â€™,\n    inlined from â€˜virtual CCoinsViewCache::~CCoinsViewCache()â€™ at /root/bitcoin/src/coins.h:362:7,\n    inlined from â€˜std::pair<CMutableTransaction, long int> TestChain100Setup::CreateValidTransaction(const std::vector<std::shared_ptr<const CTransaction> >&, const std::vector<COutPoint>&, int, const std::vector<CKey>&, const std::vector<CTxOut>&, const std::optional<CFeeRate>&, const std::optional<unsigned int>&)â€™ at /root/bitcoin/src/test/util/setup_common.cpp:486:1:\n/root/bitcoin/src/support/allocators/pool.h:210:13: warning: pointer â€˜chunkâ€™ used after â€˜void operator delete(void*, std::align_val_t)â€™ [-Wuse-after-free]\n  210 |             ASAN_UNPOISON_MEMORY_REGION(chunk, m_chunk_size_bytes);\n      |             ^~~~~~~~~~~~~~~~~~~~~~~~~~~\n/root/bitcoin/src/support/allocators/pool.h:209:31: note: call to â€˜void operator delete(void*, std::align_val_t)â€™ here\n  209 |             ::operator delete ((void*)chunk, std::align_val_t{ELEM_ALIGN_BYTES});\n      |             ~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n<snip>\nIn file included from /root/bitcoin/src/util/check.h:131,\n                 from /root/bitcoin/src/random.h:13,\n                 from /root/bitcoin/src/test/util/random.h:9,\n                 from /root/bitcoin/src/test/util/setup_common.h:19,\n                 from /root/bitcoin/src/test/transaction_tests.cpp:7:\nIn destructor â€˜PoolResource<MAX_BLOCK_SIZE_BYTES, ALIGN_BYTES>::~PoolResource() [with long unsigned int MAX_BLOCK_SIZE_BYTES = 152; long unsigned int ALIGN_BYTES = 8]â€™,\n    inlined from â€˜CCoinsViewCache::~CCoinsViewCache()â€™ at /root/bitcoin/src/coins.h:362:7:\n/root/bitcoin/src/support/allocators/pool.h:210:13: warning: pointer â€˜chunkâ€™ used after â€˜void operator delete(void*, std::align_val_t)â€™ [-Wuse-after-free]\n  210 |             ASAN_UNPOISON_MEMORY_REGION(chunk, m_chunk_size_bytes);\n      |             ^~~~~~~~~~~~~~~~~~~~~~~~~~~\nIn file included from /root/bitcoin/src/memusage.h:10,\n                 from /root/bitcoin/src/core_memusage.h:10,\n                 from /root/bitcoin/src/coins.h:10,\n                 from /root/bitcoin/src/script/sign.h:10,\n                 from /root/bitcoin/src/test/transaction_tests.cpp:23:\n/root/bitcoin/src/support/allocators/pool.h:209:31: note: call to â€˜void operator delete(void*, std::align_val_t)â€™ here\n  209 |             ::operator delete ((void*)chunk, std::align_val_t{ELEM_ALIGN_BYTES});\n      |             ~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nIn destructor â€˜PoolResource<MAX_BLOCK_SIZE_BYTES, ALIGN_BYTES>::~PoolResource() [with long unsigned int MAX_BLOCK_SIZE_BYTES = 152; long unsigned int ALIGN_BYTES = 8]â€™,\n    inlined from â€˜virtual CCoinsViewCache::~CCoinsViewCache()â€™ at /root/bitcoin/src/coins.h:362:7,\n    inlined from â€˜virtual CCoinsViewCache::~CCoinsViewCache()â€™ at /root/bitcoin/src/coins.h:362:7:\n/root/bitcoin/src/support/allocators/pool.h:210:13: warning: pointer â€˜chunkâ€™ used after â€˜void operator delete(void*, std::align_val_t)â€™ [-Wuse-after-free]\n  210 |             ASAN_UNPOISON_MEMORY_REGION(chunk, m_chunk_size_bytes);\n      |             ^~~~~~~~~~~~~~~~~~~~~~~~~~~\n/root/bitcoin/src/support/allocators/pool.h:209:31: note: call to â€˜void operator delete(void*, std::align_val_t)â€™ here\n  209 |             ::operator delete ((void*)chunk, std::align_val_t{ELEM_ALIGN_BYTES});\n      |             ~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nIn destructor â€˜PoolResource<MAX_BLOCK_SIZE_BYTES, ALIGN_BYTES>::~PoolResource() [with long unsigned int MAX_BLOCK_SIZE_BYTES = 152; long unsigned int ALIGN_BYTES = 8]â€™,\n    inlined from â€˜virtual CCoinsViewCache::~CCoinsViewCache()â€™ at /root/bitcoin/src/coins.h:362:7,\n    inlined from â€˜void transaction_tests::max_standard_legacy_sigops::test_method()â€™ at /root/bitcoin/src/test/transaction_tests.cpp:1150:1:\n/root/bitcoin/src/support/allocators/pool.h:210:13: warning: pointer â€˜chunkâ€™ used after â€˜void operator delete(void*, std::align_val_t)â€™ [-Wuse-after-free]\n  210 |             ASAN_UNPOISON_MEMORY_REGION(chunk, m_chunk_size_bytes);\n      |             ^~~~~~~~~~~~~~~~~~~~~~~~~~~\n/root/bitcoin/src/support/allocators/pool.h:209:31: note: call to â€˜void operator delete(void*, std::align_val_t)â€™ here\n  209 |             ::operator delete ((void*)chunk, std::align_val_t{ELEM_ALIGN_BYTES});\n      |             ~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nIn destructor â€˜PoolResource<MAX_BLOCK_SIZE_BYTES, ALIGN_BYTES>::~PoolResource() [with long unsigned int MAX_BLOCK_SIZE_BYTES = 152; long unsigned int ALIGN_BYTES = 8]â€™,\n    inlined from â€˜virtual CCoinsViewCache::~CCoinsViewCache()â€™ at /root/bitcoin/src/coins.h:362:7,\n    inlined from â€˜void transaction_tests::spends_witness_prog::test_method()â€™ at /root/bitcoin/src/test/transaction_tests.cpp:1305:1:\n/root/bitcoin/src/support/allocators/pool.h:210:13: warning: pointer â€˜chunkâ€™ used after â€˜void operator delete(void*, std::align_val_t)â€™ [-Wuse-after-free]\n  210 |             ASAN_UNPOISON_MEMORY_REGION(chunk, m_chunk_size_bytes);\n      |             ^~~~~~~~~~~~~~~~~~~~~~~~~~~\n/root/bitcoin/src/support/allocators/pool.h:209:31: note: call to â€˜void operator delete(void*, std::align_val_t)â€™ here\n  209 |             ::operator delete ((void*)chunk, std::align_val_t{ELEM_ALIGN_BYTES});\n      |             ~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nIn destructor â€˜PoolResource<MAX_BLOCK_SIZE_BYTES, ALIGN_BYTES>::~PoolResource() [with long unsigned int MAX_BLOCK_SIZE_BYTES = 152; long unsigned int ALIGN_BYTES = 8]â€™,\n    inlined from â€˜virtual CCoinsViewCache::~CCoinsViewCache()â€™ at /root/bitcoin/src/coins.h:362:7,\n    inlined from â€˜void transaction_tests::test_Get::test_method()â€™ at /root/bitcoin/src/test/transaction_tests.cpp:450:1:\n/root/bitcoin/src/support/allocators/pool.h:210:13: warning: pointer â€˜chunkâ€™ used after â€˜void operator delete(void*, std::align_val_t)â€™ [-Wuse-after-free]\n  210 |             ASAN_UNPOISON_MEMORY_REGION(chunk, m_chunk_size_bytes);\n      |             ^~~~~~~~~~~~~~~~~~~~~~~~~~~\n/root/bitcoin/src/support/allocators/pool.h:209:31: note: call to â€˜void operator delete(void*, std::align_val_t)â€™ here\n  209 |             ::operator delete ((void*)chunk, std::align_val_t{ELEM_ALIGN_BYTES});\n      |             ~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nIn destructor â€˜PoolResource<MAX_BLOCK_SIZE_BYTES, ALIGN_BYTES>::~PoolResource() [with long unsigned int MAX_BLOCK_SIZE_BYTES = 152; long unsigned int ALIGN_BYTES = 8]â€™,\n    inlined from â€˜virtual CCoinsViewCache::~CCoinsViewCache()â€™ at /root/bitcoin/src/coins.h:362:7,\n    inlined from â€˜void transaction_tests::test_IsStandard::test_method()â€™ at /root/bitcoin/src/test/transaction_tests.cpp:1055:1:\n/root/bitcoin/src/support/allocators/pool.h:210:13: warning: pointer â€˜chunkâ€™ used after â€˜void operator delete(void*, std::align_val_t)â€™ [-Wuse-after-free]\n  210 |             ASAN_UNPOISON_MEMORY_REGION(chunk, m_chunk_size_bytes);\n      |             ^~~~~~~~~~~~~~~~~~~~~~~~~~~\n/root/bitcoin/src/support/allocators/pool.h:209:31: note: call to â€˜void operator delete(void*, std::align_val_t)â€™ here\n  209 |             ::operator delete ((void*)chunk, std::align_val_t{ELEM_ALIGN_BYTES});\n      |             ~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n```\n\ncc @dergoegge ",
      "state": "open",
      "user": "fanquake",
      "created_at": "2025-08-14T14:45:19Z",
      "updated_at": "2026-01-14T21:58:43Z",
      "closed_at": null,
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/33188",
      "labels": [
        "Build system"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 9531,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3768084891,
      "number": 34175,
      "title": "qa: `feature_pruning.py` fails when built `ENABLE_WALLET=OFF`",
      "body": "Below are the steps to reproduce the bug:\n```\n$ cmake -B build -DENABLE_WALLET=OFF\n$ cmake --build build\n$ ./build/test/functional/feature_pruning.py --tmpdir $(pwd)/tmp\n2025-12-29T18:31:27.385714Z TestFramework (INFO): PRNG seed is: 6842027149269818275\n2025-12-29T18:31:27.386337Z TestFramework (INFO): Initializing test directory /home/hebasto/dev/bitcoin/tmp\n2025-12-29T18:31:28.135416Z TestFramework (INFO): Warning! This test requires 4GB of disk space\n2025-12-29T18:31:28.135533Z TestFramework (INFO): Mining a big blockchain of 995 blocks\n2025-12-29T18:31:49.087269Z TestFramework (INFO): Check that we haven't started pruning yet because we're below PruneAfterHeight\n2025-12-29T18:31:49.087331Z TestFramework (INFO): Success\n2025-12-29T18:31:49.087425Z TestFramework (INFO): Though we're already using more than 550MiB, current usage: 592.1861515045166\n2025-12-29T18:31:49.087446Z TestFramework (INFO): Mining 25 more blocks should cause the first block file to be pruned\n2025-12-29T18:31:49.917042Z TestFramework (INFO): Success\n2025-12-29T18:31:49.917238Z TestFramework (INFO): Usage should be below target: 480.3139057159424\n2025-12-29T18:31:49.917265Z TestFramework (INFO): Check that we'll exceed disk space target if we have a very high stale block rate\n2025-12-29T18:31:49.917287Z TestFramework (INFO): Mine 24 (stale) blocks on Node 1, followed by 25 (main chain) block reorg from Node 0, for 12 rounds\n2025-12-29T18:32:23.946016Z TestFramework (INFO): Usage can be over target because of high stale rate: 640.085205078125\n2025-12-29T18:32:23.947212Z TestFramework (INFO): Check that we can survive a 288 block reorg still\n2025-12-29T18:32:23.947673Z TestFramework (INFO): Current block height: 1320\n2025-12-29T18:32:23.948098Z TestFramework (INFO): Invalidating block 170863767faea392ccf9ff5b962cc758ebe9991b2562af2f3aa044c321d175e2 at height 1033\n2025-12-29T18:32:24.322179Z TestFramework (INFO): New best height: 1032\n2025-12-29T18:32:24.429004Z TestFramework (INFO): Generating new longer chain of 300 more blocks\n2025-12-29T18:32:24.562884Z TestFramework (INFO): Reconnect nodes\n2025-12-29T18:32:25.769411Z TestFramework (INFO): Verify height on node 2: 1332\n2025-12-29T18:32:25.769654Z TestFramework (INFO): Usage possibly still high because of stale blocks in block files: 640.085205078125\n2025-12-29T18:32:25.769682Z TestFramework (INFO): Mine 220 more large blocks so we have requisite history\n2025-12-29T18:32:32.175362Z TestFramework (INFO): Usage should be below target: 448.4003086090088\n2025-12-29T18:32:32.175530Z TestFramework (INFO): Test that we can rerequest a block we previously pruned if needed for a reorg\n2025-12-29T18:32:33.817865Z TestFramework (INFO): Will need to redownload block 1033\n2025-12-29T18:32:33.938875Z TestFramework (INFO): Rewind node 0 to prev main chain to mine longer chain to trigger redownload. Blocks needed: 233\n2025-12-29T18:32:35.807399Z TestFramework (INFO): Verify node 2 reorged back to the main chain, some blocks of which it had to redownload\n2025-12-29T18:32:38.244340Z TestFramework (INFO): Test manual pruning with block indices\n2025-12-29T18:32:39.327901Z TestFramework (INFO): Success\n2025-12-29T18:32:39.327948Z TestFramework (INFO): Test manual pruning with timestamps\n2025-12-29T18:32:40.410622Z TestFramework (INFO): Success\n2025-12-29T18:32:40.410722Z TestFramework (INFO): Test invalid pruning command line options\n2025-12-29T18:32:40.580461Z TestFramework (INFO): Test scanblocks can not return pruned data\n2025-12-29T18:32:40.583664Z TestFramework (ERROR): Unexpected exception\nTraceback (most recent call last):\n  File \"/home/hebasto/dev/bitcoin/test/functional/test_framework/test_framework.py\", line 142, in main\n    self.run_test()\n    ~~~~~~~~~~~~~^^\n  File \"/home/hebasto/dev/bitcoin/./build/test/functional/feature_pruning.py\", line 481, in run_test\n    self.test_scanblocks_pruned()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/hebasto/dev/bitcoin/./build/test/functional/feature_pruning.py\", line 496, in test_scanblocks_pruned\n    assert_raises_rpc_error(-1, \"Block not available (pruned data)\", node.scanblocks,\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        \"start\", [{\"desc\": f\"raw({false_positive_spk.hex()})\"}], 0, 0, \"basic\", {\"filter_false_positives\": True})\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/hebasto/dev/bitcoin/test/functional/test_framework/util.py\", line 157, in assert_raises_rpc_error\n    assert try_rpc(code, message, fun, *args, **kwds), \"No exception raised\"\n           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAssertionError: No exception raised\n2025-12-29T18:32:40.636711Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n2025-12-29T18:32:40.636826Z TestFramework (WARNING): Not cleaning up dir /home/hebasto/dev/bitcoin/tmp\n2025-12-29T18:32:40.636857Z TestFramework (ERROR): Test failed. Test logging available at /home/hebasto/dev/bitcoin/tmp/test_framework.log\n2025-12-29T18:32:40.636939Z TestFramework (ERROR): \n2025-12-29T18:32:40.637012Z TestFramework (ERROR): Hint: Call /home/hebasto/dev/bitcoin/test/functional/combine_logs.py '/home/hebasto/dev/bitcoin/tmp' to consolidate all logs\n2025-12-29T18:32:40.637031Z TestFramework (ERROR): \n2025-12-29T18:32:40.637048Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\n2025-12-29T18:32:40.637086Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\n2025-12-29T18:32:40.637103Z TestFramework (ERROR): \n[node 5] Cleaning up leftover process\n[node 4] Cleaning up leftover process\n[node 3] Cleaning up leftover process\n[node 2] Cleaning up leftover process\n[node 1] Cleaning up leftover process\n```\n\nThe combined log appears to be too large to upload to GitHub.\n\nThis was initially observed on NetBSD and was later reproduced on Fedora 43.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-12-29T18:46:08Z",
      "updated_at": "2026-01-14T20:58:57Z",
      "closed_at": "2026-01-14T20:58:57Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34175",
      "labels": [
        "Tests"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 6076,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3363174902,
      "number": 33266,
      "title": "signet: disk-space-DoS due to low mining difficulty",
      "body": "Due to low mining difficulty on Signet, an attacker can grind all possible nonces of a block header and create valid[^valid], alternative headers for Signet blocks. Since these have the [same chain work](https://github.com/bitcoin/bitcoin/blob/6ca6f3b37b992591726bd13b494369bee3bd6468/src/validation.cpp#L4416) as the tip, the newly mined headers [can](https://github.com/bitcoin/bitcoin/blob/6ca6f3b37b992591726bd13b494369bee3bd6468/src/validation.cpp#L4435) be submitted along with the original block content via an unsolicited `block` P2P message. Nodes that don't prune will store these blocks indefinitely.\n\nWhen initially reported in April 2025, on average 13208298 work (hash attempts) were required to find a valid nonce on the default Signet. Now, after the difficulty on Signet was increased[^signet-difficulty-increased], [recent signet blocks](https://mempool.space/signet/block/00000012e826e2a7bfc888e43b37969c5b8aafa1bcc2b3a389c238d0ef733500) require 209338421 work on average. This results in 2^32 / 13208298 = ~325 valid headers for each block on average in April and 2^32 / 209338421 = ~20 valid headers for each block at the current Signet difficulty. An attacker can use this to fill up the disk of a Signet node.\n\nAssuming 144 Signet blocks per day and assuming a size of 500kB[^signet-blocks-size] per block, the signet disk usage increases by about 72 MB per day. An attack could have resulted in a disk-usage increase of 325 * 72 MB = 23.4 GB per day in April. With the current difficulty, it could result in a disk-usage increase of 20 * 72 MB = 1.44 GB per day.\n\nA modern laptop can grind the full 2^32 nonce space in less than 30 seconds and an attacker only needs to store the nonces to build and publish the alternative blocks. This makes the attack fairly trivial to exploit. \n\nCredit goes to @stwenhao for initially reporting this in a fork-observer [issue]( https://github.com/0xB10C/fork-observer/issues/61). The attack can be detected via `getchaintips` and e.g. tools like fork-observer. The alternative blocks show up as `valid-headers`. No reorg happens as the original block remains the active tip (since it was seen first).\n\n<img width=\"3169\" height=\"954\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/386d2490-f037-4885-a083-dc2bc3803bba\" />\n\nThe attack is possible on all networks that require less than 2^32 work to find blocks. Pruned nodes are not affected as the alternative blocks are removed at some point. I'm opening this issue is to document this somewhere visible. I don't think there's action required for the default Signet at this point since the difficulty has already been increased and the attack is less effective there now. If this becomes a problem again, the best mitigation is probably to further increase the difficulty. Other public signets (e.g. Mutinynet) might want to consider increasing the mining difficulty too.\n\n[^valid]: Signet blocks commit to the header version, prevhash, merkleroot, and timestamp. These can't be changed. Only the nonce can be changed to produce valid, alternative headers. \n[^signet-blocks-size]:  filling Signet blocks with transactions is possible for *free*, but blocks seem to be limited to 1 MWU. Consistently making 500 kB blocks seems to be possible for an attacker \n[^signet-difficulty-increased]: The Signet difficulty was increased at the end of April 2025 in response to a private report.<img width=\"400\" height=\"150\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/15f1888c-3cd7-4409-a4f0-ff5f53fbc0bd\" />\n\n",
      "state": "open",
      "user": "0xB10C",
      "created_at": "2025-08-28T12:38:43Z",
      "updated_at": "2026-01-14T20:54:08Z",
      "closed_at": null,
      "comments": 11,
      "url": "https://github.com/bitcoin/bitcoin/issues/33266",
      "labels": [
        "Bug",
        "Resource usage"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 3591,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3375787221,
      "number": 33280,
      "title": "use -loadblock to load blk*****.dat files, but the blocks in it are not recognized",
      "body": "The background is I'm trying to measure the performance of connecting real blocks when the needed inputs are not in memory. My first idea is to get some blk*****.dat files with `-stopatheight` and then use `-stopafterblockimport` and `-loadblock` to load these blk files (ConnectBlock() will run when doing this) to see the performance. But I found the blk*****.dat files can not be recognized by the code.\nThough I now found an alternative way `VerifyDB()` can be leveraged to achieve my goal. I'd like still to put the above issue here.\nThe bitcoin core code I use is at HEAD `6ca6f3b37b Merge bitcoin/bitcoin#33241: Update libmultiprocess subtree to fix build issues`\n\n### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\n\n1. I first run bitcoind -prune=1024 -stopatheight=840000 -datadir=empty_dir, then there is some block files in empty_dir/blocks.\n2. Then I copy empty_dir to empty_dir2, run bitcoind -prune=1024 -stopatheight=840050 -datadir=empty_dir2\nCompare two blocks dir, I now have some blk.dat files relects height 840000 to 840050.\n3. At last I copy empty_dir to empty_dir3, and run bitcoind -datadir=empty_dir3 -assumevalid=0 -prune=10240 -stopafterblockimport -networkactive=0 -noconnect -listen=0 -dnsseed=0 -dns=0 -loadblock=blk04241.dat ...... -loadblock=blk04252.dat, the result shows it finds 0 blocks from those files, and I did some test, I found the reason is those files don't have the main Magic bytes f9beb4d9\n\nAnything wrong?\n\n### Expected behaviour\n\nthe blocks from height 840001 to 840050 are loaded from those blk files and connected to the chain.\n\n### Steps to reproduce\n\nsee above\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nmaster\n\n### Operating system and version\n\nubuntu22.04 LTS\n\n### Machine specifications\n\n_No response_",
      "state": "open",
      "user": "HowHsu",
      "created_at": "2025-09-02T12:18:08Z",
      "updated_at": "2026-01-14T20:29:47Z",
      "closed_at": null,
      "comments": 13,
      "url": "https://github.com/bitcoin/bitcoin/issues/33280",
      "labels": [
        "RPC/REST/ZMQ",
        "Block storage"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 2003,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3586989882,
      "number": 33777,
      "title": "Mining interface tracking issue",
      "body": "The mining interface is defined in:\n- https://github.com/bitcoin/bitcoin/blob/master/src/interfaces/mining.h\n- https://github.com/bitcoin/bitcoin/blob/master/src/ipc/capnp/mining.capnp\n\nClients that are known to depend on it:\n- https://github.com/stratum-mining/sv2-tp\n- https://github.com/stratum-mining/sv2-apps/tree/main/bitcoin-core-sv2\n\nThe changes below are not breaking, unless mentioned otherwise. Adding new methods or new arguments to existing methods is not a breaking change.\n\n- [ ] #33965 \n  - [ ] #33966\n- [ ] #34184\n- [x] #33819\n- [ ] #32420 \n- [ ] #34020\n- [ ] #33899\n  - [ ] #33922\n- [ ] #33756 \n\nAt this state it's OK to make breaking changes, such as deleting a method or changing its signature. But ideally we should do so once in a major release, collecting a bunch of fixes.\n\n- [ ] low priority breaking change(s): https://github.com/Sjors/bitcoin/pull/106\n  - [ ] #33936\n  - [ ] make non-mandatory coinbase commitment opt-in \n  - [ ] drop `getCoinbaseCommitment()`, `getCoinbaseTx()` and `getWitnessCommitmentIndex()`\n  - [ ] wipe dummy coinbase\n\nMisc related:\n\n- [ ] #30437",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-04T15:05:33Z",
      "updated_at": "2026-01-14T16:55:09Z",
      "closed_at": null,
      "comments": 13,
      "url": "https://github.com/bitcoin/bitcoin/issues/33777",
      "labels": [
        "Mining",
        "interfaces",
        "Tracking Issue"
      ],
      "comment_data": [
        {
          "id": 3750202100,
          "user": "ryanofsky",
          "body": "re: https://github.com/bitcoin/bitcoin/issues/33777#issuecomment-3631392182\n\nSince there are a number of PRs open, do you have suggestions about what to review (or work on) next? I'd like to see #33965 merged because of the test improvements, but so far I'm the only reviewer on that.",
          "created_at": "2026-01-14T15:47:04Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 284,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3750249595,
          "user": "ismaelsadeeq",
          "body": "Can you add me to the review list? I will take a look. thanks",
          "created_at": "2026-01-14T15:56:12Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 61,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3750541615,
          "user": "Sjors",
          "body": "@ryanofsky I'd like #33965 as well. Also #32420 has a direct impact on what stratum v2 blocks will look like.",
          "created_at": "2026-01-14T16:55:09Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 109,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1129,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1941676471,
      "number": 28648,
      "title": "test: Write assumeutxo tests",
      "body": "### Motivation\n\nTests are useful to catch bugs, so they should be written.\n\n### Possible solution\n\nWrite tests, similar to https://github.com/bitcoin/bitcoin/pull/28647\r\n\r\nRefer to the `TODO` comments in `./test/functional/feature_assumeutxo.py`, or to the uncovered lines in the AssumeUtxo code via a coverage report. For example, https://maflcko.github.io/b-c-cov/total.coverage/src/validation.cpp.gcov.html\n\n### Useful Skills\n\n* Compiling Bitcoin Core from source\r\n* Running the C++ unit tests and the Python functional tests\r\n* Basic AssumeUtxo understanding\r\n* Bitcoin Core serialization and test framework understanding\r\n* Python serialization understanding\n\n### Guidance for new contributors\n\nWant to work on this issue?\r\n\r\nFor guidance on contributing, please read [CONTRIBUTING.md](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md) before opening your pull request.\r\n",
      "state": "open",
      "user": "maflcko",
      "created_at": "2023-10-13T10:24:00Z",
      "updated_at": "2026-01-14T15:59:45Z",
      "closed_at": null,
      "comments": 22,
      "url": "https://github.com/bitcoin/bitcoin/issues/28648",
      "labels": [
        "Wallet",
        "Tests",
        "Consensus",
        "good first issue"
      ],
      "comment_data": [
        {
          "id": 3750265467,
          "user": "yashbhutwala",
          "body": "> I still think this issue should either be closed as completed or reworked to be much more specific. But probably the best path forward is to just close this and open issues for the specific cases that are still missing, if there are any.\n\nI agree this issue should be closed. After reviewing the full history:\n\n**All items from ryanofsky's original test matrix have been addressed:**\n\nTest cases (loading snapshot with):\n- âœ… Invalid hash - covered in `test_invalid_snapshot_scenarios`\n- âœ… Invalid snapshot file - covered in `test_invalid_snapshot_scenarios`\n- âœ… Unknown block reference - covered in `test_invalid_snapshot_scenarios`\n- âœ… Invalid/invalid parent block - covered in `test_snapshot_block_invalidated`\n- âœ… Block not on most-work chain - covered via #30320\n\nStarting states:\n- âœ… Ancestor of snapshot - normal case throughout tests\n- âœ… Not ancestor, less work - covered via #29996\n- âœ… Tip is snapshot block - covered via #30403\n- âœ… Descendant of snapshot - implicitly covered (fails with \"Work does not exceed\")\n- âœ… Not ancestor/descendant, more work - covered via #30320\n\n**The three remaining PRs mentioned have all been merged:** #30403, #30320, #29996\n\n**Remaining minor item:** I've opened #34286 to address the last TODO in `wallet_assumeutxo.py` (line 242), which adds test assertions verifying node state after restart during background sync. This documents an important edge case: wallets cannot be loaded after a node restart during assumeutxo background sync because blocks before the snapshot are unavailable for rescanning.\n\nGiven the original scope has been fully addressed, I think closing this issue makes sense. Any future test coverage improvements can be tracked in more specific issues.",
          "created_at": "2026-01-14T15:59:45Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 3,
            "text_length": 1717,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 919,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3800461331,
      "number": 34250,
      "title": "crash during IPC cleanup after `interruptWait()` is called",
      "body": "while working on https://github.com/stratum-mining/sv2-apps/pull/177, I'm noticing a new crash\n\nsteps to reproduce:\n- run Bitcoin Core `v30.2` on `mainnet`\n- `git clone https://github.com/plebhash/sv2-apps -b 2026-01-09-bitcoin-core-v30-2`\n- edit `sv2-apps/pool-apps/pool/config-examples/mainnet/pool-config-bitcoin-core-ipc-example.toml` so that `unix_socket_path` field points to `node.sock`\n- launch Pool via: `cd sv2-apps/pool-apps/pool; cargo run -- -c config-examples/mainnet/pool-config-bitcoin-core-ipc-example.toml`\n- let Pool run for a while\n- kill Pool with ctrl+c\n\nthis does not happen deterministically, so a few attempts of launching then killing Pool might be needed \n\nbut eventually Bitcoin Core crashes with a few different log variations:\n```\n2026-01-10T22:48:03Z [ipc] {bitcoin-node-35006/b-capnp-loop-203488} IPC server recv request  #96 BlockTemplate.getCoinbaseMerklePath$Params\n2026-01-10T22:48:03Z [ipc] {bitcoin-node-35006/b-capnp-loop-203488} IPC server post request  #96 {bitcoin-node-35006/206817 (from )}\n2026-01-10T22:48:03Z [ipc] {bitcoin-node-35006/b-capnp-loop-203488} IPC server send response #96 BlockTemplate.getCoinbaseMerklePath$Results\n2026-01-10T22:48:07Z [ipc] {bitcoin-node-35006/b-capnp-loop-203488} IPC server recv request  #97 BlockTemplate.waitNext$Params\n2026-01-10T22:48:07Z [ipc] {bitcoin-node-35006/b-capnp-loop-203488} IPC server post request  #97 {bitcoin-node-35006/206817 (from )}\n2026-01-10T22:48:07Z [ipc:info] {bitcoin-node-35006/b-capnp-loop-203488} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages13BlockTemplateEEE\n2026-01-10T22:48:07Z [ipc:info] {bitcoin-node-35006/b-capnp-loop-203488} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages13BlockTemplateEEE\n2026-01-10T22:48:07Z [ipc:info] {bitcoin-node-35006/b-capnp-loop-203488} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages13BlockTemplateEEE\n2026-01-10T22:48:07Z [ipc:info] {bitcoin-node-35006/b-capnp-loop-203488} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages13BlockTemplateEEE\n2026-01-10T22:48:07Z [ipc:info] {bitcoin-node-35006/b-capnp-loop-203488} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages13BlockTemplateEEE\n2026-01-10T22:48:07Z [ipc:info] {bitcoin-node-35006/b-capnp-loop-203488} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages13BlockTemplateEEE\n2026-01-10T22:48:07Z [ipc:info] {bitcoin-node-35006/b-capnp-loop-203488} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages13BlockTemplateEEE\n2026-01-10T22:48:07Z [ipc:info] {bitcoin-node-35006/b-capnp-loop-203488} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages6MiningEEE\n2026-01-10T22:48:07Z [ipc:info] {bitcoin-node-35006/b-capnp-loop-203488} IPC server: socket disconnected.\n2026-01-10T22:48:07Z [ipc:info] {bitcoin-node-35006/b-capnp-loop-203488} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages4InitEEE\n2026-01-10T22:48:08Z CreateNewBlock(): block weight: 3998742 txs: 599 fees: 515599 sigops 13307\nlibc++abi: terminating due to uncaught exception of type std::__1::system_error: mutex lock failed: Invalid argument\n[1]    35006 abort      ./bitcoin-30.2/bin/bitcoin -m node -ipcbind=unix -prune=555 -debug=ipc\n```\n\n```\n2026-01-10T22:22:02Z [ipc] {bitcoin-node-19528/b-capnp-loop-144717} IPC server send response #134 BlockTemplate.getCoinbaseMerklePath$Results\n2026-01-10T22:22:03Z [ipc] {bitcoin-node-19528/b-capnp-loop-144717} IPC server recv request  #135 BlockTemplate.waitNext$Params\n2026-01-10T22:22:03Z [ipc] {bitcoin-node-19528/b-capnp-loop-144717} IPC server post request  #135 {bitcoin-node-19528/147843 (from )}\n2026-01-10T22:22:04Z CreateNewBlock(): block weight: 3998510 txs: 4931 fees: 315281 sigops 999\n2026-01-10T22:22:04Z [ipc:info] {bitcoin-node-19528/b-capnp-loop-144717} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages13BlockTemplateEEE\n2026-01-10T22:22:04Z [ipc:info] {bitcoin-node-19528/b-capnp-loop-144717} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages13BlockTemplateEEE\n2026-01-10T22:22:04Z [ipc:info] {bitcoin-node-19528/b-capnp-loop-144717} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages13BlockTemplateEEE\n2026-01-10T22:22:04Z [ipc:info] {bitcoin-node-19528/b-capnp-loop-144717} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages13BlockTemplateEEE\n2026-01-10T22:22:04Z [ipc:info] {bitcoin-node-19528/b-capnp-loop-144717} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages6MiningEEE\n2026-01-10T22:22:04Z [ipc:info] {bitcoin-node-19528/b-capnp-loop-144717} IPC server: socket disconnected.\n2026-01-10T22:22:04Z [ipc:info] {bitcoin-node-19528/b-capnp-loop-144717} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages4InitEEE\n2026-01-10T22:22:05Z CreateNewBlock(): block weight: 3998649 txs: 4928 fees: 336652 sigops 1030\nAssertion failed: (m_loop), function operator*, file proxy.h, line 59.\n[1]    19528 abort      ./bitcoin-30.2/bin/bitcoin -m node -ipcbind=unix -prune=555 -debug=ipc \n```\n\ncc @ryanofsky @ismaelsadeeq ",
      "state": "open",
      "user": "plebhash",
      "created_at": "2026-01-10T22:51:23Z",
      "updated_at": "2026-01-14T15:59:00Z",
      "closed_at": null,
      "comments": 12,
      "url": "https://github.com/bitcoin/bitcoin/issues/34250",
      "labels": [
        "Bug",
        "interfaces"
      ],
      "comment_data": [
        {
          "id": 3745566529,
          "user": "ryanofsky",
          "body": "Update: I implemented a fix in 94b07f57232e72981df6fb399fe21bb93a09b667 ([tag](https://github.com/ryanofsky/bitcoin/commits/pr/ipc-cancel.1)) which prevents the crash and is simpler than the fix I mentioned in my comment yesterday https://github.com/bitcoin/bitcoin/issues/34250#issuecomment-3740582453, but I'm not really happy with it. The fix I was working on yesterday tried to detect disconnections specficially and avoid deferencing deleted `Connection` pointers in the case of a method returning an interface pointer after a connection was broken. The new fix is simpler and handles cancellations in general, instead of only detecting disconnects, and just avoids doing any unnecessary work after a cancellation happens. But I found that unless `$allowCancellation` annotations are added to the capnp files, disconnecting during a method call does not actually cancel the call, so the fix doesn't work unless extra `$allowCancellation` baggage is added to interfaces. Will look into this more and see if there may be a better fix, or maybe go back to the first approach.\n\nEDIT: The fix in 94b07f57232e72981df6fb399fe21bb93a09b667 is actually broken in another way, because the \"Aborting cancelled IPC request\" exception it tries to raise to fix the issue is never raised. The reason why the change fixes the crash is just that the $Cxx.allowCancellation annotation for reasons I'm not very clear on causes the onDisconnect handler not to be triggered until after the waitNext method returns, so the crash is avoided. This seems like another downside of the change, because it seems better if the connection can be cleaned up without waiting for pending IPC calls that could take arbitrarily long to finish executing.",
          "created_at": "2026-01-13T17:33:09Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 1723,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3746679001,
          "user": "ryanofsky",
          "body": "Update: A better fix is implemented in ba5270dce21050134be5e22df2ddf4529962c7ea ([tag](https://github.com/ryanofsky/bitcoin/commits/pr/ipc-cancel.2)) which avoids the need to require `$allowCancellation` annotations. It works in basically the same way as the last fix aside from that. Will continue working on this and adding tests, etc",
          "created_at": "2026-01-13T21:37:32Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 336,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3749243782,
          "user": "ryanofsky",
          "body": "Current plan is to open a combined libmultiprocess PR that addresses this issue and #33923. It will:\n\n- Prevent crashes in response-building code after an unclean disconnect using the approach in ba5270dce21050134be5e22df2ddf4529962c7ea ([tag](https://github.com/ryanofsky/bitcoin/commits/pr/ipc-cancel.2)) . This will prevent the crash reported here when a client calls `waitNext`, disconnects without waiting for the response, and then `waitNext` later returns a block template.\n- Resolve [#33923](https://github.com/bitcoin/bitcoin/issues/33923) and allow an arbitrary number of requests to be sent to the same server thread, getting rid of the \"thread busy\" exception. I think this can be done pretty simply by using branching promises and chaining the requests as they come in.\n\nReason for wanting to combine these is that both change type `type-context.h` a lot and I think having the second change would simplify the first. Am planning to to have the libmultiprocess PR implemented and ready for review this week, and when updating the subtree, merging to master and 30.x branches as discussed in #33439 so the same libmultiprocess version is used both branches and behavior is the same in both.",
          "created_at": "2026-01-14T12:02:00Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 1202,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3750262199,
          "user": "ismaelsadeeq",
          "body": "> You should definitely feel free to attempt another fix, and maybe there is a simpler one. I'm probably less than halfway done on my fix and planning to finish it tomorrow.\n\nI have been working on other things over the past few days; I will review your PR when it's up and suck all the information above. Thank you for all the context and updates @ryanofsky .",
          "created_at": "2026-01-14T15:59:00Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 360,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 5017,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2629170491,
      "number": 31204,
      "title": "Source code mapping for debugger has changed since cmake",
      "body": "developer-notes.md says:\r\n\r\n\r\n>1. Configure source file mapping.\r\n>\r\n>For `gdb` create or append to `.gdbinit` file:\r\n>```\r\n>set substitute-path ./src /path/to/project/root/src\r\n>```\r\n>\r\n>For `lldb` create or append to `.lldbinit` file:\r\n>```\r\n>settings set target.source-map ./src /path/to/project/root/src\r\n>```\r\n\r\nBut I found I needed to create a `.lldbinit` file with these lines:\r\n```\r\nsettings append target.source-map build/src/test/ /Users/matthewzipkin/Desktop/work/bitcoin/\r\nsettings append target.source-map build/src/src/ /Users/matthewzipkin/Desktop/work/bitcoin/src/\r\n```\r\n\r\nHere's an example of lldb's confused guess of source location:\r\n\r\n```\r\n(lldb) image lookup -vn  ProcessMessages\r\n1 match found in /Users/matthewzipkin/Desktop/work/bitcoin/build/src/bitcoind:\r\n...\r\n      LineEntry: [0x00000001003302f4-0x000000010033032c): build/src/src/net_processing.cpp:5373\r\n```\r\n\r\nCould just be fixed by updating developer-notes.md -- would we ever include a `.lldbinit` file in the repo itself? Or am I missing something else.",
      "state": "open",
      "user": "pinheadmz",
      "created_at": "2024-11-01T14:37:17Z",
      "updated_at": "2026-01-14T15:37:35Z",
      "closed_at": null,
      "comments": 16,
      "url": "https://github.com/bitcoin/bitcoin/issues/31204",
      "labels": [
        "Docs",
        "Build system",
        "Tests"
      ],
      "comment_data": [
        {
          "id": 3750142297,
          "user": "maflcko",
          "body": "Fixed in https://github.com/bitcoin/bitcoin/pull/34281. Tested on a fresh install of Ubuntu 26.04 LTS:\n\n* Master:\n\n```\n# lldb\n(lldb) version\nlldb version 21.1.7\n(lldb) target create ./bld-c/bin/bitcoind\nCurrent executable set to '/b-c/bld-c/bin/bitcoind' (x86_64).\n(lldb) settings show target.source-map\ntarget.source-map (path-map) =\n(lldb) breakpoint set --name AppInitSanityChecks\nBreakpoint 1: where = bitcoind`AppInitSanityChecks(kernel::Context const&) at init.cpp:1161:1, address = 0x00000000001981c0\n(lldb) run\nerror: Cannot launch '/b-c/bld-c/bin/bitcoind': personality set failed: Function not implemented\n(lldb) settings set target.disable-aslr false\n(lldb) run\nProcess 20302 launched: '/b-c/bld-c/bin/bitcoind' (x86_64)\nProcess 20302 stopped\n* thread #1, name = 'bitcoind', stop reason = breakpoint 1.1\n    frame #0: 0x0000563485dce1c0 bitcoind`AppInitSanityChecks(kernel=0x00005634923d71d0) at init.cpp:1161:1\n(lldb) \n```\n\n* My fix:\n\n```\n# lldb\n(lldb) version\nlldb version 21.1.7\n(lldb) target create ./bld-c/bin/bitcoind\nCurrent executable set to '/b-c-pull-34281/bld-c/bin/bitcoind' (x86_64).\n(lldb) settings show target.source-map\ntarget.source-map (path-map) =\n(lldb) breakpoint set --name AppInitSanityChecks\nBreakpoint 1: where = bitcoind`AppInitSanityChecks(kernel::Context const&) at init.cpp:1161:1, address = 0x00000000001981c0\n(lldb) run\nerror: Cannot launch '/b-c-pull-34281/bld-c/bin/bitcoind': personality set failed: Function not implemented\n(lldb) settings set target.disable-aslr false\n(lldb) run\nProcess 20308 launched: '/b-c-pull-34281/bld-c/bin/bitcoind' (x86_64)\nProcess 20308 stopped\n* thread #1, name = 'bitcoind', stop reason = breakpoint 1.1\n    frame #0: 0x0000564415caf1c0 bitcoind`AppInitSanityChecks(kernel=0x000056443ed4d1d0) at init.cpp:1161:1\n   1158\t}\n   1159\t\n   1160\tbool AppInitSanityChecks(const kernel::Context& kernel)\n-> 1161\t{\n   1162\t    // ********************************************************* Step 4: sanity checks\n   1163\t    auto result{kernel::SanityChecks(kernel)};\n   1164\t    if (!result) {\n(lldb) \n",
          "created_at": "2026-01-14T15:37:35Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 2066,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1094,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3405677599,
      "number": 33363,
      "title": "Early detect non-loopback traffic from unit tests",
      "body": "Tests should not attempt to create network connections over the internet because that has unpredictable timing and outcome. It could also reveal the location (IP address) where somebody is running Bitcoin Core tests, if the target address is very specific, e.g. not `github.com:443`, but `1.2.3.4:8333` for example. See [#31339](https://github.com/bitcoin/bitcoin/issues/31339).\n\nhttps://github.com/bitcoin/bitcoin/pull/31349 is an attempt to detect such cases in CI. In the [discussions](https://github.com/bitcoin/bitcoin/pull/31349#pullrequestreview-3185369594) on that PR a complementary idea came up - to use a mocked socket from unit tests to detect such usage. That could be done in addition if there is support for it and if not too complicated.\n\nI guess, if this is to be done, either `CreateSock()` should be changed from `BasicTestingSetup` to throw right away or return a mocked `Sock` object that has a real underlying socket and throws on attempts to create non-loopback connections.",
      "state": "open",
      "user": "vasild",
      "created_at": "2025-09-11T09:33:22Z",
      "updated_at": "2026-01-14T15:19:07Z",
      "closed_at": null,
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/33363",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1047,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3410376062,
      "number": 33375,
      "title": "bench: unrealistic ConnectBlock benchmarks",
      "body": "The current `ConnectBlock` benchmarks in `bench/connectblock.cpp` do not reflect realistic mainnet workloads due to three key issues:\n\n#### 1. Unrealistic block composition\n\nEvery benchmarked block is constructed with a highly artificial transaction pattern:\n\n```c\n/*\n * - Each transaction has the same number of inputs and outputs\n * - All Taproot inputs use simple key path spends (no script path spends)\n * - All signatures use SIGHASH_ALL (default sighash)\n * - Each transaction spends all outputs from the previous transaction\n */\n```\n\nThis setup avoids realistic UTXO set fragmentation and script diversity. The benchmark effectively measures validation of a synthetic \"ladder\" of transactions rather than a block resembling mainnet traffic.\n\n#### 2. Unrealistic UTXO cache state\n\nBefore benchmarking, the code creates a block that produces the outputs, then immediately spends them all in the benchmark block. This keeps the entire UTXO set hot in memory (`CoinsTip()`).\n\nIn reality:\n\n* Many UTXO lookups hit LevelDB and require disk access.\n* Cache misses and eviction policies significantly impact block validation cost.\n\n#### 3. Unrealistic repetition\n\nEach benchmark repeatedly validates the same synthetic block:\n\n```cpp\n    const auto& test_block{CreateTestBlock(test_setup, keys, outputs)};\n    bench.unit(\"block\").run([&] {\n        /* ... */\n    });\n```\n\nThere is no variability in transaction graph, script mix, or UTXO evolution across iterations. As a result, the benchmark never exercises cache churn, block-to-block dependency patterns, or realistic workload diversity.\n\n---\n\n### Why this matters\n\nThese issues mean the benchmark results do not reflect real-world `ConnectBlock` performance. Instead, they measure a best-case, memory-only workload on a synthetic block structure.\n",
      "state": "open",
      "user": "Raimo33",
      "created_at": "2025-09-12T12:53:02Z",
      "updated_at": "2026-01-14T15:18:23Z",
      "closed_at": null,
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/33375",
      "labels": [
        "Validation"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1843,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3528797348,
      "number": 33655,
      "title": "importdescriptors: check for errors before rescanning",
      "body": "I tried to import two descriptors with labels but one was an internal descriptor. I didn't realize that was not allowed until the entire rescan (for the first descriptor) completed and the return object included  success false with that error message, for the second descriptor.",
      "state": "open",
      "user": "pinheadmz",
      "created_at": "2025-10-18T12:49:22Z",
      "updated_at": "2026-01-14T15:17:41Z",
      "closed_at": null,
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/33655",
      "labels": [
        "Wallet",
        "RPC/REST/ZMQ"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 332,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3638031791,
      "number": 33899,
      "title": "Block template memory management (for IPC clients)",
      "body": "## Background\n\nEach time we send an IPC client a new `BlockTemplate`, via `createNewBlock` or `waitNext` on the Mining interface, libmultiprocess ensures that we hold on to its encapsulated `CBlockTemplate`. It's just as if our own code has a shared pointer to it.\n\nWe let go of it when either the client calls the `destroy` method or they disconnect (cc @ryanofsky ??).\n\nThe `CBlockTemplate` in turn contains a `CBlock` which contains pointers to individual transactions. Those transactions were in the mempool at the time the template was created, so initially there's barely any memory overhead. But as time goes by the mempool changes and the template keeps holding on to them.\n\nThis is an important behavior, because at any time the client may call `submitSolution()`. That method only takes the `nVersion`, `nTime`, `nonce` and a coinbase transaction as arguments, so it's up to us to reconstruct the block and broadcast it to our peers.\n\nAdditionally, in scenarios where a miner proposes blocks to the pool, such as pool may request some or all of the transactions for inspection.\n\nAt some point however we need to let go of `CBlockTemplate` references, because otherwise the node runs out of memory.\n\nI think we should leave it up to the client to decide which templates they want us to hold on to. That's because there isn't an obvious best way to do this. For example, we might be sending the client many new templates that build on the same prevhash but have more fees. They may decide to rate limit how many to forward downstream to the miner. Or a miner proxy might do such rate limiting. Mining equipment also needs some time to switch work, so it might send us a solution to a slightly older template.\n\nIn sv2-tp so far I implemented a fairly simple heuristic: 10 seconds after the tip changes, wipe all templates that refer to the previous tip. Additionally it limits the frequency of new templates to once every `-sv2interval` seconds (default 30), though I'm considering dropping that rate limiting in https://github.com/stratum-mining/sv2-tp/issues/60.\n\nThe work-in-progress SRI implementation in https://github.com/stratum-mining/sv2-apps/pull/59 currently wipes templates as soon as the tip updates and has no rate limiting other than by fee delta.\n\n## Memory management implementation\n\nThere are probably different ways we can go about memory management here.\n\nThe most straightforward approach is probably to track the additional memory footprint and bound it to `-maxtemplatepoolsize`. If we default that to 50MB it should be plenty for the block template manager proposed in https://github.com/bitcoin/bitcoin/issues/33758, when it's not used for mining.\n\nThe node could refuse to make new templates when it gets to 80% full and automatically drop the oldest template if it crosses 100%. \n\n## Memory management interface\n\n`createNewBlock` and `waitNext` could throw an exception or return null if the template memory is full. Both are a bit tricky to handle, so maybe they need an additional response status argument to communicate the situation.\n\nWe could also add an additional method to obtain how much memory is used and available. That would allow the Template Provider to pre-empt situations where we refuse to provide it new templates, and worse, where we start dropping them unilaterally.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-18T12:46:17Z",
      "updated_at": "2026-01-14T15:16:51Z",
      "closed_at": null,
      "comments": 18,
      "url": "https://github.com/bitcoin/bitcoin/issues/33899",
      "labels": [
        "Mining",
        "interfaces"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3372,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3659088225,
      "number": 33940,
      "title": "Memory leak when using IPC mining interface",
      "body": " _Originally posted by @plebhash in [#33899](https://github.com/bitcoin/bitcoin/issues/33899#issuecomment-3568788623)_\n\n> we are getting reports of out-of-memory crashes on https://github.com/stratum-mining/sv2-apps/pull/59#issuecomment-3568252007\n> \n> initially I suspected there could be thread-related issues similar to what I reported on https://github.com/bitcoin/bitcoin/issues/33923, but it turns out it was the VPS running out of it's 2GB available RAM, which only happened after long (12h+) running sessions\n> \n> so I leveraged [`psrecord`](https://github.com/astrofrog/psrecord) to observe how Bitcoin Core (a14e7b9dee9145920f93eab0254ce92942bd1e5e from `30.x` branch) was consuming RAM across time (connected to `mainnet` for high mempool activity, for about ~1h to have enough chain tip updates)\n> \n> this is RAM consumption of Bitcoin Core with the Rust code from https://github.com/stratum-mining/sv2-apps/pull/59 (more specifically SRI Pool at https://github.com/stratum-mining/sv2-apps/pull/59/commits/57576e083e82fb5acd5dbad75e8b4de7158a3d61) connected to it:\n> \n> <img width=\"640\" height=\"480\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/452a8246-9fdb-490c-b1d1-57a51ebb7c92\" />\n> \n> there's a clear upwards trend in RAM consumption, which made me wonder if we were doing something wrong on the Rust code\n> \n> so then I ran it alongside [`sv2-tp`](https://github.com/stratum-mining/sv2-tp) for a comparison:\n> \n> <img width=\"640\" height=\"480\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/edf8fbf0-c05e-43ad-8883-ba76fb43138b\" />\n> \n> which shows a similar upwards trend that never gets throttled down\n> \n> ---\n> \n> I don't know whether the root cause for this is related to template memory management, but there's a chance it is, so I'm reporting it here rather than opening a new issue \n\n _Originally posted by @Sjors in [#33899](https://github.com/bitcoin/bitcoin/issues/33899#issuecomment-3569959628)_\n\n> I'm planning to make similar plots for #33922 (without CPU and ideally with marks to indicate where blocks were found).\n> \n> If you're measuring the process memory instead of only the template memory (which #33922 enables), you'll want to hold the mempool itself constant. E.g. by picking some value for `-maxmempool` and waiting for it to fill before starting the measurement. You also want to set `-dbcache` to its minimum, because that's also accuring  \n\n _Originally posted by @Sjors in [#33899](https://github.com/bitcoin/bitcoin/issues/33899#issuecomment-3570523079)_\n\n> @plebhash it looks like you found a real bug. Because `BlockTemplate::createNewBlock` doesn't have a context param, it looks like its destroy method is not invoked until sv2-tp disconnects. So the node keeps holding on to templates even though the Template Provider already pruned them.\n> \n> I'll open a PR to fix that.  \n\n _Originally posted by @plebhash in [#33899](https://github.com/bitcoin/bitcoin/issues/33899#issuecomment-3570541428)_\n\n> that's good to know!\n> \n> but do we have to explicitly call `destroy` or is it sufficient to drop the reference from memory on the client side?\n> \n> from my understanding of capnp, I believe it should be sufficient to drop it from memory, but on the other hand there must be a reason for `destroy` to exist? \n\n _Originally posted by @Sjors in [#33899](https://github.com/bitcoin/bitcoin/issues/33899#issuecomment-3570785658)_\n\n> @plebhash IIUC libmultiprocess does this automatically, but only `sv2-tp` uses that library. So it probably depends on how the rust capnp library is implemented. It might be worth testing how that library behaves out of the box, with and without the fix here. Just look for the `IPC server destroy` messages on the Bitcoin Core side (preferably tested against master). \n\n\n\n",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2025-11-24T14:11:12Z",
      "updated_at": "2026-01-14T15:15:34Z",
      "closed_at": null,
      "comments": 18,
      "url": "https://github.com/bitcoin/bitcoin/issues/33940",
      "labels": [
        "Bug",
        "Resource usage",
        "interfaces"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 3825,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3723882082,
      "number": 34062,
      "title": "RFC: separate kernel logging infrastructure",
      "body": "tl;dr: kernel logging is cumbersome. I propose we layer logging so we can enable structured logging and a much simplified kernel logging interface without overcomplicating node logging.\n\n## Motivation\n\nThe `bitcoinkernel` library (#27587) [exposes](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L698-L778) functionality to interface with the kernel logging. This includes registering callbacks for log statements, level/category filtering, string formatting options, and more.\n\nKernel logging has a few problems:\n- **P1**: [callbacks](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L304) operate on formatted strings, so users need to parse the string to get the timestamp, category, level, ... based on which options are set. This is cumbersome, brittle, and inefficient.\n- **P2**: the [filtering interface](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L737) is not really intuitive, requiring users to call combinations of `btck_logging_set_level_category` and `btck_logging_enable_category` when they want to produce `debug` or `trace` logs. The level/category system makes sense for node, because it directly controls what gets written to disk and stdout, and there are quite a lot more categories producing logs. Kernel doesn't really need this - users control what happens to the logs, and can do any filtering/manipulation in the callback they provide.\n- **P3**: the node logging infrastructure has quite a bit more functionality than is necessary for a library, including ratelimiting, log formatting, outputting, buffering, ... This introduces unnecessary code and interface complexity.\n- **P4**: it [uses](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.cpp#L237) the global (node) logger, which goes against the otherwise context local (or stateless) design of the `bitcoinkernel` interface.\n\n## Approach\n\nI propose we address problems P1, P2 and P3 by layering the logging infrastructure. Roughly, this would mean:\n1. Implement a minimal `util::log::Logger` class (see [Appendix](#Appendix)) that dispatches structured log entries to registered callbacks. This is a low-level logger that does not perform formatting, rate limiting, or category filtering - it simply dispatches to callbacks.\n2. Refactor `BCLog::Logger` into `BCLog::Sink`, which registers a callback on `util::log::GetLogger()` and handles all node-specific functionality (category filtering, rate limiting, file output, formatting, ...).\n3. Update kernel code to include `util/log.h` instead of `logging.h`. The existing logging macros (`LogInfo`, `LogDebug`, etc.) continue to work unchanged.\n4. Simplify `bitcoinkernel` C API to reflect the simpler `util::log::Logger` interface (structured logging, level-based, ...), we can now completely remove `btck_LoggingOptions`.\n5. Remove `logging.h` and `logging.cpp` from the kernel library completely.\n\n**Note:** I'm leaving problem P4 out of scope for this proposal. I think it already has sufficient merit with a global logger, and I want to keep scope limited. However, I do believe layered logging infrastructure will make implementing P4 easier.\n\n## Balance\n\nThe main benefits and downsides of this approach:\n\n**Benefits:**\n- **B1:** a kernel-native structured logging interface that minimizes complexity and makes for a much more ergonomic interface, enabling structured logging instead of string parsing.\n- **B2:** doesn't complicate node logging purely for the purpose of accommodating diverging requirements for kernel. For example, I suspect projects like #30342 should be much easier with layered kernel logging.\n- **B3:** reduces friction if/when node migrates to use the public `bitcoinkernel` interface by having already completely decoupled logging.\n- ... (what have I missed?)\n\n**Downsides:**\n- **D1:** levels-based filtering has some performance overhead by formatting all (kernel) debug log strings instead of just the subset of categories specified. Note that this _only_ applies when debug is enabled, and that kernel has a lot less logging than node.\n- ... (what have I missed?)\n\n## Scope\n\nI have implemented this approach in https://github.com/bitcoin/bitcoin/compare/master...stickies-v:bitcoin:2025-12/kernel-logging-layering. Most of the changes are quite straightforward, including refactoring `BCLog::Logger` to `BCLog::Sink`, adding tests, and adding a `util::log::Logger` interface.\n\n## Appendix\n\n### Interfaces\n#### util::log::Logger\n\n```cpp\nclass Logger\n{\npublic:\n    using Callback = std::function<void(const Entry&)>;\n    using CallbackHandle = std::list<Callback>::iterator;\n\n    //! Register a callback to receive log entries. Returns a handle for unregistration.\n    [[nodiscard]] CallbackHandle RegisterCallback(Callback callback);\n\n    //! Unregister a previously registered callback.\n    void UnregisterCallback(CallbackHandle handle);\n\n    //! Set the minimum log level. Messages below this level are discarded.\n    void SetMinLevel(Level level);\n\n    //! Get the current minimum log level.\n    Level GetMinLevel() const;\n\n    //! Returns true if a message at the given level would be logged.\n    bool WillLog(Level level) const;\n\n    //! Returns true if any callbacks are registered.\n    bool Enabled() const;\n\n    //! Format message and dispatch to all registered callbacks. No-op if minimum log level not met.\n    template <typename... Args>\n    void Log(Level level, uint64_t category, std::source_location loc, bool should_ratelimit,\n             util::ConstevalFormatString<sizeof...(Args)> fmt, const Args&... args);\n};\n```\n\n#### `bitcoinkernel` C logging interface\n\n```c\ntypedef void (*btck_LogCallback)(void* user_data, const btck_LogEntry* entry);\n\nstruct btck_LogEntry {\n    const char* message;       //!< Log message\n    size_t message_len;        //!< Log message length\n    const char* file_name;     //!< Source file name\n    size_t file_name_len;      //!< Source file name length\n    const char* function_name; //!< Source function name\n    size_t function_name_len;  //!< Source function name length\n    const char* thread_name;   //!< Thread name\n    size_t thread_name_len;    //!< Thread name length\n    int64_t timestamp_ns;      //!< Timestamp in nanoseconds since epoch\n    uint32_t line;             //!< Source line number\n    btck_LogLevel level;       //!< Log level\n    btck_LogCategory category; //!< Log category\n};\n\nBITCOINKERNEL_API void btck_logging_set_min_level(btck_LogLevel level);\n\nBITCOINKERNEL_API btck_LoggingConnection* BITCOINKERNEL_WARN_UNUSED_RESULT btck_logging_connection_create(\n    btck_LogCallback log_callback,\n    void* user_data,\n    btck_DestroyCallback user_data_destroy_callback) BITCOINKERNEL_ARG_NONNULL(1);\n\nBITCOINKERNEL_API void btck_logging_connection_destroy(btck_LoggingConnection* logging_connection);\n```\n",
      "state": "open",
      "user": "stickies-v",
      "created_at": "2025-12-12T15:43:10Z",
      "updated_at": "2026-01-14T15:14:47Z",
      "closed_at": null,
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/issues/34062",
      "labels": [
        "Brainstorming",
        "Utils/log/libs"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 7027,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3741350602,
      "number": 34096,
      "title": "IBD stalls if addnode peer is in IBD",
      "body": "Starting with two fresh nodes `A` and `B`: If you start node `A` and (before node `A` completes IBD) start a second node `B` with `-addnode={address of node A}`, node `B` will stall and not proceed in IBD.\n\n```bash\nmkdir -p /tmp/nodea /tmp/nodeb\n\ncat > /tmp/nodea/bitcoin.conf << EOF\nprune=1000\nbind=127.0.0.1:8333\nEOF\n\ncat > /tmp/nodeb/bitcoin.conf << EOF\nprune=1000\nrpcport=18331\nbind=127.0.0.1:18335\naddnode=127.0.0.1:8333\nEOF\n```\n\nand then start both nodes however you prefer, e.g.\n\n```\nbitcoind -datadir=/tmp/nodea --daemonwait\nbitcoind -datadir=/tmp/nodeb --daemonwait\n```\n\nAnd node `B` will not advance:\n\n```\ntail /tmp/nodeb/debug.log\n```\n\nShutdown node `A` and node `B` comes to life!:\n\n```bash\nbitcoin-cli -datadir=/tmp/nodea stop\ntail /tmp/nodeb/debug.log\n```",
      "state": "open",
      "user": "davidgumberg",
      "created_at": "2025-12-18T03:59:41Z",
      "updated_at": "2026-01-14T15:12:35Z",
      "closed_at": null,
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/34096",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 806,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2882058716,
      "number": 31957,
      "title": "callgrind_annotate broken after cmake migration?",
      "body": "Steps to reproduce on a fresh install of Ubuntu LTS 24.04:\n\n* Install packages and clone repo: `( export DEBIAN_FRONTEND=noninteractive && apt update && apt install git ccache make build-essential libtool cmake autotools-dev automake pkg-config bsdmainutils python3     libevent-dev libboost-dev  libsqlite3-dev valgrind  -y && git clone https://github.com/bitcoin/bitcoin.git b-c ) && cd b-c`\n* `git checkout 338bc2cd261ba3daf7fb494f8cb4a534762e292c  # cmake migration (allows to test autotools and cmake on the same commit)`\n* Apply a diff to create more function calls in one hotspot (optional):\n\n```diff\ndiff --git a/src/test/util_tests.cpp b/src/test/util_tests.cpp\nindex c2c725d676..704c060749 100644\n--- a/src/test/util_tests.cpp\n+++ b/src/test/util_tests.cpp\n@@ -273,13 +273,15 @@ BOOST_AUTO_TEST_CASE(util_ReplaceAll)\n         ReplaceAll(test, search, substitute);\n         BOOST_CHECK_EQUAL(test, expected);\n     };\n-\n+    int i{10000};\n+while (i-->0){\n     test_replaceall(\"\", \"foo\", original);\n     test_replaceall(original, \"foo\", \"foo\");\n     test_replaceall(\"%s\", \"foo\", \"A test \\\"foo\\\" string 'foo'.\");\n     test_replaceall(\"\\\"\", \"foo\", \"A test foo%sfoo string '%s'.\");\n     test_replaceall(\"'\", \"foo\", \"A test \\\"%s\\\" string foo%sfoo.\");\n }\n+}\n \n BOOST_AUTO_TEST_CASE(util_TrimString)\n {\n```\n\n* Then create two out-of-tree builds, run a test in callgrind, and annotate it:\n* `./autogen.sh && rm -rf ./bld-a && mkdir bld-a && ( cd bld-a && ../configure && make -j$(nproc) )`\n* `rm -rf ./bld-c && cmake -B ./bld-c && cmake --build ./bld-c -j $(nproc)`\n* `valgrind --tool=callgrind --callgrind-out-file=cg-a-%p.out ./bld-a/src/test/test_bitcoin -t util_tests/util_ReplaceAll`\n* `valgrind --tool=callgrind --callgrind-out-file=cg-c-%p.out ./bld-c/src/test/test_bitcoin -t util_tests/util_ReplaceAll`\n* `callgrind_annotate ./cg-a-40328.out`\n* `callgrind_annotate ./cg-c-39984.out`\n\nThe cmake version of the last call will print a warning:\n\n```\n--------------------------------------------------------------------------------\nThe following files chosen for auto-annotation could not be found:\n--------------------------------------------------------------------------------\n  ./bld-c/src/crypto/./src/compat/byteswap.h\n  ./bld-c/src/crypto/./src/crypto/sha256.cpp\n  ./bld-c/src/crypto/./src/crypto/sha512.cpp\n  ./bld-c/src/test/./src/test/crypto_tests.cpp\n  ./bld-c/src/test/./src/test/util_tests.cpp\n  ./bld-c/src/util/./src/random.cpp\n  ./bld-c/src/util/./src/util/string.cpp\n...\n```\n\nIt also seems not possible to fix with `--include=dir`, as the path look a bit odd (non-existing)",
      "state": "open",
      "user": "maflcko",
      "created_at": "2025-02-26T15:48:13Z",
      "updated_at": "2026-01-14T14:58:18Z",
      "closed_at": null,
      "comments": 8,
      "url": "https://github.com/bitcoin/bitcoin/issues/31957",
      "labels": [
        "Build system",
        "Tests"
      ],
      "comment_data": [
        {
          "id": 3749961716,
          "user": "maflcko",
          "body": "For reference, the current steps to test on a fresh install of Ubuntu 26.04 LTS:\n\n```\n    1  ( export DEBIAN_FRONTEND=noninteractive && apt update && apt install git ccache make build-essential libtool cmake autotools-dev automake pkg-config bsdmainutils python3     libevent-dev libboost-dev  libsqlite3-dev valgrind  -y && git clone https://github.com/bitcoin/bitcoin.git b-c ) && cd b-c \n    7  git apply /tmp/a  # apply optional patch\n    9  rm -rf ./bld-c && cmake -DENABLE_IPC=OFF -B ./bld-c && cmake --build ./bld-c -j $(nproc) \n   10  valgrind --tool=callgrind --callgrind-out-file=cg-c-%p.out ./bld-c/bin/test_bitcoin -t util_tests/util_ReplaceAll \n   11  callgrind_annotate ./cg-c-19826.out \n```\n\nThis allows testing with and without https://github.com/bitcoin/bitcoin/pull/34281 to confirm it is fixed.",
          "created_at": "2026-01-14T14:58:18Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 813,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2643,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3747139562,
      "number": 34114,
      "title": "log: frequent `pcp: Mapping failed with result NOT_AUTHORIZED (code 2)` logs as `net:warning`",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nOn my node at home (not a monitoring node), I'm seeing three `pcp: Mapping failed with result NOT_AUTHORIZED (code 2)` logs every five minutes logged as `net:warnings`. I think that's too frequent.\n\n```\n...\n2025-12-19T10:32:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:32:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:32:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:37:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:37:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:37:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:42:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:42:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:42:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:47:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:47:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:47:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:52:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:52:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:52:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:57:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:57:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:57:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T11:00:54Z Flushed fee estimates to fee_estimates.dat.\n2025-12-19T11:02:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T11:02:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T11:02:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n...\n```\n\n### Expected behaviour\n\nFewer of the pcp warnings.\n\n### Steps to reproduce\n\nRun a node behind a router that returns NOT_AUTHORIZED for PCP (?)\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nPackage manager\n\n### What version of Bitcoin Core are you using?\n\nv30.0 (via nixpkgs)\n\n### Operating system and version\n\nNixOS\n\n### Machine specifications\n\nMachine is behind a home internet router with PCP disabled by default.  I'm running the node with `txindex=1`, `addnode`, and otherwise default configuration.",
      "state": "open",
      "user": "0xB10C",
      "created_at": "2025-12-19T11:16:06Z",
      "updated_at": "2026-01-14T14:55:09Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34114",
      "labels": [
        "Utils/log/libs"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2929,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3809637019,
      "number": 34273,
      "title": "Importing musig descriptor with identical (private) keys in tapleaf and only musig subderivation different fails",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nBelow is very silly policy, that has two almost identical musig expressions in single tapleaf. Keys inside musig expressions are the same, only musig derivation is different, yielding different resulting keys.\n\n`tr($H,and_v(v:pk(musig($0,$1,$2)/<0;1>/*),pk(musig($0,$1,$2)/<2;3>/*)))`\n\nI have no issues importing descriptor from above policy with only public keys into bitcoin core. Yet when I replace with private keys I'm getting  `is not sane: contains duplicate public keys`\n\n### Expected behaviour\n\nregardless whether descriptor contains private or public keys, it should import without duplicate keys error as musig key expression should be treated as only one key and only that key should be considered for duplicate check\n\n### Steps to reproduce\n\nDescriptor with only public keys that imports no problem:\n```\ntr(tpubD6NzVbkrYhZ4WMCcYXEgDrM1AFATSGmrFyMnA2Dgx1Y551VueaE3iemHhQBxhKWjepG76Cy5QmXv8z4KwN6ARTnZ5hVuShfxL129NVGXZuE/<0;1>/*,and_v(v:pk(musig([0f056943/86h/1h/0h]tpubDCeEX49avtiXrBTv3JWTtco99Ka499jXdZHBRtm7va2gkMAui11ctZjqNAT9dLVNaEozt2C1kfTM88cnvZCXsWLJN2p4viGvsyGjtKVV7A1,[bd6eb0b5/44h/1h/0h]tpubDDZuASpyXjtMrnf1rDDREY1VXt89RNS4ZHU99KSkvUYd7CcuDQMPizr1sBHEXhjDy3qU8sAK2i4vkcgAat84S2w4wMJM8BpJ9dPuQKV1Uqh,[18953581/44h/1h/0h]tpubDDJDF4KvHFML8KW4QCstjJaSes1D5uEcEZWTSA3ZpQPTuQTXobVBT7sGkJbLebJ88xrtvWS5fMVMNK1xTSNWNsWWc2tUybdz96HPMKA3LFV)/<0;1>/*),pk(musig([0f056943/86h/1h/0h]tpubDCeEX49avtiXrBTv3JWTtco99Ka499jXdZHBRtm7va2gkMAui11ctZjqNAT9dLVNaEozt2C1kfTM88cnvZCXsWLJN2p4viGvsyGjtKVV7A1,[bd6eb0b5/44h/1h/0h]tpubDDZuASpyXjtMrnf1rDDREY1VXt89RNS4ZHU99KSkvUYd7CcuDQMPizr1sBHEXhjDy3qU8sAK2i4vkcgAat84S2w4wMJM8BpJ9dPuQKV1Uqh,[18953581/44h/1h/0h]tpubDDJDF4KvHFML8KW4QCstjJaSes1D5uEcEZWTSA3ZpQPTuQTXobVBT7sGkJbLebJ88xrtvWS5fMVMNK1xTSNWNsWWc2tUybdz96HPMKA3LFV)/<2;3>/*)))\n```\n\nReplace one public key with corresponding private key:\n\n```\n[{'desc': 'tr(tpubD6NzVbkrYhZ4WMCcYXEgDrM1AFATSGmrFyMnA2Dgx1Y551VueaE3iemHhQBxhKWjepG76Cy5QmXv8z4KwN6ARTnZ5hVuShfxL129NVGXZuE/0/*,and_v(v:pk(musig([0f056943/86h/1h/0h]tpubDCeEX49avtiXrBTv3JWTtco99Ka499jXdZHBRtm7va2gkMAui11ctZjqNAT9dLVNaEozt2C1kfTM88cnvZCXsWLJN2p4viGvsyGjtKVV7A1,tprv8ZgxMBicQKsPd3QxqYNKLfXHkRYHSayji5qWZDLuSiDAG3S7oyhbV9VRZ4RD35LTYM11aDpvTsovP9mafLAqyCsPpwmAzt6Y6GPr8wNeHNQ/44h/1h/0h,[18953581/44h/1h/0h]tpubDDJDF4KvHFML8KW4QCstjJaSes1D5uEcEZWTSA3ZpQPTuQTXobVBT7sGkJbLebJ88xrtvWS5fMVMNK1xTSNWNsWWc2tUybdz96HPMKA3LFV)/0/*),pk(musig([0f056943/86h/1h/0h]tpubDCeEX49avtiXrBTv3JWTtco99Ka499jXdZHBRtm7va2gkMAui11ctZjqNAT9dLVNaEozt2C1kfTM88cnvZCXsWLJN2p4viGvsyGjtKVV7A1,tprv8ZgxMBicQKsPd3QxqYNKLfXHkRYHSayji5qWZDLuSiDAG3S7oyhbV9VRZ4RD35LTYM11aDpvTsovP9mafLAqyCsPpwmAzt6Y6GPr8wNeHNQ/44h/1h/0h,[18953581/44h/1h/0h]tpubDDJDF4KvHFML8KW4QCstjJaSes1D5uEcEZWTSA3ZpQPTuQTXobVBT7sGkJbLebJ88xrtvWS5fMVMNK1xTSNWNsWWc2tUybdz96HPMKA3LFV)/2/*)))#vqqlj5dt', 'timestamp': 1768321595, 'active': True, 'internal': False, 'range': [0, 100]}, {'desc': 'tr(tpubD6NzVbkrYhZ4WMCcYXEgDrM1AFATSGmrFyMnA2Dgx1Y551VueaE3iemHhQBxhKWjepG76Cy5QmXv8z4KwN6ARTnZ5hVuShfxL129NVGXZuE/1/*,and_v(v:pk(musig([0f056943/86h/1h/0h]tpubDCeEX49avtiXrBTv3JWTtco99Ka499jXdZHBRtm7va2gkMAui11ctZjqNAT9dLVNaEozt2C1kfTM88cnvZCXsWLJN2p4viGvsyGjtKVV7A1,tprv8ZgxMBicQKsPd3QxqYNKLfXHkRYHSayji5qWZDLuSiDAG3S7oyhbV9VRZ4RD35LTYM11aDpvTsovP9mafLAqyCsPpwmAzt6Y6GPr8wNeHNQ/44h/1h/0h,[18953581/44h/1h/0h]tpubDDJDF4KvHFML8KW4QCstjJaSes1D5uEcEZWTSA3ZpQPTuQTXobVBT7sGkJbLebJ88xrtvWS5fMVMNK1xTSNWNsWWc2tUybdz96HPMKA3LFV)/1/*),pk(musig([0f056943/86h/1h/0h]tpubDCeEX49avtiXrBTv3JWTtco99Ka499jXdZHBRtm7va2gkMAui11ctZjqNAT9dLVNaEozt2C1kfTM88cnvZCXsWLJN2p4viGvsyGjtKVV7A1,tprv8ZgxMBicQKsPd3QxqYNKLfXHkRYHSayji5qWZDLuSiDAG3S7oyhbV9VRZ4RD35LTYM11aDpvTsovP9mafLAqyCsPpwmAzt6Y6GPr8wNeHNQ/44h/1h/0h,[18953581/44h/1h/0h]tpubDDJDF4KvHFML8KW4QCstjJaSes1D5uEcEZWTSA3ZpQPTuQTXobVBT7sGkJbLebJ88xrtvWS5fMVMNK1xTSNWNsWWc2tUybdz96HPMKA3LFV)/3/*)))#d20d849q', 'timestamp': 1768321595, 'active': True, 'internal': True, 'range': [0, 100]}]\n``` \n\nresults in error:\n\n```\n{'success': False, 'error': {'code': -5, 'message': 'and_v(v:pk(musig([0f056943/86h/1h/0h]tpubDCeEX49avtiXrBTv3JWTtco99Ka499jXdZHBRtm7va2gkMAui11ctZjqNAT9dLVNaEozt2C1kfTM88cnvZCXsWLJN2p4viGvsyGjtKVV7A1,tpubD6NzVbkrYhZ4WWSkjC2uk5BQKT4DbvAeHPSHqjPCrz1Z6XgtSNXBfe7HjCVKqpPEnSb2LNxw2KxDeWvM22UPDoYmf7rkbdW1qc8yWJUnpFe/44h/1h/0h,[18953581/44h/1h/0h]tpubDDJDF4KvHFML8KW4QCstjJaSes1D5uEcEZWTSA3ZpQPTuQTXobVBT7sGkJbLebJ88xrtvWS5fMVMNK1xTSNWNsWWc2tUybdz96HPMKA3LFV)/0/*),pk(musig([0f056943/86h/1h/0h]tpubDCeEX49avtiXrBTv3JWTtco99Ka499jXdZHBRtm7va2gkMAui11ctZjqNAT9dLVNaEozt2C1kfTM88cnvZCXsWLJN2p4viGvsyGjtKVV7A1,tpubD6NzVbkrYhZ4WWSkjC2uk5BQKT4DbvAeHPSHqjPCrz1Z6XgtSNXBfe7HjCVKqpPEnSb2LNxw2KxDeWvM22UPDoYmf7rkbdW1qc8yWJUnpFe/44h/1h/0h,[18953581/44h/1h/0h]tpubDDJDF4KvHFML8KW4QCstjJaSes1D5uEcEZWTSA3ZpQPTuQTXobVBT7sGkJbLebJ88xrtvWS5fMVMNK1xTSNWNsWWc2tUybdz96HPMKA3LFV)/2/*)) is not sane: contains duplicate public keys'}}\n```\n\nSame error can be seen if one uses `getdescriptorinfo` rpc\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nusing code from PR https://github.com/bitcoin/bitcoin/pull/34141\n\n### Operating system and version\n\nLinux ... 6.14.0-37-generic #37~24.04.1-Ubuntu ... x86_64 x86_64 x86_64 GNU/Linux\n\n### Machine specifications\n\n_No response_",
      "state": "open",
      "user": "scgbckbone",
      "created_at": "2026-01-13T16:32:11Z",
      "updated_at": "2026-01-14T14:54:32Z",
      "closed_at": null,
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34273",
      "labels": [
        "Wallet",
        "Descriptors"
      ],
      "comment_data": [
        {
          "id": 3746726477,
          "user": "151henry151",
          "body": "If the duplicate key check is examining the individual participant keys rather than the aggregated MuSig keys, then maybe when private keys are involved the aggregation step behaves differently during validation, causing the underlying participant keys to be compared instead. \n\nAlternatively, perhaps the aggregation with private keys isn't properly applying the MuSig derivation paths, resulting in both expressions producing the same aggregate key. \n\nI'd think to look at how duplicate checking handles MuSig expressions when it can't fully resolve the aggregated key. This might be happening when `GetPubKey(0, dummy, dummy)` is called during duplicate checking with an empty `SigningProvider`, which could cause the aggregation to fail or behave differently when private keys are present.",
          "created_at": "2026-01-13T21:50:41Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 793,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 5507,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2891729679,
      "number": 31975,
      "title": "RFC: when to drop testnet3",
      "body": "Testnet3 was deprecated in v28 with the introduction of testnet4. #31974 implements its removal.\n\nDropping it in v30 seems reasonable to me, but let's discuss this here as to not clutter the implementation PR.\n\nNote that v29 (coming soon), which includes testnet3, will be supported for a while. See https://bitcoincore.org/en/lifecycle/\n\n@instagibbs wrote:\n\n> I've said it elsewhere, but I think it deserves a quite long deprecation cycle, along with some data gathering.\n> \n> We don't want services not upgrading for fixes because their test environment would break.\n> \n> e.g., what exchanges with testnet environments have adopted testnet4 (or signet), much less would be ok with removing testnet3?\n> \n> Does btcd support it? LND? Eclaire? CLN? etc.\n> \n> Lots of work to be done here imo.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-03-03T16:33:23Z",
      "updated_at": "2026-01-14T14:50:48Z",
      "closed_at": null,
      "comments": 12,
      "url": "https://github.com/bitcoin/bitcoin/issues/31975",
      "labels": [
        "Tests",
        "Needs Conceptual Review"
      ],
      "comment_data": [
        {
          "id": 3749926484,
          "user": "stwenhao",
          "body": "> Should we perhaps wait for testnet5 to see if that fixes the issues we see on testnet4?\n\nI wonder, if testnet5 will be deployed in the nearest future. 2026-01-01 and 2026-01-08 are already in the past, and nothing happened. Because when it comes to a proposed network with the premine of 10.5 million coins, then signet is pretty much already there. It was deployed in 2020, and it is beyond the first halving. Most coins are owned by developers, and there are faucets, where people can mine signet coins on CPUs.\n\nSo, is there anything, where testnet5 would do a better job, than signet with Proof of Work faucets? It may be worth considering selling some coinbase transactions, or things like that for signet coins (like: you pay 25 sBTC or more, and signet creators will allow you to produce a custom block or something). But in general, if it is only about testing mining, then faucet pretty much covers it.",
          "created_at": "2026-01-14T14:50:48Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 913,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 818,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3680657459,
      "number": 33982,
      "title": "build: `guix` package was removed from debian",
      "body": "Apparently the `guix` debian package was no longer maintained, and was removed from debian recently (see https://lwn.net/Articles/1035491/). Ubuntu and other debian derivatives will likely follow.\n\nThis means we need new setup instructions for guix on debian in `contrib/guix/INSTALL.md`.",
      "state": "open",
      "user": "laanwj",
      "created_at": "2025-12-01T11:58:44Z",
      "updated_at": "2026-01-14T14:34:07Z",
      "closed_at": null,
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/33982",
      "labels": [
        "Docs",
        "Build system"
      ],
      "comment_data": [
        {
          "id": 3749844850,
          "user": "fanquake",
          "body": "Guix 1.5.0rc1 is available for testing: https://lists.gnu.org/archive/html/guix-devel/2025-12/msg00182.html.",
          "created_at": "2026-01-14T14:34:06Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 108,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 334,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3784227504,
      "number": 34205,
      "title": "Intermittent issue in feature_bip68_sequence.py: in test_sequence_lock_confirmed_inputs                                        num_inputs = random.randint(1, min(10, available_utxos)): ValueError: empty range in randint(1, 0)",
      "body": "https://github.com/bitcoin/bitcoin/actions/runs/20722345957/job/59492260670?pr=34188#step:14:34425:\n\n```\n...\n node0 2026-01-05T18:28:42.795754Z [httpworker.1] [D:\\a\\bitcoin\\bitcoin\\src\\rpc\\request.cpp:243] [parse] [rpc] ThreadRPCServer method=getblockchaininfo user=__cookie__ \n node0 2026-01-05T18:28:42.796627Z [http] [D:\\a\\bitcoin\\bitcoin\\src\\httpserver.cpp:307] [http_request_cb] [http] Received a POST request for / from 127.0.0.1:59122 \n node0 2026-01-05T18:28:42.796705Z [httpworker.0] [D:\\a\\bitcoin\\bitcoin\\src\\rpc\\request.cpp:243] [parse] [rpc] ThreadRPCServer method=getrawtransaction user=__cookie__ \n node0 2026-01-05T18:28:42.797538Z [http] [D:\\a\\bitcoin\\bitcoin\\src\\httpserver.cpp:307] [http_request_cb] [http] Received a POST request for / from 127.0.0.1:59122 \n node0 2026-01-05T18:28:42.797608Z [httpworker.1] [D:\\a\\bitcoin\\bitcoin\\src\\rpc\\request.cpp:243] [parse] [rpc] ThreadRPCServer method=getblockchaininfo user=__cookie__ \n node0 2026-01-05T18:28:42.798538Z [http] [D:\\a\\bitcoin\\bitcoin\\src\\httpserver.cpp:307] [http_request_cb] [http] Received a POST request for / from 127.0.0.1:59122 \n node0 2026-01-05T18:28:42.798612Z [httpworker.1] [D:\\a\\bitcoin\\bitcoin\\src\\rpc\\request.cpp:243] [parse] [rpc] ThreadRPCServer method=getblockchaininfo user=__cookie__ \n test  2026-01-05T18:28:42.799132Z TestFramework (ERROR): Unexpected exception \n                                   Traceback (most recent call last):\n                                     File \"D:\\a\\bitcoin\\bitcoin\\build\\test\\functional\\test_framework\\test_framework.py\", line 142, in main\n                                       self.run_test()\n                                       ~~~~~~~~~~~~~^^\n                                     File \"D:\\a\\bitcoin\\bitcoin\\build\\test\\functional\\feature_bip68_sequence.py\", line 66, in run_test\n                                       self.test_sequence_lock_confirmed_inputs()\n                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n                                     File \"D:\\a\\bitcoin\\bitcoin\\build\\test\\functional\\feature_bip68_sequence.py\", line 149, in test_sequence_lock_confirmed_inputs\n                                       num_inputs = random.randint(1, min(10, available_utxos))\n                                     File \"C:\\hostedtoolcache\\windows\\Python\\3.14.2\\x64\\Lib\\random.py\", line 341, in randint\n                                       raise ValueError(f\"empty range in randint({a}, {b})\")\n                                   ValueError: empty range in randint(1, 0)",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-06T08:28:42Z",
      "updated_at": "2026-01-13T23:30:07Z",
      "closed_at": "2026-01-13T23:30:07Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34205",
      "labels": [
        "CI failed"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2756,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2579172974,
      "number": 31066,
      "title": " scriptpubkeyman fuzz target TopUp is slow (3/N)",
      "body": "Follow-up to https://github.com/bitcoin/bitcoin/issues/30476 and https://github.com/bitcoin/bitcoin/issues/30541:\r\n\r\nFound by OSS-Fuzz: https://issues.oss-fuzz.com/issues/369374541\r\n\r\nProbably a duplicate of, or similarity with https://github.com/bitcoin/bitcoin/issues/30498\r\n\r\nFile: [clusterfuzz-testcase-scriptpubkeyman-6582005385461760.not.txt](https://github.com/user-attachments/files/17330258/clusterfuzz-testcase-scriptpubkeyman-6582005385461760.not.txt)\r\n\r\n\r\n\r\n```\r\n$ FUZZ=scriptpubkeyman perf record -g --call-graph dwarf  ./bld-cmake/src/test/fuzz/fuzz -runs=1 /tmp/clusterfuzz-testcase-scriptpubkeyman-6582005385461760.not.txt\r\n$ hotspot ./perf.data\r\n```\r\n\r\n![Screenshot from 2024-10-10 17-19-24](https://github.com/user-attachments/assets/29918851-b1da-45d2-908f-8264e51a0f53)\r\n",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2024-10-10T15:21:10Z",
      "updated_at": "2026-01-13T23:28:48Z",
      "closed_at": "2026-01-13T23:28:48Z",
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/31066",
      "labels": [
        "Tests",
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 840,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3787451912,
      "number": 34216,
      "title": "V30.1 Release URL Does Not Exist",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nhttps://bitcoincore.org/bin/bitcoin-core-30.1/ URL is invalid.\n\nHomebrew update on Mac fails:\n\nâœ˜ Cask bitcoin-core (30.1)\nError: Download failed on Cask 'bitcoin-core' with message: Download failed: https://bitcoincore.org/bin/bitcoin-core-30.1/bitcoin-30.1-arm64-apple-darwin.zip\n==> Upgrading 1 outdated package:\nbitcoin-core 30.0 -> 30.1\n==> Upgrading bitcoin-core\n==> Purging files for version 30.1 of Cask bitcoin-core\nError: bitcoin-core: Download failed on Cask 'bitcoin-core' with message: Download failed: https://bitcoincore.org/bin/bitcoin-core-30.1/bitcoin-30.1-arm64-apple-darwin.zip\n\n### Expected behaviour\n\nHomebrew update for bitcoin-core should succeed.\n\n### Steps to reproduce\n\nJust run:\n\nbrew update; brew upgrade\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nPre-built binaries\n\n### What version of Bitcoin Core are you using?\n\nV30.0\n\n### Operating system and version\n\nMacOS Tahoe 26.1\n\n### Machine specifications\n\n_No response_",
      "state": "closed",
      "user": "vittvolt",
      "created_at": "2026-01-07T05:51:43Z",
      "updated_at": "2026-01-13T16:03:58Z",
      "closed_at": "2026-01-07T06:23:41Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34216",
      "labels": [],
      "comment_data": [
        {
          "id": 3745150856,
          "user": "fanquake",
          "body": "Just noting that v30.2 is now available, and homebrew & homebrew-cask are now pointing to that version.",
          "created_at": "2026-01-13T16:03:58Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 103,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1121,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3575888633,
      "number": 33758,
      "title": "BlockTemplate Manager Tracking issue",
      "body": "The main motivation and design rationale are discussed in #33389.\n\nWhat to review\n\n* #33421\n\n### Plan\n\n* [ ] **Introduce the Block Template Cache (Manager) #33421**\n  Implement a cache layer. All newly created block templates should be stored along with their respective configuration options. Client requests for block templates will specify the **maximum age** of the template; that is, how fresh they want the template to be:\n\n  * If a template with matching options exists in the cache and the interval has not elapsed, a cached template is returned.\n  * If no template exists or the interval has elapsed, a new template is generated, stored in the cache, and returned.\n  * After insertion, the oldest template is evicted if the cache exceeds its maximum size.\n    The cache has a configurable maximum size (default: 10).\n    It also subscribes to the validation interfaceâ€™s `BlockConnected` notification and clears the cache when a new block is connected or disconnected, preventing stale templates from being served.\n    If `test_block_validity` is set to `true` in the block creation options and the cached template found has not yet been validated, it is checked and then returned.\n    This stage will also allow sharing of template metadata built from the mining interface for a fee estimation mechanism that requires building a block template to obtain package fee rates and use them for fee estimation, and vice versa. See the discussion in #33389.\n\n* [ ] Create a block template manager that will own the `BlockTemplateCache`. Block template requests from node components and other block template-related operations will be handled via this cache.\n\n* [ ] Prune `WaitAndCreateNewBlock` and move its implementation to the block template manager under `GetNext`. This method will use the block template cache for decisions to build a block template. This approach is cleaner and should allow reusing the logic in `getblocktemplate`, thereby removing the global state.\n  [https://github.com/bitcoin/bitcoin/blob/292ea0eb8982faef460c210bd4215d603f487463/src/rpc/mining.cpp#L776](https://github.com/bitcoin/bitcoin/blob/292ea0eb8982faef460c210bd4215d603f487463/src/rpc/mining.cpp#L776)\n  [https://github.com/bitcoin/bitcoin/blob/292ea0eb8982faef460c210bd4215d603f487463/src/rpc/mining.cpp#L859-L861](https://github.com/bitcoin/bitcoin/blob/292ea0eb8982faef460c210bd4215d603f487463/src/rpc/mining.cpp#L859-L861)\n  This will also allow pruning `WaitTipChanged` and exposing information to retrieve the metadata of the last built block template, enabling the removal of additional global state.\n  [https://github.com/bitcoin/bitcoin/blob/292ea0eb8982faef460c210bd4215d603f487463/src/node/miner.h#L186-L189](https://github.com/bitcoin/bitcoin/blob/292ea0eb8982faef460c210bd4215d603f487463/src/node/miner.h#L186-L189)\n\n* [ ] **Implement trimming of transactions** in larger block templates to enable reuse when configurations do not match (see the idea here: [https://github.com/bitcoin/bitcoin/issues/33389#issuecomment-3295505510](https://github.com/bitcoin/bitcoin/issues/33389#issuecomment-3295505510))\n  This will allow reusing block templates from `SENDTEMPLATE` for mining and fee estimation, but not vice versa, because `SENDTEMPLATE` builds templates larger than 4 MB.\n\n* [ ] **Introduce a push-based subscription mechanism** that allows clients to subscribe to fee updates for a given block template and receive a new template when the fee threshold is reached or when the tip changes. This is what `waitnext` should use.\n  See the related discussion here:\n  [https://delvingbitcoin.org/t/determining-blocktemplate-fee-increase-using-fee-rate-diagram/2052](https://delvingbitcoin.org/t/determining-blocktemplate-fee-increase-using-fee-rate-diagram/2052)\n  This feature depends on cluster mempool.\n\n",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2025-10-31T17:55:33Z",
      "updated_at": "2026-01-13T13:05:44Z",
      "closed_at": null,
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/33758",
      "labels": [
        "Mining",
        "Tracking Issue"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3846,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3748280410,
      "number": 34121,
      "title": "Syncing takes many days with state of the art hardware now - Reviving bootstrapping as a solution?",
      "body": "### Please describe the feature you'd like to see added.\n\nI run the lightning node SilentBob and recently nuked my Bitcoin chainstate or blocks database while trying to fix my issues with running out of disc space.\n\nResyncing turned out to take many days, even on modern hardware. In fact, I'm still waiting two days later with the estimated time remaining constantly switching between many hours, many days or even many weeks at times (13th gen i7 10 core CPU, super fast NVME 2TB SSD, 16 gig ram, 12 gig reserved for bitcoin... 500 Mbit cable connection).\n\nLuckily @C-Otto saved me by providing me with his blocks and chainstate directories and he mentioned that he might be able to provide the same service to others if there is any demand.\n\nSo I thought I should bring this up here and inquire if there is any interest in reviving bootstrapping again, as it has existed until 2014: https://bitcoin.org/bin/block-chain/README.txt\n",
      "state": "closed",
      "user": "viaj3ro",
      "created_at": "2025-12-19T17:39:02Z",
      "updated_at": "2026-01-13T12:12:59Z",
      "closed_at": "2026-01-13T12:12:59Z",
      "comments": 12,
      "url": "https://github.com/bitcoin/bitcoin/issues/34121",
      "labels": [
        "Feature"
      ],
      "comment_data": [
        {
          "id": 3743989448,
          "user": "willcl-ark",
          "body": "Closing as unplanned, because as explained above I don't think there are any plans to re-introduce the bootstrap mechanism now that we have things like assumeutxo snapshotting, and other [related performance improvements](https://github.com/bitcoin/bitcoin/issues/34121#issuecomment-3679297841) in the pipeline. Feel free to continue conversation in here after close, if you like :)\n\nAs mentioned above, assumeutxo is still bottlenecked on validation speed, and therefore not comparable to a \"trusted datadir clone\" in terms of \"sync\" performance, but if you do want to try it out and find the torrent files unreliable or slow, I host some of the more recent snapshot files at https://utxo.download/ for direct download.",
          "created_at": "2026-01-13T12:12:59Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 720,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1032,
        "has_nack": false,
        "has_ack": false
      }
    }
  ],
  "summary": {
    "total_prs": 316,
    "total_issues": 87,
    "total_comments": 87,
    "unique_participants": 125
  }
}