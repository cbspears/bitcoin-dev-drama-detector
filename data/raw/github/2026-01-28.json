{
  "source": "github",
  "repo": "bitcoin/bitcoin",
  "fetched_at": "2026-01-28T16:29:45.603542+00:00",
  "date_range": {
    "since": "2026-01-21T16:29:45.603407+00:00",
    "until": "2026-01-28T16:29:45.603407+00:00"
  },
  "pull_requests": [
    {
      "id": 1587218477,
      "number": 28792,
      "title": "build: Embedded ASMap [3/3]: Build binary dump header file",
      "body": "Depends on https://github.com/bitcoin/bitcoin/pull/33878. This is the third in a tripled of PRs that implement the necessary changes for embedding of asmap data into the binary. This last part add the initial asmap data, implements the build changes and adds further documentation.\r\n\r\nCurrently an asmap file needs to be acquired by there user from some location or the user needs to generate one themselves. Then they need to move the file to the right place in datadir or pass the path to the file as `-asmap=PATH` in order to use the asmap feature. The change here allows for builds to embed asmap data into the bitcoind binary which makes it possible to use the feature without handling of the asmap file by the user. If the user starts bitcoind with `-asmap` the embedded data will be used for bucketing of nodes.\r\n\r\nThe data lives in the repository at `src/node/data/ip_asn.dat` and can be replaced with a new version at any time. The idea is that the data should be updated with every release. By default the data at that location is embedded into the binary but there is also a build option to prevent this (`-DWITH_EMBEDDED_ASMAP=OFF`). In this case the original behavior of the `-asmap` option is maintained.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2023-11-04T22:13:31Z",
      "updated_at": "2026-01-28T16:28:11Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28792",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1277,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3216159492,
      "number": 34424,
      "title": "[RFC] CChain Concurrency Improvement (Base + Tail Architecture)",
      "body": "## RFC: CChain Concurrency Improvement\r\n\r\nThis PR implements a copy-on-write based CChain design to enable concurrent access.\r\n\r\n### Motivation\r\n\r\nCurrent CChain uses a single vector protected by `cs_main`, creating bottlenecks for multi-threaded access. This PR lays the groundwork for removing `cs_main` locks by enabling consistent snapshots without holding locks.\r\n\r\n### Design\r\n\r\nSee full design document: [CChain Concurrency](https://github.com/alexanderwiederin/bitcoinkernel-proposals/blob/master/cchain-concurrency.md)\r\n\r\n**TL;DR:** Split chain into base (bulk of history) + tail (recent ~1,000 blocks). Use nested `stlab::copy_on_write` so updates copy only tail, keeping base shared.\r\n\r\n*Thanks to @purplekarrot for pointing me to `stlab::copy_on_write` and making design suggestions.*\r\n\r\n### Changes\r\n\r\n- Implements copy-on-write based CChain with value semantics\r\n- Removes `cs_main` locks from RPC methods (where possible)\r\n- All validation locks remain in place (`cs_main` still held during validation)\r\n- API unchanged - backward compatible\r\n\r\n### Request for Comments\r\n\r\n1. Is the nested copy-on-write architecture sound?\r\n2. Is `MAX_TAIL_SIZE = 1000` reasonable?\r\n3. What are the concerns for future lock removal?\n4. Is the added complexity worth the benefit?",
      "state": "open",
      "user": "alexanderwiederin",
      "created_at": "2026-01-27T20:44:43Z",
      "updated_at": "2026-01-28T16:27:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34424",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1341,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3120160595,
      "number": 34132,
      "title": "refactor: inline `CCoinsViewErrorCatcher` into `CCoinsViewDB`",
      "body": "### Problem\r\n\r\nThe current coins database read-error handling adds unnecessary complexity to the critical path:\r\n\r\n- `CCoinsViewErrorCatcher` sits between the cache and database views, wrapping every read operation with a generic error handler\r\n- `ExecuteBackedWrapper` adds another function call layer with lambda captures on each database read\r\n-  Uses `std::vector<std::function<void()>>` for callbacks when there's only ever one callback registered\r\n-  The error callback is set after database initialization rather than during construction (requiring a `cs_main` lock)\r\n\r\nThis adds unnecessary stack depth and bookkeeping overhead on every coins database read operation (`GetCoin`). Also note that `CCoinsViewDB::HaveCoin` isn't even called from production code as far as I can tell.\r\n\r\n### Context\r\n\r\nThis is part of ongoing coins caching cleanup efforts like #34124, #33866, #33018, and #33512.\r\n\r\n### Fix\r\n\r\nThis PR collapses the `CCoinsViewErrorCatcher` layer entirely and moves error handling directly into `CCoinsViewDB`:\r\n\r\n- Remove `ExecuteBackedWrapper` and `CCoinsViewErrorCatcher`, placing try-catch blocks directly in `CCoinsViewDB::GetCoin` and `CCoinsViewDB::HaveCoin`\r\n  - this enabled making all coins view lookups as `noexcept`\r\n- Replace `std::vector<std::function<void()>>` with a single `std::function<void()>` member, initialized in the constructor\r\n- The read error callback is now passed to `Chainstate::InitCoinsDB` and forwarded to `CCoinsViewDB` constructor\r\n\r\nA new test is also added to reproduce the behavior in case of database corruption. It's added as a first commit to demonstrate that the behavior stays unchanged.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-12-20T22:56:45Z",
      "updated_at": "2026-01-28T16:25:35Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34132",
      "labels": [
        "Refactoring",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1715,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3113336746,
      "number": 34098,
      "title": "test: [move-only] Move lint functions into modules",
      "body": "The single, large `main.rs` file is fine, but at some point it becomes harder to read.\r\n\r\nSo reduce the size by pulling functions out into modules.\r\n\r\nThis can be reviewed with the git option: `--color-moved=dimmed-zebra`",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-12-18T11:21:05Z",
      "updated_at": "2026-01-28T16:23:19Z",
      "merged_at": "2026-01-28T16:20:29Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34098",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 272,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3219064632,
      "number": 34431,
      "title": "test: node will not try to connect to anchors from an unreachable network",
      "body": "This PR adds a test to check that a node will not try to connect to an anchor from an unreachable network when initializing. It kills and can be tested with the following mutant:\r\n\r\n```diff\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex 6b79e913e8..cd8aa4c502 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -2774,7 +2774,7 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect, std\r\n             if (anchor && !m_anchors.empty()) {\r\n                 const CAddress addr = m_anchors.back();\r\n                 m_anchors.pop_back();\r\n-                if (!addr.IsValid() || IsLocal(addr) || !g_reachable_nets.Contains(addr) ||\r\n+                if (!addr.IsValid() || IsLocal(addr) ||\r\n                     !m_msgproc->HasAllDesirableServiceFlags(addr.nServices) ||\r\n                     outbound_ipv46_peer_netgroups.contains(m_netgroupman.GetGroup(addr))) continue;\r\n                 addrConnect = addr;\r\n```\r\n\r\nAlso, it fixes a bug in `assert_debug_log` which has a timing asymmetry between expected and unexpected message\r\nchecking. When all expected messages were found early, the function would return immediately without waiting for the full timeout period. This created a race condition where unexpected messages appearing after the expected messages (but before the timeout) would not be detected.",
      "state": "open",
      "user": "brunoerg",
      "created_at": "2026-01-28T14:28:35Z",
      "updated_at": "2026-01-28T16:22:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34431",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 1404,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3187604599,
      "number": 34338,
      "title": "ci, iwyu: Fix warnings in `src/zmq` and treat them as errors",
      "body": "This PR [continues](https://github.com/bitcoin/bitcoin/pull/33725#issuecomment-3466897433) the ongoing effort to enforce IWYU warnings.\r\n\r\nPrevious PRs:\r\n- https://github.com/bitcoin/bitcoin/pull/33810\r\n- https://github.com/bitcoin/bitcoin/pull/31308\r\n- https://github.com/bitcoin/bitcoin/pull/34079\r\n- https://github.com/bitcoin/bitcoin/pull/33779\r\n\r\nFor accompanying documentation, please see [Developer Notes](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#using-iwyu).\r\n\r\nAdditionally, this adds a new include category to `src/.clang-format`.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2026-01-19T12:24:27Z",
      "updated_at": "2026-01-28T16:21:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34338",
      "labels": [
        "Refactoring",
        "RPC/REST/ZMQ",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 630,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3218102916,
      "number": 34427,
      "title": "lint: Flatten lint image entry points",
      "body": "Two fixups to the lint container:\r\n\r\n* Add a missing `--platform=linux` to avoid running a non-native arch, like s390x, which happens with podman if such a container was most recently used.\r\n* Flatten the entry points to remove the bash-based one:\r\n\r\nPreviously, an additional entry point into the container that spawned a bash was supported. The bash had an alias `lint` to run all lint scripts. However, such a use-case seems limited (because it only runs inside the container), inflexible (because it only allows running all lint scripts), and possibly brittle (because it can miss re-building the image when the cache is stale). So remove it and just offer the single entry point via the `./ci/lint.py` script.\r\n\r\nIf there is a use-case to skip the image building, it should be trivial to add an env var setting the the lint Python script like `DANGER_SKIP_IMAGE_RE_BUILD=1` (or so) in the future.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-28T10:09:18Z",
      "updated_at": "2026-01-28T16:18:57Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34427",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 939,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3218546135,
      "number": 34429,
      "title": "test: Check that redundant verack message is ignored",
      "body": "The code exists and is uncovered (ref https://maflcko.github.io/b-c-cov/total.coverage/src/net_processing.cpp.gcov.html#L3795), so add a trivial test to cover it.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-28T12:08:11Z",
      "updated_at": "2026-01-28T16:16:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34429",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 215,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2417478258,
      "number": 32138,
      "title": "wallet, rpc: remove settxfee and paytxfee",
      "body": "**Summary**\r\n\r\nThis PR removes the settxfee RPC and paytxfee setting (Bitcoin Core 31.0).\r\nThese two features were deprecated in https://github.com/bitcoin/bitcoin/pull/31278.",
      "state": "open",
      "user": "polespinasa",
      "created_at": "2025-03-25T18:30:56Z",
      "updated_at": "2026-01-28T16:13:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32138",
      "labels": [
        "Wallet",
        "RPC/REST/ZMQ",
        "Needs release note"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 217,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3196609350,
      "number": 34374,
      "title": "kernel: use structured logging and simplify logging interface",
      "body": "tl;dr: kernel logging is cumbersome. This PR enables structured logging and a much simplified kernel logging interface. Closes #34062.\r\n\r\n## Motivation\r\n\r\nThe `bitcoinkernel` library (#27587) [exposes](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L698-L778) functionality to interface with the kernel logging. This includes registering callbacks for log statements, level/category filtering, string formatting options, and more.\r\n\r\nKernel logging has a few problems:\r\n- [callbacks](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L304) operate on formatted strings, so users need to parse the string to get the timestamp, category, level, ... based on which options are set. This is cumbersome, brittle, and inefficient.\r\n- the [filtering interface](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L737) is not really intuitive, requiring users to call combinations of `btck_logging_set_level_category` and `btck_logging_enable_category` when they want to produce `debug` or `trace` logs. The level/category system makes sense for node, because it directly controls what gets written to disk and stdout, and there are quite a lot more categories producing logs. Kernel doesn't really need this - users control what happens to the logs, and can do any filtering/manipulation in the callback they provide.\r\n- the node logging infrastructure has quite a bit more functionality than is necessary for a library, including ratelimiting, log formatting, outputting, buffering, ... This introduces unnecessary code and interface complexity.\r\n\r\n## Approach\r\n\r\nMost of the logic in `logging.h` is not necessary for `bitcoinkernel`, so we first separate it into `util/log.h` and `logging.h` (`common`), then upgrade the `bitcoinkernel` logging interface, and finally remove the `logging.cpp` dependency from kernel entirely.\r\n\r\n1. **Separate log generation**: Add a minimal `util::log::Dispatcher` that is used to generate logs, and forwards structured log entries to registered callbacks. No formatting, rate-limiting, or output handling - that's the consumer's responsibility. Dispatcher can be configured with a `filter` predicate (e.g. `WillLogCategoryLevel()` for `node`, or a simpler levels-based filter for `bitcoinkernel`) to avoid unnecessary string formatting and other overhead.\r\n2. **Register `BCLog::Logger` on Dispatcher**: Register a callback on the global Dispatcher to receive entries and handle node-specific concerns (formatting, rate-limiting, file output) without changing most of its logic.\r\n3. **Move logging macros to `util/log.h`**: Allows the entire codebase (including kernel code) to use the same macros without depending on `logging.h`.\r\n4. **Update bitcoinkernel C API**: Replace the string-based callback with `btck_LogEntry` containing full metadata. Remove `btck_LoggingOptions` and category enable/disable functions. Add `btck_logging_set_min_level()` for early filtering.\r\n5. Move **`logging.cpp` to `common`**: remove it as a kernel dependency entirely.\r\n\r\n## Appendix\r\n\r\n### `bitcoinkernel` C logging interface\r\n\r\n```c\r\nstruct btck_LogEntry {\r\n    const char* message;       //!< Log message\r\n    size_t message_len;        //!< Log message length\r\n    const char* file_name;     //!< Source file name\r\n    size_t file_name_len;      //!< Source file name length\r\n    const char* function_name; //!< Source function name\r\n    size_t function_name_len;  //!< Source function name length\r\n    const char* thread_name;   //!< Thread name\r\n    size_t thread_name_len;    //!< Thread name length\r\n    int64_t timestamp_ns;      //!< Timestamp in nanoseconds since epoch\r\n    uint32_t line;             //!< Source line number\r\n    btck_LogLevel level;       //!< Log level\r\n    btck_LogCategory category; //!< Log category\r\n};\r\n\r\ntypedef void (*btck_LogCallback)(void* user_data, const btck_LogEntry* entry);\r\n\r\nBITCOINKERNEL_API void btck_logging_set_min_level(btck_LogLevel level);\r\n\r\nBITCOINKERNEL_API btck_LoggingConnection* BITCOINKERNEL_WARN_UNUSED_RESULT btck_logging_connection_create(\r\n    btck_LogCallback log_callback,\r\n    void* user_data,\r\n    btck_DestroyCallback user_data_destroy_callback) BITCOINKERNEL_ARG_NONNULL(1);\r\n\r\nBITCOINKERNEL_API void btck_logging_connection_destroy(btck_LoggingConnection* logging_connection);\r\n```\r\n\r\n",
      "state": "open",
      "user": "stickies-v",
      "created_at": "2026-01-21T19:56:44Z",
      "updated_at": "2026-01-28T16:12:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34374",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 4513,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3102178109,
      "number": 34075,
      "title": "fees: Introduce Mempool Based Fee Estimation to reduce overestimation",
      "body": "This PR is another attempt to fix #27995 using a better approach.\r\n\r\nFor background and motivation, see #27995 and the discussion in the Delving Bitcoin post [Mempool Based Fee Estimation on Bitcoin Core](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703)\r\nThis PR is currently limited to using the mempool only to lower what is recommended by the Block Policy Estimator.\r\nAccurate and safe fee estimation using the mempool is challenging. There are open questions about how to prevent mempool games that are theoretically possible for miners [(a variant of the Finney attack)](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/6)\r\n\r\nThis is one of the reasons I opted to use the mempool only to lower the Block Policy Estimator, which itself is not gameable, and therefore this mechanism is not susceptible to this attack.\r\n\r\nThe underlying assumption here is that, with the current tools and work done to make RBF and CPFP feasible and guarantee (TRUC transaction relay, ephemeral anchors, cluster size 2 package rbf), it is safer to underestimate rather than overestimate.\r\nWe now assume it is relatively easy to fee-bump later if a transaction does not confirm, whereas once a fee is overestimated there is no way to recover from that.\r\n\r\nAnother open question when using the mempool for fee estimation is how to account for incoming transaction inflow.\r\n[Bitcoin Augur](https://github.com/block/bitcoin-augur) does this by using past inflow plus a constant expected inflow to predict future inflow. I find this unconvincing for fee estimation and potentially prone to more overestimation, as past conditions are not always representative of the future. See my [review of the Augur fee rate estimator and open questions](https://github.com/block/bitcoin-augur/issues/3).\r\n\r\nThis PR uses a much simpler approach based on current user behavior, similar to the widely used method employed by mempool.space: looking at the top block of the mempool and selecting a percentile feerate depending on whether the user is economical or conservative.\r\n\r\nEmpirical data from both myself and Clara Shikhelman shows that the 75th percentile feerate for economical users and the 50th percentile feerate for conservative users provide positive confirmation guarantees, hence this is what is used in this PR.\r\n\r\nParallel research by René Pickhardt and his student suggests that using the [average fee per byte of the block template performs well](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/12).\r\n\r\nAll of these are constants that can be adjusted, there is parallel work exploring these constants and running benchmarks across fee estimators to find a sweet spot.\r\n\r\nSee also work in LND, the [LND Budget Sweeper](https://delvingbitcoin.org/t/lnds-deadline-aware-budget-sweeper/1512), which applies this idea successfully. Their approach is to estimate fees initially with bitcoind, then increment gradually as the confirmation deadline approaches, using a fixed fee budget.\r\n\r\nHistorical data indicates that by doing only the approach in this PR, we are able to [reduce overestimation quite significantly (~29%)](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/8).\r\n\r\nThis is particularly useful in scenarios where the Block Policy Estimator recommends a high feerate while the mempool is empty.\r\n<img width=\"1800\" height=\"1090\" alt=\"56f3ba26c0184521c42bb82ec9d8c9f2224d4f8e\" src=\"https://github.com/user-attachments/assets/c035c40c-8ece-42a7-b290-d29f1ac9bf4d\" />\r\n\r\nAs seen in the image above, there is only one remaining unfixed case: when there is a sudden inflow of transactions and the feerate rises, the Block Policy Estimator takes time to reflect this. In that case, users will continue to see a low feerate estimate until it slowly updates. From the historical data linked above, [this occurs about ~26% of the time](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/8)).\r\n\r\nOverall, we observe a **73% success rate with 0% overestimation, and 26% underestimation** with this approach.\r\n\r\nThis PR also includes refactors that enable this work. Rather than splitting the PR and implementing changes incrementally, I opted for an end-to-end implementation:\r\n\r\n### 1. Refactors\r\n\r\n* Separation of feerate format from the fee estimate mode enumerator (separation of concerns, as they are semantically distinct)\r\n* Move logging after fee estimation estimateSmartFee from the wallet to the Block Policy Estimator internal method (also separation of concerns and avoiding leaking fee estimator internals). This change also comes with updating `createTransactionInternal` to log only the fee and its source (fee estimator, fallback fee, etc.), which is more appropriate.\r\n* Separate the fee estimate mode enum from the fee source enumerator (separation of concerns, as they are semantically distinct). This introduces a minor breaking change: the wallet RPCs now return fee *source* instead of fee *reason*, which is more accurate. Let me know if we prefer to keep the field name unchanged while returning the fee source.\r\n* Move the `StringForReason` enum from `common` to the Block Policy Estimator (also separation of concerns)\r\n* Various test file updates and renames for improved accuracy\r\n* Update Block Policy Estimator unit tests to be independent of the mempool and the validation interface\r\n\r\n### 2. Introduce Mempool-Based Fee Estimator and Fee Estimator Manager\r\n\r\n* Introduce a new abstract fee estimator base class that all fee estimators must implement\r\n\r\n* Introduce `FeeRateEstimateResult` as the response type, containing metadata and avoiding the use of out-parameters. This is easily extensible and makes future changes less invasive, as method signatures do not need to change.\r\n\r\n* Add `FeeEstimatorType` enum to identify different fee estimators\r\n\r\n* Make `CBlockPolicyEstimator` derive from the new fee estimator base class\r\n\r\n* Add `FeeRateEstimatorManager`, responsible for managing all fee estimators\r\n\r\n* Update the node context to store a `unique_ptr` to `FeeRateEstimatorManager` instead of `CBlockPolicyEstimator`\r\n\r\n* Update `CBlockPolicyEstimator` to no longer subscribe directly to the validation interface; instead, `FeeRateEstimatorManager` subscribes and forwards relevant notifications\r\n\r\n* Add a percentile calculation function that takes the chunk feerates of a block template and returns feerate percentiles; this can also be reused by the `getblockstats` RPC\r\n\r\n* Add a mempool fee estimator that generates a block template when called, calculates a percentile feerate, and returns the 75th percentile for economical mode or the 50th percentile for conservative mode\r\n\r\n* Add caching to the mempool estimator so that new estimates are generated only every 7 seconds, assuming enough [transactions have propagated](https://bitcoin.stackexchange.com/questions/125776/how-long-does-it-take-for-a-transaction-to-propagate-through-the-network/125777#125777) to make a meaningful difference.\r\n  This heuristic will likely be replaced by requesting block templates via the general-purpose block template cache proposed here: [https://github.com/bitcoin/bitcoin/issues/33389](https://github.com/bitcoin/bitcoin/issues/33389)\r\n\r\n* Update `MempoolTransactionRemovedForBlock` to return the actual block transactions as well\r\n\r\n* Track the weight of block transactions and evicted transactions after each block connection\r\n  This data is tracked for the last 6 mined blocks. A mempool feerate estimate is returned only when the average ratio of mempool transaction weight evicted due to `BLOCK` reasons to block transaction weight is greater than 75%. This heuristic provides rough confidence that the node’s mempool matches that of the majority of the hashrate. The 75% threshold is arbitrary and can be adjusted.\r\n\r\nThere is a caveat when transactions in the local mempool are consistently not mined by the network, as described in #27995 (e.g., due to filtering).\r\nAccounting for these transactions during fee estimation is not necessary, as they should be evicted from the mempool itself (see #33510). Handling this again within fee estimation would be redundant.\r\n\r\n* Persist statistics for the 6 most recent blocks to disk during periodic flushes and shutdown, so this data is available after restarts\r\n* Expose this data to users when running `estimatesmartfee` with verbosity > 2\r\n\r\n<details>\r\n<summary>see example output</summary>\r\n\r\n```\r\nbitcoin-cli estimatesmartfee 1 \"conservative\" 2\r\n```\r\n\r\n```\r\n{\r\n  \"feerate\": 0.00002133,\r\n  \"errors\": [],\r\n  \"blocks\": 2,\r\n  \"mempool_health_statistics\": [\r\n    {\r\n      \"block_height\": 927953,\r\n      \"block_weight\": 3991729,\r\n      \"mempool_txs_weight\": 3942409,\r\n      \"ratio\": 0.987644451815241\r\n    },\r\n    ...\r\n  ]\r\n}\r\n```\r\n\r\n</details>",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2025-12-15T11:53:35Z",
      "updated_at": "2026-01-28T16:12:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34075",
      "labels": [
        "TX fees and policy"
      ],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 1,
        "text_length": 8927,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3191559491,
      "number": 34352,
      "title": "ci, iwyu: Fix warnings in `src/primitives` and treat them as errors",
      "body": "This PR [continues](https://github.com/bitcoin/bitcoin/pull/33725#issuecomment-3466897433) the ongoing effort to enforce IWYU warnings.\r\n\r\nSee [Developer Notes](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#using-iwyu).",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-01-20T14:47:11Z",
      "updated_at": "2026-01-28T16:08:42Z",
      "merged_at": "2026-01-28T16:08:42Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34352",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 311,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3215348124,
      "number": 34421,
      "title": "[RFC] ci: add Chimera Linux LTO job",
      "body": "Adds a CI job based on using [Chimera Linux](https://chimera-linux.org/). This might be interesting for any of the following:\r\n* Chimera is based on LLVM & musl libc - we test both of these in isolation, but not together.\r\n* No GNU components. I don't think we have an existing Linux CI job that doesn't have a gcc/stdlibc++ install. This exercises the depends logic for a fully LLVM/Clang/lld only build, including building the native tools (related to #33902).\r\n* We don't currently have a job with LTO enabled (here using CMakes `CMAKE_INTERPROCEDURAL_OPTIMIZATION`, which is `-flto=thin` for LLVM/Clang). I think this is worth having generally (we do use LTO in some other places, like oss-fuzz). If runtime is too much of an issue, then it could also be dropped. (Chimera itself is also compiled with LTO).\r\n\r\nQT in depends doesn't build, so is excluded for now:\r\n```bash\r\n/bitcoin/depends/work/build/aarch64-unknown-linux-musl/qt/6.7.3-fbcd806db9a/qtbase/src/corelib/thread/qyieldcpu.h:35:5: note: include the header <arm_acle.h> or explicitly provide a declaration for '__yield'\r\n/bitcoin/depends/work/build/aarch64-unknown-linux-musl/qt/6.7.3-fbcd806db9a/qtbase/src/corelib/tools/qhash.cpp:1452:45: error: 'memcpy' called with `n` bigger than the size of `d`.\r\n 1452 |         memcpy(&k, &key, sizeof(long double));\r\n      |                                             ^\r\n/usr/include/fortify/string.h:48:1: note: from 'diagnose_if' attribute on 'memcpy':\r\n   48 | __error_if((__fh_bos(__od, 0) < __n), \"'memcpy' called with `n` bigger than the size of `d`.\")\r\n      | ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n/usr/include/fortify/fortify-headers.h:120:47: note: expanded from macro '__error_if'\r\n  120 | #define __error_if(cond, msg) __attribute__ ((diagnose_if (cond, msg, \"error\")))\r\n      |                                               ^            ~~~~\r\n1 warning and 1 error generated.\r\n```\r\n\r\nIf anything, this pointed out at least a few quirks, i.e #34390 & #34408.\r\n\r\nBased on #34408.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-27T16:41:57Z",
      "updated_at": "2026-01-28T16:05:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34421",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2093,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2837615883,
      "number": 33421,
      "title": "node: add  `BlockTemplateCache`",
      "body": "This PR implements the first step of #33758 by adding a cache layer for node block templates.\r\n\r\nThe cache stores newly created block templates along with their configuration options. When clients request a block template, they specify the maximum age in `MillisecondsDouble`:\r\n- If a matching template (block template with identical block creation option) exists in the cache and hasn't exceeded the age limit, the cached version is returned (if multiple exist, the most recent one is returned).\r\n- If no matching template exists or the age limit has been exceeded, a new template is generated, cached, and returned.\r\n\r\nThe cache maintains a configurable maximum size (default: 10 templates). When this limit is exceeded, the oldest template is evicted. This is usually checked after each insertion.\r\n\r\nThe cache subscribes to the validation interface and clears itself when blocks are connected (to non-historical chainstate to avoid clearing during assumeutxo background validation) or disconnected from the active chain (during reorgs), preventing stale or invalid templates from being served.\r\n\r\nThis PR also removes an unused `node/context.h` import from miner to prevent a potential circular dependency during exposing the block template cache to the node context.\r\n",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2025-09-17T18:47:09Z",
      "updated_at": "2026-01-28T15:58:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33421",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1305,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3203349197,
      "number": 34391,
      "title": "lint: upgrade lint scripts for worktrees",
      "body": "Fixes #29972\r\n\r\nUse a single script to run the linter locally or in CI.\r\n\r\nWorks from inside a worktree.\r\n",
      "state": "closed",
      "user": "willcl-ark",
      "created_at": "2026-01-23T13:42:59Z",
      "updated_at": "2026-01-28T15:16:01Z",
      "merged_at": "2026-01-28T09:51:26Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34391",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 147,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2293116283,
      "number": 31713,
      "title": "miniscript refactor: Remove unique_ptr-indirection",
      "body": "Removes one level of unnecessary indirection, which was a change that originally [aided in finding one issue](https://github.com/bitcoin/bitcoin/pull/30866#pullrequestreview-2434704657) in #30866. Simplifies the code one step further than 09a1875ad8cddeb17c19af34b8282d37fed0937e belonging to aforementioned PR.\r\n\r\nAlso adds test which verifies resistance to stack overflow when it comes to `~Node()` and `Node::Clone()`.\r\n\r\nNo observed difference when running benchmarks: ExpandDescriptor/WalletIsMineDescriptors/WalletIsMineMigratedDescriptors/WalletLoadingDescriptors.\r\n\r\nFollowup to #30866.",
      "state": "open",
      "user": "hodlinator",
      "created_at": "2025-01-22T21:16:33Z",
      "updated_at": "2026-01-28T15:06:50Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31713",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 645,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3138438378,
      "number": 34184,
      "title": "mining: add cooldown to createNewBlock() immediately after IBD",
      "body": "At startup `isInitialBlockDownload()` stops returning true once there’s less than a day of blocks left to sync. Connected mining clients will receive a flood of new templates as these last blocks are connected.\r\n\r\nFix this by briefly pausing block template creation while the best header chain is ahead of the tip. If no tip update happens for one second, we stop waiting.\r\n\r\nIt's not safe to keep waiting, because a malicious miner could announce a header and delay revealing the block, causing all other miners using this software to stall.\r\n\r\nThe cooldown only applies to `createNewBlock()`, which is typically called once per connected client; `waitNext()` remains unchanged.\r\n\r\nFixes #33994\r\n\r\n",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-12-31T05:17:32Z",
      "updated_at": "2026-01-28T15:06:04Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34184",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 762,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3199348260,
      "number": 34381,
      "title": "script: return proper error for `CScriptNum` errors",
      "body": "When evaluating a script, the current code is bad for analyzing some errors because it returns `SCRIPT_ERR_UNKNOWN_ERROR` for errors that are clearly known. \r\n\r\n`CScriptNum` has two well defined errors: number overflow and non-minimally encoded number. However, for both errors we return as unknown. This PR changes it by adding a new ScriptError that is used for any `CScriptNum` error.",
      "state": "open",
      "user": "brunoerg",
      "created_at": "2026-01-22T13:16:34Z",
      "updated_at": "2026-01-28T14:58:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34381",
      "labels": [
        "Consensus"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 439,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3086363450,
      "number": 34036,
      "title": "contrib: update macOS SDK to Xcode-26.1.1-17B100",
      "body": "Updates the macOS SDK used for Guix builds to `Xcode-26.1.1-17B100`. \r\nCloses #34034.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2025-12-09T16:45:55Z",
      "updated_at": "2026-01-28T14:58:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34036",
      "labels": [
        "Scripts and tools",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 134,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1685623460,
      "number": 29278,
      "title": "Wallet:  Add `maxfeerate` wallet startup option",
      "body": "This PR fixes #29220\r\n\r\n- The PR adds a wallet `-maxfeerate` startup option, as the upper limit of wallet transactions fee rate.\r\n\r\n- This fixes the ambiguity of using `maxtxfee` value to check the upper limit of transactions fee rate.\r\n\r\n-  Wallet will not create a transaction with fee rate above `maxfeerate` value. And you can not set wallet fee rate with `settxfee` RPC above `maxfeerate` value.\r\n\r\n- This PR adds a functional test that ensure the behavior is enforced.\r\n \r\n\r\n\r\n",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2024-01-18T22:23:49Z",
      "updated_at": "2026-01-28T14:57:52Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29278",
      "labels": [
        "RPC/REST/ZMQ",
        "Needs rebase",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 531,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2803909911,
      "number": 33324,
      "title": "blocks: add `-reobfuscate-blocks` argument to enable (de)obfuscating existing blocks",
      "body": "### Context\r\n\r\nRecent discussions highlighted that many nodes which synced before Bitcoin Core v28 have their block and undo files stored effectively in the clear (zero XOR key). This patch adds a simple, resumable maintenance tool to obfuscate previously raw block files, rotate an existing key to a fresh random one, or de-obfuscate (set key to zero) if consciously chosen, all without requiring resync. The operation can be cancelled and restarted safely.\r\n\r\n### Implementation\r\n\r\nThe new startup option `-reobfuscate-blocks[=VALUE]` accepts either 16 hex characters as an exact 8-byte XOR key (little-endian in-memory layout) or a boolean to generate a random 64-bit key. e.g. `-reobfuscate-blocks=0000000000000000` sets the key to zero, effectively removing obfuscation.\r\n\r\nIf we detect unobfuscated blocks at start time we suggest this new option in a warning.\r\n\r\nAt startup, we iterate over all undo and block files (grouping the block and undo files for more uniform iteration), read them with the old XOR key and write them back with the new key (`<name>.reobfuscated`). The implementation actually combines the two keys and reads directly into the new obfuscated version to only do a single iteration over the data. This works if the original blocks aren't obfuscated or if the new blocks aren't or if both are.\r\nAfter successful write, we immediately delete the old file. Once all files are staged, we rename them back and atomically swap `xor.dat.reobfuscated` → `xor.dat` and continue operation.\r\n\r\nWe log the old and new keys and print progress roughly per-percent as files complete (i.e. max 100 progress logs).\r\n\r\n### Constraints\r\n\r\n* Re-obfuscation resumes automatically (detected via `xor.dat.reobfuscated`) even without the flag. In worst-case a crash should only force us to redo previous work.\r\n* Single-threaded, processing one file at a time to keep code simple and avoid complexity of interleaving renames and key swaps across threads.\r\n* Fast in practice with sequential read/modify/write per blockfile - after recent obfuscation vectorization, this path is very quick.\r\n\r\n### Reproducer\r\n\r\n```bash\r\ncmake -B build -DBUILD_GUI=ON && cmake --build build -j$(nproc)\r\n# command line\r\n./build/bin/bitcoind -reobfuscate-blocks -stopatheight=1\r\n# same with GUI\r\n./build/bin/bitcoin-qt -reobfuscate-blocks -stopatheight=1\r\n```\r\n\r\n### Single-threaded Performance\r\n\r\n cpu                 | hdd/ssd | block count | size    | files  | time (min) | blocks/min \r\n---------------------|---------|-------------|---------|--------|------------|------------\r\n Apple M4 Max laptop | SSD     | ~909k       | ~707 GB | 9,982  | 8.4        | 146,613    \r\n Intel Core i9       | SSD     | ~909k       | ~725 GB | 10,238 | 23.1       | 39,351     \r\n Raspberry Pi 5      | SSD     | ~914k       | ~728 GB | 10,276 | 72.78      | 12,558     \r\n Intel Core i7       | HDD     | ~909k       | ~720 GB | 10,156 | 208.7      | 4,356      \r\n Raspberry Pi 4B     | HDD     | ~915k       | ~730 GB | 10,304 | 1467       | 624        \r\n\r\n----\r\n\r\nSimilar work:\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/32451\r\n* https://github.com/andrewtoth/blocks-xor\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-09-05T23:51:29Z",
      "updated_at": "2026-01-28T14:46:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33324",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3232,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3210330346,
      "number": 34409,
      "title": "test: use `ModuleNotFoundError` in `interface_ipc.py`",
      "body": "Change this so we catch the case where the capnp shared libs have been updated, and can no-longer be loaded by the Python module, resulting in a skipped test, even though pycapnp is installed. i.e:\r\n```bash\r\nstderr:\r\nTraceback (most recent call last):\r\n  File \"/root/ci_scratch/build/test/functional/interface_ipc.py\", line 20, in <module>\r\n    import capnp  # type: ignore[import] # noqa: F401\r\n    ^^^^^^^^^^^^\r\n  File \"/usr/local/lib64/python3.14/site-packages/capnp/__init__.py\", line 36, in <module>\r\n    from .version import version as __version__\r\n  File \"/usr/local/lib64/python3.14/site-packages/capnp/version.py\", line 1, in <module>\r\n    from .lib.capnp import _CAPNP_VERSION_MAJOR as LIBCAPNP_VERSION_MAJOR  # noqa: F401\r\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nImportError: libcapnpc.so.1.0.1: cannot open shared object file: No such file or directory\r\n```\r\n\r\nFailing in this way should make it clear that `pycapnp` needs to be reinstalled/rebuilt.\r\n\r\nIf  `pycapnp` is not installed, the test still skips as expected:\r\n```bash\r\nRemaining jobs: [interface_ipc.py]\r\n1/1 - interface_ipc.py skipped (capnp module not available.)\r\n\r\nTEST             | STATUS    | DURATION\r\n\r\ninterface_ipc.py | ○ Skipped | 0 s\r\n```\r\n\r\nFixes: #34016.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-26T11:58:41Z",
      "updated_at": "2026-01-28T14:44:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34409",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1330,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3211171533,
      "number": 34413,
      "title": "doc: Remove outdated -fdebug-prefix-map section in dev notes",
      "body": "This removes some docs. See the commit messages for an explanation.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-26T16:17:46Z",
      "updated_at": "2026-01-28T14:33:17Z",
      "merged_at": "2026-01-27T17:32:46Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34413",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 128,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3173543618,
      "number": 34283,
      "title": "[30.x] More backports",
      "body": "Backports:\r\n* #34185\r\n* #34272\r\n* #34252\r\n* #34281\r\n* #34282\r\n* #34344\r\n* #34390\r\n* #34413",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-14T13:32:45Z",
      "updated_at": "2026-01-28T14:33:01Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34283",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 112,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3218887541,
      "number": 34430,
      "title": "ci: mount git directory as writable in linter",
      "body": "On merges to master we set LINT_CI_SANITY_CHECK_COMMIT_SIG (when \"GITHUB_REPOSITORY == bitcoin/bitcoin\") which runs verify-commits.py.\r\n\r\nThis requires write access to the .git directory.\r\nMake the mounted .git directory writable.\r\n\r\nThis is currently not run on PR branches or locally which caused a miss during review.\r\n\r\nIdeally we can have the same checks running in PRs as on merges to master to avoid future discrepancies like this.",
      "state": "closed",
      "user": "willcl-ark",
      "created_at": "2026-01-28T13:45:26Z",
      "updated_at": "2026-01-28T14:19:35Z",
      "merged_at": "2026-01-28T14:16:38Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34430",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 484,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2640910930,
      "number": 32875,
      "title": "index: handle case where pindex_prev equals chain tip in NextSyncBlock()",
      "body": "`NextSyncBlock()` is for getting the next to-sync block to build index. The current master code handles a specific case in a wrong way: when pindex_prev is the chain tip, `NextSyncBlock()` does handle it in \r\n```\r\n163     // Since block is not in the chain, return the next block in the chain AFTER the last common ancestor.\r\n164     // Caller will be responsible for rewinding back to the common ancestor.     \r\n165     return chain.Next(chain.FindFork(pindex_prev));                              \r\n\r\n```\r\n but line 165 is for reorg not for `pindex_prev == chain tip` as the comment suggested. So when pindex_prev is the chain tip, return earlier and explicitly rather than mixing it with the reorg case (the above code)\r\n\r\n",
      "state": "open",
      "user": "HowHsu",
      "created_at": "2025-07-04T10:03:17Z",
      "updated_at": "2026-01-28T14:18:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32875",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 798,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2908274346,
      "number": 33604,
      "title": "p2p: Allow block downloads from peers without snapshot block after assumeutxo validation",
      "body": "Currently, after assumeutxo background validation finishes, the node continues to skip peers that don't have the snapshot block in their best chain until restart. This unnecessarily excludes peers from block downloads even though the background sync has completed and undo data is available.\r\n\r\nThe restriction persists because `m_chainman.CurrentChainstate().SnapshotBase()` continues to return the snapshot base block until restart, even after validation completes. Added `m_chainman.CurrentChainstate().m_assumeutxo == Assumeutxo::UNVALIDATED` check to only apply the peer restriction while background validation is ongoing. \r\n\r\nAlso added test coverage in `feature_assumeutxo.py` that verifies peers without the snapshot block can be used for block downloads after background validation completes. The test fails without this fix.",
      "state": "open",
      "user": "stringintech",
      "created_at": "2025-10-12T20:36:02Z",
      "updated_at": "2026-01-28T14:09:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33604",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 923,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2563709776,
      "number": 32672,
      "title": "ci: update pwsh to use custom shell that fails-fast",
      "body": "Github by default sets [fail fast](https://docs.github.com/en/actions/writing-workflows/workflow-syntax-for-github-actions#exit-codes-and-error-action-preference) behaviour on pswh shell which means that if any powershell cmdlet fails the script will stop and exit. The problem is that this behaviour doesn't apply when calling native executables, it only applies to powershell cmdlets.\r\n\r\nI think the safest thing is to whenever we use pwsh to enable `$PSNativeCommandUseErrorActionPreference = $true` which will also fail calling any exe that returns a non-zero exit code.\r\n\r\nTechnically the step `Adjust paths in test/config.ini` only uses cmdlets so this step will not benefit from this change but I feel like it's good practice to still enable this feature in case this script gets modified in the future to call an exe.\r\n\r\nHere is a CI run that has a script that fails silently (look at Windows Native, VS 2022 -> Get tool information): https://github.com/m3dwards/bitcoin/actions/runs/15415032095/job/43375709475\r\nAnd with this change applied, the script correctly fails: https://github.com/m3dwards/bitcoin/actions/runs/15416585565/job/43380685364",
      "state": "open",
      "user": "m3dwards",
      "created_at": "2025-06-03T12:03:44Z",
      "updated_at": "2026-01-28T14:07:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32672",
      "labels": [
        "Windows",
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1207,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3177081870,
      "number": 34303,
      "title": "test: addrman: test self-announcement time penalty handling",
      "body": "This PR adds a test case for addrman that verifies that addresses announcing themselves (addr == source) are exempt from time penalties, while addresses announced by others receive the expected penalty. \r\n\r\nIt fixes the following mutant (https://corecheck.dev/mutation/src/addrman.cpp#L561):\r\n```diff\r\ndiff --git a/src/addrman.cpp b/src/addrman.cpp\r\nindex 206b54118e..c6a045fd8d 100644\r\n--- a/src/addrman.cpp\r\n+++ b/src/addrman.cpp\r\n@@ -558,7 +558,7 @@ bool AddrManImpl::AddSingle(const CAddress& addr, const CNetAddr& source, std::c\r\n     AddrInfo* pinfo = Find(addr, &nId);\r\n\r\n     // Do not set a penalty for a source's self-announcement\r\n-    if (addr == source) {\r\n+    if (addr != source) {\r\n         time_penalty = 0s;\r\n     }\r\n```\r\n",
      "state": "open",
      "user": "brunoerg",
      "created_at": "2026-01-15T12:07:32Z",
      "updated_at": "2026-01-28T14:02:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34303",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 800,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2856019872,
      "number": 33472,
      "title": "guix: documented shasum gathering command",
      "body": "When a PR requires proof of Guix builds (sha256sums), the PR author or reviewer uses a not well documented command to collect the sha256sums of build outputs or manually gathers them from files.\r\n\r\nThis pull request introduces a new section in the documentation, providing some documentation on the command's functionality and usage.",
      "state": "open",
      "user": "janb84",
      "created_at": "2025-09-24T08:41:36Z",
      "updated_at": "2026-01-28T14:00:01Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33472",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 375,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3196490786,
      "number": 34373,
      "title": "refactor: Remove remaining std::bind, check via clang-tidy",
      "body": "`std::bind` has many issues:\r\n\r\n* It is verbose in a meaningless way\r\n* Overriden args are silently accepted and dropped at runtime without a compile error. Same for accidental duplicates.\r\n\r\nOne could use `std::bind_front` similar to commit fa267551c4eaef577db92e248c4b6d31d0c8bc77. Though, I think the remaining cases are better off with lambdas.\r\n\r\nSo do that here, and enable the `modernize-avoid-bind` clang-tidy rule to avoid `std::bind` bugs in the future.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-21T19:14:44Z",
      "updated_at": "2026-01-28T13:45:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34373",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 522,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2498563333,
      "number": 32420,
      "title": "miner: drop dummy extraNonce in coinbase scriptSig for templates requested via IPC",
      "body": "Our miner code adds `OP_0` as a dummy `extraNonce` to the coinbase `scriptSig`. This has been in place since v0.1.0 and removing it entirely would trigger the `bad-cb-length` consensus error on test networks for blocks 1 through 16 (`OP1` through `OP_16`).\r\n\r\nPreviously the coinbase transaction generated by our miner code was not used downstream, because the `getblocktemplate` RPC excludes it. Since the Mining IPC interface was introduced in #30200 we do expose this dummy coinbase transaction. In Stratum v2 several parts of it are communicated downstream, including the `scriptSig`.\r\n\r\nThis PR adds a `include_dummy_extranonce` option which is `false` by default, but for the time being all test code opts in to it. This avoids churning hardcoded block and transaction hashes.\r\n\r\nThe effect of having the default `false` for IPC callers is that we remove the dummy `extraNonce` from the coinbase `scriptSig` in block templates requested that way. This limits the `scriptSig` to what is essential for consensus (BIP34) and removes the need for external mining software to remove the dummy, or even ignore the `scriptSig` we provide and generate it some other way. This could cause problems if a future soft fork requires additional data to be committed here.\r\n\r\n`test/functional/interface_ipc.py` is expanded to verify the new IPC behavior.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-05-05T12:01:31Z",
      "updated_at": "2026-01-28T13:43:41Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32420",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1428,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2913595315,
      "number": 33622,
      "title": "docs: add doc comment for SRD selection algorithm",
      "body": "The params documentation is missing `change_fee` and the description is lacking recent changes.",
      "state": "closed",
      "user": "yancyribbens",
      "created_at": "2025-10-14T13:05:59Z",
      "updated_at": "2026-01-28T13:38:32Z",
      "merged_at": "2026-01-28T13:38:32Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33622",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 145,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2545149066,
      "number": 32621,
      "title": "contrib: utxo_to_sqlite.py: add option to store txid/spk as BLOBs",
      "body": "This PR is a late follow-up to https://github.com/bitcoin/bitcoin/pull/27432, introducing an option for the utxo-to-sqlite script to store the txid/scriptPubKey columns as bytes (= `BLOB` storage class in sqlite, see e.g. https://www.sqlite.org/datatype3.html in sqlite) rather than hex strings. This was proposed in earlier reviews (https://github.com/bitcoin/bitcoin/pull/27432#issuecomment-1516857024, https://github.com/bitcoin/bitcoin/pull/27432#issuecomment-1653739351) and has the obvious advantage of a significantly smaller size of the resulting database (and with that, faster conversion) and the avoidance of hex-to-bytes conversion for further processing of the data [1]. The rationale on why hex strings were chosen back then (and still stays the default, if only for compatibility reasons) is laid out in https://github.com/bitcoin/bitcoin/pull/27432#issuecomment-1516922824 [2].\r\n\r\nThe approach taken is introducing new parameters `--spk` and `--txid` which can either have the values \"hex\", \"raw\" (for scriptpubkey) and \"hex\", \"raw\", \"rawle\" (for txid). Thanks to ajtowns for providing this suggestion. Happy to take further inputs on naming and thoughts on future extensibility etc.\r\n\r\n[1] For a concrete example, I found that having these columns as bytes would be nice while working on a SwiftSync hints generator tool (https://github.com/theStack/swiftsync-hints-gen), which takes the result of the utxo-to-sqlite tool as input.\r\n[2] note that in contrast what I wrote back then, I think there is no ambiguity on byte-string-serialization of txids; they are ultimately just hash results and hence, they should be stored as such, and adding a big/little endian knob wouldn't make much sense. The drawback of not being able to immediately show txid-strings (as one would need to do the bytes-reversal step first, which is not possible in sqlite, see e.g. https://github.com/bitcoin/bitcoin/pull/24952#issuecomment-1165499803) still remains though.",
      "state": "open",
      "user": "theStack",
      "created_at": "2025-05-27T03:03:35Z",
      "updated_at": "2026-01-28T13:37:51Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32621",
      "labels": [
        "Scripts and tools"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2031,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3210441228,
      "number": 34411,
      "title": "[POC] Full Libevent removal",
      "body": "This builds on all the work being done by pinheadmz and fjahr (#32061, #34342, #34158), to demo a libevent-less bitcoind.\r\n\r\nOne thing we could decide to change, or not, is the `libevent` logging catergory. Other than that, any remaining references to libevent, should be in documentation/code comments.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-26T12:35:26Z",
      "updated_at": "2026-01-28T13:37:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34411",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 331,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3210283130,
      "number": 34408,
      "title": "ci: remove gnu-getopt usage",
      "body": "This is used for argument parsing in the `retry` script, however we don't use the script with any arguments. So remove the unused code, and the dependency on `gnu-getopt`.\r\n\r\nThis came up in the context of adding new CI jobs, where gnu-getopt might not be available, or working properly. It seemed easier to just remove the unused code, than look for more workarounds.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-01-26T11:40:54Z",
      "updated_at": "2026-01-28T13:30:37Z",
      "merged_at": "2026-01-28T13:26:37Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34408",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 396,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2516937442,
      "number": 32482,
      "title": "build: add `-W*-whitespace`",
      "body": "GCC 15 now has options to turn leading & trailing whitespace into compile failures: https://gcc.gnu.org/gcc-15/changes.html#c-family. Fix the few cases of leading tabs, and trailing whitespace, and then enable `-Wleading-whitespace` and `-Wtrailing-whitespace`.\r\n\r\nWe currently get PRs that are opened with various whitespace, i.e #33822, so turning that into compile-time failure where possible, seems useful, to avoid a CI roundtrip.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-05-13T15:13:05Z",
      "updated_at": "2026-01-28T13:20:31Z",
      "merged_at": "2025-11-12T10:53:52Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32482",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 463,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3170621319,
      "number": 34276,
      "title": "Remove empty caption from user interface (noui, gui)",
      "body": "Currently, the user interface (noui, gui) has a caption for each message. However, the caption has many issues:\r\n\r\n* It is always hard-coded to the empty string.\r\n* This is confusing and tedious when reading or maintaining the code.\r\n* It is redundant, because `noui` will ignore the caption and set the logging prefix (error, warning, info) based on the `style`.\r\n* The gui does prefer to set the title based on the caption, but since it the caption is always empty, the fallback will always be used.\r\n\r\nFix all issues by removing it.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-13T17:34:40Z",
      "updated_at": "2026-01-28T13:12:37Z",
      "merged_at": "2026-01-28T12:44:08Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34276",
      "labels": [
        "Utils/log/libs",
        "interfaces"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 588,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3203351683,
      "number": 34392,
      "title": "test: Add test runner option --ignore-self-check-warnings",
      "body": "This should make it easier to run all listed tests, when a dev has an additional local test, but does not want to add it to the test runner list.\r\n\r\nCan be tested via:\r\n\r\n```sh\r\n$ touch ./test/functional/a.py\r\n$ ./bld-cmake/test/functional/test_runner.py wallet_disable\r\n\r\n(It should print an error message and the error message has instructions how to skip it)\r\n",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-23T13:43:36Z",
      "updated_at": "2026-01-28T12:12:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34392",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 421,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1185011431,
      "number": 26812,
      "title": "test: add end-to-end tests for CConnman and PeerManager",
      "body": "Add unit tests that write data to a mocked socket and inspect what CConnman/PeerManager have written back to the socket, or check the internal state to verify that the behavior is as expected.\r\n\r\nThis is now possible, after most of https://github.com/bitcoin/bitcoin/pull/21878 has been merged - we don't do any syscalls (e.g. `connect()`, `recv()`) from the high level code and using a mocked socket allows testing the entire networking stack without opening actual network connections.",
      "state": "open",
      "user": "vasild",
      "created_at": "2023-01-04T14:39:37Z",
      "updated_at": "2026-01-28T12:09:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/26812",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 543,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2501800868,
      "number": 32427,
      "title": "(RFC) kernel: Replace leveldb-based BlockTreeDB with flat-file based store",
      "body": "Opening this PR mostly to get concept/approach feedback.\r\n\r\nThis is motivated by the kernel library, where the internal usage of leveldb is a limiting factor to its future use cases. Specifically it is not possible to share leveldb databases between two processes. A notable use-case for the kernel library is accessing and analyzing existing block data. Currently this can only be done by first shutting down the node writing this data. Moving away from leveldb opens the door towards doing this in parallel. A flat file based approach was chosen, since the requirements for persistence here are fairly simple (no deletion, constant-size entries). The change also offers better performance by making node startup faster, and has a smaller on-disk footprint, though this is negligible in the grand scheme of things.\r\n\r\nThe BlockTreeStore introduces a new data format for storing block indexes and headers on disk. The class is very similar to the existing CBlockTreeDB, which stores the same data in a leveldb database. Unlike CBlockTreeDB, the data stored through the BlockTreeStore is directly serialized and written to flat .dat files. The storage schema introduced\r\nis simple. It relies on the assumption that no entry is ever deleted and that no duplicate entries are written. These assumptions hold for the current users of CBlockTreeDB.\r\n\r\nA write ahead ahead log and boolean flags as file existence checks ensure write atomicity. Every data entry is also given a crc32c checksum to detect data corruption.\r\n\r\nThe change also opens the door towards getting rid of having to reindex the block tree due to corruption (though switching from pruned -> un-pruned still requires extra logic). This would simplify a lot of kernel/validation code, as can be seen in this [commit](https://github.com/TheCharlatan/bitcoin/commit/bfb2709e1d116d4e613601c3f0140f099530159d#diff-28f178018e05634ee3f8ddce3f4e0cec334ae69915cecf92be8299c749d8d470). The implementation here should be fairly robust against corruption (no parallel read/writes, no background compaction).\r\n\r\nAn alternative to this pull request, that could allow the same kernel feature, would be closing and opening the leveldb database only when reading and writing. This might incur a (negligible) performance penalty, but more importantly requires careful consideration of how to handle any contentions when opening, which might have complex side effects due to our current locking mode. It would also be possible to introduce an existing database with the required features for just the block tree, but that would introduce reliance on a new dependency and come with its own tradeoffs. For these reasons I chose this approach.",
      "state": "open",
      "user": "sedited",
      "created_at": "2025-05-06T14:27:59Z",
      "updated_at": "2026-01-28T11:51:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32427",
      "labels": [
        "UTXO Db and Indexes",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2759,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2294479432,
      "number": 31723,
      "title": "qa: Facilitate debugging bitcoind inside functional tests",
      "body": "Facilitates debugging specific instances of bitcoind *in the context of Python tests, inside of an editor/IDE/debugger*.\r\n\r\nMakes bitcoind spin during startup, waiting for a debugger to be attached, so that breakpoints during process init can be debugged.\r\n\r\n### Example usage\r\n\r\n1. Generate build files with `-DENABLE_WAIT_FOR_DEBUGGER=ON` & build.\r\n   \r\n   ```\r\n   cmake -B build -DCMAKE_BUILD_TYPE=Debug -DENABLE_WAIT_FOR_DEBUGGER=ON && cmake --build build -j$(nproc)\r\n   ```\r\n\r\n2. Set breakpoints in the C++ code in your editor/IDE/debugger.\r\n\r\n3. Start a Python functional test with a debugger command such as:\r\n   - LLDB inside an already started Tmux pane (append ` -o continue` to the LLDB args to have the debugger continue automatically):\r\n     ```\r\n     ./build/test/functional/feature_loadblock.py --debug_runs 2 --debug_cmd \"tmux split-window -h lldb -p \\$PID\\$\"\r\n     ```\r\n   - Sublime Text Debugger, allows a running session to attach:\r\n     ```\r\n     ./build/test/functional/feature_loadblock.py --debug_runs 2 --debug_cmd \"subl --command \\\"debugger {\\\\\\\"action\\\\\\\": \\\\\\\"start\\\\\\\", \\\\\\\"configuration\\\\\\\": {\\\\\\\"name\\\\\\\": \\\\\\\"foo\\\\\\\", \\\\\\\"type\\\\\\\": \\\\\\\"lldb\\\\\\\", \\\\\\\"request\\\\\\\": \\\\\\\"attach\\\\\\\", \\\\\\\"program\\\\\\\": \\\\\\\"dummyprogram\\\\\\\", \\\\\\\"pid\\\\\\\": \\\\\\\"\\$PID\\$\\\\\\\"}}\\\"\"\r\n     ```\r\n   - Don't specify `--debug_cmd ...\\$PID\\$...`, instead have the test framework log which bitcoind PID you should manually attach to:\r\n     ```\r\n     ./build/test/functional/feature_loadblock.py --debug_runs 2\r\n     ```\r\n\r\n5. Experience how debugger hits breakpoints as the functional test executes RPCs.\r\n\r\nUsing `-debug_runs <RUN_INDEX>` often requires doing a dry-run of a functional test with `-ldebug` and examining the log to see which run index is the one we want to debug:\r\n```\r\n2025-...Z TestFramework.node0 (DEBUG): bitcoind started (run #1, node #0), waiting for RPC to come up\r\n``` \r\n\r\n### Alternative usage\r\n\r\nTweak functional test code to specify `wait_for_debugger` when (re)starting a node:\r\n\r\n```diff\r\n-        self.restart_node(0)\r\n+        self.restart_node(0, wait_for_debugger=True)\r\n```\r\nWhile it can be messy to modify files while moving between commits, and cumbersome inside of loops, it might be more straightforward than `-debug_runs <RUN_INDEX>` in a given case.\r\n\r\n### *Needed before merge*\r\n\r\n- [ ] Testing on Mac to confirm -waitfordebugger on the C++ side behaves as expected.",
      "state": "open",
      "user": "hodlinator",
      "created_at": "2025-01-23T13:18:06Z",
      "updated_at": "2026-01-28T11:42:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31723",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2460,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2876629729,
      "number": 33512,
      "title": "coins: use number of dirty cache entries in flush warnings/logs",
      "body": "Revival of https://github.com/bitcoin/bitcoin/pull/31703 with all outstanding review feedback addressed.\r\n\r\n<details>\r\n<summary>Changes compared to the original</summary>\r\n\r\n* `EmplaceCoinInternalDANGER` is also fuzz tested now\r\n* Warning and logging moved from `FlushStateToDisk` to `CCoinsViewDB::BatchWrite`, ensuring `AssumeUTXO` snapshot writes also display progress warnings\r\n* Removed the redundant changed counter in `BatchWrite` since we now track `dirty_count` directly\r\n* All instances use `dirty_count` (not num_dirty) and parameter alignment is corrected\r\n\r\n</details>\r\n\r\n----\r\n\r\n> Since #28280 and #28233, the percentage of dirty entries in the cache when a flush happens may in practice be far from 100%. The log output, the decision to warn about a large flush (#31534), and the disk-full detection, however always use the entire size of the cache.\r\n>\r\n> Fix this by keeping track of the number of dirty entries in `CCoinsViewCache`, and using that number. We've dropped the usage of `DynamicMemoryUsage` as it's the wrong metric, even before the non-wiping flushes were introduced (if everything is dirty, memory usage is correlated with, but not the same as, the amount of disk space written or used). They could be improved by keeping track of proper write size estimates in a follow-up, but here we're just using a fixed 48 bytes per entry estimate.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-10-01T02:24:51Z",
      "updated_at": "2026-01-28T11:29:58Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33512",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 2,
        "text_length": 1433,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3216306855,
      "number": 34425,
      "title": "test: Fix all races after a socket is closed gracefully",
      "body": "Currently, functional tests may intermittently fail, due to a lack of synchronization after a node connection socket was closed gracefully: If node A is connected to node B, and node B closes the connection, node A *must* wait for the connection to be closed before continuing the test. Otherwise, subsequent re-connections may not work while a stale connection is still alive.\r\n\r\nThis can be reproduced locally via something like:\r\n\r\n```diff\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex 6b79e913e8..32bd061500 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -2200,2 +2200,3 @@ void CConnman::SocketHandlerConnected(const std::vector<CNode*>& nodes,\r\n                 }\r\n+            UninterruptibleSleep(599ms);\r\n                 pnode->CloseSocketDisconnect();\r\n```\r\n\r\nWith this diff, the tests should fail on master, and pass after this fix.\r\n\r\nThe fix involves simply calling `self.wait_until(lambda: len(node_a.getpeerinfo()) == 0)` after each disconnect, and before each re-connection.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-27T21:35:13Z",
      "updated_at": "2026-01-28T11:17:41Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34425",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1050,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 608484839,
      "number": 21590,
      "title": "Safegcd-based modular inverses in MuHash3072",
      "body": "This implements a safegcd-based modular inverse for MuHash3072. It is a fairly straightforward translation of [the libsecp256k1 implementation](https://github.com/bitcoin-core/secp256k1/pull/831), with the following changes:\r\n* Generic for 32-bit and 64-bit\r\n* Specialized for the specific MuHash3072 modulus (2^3072 - 1103717).\r\n* A bit more C++ish\r\n* Far fewer sanity checks\r\n\r\nA benchmark is also included for MuHash3072::Finalize. The new implementation is around 100x faster on x86_64 for me (from 5.8 ms to 57 μs); for 32-bit code the factor is likely even larger.\r\n\r\nFor more information:\r\n  * [Original paper](https://gcd.cr.yp.to/papers.html) by Daniel J. Bernstein and Bo-Yin Yang\r\n  * [Implementation](https://github.com/bitcoin-core/secp256k1/pull/767) for libsecp256k1 by Peter Dettman; and the [final](https://github.com/bitcoin-core/secp256k1/pull/831) version\r\n  * [Explanation](https://github.com/bitcoin-core/secp256k1/blob/master/doc/safegcd_implementation.md) of the algorithm using Python snippets\r\n  * [Analysis](https://github.com/sipa/safegcd-bounds) of the maximum number of iterations the algorithm needs\r\n   * [Formal proof in Coq](https://medium.com/blockstream/a-formal-proof-of-safegcd-bounds-695e1735a348) by Russell O'Connor (for the 256-bit version of the algorithm; here we use a 3072-bit one).\r\n",
      "state": "closed",
      "user": "sipa",
      "created_at": "2021-04-04T04:26:05Z",
      "updated_at": "2026-01-28T11:03:10Z",
      "merged_at": "2025-01-27T21:50:43Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/21590",
      "labels": [
        "Build system",
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1375,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2301455244,
      "number": 31743,
      "title": "Added missing period for consistency and readability",
      "body": "Added a missing period in a specific part of the text to maintain consistency across the document. This ensures a uniform writing style, improves readability, and aligns with the formatting used throughout the content.\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "closed",
      "user": "shaymolcho",
      "created_at": "2025-01-28T06:33:55Z",
      "updated_at": "2026-01-28T11:03:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31743",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 2337,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3132941994,
      "number": 34161,
      "title": "refactor: avoid possible UB from `std::distance` for `nullptr` args",
      "body": "### Problem\r\n\r\nCalling `std::distance(nullptr, nullptr)` has ambiguous status in the C++ standard [iterator.requirements.general](https://eel.is/c++draft/iterator.requirements.general#7):\r\n> Iterators can also have singular values that are not associated with any sequence. Results of most expressions are undefined for singular values.\r\n\r\nIt seems to work correctly in every implementation we use, but [LWG 1213](https://cplusplus.github.io/LWG/issue1213) (\"Meaning of valid and singular iterator underspecified\") has been Open since 2009, acknowledging that the standard's wording on this topic is unclear.\r\n\r\n<details>\r\n<summary>Details</summary>\r\n\r\nThe [iterator.requirements.general](https://eel.is/c++draft/iterator.requirements.general#7) states:\r\n> Iterators can also have singular values that are not associated with any sequence. Results of most expressions are undefined for singular values.\r\n\r\nAnd [LWG 208](https://cplusplus.github.io/LWG/issue208)'s rationale explicitly confirms:\r\n> Null pointers are singular.\r\n\r\nTherefore they cannot form a valid range required by [std::distance](https://eel.is/c++draft/iterator.operations#4):\r\n> Preconditions: last is reachable from first, or InputIterator meets the Cpp17RandomAccessIterator requirements and first is reachable from last.\r\n\r\n</details>\r\n\r\n### Fix\r\n\r\nA previous version of this PR checked both values for `nullptr`, the current one uses unambiguously well-defined pointer subtraction instead, which is per [expr.add](https://eel.is/c++draft/expr.add#5):\r\n> If P and Q both evaluate to null pointer values, the value is 0.\r\n\r\nThis applies on the first call before any memory is allocated, when both pointers are `nullptr`.\r\nUsing `operator-` directly is simpler and avoids the ambiguity entirely.",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2025-12-28T13:01:04Z",
      "updated_at": "2026-01-28T10:50:03Z",
      "merged_at": "2026-01-28T10:42:02Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34161",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1834,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3136120149,
      "number": 34179,
      "title": "refactor: Enable transparent lookup for setBlockIndexCandidates to remove const_cast",
      "body": "### Rationale\r\n\r\nThis PR improves code safety by removing a `const_cast` in `src/validation.cpp`.\r\n\r\nCurrently, `setBlockIndexCandidates` stores mutable `CBlockIndex*`. However, validation logic (like `CVerifyDB`) often holds `const CBlockIndex*`. Previously, checking for existence in the set required casting away constness. While currently benign, this bypasses compiler safety checks and could mask accidental modifications in future refactors.\r\n\r\n### Description\r\n\r\n1.  **Enable Heterogeneous Lookup:** Added `using is_transparent = void;` to `CBlockIndexWorkComparator` in `src/node/blockstorage.h`. This allows the `std::set` to natively accept `const CBlockIndex*` for lookup (utilizing C++14 heterogeneous lookup).\r\n2.  **Remove Cast:** Removed the now unnecessary `const_cast<CBlockIndex*>` in `src/validation.cpp`, allowing the compiler to strictly enforce const-correctness.\r\n\r\n### Notes\r\n\r\n- **Refactoring only:** No behavioral change.\r\n- **Verification:** `validation_tests` and `blockmanager_tests` pass.",
      "state": "open",
      "user": "joaonevess",
      "created_at": "2025-12-30T07:40:16Z",
      "updated_at": "2026-01-28T10:44:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34179",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1104,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3214986859,
      "number": 34420,
      "title": "consensus: disable min difficulty blocks on testnet4 after height 151200",
      "body": "  ## Summary                                                                                                                                \r\n                                                                                                                                            \r\n  Disable the min-difficulty block rule on testnet4 after block height 151,200 (epoch 75 boundary) and reset difficulty to 1,000,000 at the fork.                                                                                                                                     \r\n                                                                                                                                            \r\n  ## Motivation                                                                                                                             \r\n                                                                                                                                            \r\n  Testnet4's min-difficulty rule (allowing difficulty-1 blocks after 20 minutes) is being exploited, causing ~85-90% of blocks to be CPU-mined min-difficulty blocks. This results in a race of CPU miners broadcasting blocks at exactly the second that it's acceptable. This race is so intense that CPU miners have figured out sending empty blocks, as they propagate faster than those that contain transactions, resulting in a network where transactions are confirmed at only the remaining ASIC blocks, that have ~1 hour average block times.                                                                                                     \r\n                                                                                                                                            \r\n  After the fork:                                                                                                                           \r\n  - Min-difficulty blocks will no longer be allowed                                                                                         \r\n  - Difficulty resets to 1,000,000 (not 1, to avoid a block storm of thousands of blocks in seconds)                                        \r\n  - Normal difficulty retargeting resumes                                                                                                   \r\n                                                                                                                                            \r\n  ## Changes                                                                                                                                \r\n                                                                                                                                            \r\n  - Add `nMinDifficultyBlocksForkHeight` consensus parameter (default 0 = disabled)                                                         \r\n  - Set fork height to 151,200 for testnet4 (epoch 75 boundary, ~31,000 blocks from current height ~120,000)                                \r\n  - Modify `GetNextWorkRequired()` to disable min-difficulty rule and reset difficulty at fork                                              \r\n  - Modify `PermittedDifficultyTransition()` to enforce the new rules                                                                       \r\n  - Modify `WaitAndCreateNewBlock()` in miner to respect the fork                                                                           \r\n  - Add unit tests covering pre-fork, at-fork, and post-fork behavior                                                                       \r\n                                                                                                                                            \r\n  ## Test Plan                                                                                                                              \r\n                                                                                                                                            \r\n  - `./build/bin/test_bitcoin --run_test=pow_tests` - all 21 tests pass                                                                     \r\n                                                                                                                                            \r\n  ## Discussion                                                                                                                             \r\n                                                                                                                                            \r\n  [bitcoin-dev mailing list thread #1](https://groups.google.com/g/bitcoindev/c/iVLHJ1HWhoU)\r\n  [bitcoin-dev mailing list thread #2](https://groups.google.com/g/bitcoindev/c/Jsv1VYpewuU)     \r\n  [Bitcointalk thread](https://bitcointalk.org/index.php?topic=5569103.0)     ",
      "state": "open",
      "user": "batmanbytes",
      "created_at": "2026-01-27T15:08:13Z",
      "updated_at": "2026-01-28T09:54:52Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34420",
      "labels": [
        "Consensus"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 4957,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3195778555,
      "number": 34370,
      "title": "[29.x] Fix #34222 backport bugs",
      "body": "",
      "state": "open",
      "user": "luke-jr",
      "created_at": "2026-01-21T15:47:10Z",
      "updated_at": "2026-01-28T09:44:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34370",
      "labels": [
        "Wallet",
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 32,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1939750059,
      "number": 30341,
      "title": "Permit Combiner to strip bip32_deriv information",
      "body": "Closes: #30294\r\n\r\nLooking for approach (N)ACK.\r\n\r\nPreviously setting the `bip32derivs` flag to false with the `walletprocesspsbt` RPC correctly does not include `bip32_derivs` for inputs in the PSBT, but does include `bip32_derivs` for outputs.\r\n\r\nUser may want to actively strip all bip32 derivation paths from a PSBT for privacy reasons however. It may make sense to do this after signing your inputs and outputs during a manual coinjoin as demonstrated in the [BIP174 example](https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki#manual-coinjoin-workflow).\r\n\r\nTo me, this makes more sense to include in the [`Combiner`](https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki#combiner) PSBT role. It's then separated from signing done by the `Signers`. \r\n\r\nTherefore add functionality to `combinepsbt` permitting stripping of **all** `bip32_derivation` paths found in all provided psbts' inputs and outputs.\r\n\r\nAs this RPC can be called with a single PSBT, it can be used to strip derivation paths from a PSBT with any number of participants.\r\n",
      "state": "closed",
      "user": "willcl-ark",
      "created_at": "2024-06-26T11:01:47Z",
      "updated_at": "2026-01-28T09:40:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30341",
      "labels": [
        "PSBT"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1113,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3211138477,
      "number": 34412,
      "title": "Update secp256k1 subtree to latest master",
      "body": "Updates the secp256k1 subtree to latest master (https://github.com/bitcoin-core/secp256k1/commit/14e56970cba37ffe4ee992c1e08707a16e22e345).",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-01-26T16:07:37Z",
      "updated_at": "2026-01-28T09:31:42Z",
      "merged_at": "2026-01-28T09:30:35Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34412",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 181,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2893662859,
      "number": 33562,
      "title": "DRAFT: add a freebsd job using systemlibs",
      "body": "Re #33438\r\n\r\nTest a basic freebsd job in this repo using cirrus runners to get some info on how long a run will take on Cirrus Runners.\r\n\r\nA run on GHA (free) runners is clocking in at around 50 - 60 minutes: https://github.com/willcl-ark/bitcoin/actions/runs/18309856374/job/52135663056 \r\n\r\nThis will need permitting of the `vmactions/freebsd-vm@v1` action in this repo. This action seems well-maintained/used, including by [`rustup`](https://github.com/rust-lang/rustup/blob/061cf7830a61eaefaddddb8454232186d26fd2d1/ci/actions-templates/freebsd-builds-template.yaml#L19), python [`psutil`](https://github.com/giampaolo/psutil/blob/0217662c7e3381612e1a15181b02fe3d06894272/.github/workflows/bsd.yml#L19) and a few other notable repos.\r\n\r\nThis job could alternatively be run as a nightly job (but in this repo, rather than elsewhere), but that does not seem to address:\r\n\r\n> BSDs are being tested in nightly repos, but merging code here, just to have it reported as broken after the fact, which then requires more changes to fix, isn't ideal. Issues should be caught in this repo, before merging.\r\n\r\nInspiration taken from https://github.com/hebasto/bitcoin-core-nightly/blob/main/.github/workflows/freebsd.yml",
      "state": "closed",
      "user": "willcl-ark",
      "created_at": "2025-10-07T11:35:43Z",
      "updated_at": "2026-01-28T08:31:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33562",
      "labels": [
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1252,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2937452835,
      "number": 33680,
      "title": "validation: do not wipe utxo cache for stats/scans/snapshots",
      "body": "Revival of https://github.com/bitcoin/bitcoin/pull/30610#issuecomment-3432564955 with the remaining comments applied on top\r\n\r\n> Since #28280, the cost of a non-wiping sync of the UTXO cache is only proportional to the number of dirty entries, rather than proportional to the size of the entire cache. Because of that, there is no reason to perform a wiping flush in case the contents of the cache is still useful.\r\n> \r\n> Split the `FlushStateMode::ALWAYS` mode into a FORCE_SYNC (non-wiping) and a FORCE_FLUSH (wiping), and then use the former in `scantxoutset`, `gettxoutsetinfo`, snapshot creation.\r\n\r\n(slightly updated after #30214)",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-10-22T14:46:09Z",
      "updated_at": "2026-01-28T08:21:04Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33680",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 697,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3217429368,
      "number": 34426,
      "title": "refactor: avoid unreachable throw in `inline_check_non_fatal`",
      "body": "In builds where `G_ABORT_ON_FAILED_ASSUME` is true, `inline_check_non_fatal` called `assertion_fail()` and then had a throw `NonFatalCheckError` that was never reachable, because `assertion_fail()` either aborts or throws and never returns.\r\nRefactored `inline_check_non_fatal` to use `if constexpr (G_ABORT_ON_FAILED_ASSUME) { assertion_fail(...) } else { throw NonFatalCheckError(...) }` branch, removing the unreachable `throw`",
      "state": "closed",
      "user": "lisenokdonbassenok",
      "created_at": "2026-01-28T06:49:17Z",
      "updated_at": "2026-01-28T06:55:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34426",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 492,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3182466003,
      "number": 34322,
      "title": "node: Persist private broadcast transactions over node restarts",
      "body": "Follow-up from #29415 \r\n\r\nCurrently private broadcast transactions are stored in peer manager and do not persist over restarts. A submitted transaction can be lost if the node restarts before it is privately broadcast.\r\n\r\nThis change dumps the set of private broadcast transactions to a `privatebroadcast.dat` file on shutdown, and adds the transactions back to the private broadcast data structure on restart.",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2026-01-16T19:37:05Z",
      "updated_at": "2026-01-28T06:27:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34322",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 474,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2997112498,
      "number": 33847,
      "title": "kernel: Improve logging API",
      "body": "Simplify kernel logging API and try to connect it to the rest of the kernel API by letting log options be set on `Logger` objects directly and `Logger` objects to be associated with `Context` objects directly. Also drop `logging_disable()` function and avoid having library accumulate log messages in a 1MB buffer by default.\r\n\r\nChanges are intended to make the API a little less surprising and more future proof. Rationale is described in some more detail the commit message.\r\n\r\nThis change is not backwards compatible but I'd expect it to port over pretty smoothly to the language bindings, and offer the same benefits for them as for C/C++ callers.\r\n\r\n",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2025-11-10T23:30:46Z",
      "updated_at": "2026-01-28T06:20:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33847",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 683,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3088060609,
      "number": 34038,
      "title": "logging: API improvements",
      "body": "A few changes:\r\n\r\n * Provide `STDLOCK(m_cs)` instead of `StdLockGuard g(m_cs)` for the logging mutexes, so that we can get better warnings from clang if annotations have been missed\r\n * Allow writing `LogInfo(BCLog::NO_RATE_LIMIT, \"log message\")` to avoid rate limiting, rather than having to supply a false argument to `LogPrintLevel_(...)`\r\n * Replace the `-loglevel` parameter with a new `-trace` parameter that works the same as `-debug`\r\n * Change the `logging` RPC to allow enabling trace debugging, and to differentiate trace vs debug levels\r\n ",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2025-12-10T05:56:20Z",
      "updated_at": "2026-01-28T06:10:52Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34038",
      "labels": [
        "Needs release note"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 577,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2999254279,
      "number": 33854,
      "title": "fix assumevalid is ignored during reindex",
      "body": "During a reindex, the assumevalid setting may be ignored if the chainwork of the best header is below `minimumchainwork`. This happens when the previous IBD was stopped before connecting enough blocks to reach the required `minimumchainwork`. The assumevalid block will also be missing from the block index because the assumevalid block is set to match the `minimumchainwork`. See [Issue #31494](https://github.com/bitcoin/bitcoin/issues/31494).\r\n\r\nAs a result, `reindex` can take significantly longer to complete than necessary.\r\n\r\nThis PR addresses the issue by modifying reindex behaviour: if the chainwork of the `best_header` is below `minimumchainwork`, the node skips the `ActivateBestChain()` step and proceeds directly to synchronisation.\r\n\r\nThis PR takes a different approach from [PR #31615](https://github.com/bitcoin/bitcoin/pull/31615) to keep the validation path for `reindex` the same as the regular IBD validation path.\r\n\r\nDevelopers benchmarking IBD with `-reindex` may find this behaviour undesirable. In such cases, it’s recommended to use `-reindex-chainstate` instead or ensure that the available blocks have sufficient chainwork.\r\n\r\n`libbitcoinkernel` exposes the `ImportBlocks` function and expects `reindex` to connect blocks, so an attempt was made to preserve the existing behaviour for `libbitcoinkernel`.",
      "state": "open",
      "user": "Eunovo",
      "created_at": "2025-11-11T14:21:14Z",
      "updated_at": "2026-01-28T06:06:22Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33854",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1375,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3013940276,
      "number": 33878,
      "title": "refactor, docs: Embedded ASMap [2/3]: Refactor asmap internals and add documentation",
      "body": "This is a second slice carved out of #28792. It contains the following changes that are crucial for the embedding of asmap data which is added the following PR in the series (probably this will remain in #28792).\r\n\r\nThe changes are:\r\n- Modernizes and simplifies the asmap code by operating on `std::byte` instead of bits\r\n- Unifies asmap version calculation and naming (previously it was called version and checksum interchangeably)\r\n- Operate on a `span` rather than a vector in the asmap internal to prevent holding the asmap data in memory twice\r\n- Add more extensive documentation to the asmap implementation\r\n- Unify asmap casing in implemetation function names\r\n\r\nThe first three commits were already part of #28792, the others are new.\r\n\r\nThe documentation commit came out of feedback gathered at the latest CoreDev. The primary input for the documentation was the documentation that already existed in the Python implementation (`contrib/asmap/asmap.py`) but there are several other comments as well. Please note: I have also asked several LLMs to provide suggestions on how to explain pieces of the implementation and better demonstrate how the parts work together. I have copied bits and pieces that I liked but everything has been edited further by me and obviously all mistakes here are my own. ",
      "state": "open",
      "user": "fjahr",
      "created_at": "2025-11-15T20:50:29Z",
      "updated_at": "2026-01-28T05:29:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33878",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1392,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3184839812,
      "number": 34329,
      "title": "rpc,net: Add private broadcast RPCs",
      "body": "Follow up from #29415 \r\n\r\nSending a transaction via private broadcast does not have any way for a user to track the status of the transaction before it gets returned by another peer. The default logs will likely be removed as well in #34267. Nor is there any way to abort a transaction once it has been added to the private broadcast queue.\r\n\r\nThis adds two new RPCs:\r\n- `getprivatebroadastinfo` returns information about what transactions are in the private broadcast queue, including all the peers' addresses we have chosen and timestamps for sending and reception acknowledgement.\r\n- `abortprivatebroadcast` removes a transaction from the private broadcast queue.",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2026-01-18T01:46:20Z",
      "updated_at": "2026-01-28T04:22:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34329",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 702,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3177133582,
      "number": 34305,
      "title": "log: correct size output in disk space check",
      "body": "The output should be the additional space needed, otherwise we are always warning that 810GB will be stored, even when a user is pruning.\r\n\r\nFor example on machine with ~20GB free disk, pruning to 40GB:\r\n```bash\r\n./build/bin/bitcoind -prune=40000\r\n...\r\n2026-01-15T11:45:33Z [warning] Disk space for \"/root/.bitcoin/blocks\" may not accommodate the block files. Approximately 810 GB of data will be stored in this directory.\r\nWarning: Disk space for \"/root/.bitcoin/blocks\" may not accommodate the block files. Approximately 810 GB of data will be stored in this directory.\r\n```\r\n\r\nThis PR:\r\n```bash\r\n./build/bin/bitcoind -prune=40000\r\n...\r\n2026-01-15T11:41:49Z [warning] Disk space for \"/root/.bitcoin/blocks\" may not accommodate the block files. Approximately 39 GB of data will be stored in this directory.\r\nWarning: Disk space for \"/root/.bitcoin/blocks\" may not accommodate the block files. Approximately 39 GB of data will be stored in this directory.\r\n```",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-15T12:26:05Z",
      "updated_at": "2026-01-28T03:39:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34305",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1005,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3054407979,
      "number": 33966,
      "title": "refactor: disentangle miner startup defaults from runtime options",
      "body": "The interaction between node startup options like `-blockreservedweight` and runtime options, especially those passed via IPC, is confusing.\r\n\r\nThey're combined in `BlockAssembler::Options`, which this PR gets rid of in favour of two distinct structs:\r\n\r\n1. `BlockCreateOptions`: used by interface clients. As before, IPC clients have access to a safe / sane subset, whereas RPC and test code can use all fields.\r\n2. `MiningArgs`: these are set once during node startup\r\n\r\nBoth structs have a member for the maximum block height, which is not a problem since they're different structs. The one on `MiningArgs` (`block_max_weight`) matches `-maxblockheight` and is left alone. The one on `BlockCreateOptions` (`block_max_weight`) is an optional, it's set by `ApplyMiningDefaults` only if empty. \r\n\r\nThis all happens in the last commit and requires some preparation to keep things easy to review.\r\n\r\nWe get rid of `BlockAssembler::Options` but this is used in many tests. Since large churn is inevitable, we might as well switch all tests, bench and fuzzers over to the Mining interface. The first (non-base) commit does that, dramatically reducing direct use of `BlockAssembler`. Two exceptions are documented in the commit message. Because `test_block_validity` wasn't available via the interface and the block_assemble benchmark needs it, it's moved from `BlockAssembler::Options` to `BlockCreateOptions` (still not exposed via IPC).\r\n\r\nWe need access to mining related defaults and structs from both the miner and node initialization code. To avoid having to pull in all of `BlockAssembler` for the latter, the second commit introduces `node/mining.h` and moves constants and structs there from `src/node/types.h` (`BlockCreateOptions`, `BlockWaitOptions`, `BlockCheckOptions`) and `src/node/miner.h` (`DEFAULT_PRINT_MODIFIED_FEE`).\r\n\r\nI considered also moving `DEFAULT_BLOCK_MAX_WEIGHT`, `DEFAULT_BLOCK_RESERVED_WEIGHT`, `MINIMUM_BLOCK_RESERVED_WEIGHT` and `DEFAULT_BLOCK_MIN_TX_FEE` there from `policy.h`, since they are distinct from relay policy and not needed by the kernel. But this seems more appropriate for a follow-up and requires additional discussion.\r\n\r\nThe meat and potatoes of this PR is split between the three last commits for easier review:\r\n\r\n1. Adds `node/mining_args.{h,cpp}` and move the options checking out of `init.cpp`, without adding storage\r\n2. Add `block_max_weight` to `BlockCreateOptions` as explained above\r\n3. Introduce the `MiningArgs` struct, add it to the `NodeContext`, expand `mining_args.cpp` to store it, pass it to `BlockAssembler`, etc.\r\n\r\nI kept variable renaming and other formatting changes to a minimum to ease review with `--color-moved=dimmed-zebra`.\r\n\r\nThis PR builds on the bug fix in:\r\n- [ ] #33965\r\n\r\nOnce that is merged, this PR should not change behaviour.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-28T15:42:31Z",
      "updated_at": "2026-01-28T03:28:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33966",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2878,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3056547139,
      "number": 33974,
      "title": "cmake: Check dependencies after build option interaction",
      "body": "At present, `CMakeLists.txt` interleaves configuration-option handling with dependency discovery. As a result, unnecessary checks may be performed. For example:\r\n```\r\n$ cmake -B build --preset dev-mode -DBUILD_FOR_FUZZING=ON\r\n<snip>\r\n-- Found PkgConfig: /usr/bin/pkg-config (found version \"2.3.0\")\r\n-- Found ZeroMQ: /usr/lib64 (found suitable version \"4.3.5\", minimum required is \"4.0.0\")\r\n-- Performing Test HAVE_USDT_H\r\n-- Performing Test HAVE_USDT_H - Success\r\n-- Found USDT: /usr/include\r\n-- Found QRencode: /usr/lib64/libqrencode.so (found version \"4.1.1\")\r\n-- Performing Test CMAKE_HAVE_LIBC_PTHREAD\r\n-- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Success\r\n-- Found Threads: TRUE\r\n-- Performing Test HAVE_STDATOMIC\r\n-- Performing Test HAVE_STDATOMIC - Success\r\n-- Found WrapAtomic: TRUE\r\n-- Found OpenGL: /usr/lib64/libOpenGL.so\r\n-- Found WrapOpenGL: TRUE\r\n-- Found WrapVulkanHeaders: /usr/include\r\n-- Found Qt: /usr/lib64/cmake/Qt6 (found suitable version \"6.10.1\", minimum required is \"6.2\")\r\nCMake Warning at CMakeLists.txt:206 (message):\r\n  BUILD_FOR_FUZZING=ON will disable all other targets and force\r\n  BUILD_FUZZ_BINARY=ON.\r\n\r\n<snip>\r\n```\r\n\r\nThis PR restructures the code to ensure that all dependencies are checked only after the final build option interaction.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-11-30T15:50:06Z",
      "updated_at": "2026-01-28T03:13:56Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33974",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1331,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3070554287,
      "number": 34004,
      "title": "Implementation of SwiftSync",
      "body": "Link to the original protocol writeup found [here](https://gist.github.com/RubenSomsen/a61a37d14182ccd78760e477c78133cd). See the [Delving Bitcoin post](https://delvingbitcoin.org/t/swiftsync-speeding-up-ibd-with-pre-generated-hints-poc/1562) for initial works and discussion.\r\n\r\n# Motivation\r\n\r\nWhile many coins are available in cache when spent, every cache miss requires a trip to the disk. Memory can be scarce for single board machines, so cache misses are expected to be far more frequent. A trip to disk is all-the-more severe on low end hardware, so any minimization of disk interactions can speed up initial block download for limited resource devices. One such example may be a block template provider serving a home miner.\r\n\r\n# Intuition\r\n\r\nThe vast majority of coins created are later spent. The cost of this observation is many coins will be written to disk, only to be removed later. The SwiftSync protocol alleviates the problem by recording what coins have been added and removed with a small, in-memory aggregate. This allows for the removal of intermediate coin states until SwiftSync has completed. The state of the aggregate is verified at a predetermined chain height, and IBD continues as usual thereafter.\r\n\r\nFor any chain height, we know `all outputs - all inputs = UTXO set`, which is equivalently `all outputs - UTXO set = all inputs`. The goal is to verify the set `all outputs - UTXO set` is equal to `all inputs`. Addition and subtraction modulo a field offers a way to do so. For any set, if we add all elements of the set and subtract them, regardless of ordering, we will arrive at zero. In the current implementation, the set elements being compared are hashed outpoints.\r\n\r\nThe SwiftSync protocol is comprised of two structures. First, the aggregate that will record the state of what outpoints have been added (created) or subtracted (spent). Next, notice that the UTXO set must be reported in order to verify `all outputs - UTXO set = all inputs`. SwiftSync introduces a hints file, which may be provided to the client at startup. This hints file is nothing more than a pointer to each unspent output by recording the block height and the indexes that will remain unspent. By using this file, a client may omit outpoints that will be in the UTXO set when updating the aggregate. Note this file is not trusted. If a malicious actor provides a faulty UTXO set, the set comparison above will fail, and the client may begin a reindex.\r\n# Implementation\r\n\r\n## Aggregate\r\n\r\nThe hash aggregate takes outpoints, hashes them with a salted hasher, and updates 4, 64-bit limbs with wrapping modulo arithmetic. The choice of 4, 64-bit limbs with no carries between limbs was made to: 1. minimize code complexity within the aggregate 2. conform to existing APIs, namely `uint256`. After adding and subtracting some arbitrary list of outpoints, we may poll if the sets were equivalent with `IsZero`.\r\n## Hintsfile\r\n\r\nThe hints file is a map of block height to the indexes of the outputs in that block that _will_ be in the UTXO set. To construct this file for a particular UTXO set state, each block must be read and queried to find the outputs in that block that remain unspent. Because this is a read-only operation, this may be done on parallel threads in the future. To allow for parallelization, the hints file contains a \"contents\" section, which denotes the height and corresponding file position to find the hints for that block.\r\n\r\nTo save space when representing the indexes that remain unspent in a block, an easy choice is to take the difference between the last coin that was unspent and the next one in the block. AFICT this is a version of run-length-encoding. These indexes are encoded using `compactSize` to further save space, the run-lengths should normally fit into at least 16 bits, often 8 bits.\r\n## Parameter Interaction\r\n\r\nA side effect of omitting intermediate UTXO states while performing IBD is the \"undo data\" cannot be derived. There are already configurations that do not have full undo data history, namely pruned nodes. To avoid additional complexity in this PR, this version of accelerated IBD is only made available to pruned nodes, as the undo data would have been removed regardless of the this setting.\r\n\r\nOther parameter interactions, not yet implemented:\r\n- `assumeutxo`: Startup should fail if both are configured. A hints file will have no effect, as the UTXO set is already present.\r\n- `assumevalid`: A natural choice is to only allow SwiftSync when using `assumevalid`, and to only allow a hints file that commits to the `assumevalid` block. Similar to `assumeutxo`, a hash of the hints file may be committed to in the binary, which would be resistant to griefing attacks.\r\n# Testing [Linux example]\r\n\r\nIn your `bitcoin` directory, download the hints from the test server:\r\n\r\n```bash\r\ncurl -o signet.hints https://utxohints.store/hints/signet\r\n```\r\n\r\nVerify the hash of the file:\r\n\r\n```bash\r\necho \"2b625392ecb2adba2b5f9d7b00c8f3a8adca0d3c  signet.hints\" | sha1sum --check -\r\n```\r\n\r\nBuild the branch:\r\n\r\n```bash\r\ncmake -B build && cmake --build build -j $(nproc)\r\n```\r\n\r\nRemove existing chain state:\r\n\r\n```bash\r\nrm -rf ~/.bitcoin/signet/\r\n```\r\n\r\nProvide the file at startup:\r\n\r\n```bash\r\n./build/bin/bitcoind --chain=signet --utxohints=./signet.hints --prune=550\r\n```\r\n\r\n# Open Questions\r\n\r\n- Given the outcome of SwiftSync is pass/fail, and there is no use of intermediate states, should blocks be persisted to disk at all during the protocol?\r\n- To what degree should a hints file be committed to in the binary. No commitment allows for a server to provide hints for an arbitrary height, providing a convenience for the client, but opens up the possibility of a grief attack. Of course the server risks losing reputation for serving faulty files.\r\n\r\n# Future Iteration\r\n\r\nThis is the first iteration of the SwiftSync proposal, however more optimizations may be made. Namely, because set elements may be added or subtracted from the aggregate in any order, blocks may be downloaded in parallel from multiple peers. If you are interested in benchmarking the performance of a fully-parallel version, see the [Rust implementation](https://github.com/2140-dev/swiftsync).\r\n",
      "state": "open",
      "user": "rustaceanrob",
      "created_at": "2025-12-04T09:50:39Z",
      "updated_at": "2026-01-28T02:21:56Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34004",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 1,
        "text_length": 6261,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2940741002,
      "number": 33689,
      "title": "http: replace WorkQueue and single threads handling for ThreadPool",
      "body": "This has been a recent discovery; the general thread pool class created for #26966, cleanly \r\nintegrates into the HTTP server. It simplifies init, shutdown and requests execution logic.\r\nReplacing code that was never unit tested for code that is properly unit and fuzz tested.\r\nAlthough our functional test framework extensively uses this RPC interface (that’s how\r\nwe’ve been ensuring its correct behavior so far - which is not the best).\r\n\r\nThis clearly separates the responsibilities:\r\nThe HTTP server now focuses solely on receiving and dispatching requests, while ThreadPool handles\r\nconcurrency, queuing, and execution.\r\n\r\nThis will also allows us to experiment with further performance improvements at the task queuing and\r\nexecution level, such as a lock-free structure or task prioritization or any other implementation detail\r\nlike coroutines in the future, without having to deal with HTTP code that lives on a different layer.\r\n\r\nNote:\r\nThe rationale behind introducing the ThreadPool first is to be able to easily cherry-pick it across different\r\nworking paths. Some of the ones that are benefited from it are #26966 for the parallelization of the indexes\r\ninitial sync, #31132 for the parallelization of the inputs fetching procedure, #32061 for the libevent replacement,\r\nthe kernel API #30595 (https://github.com/bitcoin/bitcoin/pull/30595#discussion_r2413702370) to avoid blocking validation among others use cases not publicly available.\r\n\r\nNote 2:\r\nI could have created a wrapper around the existing code and replaced the `WorkQueue` in a subsequent\r\ncommit, but it didn’t seem worth the extra commits and review effort. The `ThreadPool` implements\r\nessentially the same functionality in a more modern and cleaner way.",
      "state": "open",
      "user": "furszy",
      "created_at": "2025-10-23T14:36:44Z",
      "updated_at": "2026-01-28T02:05:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33689",
      "labels": [
        "RPC/REST/ZMQ",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1804,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3133196135,
      "number": 34164,
      "title": "validation: add reusable coins view for ConnectBlock",
      "body": "This is the first commit of #31132, which can be merged as an independent change. It has a small benefit on its own, but will help in moving the parent PR forward.\r\n\r\nAdd a `Reset()` method to `CCoinsViewCache` that clears `cacheCoins`, `cachedCoinsUsage`, and `hashBlock` without flushing to the `base` view. This allows efficiently reusing a cache instance across multiple blocks.\r\n\r\nIntroduce `CoinsViewCacheController` to wrap a `CCoinsViewCache` and provide scoped access through a `Handle`. The `Handle` dereferences to the cache and automatically calls `Reset()` on destruction. This RAII pattern ensures the cache is always properly reset between blocks.\r\n\r\nAdd `m_connect_block_controller` as a persistent controller for `ConnectBlock`, avoiding repeated memory allocations.",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2025-12-28T20:05:04Z",
      "updated_at": "2026-01-28T01:40:32Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34164",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 836,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3178153988,
      "number": 34311,
      "title": "test: add unit tests for wallet interface getter basic method",
      "body": "This PR adds a unit test for basic wallet interface getter methods in `src/wallet/interfaces.cpp`  test verifies that `WalletImpl` correctly returns wallet properties and configuration values.\r\n\r\nAdded test case `wallet_interface_getters_basic` in `src/wallet/test/wallet_tests.cpp` that tests the following methods:\r\n\r\n1. **`getWalletName()`** \r\n2. **`isCrypted()`** \r\n3. **`isLocked()`**\r\n4. **`getDefaultAddressType()`**\r\n5. **`getDefaultMaxTxFee()`** \r\n6. **`getConfirmTarget()`**\r\n\r\ngetter methods are  untested. regressions in these methods could go undetected. The test catches the following types of bugs:\r\n\r\n```\r\n./bin/test_bitcoin --run_test=wallet_tests/wallet_interface_getters_basic\r\nRunning 1 test case...\r\n./wallet/test/wallet_tests.cpp(745): error: in \"wallet_tests/wallet_interface_getters_basic\": check wallet_name == \"test_wallet\" has failed [default != test_wallet]\r\n./wallet/test/wallet_tests.cpp(747): error: in \"wallet_tests/wallet_interface_getters_basic\": check wallet_interface->isCrypted() == false has failed [true != false]\r\n./wallet/test/wallet_tests.cpp(749): error: in \"wallet_tests/wallet_interface_getters_basic\": check wallet_interface->isLocked() == false has failed [true != false]\r\n./wallet/test/wallet_tests.cpp(752): error: in \"wallet_tests/wallet_interface_getters_basic\": check default_type == OutputType::BECH32 || default_type == OutputType::LEGACY || default_type == OutputType::P2SH_SEGWIT || default_type == OutputType::BECH32M has failed\r\n./wallet/test/wallet_tests.cpp(756): error: in \"wallet_tests/wallet_interface_getters_basic\": check max_fee > 0 has failed\r\n./wallet/test/wallet_tests.cpp(759): error: in \"wallet_tests/wallet_interface_getters_basic\": check confirm_target > 0 has failed\r\n\r\n*** 6 failures are detected in the test module \"Bitcoin Core Test Suite\"\r\n```\r\n",
      "state": "closed",
      "user": "b-l-u-e",
      "created_at": "2026-01-15T17:30:22Z",
      "updated_at": "2026-01-28T01:38:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34311",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1885,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3216048052,
      "number": 34422,
      "title": "Update libmultiprocess subtree to be more stable with rust IPC client",
      "body": "**This is based on #34284 + https://github.com/bitcoin-core/libmultiprocess/pull/240 so is currently a draft PR.** It's open to make sure the changes work together and there are no issues in CI.\r\n\r\nIncludes:\r\n\r\n- https://github.com/bitcoin-core/libmultiprocess/pull/241\r\n- https://github.com/bitcoin-core/libmultiprocess/pull/240\r\n\r\nThe latter change fixes issues with asynchronous requests (https://github.com/bitcoin/bitcoin/issues/33923) and unclean disconnects (https://github.com/bitcoin/bitcoin/issues/34250) that happen with the rust mining client.\r\n\r\nThe changes can be verified by running `test/lint/git-subtree-check.sh src/ipc/libmultiprocess` as described in [developer notes](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#subtrees) and [lint instructions](https://github.com/bitcoin/bitcoin/tree/master/test/lint#git-subtree-checksh)\r\n",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2026-01-27T20:06:40Z",
      "updated_at": "2026-01-28T01:28:31Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34422",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 942,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2517768893,
      "number": 32489,
      "title": "wallet: Add `exportwatchonlywallet` RPC to export a watchonly version of a wallet",
      "body": "Currently, if a user wants to use an airgapped setup, they need to manually create the watchonly wallet that will live on the online node by importing the public descriptors. This PR introduces `exportwatchonlywallet` which will create a wallet file with the public descriptors to avoid exposing the specific internals to the user. Additionally, this RPC will copy any existing labels, transactions, and wallet flags. This ensures that the exported watchonly wallet is almost entirely a copy of the original wallet but without private keys.",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-05-13T22:22:00Z",
      "updated_at": "2026-01-28T01:21:39Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32489",
      "labels": [
        "Wallet",
        "Review club"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 622,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3119599294,
      "number": 34124,
      "title": "refactor: make `CCoinsView` a purely virtual abstract base class",
      "body": "### Problem\r\n`CCoinsView` serves as the interface for the coins database layer, but historically had a dual nature that caused confusion:\r\n\r\n* It provided default noop implementations (returning `std::nullopt`, `uint256()`, `false`, `nullptr`) instead of being pure virtual\r\n* Callers could instantiate a bare `CCoinsView` and get silent no-op behavior\r\n* Mixing the interface definition with a built-in dummy implementation blurred the abstraction boundary\r\n\r\n### Context\r\n\r\nThis is part of ongoing coins caching cleanup efforts such as #34132, #33866, #33018, and #33512.\r\n\r\n### Fix\r\n\r\nThis PR makes `CCoinsView` a pure abstract interface and introduces an explicit noop implementation, in tiny incremental steps to ease review:\r\n\r\n* Add `CCoinsViewEmpty` as an explicit noop coins view for tests, benchmarks, and dummy backends\r\n* Replace all direct `CCoinsView` instantiations with `CCoinsViewEmpty`\r\n* Incrementally make all `CCoinsView` methods pure virtual (`GetCoin`, `GetBestBlock`, `BatchWrite`, `EstimateSize`, `Cursor`, `GetHeadBlocks`, `HaveCoin`)\r\n* Remove the legacy default implementations from `coins.cpp`\r\n* Update the coins view fuzzer to switch between a real database-backed view and `CCoinsViewEmpty`\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-12-20T08:47:33Z",
      "updated_at": "2026-01-27T22:29:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34124",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1289,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3214411194,
      "number": 34418,
      "title": "qa: Make wallet_multiwallet.py Windows-compatible",
      "body": "Main parts:\r\n* Commit \"qa: Check for platform-independent part of error message\" switches to match on platform-independent part of error message.\r\n* Commit \"qa: Test scanning errors individually\" disentangles code causing the same error message substring, based on #31410.\r\n* Commit \"qa: Disable parts of the test when running under Windows or root\" enables the test to be run on Windows, based in part on https://github.com/bitcoin/bitcoin/pull/31410#issuecomment-3554721014.\r\n\r\nAlso:\r\n* Removes unused option in wallet_multiwallet.py.\r\n* Breaks apart wallet_multiwallet.py's `run_test()` into smaller test functions.\r\n* Improves `assert_equal()` output for dicts.\r\n\r\nFixes #31409.",
      "state": "open",
      "user": "hodlinator",
      "created_at": "2026-01-27T12:35:18Z",
      "updated_at": "2026-01-27T22:22:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34418",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 732,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3163366332,
      "number": 34253,
      "title": "validation: cache tip recency for lock-free `IsInitialBlockDownload()`",
      "body": "This PR is a follow-up to the stale #32885.\r\n\r\n### Problem\r\n`ChainstateManager::IsInitialBlockDownload()` currently acquires `cs_main` internally, even though most existing call sites already hold the lock. This becomes relevant for proposals like #34054, which would call `IsInitialBlockDownload()` from the scheduler thread without holding `cs_main`, potentially introducing lock contention.\r\n\r\n### Fix\r\nMake `ChainstateManager::IsInitialBlockDownload()` lock-free by caching its result in a single atomic `m_cached_is_ibd` (true while in IBD, latched to false on exit).\r\nMove the IBD exit checks out of `IsInitialBlockDownload()` (reader-side) into a new `ChainstateManager::UpdateIBDStatus()` (writer-side, called under cs_main).\r\n\r\nCall UpdateIBDStatus() at strategic points where IBD exit conditions may change, after active chain tip updates in `ConnectTip()`, `DisconnectTip()`, and `LoadChainTip()`, and after `ImportBlocks()` returns.\r\n\r\nWith this, `IsInitialBlockDownload()` becomes a lock-free atomic read, avoiding internal `cs_main` acquisition on hot paths.\r\n\r\n### Testing and Benchmarks\r\nThis isn't strictly an optimization (though some usecases might benefit from it), so rather as a sanity check I ran a reindex-chainstate and an `AssumeUTXO` load (without background validation).\r\n\r\n<details>\r\n<summary>assumeutxo load | 910000 blocks | dbcache 4500 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | xfs | SSD</summary>\r\n\r\n```\r\nCOMMITS=\"595504a43209bead162da54a204df7d140a25f0e 63e822b637f67242e3689adedc0155b34100e651\"; \\\r\nCC=gcc; CXX=g++; \\\r\nBASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/ShallowBitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; UTXO_SNAPSHOT_PATH=\"$BASE_DIR/utxo-910000.dat\"; \\\r\n(echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done; echo \"\") && \\\r\nfor DBCACHE in 4500; do \\\r\n  (echo \"assumeutxo load | 910000 blocks | dbcache ${DBCACHE} | $(hostname) | $(uname -m) | $(lscpu | grep 'Model name' | head -1 | cut -d: -f2 | xargs) | $(nproc) cores | $(free -h | awk '/^Mem:/{print $2}') RAM | $(df -T $BASE_DIR | awk 'NR==2{print $2}') | $(lsblk -no ROTA $(df --output=source $BASE_DIR | tail -1) | grep -q 0 && echo SSD || echo HDD)\";) &&\\\r\n  hyperfine \\\r\n  --sort command \\\r\n  --runs 3 \\\r\n  --export-json \"$BASE_DIR/assumeutxo-$(sed -E 's/(\\w{8})\\w+ ?/\\1-/g;s/-$//'<<<\"$COMMITS\")-$DBCACHE-$CC-$(date +%s).json\" \\\r\n  --parameter-list COMMIT ${COMMITS// /,} \\\r\n  --prepare \"killall -9 bitcoind 2>/dev/null; rm -rf $DATA_DIR/blocks $DATA_DIR/chainstate $DATA_DIR/chainstate_snapshot $DATA_DIR/debug.log; git clean -fxd; git reset --hard {COMMIT} && \\\r\n             cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=RelWithDebInfo && ninja -C build bitcoind bitcoin-cli -j2 && \\\r\n             ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=1 -printtoconsole=0; sleep 20 && \\\r\n             ./build/bin/bitcoind -datadir=$DATA_DIR -daemon -blocksonly -connect=0 -dbcache=$DBCACHE -printtoconsole=0; sleep 20\" \\\r\n   --conclude \"build/bin/bitcoin-cli -datadir=$DATA_DIR stop || true; killall bitcoind || true; sleep 10; \\\r\n               echo '{COMMIT} | dbcache=$DBCACHE | chainstate: $(find $DATA_DIR/chainstate_snapshot -type f 2>/dev/null | wc -l) files, $(du -sb $DATA_DIR/chainstate_snapshot 2>/dev/null | cut -f1) bytes' >> $DATA_DIR/debug.log; \\\r\n               cp $DATA_DIR/debug.log $LOG_DIR/debug-assumeutxo-{COMMIT}-dbcache-$DBCACHE-$(date +%s).log\" \\\r\n    \"COMPILER=$CC DBCACHE=$DBCACHE ./build/bin/bitcoin-cli -datadir=$DATA_DIR -rpcclienttimeout=0 loadtxoutset $UTXO_SNAPSHOT_PATH\"; \\\r\ndone\r\n\r\n595504a432 Merge bitcoin/bitcoin#34236: Add sedited to trusted-keys\r\n63e822b637 validation: make `IsInitialBlockDownload()` lock-free\r\n\r\nassumeutxo load | 910000 blocks | dbcache 4500 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | xfs | SSD\r\n\r\nBenchmark 1: COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 595504a43209bead162da54a204df7d140a25f0e)\r\n  Time (mean ± σ):     418.452 s ±  0.461 s    [User: 0.001 s, System: 0.001 s]\r\n  Range (min … max):   418.070 s … 418.964 s    3 runs\r\n \r\nBenchmark 2: COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 63e822b637f67242e3689adedc0155b34100e651)\r\n  Time (mean ± σ):     415.994 s ±  0.294 s    [User: 0.001 s, System: 0.001 s]\r\n  Range (min … max):   415.788 s … 416.330 s    3 runs\r\n \r\nRelative speed comparison\r\n        1.01 ±  0.00  COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 595504a43209bead162da54a204df7d140a25f0e)\r\n        1.00          COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 63e822b637f67242e3689adedc0155b34100e651)\r\n```\r\n\r\n</details>\r\n\r\n<details>\r\n<summary>2026-01-12 | reindex-chainstate | 931139 blocks | dbcache 4500 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | SSD</summary>\r\n\r\n```\r\nfor DBCACHE in 4500; do \\                                                                                                                           \r\n  COMMITS=\"595504a43209bead162da54a204df7d140a25f0e 63e822b637f67242e3689adedc0155b34100e651\"; \\\r\n  STOP=931139; CC=gcc; CXX=g++; \\\r\n  BASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/BitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; \\\r\n  (echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done) && \\\r\n  (echo \"\" && echo \"$(date -I) | reindex-chainstate | ${STOP} blocks | dbcache ${DBCACHE} | $(hostname) | $(uname -m) | $(lscpu | grep 'Model name' | head -1 | cut -d: -f2 | xargs) | $(nproc) cores | $(free -h | awk '/^Mem:/{print $2}') RAM | SSD\"; echo \"\") &&\\\r\n  hyperfine \\\r\n    --sort command \\\r\n    --runs 1 \\\r\n    --export-json \"$BASE_DIR/rdx-$(sed -E 's/(\\w{8})\\w+ ?/\\1-/g;s/-$//'<<<\"$COMMITS\")-$STOP-$DBCACHE-$CC.json\" \\\r\n    --parameter-list COMMIT ${COMMITS// /,} \\\r\n    --prepare \"killall -9 bitcoind 2>/dev/null; rm -f $DATA_DIR/debug.log; git clean -fxd; git reset --hard {COMMIT} && \\\r\n      cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=Release -DENABLE_IPC=OFF && ninja -C build bitcoind -j1 && \\\r\n      ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=1000 -printtoconsole=0; sleep 20; rm -f $DATA_DIR/debug.log\" \\\r\n    --conclude \"killall bitcoind || true; sleep 5; grep -q 'height=0' $DATA_DIR/debug.log && grep -q 'Disabling script verification at block #1' $DATA_DIR/debug.log && grep -q 'height=$STOP' $DATA_DIR/debug.log; \\\r\n                cp $DATA_DIR/debug.log $LOG_DIR/debug-{COMMIT}-$(date +%s).log\" \\\r\n    \"COMPILER=$CC ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=$DBCACHE -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0\";\r\ndone\r\n\r\n595504a432 Merge bitcoin/bitcoin#34236: Add sedited to trusted-keys\r\n63e822b637 validation: make `IsInitialBlockDownload()` lock-free\r\n\r\n2026-01-12 | reindex-chainstate | 931139 blocks | dbcache 4500 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | SSD\r\n\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=931139 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 595504a43209bead162da54a204df7d140a25f0e)\r\n  Time (abs ≡):        17187.310 s               [User: 33104.415 s, System: 937.548 s]\r\n \r\nBenchmark 2: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=931139 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 63e822b637f67242e3689adedc0155b34100e651)\r\n  Time (abs ≡):        17240.300 s               [User: 33164.803 s, System: 976.485 s]\r\n \r\nRelative speed comparison\r\n        1.00          COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=931139 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 595504a43209bead162da54a204df7d140a25f0e)\r\n        1.00          COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=931139 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 63e822b637f67242e3689adedc0155b34100e651)\r\n```\r\n\r\n</details>",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-11T15:15:32Z",
      "updated_at": "2026-01-27T21:46:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34253",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 8682,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3149207404,
      "number": 34208,
      "title": "bench: add fluent API for untimed `setup` steps in nanobench",
      "body": "### Context\r\nAs described in https://github.com/martinus/nanobench/issues/130, we have a few benchmarks where we have to reset the state between runs, otherwise the repetitions will do something else than the first iteration.\r\n\r\n### Upstream\r\nI have opened a PR to `nanobench` to introduce an untimed setup phase, see: https://github.com/martinus/nanobench/pull/136\r\nUnfortunately the author has health issues and couldn't contribute to it in the past 2 years.\r\n\r\n### Tests\r\n\r\nTests were only added upstream, would be a bit awkward to wire in `nanobench.h` outside the benchmarking setup:\r\nhttps://github.com/martinus/nanobench/pull/136/changes/58350cfe5912d7e0533ccfcd759eea5d62eb55bb#diff-88160f647ce57661afe7d755fa70a5fa342a2b79d72d3511596878e69ed5cdc3\r\n\r\n### Fix\r\nI have moved the changes here as well and applied it to a few simple benchmarks as demonstration.\r\nWe can revert ones that are controversial and add other ones in follow-ups, this PR is mostly meant to add the `setup` feature.\r\n\r\n### Benchmarks\r\nMost benchmarks show a modest \"speedup\", others a \"slowdown\" - but it's only the effect of the setup that's not measured anymore - and a `run` phase which does the same operation in each epoch iteration (wallet benchmark changes were reverted since for simplicity):\r\n<img width=\"1496\" height=\"882\" alt=\"image\" src=\"https://github.com/user-attachments/assets/34c14565-f3df-41e5-9a86-95b2ca21703a\" />\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-06T11:45:35Z",
      "updated_at": "2026-01-27T21:18:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34208",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1475,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3127249876,
      "number": 34143,
      "title": "build: Prevent system header fallback and include path pollution",
      "body": "Currently, header-only dependencies in the depends subsystem are installed into the standard `include/` subdirectory. This inadvertently exposes their headers to the compiler via `-I` flags brought in by other dependencies (e.g., `libevent` or `sqlite`). This \"include path pollution\" masks missing dependencies in the build configuration. While the build might succeed by accident due to this overlap, it creates a fragile state. If the overlapping library is removed, the build will break, or, worse, the compiler may silently fall back to the host system's default paths (e.g., `/usr/include`).\r\n\r\nThis PR improves build system security and hygiene by enforcing strict, distinguished include paths for header-only dependencies. The missing dependencies revealed by this change (`Boost::headers`, `USDT::headers`) have been fixed in separate commits.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-12-23T22:17:29Z",
      "updated_at": "2026-01-27T21:13:32Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34143",
      "labels": [
        "Bug",
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 917,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3133212525,
      "number": 34165,
      "title": "coins: don't mutate main cache when connecting block",
      "body": "This is a slightly modified version of the second commit of #31132, which can be merged as an independent change. It has a small benefit on its own, but will help in moving the parent PR forward.\r\n\r\nWhen accessing coins via the `CCoinsViewCache`, methods like `GetCoin` can call `FetchCoin` which actually mutate `cacheCoins` internally to cache entries when they are pulled from the backing db. This is generally a performance improvement for single threaded access patterns, but it precludes us from accessing entries in a `CCoinsViewCache` from multiple threads without a lock.\r\n\r\nAnother aspect is that when we add an ephemeral `CCoinsViewCache` view backed by the main cache for use in `ConnectBlock()`, we will insert entries into the main cache even if the block is determined to be invalid. This is not the biggest concern, since an invalid block requires proof-of-work. But, an attacker could craft multiple invalid blocks to fill the main cache. This would make us `Flush` the cache more often than necessary. Obviously this would be very expensive to do on mainnet.\r\n\r\nIntroduce `CoinsViewCacheNonMutating`, a `CCoinsViewCache` subclass that reads coins without mutating the underlying cache via `FetchCoin()`.\r\n\r\nAdd `PeekCoin()` to look up a Coin through a stack of `CCoinsViewCache` layers without populating parent caches. This prevents the main cache from caching inputs pulled from disk for a block that has not yet been fully validated. Once `Flush()` is called on the view, these inputs will be added as spent to `coinsCache` in the main cache via `BatchWrite()`.\r\n\r\nThis is the foundation for async input fetching, where worker threads must not mutate shared state.\r\n",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2025-12-28T20:32:34Z",
      "updated_at": "2026-01-27T20:24:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34165",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1740,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3135104327,
      "number": 34176,
      "title": "wallet: crash fix, handle non-writable db directories",
      "body": "Make wallet creation and load fail with a clear error when the db directory isn’t writable.\r\n\r\n#### 1) For Wallet Creation\r\n\r\nBefore: creating a wallet would return a generic error:\r\n\"SQLiteDatabase: Failed to open database: unable to open database file\"\r\n\r\nAfter: creating a wallet returns:\r\n\"SQLiteDatabase: Failed to open database in directory <dir_path>: directory is not writable\"\r\n\r\n#### 2) For Wallet Loading\r\n\r\nWe currently allow loading wallets located on non-writable directories. This is problematic\r\nbecause the node crashes on any subsequent write; generating a block is enough to trigger it.\r\nCan be verified just by running the following test on master: https://github.com/furszy/bitcoin-core/commit/85fa4e2910f0a8f43d4ee5a1322cbb69656d85e9 \r\n\r\nAlso, to check directory writability, this creates a tmp file rather than relying on the\r\n`permissions()` functions, since perms bits alone may not reliably reflect actual writability\r\nin some systems.\r\n\r\nTesting Note:\r\nPushed the tests in separate commits so they can be cherry-picked on master for comparison.",
      "state": "open",
      "user": "furszy",
      "created_at": "2025-12-29T19:44:56Z",
      "updated_at": "2026-01-27T20:01:41Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34176",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1125,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2555774103,
      "number": 32652,
      "title": "wallet: add codex32 argument to addhdkey",
      "body": "Rebase of #27351 onto #29136.\r\n\r\nWIP\r\n\r\nThis PR introduces the ability to import [BIP 93/codex32](https://github.com/bitcoin/bips/blob/master/bip-0093.mediawiki) master seeds with the `addhdkey` command. It currently expects seeds to be provided in  either as a single seed or as a list of shares which can be assembled via Shamir Secret Sharing.\r\n\r\n",
      "state": "closed",
      "user": "roconnor-blockstream",
      "created_at": "2025-05-30T22:05:57Z",
      "updated_at": "2026-01-27T19:24:15Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32652",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 391,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3142897675,
      "number": 34193,
      "title": "wallet: make migration more robust against failures",
      "body": "This is just me finding a few more edge cases after #34156 and #34176\r\n\r\nThe goal of the PR is to handle failures in a controlled way. Just so the process can automatically restore the original wallet without requiring user manual intervention.\r\n\r\nThe covered cases are:\r\n\r\n1. During `DoMigration()`: There are methods that can throw exceptions and abruptly abort the process. \r\nInstead of crashing (GUI) or returning a generic exception, we now will catch and return the error gracefully. This lets the process restore the original wallet automatically.\r\n\r\n2. Trying to migrate a wallet in a read-only directory throws a filesystem exception and skips cleanup.\r\n Now the process will fail gracefully with a clear error msg, and automatically restore the original wallet.\r\n\r\n3. Any failure during `MigrateToSQLite` requires user manual intervention. \r\nNow the original wallet db will remain untouched, and only be updated once the sqlite db creation fully succeeds.",
      "state": "open",
      "user": "furszy",
      "created_at": "2026-01-02T20:59:40Z",
      "updated_at": "2026-01-27T19:04:39Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34193",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1017,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3188672071,
      "number": 34346,
      "title": "test: use IP_PORTRANGE_HIGH on FreeBSD for dynamic port allocation",
      "body": "Reopening #34336. I’ve now tested it on FreeBSD and confirmed it works.\r\n\r\nOn FreeBSD, the default ephemeral port range (10000-65535) overlaps with the test framework's static port range (11000-26000), possibly causing intermittent \"address already in use\" failures when tests use dynamic port allocation (`port=0`).\r\n\r\nThis PR adds a helper that sets `IP_PORTRANGE_HIGH` via `setsockopt()` before binding, requesting ports from 49152-65535 instead, which avoids the overlap, as suggested in https://github.com/bitcoin/bitcoin/issues/34331#issuecomment-3767161843 by @maflcko .\r\n\r\nFrom FreeBSD's [sys/netinet/in.h](https://cgit.freebsd.org/src/tree/sys/netinet/in.h):                                                          \r\n  ```c\r\n  #define IP_PORTRANGE         19\r\n  #define IP_PORTRANGE_HIGH    1\r\n  #define IPPORT_EPHEMERALFIRST 10000  /* default range start */\r\n  #define IPPORT_HIFIRSTAUTO   49152   /* high range start */\r\n```\r\n\r\nSee also: FreeBSD https://man.freebsd.org/cgi/man.cgi?query=ip&sektion=4 man page.\r\n\r\nFixes #34331",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2026-01-19T17:57:22Z",
      "updated_at": "2026-01-27T18:03:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34346",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1105,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3173345068,
      "number": 34281,
      "title": "build: Temporarily remove confusing and brittle `-fdebug-prefix-map`",
      "body": "The compiler option `-fdebug-prefix-map` is unconditionally set by the build system. This is problematic for many reasons:\r\n\r\n* Users and devs have no easy way to disable it without modifying the build system source code\r\n* The mapping is broken since the cmake migration, and requires manual fixups such as https://github.com/bitcoin/bitcoin/issues/31204 or https://github.com/bitcoin/bitcoin/issues/31957\r\n\r\nFix all issues by temporarily removing it.\r\n\r\nThough, the option is kept for the guix build, so that no change in behavior is observed for the release binaries.\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/31957\r\nFixes https://github.com/bitcoin/bitcoin/issues/31204\r\n\r\n\r\nThe option can be added back in the future, if there is any need to. Though, adding it back should ideally work out of the box, or at least provide easy workarounds for all commonly used tooling.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-14T12:31:05Z",
      "updated_at": "2026-01-27T17:34:25Z",
      "merged_at": "2026-01-26T13:56:01Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34281",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 952,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3214791387,
      "number": 34419,
      "title": "mining: add coinbase locktime, sequence and version fields to getblocktemplate RPC",
      "body": "- [BIP54](https://github.com/bitcoin/bips/blob/master/bip-0054.md) proposes contraining the cointbase transaction `nLockTime` and `nSequence` fields. Our internal mining code has been doing this since #32155, but currently the fields are only communicated to IPC clients (see e.g. #33819).\r\n\r\n- Additionally this PR adds the `nVersion` field. This is unrelated to BIP54, but it means `getblocktemplate` now covers all coinbase transaction fields.\r\n\r\nTypically adding new fields to the `getblocktemplate` involves a BIP, so I'll keep this in draft while I write one. WIP: https://github.com/Sjors/bips/pull/1",
      "state": "open",
      "user": "Sjors",
      "created_at": "2026-01-27T14:17:17Z",
      "updated_at": "2026-01-27T17:02:57Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34419",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 690,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3051758805,
      "number": 33962,
      "title": "refactor: replace manual promise with SyncWithValidationInterfaceQueue",
      "body": "`BroadcastTransaction()` now waits for validation callbacks using the built-in `validation_signals>SyncWithValidationInterfaceQueue()` instead of creating a local `std::promise` and scheduling a lambda. This removes an unnecessary allocation and uses the canonical API.",
      "state": "closed",
      "user": "ANtutov",
      "created_at": "2025-11-27T16:12:32Z",
      "updated_at": "2026-01-27T17:01:25Z",
      "merged_at": "2026-01-27T17:01:25Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33962",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 340,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1746125849,
      "number": 29491,
      "title": "[EXPERIMENTAL] Schnorr batch verification for blocks",
      "body": "This is a draft implementation of Schnorr signature batch verification in blocks, put here for conceptual discussion, and collaborative benchmarking.\r\n\r\nThe `secp256k1` code is still under review itself, please spend some time giving feedback there if you can:\r\n- [Batch module PR](https://github.com/bitcoin-core/secp256k1/pull/1134)\r\n- [ecmult refactoring PR](https://github.com/bitcoin-core/secp256k1/pull/1789)\r\n\r\nTODOs\r\n- [ ] Batch taproot tweak verification as well",
      "state": "open",
      "user": "fjahr",
      "created_at": "2024-02-27T17:06:26Z",
      "updated_at": "2026-01-27T17:01:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29491",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 524,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3207919952,
      "number": 34401,
      "title": "kernel:  add serialization method for btck_BlockHeader API",
      "body": "This adds serialization for `btck_BlockHeader` API. Also, updated the `CheckHandle` to compare the byte content instead of size.\r\n\r\nFollow-up to #33822 .",
      "state": "open",
      "user": "yuvicc",
      "created_at": "2026-01-25T06:50:13Z",
      "updated_at": "2026-01-27T16:47:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34401",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 212,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3184483208,
      "number": 34328,
      "title": "rpc: make `uptime` monotonic across NTP jumps",
      "body": "### Problem\r\n`bitcoin-cli uptime` was derived from wall-clock time, so it could jump by large amounts when the system clock is corrected after `bitcoind` starts (e.g. on RTC-less systems syncing NTP).\r\nThis breaks the expectation that uptime reflects process runtime.\r\n\r\n### Fix\r\nCompute uptime from a [monotonic clock](https://en.cppreference.com/w/cpp/chrono/steady_clock.html) so it is immune to wall-clock jumps, and use that monotonic uptime for the RPC.\r\nGUI startup time is derived from wall clock time minus monotonic uptime so it remains sensible after clock corrections.\r\n\r\n### Reproducer\r\nRevert the fix commit and run the `rpc_uptime` functional test (it should fail with `AssertionError: uptime should not jump with wall clock`):\r\n\r\nOr alternatively:\r\n\r\n```bash\r\ncmake -B build && cmake --build build --target bitcoind bitcoin-cli -j$(nproc)\r\nDATA_DIR=$(mktemp -d)\r\n./build/bin/bitcoind -regtest -datadir=\"$DATA_DIR\" -connect=0 -daemon\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" -rpcwait uptime\r\nsleep 1\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" setmocktime $(( $(date +%s) + 20000000 ))\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" uptime\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" stop\r\n```\r\n\r\n<details>\r\n<summary>Before (uptime jumps with wall clock)</summary>\r\n\r\n```bash\r\nBitcoin Core starting\r\n0\r\n20000001\r\nBitcoin Core stopping\r\n```\r\n\r\n</details>\r\n\r\n<details>\r\n<summary>After (uptime stays monotonic)</summary>\r\n\r\n```bash\r\nBitcoin Core starting\r\n0\r\n1\r\nBitcoin Core stopping\r\n```\r\n</details>\r\n\r\n----------\r\n\r\nIssue: https://github.com/bitcoin/bitcoin/issues/34326",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2026-01-17T20:01:46Z",
      "updated_at": "2026-01-27T16:28:20Z",
      "merged_at": "2026-01-27T12:26:55Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34328",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1674,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3195808515,
      "number": 34371,
      "title": "wallet: allow importprunedfunds for spending transactions",
      "body": "Fixes #21647\n\n`importprunedfunds` only allowed importing transactions that credit the wallet\n(checked via `IsMine`), rejecting transactions that spend from it. This could\nleave a pruned wallet showing an incorrect balance. If a spending transaction\nwas removed with `removeprunedfunds`, it couldn't be re-imported and would\nfail with \"No addresses in wallet correspond to included transaction\"\n\nThe fix adds `IsFromMe()` alongside `IsMine()`, matching the pattern used\nelsewhere in wallet code.\n\nA functional test imports a transaction that spends from the wallet but has\nno outputs to it (entire UTXO sent externally), verifying the new code path.",
      "state": "open",
      "user": "8144225309",
      "created_at": "2026-01-21T15:54:39Z",
      "updated_at": "2026-01-27T16:17:59Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34371",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 706,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3136708013,
      "number": 34181,
      "title": "refactor: [p2p] Make ProcessMessage private again, Use references when non-null",
      "body": "There is a single unit test, which calls the internal `ProcessMessage` function. This is problematic, because it makes future changes harder, since they will need to carry over this public internal interface each time.\r\n\r\nAlso, there is a mixed use of pointers and references in p2p code, where just based on context, a pointer may sometimes assumed to be null, or non-null. This is confusing when reading the code, or making or reading future changes.\r\n\r\nFix both issues in a series of commits, to:\r\n\r\n* refactor the single unit test to call higher-level functions\r\n* Make `ProcessMessage` private again\r\n* Use references instead of implicit non-null pointers, mostly in a scripted-diff",
      "state": "open",
      "user": "maflcko",
      "created_at": "2025-12-30T12:31:30Z",
      "updated_at": "2026-01-27T16:06:57Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34181",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 767,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3210348402,
      "number": 34410,
      "title": "test: ensure p2p_private_broadcast.py has connections to all nets",
      "body": "If the following two events happen:\r\n\r\n* (likely) the automatic 10 initial connections are not made to all \r\n  networks\r\n* (unlikely) the network-specific logic kicks in almost immediately.\r\n  It is using exponential distribution with a mean of 5 minutes\r\n  (`rng.rand_exp_duration(EXTRA_NETWORK_PEER_INTERVAL)`).\r\n\r\nSo if both happen, then the 11th connection may not be the expected\r\nprivate broadcast, but a network-specific connection.\r\n\r\nFix this by manually opening a connection to each network upfront.\r\nBefore filling addrman, because once addrman has addresses the manual\r\n`addnode` connections will race with the automatic ones.\r\n\r\nFixes: https://github.com/bitcoin/bitcoin/issues/34387\r\n",
      "state": "open",
      "user": "vasild",
      "created_at": "2026-01-26T12:05:26Z",
      "updated_at": "2026-01-27T16:05:37Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34410",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 764,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3132300728,
      "number": 34158,
      "title": "torcontrol: Remove libevent usage",
      "body": "This is part of the effort to remove the libevent dependency from our code base: https://github.com/bitcoin/bitcoin/issues/31194\r\n\r\nThe current approach tries to reuse existing code and follows roughly similar design decisions. It replaces the libevent-based async I/O with blocking I/O utilizing the existing `Sock` and `CThreadInterrupt`. The controller runs in a dedicated thread.\r\n\r\nThere are some optional code modernizations thrown in made along the way (namings, constexpr etc.). These are not strictly necessary but make the end result with the new code more consistent.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2025-12-27T14:20:31Z",
      "updated_at": "2026-01-27T15:59:50Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34158",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 612,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3203071670,
      "number": 34389,
      "title": "net/log: standardize peer+addr log formatting via `LogPeer`",
      "body": "This is an alternative to #34293, but aims to address the remaining logging inconsistencies more broadly.\r\nIt extends the example fixed there to every instance, restores the original separator behavior, applies it consistently via a single helper, and adds tests for `logips` (covering both current and new behavior).\r\n\r\n### Problem\r\nAfter #28521 centralized peer address logging into `CNode::LogIP()`, the original comma separator before `peeraddr=` was lost, resulting in inconsistent formatting across net (and recent private broadcast) logs.\r\nSome lines also had double spaces, empty fields, or mismatched format specifiers.\r\n\r\n### Fix\r\nIntroduces `CNode::LogPeer(bool)` which always emits `peer=<id>` and, when `-logips=1`, appends `, peeraddr=<addr>`. This eliminates hand-rolled separators and makes peer identification predictable.\r\nMinor issues (double spaces, empty placeholders, format specifiers) are fixed along the way in separate commits.\r\n\r\n### Reproducer\r\nRun with `-debug=net -logips=1` and observe peer log lines now show `peer=<id>, peeraddr=<addr>` (comma-separated). The new assertion in `feature_logging.py` automates this check.\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-23T12:09:26Z",
      "updated_at": "2026-01-27T15:53:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34389",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1214,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3169361001,
      "number": 34271,
      "title": "net_processing: make m_tx_for_private_broadcast optional",
      "body": "Make `PeerManagerImpl::m_tx_for_private_broadcast` optional because it is needed for in private broadcast mode (`-privatebroadcast=1`).\r\n\r\nA followup to #29415, requested in:\r\nhttps://github.com/bitcoin/bitcoin/pull/29415#discussion_r2620864832\r\nhttps://github.com/bitcoin/bitcoin/pull/29415/files#r2620864832",
      "state": "open",
      "user": "vasild",
      "created_at": "2026-01-13T11:32:27Z",
      "updated_at": "2026-01-27T15:39:01Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34271",
      "labels": [
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 366,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2471245988,
      "number": 32317,
      "title": "kernel: Separate UTXO set access from validation functions",
      "body": "The current code makes it hard to call functions for checking the consensus-correctness of a block without having a full UTXO set at hand. This makes implementing features such as Utreexo and non-assumevalid swiftsync, where maintaining a full UTXO set defeats their purpose, through the kernel API difficult. Checks like the coinbase subsidy, or block sigops are only available through `ConnectBlock`, which requires a complete coins cache.\r\n\r\nSolve this by moving accessing coins and the responsibility of spending them out of `ConnectBlock` and into a new separate function called `SpendBlock`. Pass a block's spent coins through the existing `CBlockUndo` data structure to `ConnectBlock`. \r\n\r\nWhile the change is largely a refactor, some smaller behaviour changes were unavoidable. These should be highlighted in the commit messages. The last commit contains the most important part of the coins logic move, the commits before attempt to prepare it piecemeal.\r\n\r\nThis pull request was benchmarked on [benchcoin](https://github.com/bitcoin-dev-tools/benchcoin/pull/162), which showed no performance regression. While discussing this pull request it was noted that pre-fetching and eliminating the need for some additional map lookups might improve performance a bit, but this does not make a measurable difference in the grand scheme of things and was not the motivation for this pull request.\r\n\r\nIn future changes, ConnectBlock could be made even more self contained, accessing the coins from the internal map could be further optimized by consolidating existence checking and spending, and the function eventually exposed in an external kernel API (as done [here](https://github.com/sedited/bitcoin/commit/09e05493010119fc60d310d3e7ffc388de441f9a#diff-f638e65d9278276b2a6ac42ffbbd26d079c3dba752feed5038a25a1ee565d320R947))",
      "state": "open",
      "user": "sedited",
      "created_at": "2025-04-21T13:15:46Z",
      "updated_at": "2026-01-27T14:44:57Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32317",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1886,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3207254787,
      "number": 34400,
      "title": "wallet: parallel fast rescan (approx 5x speed up with 16 threads)",
      "body": "This PR uses @furszy's ThreadPool from https://github.com/bitcoin/bitcoin/pull/33689 to implement parallel fast rescan. The ThreadPool commit has been cherry-picked into this PR for use.\r\n\r\nThis PR:\r\n- Adds a `ThreadPool` to the `WalletContext` to be shared by all the wallets\r\n- Adds `-walletpar` parameter to configure the number of threads to be used for parallel scanning \r\n- Updates the `wallet_fast_rescan.py` test to ensure it catches cases where the FastRescan filter wasn't properly updated. This is crucial to ensure that changes in the PR do not cause newly added output scripts to be missed.\r\n- Refactors `ScanForWalletTransactions` to make the implementation of parallel scanning easier.\r\n- Implements parallel scanning\r\n\r\nBenchmarks:\r\n**NOTE: to reproduce, please tune your system with `pyperf system tune`**\r\n\r\nUsing the following command on mainnet with a wallet with no scripts:\r\n```\r\nhyperfine --show-output --export-markdown results.md --export-json results.json  \\\r\n--sort command \\\r\n--runs 3 \\\r\n-L commit ef847e8,37d356b \\\r\n-L num_threads 1,2,4,8,16 \\\r\n--prepare 'git checkout {commit} && cmake --build build -j 20 && build/bin/bitcoind -walletpar={num_threads} && sleep 10' \\\r\n--conclude 'build/bin/bitcoin-cli stop && sleep 10' \\\r\n'build/bin/bitcoin-cli rescanblockchain 500000 900000'\r\n```\r\nI obtained the following results:\r\n| Command | Mean [s] | Min [s] | Max [s] | Relative |\r\n|:---|---:|---:|---:|---:|\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = baseline, num_threads = ..)` | 536.996 ± 0.722 | 536.257 | 537.701 | 4.64 ± 0.01 |\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = parallel_scan, num_threads = 1)` | 540.210 ± 2.696 | 537.172 | 542.320 | 4.67 ± 0.03 |\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = parallel_scan, num_threads = 2)` | 358.190 ± 0.515 | 357.675 | 358.706 | 3.10 ± 0.01 |\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = parallel_scan, num_threads = 4)` | 230.217 ± 2.321 | 228.814 | 232.896 | 1.99 ± 0.02 |\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = parallel_scan, num_threads = 8)` | 151.144 ± 1.748 | 149.506 | 152.984 | 1.31 ± 0.02 |\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = parallel_scan, num_threads = 16)` | 115.642 ± 0.305 | 115.390 | 115.982 | 1.00 |\r\n\r\nSystem information:\r\n```\r\nArchitecture:             x86_64\r\n  CPU op-mode(s):         32-bit, 64-bit\r\n  Address sizes:          46 bits physical, 48 bits virtual\r\n  Byte Order:             Little Endian\r\nCPU(s):                   20\r\n  On-line CPU(s) list:    0-19\r\nVendor ID:                GenuineIntel\r\n  Model name:             Intel(R) Core(TM) Ultra 7 265\r\n    CPU family:           6\r\n    Model:                198\r\n    Thread(s) per core:   1\r\n    Core(s) per socket:   1\r\n    Socket(s):            20\r\n    Stepping:             2\r\n    CPU(s) scaling MHz:   41%\r\n    CPU max MHz:          4800.0000\r\n    CPU min MHz:          800.0000\r\n    BogoMIPS:             4761.60\r\n```\r\n\r\nFurther benchmarks were performed using a [python script](https://github.com/Eunovo/rescan-benchmark/blob/main/rescan_benchmark.patch) with custom chains designed with payments at specified intervals, and the following graph was produced:\r\n\r\n<img width=\"4760\" height=\"8950\" alt=\"benchmark_comparison\" src=\"https://github.com/user-attachments/assets/1ba8c64d-cfca-4360-af06-1f034a30e307\" />\r\n\r\nThis graph was produced from a laptop with the following CPU specifications:\r\n```\r\nArchitecture:                x86_64\r\n  CPU op-mode(s):            32-bit, 64-bit\r\n  Address sizes:             48 bits physical, 48 bits virtual\r\n  Byte Order:                Little Endian\r\nCPU(s):                      16\r\n  On-line CPU(s) list:       0-15\r\nVendor ID:                   AuthenticAMD\r\n  Model name:                AMD Ryzen 9 8945HS w/ Radeon 780M Graphics\r\n    CPU family:              25\r\n    Model:                   117\r\n    Thread(s) per core:      2\r\n    Core(s) per socket:      8\r\n    Socket(s):               1\r\n    Stepping:                2\r\n    Frequency boost:         enabled\r\n    CPU(s) scaling MHz:      63%\r\n    CPU max MHz:             5263.0000\r\n    CPU min MHz:             400.0000\r\n```\r\n\r\nAll materials for the custom benchmarks can be found [here](https://github.com/Eunovo/rescan-benchmark).\r\n\r\nAlthough not explicitly checked with Valgrind, hyperfine reported that memory usage stayed the same across all runs. I'm not sure to what degree hyperfine's memory usage report can be trusted, but the PR limits the amount of block hashes that can be held in memory for processing to `1000` (not configurable by the user).\r\n\r\n\r\nAll benchmarks were performed against https://github.com/bitcoin/bitcoin/pull/34400/commits/37d356bbbe3efed3c7c9e64fae1bac3f4d0ec6eb instead of master because `-walletpar` is implemented here, and the benchmark scripts would otherwise break, or more complicated scripts would be required to accommodate master.\r\n",
      "state": "open",
      "user": "Eunovo",
      "created_at": "2026-01-24T19:46:16Z",
      "updated_at": "2026-01-27T14:38:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34400",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 5051,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2138649533,
      "number": 31132,
      "title": "validation: fetch block inputs on parallel threads 3x faster IBD",
      "body": "_Parts of this PR are isolated in independent smaller PRs to ease review:_\r\n\r\n* [ ] _https://github.com/bitcoin/bitcoin/pull/34164_\r\n* [ ] _https://github.com/bitcoin/bitcoin/pull/34165_\r\n\r\n---\r\n\r\nThis PR parallelizes fetching all input prevouts of a block during block connection, achieving over 3x faster IBD performance in some scenarios[^1][^2][^3][^4][^5].\r\n\r\n### Problem\r\n\r\nCurrently, when fetching inputs in `ConnectBlock`, each input is fetched from the cache sequentially. A cache miss requires a round trip to the disk database to fetch the outpoint and insert it into the cache. Since the database is read-only during `ConnectBlock`, we can fetch all inputs of a block in parallel on multiple threads while connecting.\r\n\r\n### Solution\r\n\r\nWe introduce a new `CoinsViewCacheAsync` `CCoinsViewCache` subclass that manages worker threads to fetch block inputs in parallel. The block is passed to the `CoinsViewCacheAsync` view before entering `ConnectBlock`, which kicks off the worker threads to begin fetching the inputs. The view is then passed to `ConnectBlock` since it provides the same API as `CCoinsViewCache`. The cache returns fetched coins as they become available via the overridden `FetchCoin` method. If not available yet, the main thread also fetches coins as it waits.\r\n\r\n### Implementation Details\r\n\r\nThe `CoinsViewCacheAsync` implements a lock-free MPSC (Multiple Producer, Single Consumer) queue design:\r\n\r\n- **Work Distribution**: Collects all input prevouts into a queue and uses a barrier to start all worker threads simultaneously\r\n- **Synchronization**: Worker threads use an atomic counter to claim which inputs to fetch, and each input has an atomic flag to signal completion to the main thread\r\n- **Main Thread Processing**: The main thread waits for inputs in order and moves their `Coin` into the `cacheCoins` map as they become available.\r\n- **Work Stealing**: If the main thread catches up to the workers, it assists with fetching to maximize parallelism\r\n- **Completion**: All threads synchronize on a barrier via a `Reset` method, which ensures all threads are parked before proceeding\r\n\r\n### Safety and Correctness\r\n\r\n- The `CoinsViewCacheAsync` works on a block that has not been fully validated, but it does not interfere or modify any of the validation during `ConnectBlock`\r\n- It simply fetches inputs in parallel, which must be fetched before a transaction is validated anyways\r\n- **Invalid blocks**: If an invalid block is mined, the temporary cache is reset without being flushed. This is an improvement over the current behavior, where existing inputs are inserted into the main `CoinsTip()` cache when pulled through for an invalid block\r\n\r\n### Performance\r\n\r\nBenchmarks show over 3x faster IBD performance in a cloud environment with network connected storage[^1], 3x faster IBD for an M4 Mac and up to 46% faster with directly connected storage[^2][^3][^4][^5]. The parallelization of expensive disk lookups provides significant speedup.\r\n\r\n[Flamegraphs show how the execution is changed](https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3617315125).\r\n\r\n### Credits\r\n\r\nInspired by [this comment](https://github.com/bitcoin/bitcoin/pull/18941#issuecomment-638553680).\r\n\r\nResolves https://github.com/bitcoin/bitcoin/issues/34121.\r\n\r\n[^1]: https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3678847806\r\n[^2]: https://github.com/bitcoin/bitcoin/pull/31132#pullrequestreview-3515011880\r\n[^3]: https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3463894000\r\n[^4]: https://github.com/bitcoin/bitcoin/pull/31132#pullrequestreview-3347436866\r\n[^5]: https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3488760623",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2024-10-22T14:40:28Z",
      "updated_at": "2026-01-27T14:10:32Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31132",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3751,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 341661607,
      "number": 17493,
      "title": "util: Forbid ambiguous multiple assignments in config file",
      "body": "<!-- begin based-on -->\n**This is based on #16545 + #17580.** The non-base commits are:\n\n- [`d8dd3ef3144` util: Forbid ambiguous multiple assignments in config file](https://github.com/bitcoin/bitcoin/pull/17493/commits/d8dd3ef314407b1c13f2b5d6e8c7608878736ca5)\n- [`24078e372fa` test: Extend util_ArgsMerge test to check for \"Multiple values specified\" errors](https://github.com/bitcoin/bitcoin/pull/17493/commits/24078e372fa35717e3330721914136ab14a19834)<!-- end -->\n\n---\n\nEnable error \"Multiple values specified for -setting in same section of config file.\", for ALLOW_ANY settings that don't specify ALLOW_LIST.\n\nInstead of silently ignoring settings, this change makes it an error to provide an ambiguous config file that provides assigns multiple values to a single-value setting. Change includes release notes.\n\nPart of the motivation for this change is to improve usability and prevent settings that look valid from being silently ignored. Another motivation is to be able to remove confusing \"reverse precedence\" logic in #17581",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2019-11-15T22:11:44Z",
      "updated_at": "2026-01-27T13:51:51Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/17493",
      "labels": [
        "Refactoring",
        "Utils/log/libs",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1096,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 344943058,
      "number": 17580,
      "title": "refactor: Add ALLOW_LIST flags and enforce usage in CheckArgFlags",
      "body": "<!-- begin based-on -->\n**This is based on #16545.** The non-base commits are:\n\n- [`5e3583b295d` common: Add support for combining ArgsManager flags](https://github.com/bitcoin/bitcoin/pull/17580/commits/5e3583b295d3b47466bff325b49ee6219cc88a3a)\n- [`2d9f706e7ab` scripted-diff: Add ALLOW_LIST flag to arguments retrieved with GetArgs](https://github.com/bitcoin/bitcoin/pull/17580/commits/2d9f706e7ab09f6c21bf9e080616a1c607a3aea9)\n- [`482989ddee6` refactor: Fix more ALLOW_LIST arguments](https://github.com/bitcoin/bitcoin/pull/17580/commits/482989ddee6c0f0be0cb1184930c5a675da61728)\n- [`ef344f8b706` Always reject empty -blockfilterindex=\"\" arguments](https://github.com/bitcoin/bitcoin/pull/17580/commits/ef344f8b70640f8ebc179e09943f654f54b8756b)\n- [`07bdd5ac3e5` refactor: Stop calling GetArg/IsArgSet on ALLOW_LIST options](https://github.com/bitcoin/bitcoin/pull/17580/commits/07bdd5ac3e541e2c8f40c91de24cdbd8d5a8d179)\n- [`6f506623804` refactor: Always enforce ALLOW_LIST in CheckArgFlags](https://github.com/bitcoin/bitcoin/pull/17580/commits/6f5066238047501d3d9d9f8eb2da7f55f6c32dd7)<!-- end -->\n\n---\n\nExcept for two `rpcauth` and `blockfilterindex` fixes (update: rpcauth fix was merged separately in #30401) this PR does not change any behavior outside of tests. It is just supposed to enforce internal consistency and prevent bugs by ensuring that list arguments are always retrieved with GetArgs() and non-list arguments are always retrieved with GetArg(). Followup PRs could use the ALLOW_LIST flags for better documentation and error checking in the future. For example, #17493 builds on this to disallow conflicting config values. \n\nThis change was originally made as part of #17493",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2019-11-24T20:05:39Z",
      "updated_at": "2026-01-27T13:51:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/17580",
      "labels": [
        "Refactoring",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1763,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 344944113,
      "number": 17581,
      "title": "refactor: Remove settings merge reverse precedence code",
      "body": "<!-- begin based-on -->\n**This is based on #16545 + #17580 + #17493.** The non-base commits are:\n\n- [`f50e5fe9bed` refactor: Remove settings merge reverse precedence code](https://github.com/bitcoin/bitcoin/pull/17581/commits/f50e5fe9bedcb6f4a204d9e46812d506ae1f3533)<!-- end -->\n\n---\n\nThis has no effect on behavior because as of https://github.com/bitcoin/bitcoin/pull/17493 it's not possible to specify multiple values for single value settings in the config file.\n\nThis change implements one of the settings simplifications listed in #17508",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2019-11-24T20:17:13Z",
      "updated_at": "2026-01-27T13:51:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/17581",
      "labels": [
        "Refactoring",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 600,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 355780577,
      "number": 17783,
      "title": "common: Disallow calling IsArgSet() on ALLOW_LIST options",
      "body": "<!-- begin based-on -->\n**This is based on #16545 + #17580.** The non-base commits are:\n\n- [`e327e592703` Normalize inconsistent -noonlynet behavior with -privatebroadcast and -listenonion](https://github.com/bitcoin/bitcoin/pull/17783/commits/e327e592703602a4d4faf2d1c135836c7d709b2a)\n- [`bf609a93e61` common: Disallow calling IsArgSet() on ALLOW_LIST options](https://github.com/bitcoin/bitcoin/pull/17783/commits/bf609a93e61feb55b77996c324cfb6e70ca49b9f)<!-- end -->\n\n---\n\nDisallow calling IsArgSet() function on ALLOW_LIST options. Code that uses IsArgSet() with list options is confusing and leads to bugs when IsArgSet() returns true, but GetArgs() returns an empty list, so the option is considered enabled even though it is empty. This led to a number of bugs which are fixed in #30529",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2019-12-20T15:36:53Z",
      "updated_at": "2026-01-27T13:51:32Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/17783",
      "labels": [
        "Utils/log/libs",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 851,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2170572223,
      "number": 31260,
      "title": "scripted-diff: Type-safe settings retrieval",
      "body": "This PR changes the way settings are registered and retrieved to provide more compile-time safety. Currently settings are [registered](https://github.com/ryanofsky/bitcoin/blob/03cff2c1421e5db59963eba1a845ef5dd318c275/src/init.cpp#L504) and [retrieved](https://github.com/ryanofsky/bitcoin/blob/03cff2c1421e5db59963eba1a845ef5dd318c275/src/init.cpp#L173) like:\n\n```c++\n// Register setting\nargsman.AddArg(\"-pid=<file>\", strprintf(\"Specify pid file. Relative paths will be prefixed by a net-specific datadir location. (default: %s)\", BITCOIN_PID_FILENAME), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n\n// Retrieve setting\nargs.GetPathArg(\"-pid\", BITCOIN_PID_FILENAME)\n```\n\nBut this is not ideal because nothing checks that setting names are spelled correctly, or that default values (`BITCOIN_PID_FILENAME`) are used consistently in the help string and retrieval sites, or that settings are retrieved with consistent types (bool, int, string, path, or list). This PR addresses these issues by adding setting [declarations](https://github.com/ryanofsky/bitcoin/blob/416860fc360b3d5aa1a0782ab8f8454b46e6d657/src/init_settings.h#L267-L270) which allow settings to be [registered](https://github.com/ryanofsky/bitcoin/blob/416860fc360b3d5aa1a0782ab8f8454b46e6d657/src/init.cpp#L484) and [retrieved](https://github.com/ryanofsky/bitcoin/blob/416860fc360b3d5aa1a0782ab8f8454b46e6d657/src/init.cpp#L164C38-L164C59) like:\n\n```c++\n// Declare setting\nusing PidSetting = common::Setting<\n    \"-pid=<file>\", fs::path, {.legacy = true},\n    \"Specify pid file. Relative paths will be prefixed by a net-specific datadir location. (default: %s)\">\n    ::DefaultFn<[] { return BITCOIN_PID_FILENAME; }>;\n\n// Register setting\nPidSetting::Register(argsman);\n\n// Retrieve setting\nPidSetting::Get(args)\n```\n\n---\n\n#### Suggestions for review\n\nAll the real changes in this PR are in the last scripted-diff commit:\n\n- [scripted-diff: Replace AddArgs / GetArgs calls with Setting Register / Get calls](https://github.com/bitcoin/bitcoin/pull/31260/commits/fc2591a35b0640adc0df686b0f8bed5f50ada9ce)\n\nIf you take a few minutes to look at the changes applied in this scripted-diff commit, you'll understand everything this PR is doing. A good place to start looking around in this commit is the generated [`src/init_settings.h`](https://github.com/ryanofsky/bitcoin/blob/pr/scripty/src/init_settings.h) file which declares the settings that get registered in [src/init.cpp](https://github.com/ryanofsky/bitcoin/blob/pr/scripty/src/init.cpp). Then you can look at the surrounding diffs and see they are just replacing `AddArg` and `GetArg` calls.\n\nThe other notable commit is second commit, which implements the `Setting` class:\n\n- [common: Add Setting class to support typed Settings](https://github.com/bitcoin/bitcoin/pull/31260/commits/e1f016180746db0eebc2c2e1e0786f0cc5da8a43)\n\nThe other commits do minor things like moving code or updating linters. The python script that implements the scripted diff is a temporary artifact that gets deleted. The python script is complicated because it does things like parsing c++ code to extract help strings, and figuring out the right types to declare settings with so code compiles. But the entire scope of the script is to (1) generate Setting type definitions, (2) add #includes, and (3) replace `AddArg()` calls with `Register()` calls and `GetArg()` calls with `Get()` calls. So there is not much the script can actually do wrong without triggering build and test failures.\n\n---\n\n#### Extensions\n\nThis PR only adds the ability to declare individual settings with built-in types. It doesn't provide any new runtime behavior, but a branch in issue #22978 extends the `Setting` class implemented here to support runtime setting validation, additional types like `std::variant`, additional conversion options, custom types, custom validation, and groups of settings declared as options structs.\n\nThis change is mostly orthogonal to #16545. #16545 only provides runtime type checking while this PR only provides compile-time checking with no new runtime behavior. But this change does allow a nicer way of declaring types in #16545, using c++ types like `int` instead of flags like `ALLOW_INT`, or`std::vector<std::string>` instead of `ALLOW_STRING | ALLOW_LIST`.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-11-08T22:34:46Z",
      "updated_at": "2026-01-27T13:47:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31260",
      "labels": [
        "Refactoring",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 4326,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3167372056,
      "number": 34267,
      "title": "net: avoid unconditional `privatebroadcast` logging (+ warn for debug logs)",
      "body": "### Motivation\r\nThe recently merged [private broadcast](https://github.com/bitcoin/bitcoin/pull/29415) is a privacy feature, and users may share `debug.log` with support.\r\nUnconditional `LogInfo()` messages that mention private broadcast and/or include (w)txids can leak sensitive context (e.g. which transactions a user originated).\r\nSince it's meant to be a private broadcast, we should minimize leaks.\r\nIt's a best effort, it's not invalidated by other logs possibly leaking identifiable information, those can be addressed separately.\r\nWe're not promising that the logs won't ever contain data that could be used against the user, but we should still try to minimize that data, especially for a feature that's advertised as privacy-focused.\r\n\r\nFollow up to [#29415 (comment)](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2637012294)\r\n\r\n### Changes\r\n* Move private-broadcast event logs from `LogInfo()` to `LogDebug(BCLog::PRIVBROADCAST, ...)`, so they are only emitted when `-debug=privatebroadcast` was explicitly provided.\r\n* Remove hardcoded `\"[privatebroadcast]\"` log-string prefixes (category logging already adds the prefix).\r\n* Keep warning at the default log level for startup failures.\r\n* Add an init log (not a warning since that would require excessive test framework updates) when any `-debug` categories are enabled that additional logs may contain privacy-sensitive information and should not be shared publicly.\r\n* Update a related startup arg (`-logips`) to clarify that clarify that non-debug logs can also contain IP addresses.\r\n\r\n### Reproducer\r\nThe new warning can be checked with:\r\n```bash\r\n./build/bin/bitcoind -printtoconsole=1 -stopatheight=1 -listen=0 -connect=0 | grep 'Debug logging is enabled' | wc -l\r\n       0\r\n./build/bin/bitcoind -printtoconsole=1 -stopatheight=1 -listen=0 -connect=0 -debug | grep 'Debug logging is enabled' | wc  -l\r\n       1\r\n```\r\n",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2026-01-12T21:25:29Z",
      "updated_at": "2026-01-27T13:44:37Z",
      "merged_at": "2026-01-27T11:59:42Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34267",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1976,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2546204820,
      "number": 32624,
      "title": "fuzz: wallet: add target for `MigrateToDescriptor`",
      "body": "This PR adds fuzz coverage for the scriptpubkeyman migration (`MigrateToDescriptor`). Note that it's a test for the migration of the scriptpubkey manager, not for the whole migration process as tried in #29694, because:\r\n1) The wallet migration deals with DBs which is expensive for fuzzing (was getting around 3 exec/s);\r\n2) Mocking would require lots of refactors.\r\n\r\nThis target loads keys, HDChain (even inactive ones), watch only and might add tons of different scripts, then calls `MigrateToDescriptor`. It does not play with encrypted stuff because it would make the target super slow. Also, after the migration there are some assertions that would work as a regression test for https://github.com/bitcoin/bitcoin/pull/31452, for example.",
      "state": "open",
      "user": "brunoerg",
      "created_at": "2025-05-27T11:34:05Z",
      "updated_at": "2026-01-27T13:42:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32624",
      "labels": [
        "Tests",
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 796,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3213105614,
      "number": 34416,
      "title": "Add nullptr-check to CChain::Contains(), tests",
      "body": "Add unit tests to the `CChain` class, and add a nullptr-check to `CChain::Contains()` to avoid potential memory access violation by `nullptr` dereference.\r\n\r\nThe `CChain::Contains()` method (in `src/chain.h`) dereferences its input without checking. The `Next()` method also calls into this with a `nullptr` if invoked with `nullptr`. While most call sites have indirect guarantee that the input is not `nullptr`, it's not easy to establish this to all call sites with high confidence. These methods are publicly available. There is no known high-level use case to trigger this error, but the fix is easy, and makes the code safer.\r\n\r\nAlso, unit tests were added to the `CChain` class, filling a gap.\r\n\r\nChanges:\r\n\r\n- Add basic unit tests for `CChain` class methods\r\n- Add a nullptr-check to `CChain::Contains()`\r\n- Add unit tests for `CChain::FindFork()`. These are lengthier, and not closely related to the topic of the PR, could be removed, but kept for extra test coverage.\r\n\r\nAlternative. I have considered changing `Contains()` to take a reference instead of pointer, to better express that it cannot take a `nullptr` input. It's a viable solution, requires update to only a handful of call sites (solution available on branch `cchain-contains1`). However, since most `CChain` logic operates with pointers and pointer comparison, it would break the style, so I dropped this solution.\r\n\r\nThis change is remotely related to and partly triggered by #32875 .\r\n",
      "state": "open",
      "user": "optout21",
      "created_at": "2026-01-27T05:25:08Z",
      "updated_at": "2026-01-27T13:23:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34416",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1509,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3201053750,
      "number": 34383,
      "title": "ci: remove commit count limit from `test-each-commit`",
      "body": "### Problem\r\n\r\n`test-each-commit` currently tests only a limited number of ancestor commits in a PR, so failures introduced deeper in the commit stack might be missed.\r\n\r\n### Fix\r\n\r\nRemove the max-count limit so `test-each-commit` runs the full build + unit + functional test flow on every non-head PR commit, while keeping the PR tip excluded because it is already covered by the normal CI jobs.\r\n\r\n### Examples\r\n* Example failure 10 commits deep: https://github.com/l0rinc/bitcoin/actions/runs/21390976651/job/61577575033?pr=105 in https://github.com/l0rinc/bitcoin/pull/105\r\n* Example pass with >7 dummy commits: https://github.com/l0rinc/bitcoin/actions/runs/21392557521/job/61595159841?pr=106 in https://github.com/l0rinc/bitcoin/pull/106\r\n\r\n---------\r\n\r\nNote: this PR has gone through a few iterations, the latest one just extends the existing job.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-22T21:38:21Z",
      "updated_at": "2026-01-27T12:55:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34383",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 908,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3204869606,
      "number": 34395,
      "title": "test: rename `assert_greater_than(_or_equal)` to `assert_gt`/`assert_ge`",
      "body": "### Problem\r\n\r\nThe functional test framework's `assert_greater_than` and `assert_greater_than_or_equal` helper names are verbose, discouraging their use despite providing better error messages for debugging intermittent failures.\r\nThey're also using a different nomenclature for comparison than what we're used to on C++ side.\r\n\r\n### Fix\r\n\r\nRename them to `assert_gt` and `assert_ge` via a scripted diff to align with the C++ `BOOST_CHECK_GT`/`BOOST_CHECK_GE` naming.\r\n\r\nDiscussed in https://github.com/bitcoin/bitcoin/pull/34328#discussion_r2705415238",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2026-01-23T21:04:14Z",
      "updated_at": "2026-01-27T12:52:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34395",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 625,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3205772064,
      "number": 34398,
      "title": "refactor: Include function info in runtime errors",
      "body": "Some runtime errors in `wallet/scriptpubkeyman.cpp` include function information while others do not. Refactor the code to consistently include function info throughout the file.",
      "state": "closed",
      "user": "Chand-ra",
      "created_at": "2026-01-24T05:15:49Z",
      "updated_at": "2026-01-27T12:52:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34398",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 228,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3214357714,
      "number": 34417,
      "title": "log: Print warning about privacy-sensitive log info unconditionally",
      "body": "There is a warning about logs containing privacy-sensitive information. However, it is only printed when at least one debug log category is enabled.\r\n\r\nThis is confusing, because:\r\n\r\n* Setting (let's say) `-debug=reindex` enables this warning, but it is hard to see what sensitive logs could be contained in reindex debug logs.\r\n* Dropping `-debug=reindex` again disabled this warning, but the wallet continues to log txids (and other sensitive stuff) at info level.\r\n\r\nSo instead of implying the wrong thing, it would be better to remove this log line (because it should be common sense), or log it unconditionally.\r\n\r\n",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-27T12:19:24Z",
      "updated_at": "2026-01-27T12:51:47Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34417",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 688,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2212829726,
      "number": 31410,
      "title": "qa: Fix `wallet_multiwallet.py`",
      "body": "Fixes https://github.com/bitcoin/bitcoin/issues/31409.\r\n\r\nThe first commit prevents possible false positives by ensuring that each condition potentially causing the \"Error scanning\" log message is tested separately.\r\n\r\nThe second commit disables a problematic check on Windows.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2024-12-03T13:37:11Z",
      "updated_at": "2026-01-27T12:37:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31410",
      "labels": [
        "Wallet",
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 309,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3150717332,
      "number": 34213,
      "title": "net: do not read/dump anchors if network is not active",
      "body": "We currently save 2 block-relay-only (anchor) connections when stopping a node and connect to them right after starting it. However, if you start a node with network disabled (setting -networkactive=0 or disabling using the RPC), it will read the anchors, obviously will not be able to connect to them and then, when stopping the node, considering it will have 0 block-relay-only connections, it will save 0 anchors, basically deleting the previous ones. With this PR, we will only read and write the anchors if the network is active. It will avoid losing the anchors when using the node without network activity and also avoid unecessary actions (like reading the anchors even knowing we have no network activity).",
      "state": "open",
      "user": "brunoerg",
      "created_at": "2026-01-06T21:26:09Z",
      "updated_at": "2026-01-27T12:36:22Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34213",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 770,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3199113515,
      "number": 34379,
      "title": "wallet: fix `gethdkeys` RPC for descriptors with partial xprvs",
      "body": "Fixes #34378\r\n\r\nA non-watch-only wallet allows to import descriptors with partial private keys, eg: a multisig descriptor with one private key and one public key. In case an xpub is imported in any such descriptors whose private key the wallet doesn't have, then the `gethdkeys` RPC throws an unhandled error like below when the private keys are requested.\r\n\r\nThis fix ensures that such calls are properly handled by conditionally finding the corresponding xprv and the related functional test is accordingly updated.\r\n\r\n```\r\n➜ bitcoincli -named gethdkeys private=true\r\nerror code: -1\r\nerror message:\r\nmap::at:  key not found\r\n```\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "open",
      "user": "rkrux",
      "created_at": "2026-01-22T12:08:36Z",
      "updated_at": "2026-01-27T11:47:37Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34379",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 2759,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2298162380,
      "number": 31735,
      "title": "Fix compilation errors in blockchain.cpp related to serialization, UTXO dumping, and path conversion",
      "body": "issue: #31373\r\n\r\nupdated path conversion logic to handle std::string to fs::path, and addressing undeclared identifiers such as DumpUTXOSet.",
      "state": "closed",
      "user": "krishpranav",
      "created_at": "2025-01-25T14:06:48Z",
      "updated_at": "2026-01-27T11:02:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31735",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 241,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3193554767,
      "number": 34358,
      "title": "wallet: fix removeprunedfunds bug with conflicting transactions",
      "body": "`removeprunedfunds` removes all entries from `mapTxSpends` for the inputs of the pruned tx. However, this is incorrect, because there could be multiple entries from conflicting transactions (that shouldn't be removed as well). This could lead to the wallet creating invalid transactions, trying to double spend utxos.\r\nThe bug persists when the conflicting tx was mined, because the wallet trusts its internal accounting instead of calling `AddToSpends` again.\r\n\r\nThe added test should fail on master.",
      "state": "open",
      "user": "mzumsande",
      "created_at": "2026-01-21T02:40:34Z",
      "updated_at": "2026-01-27T10:59:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34358",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 565,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2696299919,
      "number": 33067,
      "title": "test: refactor ValidWitnessMalleatedTx class to helper function",
      "body": "This PR refactors ` ValidWitnessMalleatedTx` class into a `build_malleated_tx_package` function. As a result, two tests are updated:  `mempool_accept_wtxid` and `p2p_p2p_private_broadcast`. Also included are a  few small refactors in mempool_accept_wtxid , (switching to MiniWallet, using a pre-mined chain, using txid directly.)\r\n\r\nTogether, these changes reduce complexity and improve test runtime.\r\n\r\n\r\n",
      "state": "closed",
      "user": "naiyoma",
      "created_at": "2025-07-26T00:34:36Z",
      "updated_at": "2026-01-27T10:10:49Z",
      "merged_at": "2026-01-27T10:10:49Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33067",
      "labels": [
        "Refactoring",
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 470,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3113678434,
      "number": 34100,
      "title": "doc: Use multipath descriptors in descriptors.md and linked test",
      "body": "Updates documentation and `wallet_miniscript_decaying_multisig_descriptor_psbt.py` to use single multipath descriptors with `<0;1>` syntax instead of separate external/internal descriptors.\n\n## Changes\n- **doc/descriptors.md**: Update examples (lines 70-71) to use `/<0;1>/*` multipath syntax\n- **doc/descriptors.md**: Update Basic Multisig Example instructions (line 179) to use single multipath descriptor\n- **test/functional/wallet_miniscript_decaying_multisig_descriptor_psbt.py**: Refactor to use single multipath descriptor pattern matching `wallet_multisig_descriptor_psbt.py`\n\n## Implementation\n- `_get_xpub()` now extracts external descriptor and converts to multipath format\n- `create_multisig()` imports single descriptor that expands to receive and change addresses\n- Removed fake checksums from documentation examples\n- Added clear comments documenting multipath convention\n\nFixes #34086",
      "state": "open",
      "user": "anuragchvn-blip",
      "created_at": "2025-12-18T12:59:17Z",
      "updated_at": "2026-01-27T09:20:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34100",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 965,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3143827627,
      "number": 34198,
      "title": "wallet: fix ancient wallets migration",
      "body": "We currently fail migration if the wallet does not contain the best block locator.\r\nThis is a problem for wallets created before https://github.com/bitcoin/bitcoin/pull/152, which are not storing such record.\r\n\r\nMissing this record is not an error. it simply means the wallet will scan the chain prior\r\nto finish migration.\r\n\r\nNote:\r\nOriginally I wrote the test using a BDB library (`bsddb3`) but I wasn't happy with the\r\nnew dependency, and ended up zeroing the record length manually. I'm not sure this\r\nwill work on every platform. If it doesn't, we can just just drop the test as this can be\r\ntested manually on any ancient wallet too.",
      "state": "open",
      "user": "furszy",
      "created_at": "2026-01-03T20:03:34Z",
      "updated_at": "2026-01-27T07:47:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34198",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 677,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3209325275,
      "number": 34405,
      "title": "wallet: skip APS when no partial spend exists",
      "body": "Fixes #25150\n\nAPS (Avoid Partial Spends) runs a second coin selection pass to fully spend\nUTXOs sharing a scriptPubKey. This currently runs unconditionally, even when\nthe first selection has no partial spend. Running APS unnecessarily wastes\ncomputation and can produce a worse result when there was nothing to fix.\n\nDetect partial spends by comparing selected vs available UTXO counts per\nscriptPubKey, reusing available_coins. Skip APS if none found.\n\nTest updated to create partial spend scenarios so tracepoints fire.\n\n---\n\n*Supersedes #34362 which was corrupted by a shallow clone force-push.*",
      "state": "open",
      "user": "8144225309",
      "created_at": "2026-01-26T04:36:55Z",
      "updated_at": "2026-01-27T06:35:18Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34405",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 644,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2630378925,
      "number": 32844,
      "title": "RPC/txoutproof: Support including (and verifying) proofs of wtxid",
      "body": "Feature requested by @SomberNight for Electrum's Lightning stuff. (Please confirm this does what you need)\r\n\r\nUnfortunately WIP because the wtxid merkle root calculation doesn't match and I don't have time to figure out why not yet (maybe after concept ACK? or if anyone else wants to take a look...)\r\n\r\nMostly backward compatible, but a segwit-enabled proof will verify the generation tx in old versions.",
      "state": "open",
      "user": "luke-jr",
      "created_at": "2025-06-30T23:05:05Z",
      "updated_at": "2026-01-27T00:18:10Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32844",
      "labels": [
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 2,
        "text_length": 471,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3176535463,
      "number": 34299,
      "title": "wallet: re-activate \"AmountWithFeeExceedsBalance\" error",
      "body": "picks up https://github.com/bitcoin/bitcoin/pull/25269.\r\n\r\n`AmountWithFeeExceedsBalance` error inside `WalletModel::prepareTransaction` is never thrown and remains an unused code path. This is because `createTransaction` does not retrieve the fee when the process fails. The fee return arg is set only at the end of the process, when the transaction is successfully created. Therefore, if the transaction creation fails, the fee is not available inside `WalletModel::prepareTransaction` to trigger the `AmountWithFeeExceedsBalance` error.\r\n\r\nThis PR re-implements the feature inside `CreateTransactionInternal` and adds test coverage for it.\r\n\r\n| on master | on PR |\r\n|-----------|-------|\r\n| <img src=\"https://github.com/user-attachments/assets/a903e687-2466-42c7-b898-5dec24bfe515\" width=\"750\" alt=\"Insufficient funds\" /> | <img src=\"https://github.com/user-attachments/assets/74bb3c83-6132-4c09-91f0-0a446618b3c8\" width=\"750\" alt=\"AmountWithFeeExceedsBalance\" /> |\r\n\r\nthe unreachable code path is removed in https://github.com/bitcoin-core/gui/pull/807 which requires this PR.\r\n",
      "state": "open",
      "user": "stratospher",
      "created_at": "2026-01-15T09:06:21Z",
      "updated_at": "2026-01-26T23:00:52Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34299",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1137,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2991771825,
      "number": 33828,
      "title": "Check required interfaces before generating manpages",
      "body": "Guard manpage generation by reading bitcoin-build-config.h and exiting if HAVE_SYSTEM, ENABLE_WALLET, or WITH_ZMQ are off, and provide a short hint so contributors rebuild with the right flags instead of committing incomplete manpages.\n\nFixes #17506 \n\nOverride by using the SKIP_BUILD_OPTIONS_CHECK environment variable if you really need a custom-fit manpage (see bitcoin/bitcoin#29457 (comment)).",
      "state": "open",
      "user": "151henry151",
      "created_at": "2025-11-08T20:50:34Z",
      "updated_at": "2026-01-26T22:44:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33828",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 451,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3079464109,
      "number": 34028,
      "title": "p2p: saturate LocalServiceInfo::nScore to prevent overflow",
      "body": "This prevents signed integer overflow in `LocalServiceInfo::nScore` by saturating at `std::numeric_limits<int>::max()` in `SeenLocal()`.\r\n\r\nThe `nScore` field could overflow from `INT_MAX` to `INT_MIN` when incremented during version handshakes, causing undefined behavior.\r\n\r\nI implemented saturation in `SeenLocal()` to cap `nScore` at `std::numeric_limits<int>::max()` instead of allowing overflow. This prevents undefined behavior while maintaining memory efficiency - after 2 billion connections, the matter is settled.\r\n\r\n- Added test case `LocalAddress_nScore_Overflow` that verifies saturation behavior\r\n- Test confirms `nScore` remains at max value after multiple `SeenLocal()` calls\r\n\r\nFixes #24049",
      "state": "open",
      "user": "codeabysss",
      "created_at": "2025-12-07T20:08:41Z",
      "updated_at": "2026-01-26T22:36:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34028",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 767,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2713577873,
      "number": 33117,
      "title": "Interfaces: Expose UTXO Snapshot Loading and Add Progress Notifications",
      "body": "# Add UTXO Snapshot Loading Interface and Progress Notifications\r\n\r\nThis PR implements a complete interface for loading UTXO snapshots through the GUI, including progress notifications to provide user feedback during the loading process.\r\n\r\n---\r\n\r\n## Changes\r\n\r\n### Commit 1: `interfaces: expose UTXO snapshot loading in node interface`\r\n\r\n- Added a new virtual method `loadSnapshot` to the node interface for loading UTXO snapshots.\r\n- Updated the implementation in `interfaces.cpp` to activate the snapshot using the provided file and metadata.\r\n- This change enhances the user's ability to load UTXO snapshots through the GUI.\r\n\r\n### Commit 2: `notifications: Implement snapshot load progress notifications`\r\n\r\n- Added a new signal `SnapshotLoadProgress` for snapshot load progress in the UI interface.\r\n- Updated the notifications interface to include a method for reporting snapshot loading progress.\r\n- Enhanced the `ChainstateManager` to report progress during snapshot loading.\r\n- Implemented the necessary handler in the kernel notifications to relay progress updates.\r\n- This change improves user feedback during the snapshot loading process.\r\n\r\n### Commit 3: `rpc: refactor loadtxoutset to use snapshot interface`\r\n\r\n- Updated the loadtxoutset RPC to call the new snapshot interface instead of directly working with chainstate internals.\r\n- Added getMetadata and getActivationResult methods to the snapshot interface to provide parity with the legacy RPC.\r\n- Improves modularity by consolidating snapshot handling through the interface layer.\r\n\r\n---\r\n\r\n## Technical Details\r\n\r\nThe implementation includes:\r\n\r\n- **UI Interface Enhancement**\r\n  Added `SnapshotLoadProgress` signal to `CClientUIInterface` with corresponding signal declaration and implementation.\r\n\r\n- **Node Interface**\r\n  Added `loadSnapshot` virtual method to the node interface with implementation in `interfaces.cpp`.\r\n\r\n- **Progress Notifications**\r\n  Implemented `snapshotLoadProgress` method in `KernelNotifications` class to relay progress updates to the UI.\r\n\r\n- **Base Interface**\r\n  Added `snapshotLoadProgress` virtual method to the kernel notifications interface.\r\n\r\n---\r\n\r\n## Benefits\r\n\r\n- **User Experience**\r\n  Provides real-time feedback during UTXO snapshot loading operations.\r\n\r\n- **GUI Integration**\r\n  Enables loading UTXO snapshots directly through the Bitcoin Core GUI.\r\n\r\n- **Progress Tracking**\r\n  Users can monitor the progress of snapshot loading operations.\r\n\r\n- **Consistent Interface**\r\n  Follows the existing pattern for progress notifications in the codebase.\r\n\r\n## Testing\r\n\r\n- **Daemon** build and launch `bitcoind` then with `bitcoin-cli` load a snapshot using:\r\n```bash\r\n./bitcoin-cli -rpcclienttimeout=0 -signet loadtxoutset /path/to/utxo-snapsshot.dat\r\n```\r\n- **QT Widgets**: build and run [this](https://github.com/bitcoin-core/gui/pull/870) draft PR in legacy gui repo \r\n- **QML** version: for a modern look build and run [this](https://github.com/bitcoin-core/gui-qml/pull/488) PR in the newly updated gui-qml repo \r\n",
      "state": "open",
      "user": "D33r-Gee",
      "created_at": "2025-08-01T15:31:46Z",
      "updated_at": "2026-01-26T22:18:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33117",
      "labels": [
        "interfaces"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 3107,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3187452713,
      "number": 34337,
      "title": "fuzz: Return chrono point from ConsumeTime(), Add ConsumeDuration()",
      "body": "Returning a raw i64 is a bit confusing when it comes to chrono types. For example, in the addrman fuzz tests, the `time_penalty` is not a time point, but a duration.\r\n\r\nAlso, all call-sites assume second resolution right now, so document that better by returning `NodeSeconds` from `ConsumeTime(...)` and `std::chrono::seconds` from `ConsumeDuration(...)`.\r\n\r\n",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-19T11:38:51Z",
      "updated_at": "2026-01-26T21:53:30Z",
      "merged_at": "2026-01-26T11:36:29Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34337",
      "labels": [
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 428,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3211970790,
      "number": 34415,
      "title": "test: assert shift-by-zero identity for arith_uint256",
      "body": "This adds explicit unit test assertions that left- and right-shifting\r\narith_uint256 values by zero bits is identity-preserving.\r\n\r\nWhile implicitly covered by existing loops, making this invariant\r\nexplicit improves clarity and guards against future regressions.\r\n",
      "state": "closed",
      "user": "AnmolM-777",
      "created_at": "2026-01-26T20:38:39Z",
      "updated_at": "2026-01-26T20:57:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34415",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 319,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2683376326,
      "number": 33034,
      "title": "wallet: Store transactions in a separate sqlite table",
      "body": "The wallet uses SQLite as a key-value store even though SQLite is a powerful relational database engine. This causes us numerous headaches due to the need to serialize multiple fields together, and since record read from the database during loading can come in any order.\r\n\r\nNotably, for transactions, if we were able to load them in the transaction order assigned by the wallet, PRs like #27865 would be a bit simpler and easier to reason about.\r\n\r\nThis PR makes it possible for us to do that by storing transactions in a separate table. This table has a column for each field in `CWalletTx`, which lets us use a SQL statement like `SELECT * FROM transactions ORDER BY pos` which guarantees us the order in which the transactions are loaded into the wallet.\r\n\r\nThe eventual goal is to use SQLite as a relational database with tables that store our keys and other metadata that can reference each other so that the wallet doesn't just use the database as a storage mechanism. But that is still a work in progress.\r\n\r\nThis PR makes use of the last client opened features introduced in #32895 to determine when the old record style needs to be upgraded to the new transactions table. This should give us sufficient upgrade-downgrade-upgrade handling to not lose any funds.\r\n\r\nDepends on #32763, #32895, #32985, #33032, #33033",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-07-21T22:52:54Z",
      "updated_at": "2026-01-26T19:53:18Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33034",
      "labels": [
        "Wallet",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1377,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2647467829,
      "number": 32894,
      "title": "FUZZ: Test that BnB finds best solution",
      "body": "BnB’s solution is the input set with the lowest waste score, excluding any supersets of other solution candidates.\r\nThis fuzz test compares a brute force search with the BnB result to ensure that BnB succeeds.",
      "state": "open",
      "user": "murchandamus",
      "created_at": "2025-07-07T17:34:08Z",
      "updated_at": "2026-01-26T19:47:51Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32894",
      "labels": [
        "Tests",
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 249,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2550873429,
      "number": 32636,
      "title": "Split `CWallet::Create()` into `CreateNew` and `LoadExisting`",
      "body": "This PR is mostly a refactor which splits out logic used for creating wallets and for loading wallets, both of which are presently contained in `CWallet::Create()` into `CWallet::CreateNew()` and `CWallet::LoadExisting()`\r\n\r\nThe real win of this PR is that `CWallet::Create()` uses a very bad heuristic for trying to guess whether or not it is supposed to be creating a new wallet or loading an existing wallet:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/370c59261269fd9043674e0f4fd782a89e724473/src/wallet/wallet.cpp#L2882-L2885\r\n\r\nThis heuristic assumes that wallets with no `ScriptPubKeyMans` are being created, which sounds reasonable, but as demonstrated in #32112 and #32111, this can happen when the user tries to load a wallet file that is corrupted, both issues are fixed by this PR and any other misbehavior for wallet files which succeeded the broken heuristic's sniff test for new wallets.\r\n\r\nIt was already the case that every caller of `CWallet::Create()` knows whether it is creating a wallet or loading one, so we can avoid replacing this bad heuristic with another one, and just shift the burden to the caller.",
      "state": "open",
      "user": "davidgumberg",
      "created_at": "2025-05-29T00:37:09Z",
      "updated_at": "2026-01-26T18:26:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32636",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1189,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1785565107,
      "number": 29700,
      "title": "kernel, refactor: return error status on all fatal errors",
      "body": "Return util::Result objects from all functions that can trigger fatal errors.\n\nThere are many validation functions that handle failures by calling `AbortNode` and triggering shutdowns, without returning error information to their callers. This makes error handling in libbitcoinkernel application code difficult, because the only way to handle these errors is to register for [notification callbacks](https://github.com/bitcoin/bitcoin/blob/master/src/kernel/notifications_interface.h). Improve this by making all functions that trigger fatal errors return util::Result objects with the error information.\n\nThis PR is a pure refactoring that returns extra result information from functions without changing their behavior. It's a possible alternative to and subset of #29642, which adds similar return information but also makes behavior changes and exposes a FatalError type.\n\n---\n\n<!-- begin based-on -->\n**This is based on #25665.** The non-base commits are:\n\n- [`c58e61f9911` refactor, kernel: Add FlushStatus / FlushResult types](https://github.com/bitcoin/bitcoin/pull/29700/commits/c58e61f9911dbbf2e1e7b43896cccad3e4c07bc1)\n- [`be34dd34d3f` refactor: Add InfoType field to util::Result](https://github.com/bitcoin/bitcoin/pull/29700/commits/be34dd34d3f62f86a2bd742795d12fd645ab32fd)\n- [`b9f6a3666d5` refactor, blockstorage: Return FlushResult from flush methods](https://github.com/bitcoin/bitcoin/pull/29700/commits/b9f6a3666d5f64a0ada4092b507e8fe5fddbbe08)\n- [`ca795bf4b17` refactor, blockstorage: Return fatal errors from block writes](https://github.com/bitcoin/bitcoin/pull/29700/commits/ca795bf4b1740df978f586b353fe308dc9b01ac3)\n- [`85078c8dbfe` refactor, validation: Switch to result.Update](https://github.com/bitcoin/bitcoin/pull/29700/commits/85078c8dbfe5631f735d1f58b78c79900d29e857)\n- [`431621bde28` refactor, blockstorage: Return fatal error from LoadBlockIndex](https://github.com/bitcoin/bitcoin/pull/29700/commits/431621bde2822b216926988699441837b14b5cb4)\n- [`8f2d7139167` refactor, validation: Return fatal errors from FlushStateToDisk](https://github.com/bitcoin/bitcoin/pull/29700/commits/8f2d7139167e5162ca45988ff844cd58becc78c8)\n- [`b5686de0da5` refactor, validation: Return fatal errors from mempool accept functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/b5686de0da5540acb2aec035f5dfbf0f554283fe)\n- [`9eeab948953` refactor, validation: Return fatal errors from assumeutxo snapshot functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/9eeab948953330050fc10b044a9bc4cf3eff16cf)\n- [`08200e60968` refactor, validation: Return fatal errors from block connect functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/08200e6096878b85f3150d033bb9f9f9ed133ffb)\n- [`1910899d0b1` refactor, validation: Return fatal errors from activate best chain functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/1910899d0b13fa7d3db7358c1150cd9ed80d4dba)\n- [`7cefb824939` refactor, validation: Return fatal errors from new block functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/7cefb824939c3d114176f21b515520d8646a4991)\n- [`7cd8dac6b81` refactor, blockstorage: Return fatal error from ImportBlocks](https://github.com/bitcoin/bitcoin/pull/29700/commits/7cd8dac6b815636b5ffab9d4a5c309e058c3854a)\n- [`01ea9da0f4e` refactor, validation: Return more errors from VerifyDB](https://github.com/bitcoin/bitcoin/pull/29700/commits/01ea9da0f4e991e683a65ee2ebcd2164764feeaa)\n- [`f81a1a468d8` ci: Avoid -Wno-error=maybe-uninitialized false positives](https://github.com/bitcoin/bitcoin/pull/29700/commits/f81a1a468d89689524a37a27384110aa69257386)\n- [`871651378ca` tidy: Set bugprone-unused-return-value.AllowCastToVoid](https://github.com/bitcoin/bitcoin/pull/29700/commits/871651378ca0af03365040f60858a2939e4bdf68)<!-- end -->",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-03-21T23:11:56Z",
      "updated_at": "2026-01-26T18:01:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29700",
      "labels": [
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3844,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3087630130,
      "number": 34037,
      "title": "wallet, doc: clarify the coin selection filters that enforce cluster count",
      "body": "Followup to #33629.\r\n\r\nFix misleading docs and variable names. Namely, `getTransactionAncestry` returns the cluster count, not max descendant count of ancestor set (not worth reimplementing as it is merely a heuristic). No behavior changes - I don’t think much needs to be changed for the first release containing cluster mempool. \r\n\r\nCurrent `CoinEligibilityFilter`s enforce a maximum ancestor count (summed across all outputs, potentially overestimating) and max descendant count across ancestors of the output.\r\n\r\nSince #33629, these filters have started using cluster count instead of max desc count across ancestors. The change isn’t dangerous, as the cluster count bounds descendant count as well. Currently, the wallet is essentially enforcing a mixture of both limits - this is good while we are transitioning. Note that the cluster count enforced is 25, not 64, since it's grabbing the node's descendant count limit. While it is not an apples-to-apples comparison, a cluster count limit of 25 helps us avoid busting legacy descendant limits (which will be common on the network for a while).\r\n\r\nPotential things for the future, out of scope for this PR:\r\n- When we get rid of the ancestor/descendant config options, `getPackageLimits` can probably be replaced with hard-coded values.\r\n- Change the `OutputGroup`s to track the actual cluster count that results from spending these outputs and merging their clusters.\r\n- Loosen from 25 after that policy is no longer common.\r\n- Clean up `getPackageLimits`.",
      "state": "open",
      "user": "glozow",
      "created_at": "2025-12-10T01:28:11Z",
      "updated_at": "2026-01-26T17:57:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34037",
      "labels": [
        "Docs",
        "Wallet",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1588,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3210251998,
      "number": 34407,
      "title": "guix: use osslsigncode 2.11",
      "body": "Update osslsigncode used in Guix to [2.11](https://github.com/mtrojnar/osslsigncode/releases/tag/2.11).\r\n\r\nAdd zlib as an input, its a hard dependency since\r\nhttps://github.com/mtrojnar/osslsigncode/pull/303.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-26T11:28:30Z",
      "updated_at": "2026-01-26T17:29:37Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34407",
      "labels": [
        "Build system",
        "DrahtBot Guix build requested"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 236,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3205225359,
      "number": 34397,
      "title": "doc: fix arg name hints so bugprone can validate them",
      "body": "The extra leading `=` or missing trailing `=` prevented clang-tidy's `bugprone-argument-comment` check from validating the parameter name, as it only matches comments formatted strictly as `/*parameter_name=*/` (see https://clang.llvm.org/extra/clang-tidy/checks/bugprone/argument-comment.html).\r\n\r\nI have considered doing a scripted diff, but the values I found aren't so numerous and can easily be reviewed manually.",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2026-01-23T23:16:51Z",
      "updated_at": "2026-01-26T17:05:21Z",
      "merged_at": "2026-01-26T16:51:27Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34397",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 472,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2391882324,
      "number": 32061,
      "title": "Replace libevent with our own HTTP and socket-handling implementation",
      "body": "This is a major component of [removing libevent as a dependency of the project](https://github.com/bitcoin/bitcoin/issues/31194), by replacing the HTTP server used for RPC and REST with one implemented entirely within the Bitcoin Core codebase. The new `HTTPServer` class runs its own I/O thread, handling socket connections with code based on #30988, but tailored specifically for HTTP.\r\n\r\nSome functional tests were added in #32408 to cover libevent behaviors that remain consistent with this branch. \r\n\r\nCommit strategy:\r\n- Implement a few helper functions for strings, timestamps, etc needed by HTTP protocol\r\n- Isolate the existing libevent-based HTTP server in a namespace `http_libevent`\r\n- Implement HTTP in a new namespace `http_bitcoin` (classes like `HTTPRequest`, `HTTPClient`, etc...)\r\n- Switch bitcoind from the libevent server to the new server\r\n- Clean up (delete `http_libevent`)\r\n\r\nI am currently seeing about a 10% speed up in the functional tests on my own arm/macos machine.\r\n\r\n## Integration testing:\r\n\r\nI am testing the new HTTP server by forking projects that integrate with bitcoin via HTTP and running their integration tests with bitcoind built from this branch (on Github actions). I will continue adding integrations over time, and re-running these CI tests as this branch gets rebased:\r\n\r\n- [NodeJS `rpc-bitcoin`](https://github.com/pinheadmz/rpc-bitcoin/pull/1)\r\n- [electrs](https://github.com/pinheadmz/electrs/pull/1)\r\n- [lnd](https://github.com/pinheadmz/lnd/pull/1)\r\n- [eclair](https://github.com/pinheadmz/eclair/pull/1)\r\n- [corepc](https://github.com/pinheadmz/corepc/pull/1)\r\n- [bitcoinjs-lib](https://github.com/pinheadmz/bitcoinjs-lib/pull/1)",
      "state": "open",
      "user": "pinheadmz",
      "created_at": "2025-03-13T19:32:14Z",
      "updated_at": "2026-01-26T16:07:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32061",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1752,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2281949992,
      "number": 31672,
      "title": "rpc: add cpu_load to getpeerinfo",
      "body": "Add a new field `cpu_load` to the output of `getpeerinfo` RPC.\r\n\r\nIt represents the CPU time spent by the message handling thread for the given peer, weighted for the duration of the connection. That is, for example, if two peers are equally demanding and one is connected longer than the other, then they will have the same `cpu_load` number.\r\n\r\n---\r\n\r\nMonitoring CPU usage is useful on its own. Also related to https://github.com/bitcoin/bitcoin/issues/31033.\r\n\r\n---\r\n\r\nThis PR uses `clock_gettime()` (POSIX) and `GetThreadTimes()` (Windows). An alternative to those, should this be explored are: `getrusage()` (POSIX) and `QueryThreadCycleTime()` (Windows, but it counts CPU cycles).",
      "state": "open",
      "user": "vasild",
      "created_at": "2025-01-16T14:02:03Z",
      "updated_at": "2026-01-26T15:29:05Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31672",
      "labels": [
        "RPC/REST/ZMQ",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 719,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3056381185,
      "number": 33971,
      "title": "cmake: Set `WITH_ZMQ` to `ON` in Windows presets",
      "body": "The \"zeromq\" feature is already enabled by default in `vcpkg.json`, and there appears to be no reason to omit this configuration option when building on Windows.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-11-30T13:13:02Z",
      "updated_at": "2026-01-26T14:07:38Z",
      "merged_at": "2025-12-01T09:58:19Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33971",
      "labels": [
        "Windows",
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 210,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3190110147,
      "number": 34349,
      "title": "util: Remove brittle and confusing sp::Popen(std::string)",
      "body": "The subprocess Popen call that accepts a full `std::string` has many issues:\r\n\r\n* It promotes brittle and broken code, where spaces are not properly quoted. Example: https://github.com/bitcoin/bitcoin/pull/33929#discussion_r2590523065\r\n* The internally used `util::split` function does incorrectly split on spaces, instead of using `shlex.split`.\r\n* It is redundant and not needed, because a vector interface already exists.\r\n\r\nFix all issues by removing it and just using the vector interface.\r\n\r\nThis pull request should not change any behavior: Note that the command taken from `gArgs.GetArg(\"-signer\", \"\")` is still passed through the `sp::util::split` helper, just like before. Fixing that is left for a follow-up, so that this change here is basically just a refactor.\r\n\r\nThis also fixes a unit test bug as a side-effect: Fixes https://github.com/bitcoin/bitcoin/issues/32574.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-20T07:19:24Z",
      "updated_at": "2026-01-26T13:54:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34349",
      "labels": [
        "Utils/log/libs",
        "DrahtBot Guix build requested"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 940,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2502815894,
      "number": 32430,
      "title": "test: Add and use ElapseTime helper",
      "body": "Currently mocktime is written to a global, which may leak between sub-tests (albeit some tests try to reset the mocktime on a best-effort basis). Also, when advancing it, one has to keep a counter variable around.\r\n\r\nFix both issues by a new `ElapseTime` helper, which resets the mocktime once it goes out of scope. Also, it has a method to advance the mocktime by a delta.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2025-05-06T22:39:14Z",
      "updated_at": "2026-01-26T12:46:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32430",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 409,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3180151419,
      "number": 34314,
      "title": "wallet: Fix MaxSatisfactionWeight calculation for Taproot descriptors",
      "body": "This PR fixes a bug in the `MaxSatisfactionWeight` calculation for Taproot descriptors. Previously, the implementation contained a FIXME comment and only calculated keypath spend weight, leading to significant underestimations for script path spending.\r\n\r\n### What Changed:\r\n\r\n**1. TaprootDescriptor::MaxSatisfactionWeight** - Replaced the placeholder implementation with proper script path weight calculation:\r\n   - Now iterates through all subdescriptors to find the heaviest script path\r\n   - Uses `MaxSatSize()` instead of `MaxSatisfactionWeight()` for subdescriptors (Taproot SegWit v1 has a 1:1 ratio between witness bytes and weight units, unlike the 4:1 ratio in legacy SegWit v0)\r\n   - Accounts for satisfaction size, script size, and control block size\r\n   - Returns the maximum of keypath (66 weight units) and all script paths\r\n\r\n**2. PKDescriptor::MaxSatSize** - Corrected Schnorr signature size from 65 to 64 bytes (SIGHASH_DEFAULT is omitted in Schnorr signatures)\r\n\r\n**3. MultiADescriptor::MaxSatSize** - Corrected Schnorr signature size from 65 to 64 bytes\r\n\r\n**4. Added comprehensive unit tests** - New test case `descriptor_tr_max_satisfaction_weight` with:\r\n   - Test for `tr(key, pk(key))` verifying script path weight (134) exceeds keypath weight (66)\r\n   - Test for `tr(key, sortedmulti_a(2, K1, K2))` verifying complex script path calculation (235 weight units)\r\n   - Detailed comments explaining the weight calculations for each component\r\n\r\n### Why:\r\n\r\nAccurate weight estimation for Taproot descriptors is critical for:\r\n- **Fee calculation** - Underestimated weights lead to insufficient fees and transaction rejection\r\n- **Transaction size estimation** - Affects PSBT construction and validation\r\n- **Wallet coin selection** - Incorrect weights cause suboptimal UTXO selection\r\n\r\nThe tests demonstrate the bug (old code would return 66 for both cases) and prove the fix produces correct weight estimates.",
      "state": "closed",
      "user": "tboy1337",
      "created_at": "2026-01-16T07:17:28Z",
      "updated_at": "2026-01-26T11:36:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34314",
      "labels": [
        "Wallet",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 3,
        "positive_keywords": 0,
        "text_length": 2003,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3210097004,
      "number": 34406,
      "title": "ci: clean up lint install script",
      "body": "Remove duplicate curl and xz-utils installs and silence python presence check output to reduce CI noise",
      "state": "closed",
      "user": "Olexandr88",
      "created_at": "2026-01-26T10:30:51Z",
      "updated_at": "2026-01-26T10:52:01Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34406",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 136,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3189081036,
      "number": 34348,
      "title": "lib: call RandFailure() if RDRAND fails",
      "body": "While the risk of the RDRAND instruction failing in such a fashion is minor, the current implementation allows the process to continue if such an occurrence happens.\r\n\r\nChecking for such an occurrence and calling RandFailure() if it occurs is a safer alternative than failing silently.",
      "state": "open",
      "user": "michaellappas",
      "created_at": "2026-01-19T20:50:55Z",
      "updated_at": "2026-01-26T10:50:23Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34348",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 325,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2882266509,
      "number": 33522,
      "title": "guix: use LIEF 0.17.1",
      "body": "Update LIEF in Guix & the CI to 0.17.1: https://lief.re/doc/stable/changelog.html#october-25th-2025.\r\n\r\nGuix Build:\r\n```bash\r\n64adb8b9b944ef3de68dbe0d8baa45f688b0d3fa0914448ac331a5339575d697  guix-build-98a6d95a0a0a/output/aarch64-linux-gnu/SHA256SUMS.part\r\n704f85c222bfb6bd80f2253d5b9892451f932162377c1ecf7288457ad6c15aba  guix-build-98a6d95a0a0a/output/aarch64-linux-gnu/bitcoin-98a6d95a0a0a-aarch64-linux-gnu-debug.tar.gz\r\n6ab1b8070f3c7addeaee76780cdba27b7ff4c65f6b6fc53402e3863cb94abf77  guix-build-98a6d95a0a0a/output/aarch64-linux-gnu/bitcoin-98a6d95a0a0a-aarch64-linux-gnu.tar.gz\r\n5a8a30b6ea069f61d2f1373217a654f0f8883cd0c291d92837c85259e9552317  guix-build-98a6d95a0a0a/output/arm-linux-gnueabihf/SHA256SUMS.part\r\ncc771236cbd4a013e27a30ea215ea153bbb919862356358431c7aff3789ed745  guix-build-98a6d95a0a0a/output/arm-linux-gnueabihf/bitcoin-98a6d95a0a0a-arm-linux-gnueabihf-debug.tar.gz\r\n1cc32c3d361dc3fd53241c9a5749b27640186310cc74f1646f7c39f2326f4d6b  guix-build-98a6d95a0a0a/output/arm-linux-gnueabihf/bitcoin-98a6d95a0a0a-arm-linux-gnueabihf.tar.gz\r\n765ad83372fde56601c69d582da0e88e6b957e03738c2349a586dc69472a8e80  guix-build-98a6d95a0a0a/output/arm64-apple-darwin/SHA256SUMS.part\r\n4f60db487fa6b53e4876878be0849a207b1a4ccfc31a49a0a2b12c275f15d5db  guix-build-98a6d95a0a0a/output/arm64-apple-darwin/bitcoin-98a6d95a0a0a-arm64-apple-darwin-codesigning.tar.gz\r\n274cd2843ae6518c9ebc4d82e6f1e9038c1057fb923125cc484b88502f0653cc  guix-build-98a6d95a0a0a/output/arm64-apple-darwin/bitcoin-98a6d95a0a0a-arm64-apple-darwin-unsigned.tar.gz\r\nf83f12bb83cbdac89dd5d82ed9888f382506f24e0c5c5d8afaa69ac002a7820c  guix-build-98a6d95a0a0a/output/arm64-apple-darwin/bitcoin-98a6d95a0a0a-arm64-apple-darwin-unsigned.zip\r\n29c30dfc1192cafb34313921aa9329c77358914b1ab5ea6c572afeeb3a0cf791  guix-build-98a6d95a0a0a/output/dist-archive/bitcoin-98a6d95a0a0a.tar.gz\r\nd8b3d18093607cf7e54557d6701b612aea320b12f4c5750278ea8e9df98e84e8  guix-build-98a6d95a0a0a/output/powerpc64-linux-gnu/SHA256SUMS.part\r\n5cafe7a3232a25721bbd6e137327e8885cbc2dde0ad31149210be35ee63940c3  guix-build-98a6d95a0a0a/output/powerpc64-linux-gnu/bitcoin-98a6d95a0a0a-powerpc64-linux-gnu-debug.tar.gz\r\n02adb5302d4ec684e68a18de50f86c7ad7209953c293813b2366eb237290556a  guix-build-98a6d95a0a0a/output/powerpc64-linux-gnu/bitcoin-98a6d95a0a0a-powerpc64-linux-gnu.tar.gz\r\nd1d8a3a48f244095c94c03d541bea04a424b9b419fd46f924309d5a3960a4b9b  guix-build-98a6d95a0a0a/output/riscv64-linux-gnu/SHA256SUMS.part\r\nb94bb2d5ac5cc4d4e39086185d6195caba061a2a2cd783bcefadde3686f011de  guix-build-98a6d95a0a0a/output/riscv64-linux-gnu/bitcoin-98a6d95a0a0a-riscv64-linux-gnu-debug.tar.gz\r\nb372f4fab761e8a2fd3bcf65a53ca3780ba31295fe4e06118ed6c4157cf3b79f  guix-build-98a6d95a0a0a/output/riscv64-linux-gnu/bitcoin-98a6d95a0a0a-riscv64-linux-gnu.tar.gz\r\nb13b8cda5240d0b77acc41c1d313d8935af419179f6e960f574a402812efd73f  guix-build-98a6d95a0a0a/output/x86_64-apple-darwin/SHA256SUMS.part\r\nf093b5db8aefa0d2f5fa9121fdf61679cd3abe0709c888e260f0193c6377ba27  guix-build-98a6d95a0a0a/output/x86_64-apple-darwin/bitcoin-98a6d95a0a0a-x86_64-apple-darwin-codesigning.tar.gz\r\n7cf5b518b4bf11da7f865c72d356869d338054ac450e3d67c8e557d1055b556f  guix-build-98a6d95a0a0a/output/x86_64-apple-darwin/bitcoin-98a6d95a0a0a-x86_64-apple-darwin-unsigned.tar.gz\r\n69e9d0e2b75439ba687bc387002cf9b8d9e634dd1d99d74c0d2105853751214a  guix-build-98a6d95a0a0a/output/x86_64-apple-darwin/bitcoin-98a6d95a0a0a-x86_64-apple-darwin-unsigned.zip\r\n80d12585a20c593c25b389be03abf62c4a7aa64f82a192250e0d7134b8d42ee2  guix-build-98a6d95a0a0a/output/x86_64-linux-gnu/SHA256SUMS.part\r\n18d84260035542953cba39299a6f6a022ff8a652739f9fd4207f0ca8bdeed703  guix-build-98a6d95a0a0a/output/x86_64-linux-gnu/bitcoin-98a6d95a0a0a-x86_64-linux-gnu-debug.tar.gz\r\n32c5fff612ea33ce9b3a79641ba6e228713b6fe546dd1db7c4580b0798282466  guix-build-98a6d95a0a0a/output/x86_64-linux-gnu/bitcoin-98a6d95a0a0a-x86_64-linux-gnu.tar.gz\r\nf1a8d8d8c8271c7c462ff1150c47986a9b55adc701037a178eb065242e3be90f  guix-build-98a6d95a0a0a/output/x86_64-w64-mingw32/SHA256SUMS.part\r\n1959bd2e96784c71f53750a40bc0e2f90c7fe05d3bf3b4090e22b4830763ac00  guix-build-98a6d95a0a0a/output/x86_64-w64-mingw32/bitcoin-98a6d95a0a0a-win64-codesigning.tar.gz\r\n4f299e92122829810d9e75901d689682455a2500329483381524115ef4dc8c99  guix-build-98a6d95a0a0a/output/x86_64-w64-mingw32/bitcoin-98a6d95a0a0a-win64-debug.zip\r\na6864c11dadcdbc91fabec44f6c3fc17928df7c65ee8360254e4a530ce4ba344  guix-build-98a6d95a0a0a/output/x86_64-w64-mingw32/bitcoin-98a6d95a0a0a-win64-setup-unsigned.exe\r\ne5628bbed9444fe1d490688fd993ce65d9af67d584f5371fef0f92f1cc2375ed  guix-build-98a6d95a0a0a/output/x86_64-w64-mingw32/bitcoin-98a6d95a0a0a-win64-unsigned.zip\r\n```",
      "state": "open",
      "user": "fanquake",
      "created_at": "2025-10-02T15:57:55Z",
      "updated_at": "2026-01-26T10:33:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33522",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 4696,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3191299722,
      "number": 34351,
      "title": "util: Remove `FilterHeaderHasher`",
      "body": "With respect to `std::unordered_map` documentation, the `Hash` type\r\ndefined in the template is over the `Key` and not `T`, the value. This\r\nhasher is incorrectly named as the `FilterHeader` is the value within this map.\r\nI consider this a bug as opposed to a refactor as the key and value\r\nrelationship is implied to be `filter header -> block hash` when it is\r\nthe opposite.\r\n\r\nFurther, the hasher for the key already exists via `BlockHasher`.\r\n\r\nref: https://en.cppreference.com/w/cpp/container/unordered_map.html",
      "state": "closed",
      "user": "rustaceanrob",
      "created_at": "2026-01-20T13:30:33Z",
      "updated_at": "2026-01-26T10:17:40Z",
      "merged_at": "2026-01-26T10:17:40Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34351",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 550,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3203035599,
      "number": 34388,
      "title": "doc: Explain that low-effort pull requests may be closed",
      "body": "Lately, there seems to be a rise in low-effort pull requests. For example, where a contributor does not seem to understand the changes they are submitting, or it becomes clear that they have not tested the changes at all.\r\n\r\nI don't think such pull requests are helpful, as they extract precious review time, which could be better spent on reviewing pull requests by reviewers who care about understanding the changes they are submitting, and who ensure their changes are sound and tested.\r\n\r\nSo document that such low-effort pull request may be closed.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-23T11:56:54Z",
      "updated_at": "2026-01-26T10:16:12Z",
      "merged_at": "2026-01-26T09:59:15Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34388",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 610,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3203326813,
      "number": 34390,
      "title": "test: allow overriding `tar` in `get_previous_releases.py`",
      "body": "Facilitate use on distros that might have `tar` as something else, such as `gtar`, i.e Chimera.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-01-23T13:36:39Z",
      "updated_at": "2026-01-27T17:35:22Z",
      "merged_at": "2026-01-25T12:05:43Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34390",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 154,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3206689287,
      "number": 34399,
      "title": "doc: clarify meaning of move-only commits",
      "body": "Clarify the definition of “move-only commits” in the coding style guidelines.",
      "state": "closed",
      "user": "pushkarscripts",
      "created_at": "2026-01-24T14:09:33Z",
      "updated_at": "2026-01-26T09:27:22Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34399",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 119,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3133089501,
      "number": 34162,
      "title": "net: Avoid undershooting in GetAddressesUnsafe",
      "body": "This is demonstrating an alternative approach to #33663. The author didn't seem to like by suggestion so I am putting it here to be considered by reviewers. I personally prefer this approach due to it's simplicity.\r\n\r\n`GetAddressesUnsafe` filters banned and discouraged addresses if those exist. If addresses are filtered the returned list of addresses can be shorter than originally requested because the list isn't backfilled with more valid addresses. These results end up in `GETADDR` responses as well as the `getnodeaddresses` RPC.\r\n\r\nFix this by requesting all available addresses and filter them, then only trim them to the requested `max_addresses` afterwards. Also adds a functional test which checks the new behavior via `getnodeaddresses` RPC.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2025-12-28T17:01:53Z",
      "updated_at": "2026-01-26T08:52:47Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34162",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 802,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2902093523,
      "number": 33593,
      "title": "guix: Use UCRT runtime for Windows release binaries",
      "body": "This PR:\r\n1. Switches Windows release binaries to UCRT.\r\n2. Update docs.\r\n3. Drops MSVCRT workarounds.\r\n\r\nCloses https://github.com/bitcoin/bitcoin/issues/30210.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-10-09T21:46:43Z",
      "updated_at": "2026-01-26T07:17:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33593",
      "labels": [
        "Windows",
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 213,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2919092278,
      "number": 33637,
      "title": "refactor: optimize block index comparisons (1.4-6.8x faster)",
      "body": "### Context\r\nThe comparator is often called either directly or for the sorting of [setBlockIndexCandidates](https://github.com/bitcoin/bitcoin/blob/master/src/validation.h#L637), a red-black tree-set containing valid block headers where the comparator is invoked extensively.\r\nBesided the sorted set usages, the comparator is used directly in `Chainstate` in `FindMostWorkChain`, `PruneBlockIndexCandidates`, `ActivateBestChain` and `InvalidateBlock`; and in `ChainstateManager` in `LoadBlockIndex`, `CheckBlockIndex`, `ActivateSnapshot` and `PopulateAndValidateSnapshot`.\r\n\r\nIt was profiled during the investigation of https://github.com/bitcoin/bitcoin/issues/33618#issuecomment-3402229976. \r\n\r\n### Testing\r\nTo ensure the optimized implementations are both fast and correct, the first commit adds a dedicated benchmark to measure `CBlockIndexWorkComparator` performance, and the second commit adds randomized tests comparing the new implementation with the original one.\r\n\r\n### Results\r\n\r\n> GCC 15.0.1:\r\n\r\n* `CBlockIndexWorkComparator`: 100,772,511 cmp/s → 656,674,205 cmp/s = 6.51x faster\r\n* `CheckBlockIndex`: 9,091 ops/s → 14,765 ops/s = 1.62x faster\r\n\r\n> Clang 22.0.0:\r\n\r\n* `CBlockIndexWorkComparator`: 100,451,893 cmp/s → 683,414,234 cmp/s = 6.8x faster\r\n* `CheckBlockIndex`: 10,322 ops/s → 14,376 ops/s = 1.39x faster\r\n\r\nSee https://corecheck.dev/bitcoin/bitcoin/pulls/33637 for the CI's `CheckBlockIndex` performance.\r\n\r\n<details>\r\n<summary>gcc and clang measurements</summary>\r\n\r\n> Compiler: gcc 15.0.1\r\nb60450fae8 bench: add benchmark to measure `CBlockIndexWorkComparator` performance\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                9.92 |      100,772,511.62 |    0.0% |           63.98 |           35.64 |  1.795 |          14.17 |    1.9% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|          109,996.46 |            9,091.20 |    0.2% |    1,014,421.11 |      394,979.29 |  2.568 |     313,025.11 |    0.0% |      5.50 | `CheckBlockIndex`\r\n\r\ne2e02177ba refactor: inline `arith_uint256` comparison operator\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                6.48 |      154,439,491.66 |    0.0% |           31.01 |           23.25 |  1.334 |           7.16 |    3.8% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|          105,754.86 |            9,455.83 |    0.1% |      913,130.11 |      379,588.20 |  2.406 |     276,692.11 |    0.0% |      5.50 | `CheckBlockIndex`\r\n\r\n85b74b01de refactor: optimize `arith_uint256` comparison with spaceship operator\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                6.37 |      156,990,488.06 |    0.0% |           28.85 |           22.87 |  1.261 |           8.61 |    3.2% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           83,803.10 |           11,932.73 |    0.0% |      743,565.09 |      300,824.84 |  2.472 |     232,646.08 |    0.0% |      5.56 | `CheckBlockIndex`\r\n\r\ndeb58eea2f refactor: optimize `CBlockIndexWorkComparator` with std::tie\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                1.52 |      656,674,205.98 |    0.0% |           13.18 |            5.47 |  2.410 |           3.06 |    0.1% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           67,726.84 |           14,765.19 |    0.2% |      585,826.07 |      243,155.90 |  2.409 |     181,920.07 |    0.0% |      5.54 | `CheckBlockIndex`\r\n\r\n> Compiler: clang 22.0.0\r\n\r\nb60450fae8 bench: add benchmark to measure `CBlockIndexWorkComparator` performance\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                9.96 |      100,451,893.46 |    0.0% |           61.28 |           35.75 |  1.714 |          13.62 |    2.1% |      5.52 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           96,878.70 |           10,322.19 |    0.1% |      802,827.10 |      347,679.01 |  2.309 |     234,823.10 |    0.0% |      5.50 | `CheckBlockIndex`\r\n\r\ne2e02177ba refactor: inline `arith_uint256` comparison operator\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                6.13 |      163,183,693.10 |    0.0% |           25.74 |           22.01 |  1.170 |           6.10 |    4.6% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           86,307.94 |           11,586.42 |    1.2% |      646,229.09 |      309,785.33 |  2.086 |     195,119.09 |    0.0% |      5.54 | `CheckBlockIndex`\r\n\r\n85b74b01de refactor: optimize `arith_uint256` comparison with spaceship operator\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                6.36 |      157,330,900.16 |    1.0% |           26.20 |           22.61 |  1.159 |           6.55 |    4.4% |      5.53 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           75,031.66 |           13,327.71 |    1.0% |      650,604.15 |      266,934.04 |  2.437 |     149,967.14 |    0.0% |      5.54 | `CheckBlockIndex`\r\n\r\ndeb58eea2f refactor: optimize `CBlockIndexWorkComparator` with std::tie\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                1.46 |      683,414,234.14 |    0.0% |           16.12 |            5.25 |  3.067 |           4.02 |    0.1% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           69,559.70 |           14,376.14 |    0.1% |      559,208.07 |      249,654.28 |  2.240 |     132,342.07 |    0.0% |      5.51 | `CheckBlockIndex`\r\n\r\n</details>\r\n\r\n### Reproducer\r\n\r\nRun the equivalence tests with:\r\n```bash\r\ncmake -B build && cmake --build build && ./build/bin/test_bitcoin --run_test=arith_uint256_tests,blockchain_tests\r\n```\r\n\r\nEach commit shows how it changes the relevant benchmarks.\r\n\r\n<details>\r\n<summary>Benchmark script</summary>\r\n\r\n```bash\r\nfor compiler in gcc clang; do \\\r\n  if [ \"$compiler\" = \"gcc\" ]; then CC=gcc; CXX=g++; COMP_VER=$(gcc -dumpfullversion); \\\r\n  else CC=clang; CXX=clang++; COMP_VER=$(clang -dumpversion); fi && \\\r\n  echo \"> Compiler: $compiler $COMP_VER\" && \\\r\n  for commit in b60450fae83970daa9dc2da0706bf126a2f41515 e2e02177ba6f7fac34eda9696dad2e8ecd44e6cd 85b74b01de7e914d07630138eaa78f09a083b85b deb58eea2fdd2712a28aa6b81417087426b19f5b; do \\\r\n    git fetch origin $commit >/dev/null 2>&1 && git checkout $commit >/dev/null 2>&1 && git log -1 --pretty='%h %s' && \\\r\n    rm -rf build && \\\r\n    cmake -B build -DBUILD_BENCH=ON -DENABLE_IPC=OFF -DCMAKE_BUILD_TYPE=RelWithDebInfo -DCMAKE_C_COMPILER=$CC -DCMAKE_CXX_COMPILER=$CXX >/dev/null 2>&1 && \\\r\n    cmake --build build -j$(nproc) >/dev/null 2>&1 && \\\r\n    for i in 1; do \\\r\n      build/bin/bench_bitcoin -filter='CBlockIndexWorkComparator|CheckBlockIndex' -min-time=5000; \\\r\n    done; \\\r\n  done; \\\r\ndone\r\n```\r\n\r\n</details>\r\n\r\nNote: something similar was already started in https://github.com/bitcoin/bitcoin/pull/33334, but this is a broader optimization that doesn't use the same technique: added as coauthor regardless.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-10-16T01:54:31Z",
      "updated_at": "2026-01-26T07:04:15Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33637",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 11203,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3193751838,
      "number": 34362,
      "title": "wallet: skip APS when no partial spend exists",
      "body": "Fixes #25150\n\nAPS (Avoid Partial Spends) runs a second coin selection pass to fully spend\nUTXOs sharing a scriptPubKey. This currently runs unconditionally, even when\nthe first selection has no partial spend. Running APS unnecessarily wastes\ncomputation and can produce a worse result when there was nothing to fix.\n\nDetect partial spends by comparing selected vs available UTXO counts per\nscriptPubKey, reusing available_coins. Skip APS if none found.\n\nTest updated to create partial spend scenarios so tracepoints fire.",
      "state": "closed",
      "user": "8144225309",
      "created_at": "2026-01-21T04:38:49Z",
      "updated_at": "2026-01-26T04:37:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34362",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 567,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3193557787,
      "number": 34359,
      "title": "test: add test for rebroadcast of transaction received via p2p",
      "body": "The wallet doesn't only rebroadcast transactions it created, but also relevant transactions received via p2p. \r\nSince this is not self-evident, add test coverage for it.\r\n\r\nWill keep this in draft for now, because the added test fails intermittently on master. After debugging this I think it is due to a wallet bug, which is fixed in the separate PR #34358. I rebased this PR on #34358.",
      "state": "open",
      "user": "mzumsande",
      "created_at": "2026-01-21T02:42:05Z",
      "updated_at": "2026-01-26T04:11:10Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34359",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 450,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 837470043,
      "number": 24230,
      "title": "indexes: Stop using node internal types and locking cs_main, improve sync logic",
      "body": "This PR lets indexing code mostly run outside of the node process. It also improves indexing sync logic, which is moved out of indexing code to a new [`node::SyncChain()`](https://github.com/ryanofsky/bitcoin/blob/cf6d99bed842361fb06986780097fb80c9e879e4/src/node/chain.h#L21-L36) function.\r\n\r\nAlmost all the commits in this PR are small refactoring changes that move code from `src/index/` to `src/node/`, or replace references to node types like `CBlockIndex`, `CChain`, `CChainState` in index code. There are only two commits affecting indexing sync logic which make complicated or substantive changes:\r\n\r\n- [`8862eddeb68b` indexes: Rewrite chain sync logic, simplify index sync code](https://github.com/bitcoin/bitcoin/pull/24230/commits/8862eddeb68b8871421e8aa4e69c7fa567df4da5)\r\n- [`f458cf8a4ce1` indexes: Initialize indexes without holding cs_main](https://github.com/bitcoin/bitcoin/pull/24230/commits/f458cf8a4ce1c9a21633439122df929dbee53946)\r\n\r\nThe commit messages have more details about these and other changes. Followups to this PR will reuse indexing sync code for wallets (#15719, #11756) and let indexes run in separate processes (#10102)",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2022-02-01T16:56:28Z",
      "updated_at": "2026-01-26T04:03:39Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/24230",
      "labels": [
        "UTXO Db and Indexes",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1234,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 112846431,
      "number": 10102,
      "title": "Multiprocess bitcoin",
      "body": "<!-- begin based-on -->\n**This is based on #29409.** The non-base commits are:\n\n- [`93f471464dd` test: Increase feature_block.py and feature_taproot.py timeouts](https://github.com/bitcoin/bitcoin/pull/10102/commits/93f471464dda67bf59ec474979e5e04989616ff2)\n- [`9c2f8ce25b2` test: Fix multiprocess test for unclean shutdown on kill](https://github.com/bitcoin/bitcoin/pull/10102/commits/9c2f8ce25b263eddcd5e33986626e98d5f391430)\n- [`3582e4a12a3` util: Add util::Result workaround to be compatible with libmultiprocess](https://github.com/bitcoin/bitcoin/pull/10102/commits/3582e4a12a341376e0fcb1d67cda5cc510bb1ae9)\n- [`f1d2d87c6d8` multiprocess: Add capnp serialization code for bitcoin types](https://github.com/bitcoin/bitcoin/pull/10102/commits/f1d2d87c6d87c58749f0f2fb100e184a3ab11303)\n- [`65e4390dcaa` interfaces, refactor: Change WalletLoader::restoreWallet parameter order](https://github.com/bitcoin/bitcoin/pull/10102/commits/65e4390dcaa23ab347a832e3f1ff130650efd2be)\n- [`0e436699c59` multiprocess: Add capnp wrapper for Wallet interface](https://github.com/bitcoin/bitcoin/pull/10102/commits/0e436699c59b537a5948389613dacb5c68fc2872)\n- [`0381cc5dc99` multiprocess: Add capnp wrapper for Node interface](https://github.com/bitcoin/bitcoin/pull/10102/commits/0381cc5dc999795aa1f5bcb77e8d429a9f5221e6)\n- [`88f3246ae7f` multiprocess: Make bitcoin-gui spawn a bitcoin-node process](https://github.com/bitcoin/bitcoin/pull/10102/commits/88f3246ae7f2c0cf79c3f22ba002967dda7a0b16)\n- [`aebc163451b` multiprocess: Make bitcoin-node spawn a bitcoin-wallet process](https://github.com/bitcoin/bitcoin/pull/10102/commits/aebc163451bc8c5fa8cbbcc66b553e17e06e1d82)\n- [`c5b9fe54c9c` multiprocess: Add debug.log .wallet/.gui suffixes](https://github.com/bitcoin/bitcoin/pull/10102/commits/c5b9fe54c9cc367b81487f5c9a4574243e33e7f8)\n- [`a73f70fac8d` doc: Multiprocess misc doc and comment updates](https://github.com/bitcoin/bitcoin/pull/10102/commits/a73f70fac8d396a8d719cafe10853390c53f687b)\n- [`2503f57e93c` combine_logs: Handle multiprocess wallet log files](https://github.com/bitcoin/bitcoin/pull/10102/commits/2503f57e93c32158f837e1c9f0dc9f1061b84346)<!-- end -->\n\n---\n\nThis PR adds an `--enable-multiprocess` configure option which builds new `bitcoin-node`, `bitcoin-wallet`, and `bitcoin-gui` executables with relevant functionality isolated into different processes. See [doc/design/multiprocess.md](https://github.com/ryanofsky/bitcoin/tree/pr/ipc/doc/design/multiprocess.md) for usage details and future plans.\n\nThe change is implemented by adding a new [`Init`](https://github.com/ryanofsky/bitcoin/blob/pr/ipc/src/interfaces/init.h) interface that spawns new wallet and node subprocesses that can be controlled over a [socketpair](http://man7.org/linux/man-pages/man2/socketpair.2.html) by calling [`Node`](https://github.com/ryanofsky/bitcoin/blob/pr/ipc/src/interfaces/node.h), [`Wallet`](https://github.com/ryanofsky/bitcoin/blob/pr/ipc/src/interfaces/wallet.h), and [`ChainClient`](https://github.com/ryanofsky/bitcoin/blob/pr/ipc/src/interfaces/chain.h) methods. When running with split processes, you can see the IPC messages going back and forth in `-debug=1` output. Followup PR's #19460 and #19461 add `-ipcbind` and `-ipcconnect` options that allow more flexibility in how processes are connected.\n\nThe IPC protocol used is Cap'n Proto, but this could be swapped out for another protocol. Cap'n Proto types and libraries are only accessed in the [src/ipc/capnp/](https://github.com/ryanofsky/bitcoin/tree/pr/ipc/src/ipc/capnp) directory, and not in any public headers or other parts of bitcoin code.\n\nSlides from a presentation describing this change are available on [google drive](https://docs.google.com/presentation/d/1AeJ-7gD-dItUgs5yH-HoEzLvXaEWe_2ZiGUUxYIXcws/edit). Demo code used in the presentation was from an older version this PR (tag [ipc.21](https://github.com/ryanofsky/bitcoin/releases/tag/pr%2Fipc.21), [commits](https://github.com/ryanofsky/bitcoin/compare/master...pr/ipc.21)).\n\n---\n\nThis PR is part of the [process separation project](https://github.com/bitcoin/bitcoin/issues/28722).",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2017-03-27T21:48:26Z",
      "updated_at": "2026-01-25T20:56:55Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/10102",
      "labels": [
        "GUI",
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 4142,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 304070624,
      "number": 16545,
      "title": "refactor: Implement missing error checking for ArgsManager flags",
      "body": "Trigger startup errors if bitcoin is configured with bad setting values according to flags. Also raise internal errors if settings are registered and retrieved with inconsistent flags.\n\nThis change has no effect on behavior because the new ArgsManager flags added here are not used outside of tests yet.\n\nIt'll probably be easier to start applying type checking flags to _new_ options than _existing_ options. But for examples of how type checking flags can make sense applied to existing options, see the new [example_options unit test](https://github.com/ryanofsky/bitcoin/blob/pr/argcheck/src/test/argsman_tests.cpp#L27) added in this PR.\n\n---\n\nFollowups:\n\n- Support for flag combinations is possible and is added in commit c919f51c044f0e80ecd301f9c9d396ddff2331ba ([branch](https://github.com/ryanofsky/bitcoin/commits/pr/argcomb))\n- ALLOW_LIST flags are added and enforced in [#17580](https://github.com/bitcoin/bitcoin/pull/17580)\n- Bad IsArgSet usages with ALLOW_LIST are removed in [#30529](https://github.com/bitcoin/bitcoin/pull/30529) and prevented in [#17783](https://github.com/bitcoin/bitcoin/pull/17783)\n- Confusing and ignored multiple assignments in config files are disallowed in [#17493](https://github.com/bitcoin/bitcoin/pull/17493)\n- Confusing reverse-precedence settings merging code is removed in [#17581](https://github.com/bitcoin/bitcoin/pull/17581)\n- Type flags added in this PR implement runtime part of a change to add more compile-time checking in [#22978](https://github.com/bitcoin/bitcoin/pull/22978)\n",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2019-08-04T14:13:12Z",
      "updated_at": "2026-01-25T20:53:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/16545",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1600,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 445592053,
      "number": 19460,
      "title": "multiprocess: Add bitcoin-wallet -ipcconnect option",
      "body": "<!-- begin based-on -->\n**This is based on #29409 + #10102.** The non-base commits are:\n\n- [`5124e765ad6` multiprocess: Add bitcoin-wallet -ipcconnect option](https://github.com/bitcoin/bitcoin/pull/19460/commits/5124e765ad63cfa8e6ae2dec27d427e4f9012018)<!-- end -->\n\n---\n\nBuilding on #10102, this adds an `-ipcconnect` option to `bitcoin-wallet` and an `-ipcbind` option to `bitcoin-node` (both enabled by default in multiprocess builds) so bitcoin node will listen on a `<datadir>/sockets/node.sock` unix socket, and `bitcoin-wallet` will connect to it.\n\nThe idea is that `bitcoin-wallet` can be extended in the future to have some online functionality. For example, there could be a `bitcoin-wallet sync` command that will update balances and sync latest transactions to an unloaded wallet, or a `bitcoin-wallet serve` subcommand that loads a wallet and serves RPC requests, or a `bitcoin-wallet shell` subcommand that allows running RPC methods interactively like the GUI console, or just general support for `bitcoin-wallet <rpc method> <rpc params>` invocations suggested https://github.com/bitcoin/bitcoin/pull/13926#issuecomment-455187379.\n\nThis PR is small and doesn't do much. The only visible change is that `bitcoin-wallet` now checks whether a node socket exists on startup and prints \"Connected to IPC address\" if it can connect it it.\n\nThe default `bitcoin-wallet` connect option is `-ipcconnect=auto`, which connects if possible as described above, and proceeds offline if not possible. Other supported options are `-noipcconnect` to disable ipc, `-ipcconnect` to require a connection and fail if it can't be established, and `-ipcconnect=unix:<socket>` to require a connection and use a custom socket path.\n\nThese changes require multiprocess support and this PR has no effect unless bitcoin is configured with `--enable-multiprocess` as described in [doc/multiprocess.md](https://github.com/bitcoin/bitcoin/blob/master/doc/multiprocess.md)\n\n---\n\nThis PR is part of the [process separation project](https://github.com/bitcoin/bitcoin/issues/28722).",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2020-07-07T18:53:19Z",
      "updated_at": "2026-01-25T20:37:32Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/19460",
      "labels": [
        "Wallet",
        "Build system",
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2117,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 445595297,
      "number": 19461,
      "title": "multiprocess: Add bitcoin-gui -ipcconnect option",
      "body": "<!-- begin based-on -->\n**This is based on #29409 + #10102 + #19460.** The non-base commits are:\n\n- [`86eb8268426` multiprocess: Add bitcoin-gui -ipcconnect option](https://github.com/bitcoin/bitcoin/pull/19461/commits/86eb826842691ed52057a1aada702a5c1eb7c262)<!-- end -->\n\n---\n\nBuilding on #10102, this adds an `-ipcconnect` option to `bitcoin-gui` that connects the GUI to an existing `bitcoin-node` process already running in the background instead of spawning a new `bitcoin-node` process. This allows the GUI to be started and stopped independently of the node. By default with this change, `bitcoin-gui` will check if a `<datadir>/sockets/node.sock` socket exists and try to connect to that. If that doesn't work, it will spawn a new node process and start up the same way it did before this PR.\n\nThe default `bitcoin-gui` connect option is `-ipcconnect=auto`, which tries to connect if possible as described above, and spawns a new `bitcoin-node` process if not possible. Other supported options are `-noipcconnect` to never connect to an existing node and always spawn a new one, `-ipcconnect` to require a connection and fail if it can't be established, and `-ipcconnect=unix:<socket>` to require a connection and use a custom socket path.\n\nWith this PR, basic functionality works and gui instances can connect and disconnect from a running node. But there are rough edges: If a gui process doesn't shut down cleanly, the node can see unhandled IpcExceptions, and if node command line options are passed to `bitcoin-gui` and `bitcoin-gui` connects to an exiting bitcoin-node process instead of spawning a new one, the node options will be silently ignored. \n\nThese changes require multiprocess support and this PR has no effect unless bitcoin is configured with `--enable-multiprocess` as described in [doc/multiprocess.md](https://github.com/bitcoin/bitcoin/blob/master/doc/multiprocess.md)\n\n---\n\nThis PR is part of the [process separation project](https://github.com/bitcoin/bitcoin/issues/28722).",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2020-07-07T19:00:11Z",
      "updated_at": "2026-01-25T20:34:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/19461",
      "labels": [
        "GUI",
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2057,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 578665495,
      "number": 21283,
      "title": "Implement BIP 370 PSBTv2",
      "body": "BIP 370 PSBTv2 introduces several new fields and different invariants for PSBT. This PR implements those new fields and restructures the PSBT implementation to match PSBTv2 but still remain compatible with PSBTv0.",
      "state": "open",
      "user": "achow101",
      "created_at": "2021-02-23T18:29:20Z",
      "updated_at": "2026-01-25T20:31:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/21283",
      "labels": [
        "Wallet",
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 238,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 877751403,
      "number": 24539,
      "title": "Add a \"tx output spender\" index",
      "body": "This PR adds a new \"tx output spender\" index, which allows users to query which tx spent a given outpoint with the `gettxspendingprevout` RPC call that was added by https://github.com/bitcoin/bitcoin/pull/24408.\r\n\r\nSuch an index would be extremely useful for Lightning, and probably for most layer-2 protocols that rely on chains of unpublished transactions.\r\n\r\nUPDATE: this PR is ready for review and issues have been addressed:\r\n- using a watch-only wallet instead would not work if there is a significant number of outpoints to watch (see https://github.com/bitcoin/bitcoin/pull/24539#issuecomment-1276595646)\r\n- this PR does not require `-txindex` anymore\r\n\r\nWe use a composite key with 2 parts (suggested by @romanz): hash(spent outpoint) and tx position, with an empty value. Average composite key size is 15 bytes.\r\n\r\nThe spending tx can optionally be returned by `gettxspendingprevout` (even it `-txindex is not set`).",
      "state": "open",
      "user": "sstone",
      "created_at": "2022-03-11T19:32:41Z",
      "updated_at": "2026-01-25T20:27:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/24539",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 958,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1004149182,
      "number": 25665,
      "title": "refactor: Add util::Result failure types and ability to merge result values",
      "body": "Add `util::Result` support for returning more error information and make use of it in [LoadChainstate method](https://github.com/bitcoin/bitcoin/pull/25665/commits/0263614685582fed2290494f5233dbe038fc350c) as an initial application. Followup PRs [#25722](https://github.com/bitcoin/bitcoin/pull/25722) and [#29700](https://github.com/bitcoin/bitcoin/pull/29700) use it more broadly to return errors and warnings from wallet and kernel functions as well.\r\n\r\nThis change adds two major features to the result class:\r\n\r\n- For better error handling, adds the ability to return a value on failure, not just a value on success. This is a key missing feature that makes the result class not useful for functions like `LoadChainstate()` which produce different errors that need to be handled differently [^1].\r\n\r\n[^1]: Ability to return error values was actually present in the original implementation of [#25218](https://github.com/bitcoin/bitcoin/pull/25218), but unfortunately removed in later iterations. See [design notes](https://github.com/bitcoin-core/bitcoin-devwiki/wiki/util::Result-design-notes).\r\n\r\n- For better error reporting, adds the ability to return warning messages and multiple errors, not just a single error string. This provides a way for functions to report errors and warnings in a standard way, and simplifies interfaces:\r\n\r\n    ```diff\r\n    -virtual std::unique_ptr<Wallet> loadWallet(const std::string& name, bilingual_str& error, std::vector<bilingual_str>& warnings) = 0;\r\n    +virtual util::Result<std::unique_ptr<Wallet>> loadWallet(const std::string& name) = 0;\r\n    ```\r\n\r\n    ```diff\r\n    -std::unique_ptr<WalletDatabase> MakeDatabase(const fs::path& path, const DatabaseOptions& options, DatabaseStatus& status, bilingual_str& error);\r\n    +util::Result<std::unique_ptr<WalletDatabase>, DatabaseError> MakeDatabase(const fs::path& path, const DatabaseOptions& options);\r\n   ```\r\n\r\nThis change also makes some more minor improvements:\r\n\r\n- Smaller type size. `util::Result<int>` is 16 bytes, and `util::Result<void>` is 8 bytes. Previously both were 72 bytes.\r\n\r\n- Broader type compatibility. Supports noncopyable and nonmovable success and error types.\r\n\r\n### Comparison with `std::expected`\r\n\r\nCurrently, the `util::Result` class is useful for error reporting—returning translated, user-facing error strings—but not as useful for error handling, where callers need structured failure information to decide how to proceed. By contrast, `std::expected` / `util::Expected` (#34005, #34006) is good for error handling but less helpful for reporting. This PR closes the gap between the two classes.\r\n\r\nWith this PR, `std::expected` remains a good choice for lower-level functions or simple functions that fail in only a few well-defined ways. Meanwhile,\r\n\r\n- `Result` becomes a better choice for operations that can fail in many different ways—loading a wallet, connecting a block, etc.—where callers may want complete error traces, not just low-level errors without context or high-level errors without detail. (Followup [#25722](https://github.com/bitcoin/bitcoin/pull/25722) applies this to wallet-loading functions.) \r\n- `Result` can also be more useful than `expected` when merging status information from multiple calls. (Followup [#29700](https://github.com/bitcoin/bitcoin/pull/29700) uses this to reliably propagate flush and fatal-error status from validation code that can internally trigger flushes or shutdowns.)\r\n- `Result` may also be a better choice than `std::expected` when returning pointer values. (Followup [#26022](https://github.com/bitcoin/bitcoin/pull/26022) adds a `ResultPtr` specialization that avoids double dereferencing.) \r\n- `Result` can be more efficient than `std::expected` when failures are rare but failure objects are large, since failure values are heap-allocated.\r\n\r\nThis PR effectively makes `Result` a superset of `expected`, making the representations compatible and allowing them to be used together.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2022-07-21T12:46:09Z",
      "updated_at": "2026-01-25T20:20:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/25665",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 4045,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1010047865,
      "number": 25722,
      "title": "refactor: Use util::Result class for wallet loading",
      "body": "<!-- begin based-on -->\n**This is based on #25665 + #26022.** The non-base commits are:\n\n- [`9c8facf50f2` Add temporary ResultExtract helper for porting to util::Result](https://github.com/bitcoin/bitcoin/pull/25722/commits/9c8facf50f210e8327ac1e96fbec265916a74f2f)\n- [`1d46b7bd1fc` refactor: Use util::Result class in wallet/sqlite](https://github.com/bitcoin/bitcoin/pull/25722/commits/1d46b7bd1fcac1166869c40cd1eb5771ac701116)\n- [`c577b636d33` refactor: Use util::Result class in wallet/migrate](https://github.com/bitcoin/bitcoin/pull/25722/commits/c577b636d33b9fbdc9cb8b03e8ee05d90caf8ecd)\n- [`8f1f60f9343` refactor: Use util::Result class in wallet::MakeDatabase](https://github.com/bitcoin/bitcoin/pull/25722/commits/8f1f60f93438d7a0f557128c52cee8d05b8c9f82)\n- [`e9d0495b0a8` refactor: Use util::Result class in wallet/dump](https://github.com/bitcoin/bitcoin/pull/25722/commits/e9d0495b0a8a76aa3a8231d6595cff3f15960821)\n- [`a85d65598e3` refactor: Use util::Result class in wallet/wallettool](https://github.com/bitcoin/bitcoin/pull/25722/commits/a85d65598e30e3a0d7be08b426b7c3b7a8cbf807)\n- [`1efcdbe42c4` refactor: Use util::Result class in wallet/wallet](https://github.com/bitcoin/bitcoin/pull/25722/commits/1efcdbe42c445885ce42fa51fd209e9e0779ef11)\n- [`1db7b970d89` refactor: Use util::Result class in wallet/load](https://github.com/bitcoin/bitcoin/pull/25722/commits/1db7b970d89117c9c539d4b40f814e7c542d51c2)\n- [`e5db02940d7` refactor: Use util::Result class in wallet/rpc](https://github.com/bitcoin/bitcoin/pull/25722/commits/e5db02940d7d8d1874fbe63ec5067ae127e088a7)\n- [`c3c1e9c9ed1` refactor: Use util::Result class in wallet/interfaces](https://github.com/bitcoin/bitcoin/pull/25722/commits/c3c1e9c9ed19210f05c41cccea91b544663ec11a)\n- [`ee403e83522` refactor: Use util::Result class in wallet/test](https://github.com/bitcoin/bitcoin/pull/25722/commits/ee403e8352271b8b220a711f3e51b2abf96a4c88)\n- [`89d92070b11` Drop temporary ResultExtract helper for porting to util::Result](https://github.com/bitcoin/bitcoin/pull/25722/commits/89d92070b11f6de516105ffa9e561b4c34c0e2fa)\n- [`23df7666d1c` scripted-diff: replace wallet DatabaseStatus with DatabaseError](https://github.com/bitcoin/bitcoin/pull/25722/commits/23df7666d1cfae87609b0054e7184bfad71467dd)\n- [`93828179010` iwyu fix https://github.com/bitcoin/bitcoin/actions/runs/21266012856/job/61207857203?pr=25722](https://github.com/bitcoin/bitcoin/pull/25722/commits/9382817901067c57b5ff4044d4c7aa09aee25376)<!-- end -->\n\n---\n\nWallet loading functions up and down the stack have lots of error and warning parameters, and return error information in different ways. This PR makes them uniformly return `util::Result`, without changing behavior.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2022-07-27T19:26:58Z",
      "updated_at": "2026-01-25T20:17:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/25722",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2763,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1047758233,
      "number": 26022,
      "title": "Add util::ResultPtr class",
      "body": "<!-- begin based-on -->\n**This is based on #25665.** The non-base commits are:\n\n- [`5142f017eaa` Add util::ResultPtr class](https://github.com/bitcoin/bitcoin/pull/26022/commits/5142f017eaa3b3f6d0109fc9f836e6243349d541)\n- [`8ef747c80fc` Use ResultPtr<unique_ptr> instead of Result<unique_ptr>](https://github.com/bitcoin/bitcoin/pull/26022/commits/8ef747c80fc3e39ecb2bb5856a489cbfc5737f48)<!-- end -->\n\n---\n\nThe `util::ResultPtr` class is a wrapper for `util::Result` providing syntax sugar to make it less awkward to use with returned pointers. Instead of needing to be deferenced twice with `**result` or `(*result)->member`, it only needs to be dereferenced once with `*result` or `result->member`. Also when it is used in a boolean context, instead of evaluating to true when there is no error and the pointer is null, it evaluates to false so it is straightforward to determine whether the result points to something.\n\nThis PR is only partial a solution to #26004 because while it makes it easier to check for null pointer values, it does not make it impossible to return a null pointer value inside a successful result. It would be possible to enforce that successful results always contain non-null pointers by using a `not_null` type (https://github.com/bitcoin/bitcoin/issues/24423) in combination with `ResultPtr`, though.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2022-09-06T15:57:14Z",
      "updated_at": "2026-01-25T20:14:18Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/26022",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1358,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1181482615,
      "number": 26781,
      "title": "Release `LockData::dd_mutex` before calling `*_detected` functions",
      "body": "Both `double_lock_detected()` and `potential_deadlock_detected()` functions call `LogPrintf()` which in turn implies locking of the `Logger::m_cs` mutex. To avoid a deadlock, the latter must not have the `Mutex` type (see https://github.com/bitcoin/bitcoin/pull/16112).\r\n\r\nWith this PR the mentioned restriction has been lifted, and it is possible now to use our regular `Mutex` type for the `Logger::m_cs` mutex instead of a dedicated `StdMutex` type (not introducing that change here, as its diff is much bigger than a few lines, and the currently proposed diff seems valuable by itself).\r\n\r\n**Note for reviewers:** Make sure the code is configured and built with `CPPFLAGS=-DDEBUG_LOCKORDER`.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2022-12-31T15:38:49Z",
      "updated_at": "2026-01-25T20:13:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/26781",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 762,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1220771563,
      "number": 26988,
      "title": "cli: rework -addrinfo cli to use addresses which aren’t filtered for quality/recency",
      "body": "Rework of `-addrinfo` CLI is done using `getaddrmaninfo` RPC proposed in https://github.com/bitcoin/bitcoin/pull/27511. This would be useful for users who want to know the total number of addresses the node knows about and can make connections to. \r\n\r\nCurrently, `-addrinfo` returns total number of addresses the node knows about after filtering them for quality + recency using [`isTerrible`](https://github.com/bitcoin/bitcoin/blob/4b51290f719559b8506425177f7758abe66fe2c3/src/addrman.cpp#L808). However `isTerrible`addresses [don't matter](https://github.com/bitcoin/bitcoin/pull/26988#discussion_r1147725684) when selecting outbound peers to connect to. Total number of addresses the node knows about could be higher than what `-addrinfo` currently displays. See https://github.com/bitcoin/bitcoin/pull/24370.",
      "state": "open",
      "user": "stratospher",
      "created_at": "2023-01-29T21:25:28Z",
      "updated_at": "2026-01-25T20:07:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/26988",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 898,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1389230610,
      "number": 27865,
      "title": "wallet: Track no-longer-spendable TXOs separately",
      "body": "In #27286, the wallet keeps track of all of its transaction outputs, even if they are already spent or are otherwise unspendable. This TXO set is iterated for balance checking and coin selection preparation, which can still be slow for wallets that have had a lot of activity. This PR aims to improve the performance of such wallets by moving UTXOs that are definitely no longer spendable to a different map in the wallet so that far fewer TXOs need to be iterated for the aforementioned functions.\r\n\r\nUnspendable TXOs (not to be confused with Unspent TXOs) are those which have a spending transaction that has been confirmed, or are no longer valid due to reorgs. TXOs that are spent in unconfirmed transactions remain in the primary TXO set, and are filtered out of balance and coin selection as before.\r\n\r\nDepends on #27286",
      "state": "open",
      "user": "achow101",
      "created_at": "2023-06-12T18:40:10Z",
      "updated_at": "2026-01-25T19:56:32Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/27865",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 876,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1487286408,
      "number": 28333,
      "title": "wallet: Construct ScriptPubKeyMans with all data rather than loaded progressively",
      "body": "Instead of constructing ScriptPubKeyMans with no data, and then loading data as we find it, we should gather everything first and then load it all on construction. If there actually is no data and we want to setup generation, then that should also occur in a constructor rather than afterwards.\r\n\r\nThis change is only applied to DescriptorScriptPubKeyMan and ExternalSignerScriptPubKeyMan, and should be done for any ScriptPubKeyMans added in the future. I don't think it's really worth it to do this for LegacyScriptPubKeyMan since it would make loading performance worse (or cause layer violations) and it's (supposed to be) going away soon.",
      "state": "open",
      "user": "achow101",
      "created_at": "2023-08-24T02:55:39Z",
      "updated_at": "2026-01-25T19:53:10Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28333",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 725,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1566486194,
      "number": 28690,
      "title": "build: Introduce internal kernel library",
      "body": "This PR introduces a new `libbitcoin_kernel` internal library. It completes the internal library design as laid out in [doc/design/libraries.md](https://github.com/bitcoin/bitcoin/blob/master/doc/design/libraries.md). Since the `util` library contains a bunch of modules that are not required by the kernel library, a new `kernel_util` library is introduced as well that only consists of the modules required by the kernel library. The external `libbitcoinkernel` library now re-uses the compiled objects from the internal libraries. \r\n\r\nThere is a trade-off to this. Since we don't manually export symbols from the kernel library yet, this would make the library unusable if `REDUCE_EXPORTS=ON`. For now this means that the patch here introduces a separate source file list for the external library that gets populated by the source files of its static dependents.",
      "state": "open",
      "user": "sedited",
      "created_at": "2023-10-20T11:01:03Z",
      "updated_at": "2026-01-25T19:50:03Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28690",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 906,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1588144092,
      "number": 28802,
      "title": "ArgsManager: support subcommand-specific options",
      "body": "Adds the ability to link particular options to one or more subcommands, and uses this feature in `bitcoin-wallet`. Separates out the help information for subcommand-specific options (duplicating it if an option applies to multiple subcommands), and provides a function for checking if some options have been specified that only apply to different subcommands.",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2023-11-06T09:00:47Z",
      "updated_at": "2026-01-25T19:43:49Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28802",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 408,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1655695603,
      "number": 29136,
      "title": "wallet: `addhdkey` RPC to add just keys to wallets via new `unused(KEY)` descriptor",
      "body": "It is sometimes useful for the wallet to have keys that it can sign with but are not (initially) involved in any scripts, e.g. for setting up a multisig. Ryanofsky [suggested](https://github.com/bitcoin/bitcoin/pull/26728#issuecomment-1867721948) A `unused(KEY)` descriptor which allows for a key to be specified, but produces no scripts. These can be imported into the wallet, and subsequently retrieved with `gethdkeys`. Additionally, `listdescriptors` will output these descriptors so that they can be easily backed up.\r\n\r\nIn order to make it easier for people to add HD keys to their wallet, and to generate a new one if they want to rotate their descriptors, an `addhdkey` RPC is also added. Without arguments, it will generate a new HD key and add it to the wallet via a `unused(KEY)` descriptor. If provided a private key, it will construct the descriptor and add it to the wallet.\r\n\r\nSee also: https://github.com/bitcoin/bitcoin/pull/26728#issuecomment-1866961865\r\n\r\nBased on #29130 as `gethdkeys` is useful for testing this.",
      "state": "open",
      "user": "achow101",
      "created_at": "2023-12-22T23:40:15Z",
      "updated_at": "2026-01-25T19:37:30Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29136",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1117,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1681972231,
      "number": 29256,
      "title": "log, refactor: Allow log macros to accept context arguments",
      "body": "Allow `LogDebug()`, `LogTrace()`, `LogInfo()`, `LogWarning()`, and `LogError()` macros to accept context arguments to provide more information in log messages and more control over logging to callers.\r\n\r\nThis functionality is used in followup PRs:\r\n\r\n- [#30342](https://github.com/bitcoin/bitcoin/pull/30342) - To let libbitcoinkernel send output to specfic `BCLog::Logger` instances instead of a global instance, so output can be disambiguated and applications can have more control over logging.\r\n\r\n- [#30343](https://github.com/bitcoin/bitcoin/pull/30343) - To replace custom `WalletLogPrintf` calls with standard logging calls that automatically include wallet names and don't log everything at info level.\r\n\r\nThis PR does not change behavior of current log prints or require them to be updated. It includes tests and documentation covering the new functionality.\r\n\r\n---\r\n\r\nNote: Originally this PR also removed some restrictions around passing category constants to log macros to try to make them more consistent, but these changes were too controversial and have been dropped.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-01-16T22:09:35Z",
      "updated_at": "2026-01-25T19:31:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29256",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1142,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1940576733,
      "number": 30342,
      "title": "kernel, logging: Pass Logger instances to kernel objects",
      "body": "Pass `Logger` instances to `BlockManager`, `CCoinsViewDB`, `CDBWrapper`, `Chainstate`, `ChainstateManager`, `CoinsViews`, and `CTxMemPool` classes so libbitcoinkernel applications and tests have the option to control where log output goes instead of having all output sent to the global logger.\n\nThis PR is an alternative to #30338. It is more limited because it only changes kernel code while leaving other parts of the codebase alone. It also takes the opportunity to migrate legacy LogPrint / LogPrintf calls to the new log macros introduced in #28318.\n\n---\n\n<!-- begin based-on -->\n**This is based on #29256 + #33847.** The non-base commits are:\n\n- [`4050e4667f6` refactor: Pass Logger instances to kernel objects](https://github.com/bitcoin/bitcoin/pull/30342/commits/4050e4667f63f7eb7d903f1e0179f167d790ae95)\n- [`b7952dc9bcc` refactor: Log kernel output to local log instances](https://github.com/bitcoin/bitcoin/pull/30342/commits/b7952dc9bccd86e594bc88690386b5807e3d461a)\n- [`3fd9bec3be5` refactor: Pass Logger instance to CTxMemPool](https://github.com/bitcoin/bitcoin/pull/30342/commits/3fd9bec3be5819ed1b130c632c8a693b5b7b0938)\n- [`75e1e958f5e` kernel: Drop global Logger instance](https://github.com/bitcoin/bitcoin/pull/30342/commits/75e1e958f5e8a27491723aa88c69bf3cd8de7509)<!-- end -->",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-06-26T17:52:24Z",
      "updated_at": "2026-01-25T19:01:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30342",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1357,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1940584116,
      "number": 30343,
      "title": "wallet, logging: Replace WalletLogPrintf() with LogInfo()",
      "body": "Make new logging macros `LogDebug()`, `LogTrace()`, `LogInfo()`, `LogWarning()`, and `LogError()` compatible with wallet code and drop custom WalletLogPrintf() function. The new logging macros introduced in #28318 weren't previously useful in wallet code because wallet code prefixes most log messages with the wallet names to be be able to distinguish log output from multiple wallets. Fix this by introducing a new `WalletLogSource` class inheriting from `BCLog::Source` which can include the wallet name in log messages.\n\n---\n\n<!-- begin based-on -->\n**This is based on #29256.** The non-base commits are:\n\n- [`2d5c5f0e905` wallet, logging: Replace WalletLogPrintf() with LogInfo()](https://github.com/bitcoin/bitcoin/pull/30343/commits/2d5c5f0e90514e4ef4b6343124c827aea1d0eeab)\n- [`4fb99c22c1c` wallet, logging: Switch LogInfo to LogWarning/LogError](https://github.com/bitcoin/bitcoin/pull/30343/commits/4fb99c22c1c0f242dfdda38832a4814b421273d4)\n- [`a08c9bc808e` wallet, logging: Switch LogInfo to LogError in AddWalletDescriptor](https://github.com/bitcoin/bitcoin/pull/30343/commits/a08c9bc808ef19accc90335fb115f791a66e0158)<!-- end -->",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-06-26T17:57:15Z",
      "updated_at": "2026-01-25T18:58:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30343",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1201,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2086428775,
      "number": 30951,
      "title": "net: option to disallow v1 connection on ipv4 and ipv6 peers",
      "body": "resolves #29618.\r\n\r\nThis PR adds a config flag option `-v2onlyclearnet` which disallows outbound v1 connections on ipv4 and ipv6 networks since they're unencrypted. outbound v1 connections are still possible from tor/i2p/cjdns peers since they're encrypted networks.\r\n\r\n- v1 outbound connections to peers are not attempted\r\n- v1 reconnections are not attempted (if peer is falsely advertised as v2 peer and we attempt a v2 connection but it fails, we do not attempt a v1 reconnection when `-v2onlyclearnet` is switched on)\r\n\r\nCurrently 70% of reachable nodes in network supporting v2 (according to https://21.ninja/reachable-nodes/node-service-share/ and https://bitnodes.io/nodes). Also found 81% of addresses supporting v2 in the addrman of nodes I checked - personal node and the nodes in [peer.observer](https://peer.observer/addrman/alice). (You can use [this branch ](https://github.com/stratospher/bitcoin/commits/addrinfo_service_display/)to check the % of v2 addresses in a node's addrman.)",
      "state": "open",
      "user": "stratospher",
      "created_at": "2024-09-23T12:23:48Z",
      "updated_at": "2026-01-25T18:45:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30951",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1060,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2203477250,
      "number": 31382,
      "title": "kernel: Flush in ChainstateManager destructor",
      "body": "This simplifies the shutdown code a bit and reduces the amount of extra logic required in kernel/bitcoinkernel.cpp to tear down the chainman.\r\n\r\nMoving the second flush out of the Shutdown function into the ChainstateManager destructor, should be safe since there should be no new events created after the first flush. Tweak the chainman tests to actually exercise this new tear down behaviour.\r\n\r\n---\r\n\r\nThis PR is part of the [libbitcoinkernel project](https://github.com/bitcoin/bitcoin/issues/27587)",
      "state": "open",
      "user": "sedited",
      "created_at": "2024-11-27T13:18:50Z",
      "updated_at": "2026-01-25T18:22:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31382",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 549,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2217053399,
      "number": 31425,
      "title": "RFC: Riscv bare metal CI job",
      "body": "This adds a CI job for building the static consensus library and linking it to an executable. It uses newlib-cygwin as a C library for the final linking step. This ensure compatibility with this target going forward and can serve as a starting point for enabling bare metal builds for the entire kernel library. This would have also caught the error fixed in #31365.",
      "state": "open",
      "user": "sedited",
      "created_at": "2024-12-05T08:30:01Z",
      "updated_at": "2026-01-25T18:16:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31425",
      "labels": [
        "Build system",
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 395,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2272618048,
      "number": 31644,
      "title": "leveldb: show non-default options during init",
      "body": "To help with to debugging and traceability (in alignment with displaying other non-default args such as `Command-line arg: dbcache=\"10000\"`) we can extend the LevelDB opening log with an additional debug message for the used non-default settings.\r\n\r\nTo avoid showing booleans as e.g. `create_if_missing=1`, I've added a local `ToString` lambda for `bool`.\r\nI wanted to use `util::Join` at the end, but couldn't find any way that I liked.\r\n\r\nExample output after the change:\r\n```bash\r\n2025-10-15T02:39:45Z Opened LevelDB successfully\r\n2025-10-15T02:39:45Z [leveldb] startup options: options.compression=NoCompression, options.create_if_missing=true, options.max_file_size=33554432, options.paranoid_checks=true, options.write_buffer_size=524288, readoptions.fill_cache=false, readoptions.verify_checksums=true, writeoptions.sync=true\r\n```",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-01-12T17:30:54Z",
      "updated_at": "2026-01-25T18:03:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31644",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 883,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2281150274,
      "number": 31668,
      "title": "Added rescan option for import descriptors",
      "body": "Fix related to issue: https://github.com/bitcoin/bitcoin/issues/31263\r\n",
      "state": "open",
      "user": "saikiran57",
      "created_at": "2025-01-16T08:11:27Z",
      "updated_at": "2026-01-25T18:00:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31668",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 114,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2368554207,
      "number": 31974,
      "title": "Drop testnet3",
      "body": "Testnet3 was deprecated in v28 with the introduction of testnet4. It will be dropped in v30 _or later_, please discuss in #31975.\r\n\r\nThere is no more `[test]` network section. The user is expected to set testnet4 explicitly, which should make future rotation of testnets easier.\r\n\r\nIf a `[test]` or `[testnet3]` section is present in `bitcoin.conf` a warning is issued:\r\n\r\n```\r\nWarning: .../bitcoin.conf:18 Section [test] is not recognized.\r\n```\r\n\r\nStarting with `-testnet3` will be greeted with an error message:\r\n\r\n```\r\nError: Testnet3 was dropped in version 30.0. Consider using '-testnet4' instead.\r\n```\r\n\r\nThis also prevents a fallback to mainnet.\r\n\r\nStarting with `-test` was already not possible with testnet3.\r\n\r\nReview hints:\r\n- make a (Windows) Guix build and test the (un)installer\r\n\r\nGuix hashes:\r\n\r\n```\r\n(todo)\r\n```",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-03-03T16:22:11Z",
      "updated_at": "2026-01-25T17:30:42Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31974",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 842,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2393065673,
      "number": 32065,
      "title": "i2p: make a time gap between creating transient sessions and using them",
      "body": "Connecting to an I2P peer consists of creating a session (the\r\n`SESSION CREATE` command) and then connecting to the peer using that\r\nsession (`STREAM CONNECT ID=session_id ...`).\r\n\r\nThis change is only relevant for transient sessions because when a\r\npersistent session is used it is created once and used for all\r\nconnections.\r\n\r\nBefore this change Bitcoin Core would create the session and use it in\r\nquick succession. That is, the `SESSION CREATE` command would be\r\nimmediately followed by `STREAM CONNECT`. This could ease network\r\nactivity monitoring by an adversary.\r\n\r\nTo mitigate that, this change creates sessions upfront without an\r\nimmediate demand for new sessions and later uses them. This creates a\r\ntime gap between `SESSION CREATE` and `STREAM CONNECT`. Note that there\r\nis always some demand for new I2P connections due to disconnects.\r\n\r\n---\r\n\r\nSummary of the changes in the code:\r\n\r\n* Create the session from the `Session` constructor (send `SESSION CREATE`\r\n  to the I2P SAM proxy). This constructor was only called when transient\r\n  sessions were needed and was immediately followed by `Connect()` which\r\n  would have created the session. So this is a noop change if viewed\r\n  in isolation.\r\n\r\n* Every time we try to connect to any peer (not just I2P) create a new\r\n  I2P session, up to a limit (currently 10). This way a bunch of\r\n  sessions are created (`SESSION CREATE`) at times that are decoupled\r\n  from the time when sessions will be used (`STREAM CONNECT`).\r\n\r\n* Tweak the code in `CConnman::ConnectNode()` to avoid creating session\r\n  objects while holding `m_unused_i2p_sessions_mutex` because now\r\n  creating `i2p::sam::Session` involves network activity and could take\r\n  a few seconds.\r\n\r\n---\r\n\r\nBefore (note the timestamps):\r\n\r\n2025-03-13T09:23:40Z [opencon] [i2p:info] Transient SAM session cd7ea49a7e created\r\n2025-03-13T09:23:43Z [opencon] [i2p] -> STREAM CONNECT ID=cd7ea49a7e DESTINATION=...\r\n\r\n2025-03-13T09:23:51Z [opencon] [i2p:info] Transient SAM session cb0956207e created\r\n2025-03-13T09:23:52Z [opencon] [i2p] -> STREAM CONNECT ID=cb0956207e DESTINATION=...\r\n\r\n2025-03-13T09:24:04Z [opencon] [i2p:info] Transient SAM session 35ad67f343 created\r\n2025-03-13T09:24:04Z [opencon] [i2p] -> STREAM CONNECT ID=35ad67f343 DESTINATION=...\r\n\r\nAfter:\r\n\r\n2025-03-13T17:08:58Z [opencon] [i2p:info] Transient SAM session 16098cd4ea created\r\n2025-03-13T17:09:34Z [opencon] [i2p] -> STREAM CONNECT ID=16098cd4ea DESTINATION=...\r\n\r\n2025-03-13T17:09:38Z [opencon] [i2p:info] Transient SAM session 5d209bf1bc created\r\n2025-03-13T17:09:59Z [opencon] [i2p] -> STREAM CONNECT ID=5d209bf1bc DESTINATION=...\r\n\r\n2025-03-13T17:09:50Z [opencon] [i2p:info] Transient SAM session e78aa6d2e7 created\r\n2025-03-13T17:12:09Z [opencon] [i2p] -> STREAM CONNECT ID=e78aa6d2e7 DESTINATION=...\r\n\r\n---\r\n\r\nThis was suggested by @eyedeekay some time ago (in 2023 actually) and has been lingering in my TODO since then :eyes:. A further suggestion is to also add a time gap between the activity cease and the closing of the session. For this, when `CNode` is destroyed `CNode::m_i2p_sam_session` would have to be moved elsewhere and destroyed at a later time. cc @zzzi2p",
      "state": "open",
      "user": "vasild",
      "created_at": "2025-03-14T08:29:59Z",
      "updated_at": "2026-01-25T17:24:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32065",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3245,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2466171613,
      "number": 32297,
      "title": "bitcoin-cli: Add -ipcconnect option",
      "body": "This implements an idea from sipa in https://github.com/bitcoin/bitcoin/issues/28722#issuecomment-2807026958 to allow `bitcoin-cli` to connect to the node via IPC instead of TCP, if the ENABLE_IPC cmake option is enabled and the node has been started with `-ipcbind`.\r\n\r\nThis feature can be tested with:\r\n\r\n```\r\nbuild/bin/bitcoin-node -regtest -ipcbind=unix -debug=ipc\r\nbuild/bin/bitcoin-cli -regtest -ipcconnect=unix -getinfo\r\n```\r\n\r\nThe -ipconnect parameter can also be omitted, since this change also makes `bitcoin-cli` prefer IPC over HTTP by default, and falling back to HTTP if an IPC connection can't be established.\r\n\r\n---\r\n\r\nThis PR is part of the [process separation project](https://github.com/bitcoin/bitcoin/issues/28722).",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2025-04-17T13:55:32Z",
      "updated_at": "2026-01-25T16:57:30Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32297",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 772,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2511642895,
      "number": 32468,
      "title": "rpc: generateblock to allow multiple outputs",
      "body": "## Generatetomany\r\n\r\nFirst approach was to create a `generatetomany` rpc call. That approach can be seen here https://github.com/polespinasa/bitcoin/pull/3\r\n\r\n## Generateblock\r\nModifies `generateblock` to allow a user to set multiple outputs in the coinbase transaction. If an empty set is provided, the block will be empty. If no set of transactions is provided, the block will mine the mempool. If a set of transactions is provided only that set of txs will be mined.\r\n\r\n```\r\n$./bitcoin-cli -rpcport=18443 generateblock bcrt1qw6qkj8wtw5hraxwxjp08m4aymkntms3yhqyacj\r\n{\r\n  \"hash\": \"7359a3ed7af0f18f4016e6cb29193bd787a2452c584781135c585d5204b9ec5b\"\r\n}\r\n\r\n$ ./bitcoin-cli -rpcport=18443 generateblock '[\"bcrt1qal6p633hvwz2yp5mav0qy7u2az8gkn2xywnj6v\", \"bcrt1qvr3qgyhw6y0e0zj97v0j5yc40xtpea4wqj0g43\"]'\r\n{\r\n  \"hash\": \"6db028454b26d6667dd6df45be2772844121fb44f86433f6bbfbafa429974684\"\r\n}\r\n\r\n$ ./bitcoin-cli -rpcport=18443 generateblock '[\"bcrt1qal6p633hvwz2yp5mav0qy7u2az8gkn2xywnj6v\", \"bcrt1qvr3qgyhw6y0e0zj97v0j5yc40xtpea4wqj0g43\"]' []\r\n\r\n{\r\n  \"hash\": \"33e2ddc52546ddb0edf28bef5b295ee8fbd487b8aca19c97018467e2477877df\"\r\n}\r\n\r\n```\r\n\r\n### Motivation\r\nhttps://x.com/SuperTestnet/status/1921220086645342550\r\n\r\nCitating @supertestnet \r\n> When mining a block on regtest, the command \"generatetoaddress\" is available if you want to send the entire coinbase to 1 address. Let's add generatetomany in case you want to split up the coinbase among multiple addresses, similar to how the \"sendtoaddress\" and \"sendmany\" commands both exist and let you send money to (1) one address or (2) multiple addresses. The generatetomany command would be particularly useful for simulating protocols that send money to multiple recipients directly from a coinbase, as several pools do now, like ocean and braidpool.\r\n\r\n### Notes\r\n- ~Needs release note~\r\n- ~Changes on `generateblock` are not backwards compatible as now it takes an array of outputs instead a single output. This should not be critical as it is a test RPC.~ ",
      "state": "open",
      "user": "polespinasa",
      "created_at": "2025-05-10T17:34:29Z",
      "updated_at": "2026-01-25T16:32:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32468",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2041,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3181854676,
      "number": 34320,
      "title": "coins: replace remaining `HaveCoin` calls with `GetCoin`",
      "body": "Split out of https://github.com/bitcoin/bitcoin/pull/34132#discussion_r2692307054.\r\n\r\n### Problem\r\n\r\nWe have two ways to check a coin exists in the db.\r\nOne tries to deserialize, the other just returns whether any value is associated with the key.\r\nBut we usually need the full value we probed for, and `HaveCoin` cannot cache the returned value, so it can trigger an extra lookup if `HaveCoin` uses `Exists` and the caller later needs the actual value.\r\nWe're already delegating most `HaveCoin` calls to `GetCoin` anyway for the above reasons, so the current implementation of `HaveCoin` is redundant.\r\n\r\n### Fix\r\n\r\nReplace `HaveCoin` calls with `GetCoin`, reuse `ReadRaw` in `dbwrapper`, stop ignoring deserialization failures, and readjust tests to this simpler state.\r\n\r\n<details>\r\n<summary>Details</summary>\r\n\r\nSee https://github.com/bitcoin/bitcoin/blob/cd0959ce9b7c5b80ebd45b652d557630b4dc604b/src/dbwrapper.cpp#L304-L331 and https://github.com/bitcoin/bitcoin/blob/a9b7f5614c24fe6f386448604c325ec4fa6c98a5/src/dbwrapper.h#L206-L241\r\n\r\n</details>\r\n\r\n### Notes\r\n* It seems https://github.com/bitcoin/bitcoin/pull/26331 did not fix https://github.com/bitcoin/bitcoin/issues/26112.\r\n* After this PR deserialization failures will crash the app, see https://github.com/bitcoin/bitcoin/pull/33866 for similar cleanups. This is deliberate to fail early instead of trying to recover.\r\n\r\n### Reproducers\r\nThis isn't meant as an optimization but it's important to make sure there are no regressions.\r\n\r\n<details>\r\n<summary>assumeutxo load | 910000 blocks | dbcache 4500 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | xfs | SSD</summary>\r\n\r\n```bash\r\nCOMMITS=\"0ffb20dee17858e0f13b23fce3dd0ec06cbeb9a2 9b4e0448b2cd4b0b5a3db231472a2e3d16a97972\"; \\\r\nCC=gcc; CXX=g++; \\\r\nBASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/ShallowBitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; UTXO_SNAPSHOT_PATH=\"$BASE_DIR/utxo-910000.dat\"; \\\r\n(echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done; echo \"\") && \\\r\nfor DBCACHE in 4500; do \\\r\n  (echo \"assumeutxo load | 910000 blocks | dbcache ${DBCACHE} | $(hostname) | $(uname -m) | $(lscpu | grep 'Model name' | head -1 | cut -d: -f2 | xargs) | $(nproc) cores | $(free -h | awk '/^Mem:/{print $2}') RAM | $(df -T $BASE_DIR | awk 'NR==2{print $2}') | $(lsblk -no ROTA $(df --output=source $BASE_DIR | tail -1) | grep -q 0 && echo SSD || echo HDD)\";) &&\\\r\n  hyperfine \\\r\n  --sort command \\\r\n  --runs 3 \\\r\n  --export-json \"$BASE_DIR/assumeutxo-$(sed -E 's/(\\w{8})\\w+ ?/\\1-/g;s/-$//'<<<\"$COMMITS\")-$DBCACHE-$CC-$(date +%s).json\" \\\r\n  --parameter-list COMMIT ${COMMITS// /,} \\\r\n  --prepare \"killall -9 bitcoind 2>/dev/null; rm -f ./build/bin/bitcoind; rm -rf $DATA_DIR/blocks $DATA_DIR/chainstate $DATA_DIR/chainstate_snapshot $DATA_DIR/debug.log; git clean -fxd; git reset --hard {COMMIT} && \\\r\n             cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=RelWithDebInfo && ninja -C build bitcoind bitcoin-cli -j2 && \\\r\n             ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=1 -printtoconsole=0; sleep 20 && \\\r\n             ./build/bin/bitcoind -datadir=$DATA_DIR -daemon -blocksonly -connect=0 -dbcache=$DBCACHE -printtoconsole=0; sleep 20\" \\\r\n   --conclude \"build/bin/bitcoin-cli -datadir=$DATA_DIR stop || true; killall bitcoind || true; sleep 10; \\\r\n               echo '{COMMIT} | dbcache=$DBCACHE | chainstate: $(find $DATA_DIR/chainstate_snapshot -type f 2>/dev/null | wc -l) files, $(du -sb $DATA_DIR/chainstate_snapshot 2>/dev/null | cut -f1) bytes' >> $DATA_DIR/debug.log; \\\r\n               cp $DATA_DIR/debug.log $LOG_DIR/debug-assumeutxo-{COMMIT}-dbcache-$DBCACHE-$(date +%s).log\" \\\r\n    \"COMPILER=$CC DBCACHE=$DBCACHE ./build/bin/bitcoin-cli -datadir=$DATA_DIR -rpcclienttimeout=0 loadtxoutset $UTXO_SNAPSHOT_PATH\"; \\\r\ndone\r\n\r\n0ffb20dee1 Merge bitcoin/bitcoin#34282: qa: Fix Windows logging bug\r\n9b4e0448b2 coins: replace remaining `HaveCoin` calls with `GetCoin()` and remove the former\r\n\r\nassumeutxo load | 910000 blocks | dbcache 4500 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | xfs | SSD\r\n\r\nBenchmark 1: COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 0ffb20dee17858e0f13b23fce3dd0ec06cbeb9a2)\r\n  Time (mean ± σ):     414.640 s ±  4.562 s    [User: 0.001 s, System: 0.001 s]\r\n  Range (min … max):   411.946 s … 419.907 s    3 runs\r\n \r\n  Warning: Statistical outliers were detected. Consider re-running this benchmark on a quiet system without any interferences from other programs. It might help to use the '--warmup' or '--prepare' options.\r\n \r\nBenchmark 2: COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 9b4e0448b2cd4b0b5a3db231472a2e3d16a97972)\r\n  Time (mean ± σ):     417.815 s ±  3.844 s    [User: 0.002 s, System: 0.001 s]\r\n  Range (min … max):   413.440 s … 420.653 s    3 runs\r\n \r\nRelative speed comparison\r\n        1.00          COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 0ffb20dee17858e0f13b23fce3dd0ec06cbeb9a2)\r\n        1.01 ±  0.01  COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 9b4e0448b2cd4b0b5a3db231472a2e3d16a97972)\r\n```\r\n\r\n</details>\r\n\r\n\r\n<details>\r\n<summary>2026-01-20 | reindex-chainstate | 932239 blocks | dbcache 450 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | SSD</summary>\r\n\r\n```bash\r\nfor DBCACHE in 450 4500; do \\                                                                                                                                     \r\n  COMMITS=\"0ffb20dee17858e0f13b23fce3dd0ec06cbeb9a2 9b4e0448b2cd4b0b5a3db231472a2e3d16a97972\"; \\\r\n  STOP=932239; CC=gcc; CXX=g++; \\\r\n  BASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/BitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; \\\r\n  (echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done) && \\\r\n  (echo \"\" && echo \"$(date -I) | reindex-chainstate | ${STOP} blocks | dbcache ${DBCACHE} | $(hostname) | $(uname -m) | $(lscpu | grep 'Model name' | head -1 | cut -d: -f2 | xargs) | $(nproc) cores | $(free -h | awk '/^Mem:/{print $2}') RAM | $(lsblk -no ROTA $(df --output=source $BASE_DIR | tail -1) | grep -q 0 && echo SSD || echo HDD)\"; echo \"\") &&\\\r\n  hyperfine \\\r\n    --sort command \\\r\n    --runs 1 \\\r\n    --export-json \"$BASE_DIR/rdx-$(sed -E 's/(\\w{8})\\w+ ?/\\1-/g;s/-$//'<<<\"$COMMITS\")-$STOP-$DBCACHE-$CC.json\" \\\r\n    --parameter-list COMMIT ${COMMITS// /,} \\\r\n    --prepare \"killall -9 bitcoind 2>/dev/null; rm -f ./build/bin/bitcoind; git clean -fxd; git reset --hard {COMMIT} && \\\r\n      cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=Release -DENABLE_IPC=OFF && ninja -C build bitcoind -j1 && \\\r\n      ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=1000 -printtoconsole=0; sleep 20; rm -f $DATA_DIR/debug.log\" \\\r\n    --conclude \"killall bitcoind || true; sleep 5; grep -q 'height=0' $DATA_DIR/debug.log && grep -q 'Disabling script verification at block #1' $DATA_DIR/debug.log && grep -q 'height=$STOP' $DATA_DIR/debug.log && grep 'Bitcoin Core version' $DATA_DIR/debug.log | grep -q \"$(printf %.12s {COMMIT})\"; \\\r\n                cp $DATA_DIR/debug.log $LOG_DIR/debug-{COMMIT}-$(date +%s).log\" \\\r\n    \"COMPILER=$CC ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=$DBCACHE -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0\";\r\ndone\r\n\r\n0ffb20dee1 Merge bitcoin/bitcoin#34282: qa: Fix Windows logging bug\r\n9b4e0448b2 coins: replace remaining `HaveCoin` calls with `GetCoin()` and remove the former\r\n\r\n2026-01-20 | reindex-chainstate | 932239 blocks | dbcache 450 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | SSD\r\n\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=932239 -dbcache=450 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 0ffb20dee17858e0f13b23fce3dd0ec06cbeb9a2)\r\n  Time (abs ≡):        21792.702 s               [User: 50404.736 s, System: 2993.346 s]\r\n \r\nBenchmark 2: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=932239 -dbcache=450 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 9b4e0448b2cd4b0b5a3db231472a2e3d16a97972)\r\n  Time (abs ≡):        21806.403 s               [User: 50228.797 s, System: 3049.315 s]\r\n \r\nRelative speed comparison\r\n        1.00          COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=932239 -dbcache=450 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 0ffb20dee17858e0f13b23fce3dd0ec06cbeb9a2)\r\n        1.00          COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=932239 -dbcache=450 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 9b4e0448b2cd4b0b5a3db231472a2e3d16a97972)\r\n\r\n0ffb20dee1 Merge bitcoin/bitcoin#34282: qa: Fix Windows logging bug\r\n9b4e0448b2 coins: replace remaining `HaveCoin` calls with `GetCoin()` and remove the former\r\n\r\n2026-01-21 | reindex-chainstate | 932239 blocks | dbcache 4500 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | SSD\r\n\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=932239 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 0ffb20dee17858e0f13b23fce3dd0ec06cbeb9a2)\r\n  Time (abs ≡):        17483.617 s               [User: 34266.506 s, System: 941.755 s]\r\n \r\nBenchmark 2: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=932239 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 9b4e0448b2cd4b0b5a3db231472a2e3d16a97972)\r\n  Time (abs ≡):        17375.956 s               [User: 34053.656 s, System: 953.146 s]\r\n \r\nRelative speed comparison\r\n        1.01          COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=932239 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 0ffb20dee17858e0f13b23fce3dd0ec06cbeb9a2)\r\n        1.00          COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=932239 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 9b4e0448b2cd4b0b5a3db231472a2e3d16a97972)\r\n```\r\n\r\n</details>\r\n\r\n<details>\r\n<summary>2026-01-20 | pruned IBD | 932239 blocks | dbcache 450 | pruning 550 | i7-hdd | x86_64 | Intel(R) Core(TM) i7-7700 CPU @ 3.60GHz | 8 cores | 62Gi RAM | ext4 | HDD</summary>\r\n\r\n```\r\nCOMMITS=\"0ffb20dee17858e0f13b23fce3dd0ec06cbeb9a2 9b4e0448b2cd4b0b5a3db231472a2e3d16a97972\"; \\                                                      \r\nSTOP=932239; DBCACHE=450; PRUNE=550; \\\r\nCC=gcc; CXX=g++; \\\r\nBASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/ShallowBitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; \\\r\n(echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done) && \\\r\n(echo \"\" && echo \"$(date -I) | pruned IBD | ${STOP} blocks | dbcache ${DBCACHE} | pruning ${PRUNE} | $(hostname) | $(uname -m) | $(lscpu | grep 'Model name' | head -1 | cut -d: -f2 | xargs) | $(nproc) cores | $(free -h | awk '/^Mem:/{print $2}') RAM | $(df -T $BASE_DIR | awk 'NR==2{print $2}') | $(lsblk -no ROTA $(df --output=source $BASE_DIR | tail -1) | grep -q 0 && echo SSD || echo HDD)\"; echo \"\") &&\\\r\nhyperfine \\\r\n  --sort command \\\r\n  --runs 2 \\\r\n  --export-json \"$BASE_DIR/ibd-$(sed -E 's/(\\w{8})\\w+ ?/\\1-/g;s/-$//'<<<\"$COMMITS\")-$STOP-$DBCACHE-$CC.json\" \\\r\n  --parameter-list COMMIT ${COMMITS// /,} \\\r\n  --prepare \"killall -9 bitcoind 2>/dev/null; rm -rf $DATA_DIR/*; git clean -fxd; git reset --hard {COMMIT} && \\\r\n    cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=Release && ninja -C build bitcoind -j2 && \\\r\n    ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=1 -prune=$PRUNE -printtoconsole=0; sleep 20\" \\\r\n  --conclude \"killall bitcoind || true; sleep 5; grep -q 'height=0' $DATA_DIR/debug.log && grep -q 'Disabling script verification at block #1' $DATA_DIR/debug.log && grep -q 'height=$STOP' $DATA_DIR/debug.log && grep 'Bitcoin Core version' $DATA_DIR/debug.log | grep -q \"$(printf %.12s {COMMIT})\"; \\\r\n              cp $DATA_DIR/debug.log $LOG_DIR/debug-{COMMIT}-$(date +%s).log\" \\\r\n  \"COMPILER=$CC ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=$DBCACHE -blocksonly -prune=$PRUNE -printtoconsole=0\"\r\n\r\n0ffb20dee1 Merge bitcoin/bitcoin#34282: qa: Fix Windows logging bug\r\n9b4e0448b2 coins: replace remaining `HaveCoin` calls with `GetCoin()` and remove the former\r\n\r\n2026-01-20 | pruned IBD | 932239 blocks | dbcache 450 | pruning 550 | i7-hdd | x86_64 | Intel(R) Core(TM) i7-7700 CPU @ 3.60GHz | 8 cores | 62Gi RAM | ext4 | HDD\r\n\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/ShallowBitcoinData -stopatheight=932239 -dbcache=450 -blocksonly -prune=550 -printtoconsole=0 (COMMIT = 0ffb20dee17858e0f13b23fce3dd0ec06cbeb9a2)\r\n  Time (mean ± σ):     46504.109 s ± 107.376 s    [User: 67620.317 s, System: 4548.654 s]\r\n  Range (min … max):   46428.183 s … 46580.036 s    2 runs\r\n \r\nBenchmark 2: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/ShallowBitcoinData -stopatheight=932239 -dbcache=450 -blocksonly -prune=550 -printtoconsole=0 (COMMIT = 9b4e0448b2cd4b0b5a3db231472a2e3d16a97972)\r\n  Time (mean ± σ):     46099.327 s ± 273.054 s    [User: 67100.985 s, System: 4465.216 s]\r\n  Range (min … max):   45906.249 s … 46292.406 s    2 runs\r\n \r\nRelative speed comparison\r\n        1.01 ±  0.01  COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/ShallowBitcoinData -stopatheight=932239 -dbcache=450 -blocksonly -prune=550 -printtoconsole=0 (COMMIT = 0ffb20dee17858e0f13b23fce3dd0ec06cbeb9a2)\r\n        1.00          COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/ShallowBitcoinData -stopatheight=932239 -dbcache=450 -blocksonly -prune=550 -printtoconsole=0 (COMMIT = 9b4e0448b2cd4b0b5a3db231472a2e3d16a97972)\r\n```\r\n\r\n</details>",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-16T16:17:29Z",
      "updated_at": "2026-01-25T16:28:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34320",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 14490,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2607107167,
      "number": 32784,
      "title": "wallet: derivehdkey RPC to get xpub at arbitrary path",
      "body": "Given a (blank) wallet with an `unused(KEY)` descriptor, `derivehdkey \"m/87h/0h/0h\"` gets the xpub or xpriv at any given path.\r\n\r\nThis is particularly useful for multisig setup where it's not desirable to use our default derivations (e.g. 44h).\r\n\r\nI updated the multisig tutorial and the functional test.\r\n\r\nBased on:\r\n- #29136",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-06-20T11:04:39Z",
      "updated_at": "2026-01-25T15:40:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32784",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 381,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2613678472,
      "number": 32800,
      "title": "rpc: Distinguish between vsize and sigop adjusted mempool vsize",
      "body": "### Motivation and Problem\r\n\r\n`CTxMemPoolEntry::GetTxSize()` returns the larger of two values: the BIP 141 virtual size (vsize) and the \"sigop-adjusted size.\" This sigop-adjusted size is used by mempool validation and mining algorithms as a safeguard to prevent overfilling blocks with transactions that approach both the weight and signature operation (sigop) limits in a way that could exploit block space efficiency.\r\n\r\nIn the current implementation, the sigop-adjusted size is reported as the \"vsize\" in RPCs that provide mempool transaction data, such as `getmempoolentry`, `getrawmempool`, `testmempoolaccept`, and `submitpackage`. However, the documentation for these RPCs typically describes this value simply as the \"virtual transaction size as defined in BIP 141,\" without acknowledging the sigop adjustment. Since the reported size may differ from the pure BIP 141 definition, this confuses people as in this [tweet](https://x.com/mononautical/status/1646166180145577990?s=20), discrepancy can be misleading, as the reported size may differ from the pure BIP 141 definition.\r\n\r\n### Proposed Solution\r\nTo resolve this, all mempool-related RPCs now return two separate fields:\r\n\r\n**vsize:** the sigop-adjusted size, i.e. max(BIP 141 vsize, sigop-adjusted size), which reflects the value previously returned under the vsize label and continues to drive mempool acceptance and block template scoring.\r\n\r\n**vsize_bip141:** the pure BIP 141 virtual size, strictly `ceil(weight/4)`, matching the consensus definition and now reported separately for clarity.\r\n\r\nThis preserves the behavior for clients that depend on the mempool policy size being reported as vsize while making the consensus size explicitly accessible under vsize_bip141.\r\n\r\nAdditionally, this PR updates the relevant RPC help text to clearly document the distinction between these two sizes, and adds supporting documentation `doc/policy/feerates-and-vsize.md` to better explain fee rates, virtual size calculations, sigop adjustments, and the mempool policy heuristics.\r\n\r\nA new field, **sigopsize**, has also been added to the getrawtransaction RPC result when input information (transaction is in the mempool) is available. This field explicitly reports the sigop-adjusted size as calculated by `ceil(sigop cost * bytes_per_sigop / WITNESS_SCALE_FACTOR)`. Exposing this value provides users with more precise insight into how the transaction’s sigops impact its effective size for policy and fee estimation.\r\n\r\nNote: This picks up work from the closed [#27591](https://github.com/bitcoin/bitcoin/pull/27591)\r\nFixes [#32775](https://github.com/bitcoin/bitcoin/issues/32775)",
      "state": "open",
      "user": "musaHaruna",
      "created_at": "2025-06-24T06:13:34Z",
      "updated_at": "2026-01-25T15:33:33Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32800",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2710,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2635595853,
      "number": 32857,
      "title": "wallet: allow skipping script paths",
      "body": "While testing MuSig2 integration in #29675 I ran into a Ledger bug https://github.com/LedgerHQ/app-bitcoin-new/issues/329 that was triggered because we signed for a script path in addition to the key path. The bug itself will be fixed, but it seems useful in general to be able to skip script path signing.\r\n\r\nFor example, you may have a 2-of-2 musig() descriptor with some sort of fallback after coins are N blocks old. For both on chain privacy and fee reasons, you don't want to use this path unless absolutely necessary. But our wallet can't know if our co-signer still has their key, so we sign the script path at all times. This could lead to accidental broadcast.\r\n\r\nThis PR introduces a `keypath_only` option (default `false` for now) to:\r\n- the `send` RPC \r\n- the `walletprocesspsbt` RPC.\r\n\r\nThe resulting PSBT won't include `taproot_script_path_sigs`. It does still have `taproot_bip32_derivs` and `musig2_participant_pubkeys`.\r\n\r\nThe `wallet_taproot.py` tests are expanded to cover this behavior.\r\n\r\nIt can also be tested with https://github.com/Sjors/bitcoin/pull/91 and a slightly modified [Moosig](https://github.com/LedgerHQ/moosig). See https://github.com/LedgerHQ/app-bitcoin-new/issues/329 for the rough steps.\r\n\r\nBased on:\r\n- [ ] #32876\r\n\r\nTODO:\r\n- [ ] maybe refactor `MutableTransactionSignatureCreator`\r\n- [ ] add test coverage for `send`\r\n\r\nPotential followups:\r\n- make this default for `musig()` (after #29675)",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-07-02T14:13:31Z",
      "updated_at": "2026-01-25T15:30:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32857",
      "labels": [
        "Wallet",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 1469,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2637847621,
      "number": 32861,
      "title": "Have createwalletdescriptor auto-detect an unused(KEY)",
      "body": "The `createwalletdescriptor` was introduced in #29130 to let users add a `tr()` descriptor to an existing SegWit wallet. The new `addhdkey` method from #29136 introduces a new potential workflow: start from a blank wallet, generate an HD and then add only the descriptors you need, e.g.:\r\n\r\n```sh\r\nbitcoin rpc createwallet TaprootMaxi blank=true\r\nbitcoin rpc addhdkey\r\nbitcoin rpc createwalletdescriptor bech32m\r\n```\r\n\r\nBefore this PR the last line would fail, requiring the user to call `gethdkeys` and copy-paste the xpub.\r\n\r\nThis PR makes `createwalletdescriptor` a bit smarter so it just finds the `unused(KEY)` generated by `hdkey` and uses that.\r\n\r\nIf multiple `unused(KEY)` descriptors are present the user still has to pick one.\r\n\r\nA potential followup is to make our [multisig tutorial](https://github.com/bitcoin/bitcoin/blob/master/doc/multisig-tutorial.md) slightly safer to use. Rather than creating a full wallet, the instruction could be changed to start with a blank wallet and only generate the default legacy descriptor. This avoids accidental use of single sig `p2sh-segwit` and `bech32` addresses.\r\n\r\n(I might do that in #32784, which introduces some other improvements to the tutorial. The situation is still not great; ideally the `importdescriptors` RPC is enhanced to detect when an `xpub` is a child of an hd key and then treats it as if an xpriv was imported.)\r\n\r\nBuilds on #29136.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-07-03T08:55:40Z",
      "updated_at": "2026-01-25T15:26:56Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32861",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1462,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2647773300,
      "number": 32895,
      "title": "wallet: Prepare for future upgrades by recording versions of last client to open and decrypt",
      "body": "When a wallet is automatically upgraded, we always do so in a way that allows the user to load their wallet in an older version. When the user loads their wallet into an upgraded version again, the wallet may not perform the automatic upgrade and end up with upgraded and non-upgraded material in the wallet.\r\n\r\nIf we write some information about the last client to open the wallet, we would be able to detect these upgrade-downgrade-upgrade situations and perform another upgrade if so. However, in order for this to work, we need to have implemented writing such information into versions prior to the ones which introduce new automatic upgrades.\r\n\r\nWe are already writing the CLIENT_VERSION into all wallets in a \"version\" record, although this record is not updated in the same way across all previous versions. Since v24.0, we are always updating the record when the client version differs, but prior to that, the record would only be updated when the client version is newer. Even so, we can use this record to store the last client version.\r\n\r\nThe first commit decouples the written client version from the node version. This aids in development of new features. The version is entirely decoupled from previous versions by requiring all versions to have bit 30 set, and the initial version being `0 | (1 << 30)`. The versions just need to be at least 299900, and forcing bit 30 to be set was an easy way to achieve this.\r\n\r\nHowever, using version numbers is not as flexible as feature flags, so the second commit introduces the concept of Wallet Client Features. These flags are distinct from the existing Wallet Feature Flags since they are conceptually different. These are written in a separate record, and the wallet client version is incremented to `(1 << 0) | (1 << 30)`.\r\n\r\nLastly, since some upgrades may need private keys and can only occur after the wallet is decrypted, the third commit also adds a last decrypted features flags record to record the features of the last client to decrypt the wallet.\r\n\r\nThe result is that we will now be able to detect a downgrade down to v24.0 and be able to implement in parallel multiple features that require automatic upgrades.",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-07-07T20:13:08Z",
      "updated_at": "2026-01-25T15:13:43Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32895",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2277,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2677577590,
      "number": 33008,
      "title": "wallet: support bip388 policy with external signer",
      "body": "External signers such as Ledger, BitBox02 and Jade, when used with multisig, use [BIP388](https://github.com/bitcoin/bips/blob/master/bip-0388.mediawiki) to display (and constrain) descriptor policies to their users.\r\n\r\nAt least in the case of Ledger (no others so far, see https://github.com/bitcoin/bitcoin/pull/33008#issuecomment-3165080503) this requires us to hold on to an hmac, which proves to the device that the user previously reviewed and approved it.\r\n\r\nThis PR adds a new RPC call `registerpolicy` which converts our descriptor(s) into a BIP388 policy (_partially implemented_), calls a new HWI method `register` (_implemented_) and stores the resulting HMAC (_implemented_).\r\n\r\nWhen signing a transaction using HWI's `signtx` it passes the HMAC along with the PSBT (_TODO_).\r\n\r\nFor convenience the HMAC can be retrieved via `getwalletinfo` (_implemented_). This is useful for scenario's where we can't (yet) complete a transaction via HWI calls.\r\n\r\nNote that the HMAC itself is not specified in BIP388 and may be different for different hardware vendors. So we'll store and echo any hex string the device gives us.\r\n\r\nAn alternative approach to directly supporting BIP388 policies would be to pass the involved descriptors to HWI and have it figure out how to derive a policy.\r\n\r\nTesting:\r\n- make a multisig wallet with a Ledger or other [supported device](https://github.com/bitcoin/bips/blob/master/bip-0388.mediawiki#reference-implementation)\r\n  - try https://github.com/Sjors/bitcoin/pull/91 if you're feeling adventurous, it includes this PR\r\n- install https://github.com/bitcoin-core/HWI/pull/791 HWI branch\r\n- call `bitcoin rpc registerpolicy`\r\n- call `bitcoin rpc getwalletinfo` to see the hmac\r\n\r\nTODO:\r\n- [ ] derive policy using `Descriptor` class instead regex madness, implement all constraints\r\n- [ ] pass hmac along when signing\r\n\r\nDepends on:\r\n- [ ] HWI `register` command: https://github.com/bitcoin-core/HWI/pull/791\r\n- [ ] HWI optional `--hmac` argument for `signtx` (if set, bypass the current auto-registration workaround)\r\n\r\nPotential followups:\r\n- pass hmac along when displaying an address. This provides some extra assurance to the user. See https://github.com/bitcoin-core/HWI/pull/647\r\n",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-07-18T15:31:45Z",
      "updated_at": "2026-01-25T15:04:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33008",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2277,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2683353492,
      "number": 33033,
      "title": "wallet, sqlite: Encapsulate SQLite statements in a RAII class",
      "body": "SQLite statements are C objects which can be long lived, so having them be initialized in a constructor, and cleanup everything in a destructor, makes the sqlite code cleaner and easier to read. This also lets us have the various functions needed to interact with sqlite statements be member functions.\r\n\r\nThis will be particularly useful in future work which makes use of more complicated SQL statements.",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-07-21T22:43:08Z",
      "updated_at": "2026-01-25T14:47:51Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33033",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 467,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2712708880,
      "number": 33112,
      "title": "wallet: relax external_signer flag constraints",
      "body": "The `external_signer` indicates that an external signer device may be called via [HWI](https://github.com/bitcoin-core/HWI) or [equivalent](https://github.com/bitcoin/bitcoin/blob/master/doc/external-signer.md#signer-api) application.\r\n\r\nWhen it was initially introduced some additional constraints were placed on wallets with this flag: it had to be a descriptor wallet and watch-only. Also the flag could not be added or removed later.\r\n\r\nThe constraints aren't a problem for the main supported and documented use case of connecting a single hardware wallet and using it just like a normal single sig Bitcoin Core wallet.\r\n\r\nBut they get in the way of more advanced constructions, which are becoming increasingly practical especially once MuSig2 support lands with #29675. See https://github.com/Sjors/bitcoin/pull/91 and https://github.com/bitcoin-core/HWI/pull/794 for a collection of changes on top of that which facilitate MuSig2 with a hardware wallet. And see #24861.\r\n\r\nThis pull requests drops the following constraints:\r\n\r\n- `disable_private_keys` is no longer mandatory (but still default)\r\n- `external_signer` flag is now mutable\r\n\r\nAdditionally it does the following:\r\n\r\n- make the `blank` option for `createwallet` consistent with regular wallets by _not_ importing keys from the connected signer\r\n- avoid going through `createTransaction` for external signers (otherwise the GUI breaks)\r\n- update `external-signer.md` mainly to use named arguments and point out a GUI setting\r\n\r\n\r\nThis should no noticeable effect on the default single sig use case described above.\r\n\r\n \r\n",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-08-01T10:11:18Z",
      "updated_at": "2026-01-25T14:34:58Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33112",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1635,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2748998057,
      "number": 33199,
      "title": "fees: enable `CBlockPolicyEstimator` return sub 1 sat/vb fee rate estimates",
      "body": "This is a simple PR that updates the block policy estimator’s `MIN_BUCKET_FEERATE` constant to be identical to the policy `DEFAULT_MIN_RELAY_TX_FEE`. \r\nIt also enables the fee estimator to record transactions with a fee rate up to the `DEFAULT_MIN_RELAY_TX_FEE` in its stats, which effectively allows the estimator to return sub-1 sat/vB fee rate estimates.\r\n\r\nThe change is correct because the estimator creates buckets of fee rates from\r\n`MIN_BUCKET_FEERATE`,\r\n`MIN_BUCKET_FEERATE` + `FEE_SPACING`,\r\n`MIN_BUCKET_FEERATE` + `2 * FEE_SPACING`,\r\n… up to `MAX_BUCKET_FEERATE`.\r\n\r\nThis means it will record sub-1 sat/vB fee rates in the buckets and may return them as a fee rate estimate when that bucket is the lowest one with sufficient transactions for a given target.\r\n\r\nTying `MIN_BUCKET_FEERATE` to `DEFAULT_MIN_RELAY_TX_FEE` also makes it dynamic, so we don’t need to update the fee estimator when the `minrelaytxfee` default is adjusted in the future.\r\n\r\nFor the mempool fee rate estimator in #31664, no update is needed since it uses the block assembler and because the node can see sub-1 sat/vB transactions, it can generate block templates with those and therefore return a fee rate estimate accordingly.\r\n\r\n---\r\n\r\nWhile touching this part of the fee estimator code, this PR got rid of the dummy value persisted in the file",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2025-08-15T15:15:26Z",
      "updated_at": "2026-01-25T14:15:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33199",
      "labels": [
        "TX fees and policy"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1407,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2756065507,
      "number": 33215,
      "title": "Fix compatibility with `-debuglogfile` command-line option",
      "body": "This PR avoids hardcoding the \"debug.log\" filename, ensuring compatibility with custom filenames provided via the `-debuglogfile` command-line option.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-08-19T10:59:57Z",
      "updated_at": "2026-01-25T14:12:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33215",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 209,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2809021284,
      "number": 33343,
      "title": "help: enrich help text for `-loadblock`",
      "body": "`-loadblock` doesn't support XOR-ed files, mention it in its help text to avoid troubles for users.",
      "state": "open",
      "user": "HowHsu",
      "created_at": "2025-09-08T17:41:11Z",
      "updated_at": "2026-01-25T13:49:01Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33343",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 139,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2829858173,
      "number": 33392,
      "title": "wallet, rpc: add UTXO set check and incremental rescan to importdescriptors",
      "body": "Fixes [#28898](https://github.com/bitcoin/bitcoin/issues/28898)\r\n\r\nWhen importing descriptors, users may accidentally provide an incorrect birthdate (timestamp). This can cause the wallet to miss relevant historical transactions, leading to incorrect or incomplete balances. Currently, the wallet only relies on rescans starting from the provided timestamp.\r\n\r\nThis PR extends the importdescriptors RPC with a new optional argument:\r\n\r\n`verify_balance` a `bool` which is `false` by defualt.\r\n\r\nIf enabled, the wallet will compare its calculated trusted balance against UTXO set balance (by generating the `scriptpukeys` of the wallet and comparing it with the chains UTXO set `scriptpubkeys` to get the accurate balance belonging to the wallet and comparing it with the wallet trusted balance).\r\n\r\nIf the balances match, import continues as normal.\r\nIf a discrepancy is detected, the wallet will attempt incremental rescans in chunks of recent blocks until the missing history is found. If the wallet is pruned, incremental rescans will not go earlier than the prune boundary.\r\n\r\nAdditional information is returned in the RPC response under an `\"info\" ` object when `verify_balance` is used, they are:\r\n\r\n`utxo_check`: whether the UTXO set matched the wallet balance\r\n`scanned_chunks:` number of incremental rescan chunks attempted\r\n`scanned_blocks`: approximate number of blocks scanned during incremental rescans\r\n\r\nThis helps detect and fix balance mismatches caused by wrong descriptor timestamps.\r\n\r\n**Implementation:**\r\n- Add `FindCoinsByScript()` for scanning UTXO set for coins belonging to output_scripts and expose it to node interface through `findCoinsByScript()`.\r\n- Add `GetWalletUTXOSetBalance()` which calculates the wallet’s total spendable balance by summing all UTXOs in the blockchain’s UTXO set that belong to the wallet’s scriptPubKeys, ignoring immature coinbase outputs.\r\n- Add `std::optional<int64_t> endTime` to `RescanFromTime()` which lets the rescan stop at a specific block height, limiting the scan to a defined time range instead of scanning from startTime all the way to the blockchain tip.\r\n- Add `IncrementalRescan()` this function scans the wallet’s transaction history in chunks of blocks from tip backwards to try and reconcile the wallet’s trusted balance with the actual UTXO-set balance, stopping early if a chunk produces a balance that matches the target. It is used only when there’s a discrepancy between the wallet’s trusted balance and the UTXO-set balance, performing an incremental rescan to identify when the balances align and recording how many chunks were scanned. \r\n\r\n**`importescriptors` with incremental example**\r\n```\r\nbitcoin-cli importdescriptors '[{\r\n    \"desc\": \"wpkh([f5b1c3d7/84h/0h/0h]xpub6CUGRUonZSQ4TWtTMmzXdrXDtypWKiKpJrZT4S9vPz4ZZ6f4a1V4f3ChFy8hRk4M6mh4J4LR6WcJbNf2oyMFGmQH6Eo1QvLKMjR18q3fTq5/0/*)#abcd1234\",\r\n    \"timestamp\": \"now\"\r\n}]' true\r\n```\r\n\r\nExample Output\r\n```\r\n[\r\n  {\r\n    \"info\": {\r\n      \"utxo_check\": true,\r\n      \"scanned_blocks\": 2000,\r\n      \"scanned_chunks\": 2\r\n    }\r\n  }\r\n]\r\n```\r\n\r\n**Benchmarks**\r\nHere's a benchmark result for normal rescan and incremental rescan as suggested by **fjahr**. \r\n\r\n| ns/op        | op/s       | err% | total | benchmark                   |\r\n|-------------:|-----------:|-----:|------:|:----------------------------|\r\n| 13,481.56    | 74,175.41  | 0.9% | 0.01  | BenchmarkIncrementalRescans |\r\n| 13,450.49    | 74,346.72  | 1.4% | 0.01  | BenchmarkIncrementalRescans |\r\n| 13,468.04    | 74,249.85  | 1.5% | 0.01  | BenchmarkIncrementalRescans |\r\n| 2,274,875.00 | 439.58     | 1.7% | 0.03  | BenchmarkRescanFull         |\r\n| 2,301,375.00 | 434.52     | 1.4% | 0.03  | BenchmarkRescanFull         |\r\n| 2,306,334.00 | 433.59     | 3.0% | 0.03  | BenchmarkRescanFull         |\r\n\r\n\r\nHere's the [code](https://github.com/bitcoin/bitcoin/commit/15982b5cdef97d89c5ac68fe4b075abad1f65228)  for the benchmark. Not 100 percent sure if I wrote it correctly. It's my first time writting benchmark, took inspiration from how [src/bench/wallet_balance.cpp](https://github.com/bitcoin/bitcoin/blob/master/src/bench/wallet_balance.cpp) was written.\r\n\r\n\r\nA big thanks to **fjahr** for suggesting this approach [comment](https://github.com/bitcoin/bitcoin/pull/33392#issuecomment-3300319224)",
      "state": "open",
      "user": "musaHaruna",
      "created_at": "2025-09-15T16:17:12Z",
      "updated_at": "2026-01-25T13:36:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33392",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 4366,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2887599768,
      "number": 33540,
      "title": "argsman, cli: GNU-style command-line option parsing (allows options after non-option arguments)",
      "body": "This PR simplifies the argument parsing logic and resolves practical issues for `bitcoin-cli` and similar binaries (e.g. `bitcoin-wallet`) making their usage more consistent and predictable, enabling valid patterns such as mixing commands with wallet- or RPC-specific options—without relying on argument ordering quirks.\r\n\r\n<details>\r\n<summary>What's changed in ArgsManager that allows the above.</summary>\r\n\r\n- Previously, `ArgsManager` stopped interpreting options once a non-option argument was encountered (non-GNU parsing). For example:\r\n\r\n        bitcoind -a -b param -c\r\n\r\n  would ignore `-c` because it followed the non-option argument `param`. In some cases '-c' is interpreted as an argument for 'param', producing unexpected behavior (eg empty arrays for listtransactions command).\r\n\r\n- This PR changes the behavior so that options following non-option argument are recognized and processed (GNU parsing). This is needed for workflows for tools like CLI where command arguments may be followed by wallet- or RPC-specific\r\noptions, e.g.:\r\n\r\n        bitcoin-cli -rpcwallet=\"\" listtransactions -rpcwallet=mywallet\r\n    \r\n        bitcoin-cli getaddressinfo <address> -rpcwallet=mywallet\r\n\r\n- (other binaries could also benefit from this change,  e.g. `bitcoin-wallet`)\r\n\r\n        bitcoin-wallet create -wallet=newname\r\n\r\n- Invalid options passed after non-options will be treated as RPC arguments that begin with a `-` character (so no\r\nbehavioural change against `master`), e.g.:\r\n\r\n        bitcoin-cli -regtest -datadir=/tmp/btc createwallet -mywallet\r\n        {\r\n            \"name\": \"-mywallet\"\r\n        }\r\n\r\n</details>\r\n\r\n<details><summary>Before and after outputs running RPC commands from <code>CLI</code>/ <code>bitcoin-cli</code>.</summary><ul>\r\n     <li><details><summary>wallet commands using <code>CLI</code>:</summary><ul> \r\n           <li><details><summary><code>getaddressinfo</code></summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc getaddressinfo bcrt1qrnz5xlcwz5d85n3fag6v0vc4lryjc90jhqtpsh -rpcwallet=nonExistent\r\nerror message:\r\ngetaddressinfo \"address\"\r\n...\r\n```\r\n</li>\r\n           <li>after\r\n\r\n```\r\n./build/bin/bitcoin-cli -regtest -datadir=/tmp/btc getaddressinfo bcrt1qrnz5xlcwz5d85n3fag6v0vc4lryjc90jhqtpsh -rpcwallet=nonExistent\r\nerror code: -18\r\nerror message:\r\nRequested wallet does not exist or is not loaded\r\n```\r\n\r\n</li>\r\n           </ul></details></li>\r\n           <li><details><summary><code>listtransactions</code></summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=nonExistent\r\n[\r\n]\r\n```\r\n\r\n</li>\r\n           <li>after\r\n\r\n\r\n```\r\n./build/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=nonExistent\r\nerror code: -18\r\nerror message:\r\nRequested wallet does not exist or is not loaded\r\n```\r\n\r\n</li>\r\n           </ul></details></li>\r\n           <li><details><summary>any command that needs an option to be specifed, it can be added at the end directly instead of before the command</summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions\r\nerror code: -19\r\nerror message:\r\nMultiple wallets are loaded. Please select which wallet to use by requesting the RPC through the /wallet/<walletname> URI path. Or for the CLI, specify the \"-rpcwallet=<walletname>\" option before the command (run \"bitcoin-cli -h\" for help or \"bitcoin-cli listwallets\" to see which wallets are currently loaded).\r\n```\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=\"\"\r\nerror code: -19\r\nerror message:\r\nMultiple wallets are loaded. Please select which wallet to use by requesting the RPC through the /wallet/<walletname> URI path. Or for the CLI, specify the \"-rpcwallet=<walletname>\" option before the command (run \"bitcoin-cli -h\" for help or \"bitcoin-cli listwallets\" to see which wallets are currently loaded).\r\n```\r\n\r\n</li>\r\n           <li>after\r\n\r\n```\r\n/build/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=\"\"\r\n[\r\n  {\r\n    \"address\": \"bcrt1q5pqkrlfrp9rvsg43sxxagrees7r7ul6uyskhs4\",\r\n    \"parent_descs\": [\r\n      \"wpkh([76a11ab0/84h/1h/0h]tpubDCDCuyC1Rtm1weZ5kfBYtdchcmqa2t8db7M68wsPHbWhUrYnzFTrHu7ufVVRydt3FdWQy8iNmKbZYbgpWWcEKPAj896x53UbS6i2xRD1qct/0/*)#kuff3m9t\"\r\n    ],\r\n    \"category\": \"immature\",\r\n    \"amount\": 50.00000000,\r\n    \"label\": \"\",\r\n...\r\n```\r\n\r\n</li>\r\n           </ul></details></li>\r\n     </ul></details></li>\r\n     <li><details><summary>other binaries could benefit from it, e.g. <code>bitcoin-wallet:</code></summary><ul> \r\n           <li><details><summary><code>create</code> command</summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-wallet -regtest -datadir=/tmp/btc create\r\nWallet name must be provided when creating a new wallet.\r\n```\r\n_(`-wallet` option has to be passed before the `create` command in order to work)_\r\n```\r\n./build_master/bin/bitcoin-wallet -regtest -datadir=/tmp/btc create -wallet=newWalletName\r\nError: Additional arguments provided (-wallet=newWalletName). Methods do not take arguments. Please refer to `-help`.\r\n```\r\n\r\n</li>\r\n           <li>after\r\n\r\n```\r\n./build/bin/bitcoin-wallet -regtest -datadir=/tmp/btc create -wallet=newWallet\r\nTopping up keypool...\r\nWallet info\r\n===========\r\nName: newWallet\r\nFormat: sqlite\r\nDescriptors: yes\r\nEncrypted: no\r\nHD (hd seed available): yes\r\nKeypool Size: 8000\r\nTransactions: 0\r\nAddress Book: 0\r\n```\r\n</li>\r\n           </ul></details></li>\r\n     </ul></details></li>\r\n     </ul> <!-- End -->\r\n</details>\r\n\r\n-<ins>_**Notes**_</ins>:\r\n\r\n- <ins>Backwards compatibility</ins>:\r\nThis PR is backward compatible in the sense that it allows new valid invocations that were previously rejected (failed or somehow ignored).\r\nIn `master`, any valid option following a command is treated as a positional argument. This can lead to unexpected RPC errors or help messages due to mismatched argument types. With this PR, those cases are parsed as proper options when applicable.\r\n\r\n- `bitcoin-cli` continues to accept RPC arguments that begin with a `-` character as currently in `master` (check `createwallet` example in _\"What's change in ArgsManager\"_ section above).\r\n\r\n- `bitcoin-cli` could distinguish between options that begin with single and double dashes, and treat options after the RPC method name that begin with double dashes as RPC named parameters (check example in 4th [commit](https://github.com/bitcoin/bitcoin/pull/33540/commits/a101bbb61fdf5563337334d63a10432432ee3625) message body).\r\n\r\n- Refactored both `ArgsManager::ProcessOptionKey` (new function added in this PR) and `ArgsManager::ParseParameters` in separated commits making the code clearer and the PR much easier to follow and review.",
      "state": "open",
      "user": "pablomartin4btc",
      "created_at": "2025-10-04T22:43:06Z",
      "updated_at": "2026-01-25T13:00:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33540",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 2,
        "text_length": 6987,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2925411752,
      "number": 33646,
      "title": "log: check fclose() results and report safely in logging.cpp",
      "body": "`fclose()` can report write errors (for example if the disk is full or the filesystem has a problem). Right now, some `fclose()` calls in `src/logging.cpp` ignore the return value. This means errors might go unnoticed and log lines could be lost without warning.\r\n\r\n## What this PR does:\r\n- Add a small helper that prints `fclose()` errors to `stderr` (with path and errno).\r\n- In shutdown: close `m_fileout` safely and report errors.\r\n- In reopen: open the new file, swap it in, close the old one, and report errors if closing fails.\r\n- In shrink/rotate: check all `fclose(file)` calls and report failures.\r\n\r\nNo other behavior changes. Normal logging, rotation, and console output remain unchanged.",
      "state": "open",
      "user": "cedwies",
      "created_at": "2025-10-17T19:06:08Z",
      "updated_at": "2026-01-25T12:30:51Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33646",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 761,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2934151848,
      "number": 33671,
      "title": "wallet: Add separate balance info for non-mempool wallet txs",
      "body": "Changes `getbalances` to report the sum of txos spent by transactions that aren't confirmed nor in the mempool (eg due to being part of too long a mempool chain, or spending non-standard outputs, or having a datacarrier output that exceeds `-datacarriersize`, etc). Those values are added to the trusted/untrusted_pending/immature/used fields as appropriate (where previously they were skipped), and subtracted from the new nonmempool field, so that the sum of all fields remains the same.\r\n\r\nFor example:\r\n\r\n```\r\n$ bitcoin-cli -regtest getbalances\r\n{\r\n  \"mine\": {\r\n    \"trusted\": 6049.99999220,\r\n    \"untrusted_pending\": 0.00000000,\r\n    \"immature\": 3200.00000780,\r\n    \"nonmempool\": -100.00000000\r\n  },\r\n  \"lastprocessedblock\": {\r\n    \"hash\": \"3ab4582226d5e8ad76438db48d76e822c31bce2cdbc7ba82a5d974a277515d0d\",\r\n    \"height\": 221\r\n  }\r\n}\r\n```\r\n\r\nCloses #11887",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2025-10-21T16:59:13Z",
      "updated_at": "2026-01-25T12:20:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33671",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 922,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3054115118,
      "number": 33965,
      "title": "mining: fix -blockreservedweight shadows IPC option",
      "body": "Also enforce `MINIMUM_BLOCK_RESERVED_WEIGHT` for IPC clients.\r\n\r\nThe `-blockreservedweight` startup option should only affect RPC code, because IPC clients (currently) do not have a way to signal their intent to use the node default (the `BlockCreateOptions` struct defaults merely document a recommendation for client software).\r\n\r\nBefore this PR however, if the user set `-blockreservedweight` then `ApplyArgsManOptions` would cause the `block_reserved_weight` option passed by IPC clients to be ignored. _Users who don't set this value were not affected._\r\n\r\nFix this by making BlockCreateOptions::block_reserved_weight an\r\nstd::optional.\r\n\r\nInternal interface users, such as the RPC call sites, don't set a\r\nvalue so -blockreservedweight is used. Whereas IPC clients do set\r\na value which is no longer ignored.\r\n\r\nTest coverage is added, with a preliminary commit that refactors the `create_block_template` and `wait_next_template` helpers.\r\n\r\n`mining_basic.py` already ensured `-blockreservedweight` is enforced by mining RPC methods. The second commit adds coverage for Mining interface IPC clients. It also verifies that `-blockreservedweight` has no effect on them.\r\n\r\nThe third commit enforces `MINIMUM_BLOCK_RESERVED_WEIGHT` for IPC clients. Previously lower values were quietly clamped.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-28T13:38:33Z",
      "updated_at": "2026-01-25T11:06:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33965",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1349,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2259275135,
      "number": 31599,
      "title": "qa: Improve framework.generate* enforcement (#31403 follow-up)",
      "body": "#31403 follow-up, see [comment](https://github.com/bitcoin/bitcoin/pull/31403#pullrequestreview-2498806354)\r\n\r\n- Rename `invalid_call` parameter to `called_by_framework` in `generateblock`, `generatetoaddress` and `generatetodescriptor` mining methods to better express its intended usage. \r\n- Add explicit assertion message clarifying that these functions should only be called by TestFramework itself to maintain proper node synchronization.",
      "state": "closed",
      "user": "yuvicc",
      "created_at": "2025-01-03T13:41:58Z",
      "updated_at": "2026-01-25T11:01:35Z",
      "merged_at": "2025-01-24T23:33:23Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31599",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 506,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2167854949,
      "number": 31241,
      "title": "wallet: remove BDB dependency from wallet migration benchmark",
      "body": "Part of the legacy wallet removal working path #20160.\r\n\r\nStops creating a bdb database in the wallet migration benchmark.\r\nInstead, the benchmark now creates the db in memory and re-uses it for the migration process.",
      "state": "closed",
      "user": "furszy",
      "created_at": "2024-11-07T16:42:00Z",
      "updated_at": "2026-01-25T11:01:35Z",
      "merged_at": "2025-01-24T23:21:59Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31241",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 279,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3091431534,
      "number": 34049,
      "title": "rpc: Disallow captures in RPCMethodImpl",
      "body": "When defining `RPCHelpMan` objects, we usually return a lambda, and mostly we define those via `[&](...) { ... }` which explicitly captures any parameters or local variables by reference. If we were to actually use any of those captures (we don't), we would invoke undefined behaviour. So instead, convert all the `[&]` to `[]` to avoid capturing, and as part of `RPCHelpMan` check that the function we provide is convertible to a bare function pointer, so that any attempts to capture anything (even if it's by-copy, which is safe) results in an error.\r\n\r\nWhile we're at it, rename `RPCHelpMan` to `RPCMethod`, reflecting it's greater responsibility since #19386.",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2025-12-11T03:25:25Z",
      "updated_at": "2026-01-25T10:17:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34049",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 704,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3208091260,
      "number": 34404,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "JeevanYewale",
      "created_at": "2026-01-25T09:36:35Z",
      "updated_at": "2026-01-25T09:36:55Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34404",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3208085589,
      "number": 34403,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "JeevanYewale",
      "created_at": "2026-01-25T09:32:43Z",
      "updated_at": "2026-01-25T09:33:10Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34403",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3124280596,
      "number": 34141,
      "title": "miniscript: Use Func and Expr when parsing keys, hashes, and locktimes",
      "body": "The miniscript parser currently only looks for the next `)` when parsing key, hash, and locktime expressions. This fails to parse when the expressions contain a nested expression. Currently, this is only possible with `musig()` inside of key expressions. However, this pattern can be generalized to handling hashes and locktimes, so I implemented those too.\r\n\r\nFixes #34076",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-12-22T21:36:58Z",
      "updated_at": "2026-01-25T09:32:05Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34141",
      "labels": [
        "Descriptors"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 444,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3208083364,
      "number": 34402,
      "title": "doc: Fix grammar in CONTRIBUTING.md",
      "body": "## Summary\r\nFix grammatical error in the contributing guidelines.\r\n\r\n## Changes\r\n- Change \"Valid areas as:\" to \"Valid areas are:\" for proper grammar\r\n\r\nThis is a minor documentation improvement to enhance readability.\r\n",
      "state": "closed",
      "user": "JeevanYewale",
      "created_at": "2026-01-25T09:30:56Z",
      "updated_at": "2026-01-25T09:31:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34402",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 255,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3163535277,
      "number": 34254,
      "title": "validation: Prevent duplicate logging and looping in invalid block handling",
      "body": "`InvalidChainFound()` is called from 3 spots:\r\n1. from `InvalidBlockFound()`\r\n2. from `ActivateBestChain()`, with the highest connectable block of the chain\r\nas an arg (after having called `InvalidBlockFound()` already for the block that failed in `ConnectTip()`)\r\n3. from `InvalidateBlock()` (rpc-only)\r\n\r\nMost of the logic in `InvalidChainFound()` is not required for 2) and 3):\r\nIn `ActivateBestChain()`, the previous call to `InvalidChainFound()` before via `InvalidBlockFound` did the flag updates, best header calculation and logging, so only `m_best_invalid` could need additional updating.\r\nIn `InvalidateBlock()` (which doesn't call `InvalidBlockFound()`), we do most of the accounting manually.\r\n\r\nTherefore move of all logic but the `m_best_invalid` update into `InvalidBlockFound()`, avoiding duplicate logging and unnecessary work (the loops over the block index in `SetBlockFailureFlags()` and `RecalculateBestHeader()`\r\nwere done twice before).\r\n\r\nThe second commit renames `InvalidChainFound` to `UpdateBestInvalid` to adjust to its remaining role.\r\n\r\nThis addresses past discussions about repeated work in `InvalidateBlock()` (https://github.com/bitcoin/bitcoin/pull/31405#discussion_r2135717500) and `ActivateBestChain()` (https://github.com/bitcoin/bitcoin/pull/31533#discussion_r2607189790)",
      "state": "open",
      "user": "mzumsande",
      "created_at": "2026-01-11T16:59:21Z",
      "updated_at": "2026-01-25T08:17:41Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34254",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1386,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3166250753,
      "number": 34264,
      "title": "fuzz: Extend `spend` coverage",
      "body": "Make the `wallet/spend` fuzz target stateful and extend coverage for several missing methods.",
      "state": "open",
      "user": "Chand-ra",
      "created_at": "2026-01-12T15:12:26Z",
      "updated_at": "2026-01-25T08:08:15Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34264",
      "labels": [
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 123,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3174053537,
      "number": 34286,
      "title": "test: verify node state after restart in assumeutxo",
      "body": "## Summary\n\nThis PR replaces the TODO comment in `wallet_assumeutxo.py` (line 242) with actual test assertions that verify node and wallet behavior after a restart during assumeutxo background sync.\n\n## Changes\n\nThe new tests verify:\n- Two chainstates exist (background validation not complete)\n- Background chainstate is still at `START_HEIGHT`\n- Snapshot chainstate has synced to at least `PAUSE_HEIGHT`\n- Wallets cannot be loaded after restart (expected behavior)\n- Wallet backup from before snapshot height cannot be restored\n\n## Motivation\n\nDuring implementation, I discovered that **wallets cannot be loaded after a node restart during assumeutxo background sync**. This is expected behavior because:\n- The wallet loading code checks if required blocks are available for rescanning\n- During assumeutxo background sync, blocks before the snapshot are not available\n- This applies to all wallets, including watch-only wallets created at the snapshot height\n\nThis is a valuable test addition because it documents this expected behavior and ensures it doesn't regress. Users should be aware that if they restart their node during assumeutxo background sync, they won't be able to load their wallets until the background sync completes.\n\n## Related\n\nrefs #28648\n\nAddresses the TODO comment that was originally added as part of the assumeutxo wallet test implementation.",
      "state": "open",
      "user": "yashbhutwala",
      "created_at": "2026-01-14T15:55:59Z",
      "updated_at": "2026-01-25T07:49:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34286",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1422,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3174906348,
      "number": 34293,
      "title": "Bugfix: net_processing: Restore missing comma between peer and peeraddr in \"receive version message\" and \"New ___ peer connected\"",
      "body": "Versions prior to 29.x all included a comma here, and the general format of the message still includes commas between all other fields\r\n",
      "state": "open",
      "user": "luke-jr",
      "created_at": "2026-01-14T20:34:00Z",
      "updated_at": "2026-01-25T07:42:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34293",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 266,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3176742789,
      "number": 34301,
      "title": "wallet: remove outdated `RewriteDB` calls from SPKM & `DBErrors::NEED_REWRITE` enum value",
      "body": "ISTM that there is no implementation left of the `RewriteDB` method in any of the SPKMs, and thus, its call sites can be removed safely.\r\n\r\nAlso remove `DBErrors::NEED_REWRITE` enum value as its usage is outdated now.\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "open",
      "user": "rkrux",
      "created_at": "2026-01-15T10:11:36Z",
      "updated_at": "2026-01-25T07:33:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34301",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 2373,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3187823761,
      "number": 34342,
      "title": "cli: Replace libevent usage with simple http client",
      "body": "Part of the effort to remove the libevent dependency altogether, see #31194\r\n\r\nThis takes the [`HTTPHeaders` class](https://github.com/bitcoin/bitcoin/pull/32061/commits/d549f01caab659f1c431ccabf0f5ff1800debcfe) from #32061 and puts it into [`common/http.h|cpp`](https://github.com/bitcoin/bitcoin/pull/34342/commits/634d4dcfa428f17f0a12c2e2742c2c08e2345033). While it would not be strictly required for that PR to go in first, it might be better to review it first or simultaneously.\r\n\r\nOtherwise the change itself replaces the libevent-based HTTP client with a simple synchronous implementation which uses the `Sock` class directly.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2026-01-19T13:27:54Z",
      "updated_at": "2026-01-25T06:56:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34342",
      "labels": [
        "Scripts and tools"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 686,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2989452954,
      "number": 33822,
      "title": "kernel: Add block header support and validation",
      "body": "Adds a new `btck_BlockHeader` type and associated functions to create, access, and validate block headers. Block headers will have their own type (`btck_BlockHeader`) that can be created from raw data, copied, and queried for all the standard header fields (hash, prev hash, timestamp, bits, version, nonce). We can also extract headers from full blocks or block tree entries.\r\n\r\nThe first commit here refactors `BlockValidationState` to use Handle/View pattern so external code can own them, which is required for the header processing in the API.\r\n\r\n #### New Block Header API\r\n\r\n  - **`btck_BlockHeader` type**: Opaque handle for block headers\r\n  - **Header methods**:\r\n    - `btck_block_header_create()`: Create header from 80-byte serialized data\r\n    - `btck_block_header_copy()`: Copy block headers\r\n    - `btck_block_header_destroy()`: Destroy header object\r\n    - `btck_block_header_get_hash()`: Calculate block hash\r\n    - `btck_block_header_get_prev_hash()`: Get previous block hash\r\n    - `btck_block_header_get_timestamp()`: Get block timestamp\r\n    - `btck_block_header_get_bits()`: Get difficulty target (compact format)\r\n    - `btck_block_header_get_version()`: Get block version\r\n    - `btck_block_header_get_nonce()`: Get proof-of-work nonce\r\n    \r\n    - `btck_block_get_header()`: Extract header from a full block\r\n    - `btck_block_tree_entry_get_block_header()`: Get header associated with a block tree entry\r\n  \r\n  - **Header Processing Methods:**\r\n    - **`btck_chainstate_manager_process_block_header()`**: Validates and processes a block header without requiring the full block. This performs proof-of-work verification, timestamp validation, and updates the internal chain state.\r\n    - **`btck_chainstate_manager_get_best_entry()`**: Returns the block tree entry with the most cumulative proof-of-work.\r\n\r\nWhy `btck_chainstate_manager_get_best_entry()` is included alongside header validation? Just as we have logic to get the tip for block validation (so you can request more blocks extending your best from your peers), we need the equivalent for header validation. To make header validation worthwhile, knowing what the best current header is seems useful—it tells you what headers to request next from peers.\r\n\r\n\r\n\r\n  ### Testing\r\n\r\n  Added tests in `test_kernel.cpp` that cover creating headers from raw data, extracting all header fields, and processing headers through the chainstate manager.\r\n  \r\n  CC sedited",
      "state": "closed",
      "user": "yuvicc",
      "created_at": "2025-11-07T17:16:01Z",
      "updated_at": "2026-01-25T06:52:22Z",
      "merged_at": "2026-01-23T13:04:11Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33822",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2492,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1216590444,
      "number": 26966,
      "title": "index: initial sync speedup, parallelize process",
      "body": "The current procedure for building the block filter index involves processing filters one at a time;\r\nReading blocks, undo data, and previous headers from disk sequentially.\r\n\r\nThis PR introduces a new mechanism to perform the work concurrently. Dividing the filters\r\ngeneration workload among a pool of workers that can be configured by the user,\r\nsignificantly increasing the speed of the index construction process.\r\n\r\nThe same concurrent processing model has been applied to the transactions index as well.\r\n\r\nThe newly introduced init flag `-indexworkers=<n>` enables the concurrent sync\r\nbehavior.\r\nWhere \"n\" is the number of worker threads that will be spawned at startup to create ranges\r\nof block filters during the initial sync process. Destroying the workers pool once the\r\ninitial sync completes.\r\nNote: by default, the parallelized sync process is not enabled.\r\n\r\nNow the juicy part:\r\nIn my computer, with the node in debug mode and on IBD, with `-indexworkers=4`, the\r\nblock filter index generation took less than an hour. While, in master, the sync took more than 7 hours.\r\n\r\nImportant Note:\r\nAs the access to the block data on disk is protected by `cs_main`, this new feature runs substantially\r\nfaster when the node is not in IBD.\r\n\r\n#### Testing Notes:\r\n\r\n1. Sync your node without any index.\r\n2. Restart the node with one of the indexes (`-blockfilterindex` or `-txindex`) and `-connect=0` (to sync only the index, without running the net/validation threads. Since threads won't be competing for `cs_main`, this will give you a more accurate result).\r\n\r\n   You’ll see a \"[index name] is enabled at height [height]\" log entry once it finishes. Then it’s just a matter of subtracting the index startup time from the \"index synced\" log time.\r\n\r\n  Keep in mind that threads are shared among all indexes you start. So if you run both indexes at the same time, your benchmark results cannot be compared against single-index runs.\r\n\r\n#### Fuzz Test Coverage Report\r\nCoverage diff for the fuzz test can be found on https://brunoerg.xyz/bitcoin-core-coverage/26966/coverage_report/",
      "state": "open",
      "user": "furszy",
      "created_at": "2023-01-25T13:36:23Z",
      "updated_at": "2026-01-25T00:05:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/26966",
      "labels": [
        "UTXO Db and Indexes",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2140,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1678271840,
      "number": 29247,
      "title": "CAT in Tapscript (BIP-347)",
      "body": "# CAT in Tapscript\r\n\r\nThis PR provides the necessary code to enable the opcode OP\\_CAT in Tapscript as specified in [BIP-347: OP\\_CAT in Tapscript](https://github.com/bitcoin/bips/blob/master/bip-0347.mediawiki) and [BIN-2024-0001](https://github.com/bitcoin-inquisition/binana/blob/master/2024/BIN-2024-0001.md),\r\n\r\n**Important:** This PR *does not* include miner activation functionality. This means that merging this PR into bitcoin-core will not make OP\\_CAT functional in Bitcoin.\r\nIf this PR is merged it is *not* a signal of community consensus around activating CAT nor be read as a portent about the activation process or timeline.\r\nThe PR is not a stand-in for consensus around such decisions.\r\n\r\nThis PR includes:\r\n\r\n- An implementation of the Tapscript opcode OP\\_CAT along with the flags `SCRIPT_VERIFY_OP_CAT` and `SCRIPT_VERIFY_DISCOURAGE_OP_CAT`.\r\n- Integration and unit tests which ensure that our CAT  implementation works as expected. This includes ensuring that CAT never uses more that 520 bytes of stack memory. A full description of what these tests cover is given below.\r\n- An improvement to `src/test/script_tests.cpp` JSON script format enabling the rapid creation of new Tapscript unit tests.\r\n\r\n## Activation on Bitcoin-inquisition (signet)\r\n\r\n[Bitcoin-inquisition PR 37](https://github.com/bitcoin-inquisition/bitcoin/pull/39) which contained our implementation of OP\\_CAT [was merged into bitcoin-inquisition (signet) on Apr 25 2024](https://github.com/bitcoin-inquisition/bitcoin/pull/39), released as [bitcoin-inquisition release 25.2 on Apr 26 2024.](https://github.com/bitcoin-inquisition/bitcoin/releases/tag/v25.2-inq) and activated in bitcoin-inquisition Apr 30 2024. The bitcoin-inquisition PR was reviewed in the PR review club [(transcript of discussion)](https://bitcoincore.reviews/bitcoin-inquisition-39). Since Apr 30 2024 there have been many OP\\_CAT transactions created and spent on signet.\r\n\r\nThe code merged into bitcoin-inquisition differs from this PR, as we have removed the consensus logic which was used to activate it on signet.\r\n\r\n## OP\\_CAT Tapscript Implementation\r\n\r\nWe implement OP\\_CAT as a new Tapscript op code by redefining the opcode OP\\_SUCCESS126 (126 in decimal and 0x7e in hexadecimal). This is the same opcode value used by the original OP_CAT.\r\n\r\nWhen evaluated, the OP\\_CAT instruction:\r\n\r\n1. Pops the top two values off the stack,\r\n2. concatenates the popped values together in stack order,\r\n3. and then pushes the concatenated value on the top of the stack.\r\n\r\nOP\\_CAT fails if there are fewer than two values on the stack or if a concatenated value would have a combined size greater than the maximum script element size of 520 bytes.\r\n\r\nSee [BIP 347](https://github.com/bitcoin/bips/blob/master/bip-0347.mediawiki) for a deeper description.\r\n\r\n### Errors thrown\r\n\r\nIf evaluated OP\\_CAT can throw the following errors:\r\n\r\n- If at time of evaluation the stack has fewer than two elements we throw the error: `SCRIPT_ERR_INVALID_STACK_OPERATION`\r\n- If at time of evaluation the top two stack elements have a combined size greater than `MAX_SCRIPT_ELEMENT_SIZE` (520 bytes) we throw the error: `SCRIPT_ERR_PUSH_SIZE`.\r\n\r\n### Script verification flags\r\n\r\nWhile this PR does not contain any miner signaling and activation logic and can not activate OP\\_CAT, it does contain two flags which future activation logic could set to control activation of OP\\_CAT.\r\n\r\n- `SCRIPT_VERIFY_OP_CAT` IF a bitcoin node has this set to true, then it treat OP\\_CAT enabled for Tapscript. That is, OP\\_SUCCESS126 will be redefining to OP\\_CAT in Tapscript. If this was set to true at the consensus level this would cause a soft fork.\r\n\r\n`SCRIPT_VERIFY_DISCOURAGE_OP_CAT` When set to true, a node receiving any Tapscript transaction containing the opcode OP\\_CAT or OP\\_SUCCESS126 will reject the transaction throwing the error `SCRIPT_ERR_DISCOURAGE_OP_CAT` but not banning the node which relayed the transaction. This prevents nodes from relaying transactions with OP\\_CAT. This  is equivalent to the behavior of `SCRIPT_ERR_DISCOURAGE_OP_CAT = true` when `SCRIPT_VERIFY_OP_CAT = false` as OP\\_CAT is an OP\\_SUCCESS (OP\\_SUCCESS126).\r\n\r\nThis is how these two flags are intended to be used to ensure a smooth soft fork.\r\n\r\n| Stage | `SCRIPT_VERIFY OP_CAT` | `SCRIPT_VERIFY DISCOURAGE_OP_CAT` | Status |\r\n| --- | --- | --- | --- |\r\n| **1.Default** | False | True | This does not represent any change in behavior of the bitcoin-core node. |\r\n| **2.Upgrading** | True | True | OP\\_CAT is activating. |\r\n| **3.Upgraded** | True | False | It is clear that OP\\_CAT has been activated and the network has been upgraded. |\r\n\r\nThe flag `SCRIPT_ERR_DISCOURAGE_OP_CAT` provides a window of time for the network to fully activate, before nodes will relay or accept transactions containing OP\\_CAT in their mem pools.\r\n\r\n## Tests\r\n\r\nThis PR contains a suite of script tests to ensure that OP\\_CAT functions as expected. In the JSON script tests (`script_tests.json`), we test:\r\n\r\n- That if OP\\_CAT is not activated that there are no changes to bitcoin consensus.\r\n- That regardless of the activation or non-activation of OP\\_CAT in Tapscript, pre-Tapscript scripts, i.e. Bitcoin scripts, have no changes in behavior.\r\n- That OP\\_CAT when evaluated throws the expected error when there are less than two elements on the stack.\r\n- That OP\\_CAT when evaluated in a variety of circumstances and edge cases, successfully concatenates elements of the stack. This includes:\r\n  - multiple calls to OP\\_CAT in a row,\r\n  - evaluating OP\\_CAT inside of a IF conditional,\r\n  - evaluating OP\\_CAT on zero size stack elements, random and large stack elements,\r\n  - evaluating OP\\_CAT on values being moved to and from the alt stack,\r\n  - and checking that when evaluated OP\\_CAT concatenates the elements in the expected order.\r\n\r\nAll of these tests are designed to cover the happy path of OP\\_CAT, the various errors which OP\\_CAT can throw and all the corner cases between those two outcomes.\r\n\r\nAdditionally we include three tests outside of the JSON script tests.\r\n\r\n- `cat_simple` and `cat_empty_stack` are designed to test OP\\_CAT outside of the JSON serialization regime. Ensure that we catch bugs that we might miss in the JSON script tests due to a bug introduced at the JSON serialization layer.\r\n- `cat_dup_test` enumerates all stack element sizes from 1 to 522 bytes and then enumerates up to 10 repetitions of `OP\\_DUP OP\\_CAT`. It then tests if the stack element would exceed 520 bytes and if so did OP\\_CAT throw the error `SCRIPT_ERR_PUSH_SIZE`. This allows us to be certain that OP\\_CAT will not introduce any `OP\\_DUP OP\\_CAT` memory exhaustion attacks.\r\n\r\n### Better Tapscript tests in JSON script tests\r\n\r\nWhile writing these JSON script tests (`script_tests.json`) we ran into the following problem. The JSON script tests are simple and easy to write for pre-Tapscript scripts, but adding or changing a Tapscript test requires substantial work per test.\r\nConsider the following pre-tapscript test:\r\n\r\n```json\r\n[\"'aa' 'bb'\", \"CAT 0x4c 0x02 0xaabb EQUAL\", \"P2SH,STRICTENC\", \"DISABLED_OPCODE\", \"CAT disabled\"]\r\n```\r\n\r\nwhereas a Tapscript test for the same script (annotated with comments for better readability) would look like:\r\n\r\n```json\r\n[\r\n    [\r\n        \"aa\",\r\n        \"bb\",\r\n        \"7e4c02aabb87\", // output script\r\n        \"c0d6889cb081036e0faefa3a35157ad71086b123b2b144b649798b494c300a961d\", // control block\r\n        0.00000001\r\n    ],\r\n    \"\",\r\n    \"0x51 0x20 0x15048ed3a65748549c27b671936987093cf73a4c9cb18522a74fb9553060ca99\", // Tapscript output\r\n    \"P2SH,WITNESS,TAPROOT\",\r\n    \"OK\",\r\n    \"TAPSCRIPT CATs aa and bb together and checks if EQUAL to aabb\"\r\n]\r\n```\r\n\r\nComputing the Tapscript output, such as `0x51 0x20 0x15048ed3a65748549c27b671936987093cf73a4c9cb18522a74fb9553060ca99`, requires writing custom code and running it for each test. The same is true for the Tapscript control block, such as `c0d6889cb081036e0faefa3a35157ad71086b123b2b144b649798b494c300a961d`. If a test is changed or updated new outputs and control blocks must be computed. The complexity of doing this is likely the reason that no one has added any Tapscript tests to JSON script tests until this PR.\r\n\r\nIn this PR we address this issue by adding the following improvements to JSON script tests:\r\n\r\n- Adding simple macros (`\"#SCRIPT#` and `#CONTROLBLOCK#`) that allow the script test parser to automatically generate and inject a valid Tapscript output and control block to be computed automatically from the JSON script.\r\n- Allowing Tapscript scripts to use the human readable strings like pre-script scripts by marking the location of the script in the witness stack using `#SCRIPT#`. This transforms the unreadable script `7e4c02aabb87` into `#SCRIPT# CAT 0x4c 0x02 0xaabb EQUAL`.\r\n\r\nThis results in the following JSON script test which is far easier to write and easier to read.\r\n\r\n```json\r\n[\r\n    [\r\n        \"aa\",\r\n        \"bb\",\r\n        \"#SCRIPT# CAT\",\r\n        \"#CONTROLBLOCK#\",\r\n        0.00000001\r\n    ],\r\n    \"\",\r\n    \"0x51 0x20 #TAPROOTOUTPUT#\",\r\n    \"P2SH,WITNESS,TAPROOT,OP_CAT\",\r\n    \"OK\",\r\n    \"TAPSCRIPT Test of OP_CAT flag by calling CAT on two elements. TAPSCRIPT_OP_CAT flag is set so CAT is executed.\"\r\n],\r\n```\r\n  \r\n",
      "state": "open",
      "user": "arminsabouri",
      "created_at": "2024-01-14T22:40:42Z",
      "updated_at": "2026-01-24T23:37:47Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29247",
      "labels": [
        "Consensus",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 4,
        "positive_keywords": 1,
        "text_length": 9301,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3205154700,
      "number": 34396,
      "title": "refactor: modernize FuzzedDataProvider with if constexpr and safe casts",
      "body": "This PR modernizes `FuzzedDataProvider.h` by resolving outstanding C++17 migration TODOs.\r\n\r\n1. Replace conditional with `if constexpr` in `ConvertUnsignedToSigned`\r\n   - The TODO noted this should be changed once C++17 becomes mainstream\r\n\r\n2. Fix signed/unsigned comparison\r\n   - Add explicit cast in comparison to avoid implicit conversions\r\n   - Makes the type conversion explicit and safer\r\n\r\n3. Remove outdated TODO in `PickValueInArray`\r\n   - The TODO suggested using `static_assert`, but this is not possible since `std::initializer_list::size()` is a runtime value when passed as a function parameter\r\n\r\nMotivation:\r\n\r\nThese TODOs have been present since the code was written, waiting for C++14/C++17 adoption. Since Bitcoin Core now uses C++20, these modernizations are long overdue.\r\n",
      "state": "closed",
      "user": "b-l-u-e",
      "created_at": "2026-01-23T22:41:30Z",
      "updated_at": "2026-01-24T20:37:03Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34396",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 867,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2173924864,
      "number": 31275,
      "title": "doc: corrected lockunspent rpc quoting",
      "body": "bitcoin-cli help lockunspent RPC example shows:\r\n\r\n```\r\nAs a JSON-RPC call\r\n> curl --user myusername --data-binary '{\"jsonrpc\": \"1.0\", \"id\": \"curltest\", \"method\": \"lockunspent\", \"params\": [false, \"[{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\",\\\"vout\\\":1}]\"]}' -H 'content-type: text/plain;' http://127.0.0.1:8332/\r\n```\r\nIncluding quotes around the transactions argument. Using the RPC in this way fails:\r\n\r\n```\r\ncurl --data-binary '{\"jsonrpc\": \"1.0\", \"id\": \"curltest\", \"method\": \"lockunspent\", \"params\": [false, \"[{\\\"txid\\\":\\\"6f244af8e2162138369fc736a673f85ead59ad88fb5a1edd6e03f81b33c537b0\\\",\\\"vout\\\":1}]\"]}' -H 'content-type: text/plain;' http://127.0.0.1:18443/wallet/locktest\r\n\r\n{\"result\":null,\"error\":{\"code\":-3,\"message\":\"Expected type array, got string\"},\"id\":\"curltest\"}\r\n```\r\n\r\nThis change corrects the documentation to remove the additional quotes so the example works as intended:\r\n\r\n```\r\ncurl --data-binary '{\"jsonrpc\": \"1.0\", \"id\": \"curltest\", \"method\": \"lockunspent\", \"params\": [false, [{\"txid\":\"6f244af8e2162138369fc736a673f85ead59ad88fb5a1edd6e03f81b33c537b0\",\"vout\":0}]]}' -H 'content-type: text/plain;' http://127.0.0.1:18443/wallet/locktest\r\n\r\n{\"result\":true,\"error\":null,\"id\":\"curltest\"}\r\n```",
      "state": "open",
      "user": "Talej",
      "created_at": "2024-11-12T02:44:48Z",
      "updated_at": "2026-01-24T19:59:47Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31275",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1285,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2237045890,
      "number": 31507,
      "title": "build: Use clang-cl to build on Windows natively",
      "body": "Building on Windows using Clang instead of the MS compiler may be beneficial, considering the issues with the latter, as outlined in https://github.com/bitcoin/bitcoin/issues/31456:\r\n\r\n>    * non-optimized codegen: [build: remove need to test for endianness #29852 (comment)](https://github.com/bitcoin/bitcoin/pull/29852#issuecomment-2049803970)\r\n> \r\n>    * compile failure: [MSVC 17.12.0 internal compiler error  #31303](https://github.com/bitcoin/bitcoin/issues/31303)\r\n> \r\n>    * legal, but brittle stdlib: [util: Drop boost posix_time in ParseISO8601DateTime #31391 (comment)](https://github.com/bitcoin/bitcoin/pull/31391#issuecomment-2510762011)\r\n> \r\n>    * unspecified issue: [refactor: Check translatable format strings at compile-time #31061 (comment)](https://github.com/bitcoin/bitcoin/pull/31061#issuecomment-2531244463)\r\n\r\nAdditionally, MSVC does not [support](https://learn.microsoft.com/en-us/cpp/assembler/inline/inline-assembler) inline assembly on the ARM and x64 processors.\r\n\r\nSo this PR:\r\n1. Closes https://github.com/bitcoin/bitcoin/issues/31456 (and addresses https://github.com/bitcoin/bitcoin/issues/14118).\r\n2. Could be an alternative to https://github.com/bitcoin/bitcoin/pull/24773.\r\n\r\n---\r\n\r\nAdditionally, clang-cl:\r\n1. Produces binaries with [better](https://github.com/bitcoin-core/secp256k1/pull/1681) performance. For example:\r\n\r\n| MSVC, block/s | clang-cl, block/s | benchmark |\r\n|--------------:|------------------:|:----------|\r\n|          7.40 |             11.52 | `ConnectBlockAllEcdsa`\r\n|          7.32 |             11.81 | `ConnectBlockAllSchnorr`\r\n|          7.38 |             11.45 | `ConnectBlockMixedEcdsaSchnorr`\r\n|         91.86 |            143.12 | `DeserializeAndCheckBlockTest`\r\n|        121.46 |            189.04 | `DeserializeBlockTest`\r\n\r\n2. Builds faster on the CI:\r\n    - [MSVC](https://github.com/bitcoin/bitcoin/actions/runs/13792522864/job/38575846787) - 20m 35s\r\n    - [clang-cl](https://github.com/bitcoin/bitcoin/actions/runs/13792522864/job/38575849680) - 12m 43s\r\n",
      "state": "open",
      "user": "hebasto",
      "created_at": "2024-12-16T10:58:38Z",
      "updated_at": "2026-01-24T18:30:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31507",
      "labels": [
        "Windows",
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2081,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1933587757,
      "number": 30322,
      "title": "test: raise an error in `_bulk_tx_` when `target_vsize` is too low",
      "body": "This is a simple test PR that does two things:\r\n\r\n1. Raise an exception in `_bulk_tx_` when `target_vsize` is too low, i.e., below the tx vsize.\r\n2. Addresses some review comments from https://github.com/bitcoin/bitcoin/pull/30162, which are:\r\n   - Raise an error if the output value is less than or equal to zero in `create_self_transfer`.\r\n\tThis prevents creating transactions with a value of 0 or less.\r\n   - Add a test to verify that `create_self_transfer_multi` also respects the passed `target_vsize`.\r\n",
      "state": "closed",
      "user": "ismaelsadeeq",
      "created_at": "2024-06-22T14:20:14Z",
      "updated_at": "2026-01-24T11:01:14Z",
      "merged_at": "2025-01-24T23:27:42Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30322",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 576,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1547517671,
      "number": 28616,
      "title": "Show transactions as not fully confirmed during background validation",
      "body": "Fixes #28598: currently if assumeutxo were to be used, transactions might get shown as confirmed even while the entire chainstate is unconfirmed.\r\n\r\nThis also adds an `assumed` value to `listtransactions` etc, shown only for confirmed transactions when a snapshot is loaded.\r\n\r\nThe UI experience for assume utxo still needs work. This PR makes the wallet UI safer by not rendering transactions as fully confirmed until the background validation is done.\r\n\r\nInstead it shows the same icon as when a transaction has 1 confirmation. This is quite conservative. The cost of tricking someone into accepting a fake coin, by giving them a invalid snapshot`*` and then mining a block on top of it, is higher than a regular doublespend by mining.\r\n\r\n![pending](https://github.com/bitcoin/bitcoin/assets/10217/a2a95190-a1a7-402e-822b-b0829d5bdf45)\r\n\r\n`* =` in the current implementation this involves giving someone a malicious binary or getting them to recompile\r\n\r\nCaveat: because transaction state is updated after `blockConnected`, if you restart the node during background sync, then the transaction will show as fully confirmed (`\"assumed\": false`) briefly - until the next block is connected.",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2023-10-09T09:47:24Z",
      "updated_at": "2026-01-24T11:01:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28616",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1259,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2029328390,
      "number": 30688,
      "title": "fuzz: speed up addrman",
      "body": "There is no need to iterate 10'000 times and\r\ncall `Add` 10'000 times at once (we only add\r\n1000 addresses at once in practice). These values\r\nwere introduced in 214d9055acdd72189a2f415477ce472ca8db4191.\r\n\r\nI see an avg of 40 exec/s on master for this target and 115 exec/s on this branch.",
      "state": "closed",
      "user": "brunoerg",
      "created_at": "2024-08-21T09:20:06Z",
      "updated_at": "2026-01-24T11:01:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30688",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 312,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2255637174,
      "number": 31581,
      "title": "test: have miner_tests use  Mining interface",
      "body": "Needed for both #31283 and #31564.\r\n\r\nBy using the Mining interface in `miner_tests.cpp` we increase its coverage in unit tests.",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2024-12-30T16:34:31Z",
      "updated_at": "2026-01-24T11:01:12Z",
      "merged_at": "2025-01-06T23:28:48Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31581",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 173,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2244189529,
      "number": 31539,
      "title": "optimization: buffer reads(23%)/writes(290%) in [undo]block [de]serialization, 6% faster IBD",
      "body": "An alternative implementation of https://github.com/bitcoin/bitcoin/pull/31551, where the block is read into memory in chunks, resulting in similar gains, but is slightly more complicated, but uses less memory.\r\n\r\n---\r\n\r\n\r\nThis is a precursor to https://github.com/bitcoin/bitcoin/pull/31144.\r\n\r\nCurrently, obfuscation operations are performed byte-by-byte during serialization. Buffering the reads allows batching these operations (implemented in https://github.com/bitcoin/bitcoin/pull/31144) and improves file access efficiency by reducing fread calls and associated locking overhead. Testing with various buffer sizes showed that 16 KiB provides the best performance.\r\n\r\nFor writes, buffering enables batched obfuscations directly on the internal buffer, avoiding the need to copy input spans for obfuscation. Xor key offsets are calculated based on the file position, and the batched obfuscation is applied before writing to disk.\r\n\r\n`BufferedFile` was avoided for both reads and writes due to its unrelated operations and potential deprecation.\r\n\r\n--------\r\n\r\n2 full IBD runs against master for 870k blocks (seeded from real nodes) indicates a 6% total speedup.\r\n\r\n<details>\r\n<summary>Details</summary>\r\n\r\n```bash\r\nhyperfine --runs 2 --export-json /mnt/my_storage/ibd-xor-buffered.json --parameter-list COMMIT d73f37dda221835b5109ede1b84db2dc7c4b74a1,6853b2740851befffa3ca0b24d94212ed1e48d66 --prepare 'rm -rf /mnt/my_storage/BitcoinData/* && git checkout {COMMIT} && git clean -fxd && git reset --hard && cmake -B build -DCMAKE_BUILD_TYPE=Release -DBUILD_UTIL=OFF -DBUILD_TX=OFF -DBUILD_TESTS=OFF -DENABLE_WALLET=OFF -DINSTALL_MAN=OFF && cmake --build build -j$(nproc)' 'COMMIT={COMMIT} ./build/src/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=870000 -printtoconsole=0'\r\n\r\nBenchmark 1: COMMIT=d73f37dda221835b5109ede1b84db2dc7c4b74a1 ./build/src/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=870000 -printtoconsole=0\r\n  Time (mean ± σ):     40216.674 s ± 113.132 s    [User: 51496.289 s, System: 3541.340 s]\r\n  Range (min … max):   40136.678 s … 40296.671 s    2 runs\r\n\r\nBenchmark 2: COMMIT=6853b2740851befffa3ca0b24d94212ed1e48d66 ./build/src/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=870000 -printtoconsole=0\r\n  Time (mean ± σ):     37964.015 s ± 624.115 s    [User: 49086.037 s, System: 3375.072 s]\r\n  Range (min … max):   37522.699 s … 38405.331 s    2 runs\r\n\r\nSummary\r\n  COMMIT=6853b2740851befffa3ca0b24d94212ed1e48d66 ./build/src/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=870000 -printtoconsole=0 ran\r\n    1.06 ± 0.02 times faster than COMMIT=d73f37dda221835b5109ede1b84db2dc7c4b74a1 ./build/src/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=870000 -printtoconsole=0\r\n```\r\n\r\n</details>\r\n\r\nMicrobenchmarks show a ~23%/290% speedup (the followup XOR batching improves this further):\r\n> cmake -B build -DBUILD_BENCH=ON -DCMAKE_BUILD_TYPE=Release && cmake --build build -j$(nproc) && build/src/bench/bench_bitcoin -filter='ReadBlockBench|SaveBlockBench' -min-time=10000\r\n\r\nBefore:\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|        2,288,264.16 |              437.01 |    0.2% |     11.00 | `ReadBlockBench`\r\n|        5,260,934.43 |              190.08 |    1.2% |     11.08 | `SaveBlockBench`\r\n\r\nAfter `optimization: Buffer serialization reads in UndoRead and ReadBlock` (23% faster read):\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|        1,847,259.64 |              541.34 |    0.2% |     11.03 | `ReadBlockBench`\r\n\r\nAfter `optimization: Buffer serialization writes in UndoWrite and WriteBlock` (290% faster write):\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|        1,804,208.61 |              554.26 |    1.4% |     10.89 | `SaveBlockBench`\r\n",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2024-12-19T11:09:38Z",
      "updated_at": "2026-01-24T11:01:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31539",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 4183,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2278194478,
      "number": 31658,
      "title": "test: p2p: fix sending of manual INVs in tx download test",
      "body": "The `test_inv_block` sub-test in p2p_tx_download.py has a subtle bug: the manual msg_inv announcements from peers currently have no effect, since they don't match the wtxidrelay setting (=true by default for `P2PInterface` instances) and are hence ignored by the nodes (since 2d282e0c / PR #18044):\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/e7c479495509c068215b73f6df070af2d406ae15/src/net_processing.cpp#L3904-L3911\r\n\r\nThough the test still passes on master, it does so without the intended scenario of asking an additional peer (triggering the GETDATA_TX_INTERVAL delay). Fix this by sending the INV message with MSG_WTX instead of MSG_TX. This increases the test run time by about one minute intentionally.\r\n\r\nIt might be good to avoid issues like this in the future, happy to add test framework improvements if someone has a concrete idea.\r\n\r\n(Got into the topic of tx/wtx announcements via the discussion https://github.com/bitcoin/bitcoin/pull/31397#discussion_r1904121487)",
      "state": "closed",
      "user": "theStack",
      "created_at": "2025-01-15T03:06:39Z",
      "updated_at": "2026-01-24T11:01:11Z",
      "merged_at": "2025-01-24T10:49:22Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31658",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1038,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2282211719,
      "number": 31674,
      "title": "init: Lock blocksdir in addition to datadir",
      "body": "This probably should've been included in #12653 when `-blocksdir` was introduced. Credit TheCharlatan for noticing that it's missing.\r\n\r\nThis guards against 2 processes running with separate datadirs but the same blocksdir. I didn't add `walletdir` as I assume sqlite has us covered there.\r\n\r\nIt's not likely to happen currently, but may be more relevant in the future with applications using the kernel. Note that the kernel does not currently do any dir locking, but it should.",
      "state": "closed",
      "user": "theuni",
      "created_at": "2025-01-16T15:58:54Z",
      "updated_at": "2026-01-24T11:01:10Z",
      "merged_at": "2025-01-24T23:15:17Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31674",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 523,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2293542630,
      "number": 31718,
      "title": "Docs: fix typos in documentation files",
      "body": "",
      "state": "closed",
      "user": "wgyt",
      "created_at": "2025-01-23T03:52:41Z",
      "updated_at": "2026-01-24T11:01:09Z",
      "merged_at": "2025-01-24T10:39:42Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31718",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 39,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2296692081,
      "number": 31730,
      "title": "build: add `bitcoind-release` preset with only `BUILD_DAEMON` enabled with `release` build type",
      "body": "When benchmarking IBD or reindex behavior we have to build bitcoind only, which currently looks like:\r\n```bash\r\ncmake -B build -DCMAKE_BUILD_TYPE=Release -DBUILD_CLI=OFF -DBUILD_TESTS=OFF -DBUILD_TX=OFF -DBUILD_UTIL=OFF -DENABLE_EXTERNAL_SIGNER=OFF -DENABLE_WALLET=OFF -DINSTALL_MAN=OFF\r\n```\r\nAfter this change we can simplify that to\r\n```bash\r\ncmake --preset bitcoind-release\r\n```\r\n\r\n---\r\n\r\nYou can validate the change by comparing the outputs of before and after:\r\n```bash\r\ngit clean -fxd >/dev/null 2>&1 \\\r\n&& stdbuf -oL cmake -B build -DCMAKE_BUILD_TYPE=Release -DBUILD_CLI=OFF -DBUILD_TESTS=OFF -DBUILD_TX=OFF -DBUILD_UTIL=OFF -DENABLE_EXTERNAL_SIGNER=OFF -DENABLE_WALLET=OFF -DINSTALL_MAN=OFF 2>&1 | grep -E \"( OFF| ON)|CMAKE_BUILD_TYPE\"\r\n```\r\nvs\r\n```bash\r\ngit clean -fxd >/dev/null 2>&1 \\\r\n&& stdbuf -oL cmake --preset bitcoind-release 2>&1 | grep -E \"( OFF| ON)|CMAKE_BUILD_TYPE\"\r\n```\r\nwhich will only contain a single `CMAKE_BUILD_TYPE=\"Release\"` (but `CMAKE_BUILD_TYPE ...................... Release` should be present in both)\r\n",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2025-01-24T12:31:34Z",
      "updated_at": "2026-01-24T11:01:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31730",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1135,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2641394506,
      "number": 32876,
      "title": "refactor: use options struct for signing and PSBT operations",
      "body": "Replace the `sign`, `finalize` , `bip32derivs` and `sighash_type` arguments that are passed to `FillPSBT()` and `SignPSBTInput()` with a `PSBTFillOptions` struct.\r\n\r\n```cpp\r\nstruct PSBTFillOptions {\r\n    bool sign{true};\r\n    std::optional<int> sighash_type{std::nullopt};\r\n    bool finalize{true};\r\n    bool bip32_derivs{true};\r\n};\r\n```\r\n\r\nAdditionally this PR introduces:\r\n\r\n```cpp\r\nstruct SignOptions {\r\n    int sighash_type{SIGHASH_DEFAULT};\r\n};\r\n```\r\n\r\nThis is used by `SignTransaction` and the `MutableTransactionSignatureCreator` constructor.\r\n\r\nThese changes make it easier to add additional options later without large code churn, such as `avoid_script_path` proposed in #32857. It also makes the use of default boolean options safer compared to positional arguments that can easily get mixed up.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-07-04T12:40:44Z",
      "updated_at": "2026-01-24T08:12:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32876",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 866,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3203363765,
      "number": 34393,
      "title": "rpc: Fix off-by-one error in getblockchaininfo help",
      "body": "Correct the `headers` field description in `getblockchaininfo`.\r\n\r\nAnalogous to `blocks` (\"the height of the most-work fully-validated chain\"), `headers` reports the height of the best known header chain, not a count.\r\n\r\nI'm open to suggestions regarding the exact wording, I just want to make sure we fix the off-by-one error.\r\n\r\nSample output:\r\n```\r\n{\r\n  \"chain\": \"main\",\r\n  \"blocks\": 933527,\r\n  \"headers\": 933527,\r\n  ...\r\n}\r\n```",
      "state": "open",
      "user": "billymcbip",
      "created_at": "2026-01-23T13:46:44Z",
      "updated_at": "2026-01-24T07:30:43Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34393",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 483,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2678738082,
      "number": 33014,
      "title": "rpc: Fix internal bug in descriptorprocesspsbt when encountering invalid signatures",
      "body": "Fixes #32849\r\nThe descriptorprocesspsbt RPC was crashing with an internal bug assertion when processing PSBTs with invalid signatures (like invalid Schnorr signatures with SIGHASH_SINGLE | ANYONECANPAY flags). Instead of returning a helpful error message, it would just crash.\r\nThis change replaces the CHECK_NONFATAL call with proper error handling that catches the failure and returns a JSONRPCError with a clear message to the user.\r\nTested with Bitcoin Core v29.0.0 using the exact PSBT from the issue report. The fix now returns proper error messages instead of crashing.",
      "state": "open",
      "user": "b-l-u-e",
      "created_at": "2025-07-19T05:15:00Z",
      "updated_at": "2026-01-24T07:04:41Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33014",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 660,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2683340623,
      "number": 33032,
      "title": "wallet, test: Replace MockableDatabase with in-memory SQLiteDatabase",
      "body": "`MockableDatabase` was introduced for the tests to avoid tying non-database tests to a particular database type. However, since the only database type now is sqlite, and because the mockable behavior is no longer used by the tests, we can replace usage of the `MockabeDatabase` with a SQLite database that lives only in memory.\r\n\r\nThis is particularly useful for future work that has the wallet make use of SQLite's capabilities more, which are less conducive to having a separate mock database implementation.",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-07-21T22:36:32Z",
      "updated_at": "2026-01-24T06:35:50Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33032",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 579,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3152436690,
      "number": 34219,
      "title": "psbt: validate pubkeys in MuSig2 pubnonce/partial sig deserialization",
      "body": "The previous fix for invalid MuSig2 pubkeys (bitcoin/bitcoin#34010) only\r\naddressed the PSBT_IN_MUSIG2_PARTICIPANT_PUBKEYS field. However, the\r\nPSBT_IN_MUSIG2_PUB_NONCE and PSBT_IN_MUSIG2_PARTIAL_SIG fields also\r\ndeserialize pubkeys without validation, which could lead to crashes when\r\ninvalid pubkeys are processed.\r\n\r\nThis commit adds validation to the DeserializeMuSig2ParticipantDataIdentifier\r\nfunction to ensure all pubkeys in MuSig2 pubnonce and partial signature\r\nfields are fully valid elliptic curve points.\r\n\r\nThe fix:\r\n- Validates both aggregate and participant pubkeys in MuSig2 pubnonce and\r\n  partial signature deserialization\r\n- Throws std::ios_base::failure with descriptive error messages for invalid\r\n  pubkeys\r\n- Prevents potential crashes from invalid elliptic curve points\r\n- Maintains backward compatibility for valid PSBTs\r\n\r\nThis completes the fix for issues [#33999](https://github.com/bitcoin/bitcoin/issues/33999) and [#34201](https://github.com/bitcoin/bitcoin/issues/34201).",
      "state": "open",
      "user": "tboy1337",
      "created_at": "2026-01-07T12:41:30Z",
      "updated_at": "2026-01-24T03:13:59Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34219",
      "labels": [
        "PSBT"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1075,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2901201712,
      "number": 33585,
      "title": "cmake: Use builtin support for .manifest files",
      "body": "Remove some redundant logic from the CMake code:\r\n\r\n* The `WIN32_EXECUTABLE` target property only has an effect when building for `WIN32`. Checking `WIN32` is redundant.\r\n* CMake has builtin support for `.rc` and `.manifest` files. Both may be added to sources unconditionally. They only have an effect when building for `WIN32`.\r\n",
      "state": "open",
      "user": "purpleKarrot",
      "created_at": "2025-10-09T15:44:53Z",
      "updated_at": "2026-01-23T23:27:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33585",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 378,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2930696206,
      "number": 33663,
      "title": "net: Filter addrman during address selection via AddrPolicy to avoid underfill",
      "body": "This PR introduces `AddrMan::AddrPolicy`, a predicate that allows callers to\r\nexclude addresses during selection. The policy returns true to skip a given\r\nentry and is evaluated while holding `AddrMan::cs`.\r\n\r\nThe mechanism is used in `CConnman::GetAddressesUnsafe()` to filter out\r\nbanned and discouraged peers during address selection instead of removing\r\nthem afterward. This prevents P2P responses (`GETADDR`) and RPCs (`getnodeaddresses)` from\r\nreturning fewer results than requested when large portions of the address space are filtered.\r\n\r\nAdditional improvements:\r\n- Logs the number of filtered entries for diagnostics\r\n- Avoids redundant filtering passes in higher-level callers\r\n- Keeps locking behavior unchanged (the policy runs under `AddrMan::cs`)\r\n\r\n**Testing**\r\n- Repro: ban or discourage a large set of addresses, then call\r\n  `getnodeaddresses 1`,  previously underfilled.\r\n- After this change, the RPC returns up to the requested count as expected.\r\n\r\nNo behavior change for unaffected callers.\r\n",
      "state": "open",
      "user": "waketraindev",
      "created_at": "2025-10-20T18:03:51Z",
      "updated_at": "2026-01-23T21:20:04Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33663",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1094,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3192195239,
      "number": 34356,
      "title": "doc: clarify -bind behavior with Tor",
      "body": "Clarify the -bind help text to explain the interaction with Tor and why incoming Tor connections may be counted as regular IPv4 connections in -netinfo.\r\n\r\nFixes #33458",
      "state": "closed",
      "user": "crackedhandle",
      "created_at": "2026-01-20T17:47:30Z",
      "updated_at": "2026-01-23T19:37:15Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34356",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 205,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3034182041,
      "number": 33922,
      "title": "mining: add getMemoryLoad() and track template non-mempool memory footprint",
      "body": "Implements a way to track the memory footprint of all non-mempool transactions that are still being referenced by block templates, see discussion in  #33899. It does not impose a limit.\r\n\r\nIPC clients can query this footprint (total, across all clients) using the `getMemoryLoad()` IPC method. Its client-side usage is demonstrated here:\r\n- https://github.com/stratum-mining/sv2-tp/pull/63\r\n\r\nAdditionally, the functional test in `interface_ipc.py` is expanded to demonstrate how template memory management works: templates are not released until the client drops references to them, or calls the template destroy method, or disconnects. The destroy method is called automatically by clients using [libmultiprocess](https://github.com/bitcoin-core/libmultiprocess), as [sv2-tp](https://github.com/stratum-mining/sv2-tp) does. In the Python tests it also happens when references are destroyed or go out of scope.\r\n\r\nThe PR starts with preparation refactor commits:\r\n\r\n1. Tweaks `interface_ipc.py` so `destroy()` calls happen in an order that's useful to later demonstrate memory management\r\n2. Change `std::unique_ptr<BlockTemplate> block_template` from a `static` defined in `rpc/mining.cpp` to `NodeContext`. This prevents a crash when we switch to a non-trivial destructor later (which uses `m_node`).\r\n\r\nThen the main commits:\r\n\r\n3. Add `template_tx_refs` to `NodeContext` to track how many templates contain any given transaction. This map is updated by the `BlockTemplate` constructor and destructor.\r\n4. Add `GetTemplateMemoryUsage()` which loops over this map and sums up the memory footprint for transactions outside the mempool\r\n5. Expose this information to IPC clients via `getMemoryLoad()` and add test coverage\r\n",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-21T15:34:14Z",
      "updated_at": "2026-01-23T17:17:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33922",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1801,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3037988791,
      "number": 33929,
      "title": "test: Remove `system_tests/run_command` runtime dependencies",
      "body": "`system_tests` currently rely on `cat`, `echo`, `false` and `sh` being available in `PATH` at runtime.\r\n\r\nThis PR:\r\n1. Removes these dependencies.\r\n2. Reduces the number of platform-specific code paths.\r\n\r\nThe change is primarily motivated by my work on maintaining the [`bitcoin-core`](https://packages.guix.gnu.org/packages/bitcoin-core) package in Guix. It enables the removal of the existing `bash` and `coreutils` native inputs, which in turn makes it possible to drop the implicit dependency on `qtbase@5` (see https://codeberg.org/guix/guix/pulls/4386#issuecomment-8613333).\r\n\r\nBased on https://github.com/bitcoin/bitcoin/pull/34349.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-11-23T23:03:10Z",
      "updated_at": "2026-01-23T17:04:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33929",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 701,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2194781763,
      "number": 31349,
      "title": "ci: detect outbound internet traffic generated while running tests",
      "body": "Prevent generating outbound traffic on a non-loopback interface during tests.\r\n\r\n* Fix `node_init_tests/init_test`\r\n* Change CI to catch new regressions, including DNS traffic. DNS traffic is detected because some VMs have configured a non-loopback DNS server, `[1111:1111::1]:53`. This is achieved by running `tcpdump` during tests and inspecting its output after the tests. Add `--cap-add NET_RAW` to docker to be able to run `tcpdump`.\r\n\r\nResolves https://github.com/bitcoin/bitcoin/issues/31339\r\n",
      "state": "open",
      "user": "vasild",
      "created_at": "2024-11-22T13:58:43Z",
      "updated_at": "2026-01-23T16:02:43Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31349",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 567,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3201135611,
      "number": 34384,
      "title": "Remove epoch logic from mempool",
      "body": "Since #33591, the epoch-based graph traversal optimization logic is only used for `CTxMempool::GetChildren()`, a function that is only used in RPC code and tests. Rewrite it without epochs, and remove `util/epochguard.h` itself, as that was its last use.\r\n\r\nThis allows us to reduce per-transaction memory usage by 8 bytes, for no material loss. With the new TxGraph-based mempool implementation, I also don't foresee future uses for it, as TxGraph can do even better by using BitSet-based traversal tracking.",
      "state": "closed",
      "user": "sipa",
      "created_at": "2026-01-22T22:12:00Z",
      "updated_at": "2026-01-23T15:16:45Z",
      "merged_at": "2026-01-23T15:10:59Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34384",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 541,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3123653803,
      "number": 34139,
      "title": "refactor: Add helper for Taproot control block size check",
      "body": "Add a helper for the Taproot control block size check to improve readability and reduce repetition. We currently have three instances of this check.\r\n\r\nBuild & unit tests succeed on my end.",
      "state": "closed",
      "user": "billymcbip",
      "created_at": "2025-12-22T17:24:36Z",
      "updated_at": "2026-01-23T14:51:24Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34139",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 247,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3172818667,
      "number": 34279,
      "title": "test: Fail on self-check warnings in test_runner.py",
      "body": "I don't see a reason to start running the tests, if the test_runner detects warnings during the self-check.\r\n\r\nUsually, this will just lead to a possibly confusing test failure after some wasted time anyway.\r\n\r\nSo just fail fast before even running any tests.\r\n\r\nIf there was a reason to ignore the warnings, a new option could trivially be added:\r\n\r\n```py\r\n    parser.add_argument(\"--ignore-self-check-warnings\", dest=\"ignore_warnings\", default=False, action=\"store_true\",\r\n                        help=\"Ignore test runner warnings about self-checks before running the tests\")\r\n```\r\n\r\nHowever, I don't see the need.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-14T09:50:09Z",
      "updated_at": "2026-01-23T14:07:20Z",
      "merged_at": "2026-01-14T16:28:18Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34279",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 668,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3199200577,
      "number": 34380,
      "title": "test: Fix P2PK script test",
      "body": "I found another script_tests case that isn't behaving the way it was meant to. It's a P2PK spend where we add an `OP_NOP8` to the scriptSig to make it non-push-only. The test should check that [`scriptSig.IsPushOnly()`](https://github.com/bitcoin/bitcoin/blob/691dc830c669061923a7eec677415013f75fd5d8/src/script/interpreter.cpp#L2055) is only enforced in P2SH mode when the scriptPubKey actually matches the P2SH pattern. To test this, we need to **turn on the P2SH flag**.",
      "state": "closed",
      "user": "billymcbip",
      "created_at": "2026-01-22T12:35:44Z",
      "updated_at": "2026-01-23T13:52:33Z",
      "merged_at": "2026-01-23T09:31:36Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34380",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 500,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3201168043,
      "number": 34385,
      "title": "subprocess: Fix `-Wunused-private-field` when building with clang-cl on Windows",
      "body": "This PR is a prerequisite for https://github.com/bitcoin/bitcoin/pull/31507.\r\n\r\nIt resolves `-Wunused-private-field` warnings triggered in `src/util/subprocess.h` when compiling with clang-cl on Windows:\r\n```\r\nD:\\a\\bitcoin\\bitcoin\\src\\util/subprocess.h(759,10): warning : private field 'parent_' is not used [-Wunused-private-field] [D:\\a\\bitcoin\\bitcoin\\build\\src\\util\\bitcoin_util.vcxproj]\r\nD:\\a\\bitcoin\\bitcoin\\src\\util/subprocess.h(760,7): warning : private field 'err_wr_pipe_' is not used [-Wunused-private-field] [D:\\a\\bitcoin\\bitcoin\\build\\src\\util\\bitcoin_util.vcxproj]\r\nD:\\a\\bitcoin\\bitcoin\\src\\util/subprocess.h(1038,7): warning : private field 'child_pid_' is not used [-Wunused-private-field] [D:\\a\\bitcoin\\bitcoin\\build\\src\\util\\bitcoin_util.vcxproj]\r\n```\r\n\r\nOnly the second commit has been [submitted](https://github.com/arun11299/cpp-subprocess/pull/127) upstream. The first commit is specific to this repository and not applicable upstream.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2026-01-22T22:26:40Z",
      "updated_at": "2026-01-23T13:42:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34385",
      "labels": [
        "Refactoring",
        "Windows"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1037,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2999849822,
      "number": 33856,
      "title": "kernel, validation: Refactor ProcessNewBlockHeaders to return BlockValidationState",
      "body": "## Motivation\r\n\r\nThis PR refactors `ProcessNewBlockHeaders()` to return `BlockValidationState` by value instead of using out-parameters or boolean returns. This follows the pattern established in #31981 (commit 74690f4) which refactored `TestBlockValidity()` in a similar manner.\r\n\r\n### Current Issues\r\n **ProcessNewBlockHeaders()**: Uses an out-parameter `BlockValidationState& state`, making the API less intuitive.\r\n\r\nAs noted by @theCharlatan in #33822 [comment](https://github.com/bitcoin/bitcoin/pull/33822#discussion_r2508065115) and can be a fix for that too:\r\n> One thing that could be considered here is returning the BlockValidationState directly instead of having an in/out param. To safely do that I think we'd need to refactor ProcessNewBlockHeaders though, similarly to what was done in 74690f4.\r\n\r\nThe changes are split into two commits, see individual commit message for more info.",
      "state": "open",
      "user": "yuvicc",
      "created_at": "2025-11-11T17:23:59Z",
      "updated_at": "2026-01-23T13:42:04Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33856",
      "labels": [
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 981,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3160483005,
      "number": 34242,
      "title": "Prepare string and net utils for future HTTP operations",
      "body": "This is a component of [removing libevent as a dependency of the project](https://github.com/bitcoin/bitcoin/issues/31194). It is the first six commits of #32061 and provides a string-parsing utility (`LineReader`) that is also consumed by #34158.\r\n\r\nThese are the functions that are added / updated for HTTP and Torcontrol:\r\n\r\n- `GetBindAddress()`: Given a socket, provides the bound address as a CService. Currently used by p2p but moved from `net` to `netbase` so other modules can call it.\r\n- `ToIntegral()`: Already used to parse numbers from strings, added new argument `base = 10` so it can also be used to parse hexadecimal integers. HTTP chunked transfer-encoding uses hex-encoded integers to specify payload size: https://datatracker.ietf.org/doc/html/rfc7230.html#section-4.1\r\n- `AsciiCaseInsensitive` comparators: Needed to store HTTP headers in an `unordered_map`. Headers are key-value pairs that are parsed with case-insensitive keys: https://httpwg.org/specs/rfc9110.html#rfc.section.5.1\r\n- `FormatRFC1123DateTime()`: The required datetime format for HTTP headers (e.g. `Fri, 31 May 2024 19:18:04 GMT`)\r\n- `LineReader`: Fields in HTTP requests are newline-terminated. This struct is given an input buffer and provides methods to read lines as strings.\r\n",
      "state": "closed",
      "user": "pinheadmz",
      "created_at": "2026-01-09T18:11:27Z",
      "updated_at": "2026-01-23T12:26:51Z",
      "merged_at": "2026-01-23T12:25:50Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34242",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1325,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3176622068,
      "number": 34300,
      "title": "test: use ephemeral ports in p2p_private_broadcast.py",
      "body": "The test `p2p_private_broadcast.py` gets some Python P2P nodes to listen and instructs the SOCKS5 proxy to redirect connections to them instead of to the requested addresses. This way the `bitcoind` which uses the proxy is tricked to think it has connected to real routable internet IP addresses or `.onion` addresses.\r\n\r\nPicking the ports where to Python P2P nodes to listen however is tricky to be done in a non-conflicting way, given that other tests may run in parallel. https://github.com/bitcoin/bitcoin/pull/34186 made it possible to let the OS select a free port, so use that in\r\n`p2p_private_broadcast.py`.\r\n\r\n---\r\n\r\n_Suggested in https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2654849875_",
      "state": "closed",
      "user": "vasild",
      "created_at": "2026-01-15T09:33:16Z",
      "updated_at": "2026-01-23T11:47:17Z",
      "merged_at": "2026-01-15T14:29:20Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34300",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 763,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3193524455,
      "number": 34357,
      "title": "rpc: Handle nullptr from createNewBlock in getblocktemplate",
      "body": "Fixes #34262\r\n\r\ngetblocktemplate currently asserts when miner.createNewBlock() returns nullptr. This can happen during shutdown or when the mining subsystem is unavailable.\r\n\r\nReplace the assertion with proper error handling that returns RPC_CLIENT_NOT_CONNECTED instead, indicating the service is temporarily unavailable.",
      "state": "closed",
      "user": "DevPatel-11",
      "created_at": "2026-01-21T02:26:28Z",
      "updated_at": "2026-01-23T11:36:30Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34357",
      "labels": [
        "RPC/REST/ZMQ",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 382,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1426141820,
      "number": 28055,
      "title": "Bugfix: net_processing: Restore \"Already requested\" error for FetchBlock",
      "body": "Regression introduced by #27626\r\n\r\nAdds new tests",
      "state": "closed",
      "user": "luke-jr",
      "created_at": "2023-07-09T01:26:25Z",
      "updated_at": "2026-01-23T11:00:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28055",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 122,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1234131225,
      "number": 27064,
      "title": "system: use %LOCALAPPDATA% as default datadir on windows",
      "body": "Closes https://github.com/bitcoin/bitcoin/issues/2391\r\n\r\nThis PR changes the default datadir location on Windows from `C:\\Users\\Username\\AppData\\Roaming\\Bitcoin` to `C:\\Users\\Username\\AppData\\Local\\Bitcoin`. This change only applies to fresh installs. To preserve backwards compatibility, on startup we check for the existence of `C:\\Users\\Username\\AppData\\Roaming\\Bitcoin\\chainstate` and if it is there, we continue using the \"Roaming\" directory as the default datadir location.\r\n\r\n[Note that in Windows 11 this change may be moot:](https://learn.microsoft.com/en-us/uwp/api/windows.storage.applicationdata.roamingfolder?view=winrt-22621)\r\n\r\n> Roaming data and settings is no longer supported as of Windows 11. The recommended replacement is [Azure App Service](https://learn.microsoft.com/en-us/azure/app-service/). Azure App Service is widely supported, well documented, reliable, and supports cross-platform/cross-ecosystem scenarios such as iOS, Android and web. Settings stored here no longer roam (as of Windows 11), but the settings store is still available.\r\n",
      "state": "closed",
      "user": "pinheadmz",
      "created_at": "2023-02-08T20:44:10Z",
      "updated_at": "2026-01-23T11:00:36Z",
      "merged_at": "2024-05-23T16:12:11Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/27064",
      "labels": [
        "Windows"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1125,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1461742289,
      "number": 28212,
      "title": "test: verify spend from 999-of-999 taproot multisig wallet",
      "body": "Verify that a 999-of-999 taproot multisig wallet is possible and can spend from it, and that neither a 1-of-0 nor 1-of-1000 is allowed.\r\n\r\nThe tests will require some time to run. On my Mac M1 the new tests run in about 40 seconds.\r\n\r\nHad to bump fee rate to resolve assertions in sendtoaddress and psbt methods:\r\n- code -5: assert rpc_online.gettransaction(txid)[\"confirmations\"] > 0\r\n- code -26: min relay fee not met\r\n\r\nFixes #28179 ",
      "state": "closed",
      "user": "eriknylund",
      "created_at": "2023-08-03T16:26:06Z",
      "updated_at": "2026-01-23T11:00:35Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28212",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 495,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2201636208,
      "number": 31376,
      "title": "Miner: never create a template which exploits the timewarp bug",
      "body": "This check was introduced in #30681 but only enabled for testnet4. To avoid potentially creating an invalid block template if a soft fork to fix the timewarp attack were to activate in the future, we should have this check on all networks. It also seems wise for our miner to not support it whether or not a soft fork activates to fix it at the consensus level.",
      "state": "closed",
      "user": "darosior",
      "created_at": "2024-11-26T18:05:01Z",
      "updated_at": "2026-01-23T11:00:34Z",
      "merged_at": "2025-01-23T10:54:53Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31376",
      "labels": [
        "Mining",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 1,
        "text_length": 424,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1563555910,
      "number": 28678,
      "title": "miniscript: convert non-critical asserts to Assumes",
      "body": "It's better practice to use `Assume` for non-critical assumptions made in the code. This is especially relevant for P2P-exposed functionality, which I don't believe is the case for miniscript, but still, use `Assume`s except in places where a crash or UB will be inevitable on a failed `assert` anyway.",
      "state": "closed",
      "user": "sipa",
      "created_at": "2023-10-18T22:00:52Z",
      "updated_at": "2026-01-23T11:00:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28678",
      "labels": [
        "Descriptors",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 354,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2235863965,
      "number": 31504,
      "title": "cmake: De-duplicate libraries on link lines opportunistically",
      "body": "This PR resolves \"ignoring duplicate libraries\" linker warnings on [macOS](https://github.com/bitcoin/bitcoin/actions/runs/12324827707/job/34403065736):\r\n```\r\n[892/895] Linking CXX executable src/test/test_bitcoin\r\nld: warning: ignoring duplicate libraries: 'src/secp256k1/lib/libsecp256k1.a'\r\n<snip>\r\n[894/895] Linking CXX executable src/test/fuzz/fuzz\r\nld: warning: ignoring duplicate libraries: 'libleveldb.a', 'libminisketch.a', 'src/libbitcoin_common.a', 'src/secp256k1/lib/libsecp256k1.a', 'src/univalue/libunivalue.a', 'src/util/libbitcoin_util.a'\r\n```",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2024-12-15T15:59:52Z",
      "updated_at": "2026-01-23T11:00:33Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31504",
      "labels": [
        "Build system",
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 621,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2214827076,
      "number": 31416,
      "title": "doc: Fix incorrect send RPC docs",
      "body": "It would be good to have accurate RPC docs, so that humans and machines can read them and rely on them.\r\n\r\nThis fixes one issue.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2024-12-04T10:32:37Z",
      "updated_at": "2026-01-23T11:00:33Z",
      "merged_at": "2025-01-23T17:42:59Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31416",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 161,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2244952060,
      "number": 31541,
      "title": "qa: Use `sys.executable` when invoking other Python scripts",
      "body": "This PR fixes the `rpc_signer.py` and `wallet_signer.py` functional tests on systems where `python3` is not available in the `PATH`, causing the shebang `#!/usr/bin/env python3` to fail.\r\n\r\nHere are logs on NetBSD 10.0:\r\n- without this PR:\r\n```\r\n$ python3.12 ./build/test/functional/test_runner.py rpc_signer.py wallet_signer.py\r\nTemporary test directory at /tmp/test_runner_₿_🏃_20241219_160538\r\nRemaining jobs: [rpc_signer.py, wallet_signer.py --descriptors]\r\n1/2 - rpc_signer.py failed, Duration: 1 s\r\n\r\nstdout:\r\n2024-12-19T16:05:40.012000Z TestFramework (INFO): PRNG seed is: 1833166631173850775\r\n2024-12-19T16:05:40.012000Z TestFramework (INFO): Initializing test directory /tmp/test_runner_₿_🏃_20241219_160538/rpc_signer_1\r\n2024-12-19T16:05:40.754000Z TestFramework (ERROR): Assertion failed\r\nTraceback (most recent call last):\r\n  File \"/home/hebasto/dev/bitcoin/test/functional/test_framework/util.py\", line 160, in try_rpc\r\n    fun(*args, **kwds)\r\n  File \"/home/hebasto/dev/bitcoin/test/functional/test_framework/coverage.py\", line 50, in __call__\r\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/hebasto/dev/bitcoin/test/functional/test_framework/authproxy.py\", line 146, in __call__\r\n    raise JSONRPCException(response['error'], status)\r\ntest_framework.authproxy.JSONRPCException: RunCommandParseJSON error: process(/home/hebasto/dev/bitcoin/test/functional/mocks/signer.py enumerate) returned 127: env: python3: No such file or directory\r\n (-1)\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/hebasto/dev/bitcoin/test/functional/test_framework/test_framework.py\", line 135, in main\r\n    self.run_test()\r\n  File \"/home/hebasto/dev/bitcoin/build/test/functional/rpc_signer.py\", line 72, in run_test\r\n    assert_raises_rpc_error(-1, 'fingerprint not found',\r\n  File \"/home/hebasto/dev/bitcoin/test/functional/test_framework/util.py\", line 151, in assert_raises_rpc_error\r\n    assert try_rpc(code, message, fun, *args, **kwds), \"No exception raised\"\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/hebasto/dev/bitcoin/test/functional/test_framework/util.py\", line 166, in try_rpc\r\n    raise AssertionError(\r\nAssertionError: Expected substring not found in error message:\r\nsubstring: 'fingerprint not found'\r\nerror message: 'RunCommandParseJSON error: process(/home/hebasto/dev/bitcoin/test/functional/mocks/signer.py enumerate) returned 127: env: python3: No such file or directory\r\n'.\r\n2024-12-19T16:05:40.756000Z TestFramework (INFO): Stopping nodes\r\n2024-12-19T16:05:40.873000Z TestFramework (WARNING): Not cleaning up dir /tmp/test_runner_₿_🏃_20241219_160538/rpc_signer_1\r\n2024-12-19T16:05:40.873000Z TestFramework (ERROR): Test failed. Test logging available at /tmp/test_runner_₿_🏃_20241219_160538/rpc_signer_1/test_framework.log\r\n2024-12-19T16:05:40.873000Z TestFramework (ERROR): \r\n2024-12-19T16:05:40.873000Z TestFramework (ERROR): Hint: Call /home/hebasto/dev/bitcoin/test/functional/combine_logs.py '/tmp/test_runner_₿_🏃_20241219_160538/rpc_signer_1' to consolidate all logs\r\n2024-12-19T16:05:40.873000Z TestFramework (ERROR): \r\n2024-12-19T16:05:40.873000Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\r\n2024-12-19T16:05:40.873000Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\r\n2024-12-19T16:05:40.873000Z TestFramework (ERROR): \r\n\r\n\r\nstderr:\r\n\r\n\r\nRemaining jobs: [wallet_signer.py --descriptors]\r\n2/2 - wallet_signer.py --descriptors failed, Duration: 1 s\r\n\r\nstdout:\r\n2024-12-19T16:05:40.014000Z TestFramework (INFO): PRNG seed is: 7530764367977090686\r\n2024-12-19T16:05:40.014000Z TestFramework (INFO): Initializing test directory /tmp/test_runner_₿_🏃_20241219_160538/wallet_signer_0\r\n2024-12-19T16:05:40.526000Z TestFramework (ERROR): JSONRPC error\r\nTraceback (most recent call last):\r\n  File \"/home/hebasto/dev/bitcoin/test/functional/test_framework/test_framework.py\", line 135, in main\r\n    self.run_test()\r\n  File \"/home/hebasto/dev/bitcoin/build/test/functional/wallet_signer.py\", line 66, in run_test\r\n    self.test_valid_signer()\r\n  File \"/home/hebasto/dev/bitcoin/build/test/functional/wallet_signer.py\", line 83, in test_valid_signer\r\n    self.nodes[1].createwallet(wallet_name='hww', disable_private_keys=True, descriptors=True, external_signer=True)\r\n  File \"/home/hebasto/dev/bitcoin/test/functional/test_framework/test_node.py\", line 935, in createwallet\r\n    return self.__getattr__('createwallet')(wallet_name, disable_private_keys, blank, passphrase, avoid_reuse, descriptors, load_on_startup, external_signer)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/hebasto/dev/bitcoin/test/functional/test_framework/coverage.py\", line 50, in __call__\r\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/hebasto/dev/bitcoin/test/functional/test_framework/authproxy.py\", line 146, in __call__\r\n    raise JSONRPCException(response['error'], status)\r\ntest_framework.authproxy.JSONRPCException: RunCommandParseJSON error: process(/home/hebasto/dev/bitcoin/test/functional/mocks/signer.py enumerate) returned 127: env: python3: No such file or directory\r\n (-1)\r\n2024-12-19T16:05:40.528000Z TestFramework (INFO): Stopping nodes\r\n2024-12-19T16:05:40.645000Z TestFramework (WARNING): Not cleaning up dir /tmp/test_runner_₿_🏃_20241219_160538/wallet_signer_0\r\n2024-12-19T16:05:40.646000Z TestFramework (ERROR): Test failed. Test logging available at /tmp/test_runner_₿_🏃_20241219_160538/wallet_signer_0/test_framework.log\r\n2024-12-19T16:05:40.646000Z TestFramework (ERROR): \r\n2024-12-19T16:05:40.646000Z TestFramework (ERROR): Hint: Call /home/hebasto/dev/bitcoin/test/functional/combine_logs.py '/tmp/test_runner_₿_🏃_20241219_160538/wallet_signer_0' to consolidate all logs\r\n2024-12-19T16:05:40.646000Z TestFramework (ERROR): \r\n2024-12-19T16:05:40.646000Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\r\n2024-12-19T16:05:40.646000Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\r\n2024-12-19T16:05:40.646000Z TestFramework (ERROR): \r\n\r\n\r\nstderr:\r\n\r\n\r\n\r\nTEST                           | STATUS    | DURATION\r\n\r\nrpc_signer.py                  | ✖ Failed  | 1 s\r\nwallet_signer.py --descriptors | ✖ Failed  | 1 s\r\n\r\nALL                            | ✖ Failed  | 2 s (accumulated) \r\nRuntime: 1 s\r\n\r\n```\r\n- with this PR:\r\n```\r\n$ python3.12 ./build/test/functional/test_runner.py rpc_signer.py wallet_signer.py   \r\nTemporary test directory at /tmp/test_runner_₿_🏃_20241219_160011\r\nRemaining jobs: [rpc_signer.py, wallet_signer.py --descriptors]\r\n1/2 - rpc_signer.py passed, Duration: 2 s\r\nRemaining jobs: [wallet_signer.py --descriptors]\r\n2/2 - wallet_signer.py --descriptors passed, Duration: 3 s\r\n\r\nTEST                           | STATUS    | DURATION\r\n\r\nrpc_signer.py                  | ✓ Passed  | 2 s\r\nwallet_signer.py --descriptors | ✓ Passed  | 3 s\r\n\r\nALL                            | ✓ Passed  | 5 s (accumulated) \r\nRuntime: 3 s\r\n\r\n```",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2024-12-19T16:06:25Z",
      "updated_at": "2026-01-23T11:00:32Z",
      "merged_at": "2025-01-23T11:18:27Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31541",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 7517,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2264369736,
      "number": 31619,
      "title": "ci: change the build to be verbose by default",
      "body": "Previously CI would use a non-verbose build (where exact compilation and linking commands are not visible) and only if it fails, would rerun the build in verbose mode.\r\n\r\nChange this to use verbose in the initial build as well for two reasons:\r\n1. It is useful to be able to see the exact compilation and linking commands even for successful builds, to e.g. confirm some particular flags are (not) used as expected.\r\n2. In failed builds, if the failure is during linking, the repeated verbose build may not show a single compilation command because all files are already compiled, so compilation flags will remain hidden.\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "closed",
      "user": "vasild",
      "created_at": "2025-01-07T17:24:12Z",
      "updated_at": "2026-01-23T11:00:31Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31619",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 2733,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2262207940,
      "number": 31613,
      "title": "depends, NetBSD: Fix `bdb` package compilation with GCC-14",
      "body": "On NetBSD 10, compilation of the `bdb` package with GCC-14 fails with the following error:\r\n```\r\n$ gmake -C depends bdb CC=/usr/pkg/gcc14/bin/gcc\r\n<snip>\r\n./libtool --mode=compile /usr/pkg/gcc14/bin/gcc -c -I. -I../dist/./..   -I/home/hebasto/dev/bitcoin/depends/x86_64-unknown-netbsd10.0/include -D_XOPEN_SOURCE=600  -pipe -std=c11 -O2 -Wno-error=implicit-function-declaration -Wno-error=format-security -Wno-error=implicit-int  ../dist/./../env/env_config.c\r\nlibtool: compile:  /usr/pkg/gcc14/bin/gcc -c -I. -I../dist/./.. -I/home/hebasto/dev/bitcoin/depends/x86_64-unknown-netbsd10.0/include -D_XOPEN_SOURCE=600 -pipe -std=c11 -O2 -Wno-error=implicit-function-declaration -Wno-error=format-security -Wno-error=implicit-int ../dist/./../env/env_config.c  -fPIC -DPIC -o env_config.o\r\n../dist/./../env/env_config.c: In function '__config_parse':\r\n../dist/./../env/env_config.c:98:13: warning: implicit declaration of function 'strcasecmp'; did you mean 'strncmp'? [-Wimplicit-function-declaration]\r\n   98 |         if (strcasecmp(s, argv[0]) == 0) {                              \\\r\n      |             ^~~~~~~~~~\r\n../dist/./../env/env_config.c:135:9: note: in expansion of macro 'CONFIG_UINT32'\r\n  135 |         CONFIG_UINT32(\"mutex_set_align\", __mutex_set_align);\r\n      |         ^~~~~~~~~~~~~\r\n../dist/./../env/env_config.c: In function '__config_split':\r\n../dist/./../env/env_config.c:537:43: warning: implicit declaration of function 'strsep'; did you mean 'strdup'? [-Wimplicit-function-declaration]\r\n  537 |         for (count = 0, ap = argv; (*ap = strsep(&input, \" \\t\\n\")) != NULL;)\r\n      |                                           ^~~~~~\r\n      |                                           strdup\r\n../dist/./../env/env_config.c:537:41: error: assignment to 'char *' from 'int' makes pointer from integer without a cast [-Wint-conversion]\r\n  537 |         for (count = 0, ap = argv; (*ap = strsep(&input, \" \\t\\n\")) != NULL;)\r\n      |                                         ^\r\ngmake[1]: *** [Makefile:1664: env_config.o] Error 1\r\ngmake[1]: Leaving directory '/home/hebasto/dev/bitcoin/depends/work/build/x86_64-unknown-netbsd10.0/bdb/4.8.30-cac45822ba8/build_unix'\r\ngmake: *** [funcs.mk:302: /home/hebasto/dev/bitcoin/depends/work/build/x86_64-unknown-netbsd10.0/bdb/4.8.30-cac45822ba8/build_unix/.stamp_built] Error 2\r\ngmake: Leaving directory '/home/hebasto/dev/bitcoin/depends'\r\n```\r\n\r\nThis PR resolves the compilation issue.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-01-06T15:55:15Z",
      "updated_at": "2026-01-23T11:00:31Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31613",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2498,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2270577210,
      "number": 31635,
      "title": "test: add coverage for unknown address type for `createwalletdescriptor`",
      "body": "Calling `createwalletdescriptor` RPC with an unknown address type throws an error. This PR adds test coverage for it as done for other RPCs (`getnewaddress `, `getrawchangeaddress`, etc).",
      "state": "closed",
      "user": "brunoerg",
      "created_at": "2025-01-10T14:09:37Z",
      "updated_at": "2026-01-23T11:00:30Z",
      "merged_at": "2025-01-23T12:50:44Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31635",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 260,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2290079126,
      "number": 31699,
      "title": "test,bench: validate `CheckTransaction`'s duplicate input detection in broader context",
      "body": "This PR follows up on [#31682](https://github.com/bitcoin/bitcoin/pull/31682), isolating its testing and benchmarking improvements to focus on `CheckTransaction`'s duplicate input detection and performance in realistic contexts, avoiding the controversial consensus code change.\r\n\r\nFirst commit adds tests to validate `CheckTransaction`'s ordering-based duplicate detection against the hash-based methods used elsewhere in the codebase.\r\n\r\nSecond commit replaces overly-specific microbenchmarks with `ProcessTransactionBench`, which implicitly measures `CheckTransaction` as part of the full validation pipeline.",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2025-01-21T14:03:36Z",
      "updated_at": "2026-01-23T11:00:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31699",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 699,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2289640936,
      "number": 31696,
      "title": "test: Check that reindex with prune wipes blk files",
      "body": "This adds missing test coverage for `CleanupBlockRevFiles`.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-01-21T10:58:33Z",
      "updated_at": "2026-01-23T11:00:29Z",
      "merged_at": "2025-01-23T12:43:01Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31696",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 111,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2290159806,
      "number": 31701,
      "title": "test: Bump sync_mempools timeout in p2p_1p1c_network.py",
      "body": "This should address the two issues that happened in https://github.com/bitcoin/bitcoin/actions/runs/12885576442/job/35924329657?pr=25832#step:6:7601:\r\n\r\n* The combined log isn't printed on a test failure.\r\n* The timeout is too strict for the GHA virtual machines.\r\n\r\nFor reference, the output was:\r\n\r\n```\r\n...\r\n149/315 - rpc_blockchain.py --v2transport passed, Duration: 10 s\r\n150/315 - p2p_addrfetch.py passed, Duration: 1 s\r\n151/315 - p2p_1p1c_network.py failed, Duration: 31 s\r\n\r\nstdout:\r\n2025-01-21T12:05:49.465000Z TestFramework (INFO): PRNG seed is: 6581340712385622842\r\n2025-01-21T12:05:49.466000Z TestFramework (INFO): Initializing test directory /tmp/test_runner_₿_🏃_20250121_120233/p2p_1p1c_network_207\r\n2025-01-21T12:05:52.408000Z TestFramework (INFO): Fill mempools with large transactions to raise mempool minimum feerates\r\n2025-01-21T12:05:52.408000Z TestFramework (INFO): Fill the mempool until eviction is triggered and the mempoolminfee rises\r\n2025-01-21T12:05:59.692000Z TestFramework (INFO): Pre-send some transactions to nodes\r\n2025-01-21T12:06:00.203000Z TestFramework (INFO): Submit full packages to node0\r\n2025-01-21T12:06:00.220000Z TestFramework (INFO): Wait for mempools to sync\r\n2025-01-21T12:06:20.384000Z TestFramework (ERROR): Assertion failed\r\nTraceback (most recent call last):\r\n  File \"/home/runner/work/bitcoin/bitcoin/test/functional/test_framework/test_framework.py\", line 135, in main\r\n    self.run_test()\r\n  File \"/home/runner/work/bitcoin/bitcoin/build/test/functional/p2p_1p1c_network.py\", line 153, in run_test\r\n    self.sync_mempools(timeout=20)\r\n  File \"/home/runner/work/bitcoin/bitcoin/test/functional/test_framework/test_framework.py\", line 803, in sync_mempools\r\n    raise AssertionError(\"Mempool sync timed out after {}s:{}\".format(\r\nAssertionError: Mempool sync timed out after 20s:\r\n...",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-01-21T14:38:49Z",
      "updated_at": "2026-01-23T11:00:28Z",
      "merged_at": "2025-01-21T16:49:51Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31701",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1892,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2290731477,
      "number": 31704,
      "title": "doc: add a section in the fuzzing documentation about using MSan",
      "body": "Just a couple lines in a subsection of the sanitizers section mentioning that using the memory sanitizer is a bit more involve than other sanitizers, describing the steps and pointing to an example.",
      "state": "closed",
      "user": "darosior",
      "created_at": "2025-01-21T19:53:31Z",
      "updated_at": "2026-01-23T11:00:27Z",
      "merged_at": "2025-01-23T14:25:35Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31704",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 263,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2292768782,
      "number": 31709,
      "title": "cmake: Fail if `Libmultiprocess` is missing when `WITH_MULTIPROCESS=ON`",
      "body": "Fixes https://github.com/bitcoin/bitcoin/issues/31708:\r\n```\r\n$ cmake -B build -DWITH_MULTIPROCESS=ON\r\n-- The CXX compiler identification is GNU 13.3.0\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Check for working CXX compiler: /usr/bin/c++ - skipped\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\n-- Found SQLite3: /usr/include (found suitable version \"3.45.1\", minimum required is \"3.7.17\") \r\nCMake Error at CMakeLists.txt:146 (find_package):\r\n  By not providing \"FindLibmultiprocess.cmake\" in CMAKE_MODULE_PATH this\r\n  project has asked CMake to find a package configuration file provided by\r\n  \"Libmultiprocess\", but CMake did not find one.\r\n\r\n  Could not find a package configuration file provided by \"Libmultiprocess\"\r\n  with any of the following names:\r\n\r\n    LibmultiprocessConfig.cmake\r\n    libmultiprocess-config.cmake\r\n\r\n  Add the installation prefix of \"Libmultiprocess\" to CMAKE_PREFIX_PATH or\r\n  set \"Libmultiprocess_DIR\" to a directory containing one of the above files.\r\n  If \"Libmultiprocess\" provides a separate development package or SDK, be\r\n  sure it has been installed.\r\n\r\n\r\n-- Configuring incomplete, errors occurred!\r\n```",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-01-22T17:35:32Z",
      "updated_at": "2026-01-23T11:00:26Z",
      "merged_at": "2025-01-23T09:46:49Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31709",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1286,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2293170934,
      "number": 31717,
      "title": "docs: fix  README.md",
      "body": "Hello\r\nI noticed a spelling issue.\r\nBest regards!\r\n",
      "state": "closed",
      "user": "nnsW3",
      "created_at": "2025-01-22T21:52:12Z",
      "updated_at": "2026-01-23T11:00:25Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31717",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 72,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3181018875,
      "number": 34317,
      "title": "fuzz: Exclude too expensive inputs in descriptor_parse targets",
      "body": "Accepting \"expensive\" fuzz inputs which have no real use-case is problematic, because it prevents the fuzz engine from spending time on the next useful fuzz input.\r\n\r\nFor example, those will take several seconds (!) and the flamegraph shows that base58 encoding is the cause:\r\n\r\n```\r\ncurl -fLO 'https://github.com/bitcoin-core/qa-assets/raw/b5ad78e070e4cf36beb415d7b490d948d70ba73f/fuzz_corpora/mocked_descriptor_parse/f5abf41608addcef3538da61d8096c2050235032'\r\ncurl -fLO 'https://github.com/bitcoin-core/qa-assets/raw/b5ad78e070e4cf36beb415d7b490d948d70ba73f/fuzz_corpora/descriptor_parse/78cb3175467f53b467b949883ee6072e92dbb267'\r\n\r\nFUZZ=mocked_descriptor_parse ./bld-cmake/bin/fuzz ./f5abf41608addcef3538da61d8096c2050235032\r\nFUZZ=descriptor_parse ./bld-cmake/bin/fuzz ./78cb3175467f53b467b949883ee6072e92dbb267\r\n```\r\n\r\nThis will also break 32-bit fuzzing, see https://github.com/bitcoin/bitcoin/issues/34110#issuecomment-3759461248.\r\n\r\nFix all issues by checking for `HasTooLargeLeafSize`.\r\n\r\nSorry for creating several pull requests to fix this class of issue, but I think this one should be the last one. :sweat_smile: ",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-16T12:00:14Z",
      "updated_at": "2026-01-23T10:29:39Z",
      "merged_at": "2026-01-23T09:54:28Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34317",
      "labels": [
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1188,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3201791565,
      "number": 34386,
      "title": "wallet: Fix Taproot descriptor weight calculation",
      "body": "### Problem\r\nThe `MaxSatisfactionWeight` method for Taproot descriptors was incorrectly assuming only keypath spends, leading to significant underestimations of transaction weight. This could cause fee estimation failures for Taproot descriptors with script paths that are more expensive than the key path.\r\n\r\n### Solution\r\n- **Fixed weight calculation**: Updated `MaxSatisfactionWeight` to properly calculate the maximum weight across all Taproot script leaves, not just the key path\r\n\r\n### Changes\r\n- `src/script/descriptor.cpp`: Implemented proper weight calculation that iterates through all descriptor leaves to find the maximum satisfaction weight\r\n- `src/test/descriptor_tests.cpp`: Added comprehensive test case `descriptor_tr_max_satisfaction_weight` covering various Taproot scenarios\r\n- `test/functional/wallet_taproot.py`: Updated tests to handle higher fee rates for complex script paths and improved assertions\r\n\r\n### Testing\r\n- Added unit tests verifying correct weight calculation for Taproot descriptors with script paths heavier than key paths\r\n- Updated functional tests to use appropriate fee rates for edge cases involving large Taproot scripts\r\n- All existing tests continue to pass\r\n\r\nThis fix ensures wallets can properly estimate fees for all Taproot spending scenarios, preventing transaction failures due to underestimated fees.",
      "state": "closed",
      "user": "tboy1337",
      "created_at": "2026-01-23T04:04:36Z",
      "updated_at": "2026-01-23T10:05:56Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34386",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1405,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2513877394,
      "number": 32471,
      "title": "wallet/rpc: fix listdescriptors RPC fails to return descriptors with private key information when wallet contains descriptors missing any key",
      "body": "_TLDR:\r\nCurrently, `listdescriptors [private=true]` will fail for a non-watch-only wallet if any descriptor has a missing private key(e.g `tr()`, `multi()`, etc.). This PR changes that while making sure `listdescriptors [private=true]` still fails if there no private keys. Closes #32078_ \r\n\r\nIn non-watch-only wallets, it's possible to import descriptors as long as at least one private key is included. It's important that users can still view these descriptors when they need to create a backup—even if some private keys are missing ([#32078 (comment)](https://github.com/bitcoin/bitcoin/issues/32078#issuecomment-2781428475)). This change makes it possible to do so.\r\n\r\nThis change also helps prevent `listdescriptors true` from failing completely, because one descriptor is missing some private keys.\r\n\r\n### Notes\r\n- The new behaviour is applied to all descriptors including miniscript descriptors\r\n- `listdescriptors true` still fails for watch-only wallets to preserve existing behaviour https://github.com/bitcoin/bitcoin/pull/24361#discussion_r920801352\r\n- Wallet migration logic previously used `Descriptor::ToPrivateString()` to determine which descriptor was watchonly. This means that modifying the `ToPrivateString()` behaviour caused descriptors that were previously recognized as \"watchonly\" to be \"non-watchonly\". **In order to keep the scope of this PR limited to the RPC behaviour, this PR uses a different method to determine `watchonly` descriptors for the purpose of wallet migration.** A follow-up PR can be opened to update migration logic to exclude descriptors with some private keys from the `watchonly` migration wallet. \r\n\r\n### Relevant PRs\r\nhttps://github.com/bitcoin/bitcoin/pull/24361\r\nhttps://github.com/bitcoin/bitcoin/pull/32186\r\n\r\n### Testing\r\nFunctional tests were added to test the new behaviour\r\n\r\nEDIT\r\n**`listdescriptors [private=true]` will still fail when there are no private keys because non-watchonly wallets must have private keys and calling `listdescriptors [private=true]` for watchonly wallet returns an error**",
      "state": "closed",
      "user": "Eunovo",
      "created_at": "2025-05-12T13:26:20Z",
      "updated_at": "2026-01-23T07:48:59Z",
      "merged_at": "2026-01-20T20:17:42Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32471",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2204,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2275111412,
      "number": 31650,
      "title": "refactor: Avoid copies by using const references or by move-construction",
      "body": "Top level `const` in declarations is problematic for many reasons:\r\n\r\n* It is often a typo, where one wanted to denote a const reference. For example `bool PSBTInputSignedAndVerified(const PartiallySignedTransaction psbt, ...` is missing the `&`. This will create a redundant copy of the value.\r\n* In constructors it prevents move construction.\r\n* It can incorrectly imply some data is const, like in an imaginary example `std::span<int> Shuffle(const std::span<int>);`, where the `int`s are *not* const.\r\n* The compiler ignores the `const` from the declaration in the implementation.\r\n* It isn't used consistently anyway, not even on the same line.\r\n\r\nFix some issues by:\r\n\r\n* Using a const reference to avoid a copy, where read-only of the value is intended. This is only done for values that may be expensive to copy.\r\n* Using move-construction to avoid a copy\r\n* Applying `readability-avoid-const-params-in-decls` via clang-tidy",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-01-13T20:41:34Z",
      "updated_at": "2026-01-23T07:48:12Z",
      "merged_at": "2026-01-19T11:04:40Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31650",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1005,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3173584131,
      "number": 34284,
      "title": "ipc, test: Add tests for unclean disconnect and thread busy behavior",
      "body": "Upcoming libmultiprocess changes are expected to alter this behavior (https://github.com/bitcoin/bitcoin/issues/34250#issuecomment-3749243782), making test coverage useful for documenting current behavior and validating the intended changes.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2026-01-14T13:46:24Z",
      "updated_at": "2026-01-23T04:19:58Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34284",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 310,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3154286083,
      "number": 34225,
      "title": "refactor, key: move `CreateMuSig2{Nonce,PartialSig}` functions to `musig.{h,cpp}` module",
      "body": "This PR is a follow-up of #29675, see https://github.com/bitcoin/bitcoin/pull/29675#discussion_r2265077463. It moves all MuSig2 functions that currently live in `CKey` and call secp256k1 musig module API functions (i.e. `secp256k1_musig_...`) to the `musig.{h,cpp}` module, as this seems to be a better place. One small drawback of doing this is that the `secp256k1_context_signing` object needs to be accessed from the outside; this is currently solved by changing the linkage from `static` to `extern` to expose the symbol globally [1]. Happy to add an access function if that is preferred instead. \r\n\r\nAs the patch is mostly move-only, it can be best reviewed via the git option `--color-moved=dimmed-zebra`\r\n\r\n[1] note that the same approach is used in the Silent Payments sending PR #28201, though having a TODO comment added, see https://github.com/bitcoin/bitcoin/pull/28201/commits/a4ebd7da5aaaa567fa9c613666513341f2aea241#diff-e5cbd40011e760f175b82d7ec44ad512bdb3d9108068b660642204da9c9187b1R25",
      "state": "open",
      "user": "theStack",
      "created_at": "2026-01-07T23:45:38Z",
      "updated_at": "2026-01-23T02:19:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34225",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1092,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3200991905,
      "number": 34382,
      "title": "test: wallet: Check fallbackfee default argument behavior.",
      "body": "In an unmerged branch of #32636 (https://github.com/bitcoin/bitcoin/commit/097e00f90765915b0f8353a4eb5ebb18ceae2a66) I unintentionally broke default `-fallbackfee` behavior, but this was not caught by any tests. See https://github.com/bitcoin/bitcoin/pull/32636#discussion_r2706178076.\r\n\r\nSomething like the following diff does not cause any test failures on master despite causing a behavior change:\r\n\r\n```diff\r\ndiff --git a/src/wallet/wallet.cpp b/src/wallet/wallet.cpp\r\nindex bc27018cd2..079610fba0 100644\r\n--- a/src/wallet/wallet.cpp\r\n+++ b/src/wallet/wallet.cpp\r\n@@ -3048,24 +3048,24 @@ std::shared_ptr<CWallet> CWallet::Create(WalletContext& context, const std::stri\r\n     if (const auto arg{args.GetArg(\"-fallbackfee\")}) {\r\n         std::optional<CAmount> fallback_fee = ParseMoney(*arg);\r\n         if (!fallback_fee) {\r\n             error = strprintf(_(\"Invalid amount for %s=<amount>: '%s'\"), \"-fallbackfee\", *arg);\r\n             return nullptr;\r\n         } else if (fallback_fee.value() > HIGH_TX_FEE_PER_KB) {\r\n             warnings.push_back(AmountHighWarn(\"-fallbackfee\") + Untranslated(\" \") +\r\n                                _(\"This is the transaction fee you may pay when fee estimates are not available.\"));\r\n         }\r\n         walletInstance->m_fallback_fee = CFeeRate{fallback_fee.value()};\r\n+        // Disable fallback fee in case value was set to 0, enable if non-null value\r\n+        walletInstance->m_allow_fallback_fee = walletInstance->m_fallback_fee.GetFeePerK() != 0;\r\n     }\r\n\r\n-    // Disable fallback fee in case value was set to 0, enable if non-null value\r\n-    walletInstance->m_allow_fallback_fee = walletInstance->m_fallback_fee.GetFeePerK() != 0;\r\n```\r\n\r\nThis PR adds a functional test check that when no `-fallbackfee` argument is set and fee estimation is not possible, that sending fails because `-fallbackfee` is disabled by default.",
      "state": "open",
      "user": "davidgumberg",
      "created_at": "2026-01-22T21:15:04Z",
      "updated_at": "2026-01-23T02:00:18Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34382",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1935,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2946400797,
      "number": 33701,
      "title": "test: add case where `TOTAL_TRIES` is exceeded yet solution remains",
      "body": "Show that `CoinGrider` halts searching when the number of attempts exceeds `TOTAL_TRIES`.  To do so, show that a solution is found, then add one more entry to the same set of inputs.  Since the search orders by `effective_value`, the solution is constructed such that only values with the lowest `effective_value` have the least weight.  Only the lowest weight values will not exceed the `max_selection_weight`. Therefore, `CoinGrinder` will not evaluate all lowest weight solutions together before exceeding `TOTAL_TRIES` since they are last found.\r\n\r\nThis test case was inspired by a similar test for `BnB` currently named `bnb_test`.",
      "state": "open",
      "user": "yancyribbens",
      "created_at": "2025-10-25T00:30:30Z",
      "updated_at": "2026-01-23T00:45:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33701",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 704,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3187784182,
      "number": 34341,
      "title": "wallet: only log `txid` when `-debug=wallet` is explicit",
      "body": "Extracted from: https://github.com/bitcoin/bitcoin/pull/34267#discussion_r2693741105\r\n\r\n### Problem\r\n\r\nAll wallet logging was written to `debug.log` by default, so it can leak sensitive wallet context (`txids` and full transaction strings) when shared.\r\nAlso, `WalletLogPrintf` is a leftover name from the removed `LogPrintf` API and does not reflect the current behavior (unconditional info-level logging).\r\n\r\n### Fix\r\n\r\nAfter a refactor commit to rename `WalletLogPrintf` to `WalletLogInfo` (`scripted-diff` only) to reflect that it logs unconditionally at info level, redact txids and full transaction strings from info-level wallet logs, and add a new `-debug=wallet` category for sensitive context (txid/full tx string) logged as indented follow-up lines via the new `WalletLogDebug()`.\r\n\r\n### Reproducer\r\n\r\nWe can easily exercises the common create wallet, mine, and send paths to demonstrate the info-level redaction vs `-debug=wallet` behavior.\r\nIt does not attempt to trigger rare error paths (e.g. database write failures, unexpected script types, conflicts/double-spends, broadcast failures, rescans/migrations), which would require additional setup and can be deduced from the code.\r\n\r\nBuild and run this once \"before\" and once \"after\", then compare grepped log output.\r\n\r\n```bash\r\ncmake -B build >/dev/null 2>&1 && cmake --build build --target bitcoind bitcoin-cli -j$(nproc) >/dev/null 2>&1\r\n\r\nDATA_DIR=$(mktemp -d)\r\n\r\n./build/bin/bitcoind -regtest -datadir=\"$DATA_DIR\" -daemon -connect=0 -fallbackfee=0.0002 >/dev/null 2>&1\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" -rpcwait getblockchaininfo >/dev/null\r\n\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" createwallet w0 >/dev/null\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" createwallet w1 >/dev/null\r\nADDR0=$(./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" -rpcwallet=w0 getnewaddress)\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" -rpcwallet=w0 generatetoaddress 101 \"$ADDR0\" >/dev/null\r\nADDR1=$(./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" -rpcwallet=w1 getnewaddress)\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" -rpcwallet=w0 sendtoaddress \"$ADDR1\" 1 >/dev/null\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" -rpcwallet=w1 -rpcwait getbalances >/dev/null\r\n\r\nrg -n \"CommitTransaction|AddToWallet|Submitting wtx|txid=|CTransaction\\\\(\" \"$DATA_DIR/regtest/debug.log\" || true\r\n\r\n./build/bin/bitcoin-cli -regtest -datadir=\"$DATA_DIR\" stop >/dev/null\r\n```\r\n\r\n<details>\r\n<summary>Before (info-level wallet logs include txids and transaction dump)</summary>\r\n\r\n```bash\r\n113:2026-01-19T12:51:04Z [w0] AddToWallet d9a81836a9a2e8158ca6aa49278b70305a07614df420d980abe2028366407731  new Confirmed (block=24fd805ca35464a95530674f8434c3af34111409e5e3477ae4ba4b46f085baac, height=1, index=0)\r\n...\r\n411:2026-01-19T12:51:05Z [w0] AddToWallet 3d72f6d5f6829a070b0d9766a672b158b6a1fd87bea0f6959ab0ec4b44ebb7ef  new Confirmed (block=2e937f886897ccd9345fc859ebedde9be981a831aa55786286dae69b21a36007, height=101, index=0)\r\n417:2026-01-19T12:51:05Z [w0] CommitTransaction:\r\n418:CTransaction(hash=14daa63ec9, ver=2, vin.size=1, vout.size=2, nLockTime=3)\r\n423:2026-01-19T12:51:05Z [w0] AddToWallet 14daa63ec9de552d7260ab2cd3e993ba41cd1eadc2e525eec8e017b26ebd5a4c  newupdate Inactive (abandoned=0)\r\n424:2026-01-19T12:51:05Z [w0] Submitting wtx 14daa63ec9de552d7260ab2cd3e993ba41cd1eadc2e525eec8e017b26ebd5a4c to mempool and for broadcast to peers\r\n425:2026-01-19T12:51:05Z [w0] AddToWallet 14daa63ec9de552d7260ab2cd3e993ba41cd1eadc2e525eec8e017b26ebd5a4c   InMempool\r\n426:2026-01-19T12:51:05Z [w1] AddToWallet 14daa63ec9de552d7260ab2cd3e993ba41cd1eadc2e525eec8e017b26ebd5a4c  new InMempool\r\n```\r\n</details>\r\n\r\n<details>\r\n<summary>After (info-level wallet logs redact txids and transaction dump)</summary>\r\n\r\n```bash\r\n115:2026-01-19T12:52:46Z [w0] AddToWallet new Confirmed (block=7f0cdb7a15da25963eb2276592aefb99596011a3288f08a8598c87046e5d1f2f, height=1, index=0)\r\n...\r\n411:2026-01-19T12:52:47Z [w0] AddToWallet new Confirmed (block=0a02dcb2e58029c5e665bad29ae90f69f813527bb41f6c74e7600ada7194019c, height=101, index=0)\r\n417:2026-01-19T12:52:47Z [w0] CommitTransaction\r\n418:2026-01-19T12:52:47Z [w0] AddToWallet newupdate Inactive (abandoned=0)\r\n419:2026-01-19T12:52:47Z [w0] Submitting wtx to mempool and for broadcast to peers\r\n420:2026-01-19T12:52:47Z [w0] AddToWallet  InMempool\r\n421:2026-01-19T12:52:47Z [w1] AddToWallet new InMempool\r\n```\r\n</details>\r\n\r\n<details>\r\n<summary>After with <code>-debug=wallet</code> (txids and transaction dump only in <code>[wallet]</code> debug lines)</summary>\r\n\r\nAdding wallet debug logging:\r\n```bash\r\n./build/bin/bitcoind -regtest -datadir=\"$DATA_DIR\" -daemon -connect=0 -fallbackfee=0.0002 -debug=wallet >/dev/null 2>&1\r\n```\r\n\r\n```bash\r\n114:2026-01-19T12:54:47Z [w0] AddToWallet new Confirmed (block=511c1230d47d8d70c87f01b1b2274a4c04a8304f826f500af90ac36d3953544d, height=1, index=0)\r\n115:2026-01-19T12:54:47Z [wallet] [w0]   txid=7d8e6900d4f3815291f5c80c24067d71867e605bc1ac96bc302174fc7c22c38f\r\n...\r\n512:2026-01-19T12:54:47Z [w0] AddToWallet new Confirmed (block=2c1aa6e5312f1b0213e5d8a32807baba845e5b1f19998e9ae5366ccc6ffce3b0, height=101, index=0)\r\n513:2026-01-19T12:54:47Z [wallet] [w0]   txid=eb8521e70116f366541ab8202375b3ec145e29e7271779baa4eff066ccd1e9ac\r\n519:2026-01-19T12:54:47Z [w0] CommitTransaction\r\n520:2026-01-19T12:54:47Z [wallet] [w0]   CTransaction(hash=b56f816d0c, ver=2, vin.size=1, vout.size=2, nLockTime=101)\r\n525:2026-01-19T12:54:47Z [w0] AddToWallet newupdate Inactive (abandoned=0)\r\n526:2026-01-19T12:54:47Z [wallet] [w0]   txid=b56f816d0cf7fdc5ae34eb09bcfdfefe66e57e3f76be86e46ffebd046eaa8ed2\r\n527:2026-01-19T12:54:47Z [w0] Submitting wtx to mempool and for broadcast to peers\r\n528:2026-01-19T12:54:47Z [wallet] [w0]   txid=b56f816d0cf7fdc5ae34eb09bcfdfefe66e57e3f76be86e46ffebd046eaa8ed2\r\n529:2026-01-19T12:54:47Z [w0] AddToWallet  InMempool\r\n530:2026-01-19T12:54:47Z [wallet] [w0]   txid=b56f816d0cf7fdc5ae34eb09bcfdfefe66e57e3f76be86e46ffebd046eaa8ed2\r\n531:2026-01-19T12:54:47Z [w1] AddToWallet new InMempool\r\n532:2026-01-19T12:54:47Z [wallet] [w1]   txid=b56f816d0cf7fdc5ae34eb09bcfdfefe66e57e3f76be86e46ffebd046eaa8ed2\r\n```\r\n\r\n</details>\r\n",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2026-01-19T13:15:38Z",
      "updated_at": "2026-01-23T00:05:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34341",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 6286,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3197036941,
      "number": 34376,
      "title": "bench/test: clarify merkle bench and witness test intent",
      "body": "Follow-up to #32497.\r\n\r\nClarify why the witness merkle test uses an odd leaf count (it exercises leaf duplication in `ComputeMerkleRoot()`), and make the coinbase witness hash initialization explicit.\r\n\r\nAlso simplify the leaf-copy loop in the `MerkleRoot` benchmark for readability.\r\n\r\nNo production code is changed in this follow-up, for simplicity and safety.",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2026-01-21T22:31:01Z",
      "updated_at": "2026-01-22T21:49:57Z",
      "merged_at": "2026-01-22T21:49:57Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34376",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 419,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3193617894,
      "number": 34360,
      "title": "bench: add WalletBalanceManySpent for high-history wallet scenario",
      "body": "This PR introduces a new benchmark that measures `GetBalance()` performance on wallets with extensive transaction history where the majority of outputs have already been spent.\r\n\r\nIt was created to test #27865, which separates spent TXOs from spendable ones.\r\nThis pattern mirrors real-world usage in high-activity wallets such as Lightning nodes, exchanges, hot wallets, and payment processors.\r\n\r\n**Setup:**\r\n- Creates 500 blocks × 100 coinbase outputs = 50,000 wallet TXOs\r\n- Matures all coinbases with COINBASE_MATURITY additional blocks\r\n- Spends 49,950 outputs in batched transactions (confirmed in blocks)\r\n- Consolidation outputs go to a burn script to avoid inflating wallet TXO count\r\n                                                                                                                                         \r\nTo keep the setup time reasonable, the benchmark uses the fast “fake block” approach, similar to `wallet_create_tx.cpp`.",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2026-01-21T03:15:17Z",
      "updated_at": "2026-01-22T21:48:10Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34360",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1021,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3176419903,
      "number": 34297,
      "title": "p2p: add validation checks for initial self-announcement",
      "body": "This is a follow up to #34146 . Adds validation check to the initial self-announcement code path. `IsAddrCompatible()` check can prevent sending non-routable addresses to peers that don't support addrv2.",
      "state": "closed",
      "user": "frankomosh",
      "created_at": "2026-01-15T08:26:00Z",
      "updated_at": "2026-01-22T18:43:09Z",
      "merged_at": "2026-01-22T11:01:54Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34297",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 260,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1542161958,
      "number": 28591,
      "title": "kernel: chainparams updates for 26.x",
      "body": "Update chainparams pre `26.x` branch off.\r\n\r\nNote: Remember that some variance is expected in the m_assumed_* sizes.\r\n\r\nCloses #28572.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2023-10-04T16:19:29Z",
      "updated_at": "2026-01-22T18:21:28Z",
      "merged_at": "2023-10-09T13:54:46Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28591",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 171,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3185680005,
      "number": 34333,
      "title": "fuzz:wallet: add target for wallet receive",
      "body": "Tracking issue (https://github.com/bitcoin/bitcoin/issues/29901)\r\n\r\nthis add fuzz target for wallet receive...\r\n\r\nAlso,  for block height handling for unknown heights\r\n\r\nAllowing `-1` for `conflicting_block_height` in `TxStateBlockConflicted` which is a valid state when deserializing old wallet data where block heights weren't stored. This helps sorting an assertion failure that would occur when `GetTxDepthInMainChain()` encounters transactions with unknown conflicting block heights.\r\n\r\n discovered that `GetTxDepthInMainChain()` would crash with `assert(conf->conflicting_block_height >= 0)` when handling transactions with `-1` (unknown height), even though this is used elsewhere in the codebase.\r\n\r\n**Code inconsistency here below:**\r\n\r\nIn `src/wallet/transaction.h:94`, `-1` is  used for unknown heights:\r\n\r\n```cpp\r\n} else if (data.index == -1) {\r\n    return TxStateBlockConflicted{data.block_hash, /*height=*/-1};  \r\n}\r\n```\r\n\r\nIn `src/wallet/wallet.cpp:1320`, negative heights are handled \r\n\r\n```cpp\r\n// If number of conflict confirms cannot be determined, this means\r\n// that the block is still unknown or not yet part of the main chain,\r\n// for example when loading the wallet during a reindex. Do nothing in that\r\n// case.\r\nif (m_last_block_processed_height < 0 || conflicting_height < 0) {\r\n    return; \r\n}\r\n```\r\n\r\nBut in `src/wallet/wallet.cpp:3299`, the assertion requires `>= 0`:\r\n\r\n```cpp\r\n} else if (auto* conf = wtx.state<TxStateBlockConflicted>()) {\r\n    assert(conf->conflicting_block_height >= 0);  // here it crashes\r\n    return -1 * (GetLastBlockHeight() - conf->conflicting_block_height + 1);\r\n}\r\n```\r\n",
      "state": "open",
      "user": "b-l-u-e",
      "created_at": "2026-01-18T19:38:24Z",
      "updated_at": "2026-01-22T17:27:31Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34333",
      "labels": [
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1672,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2584507258,
      "number": 32729,
      "title": "test,refactor: extract script template helpers & widen sigop count coverage",
      "body": "### Summary\r\n\r\nThis PR extracts a set of cheap, inline helpers for recognizing the most common script templates, clarifies the definition of valid op-codes for pre-Taproot scripts, and splits the existing \"deserialize + check-block\" benchmark into three orthogonal micro-benchmarks.  \r\nThe change is behavior-neutral for consensus and policy - every modified call-site performs the same checks as before, just through clearer helper functions.\r\n\r\n### Context\r\n\r\nWhile working on [`GetSigOpCount` optimizations for known script templates](https://github.com/bitcoin/bitcoin/pull/32532) I noticed that feature-test coverage was [thin for this code path](https://maflcko.github.io/b-c-cov/total.coverage/src/script/script.cpp.gcov.html).  \r\nThis PR therefore adds tests for error cases (malformed push-data encodings) and for the expected sigop totals of the various script templates (including edge cases like a sigop after an `OP_RETURN`).\r\n\r\nGiven the difficulty of reviewing the [original optimizations themselves](https://github.com/bitcoin/bitcoin/pull/32532#issuecomment-2950665350), I split all test / benchmark work into this standalone PR.  \r\nThe recent burst of sigops related refactor activity ([#31624](https://github.com/bitcoin/bitcoin/pull/31624), [#32521](https://github.com/bitcoin/bitcoin/pull/32521), [#32533](https://github.com/bitcoin/bitcoin/pull/32533)) underlines the need for extra safety.\r\n\r\nThe refactors here eliminate magic numbers, deduplicate template checks, and lay groundwork for future performance work.\r\n\r\n### Structure\r\n\r\n* **Benchmarks** - first commits separate deserialization+hashing, validation, and sigop counting so each cost can be measured independently.  \r\n* **Template helpers** - tiny, mechanical commits move each script-template check into `script.h`, replace all ad-hoc byte-checks, and add tests where necessary.  \r\n* **Tests** - a full script-test suite covering malformed `PUSHDATA` sequences and the pre-taproot / accurate sigop totals for every standard template.  \r\n* **pre-taproot opcode ceiling** - documents, enforces, and tests that `OP_CHECKSIGADD` > `MAX_OPCODE`.\r\n* **Extra fuzzing** - enabled all possible opcodes in `ConsumeOpcodeType`",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-06-11T14:44:28Z",
      "updated_at": "2026-01-22T17:18:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32729",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2276,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3104076541,
      "number": 34079,
      "title": "kernel: Remove non-kernel module includes",
      "body": "Found these while attempting to isolate the kernel library sources into their own repository. There still is no mechanism for preventing including headers into the kernel library that don't belong to kernel modules, but it is also fairly straight forward to correct manually for now. However, the changes here might be incomplete.",
      "state": "closed",
      "user": "sedited",
      "created_at": "2025-12-15T21:30:55Z",
      "updated_at": "2026-01-22T16:28:03Z",
      "merged_at": "2025-12-22T14:07:41Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34079",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 372,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3177864654,
      "number": 34309,
      "title": "guix: stop passing depends sources to codesigning",
      "body": "I think this is just a copy-pasta from the build container (which has existed since this file was introduced in 38eb91eb0616ed6dbe34c23e11588d130fef07f8). I don't see why we'd need the depends sources available when performing codesigning.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-01-15T15:58:51Z",
      "updated_at": "2026-01-22T16:22:31Z",
      "merged_at": "2026-01-22T16:20:51Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34309",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 289,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3128861568,
      "number": 34146,
      "title": "p2p: send first addr self-announcement in separate message 🎄",
      "body": "This makes sure the initial address self-announcement a node sends to a peer happends in a separate P2P message. This has benefits for both inbound and outbound connections:\r\n\r\nFor inbound connections from a peer to us, previously, we might send the self-announcement along with our response to a GETADDR request. However, the self-announcement might replace an address from the GETADDR response. This isn't clean.\r\n\r\nFor outbound connections from us to a peer, previously, it could have happend that we send the self-announcement along with other addresses. Since shortly after connection open, the peer might only have one rate-limiting token for us, and the addresses are shuffeld on arrival, it's possible that the self-announcement gets rate-limited. However, note that these rate-limitings seem to be rare in practice.\r\n\r\nThis is inspired by and based on https://github.com/bitcoin/bitcoin/pull/33699#issuecomment-3462287763. The discussion there should be helpful for reviewers. ",
      "state": "closed",
      "user": "0xB10C",
      "created_at": "2025-12-24T15:38:31Z",
      "updated_at": "2026-01-22T15:23:29Z",
      "merged_at": "2026-01-14T22:16:49Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34146",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1047,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3196671528,
      "number": 34375,
      "title": "doc: mempool: fix  `removeUnchecked` incorrect comment",
      "body": "`CTxMemPool::removeUnchecked` description comment is stale and incorrect; the behaviour being described no longer applies in the post-cluster world.  This PR is a simple fix that attempts to correctly describe what is being done in removeUnchecked.\r\n\r\n",
      "state": "closed",
      "user": "ismaelsadeeq",
      "created_at": "2026-01-21T20:16:52Z",
      "updated_at": "2026-01-22T14:48:23Z",
      "merged_at": "2026-01-22T14:45:22Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34375",
      "labels": [
        "Docs",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 307,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3023781832,
      "number": 33908,
      "title": "kernel: add context‑free block validation API (`btck_check_block_context_free`) with POW/Merkle flags",
      "body": "This PR exposes Bitcoin Core’s context‑free block checks to library users via a new C API entry point, `btck_check_block_context_free`. \r\n\r\nCallers can validate a block’s structure (size/weight, coinbase rules, per‑tx context‑free checks) and optionally re‑run Proof‑of‑Work and Merkle‑root verification without touching chainstate, the block index, or the UTXO set. \r\n\r\nRationale\r\nClients embedding the kernel need a pure block sanity check without requiring node state or disk writes (candidate block validation, for example). This API offers that surface in a single call, with optional PoW/Merkle toggles to avoid redundant work when the header has already been validated or when Merkle verification is deferred.",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2025-11-18T23:37:30Z",
      "updated_at": "2026-01-22T13:40:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33908",
      "labels": [
        "Validation",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 818,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3192005892,
      "number": 34355,
      "title": "doc: Fix wrong code in WITH_LOCK doxygen comment",
      "body": "The typo is harmless, but a bit confusing every time i read it",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-20T16:52:27Z",
      "updated_at": "2026-01-22T13:07:28Z",
      "merged_at": "2026-01-22T11:23:07Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34355",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 111,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3197178191,
      "number": 34377,
      "title": "test: Rename wallet in restore attempt in wallet_assumeutxo",
      "body": "I hope this fixes #34354\r\n\r\nBased on this error from the logs `filesystem error: cannot remove: The process cannot access the file because it is being used by another process` it looks like there still exists a wallet file by the same name from the previous test case hasn't been cleaned up yet by it's process fully. This should be fixed by giving the failing `restorewallet` case a different wallet name and this shouldn't have any further effects on the rest of the test because is expected to fail anyway. The following (successful) call already uses a different wallet name.",
      "state": "closed",
      "user": "fjahr",
      "created_at": "2026-01-21T23:31:00Z",
      "updated_at": "2026-01-22T11:59:46Z",
      "merged_at": "2026-01-22T11:59:46Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34377",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 639,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3110306931,
      "number": 34090,
      "title": "net: Fix `-Wmissing-braces`",
      "body": "On some non-POSIX platforms, Clang emits `-Wmissing-braces` warnings for the `IN6ADDR_ANY_INIT` and `IN6ADDR_LOOPBACK_INIT` macros. For example, on OpenIndiana / illumos:\r\n```\r\n$ uname -srv\r\nSunOS 5.11 illumos-325e0fc8bb\r\n$ clang --version\r\nclang version 21.1.7 (https://github.com/OpenIndiana/oi-userland.git 36a81bf5e5d307d4e85893422600678d46328010)\r\nTarget: x86_64-pc-solaris2.11\r\nThread model: posix\r\nInstalledDir: /usr/clang/21/bin\r\n$ cmake -B build -DCMAKE_GENERATOR=Ninja -DCMAKE_C_COMPILER=clang -DCMAKE_CXX_COMPILER=clang++ -DENABLE_IPC=OFF -DAPPEND_CXXFLAGS='-Wno-unused-command-line-argument'\r\n$ cmake --build build\r\n[284/573] Building CXX object src/CMakeFiles/bitcoin_node.dir/net.cpp.o\r\n/export/home/hebasto/dev/bitcoin/src/net.cpp:3309:42: warning: suggest braces around initialization of subobject [-Wmissing-braces]\r\n 3309 |         const CService ipv6_any{in6_addr(IN6ADDR_ANY_INIT), GetListenPort()}; // ::\r\n      |                                          ^~~~~~~~~~~~~~~~\r\n/usr/include/netinet/in.h:479:32: note: expanded from macro 'IN6ADDR_ANY_INIT'\r\n  479 | #define IN6ADDR_ANY_INIT            {   0, 0, 0, 0,     \\\r\n      |                                         ^~~~~~~~~~~~~~~~~\r\n  480 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  481 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  482 |                                         0, 0, 0, 0 }\r\n      |                                         ~~~~~~~~~~\r\n1 warning generated.\r\n[467/573] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/i2p_tests.cpp.o\r\n/export/home/hebasto/dev/bitcoin/src/test/i2p_tests.cpp:116:34: warning: suggest braces around initialization of subobject [-Wmissing-braces]\r\n  116 |     const CService addr{in6_addr(IN6ADDR_LOOPBACK_INIT), /*port=*/7656};\r\n      |                                  ^~~~~~~~~~~~~~~~~~~~~\r\n/usr/include/netinet/in.h:484:37: note: expanded from macro 'IN6ADDR_LOOPBACK_INIT'\r\n  484 | #define IN6ADDR_LOOPBACK_INIT       {   0, 0, 0, 0,     \\\r\n      |                                         ^~~~~~~~~~~~~~~~~\r\n  485 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  486 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  487 |                                         0, 0, 0, 0x1U }\r\n      |                                         ~~~~~~~~~~~~~\r\n/export/home/hebasto/dev/bitcoin/src/test/i2p_tests.cpp:159:38: warning: suggest braces around initialization of subobject [-Wmissing-braces]\r\n  159 |         const CService addr{in6_addr(IN6ADDR_LOOPBACK_INIT), /*port=*/7656};\r\n      |                                      ^~~~~~~~~~~~~~~~~~~~~\r\n/usr/include/netinet/in.h:484:37: note: expanded from macro 'IN6ADDR_LOOPBACK_INIT'\r\n  484 | #define IN6ADDR_LOOPBACK_INIT       {   0, 0, 0, 0,     \\\r\n      |                                         ^~~~~~~~~~~~~~~~~\r\n  485 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  486 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  487 |                                         0, 0, 0, 0x1U }\r\n      |                                         ~~~~~~~~~~~~~\r\n2 warnings generated.\r\n[483/573] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/netbase_tests.cpp.o\r\n/export/home/hebasto/dev/bitcoin/src/test/netbase_tests.cpp:505:36: warning: suggest braces around initialization of subobject [-Wmissing-braces]\r\n  505 |         CService(CNetAddr(in6_addr(IN6ADDR_LOOPBACK_INIT)), 0 /* port */),\r\n      |                                    ^~~~~~~~~~~~~~~~~~~~~\r\n/usr/include/netinet/in.h:484:37: note: expanded from macro 'IN6ADDR_LOOPBACK_INIT'\r\n  484 | #define IN6ADDR_LOOPBACK_INIT       {   0, 0, 0, 0,     \\\r\n      |                                         ^~~~~~~~~~~~~~~~~\r\n  485 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  486 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  487 |                                         0, 0, 0, 0x1U }\r\n      |                                         ~~~~~~~~~~~~~\r\n/export/home/hebasto/dev/bitcoin/src/test/netbase_tests.cpp:510:36: warning: suggest braces around initialization of subobject [-Wmissing-braces]\r\n  510 |         CService(CNetAddr(in6_addr(IN6ADDR_LOOPBACK_INIT)), 0x00f1 /* port */),\r\n      |                                    ^~~~~~~~~~~~~~~~~~~~~\r\n/usr/include/netinet/in.h:484:37: note: expanded from macro 'IN6ADDR_LOOPBACK_INIT'\r\n  484 | #define IN6ADDR_LOOPBACK_INIT       {   0, 0, 0, 0,     \\\r\n      |                                         ^~~~~~~~~~~~~~~~~\r\n  485 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  486 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  487 |                                         0, 0, 0, 0x1U }\r\n      |                                         ~~~~~~~~~~~~~\r\n/export/home/hebasto/dev/bitcoin/src/test/netbase_tests.cpp:515:36: warning: suggest braces around initialization of subobject [-Wmissing-braces]\r\n  515 |         CService(CNetAddr(in6_addr(IN6ADDR_LOOPBACK_INIT)), 0xf1f2 /* port */),\r\n      |                                    ^~~~~~~~~~~~~~~~~~~~~\r\n/usr/include/netinet/in.h:484:37: note: expanded from macro 'IN6ADDR_LOOPBACK_INIT'\r\n  484 | #define IN6ADDR_LOOPBACK_INIT       {   0, 0, 0, 0,     \\\r\n      |                                         ^~~~~~~~~~~~~~~~~\r\n  485 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  486 |                                         0, 0, 0, 0,     \\\r\n      |                                         ~~~~~~~~~~~~~~~~~\r\n  487 |                                         0, 0, 0, 0x1U }\r\n      |                                         ~~~~~~~~~~~~~\r\n3 warnings generated.\r\n[573/573] Linking CXX executable bin/test_bitcoin\r\n```\r\n\r\nThe same issue is observed on Windows. For further details, see https://github.com/bitcoin/bitcoin/pull/31507.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-12-17T14:53:51Z",
      "updated_at": "2026-01-22T11:49:07Z",
      "merged_at": "2026-01-22T11:40:05Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34090",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 6596,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2829220023,
      "number": 33390,
      "title": "cmake: exclude secp256k1 from all",
      "body": "Instead of setting the EXCLUDE_FROM_ALL target property, pass EXCLUDE_FROM_ALL to `add_subdirectory()`.\r\n\r\nThis has the following advanteges:\r\n\r\n* It is shorter (obviously).\r\n* Target properties are set only in the `CMakeLists.txt` file that defines the target.\r\n* Install rules defined in the subdirectory are excluded as well. This is what we want, because secp256k1 is linked statically.",
      "state": "open",
      "user": "purpleKarrot",
      "created_at": "2025-09-15T13:11:00Z",
      "updated_at": "2026-01-22T11:23:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33390",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 424,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3150016853,
      "number": 34211,
      "title": "build: Alt restore cross-compilation for Android",
      "body": "# build, qt, doc: Add Android GUI support and APK packaging\r\n\r\nThis PR restores cross-compilation for Android (previously removed in #30049 and proposed in #32262) and extends it to support the Bitcoin-Qt GUI and Android Application Package (APK) generation.\r\n\r\nUnlike #32262, which focused on restoring the base cross-compilation, this PR provides a complete path to a functional Android application. It achieves this by updating the `depends` system to handle Android-specific requirements (shared Qt libraries, JNI support), integrating `androiddeployqt` into the CMake build system, and providing a standard Android entry point.\r\n\r\n### Alternatives\r\nThis PR is offered as an alternative to #32262. It incorporates and builds upon the `depends` fixes introduced there while adding the necessary components for a full GUI application and automated APK packaging.\r\n\r\n### Key Changes (mostly from #32262)\r\n- **build**: Restored and updated Android cross-compilation support in the `depends` system. This includes handling Android ABIs and mapping them to Bitcoin Core's `HOST` triples.\r\n- **build**: Added APK generation support via a new `apk_package` CMake target. This target automates the generation of `deploy.json` and the execution of `androiddeployqt` to produce ready-to-install `.apk` files.\r\n- **qt**: Added Android-specific GUI configurations, including a Java entry point (`BitcoinQtActivity.java`), high-resolution icons, and a manifest template.\r\n- **doc**: Added `doc/build-android.md` with detailed instructions for setting up the Android SDK/NDK and building the GUI.\r\n- **util**: Added a deduction guide for `util::Overloaded` to ensure compatibility with modern Android C++ toolchains.\r\n- **depends**: Applied several patches to Qt to fix JNI static linking issues and duplicate symbols encountered during Android builds.\r\n\r\n### Testing\r\nThe changes have been tested on Ubuntu 22.04 targeting `x86_64-linux-android` (API level 34) with NDK r26b and Qt 6.7.3. The resulting APK has been verified to install and run correctly on an Android emulator (see screenshot at the bottom).\r\nAlso it has been tested on a real devices with Android 13 (API level 33) for both abis `arm64-v8a` (aarch64) and `armv7a`.\r\n\r\n**Build Example:**\r\n```bash\r\n# Set environment\r\nexport ANDROID_SDK_ROOT=/path/to/Android/Sdk\r\nexport ANDROID_NDK_ROOT=$ANDROID_SDK_ROOT/ndk/26.1.10909125\r\n\r\n# Build dependencies\r\ngmake -C depends HOST=x86_64-linux-android ANDROID_SDK=$ANDROID_SDK_ROOT ANDROID_NDK=$ANDROID_NDK_ROOT ANDROID_API_LEVEL=34 NO_IPC=1  -j$(nproc)\r\n\r\n# Configure and build APK\r\ncmake -G Ninja -B build --toolchain depends/x86_64-linux-android/toolchain.cmake \\\r\n      -DBUILD_GUI=ON -DANDROID_API_LEVEL=34  -j$(nproc)\r\ncmake --build build --target apk_package  -j$(nproc)\r\n```\r\n\r\n### Note for Reviewers\r\n- Android does not support the system-wide IPC mechanisms used by Bitcoin Core's multiprocess support, so `NO_IPC=1` is currently required.\r\n- CI integration for the Android build is not included in this PR and will be addressed in a follow-up task if deemed necessary.\r\n\r\n### Emulator Screenshot\r\n<details>\r\n  <summary>Click to expand</summary>\r\n  \r\n<img width=\"968\" height=\"2187\" alt=\"Screenshot 2026-01-06 082824\" src=\"https://github.com/user-attachments/assets/9d7b0130-b624-4817-adf4-f5825c8e4c9d\" />\r\n\r\n</details>\r\n\r\n",
      "state": "closed",
      "user": "D33r-Gee",
      "created_at": "2026-01-06T16:48:55Z",
      "updated_at": "2026-01-22T11:22:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34211",
      "labels": [
        "Build system",
        "Android"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 3378,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2089458493,
      "number": 30961,
      "title": "ci: add `LLVM_SYMBOLIZER_PATH` to Valgrind fuzz job",
      "body": "Otherwise:\r\n```bash\r\n\tNEW_FUNC[1/23]: ==4710==WARNING: invalid path to external symbolizer!\r\n==4710==WARNING: Failed to use and restart external symbolizer!\r\n0xb72010  (/ci_container_base/ci/scratch/build-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0xa6a010) (BuildId: 2087ad415cb752eea259ed750f3b78a7fcb0b43b)\r\n\tNEW_FUNC[2/23]: 0xb72240  (/ci_container_base/ci/scratch/build-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0xa6a240) (BuildId: 2087ad415cb752eea259ed750f3b78a7fcb0b43b)\r\n\r\n```",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2024-09-24T16:06:30Z",
      "updated_at": "2026-01-22T10:58:18Z",
      "merged_at": "2024-09-26T08:59:06Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30961",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 530,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2064363526,
      "number": 30866,
      "title": "descriptor: Add proper Clone function to miniscript::Node",
      "body": "Multipath descriptors requires performing a deep copy, so a Clone function that does that is added to miniscript::Node instead of the current shallow copy.\r\n\r\nFixes #30864",
      "state": "closed",
      "user": "achow101",
      "created_at": "2024-09-10T19:52:31Z",
      "updated_at": "2026-01-22T10:58:18Z",
      "merged_at": "2025-01-22T11:23:17Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30866",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 229,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2246906275,
      "number": 31548,
      "title": "fuzz: Abort when global PRNG is used before SeedRand::ZEROS",
      "body": "This adds one more check to abort when global PRNG is used before SeedRand::ZEROS in fuzz tests. This is achieved by carving out the two remaining uses. First, `g_rng_temp_path_init`, and second the random fallback for `RANDOM_CTX_SEED`, which isn't used in fuzz tests anyway.\r\n\r\nRequested in https://github.com/bitcoin/bitcoin/pull/31521#issuecomment-2554669015\r\n\r\nCan be tested by reverting fadd568931a2d21e0f80e1efaf2281f5164fa20e and observing an abort when running the `utxo_total_supply` fuzz target.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2024-12-20T15:30:16Z",
      "updated_at": "2026-01-22T10:58:17Z",
      "merged_at": "2025-01-22T17:40:29Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31548",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 566,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2287458917,
      "number": 31690,
      "title": "doc: Amend notes on benchmarking",
      "body": "This gives some more context on the motivation and larger picture of benchmarks.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-01-20T11:46:45Z",
      "updated_at": "2026-01-22T10:58:16Z",
      "merged_at": "2025-01-22T16:45:07Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31690",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 113,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2292810508,
      "number": 31710,
      "title": "Typo fix release-notes-0.10.0.md",
      "body": "# Typo Fix in `release-notes-0.10.0.md`\r\n\r\n## Description\r\nThis pull request corrects the typo in the release notes from \"actualy\" to \"actually.\"\r\n\r\n## Changes\r\n- Fixed the typo \"actualy\" to \"actually\" in the release notes for version 0.10.0.\r\n",
      "state": "closed",
      "user": "BorisNaum",
      "created_at": "2025-01-22T18:00:45Z",
      "updated_at": "2026-01-22T10:58:15Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31710",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 277,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2571509113,
      "number": 32685,
      "title": "wallet: Allow read-only database access for info and dump commands",
      "body": "## Problem\r\n\r\nFixes #29559\r\n\r\nThe `bitcoin-wallet info` and `bitcoin-wallet dump` commands currently fail when wallet files are write-protected, throwing \"Database opened in readonly mode but read-write permissions are needed\" errors. This prevents users from safely inspecting write-protected wallet files, which is important for:\r\n\r\n- Security-conscious setups where wallets are stored on read-only filesystems\r\n- Forensic analysis of wallet files without risk of modification\r\n- Backup verification without accidentally corrupting wallet data\r\n- Compliance with principle of least privilege (read-only operations should only require read access)\r\n\r\n## Solution\r\n\r\nThis PR adds comprehensive read-only database support to enable `bitcoin-wallet info` and `dump` commands to work with write-protected wallet files.\r\n\r\n### Key Changes\r\n\r\n**Database Layer (`src/wallet/db.h`, `src/wallet/sqlite.h`, `src/wallet/sqlite.cpp`)**\r\n- Add `read_only` boolean option to `DatabaseOptions` structure  \r\n- Add `IsReadOnly()` virtual method to `WalletDatabase` interface\r\n- Modify `SQLiteDatabase` to properly handle read-only mode:\r\n  - Use `SQLITE_OPEN_READONLY` flag when `read_only=true`\r\n  - Skip write operations (pragma settings, table creation) in read-only mode\r\n  - Maintain full read capability for queries and data retrieval\r\n\r\n**Wallet Tool (`src/wallet/wallettool.cpp`)**\r\n- Update `bitcoin-wallet info` command to use `options.read_only = true`\r\n- Update `bitcoin-wallet dump` command to use `options.read_only = true`\r\n\r\n**Wallet Loading (`src/wallet/walletdb.cpp`)**\r\n- Enhance `LoadWallet()` to detect read-only mode via `database.IsReadOnly()`\r\n- Skip version updates and other write operations when in read-only mode\r\n- Prevent \"Wallet corrupted\" errors during read-only access\r\n\r\n**Legacy Support (`src/wallet/migrate.h`)**\r\n- Add `IsReadOnly()` method to `BerkeleyRODatabase` for consistency\r\n\r\n## Testing\r\n\r\nThe implementation has been thoroughly tested:\r\n\r\n### Manual Testing\r\n- ✅ Created test wallets and made them read-only (`chmod 444`)\r\n- ✅ Verified `bitcoin-wallet info` works with read-only files\r\n- ✅ Verified `bitcoin-wallet dump` works with read-only files\r\n- ✅ Confirmed identical output between read-write and read-only access\r\n- ✅ Verified normal read-write operations remain unaffected\r\n\r\n### Unit Tests\r\nAll existing wallet tests continue to pass, confirming no regression in normal wallet operations.\r\n\r\n### Safety Verification\r\n- File permissions are respected (no writes attempted on read-only files)\r\n- Data integrity maintained (read-only access produces identical results)\r\n- Backwards compatibility preserved (existing workflows unaffected)\r\n\r\n## Security Considerations\r\n\r\nThis change **improves** security by:\r\n- Enabling inspection of wallet files without write access (principle of least privilege)\r\n- Preventing accidental wallet corruption during read-only operations\r\n- Supporting secure forensic analysis workflows\r\n- Reducing attack surface for read-only operations\r\n\r\nThe implementation is conservative and safe:\r\n- Only affects explicitly read-only operations (`info` and `dump` commands)\r\n- No changes to consensus or validation logic\r\n- No impact on normal wallet operations\r\n- Uses SQLite's built-in read-only mode for safety\r\n\r\n## Backwards Compatibility\r\n\r\nFull backwards compatibility is maintained:\r\n- Existing wallet operations work identically\r\n- No API changes for normal use cases  \r\n- No changes to wallet file formats\r\n- No impact on other Bitcoin Core components\r\n\r\n## Related Work\r\n\r\nThis builds upon existing read-only database patterns in Bitcoin Core, particularly the `BerkeleyRODatabase` class used for wallet migration scenarios. \r\n\r\n#28116 ",
      "state": "open",
      "user": "PeterWrighten",
      "created_at": "2025-06-05T20:36:09Z",
      "updated_at": "2026-01-22T09:49:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32685",
      "labels": [
        "Wallet",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 2,
        "text_length": 3773,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3194930713,
      "number": 34366,
      "title": "test: switch order of error code and message check",
      "body": "I feel it'd be easier to debug intermittent test failures if the error message is present in the logs instead of error code. So, switching order of error code and message in the `try_rpc` function to aid error debugging.\r\n\r\nShould help in debugging #34354 IMO. It's an intermittent failure on Windows that I can't reproduce and it's more difficult to figure out what could have gone wrong only by seeing the error code like below in the CI logs. Given that the functional tests pass, I don't see a harm in checking for error message first and throwing it in case of a mismatch.\r\n\r\n```python\r\nAssertionError: Unexpected JSONRPC error code -1\r\n```\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "closed",
      "user": "rkrux",
      "created_at": "2026-01-21T11:56:12Z",
      "updated_at": "2026-01-22T09:13:41Z",
      "merged_at": "2026-01-21T22:09:39Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34366",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 1,
        "text_length": 2762,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2962918038,
      "number": 33745,
      "title": "mining: check witness commitment in submitBlock",
      "body": "When an IPC client requests a new block template via the Mining interface, we hold on to its `CBlock`. That way when they call `submitSolution()` we can modify it in place, rather than having to reconstruct the full block like the `submitblock` RPC does.\r\n\r\nBefore this commit however we forgot to invalidate `m_checked_witness_commitment`, which we should since the client brings a new coinbase.\r\n\r\nThis would cause us to accept an invalid chaintip.\r\n\r\nFix this and add a test to confirm that we now reject such a block. As a sanity check, we add a second node to the test and confirm that will accept our mined block.\r\n\r\nAs first noticed in #33374 the IPC code takes the coinbase as provided, unlike the `submitblock` RPC which calls `UpdateUncommittedBlockStructures()` and adds witness commitment to the coinbase if it was missing.\r\n\r\nAlthough that could have been an alternative fix, we instead document that IPC clients are expected to provide the full coinbase including witness commitment.\r\n\r\nPatch to produce the original issue:\r\n\r\n```diff\r\ndiff --git a/src/node/miner.cpp b/src/node/miner.cpp\r\nindex b988e28a3f..28e9048a4d 100644\r\n--- a/src/node/miner.cpp\r\n+++ b/src/node/miner.cpp\r\n@@ -450,15 +450,10 @@ void AddMerkleRootAndCoinbase(CBlock& block, CTransactionRef coinbase, uint32_t\r\n     }\r\n     block.nVersion = version;\r\n     block.nTime = timestamp;\r\n     block.nNonce = nonce;\r\n     block.hashMerkleRoot = BlockMerkleRoot(block);\r\n-\r\n-    // Reset cached checks\r\n-    block.m_checked_witness_commitment = false;\r\n-    block.m_checked_merkle_root = false;\r\n-    block.fChecked = false;\r\n }\r\n\r\n std::unique_ptr<CBlockTemplate> WaitAndCreateNewBlock(ChainstateManager& chainman,\r\n                                                       KernelNotifications& kernel_notifications,\r\n                                                       CTxMemPool* mempool,\r\ndiff --git a/test/functional/interface_ipc.py b/test/functional/interface_ipc.py\r\nindex cce56e3294..bf1b7048ab 100755\r\n--- a/test/functional/interface_ipc.py\r\n+++ b/test/functional/interface_ipc.py\r\n@@ -216,22 +216,22 @@ class IPCInterfaceTest(BitcoinTestFramework):\r\n             assert_equal(res.result, True)\r\n\r\n             # The remote template block will be mutated, capture the original:\r\n             remote_block_before = await self.parse_and_deserialize_block(template, ctx)\r\n\r\n-            self.log.debug(\"Submitted coinbase must include witness\")\r\n+            self.log.debug(\"Submitted coinbase with missing witness is accepted\")\r\n             assert_not_equal(coinbase.serialize_without_witness().hex(), coinbase.serialize().hex())\r\n             res = await template.result.submitSolution(ctx, block.nVersion, block.nTime, block.nNonce, coinbase.serialize_without_witness())\r\n-            assert_equal(res.result, False)\r\n+            assert_equal(res.result, True)\r\n\r\n             self.log.debug(\"Even a rejected submitBlock() mutates the template's block\")\r\n             # Can be used by clients to download and inspect the (rejected)\r\n             # reconstructed block.\r\n             remote_block_after = await self.parse_and_deserialize_block(template, ctx)\r\n             assert_not_equal(remote_block_before.serialize().hex(), remote_block_after.serialize().hex())\r\n\r\n-            self.log.debug(\"Submit again, with the witness\")\r\n+            self.log.debug(\"Submit again, with the witness - does not replace the invalid block\")\r\n             res = await template.result.submitSolution(ctx, block.nVersion, block.nTime, block.nNonce, coinbase.serialize())\r\n             assert_equal(res.result, True)\r\n\r\n             self.log.debug(\"Block should propagate\")\r\n             assert_equal(self.nodes[1].getchaintips()[0][\"height\"], current_block_height + 1)\r\n```\r\n",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2025-10-30T12:02:55Z",
      "updated_at": "2026-01-22T09:01:05Z",
      "merged_at": "2025-11-12T15:04:13Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33745",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 3799,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3090774381,
      "number": 34047,
      "title": "cmake: Add fail pattern to `try_append_cxx_flags`",
      "body": "This PR addresses scenarios where the build environment, such as OSS-Fuzz, provides the `-Wno-error=unknown-warning-option` flag, which undermines our use of `-Werror` when checking compiler flags.\r\n\r\nTo reproduce the issue on the master branch @ c1f0a89d9caeb62a0a5f3462b454746941e626e6:\r\n```\r\n$ env CXX=clang++ CC=clang CXXFLAGS=\"-Wno-error=unknown-warning-option\" cmake -B build 2>&1 | grep WDUPLICATED_BRANCHES\r\n-- Performing Test CXX_SUPPORTS__WDUPLICATED_BRANCHES\r\n-- Performing Test CXX_SUPPORTS__WDUPLICATED_BRANCHES - Success\r\n```\r\n\r\nThis output shows that the `-Wduplicated-branches` flag is incorrectly treated as recognised by the compiler.\r\n\r\nNoticed while working on the [migration](https://github.com/google/oss-fuzz/pull/14457) to Ubuntu 24.04 in OSS-Fuzz.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-12-10T21:14:51Z",
      "updated_at": "2026-01-22T08:08:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34047",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 822,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3190306599,
      "number": 34350,
      "title": "wallet: fix importprunedfunds to allow importing spending txs",
      "body": "Fixes #21647\r\n\r\nThis PR fixes an issue where the `importprunedfunds` RPC only allowed importing\r\ntransactions that credit the wallet, but rejected transactions that spend from\r\nthe wallet.\r\n\r\nThis could lead to incorrect wallet balance in pruned or partially-synced setups\r\nwhere a spending transaction is missing: the wallet would remember receiving\r\nfunds but forget that they were already spent.\r\n\r\nThe fix extends the check to also allow transactions that are `IsFromMe()`.\r\n\r\nA functional test is added to cover importing a spending transaction and ensure\r\nit is correctly accepted and restored to the wallet.\r\n\r\n\r\n\r\n",
      "state": "closed",
      "user": "crackedhandle",
      "created_at": "2026-01-20T08:25:41Z",
      "updated_at": "2026-01-22T04:19:11Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34350",
      "labels": [
        "Wallet",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 684,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2902028046,
      "number": 33592,
      "title": "contrib: remove deprecated --deep signing from macdeployqtplus",
      "body": "**Description**\r\nRemoved the deprecated --deep flag from codesign in macdeployqtplus and replaced it with an explicit recursive signing process for all binaries, frameworks, and plugins.\r\nFixes #32486 \r\n\r\n<img width=\"624\" height=\"370\" alt=\"Screenshot 2025-10-10 at 2 36 16 AM\" src=\"https://github.com/user-attachments/assets/6329b67e-e400-4d8d-947c-25bceab4cb55\" />\r\n\r\n\r\n**Steps To Reproduce**\r\nN/A since not a bug only deprecating an arg\r\n\r\n**Steps To Test**\r\n- Set up the app normally.\r\n- Signing would be logged\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "open",
      "user": "amishhaa",
      "created_at": "2025-10-09T21:11:13Z",
      "updated_at": "2026-01-22T02:05:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33592",
      "labels": [
        "Scripts and tools"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 2641,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3196205347,
      "number": 34372,
      "title": "QA: wallet_migration: Test several more weird scenarios",
      "body": "Includes the \"survive\" file test from #34222 ",
      "state": "open",
      "user": "luke-jr",
      "created_at": "2026-01-21T17:44:07Z",
      "updated_at": "2026-01-21T23:44:02Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34372",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 101,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3161267008,
      "number": 34246,
      "title": "verify-commits: Allow specific commits to allow sha1",
      "body": "Allow specific commits to not require the sha1 check.\r\n\r\nFixes the CI for aeaa67a9eac0decb89c60a67f9755ca10cbcc1d9 which uses SHA1 somewhere in the key's self signatures.",
      "state": "closed",
      "user": "achow101",
      "created_at": "2026-01-10T00:29:36Z",
      "updated_at": "2026-01-21T22:34:24Z",
      "merged_at": "2026-01-13T23:02:44Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34246",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 223,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2519262912,
      "number": 32497,
      "title": "merkle: pre‑reserve leaves to prevent reallocs with odd vtx count",
      "body": "#### Summary\r\n\r\n`ComputeMerkleRoot` [duplicates the last hash](https://github.com/bitcoin/bitcoin/blob/39b6c139bd6be33699af781f1d71f6fed303d468/src/consensus/merkle.cpp#L54-L56) when the input size is odd. If the caller provides a `std::vector` whose capacity equals its size, that extra `push_back` forces a reallocation, doubling its capacity (causing peak memory usage of 3x the necessary size).\r\n\r\nThis affects roughly half of the created blocks (those with odd transaction counts), causing unnecessary memory fragmentation during every block validation.\r\n\r\n#### Fix\r\n\r\n* Pre-reserves vector capacity to account for the odd-count duplication using `(size + 1) & ~1ULL`.\r\n    * This syntax produces [optimal assembly](https://github.com/bitcoin/bitcoin/pull/32497#discussion_r2553107836) across x86/ARM and 32/64-bit platforms for GCC & Clang.\r\n* Eliminates default construction of `uint256` objects that are immediately overwritten by switching from `resize` to `reserve` + `push_back`.\r\n\r\n#### Memory Impact\r\n\r\n[Memory profiling](https://github.com/bitcoin/bitcoin/pull/32497#issuecomment-3563724551) shows **50% reduction in peak allocation** (576KB → 288KB) and elimination of reallocation overhead.\r\n\r\n#### Validation\r\n\r\nThe benchmark was updated to use an odd leaf count to demonstrate the real-world scenario where the reallocation occurs.\r\n\r\nA full `-reindex-chainstate` up to block **896 408** ran without triggering the asserts.\r\n\r\n<details>\r\n<summary>Validation asserts</summary>\r\n\r\nTemporary asserts (not included in this PR) confirm that `push_back` never reallocates and that the coinbase witness hash remains null:\r\n```cpp\r\nif (hashes.size() & 1) {\r\n    assert(hashes.size() < hashes.capacity()); // TODO remove\r\n    hashes.push_back(hashes.back());\r\n}\r\n\r\nleaves.reserve((block.vtx.size() + 1) & ~1ULL); // capacity rounded up to even\r\nleaves.emplace_back();\r\nassert(leaves.back().IsNull()); // TODO remove\r\n```\r\n\r\n</details>\r\n\r\n#### Benchmark Performance\r\n\r\nWhile the main purpose is to improve predictability, the reduced memory operations also improve hashing throughput slightly.\r\n",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2025-05-14T13:01:42Z",
      "updated_at": "2026-01-21T22:31:40Z",
      "merged_at": "2026-01-20T23:47:26Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32497",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2169,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3167650906,
      "number": 34269,
      "title": "wallet: disallow creating new or restoring to an unnamed (default) wallet",
      "body": "We've been moving in the direction that all wallets must have a name. Therefore, we shouldn't allow creating new unnamed wallets. `createwallet`, `restorewallet`, and the wallet tool's `create` and `createfromdump` all now require the user to provide a non-empty wallet name when creating/restoring a wallet.\r\n\r\nThe GUI is already enforcing this, but we were not enforcing it for RPCs or in the underlying `CreateWallet` and `RestoreWallet` functions.\r\n\r\nWallet migration does still need to be able to restore unnamed wallets, so there is a new argument to `RestoreWallet` to explicitly allow that behavior for migration only.",
      "state": "closed",
      "user": "achow101",
      "created_at": "2026-01-12T23:39:06Z",
      "updated_at": "2026-01-21T21:57:14Z",
      "merged_at": "2026-01-21T21:57:14Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34269",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 700,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3191565524,
      "number": 34353,
      "title": "refactor: Use std::bind_front over std::bind",
      "body": "`std::bind` has many issues:\r\n\r\n* It is verbosely listing all placeholders, but in a meaningless way, because it doesn't name the args or their types.\r\n* It silently ignores args passed to it, when one arg is overridden. For example [1] compiles fine on current master.\r\n* Accidentally duplicated placeholders compile fine as well.\r\n* Usually the placeholders aren't even needed.\r\n* This makes it hard to review, understand, and maintain.\r\n\r\nFix all issues by using `std::bind_front` from C++20, which allows to drop the brittle `_1, _2, ...` placeholders. The replacement should be correct, if the trailing placeholders are ordered.\r\n\r\nIntroducing the same silent bug on top of this pull request [2] will now lead to a compile failure.\r\n\r\n----\r\n\r\n[1]\r\n\r\n```diff\r\ndiff --git a/src/qt/walletmodel.cpp b/src/qt/walletmodel.cpp\r\nindex 694fb535b5..7661dd361e 100644\r\n--- a/src/qt/walletmodel.cpp\r\n+++ b/src/qt/walletmodel.cpp\r\n@@ -412,3 +412,3 @@ void WalletModel::subscribeToCoreSignals()\r\n     m_handler_status_changed = m_wallet->handleStatusChanged(std::bind(&NotifyKeyStoreStatusChanged, this));\r\n-    m_handler_address_book_changed = m_wallet->handleAddressBookChanged(std::bind(NotifyAddressBookChanged, this, std::placeholders::_1, std::placeholders::_2, std::placeholders::_3, std::placeholders::_4, std::placeholders::_5));\r\n+    m_handler_address_book_changed = m_wallet->handleAddressBookChanged(std::bind(NotifyAddressBookChanged, this, CTxDestination{}, std::placeholders::_2, std::placeholders::_3, std::placeholders::_4, std::placeholders::_5));\r\n     m_handler_transaction_changed = m_wallet->handleTransactionChanged(std::bind(NotifyTransactionChanged, this, std::placeholders::_1, std::placeholders::_2)); \r\n```\r\n\r\n[2]\r\n\r\n```diff\r\ndiff --git a/src/qt/walletmodel.cpp b/src/qt/walletmodel.cpp\r\nindex 578713c0ab..84cced741c 100644\r\n--- a/src/qt/walletmodel.cpp\r\n+++ b/src/qt/walletmodel.cpp\r\n@@ -412,3 +412,3 @@ void WalletModel::subscribeToCoreSignals()\r\n     m_handler_status_changed = m_wallet->handleStatusChanged(std::bind_front(&NotifyKeyStoreStatusChanged, this));\r\n-    m_handler_address_book_changed = m_wallet->handleAddressBookChanged(std::bind_front(NotifyAddressBookChanged, this));\r\n+    m_handler_address_book_changed = m_wallet->handleAddressBookChanged(std::bind_front(NotifyAddressBookChanged, this, CTxDestination{}));\r\n     m_handler_transaction_changed = m_wallet->handleTransactionChanged(std::bind_front(NotifyTransactionChanged, this));\r\n",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-20T14:48:59Z",
      "updated_at": "2026-01-21T18:17:09Z",
      "merged_at": "2026-01-21T14:59:37Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34353",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2520,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3195680966,
      "number": 34369,
      "title": "test: Scale NetworkThread close timeout with timeout_factor",
      "body": "Not sure if this fixes https://github.com/bitcoin/bitcoin/issues/34248, but scaling here probably makes sense, considering some CI setups run in nested VMs with a different arch system-qemu.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-21T15:22:24Z",
      "updated_at": "2026-01-21T18:16:40Z",
      "merged_at": "2026-01-21T16:42:26Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34369",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 250,
        "has_nack": false,
        "has_ack": false
      }
    }
  ],
  "issues": [
    {
      "id": 1313658734,
      "number": 25669,
      "title": "`externalip=...onion` ignored when onion/prox not set",
      "body": "My bitcoin.conf says `externalip=....onion` (among a few other IPs) but `localaddresses` in `getnetworkinfo` only lists the non-onion IPs. I assume this may (or may not) have to do with the fact that no `onion`/`proxy` is configured - the node doesn't have the ability to make outbound tor connections, but that doesn't mean anything for inbound onion connections.",
      "state": "open",
      "user": "TheBlueMatt",
      "created_at": "2022-07-21T18:43:24Z",
      "updated_at": "2026-01-28T14:04:57Z",
      "closed_at": null,
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/25669",
      "labels": [
        "Bug"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 418,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3765907820,
      "number": 34163,
      "title": "qa: Framework fails when initiating node from cached chain",
      "body": "Consider the following MRE:\n```\n#!/usr/bin/env python3\n# File: test/functional/MRE.py\n\nfrom test_framework.test_framework import BitcoinTestFramework\n\nclass MRE(BitcoinTestFramework):\n    def set_test_params(self):\n        self.num_nodes = 1\n        self.setup_clean_chain = False  # Test succeeds when True.\n\n    def skip_test_if_missing_module(self):\n        self.skip_if_no_wallet()\n\n    def run_test(self):\n        self.log.info(\"OK\")\n\nif __name__ == '__main__':\n    MRE(__file__).main()\n```\n\nOn OpenIndiana:\n```\n$ $ env CXXFLAGS=\"-pthread\" cmake -B build -DENABLE_IPC=OFF\n$ cmake --build build\n$ python3.14 ./build/test/functional/MRE.py \n2025-12-28T17:43:24.329616Z TestFramework (INFO): PRNG seed is: 2377333319933758475\n2025-12-28T17:43:24.331825Z TestFramework (INFO): Initializing test directory /tmp/bitcoin_func_test_f81ll6fk\n2025-12-28T17:43:24.627126Z TestFramework (ERROR): Unexpected exception\nTraceback (most recent call last):\n  File \"/export/home/hebasto/dev/bitcoin/test/functional/test_framework/test_framework.py\", line 138, in main\n    self.setup()\n    ~~~~~~~~~~^^\n  File \"/export/home/hebasto/dev/bitcoin/test/functional/test_framework/test_framework.py\", line 269, in setup\n    self.setup_network()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"/export/home/hebasto/dev/bitcoin/test/functional/test_framework/test_framework.py\", line 360, in setup_network\n    self.setup_nodes()\n    ~~~~~~~~~~~~~~~~^^\n  File \"/export/home/hebasto/dev/bitcoin/test/functional/test_framework/test_framework.py\", line 384, in setup_nodes\n    self.import_deterministic_coinbase_privkeys()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/export/home/hebasto/dev/bitcoin/test/functional/test_framework/test_framework.py\", line 401, in import_deterministic_coinbase_privkeys\n    self.init_wallet(node=i)\n    ~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/export/home/hebasto/dev/bitcoin/test/functional/test_framework/test_framework.py\", line 408, in init_wallet\n    n.createwallet(wallet_name=wallet_name, load_on_startup=True)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/export/home/hebasto/dev/bitcoin/test/functional/test_framework/coverage.py\", line 50, in __call__\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\n  File \"/export/home/hebasto/dev/bitcoin/test/functional/test_framework/authproxy.py\", line 156, in __call__\n    raise JSONRPCException(response['error'], status)\ntest_framework.authproxy.JSONRPCException: Wallet file verification failed. SQLiteDatabase: Failed to open database: unable to open database file\n (-4)\n2025-12-28T17:43:24.682846Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n2025-12-28T17:43:24.683153Z TestFramework (WARNING): Not cleaning up dir /tmp/bitcoin_func_test_f81ll6fk\n2025-12-28T17:43:24.683377Z TestFramework (ERROR): Test failed. Test logging available at /tmp/bitcoin_func_test_f81ll6fk/test_framework.log\n2025-12-28T17:43:24.684155Z TestFramework (ERROR): \n2025-12-28T17:43:24.684615Z TestFramework (ERROR): Hint: Call /export/home/hebasto/dev/bitcoin/test/functional/combine_logs.py '/tmp/bitcoin_func_test_f81ll6fk' to consolidate all logs\n2025-12-28T17:43:24.684729Z TestFramework (ERROR): \n2025-12-28T17:43:24.684901Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\n2025-12-28T17:43:24.685270Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\n2025-12-28T17:43:24.685378Z TestFramework (ERROR): \n[node 0] Cleaning up leftover process\n```",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-12-28T18:45:59Z",
      "updated_at": "2026-01-28T14:02:58Z",
      "closed_at": null,
      "comments": 14,
      "url": "https://github.com/bitcoin/bitcoin/issues/34163",
      "labels": [
        "Wallet",
        "Tests",
        "Upstream"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3671,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3737265193,
      "number": 34086,
      "title": "doc: Use multi-path descriptors in descriptors.md and linked tests.",
      "body": "### Motivation\n\nA single multipath descriptor is the most convenient pattern for multisig; our documentation should use it.\n\nThese files should use multipath descriptors as per https://github.com/bitcoin/bitcoin/commit/2a46e94a1600a4f28e01db23a89f039acaa2c45e and https://github.com/bitcoin/bitcoin/pull/33286:\n\n**Locations:**\n- [ ] [doc/descriptors.md](https://github.com/bitcoin/bitcoin/tree/master/doc/descriptors.md):\n  - [ ] \"Basic Multisig Example\"\n  - [ ] \"Examples\" with this text:\n    > For brevity, the internal \"change\" descriptor accompanying the above external \"receiving\" descriptor is not included here, but it typically differs only in the xpub derivation steps, ending in /1/* for change addresses. \n- [ ] [wallet_miniscript_decaying_multisig_descriptor_psbt.py](https://github.com/bitcoin/bitcoin/tree/master/test/functional/wallet_miniscript_decaying_multisig_descriptor_psbt.py) functional test\n\n### Possible solution\n\nThis only requires familiarity with multi-path descriptor semantics to solve. See [Specifying receiving and change descriptors in one descriptor](https://github.com/bitcoin/bitcoin/blob/master/doc/descriptors.md#specifying-receiving-and-change-descriptors-in-one-descriptor) for how to update `desciptors.md` and #33286's [functional test diff](https://github.com/bitcoin/bitcoin/pull/33286/changes#diff-94f52fa5de899f58d07aca5026545378bc3da616d4927d71435fa0224eda589b) for an approach to solve this issue in the functional test.\n\n\n### Useful Skills\n\n* Understanding of multi-path descriptor semantics\n* Running the Python functional tests\n* Basic Python\n\n### Guidance for new contributors\n\nWant to work on this issue?\n\nFor guidance on contributing, please read [CONTRIBUTING.md](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md) before opening your pull request.\n",
      "state": "open",
      "user": "BenWestgate",
      "created_at": "2025-12-17T04:16:29Z",
      "updated_at": "2026-01-28T14:01:46Z",
      "closed_at": null,
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/34086",
      "labels": [
        "good first issue"
      ],
      "comment_data": [
        {
          "id": 3811393360,
          "user": "Heiwabit",
          "body": "I added the word 'Bitcoin' in the White Paper of the blockchain I created (https://github.com/Heiwabit/BriXNetworkWhitepaper.git\n) to show it’s based on Bitcoin’s libraries. The full system is ready to lunch and it will launch soon. Cheers ",
          "created_at": "2026-01-28T13:45:43Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 240,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1885,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3826722076,
      "number": 34331,
      "title": "qa: Failure in `p2p_fingerprint.py`",
      "body": "On FreeBSD 15.0, https://github.com/hebasto/bitcoin-core-nightly/actions/runs/21105606197/job/60696569283:\n```\n386/456 - p2p_fingerprint.py failed, Duration: 0 s\n\nstdout:\n2026-01-18T04:34:49.101209Z TestFramework (INFO): PRNG seed is: 4679507874993432966\n2026-01-18T04:34:49.102528Z TestFramework (INFO): Initializing test directory /tmp/test_runner_₿_🏃_20260118_042715/p2p_fingerprint_63\n2026-01-18T04:34:49.360239Z TestFramework (ERROR): Unexpected exception\nTraceback (most recent call last):\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 138, in main\n    self.setup()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 269, in setup\n    self.setup_network()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 360, in setup_network\n    self.setup_nodes()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 382, in setup_nodes\n    self.start_nodes()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 528, in start_nodes\n    node.wait_for_rpc_connection()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_node.py\", line 316, in wait_for_rpc_connection\n    raise FailedToStartError(self._node_msg(\ntest_framework.test_node.FailedToStartError: [node 0] bitcoind exited with status 1 during initialization. Error: Unable to bind to 127.0.0.1:11756 on this computer. Bitcoin Core is probably already running.\nError: Failed to listen on any port. Use -listen=0 if you want this.\n************************\n\n2026-01-18T04:34:49.423831Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n2026-01-18T04:34:49.424142Z TestFramework (WARNING): Not cleaning up dir /tmp/test_runner_₿_🏃_20260118_042715/p2p_fingerprint_63\n2026-01-18T04:34:49.424336Z TestFramework (ERROR): Test failed. Test logging available at /tmp/test_runner_₿_🏃_20260118_042715/p2p_fingerprint_63/test_framework.log\n2026-01-18T04:34:49.424671Z TestFramework (ERROR): \n2026-01-18T04:34:49.425017Z TestFramework (ERROR): Hint: Call /home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/combine_logs.py '/tmp/test_runner_₿_🏃_20260118_042715/p2p_fingerprint_63' to consolidate all logs\n2026-01-18T04:34:49.425220Z TestFramework (ERROR): \n2026-01-18T04:34:49.425516Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\n2026-01-18T04:34:49.425685Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\n2026-01-18T04:34:49.425795Z TestFramework (ERROR): \n\n\n```",
      "state": "open",
      "user": "hebasto",
      "created_at": "2026-01-18T12:22:44Z",
      "updated_at": "2026-01-28T13:59:23Z",
      "closed_at": null,
      "comments": 11,
      "url": "https://github.com/bitcoin/bitcoin/issues/34331",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "comment_data": [
        {
          "id": 3806652576,
          "user": "hebasto",
          "body": "Another [test](https://github.com/hebasto/bitcoin-core-nightly/actions/runs/21105606197/job/60696569283) resulted in seemingly the same error.\n```\n386/456 - p2p_fingerprint.py failed, Duration: 0 s\n\nstdout:\n2026-01-18T04:34:49.101209Z TestFramework (INFO): PRNG seed is: 4679507874993432966\n2026-01-18T04:34:49.102528Z TestFramework (INFO): Initializing test directory /tmp/test_runner_₿_🏃_20260118_042715/p2p_fingerprint_63\n2026-01-18T04:34:49.360239Z TestFramework (ERROR): Unexpected exception\nTraceback (most recent call last):\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 138, in main\n    self.setup()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 269, in setup\n    self.setup_network()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 360, in setup_network\n    self.setup_nodes()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 382, in setup_nodes\n    self.start_nodes()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 528, in start_nodes\n    node.wait_for_rpc_connection()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_node.py\", line 316, in wait_for_rpc_connection\n    raise FailedToStartError(self._node_msg(\ntest_framework.test_node.FailedToStartError: [node 0] bitcoind exited with status 1 during initialization. Error: Unable to bind to 127.0.0.1:11756 on this computer. Bitcoin Core is probably already running.\nError: Failed to listen on any port. Use -listen=0 if you want this.\n************************\n\n2026-01-18T04:34:49.423831Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n2026-01-18T04:34:49.424142Z TestFramework (WARNING): Not cleaning up dir /tmp/test_runner_₿_🏃_20260118_042715/p2p_fingerprint_63\n2026-01-18T04:34:49.424336Z TestFramework (ERROR): Test failed. Test logging available at /tmp/test_runner_₿_🏃_20260118_042715/p2p_fingerprint_63/test_framework.log\n2026-01-18T04:34:49.424671Z TestFramework (ERROR): \n2026-01-18T04:34:49.425017Z TestFramework (ERROR): Hint: Call /home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/combine_logs.py '/tmp/test_runner_₿_🏃_20260118_042715/p2p_fingerprint_63' to consolidate all logs\n2026-01-18T04:34:49.425220Z TestFramework (ERROR): \n2026-01-18T04:34:49.425516Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\n2026-01-18T04:34:49.425685Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\n2026-01-18T04:34:49.425795Z TestFramework (ERROR): \n\n\n```",
          "created_at": "2026-01-27T17:58:30Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 2957,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3806668247,
          "user": "w0xlt",
          "body": "With or without https://github.com/bitcoin/bitcoin/pull/34346 ?",
          "created_at": "2026-01-27T18:01:39Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 63,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3806686589,
          "user": "hebasto",
          "body": "> With or without [#34346](https://github.com/bitcoin/bitcoin/pull/34346) ?\n\nThe master branch.",
          "created_at": "2026-01-27T18:04:57Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 95,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2957,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3864972233,
      "number": 34428,
      "title": "ci: iwyu task fails when run in a worktree",
      "body": "(I don't need this, but maybe someone else does?)\n\nJust wanted to note that the iwyu task is known to not work in a worktree. It fails with:\n\n```\n...\nIWYU edited 0 files on your behalf.\n\n+ git diff -U0\n+ ./contrib/devtools/clang-format-diff.py -binary=clang-format-21 -p1 -i -v\nfatal: not a git repository: /home/runner/work/bitcoin-core-with-ci/bitcoin-core-with-ci/.git/worktrees/ci-matrix-worktree\n+ git --no-pager diff --exit-code\nfatal: not a git repository: /home/runner/work/bitcoin-core-with-ci/bitcoin-core-with-ci/.git/worktrees/ci-matrix-worktree\n+ echo '^^^ ⚠️ Failure generated from IWYU'\n+ false\n^^^ ⚠️ Failure generated from IWYU\nCommand '['docker', 'exec', 'ebf1d1ae7dd7efd91962e3363c2859da5fc8a5061655d95b9fd90a2b51929fd1', '/home/runner/work/_temp/ci/test/03_test_script.sh']' returned non-zero exit status 1.\n```\n\nTested with a hacky diff like:\n\n```diff\ndiff --git a/.github/actions/configure-environment/action.yml b/.github/actions/configure-environment/action.yml\nindex e2a26b7184..df2a6aae28 100644\n--- a/.github/actions/configure-environment/action.yml\n+++ b/.github/actions/configure-environment/action.yml\n@@ -19,2 +19,3 @@ runs:\n       run: |\n+        cd ../ci-matrix-worktree\n         echo \"DEPENDS_HASH=$(git ls-tree HEAD depends \"$FILE_ENV\" | sha256sum | cut -d' ' -f1)\" >> $GITHUB_ENV\n@@ -25,2 +26,3 @@ runs:\n       run: |\n+        cd ../ci-matrix-worktree\n         source $FILE_ENV\ndiff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml\nindex bbac5e023c..afb51b99e2 100644\n--- a/.github/workflows/ci.yml\n+++ b/.github/workflows/ci.yml\n@@ -626,2 +626,6 @@ jobs:\n       - *CHECKOUT\n+      \n+      - name: Worktree add\n+        run: |\n+          git worktree add ../ci-matrix-worktree HEAD\n \n@@ -655,3 +659,5 @@ jobs:\n       - name: CI script\n-        run: ./ci/test_run_all.sh\n+        run: |\n+          cd ../ci-matrix-worktree  # cd required :(\n+          ./ci/test_run_all.sh\n \n",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-28T11:31:37Z",
      "updated_at": "2026-01-28T12:34:32Z",
      "closed_at": null,
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/34428",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 1964,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3515047935,
      "number": 33628,
      "title": "Minor Release 29.3",
      "body": "🚧 Milestone: https://github.com/bitcoin/bitcoin/milestone/80\n\nBackports and other changes\n- #33623\n- #33611\n- #34222\n- #33788\n- #34268\n- https://github.com/bitcoin/bitcoin/pull/34370\n\n\nRC 1\n- [x] final changes #34268\n- [x] tag\n- [] upload binaries\n- [] announcements\n\n\nSee [release process docs](https://github.com/bitcoin/bitcoin/blob/master/doc/release-process.md) for more details. This issue can be used to track status updates. Please feel free to suggest backports in the comments.",
      "state": "open",
      "user": "glozow",
      "created_at": "2025-10-14T18:35:27Z",
      "updated_at": "2026-01-28T09:58:21Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/33628",
      "labels": [
        "Tracking Issue"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 506,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2265800207,
      "number": 29972,
      "title": "qa: Support git worktrees when running the linters locally via Docker",
      "body": "I discovered that running this command (from `test/lint/README.md`):\r\n```\r\nDOCKER_BUILDKIT=1 docker build -t bitcoin-linter --file \"./ci/lint_imagefile\" ./ && docker run --rm -v $(pwd):/bitcoin -it bitcoin-linter\r\n```\r\ndoesn't work when trying to run it out of a git worktree:\r\n```\r\nfatal: not a git repository: /home/sdaftuar/bitcoin/.git/worktrees/2024-04-cluster-mempool-txgraph-rebased\r\n```\r\n (Though it did work for me when I tried checking out my branch in a regular git repo).  \r\n\r\nI don't know anything about these scripts, but if there's an easy way to support worktrees I think it would be useful!",
      "state": "closed",
      "user": "sdaftuar",
      "created_at": "2024-04-26T13:32:11Z",
      "updated_at": "2026-01-28T09:51:25Z",
      "closed_at": "2026-01-28T09:51:25Z",
      "comments": 12,
      "url": "https://github.com/bitcoin/bitcoin/issues/29972",
      "labels": [
        "Feature",
        "Tests"
      ],
      "comment_data": [
        {
          "id": 3783284789,
          "user": "Sjors",
          "body": "A tangential problem I often run into is that I use symlinks, e.g. `releases` points to a folder that has the previous release binaries (so I don't accidentally wipe them).\n\nPresumably both issues can be solved by copying things into a (temporary) volume?",
          "created_at": "2026-01-22T09:00:28Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 255,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 677,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3629644627,
      "number": 33882,
      "title": "Standardness policy rules for legacy Multisig script is incoherent",
      "body": "Over the years policy surrounding multisig scripts, particularly for legacy multisig scripts, has evolved in a haphazard way with various PRs affecting  legacy multisig script policy without considering the ramifications.\n\nThe current status of legacy multisig script policy is as follows:\n\n* Legacy multisig outputs in transactions can be at most *m*-of-3.  All pubkeys in such outputs must be of the form of a compressed pubkey, or uncompressed pubkey, or a hybrid pubkey.\n* Legacy multisig inputs being redeemed in transaction can be *m*-of-*n* with *m* and *n* 20 or less.  Any public keys processed by OP_CHECKMULTISIG must be compressed or uncompressed pubkeys.  hybrid or other data blobs are only allowed in the unprocessed part of the public key list.\n\nWhile it is acceptable for legacy multisig output creation policy to be stricter than redemption policy, it makes no sense to allow hybrid keys in outputs by policy, but then to disallow them as inputs by policy.\n\nHowever, there are further issues. Legacy multisig policy has evolved over time.  In the beginning when legacy multisig outputs were introduced as standard by BIP 11, \"pubkeys\" were allowed by policy to be any value between 33 and 120 bytes.  Some Bitcoin users have taken advantage of those liberal policies and created legacy multisig script UTXOs that were redeemable by policy at the time they were created, but are no longer redeemable by policy today.  The UTXO 4dacd03d73cb497229dbfe2e7209adc4221540efe0e4c57f408b09b2fd36ece6:1 from 2014-01-12 is but one example.  @ajtowns's analysis in #33755 suggests there are at least 147,470 such UTXOs that have become *soft-confiscated* over time, meaning that when they were created they were redeemable by policy, but become no longer redeemable by policy and would require direct miner assistance to be spent.\n\nBased on my research, I believe there are 4 tasks that need to be done to make legacy Multisig policy coherent again.\n\n### 1. Ban hybrid keys in legacy outputs\n\nWe should strengthen the rules surrounding creating legacy multisig (and legacy single sig) to ban the use of hybrid keys.  Such keys are nearly irredeemable.  However, we should only strengthen policy around the creating new legacy script outputs without further restricting policy around redeeming legacy script UTXOs.\n\n### 2. Bring legacy script redemption policy in line with P2SH redeem script policy.\n\nP2SH redeem script policy has also evolved over time.  Current policy for P2SH redemption allow any scripts so long as they have a limited number of CHECKSIG related operations.  I see no reason why legacy script should be subject to significantly more stringent constraints than P2SH redeem scripts are.\n\n### 3. Relax `SCRIPT_VERIFY_STRICTENC` policy to only ban hybrid keys.\n\nPR #5247 went unnecessarily overboard in its quest to stomp out uses of hybrid keys and made UTXOs that already existed at the time unspendable.  PR #33755 partially reverts this change so that only hybrid keys are excluded from processing in  CHECKMULTISIG.\n\n### 4. Bring `SCRIPT_VERIFY_WITNESS_PUBKEYTYPE` policy in line with BIP 143 requirements.\n\nThis task is technically unrelated to legacy multisig policy, being instead about Segwit V0 multisig policy.  However the policy implemented in Bitcoin Core does not match the policy stated in BIP 143, and they ought to be brought into agreement. Either by implementing the policy correctly (as #33759 does), or by amending BIP 143 to describe the current policy as implemented.\n\nIn particular, both tasks 2 and 3 need to be completed in order to make stuck UTXOs, such as 4dacd03d73cb497229dbfe2e7209adc4221540efe0e4c57f408b09b2fd36ece6:1 spendable by policy again.\n\nI want to make it clear that UTXOs such as the above are not particularly abusive.  They were simply caught up incidentally in the policy changes of PR #5247, which was only about banning the use of hybrid keys.  4dacd03d73cb497229dbfe2e7209adc4221540efe0e4c57f408b09b2fd36ece6:1 has no hybrid nor hybrid looking pubkeys in it.\n\n```\t\nOP_PUSHNUM_1\nOP_PUSHBYTES_33 035bceeb417f25beaa28d133ee7b28faa1e4f5c2f76b8daf12c3fab18261718790\nOP_PUSHBYTES_33 1c434e545250525459000000000000000000000001000000004190ab0000000000\nOP_PUSHNUM_2\nOP_CHECKMULTISIG\n```\n*The script from UTXO 4dacd03d73cb497229dbfe2e7209adc4221540efe0e4c57f408b09b2fd36ece6:1*",
      "state": "open",
      "user": "roconnor-blockstream",
      "created_at": "2025-11-16T02:09:46Z",
      "updated_at": "2026-01-28T00:20:33Z",
      "closed_at": null,
      "comments": 23,
      "url": "https://github.com/bitcoin/bitcoin/issues/33882",
      "labels": [
        "Brainstorming",
        "TX fees and policy"
      ],
      "comment_data": [
        {
          "id": 3781700801,
          "user": "151henry151",
          "body": "@ajtowns I guess my language there was not very clear, sorry about that. My confusion was simply about this line of your previous reply:\n\n> It would probably be good if someone ran a reindex with **both the current and proposed policies** for non-compressed keys in p2wsh enforced as a consensus rule, to see if there are any transactions in the blockchain violating those rules\n\nI am running a reindex to determine whether any existing transactions violate the proposed policy, but was just confused about the idea of checking to see if any transactions violate the **existing** policy. I understand some UTXOs are soft confiscated by the current policy, but thought it would be impossible for a transaction to be confirmed on the blockchain and yet also in violation of the current policy. I just want to be sure I'm understanding everything to the best of my ability. ",
          "created_at": "2026-01-21T23:53:01Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 871,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3782320432,
          "user": "ajtowns",
          "body": "If some miners accepted txs out of band and didn't enforce the policy specified by BIP143, there might by confirmed txs in the blockchain that violate the existing policy.",
          "created_at": "2026-01-22T03:24:15Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 171,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3782344464,
          "user": "151henry151",
          "body": "Ah, I see now. Thanks for explaining. My workstation is slow and old, so I'm only 65% through the reindex with the changed policy, but when I'm finished with that I'll check with current policy as well and share my results (and methodology) for review.",
          "created_at": "2026-01-22T03:35:46Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 252,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3802171234,
          "user": "151henry151",
          "body": "@ajtowns I've completed a reindex checking with the changed policy; I found no transactions violate it.\n\nModified `src/validation.cpp` at line 2314 in `GetBlockScriptFlags()` to enforce `SCRIPT_VERIFY_WITNESS_PUBKEYTYPE` as a consensus rule after segwit activation by adding `if (DeploymentActiveAt(block_index, chainman, Consensus::DEPLOYMENT_SEGWIT)) { flags |= SCRIPT_VERIFY_WITNESS_PUBKEYTYPE; }`. Built Bitcoin Core with this modification, configured pruning (`prune=55000`), ran a full reindex, and monitored `debug.log` for consensus failures (`WITNESS_PUBKEYTYPE`, `block-script-verify-flag-failed`, `bad-blk-sigops`, `BLOCK_CONSENSUS`). The reindex completed successfully, validating all 933,906 blocks with zero consensus errors, confirming no historical blocks violate this rule when enforced as consensus.\n\nFor good measure, I'm now running a reindex with current policy checking for the same.",
          "created_at": "2026-01-26T23:02:30Z",
          "drama_signals": {
            "drama_keywords": 2,
            "positive_keywords": 0,
            "text_length": 905,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3804251272,
          "user": "ajtowns",
          "body": "Hmm, this would need `assumevalid=0` as well, no?",
          "created_at": "2026-01-27T10:04:00Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 49,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3808243547,
          "user": "151henry151",
          "body": "> Hmm, this would need `assumevalid=0` as well, no?\n\nYou're correct, my mistake. I'm performing the reindex again. Thanks",
          "created_at": "2026-01-28T00:20:33Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 121,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 4407,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3723882082,
      "number": 34062,
      "title": "RFC: separate kernel logging infrastructure",
      "body": "tl;dr: kernel logging is cumbersome. I propose we layer logging so we can enable structured logging and a much simplified kernel logging interface without overcomplicating node logging.\n\n## Motivation\n\nThe `bitcoinkernel` library (#27587) [exposes](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L698-L778) functionality to interface with the kernel logging. This includes registering callbacks for log statements, level/category filtering, string formatting options, and more.\n\nKernel logging has a few problems:\n- **P1**: [callbacks](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L304) operate on formatted strings, so users need to parse the string to get the timestamp, category, level, ... based on which options are set. This is cumbersome, brittle, and inefficient.\n- **P2**: the [filtering interface](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L737) is not really intuitive, requiring users to call combinations of `btck_logging_set_level_category` and `btck_logging_enable_category` when they want to produce `debug` or `trace` logs. The level/category system makes sense for node, because it directly controls what gets written to disk and stdout, and there are quite a lot more categories producing logs. Kernel doesn't really need this - users control what happens to the logs, and can do any filtering/manipulation in the callback they provide.\n- **P3**: the node logging infrastructure has quite a bit more functionality than is necessary for a library, including ratelimiting, log formatting, outputting, buffering, ... This introduces unnecessary code and interface complexity.\n\n\n## Approach\n\nI propose we address problems P1, P2 and P3 by layering the logging infrastructure. Roughly, this would mean:\n1. Implement a minimal `util::log::Logger` class (see [Appendix](#Appendix)) that dispatches structured log entries to registered callbacks. This is a low-level logger that does not perform formatting, rate limiting, or category filtering - it simply dispatches to callbacks.\n2. Refactor `BCLog::Logger` into `BCLog::Sink`, which registers a callback on `util::log::GetLogger()` and handles all node-specific functionality (category filtering, rate limiting, file output, formatting, ...).\n3. Update kernel code to include `util/log.h` instead of `logging.h`. The existing logging macros (`LogInfo`, `LogDebug`, etc.) continue to work unchanged.\n4. Simplify `bitcoinkernel` C API to reflect the simpler `util::log::Logger` interface (structured logging, level-based, ...), we can now completely remove `btck_LoggingOptions`.\n5. Remove `logging.h` and `logging.cpp` from the kernel library completely.\n\n## Balance\n\nThe main benefits and downsides of this approach:\n\n**Benefits:**\n- **B1:** a kernel-native structured logging interface that minimizes complexity and makes for a much more ergonomic interface, enabling structured logging instead of string parsing.\n- **B2:** doesn't complicate node logging purely for the purpose of accommodating diverging requirements for kernel. For example, I suspect projects like #30342 should be much easier with layered kernel logging.\n- **B3:** reduces friction if/when node migrates to use the public `bitcoinkernel` interface by having already completely decoupled logging.\n- ... (what have I missed?)\n\n**Downsides:**\n- **D1:** levels-based filtering has some performance overhead by formatting all (kernel) debug log strings instead of just the subset of categories specified. Note that this _only_ applies when debug is enabled, and that kernel has a lot less logging than node.\n- ... (what have I missed?)\n\n## Scope\n\nI have implemented this approach in https://github.com/bitcoin/bitcoin/compare/master...stickies-v:bitcoin:2025-12/kernel-logging-layering. Most of the changes are quite straightforward, including refactoring `BCLog::Logger` to `BCLog::Sink`, adding tests, and adding a `util::log::Logger` interface.\n\n## Appendix\n\n### Interfaces\n#### util::log::Logger\n\n```cpp\nclass Logger\n{\npublic:\n    using Callback = std::function<void(const Entry&)>;\n    using CallbackHandle = std::list<Callback>::iterator;\n\n    //! Register a callback to receive log entries. Returns a handle for unregistration.\n    [[nodiscard]] CallbackHandle RegisterCallback(Callback callback);\n\n    //! Unregister a previously registered callback.\n    void UnregisterCallback(CallbackHandle handle);\n\n    //! Set the minimum log level. Messages below this level are discarded.\n    void SetMinLevel(Level level);\n\n    //! Get the current minimum log level.\n    Level GetMinLevel() const;\n\n    //! Returns true if a message at the given level would be logged.\n    bool WillLog(Level level) const;\n\n    //! Returns true if any callbacks are registered.\n    bool Enabled() const;\n\n    //! Format message and dispatch to all registered callbacks. No-op if minimum log level not met.\n    template <typename... Args>\n    void Log(Level level, uint64_t category, std::source_location loc, bool should_ratelimit,\n             util::ConstevalFormatString<sizeof...(Args)> fmt, const Args&... args);\n};\n```\n\n#### `bitcoinkernel` C logging interface\n\n```c\ntypedef void (*btck_LogCallback)(void* user_data, const btck_LogEntry* entry);\n\nstruct btck_LogEntry {\n    const char* message;       //!< Log message\n    size_t message_len;        //!< Log message length\n    const char* file_name;     //!< Source file name\n    size_t file_name_len;      //!< Source file name length\n    const char* function_name; //!< Source function name\n    size_t function_name_len;  //!< Source function name length\n    const char* thread_name;   //!< Thread name\n    size_t thread_name_len;    //!< Thread name length\n    int64_t timestamp_ns;      //!< Timestamp in nanoseconds since epoch\n    uint32_t line;             //!< Source line number\n    btck_LogLevel level;       //!< Log level\n    btck_LogCategory category; //!< Log category\n};\n\nBITCOINKERNEL_API void btck_logging_set_min_level(btck_LogLevel level);\n\nBITCOINKERNEL_API btck_LoggingConnection* BITCOINKERNEL_WARN_UNUSED_RESULT btck_logging_connection_create(\n    btck_LogCallback log_callback,\n    void* user_data,\n    btck_DestroyCallback user_data_destroy_callback) BITCOINKERNEL_ARG_NONNULL(1);\n\nBITCOINKERNEL_API void btck_logging_connection_destroy(btck_LoggingConnection* logging_connection);\n```\n",
      "state": "open",
      "user": "stickies-v",
      "created_at": "2025-12-12T15:43:10Z",
      "updated_at": "2026-01-27T20:54:50Z",
      "closed_at": null,
      "comments": 15,
      "url": "https://github.com/bitcoin/bitcoin/issues/34062",
      "labels": [
        "Brainstorming",
        "Utils/log/libs"
      ],
      "comment_data": [
        {
          "id": 3780922349,
          "user": "stickies-v",
          "body": "I've now opened https://github.com/bitcoin/bitcoin/pull/34374 to address this issue. Compared to the [previous approach](https://github.com/bitcoin/bitcoin/issues/34062#issuecomment-3667169341), the main changes are:\n- `Dispatcher` (previously `util::log::Logger`) is now instantiated with a `FilterFunc filter` predicate, that enables `util` to remain oblivious to the `logging.h` level/category setting logic whilst still allowing log consumers (such as `BCLog::Logger`) to avoid overhead (e.g string formatting, lambda evaluation) when logs don't pass the filter. I think this should address @ajtowns' main outstanding [concern](https://github.com/bitcoin/bitcoin/issues/34062#issuecomment-3677360573)? It also avoids the need for `BCLog::Logger` to synchronize its minimum levels with `util::log::Dispatcher`'s minimum level, simplifying the implementation in some ways (but complicating it in others, e.g. requiring a new global `Dispatcher`).\n- rename `util::log::Logger` to `util::log::Dispatcher` so we can keep the `BCLog::Logger` name unchanged and minimize unnecessary code churn.\n\nI'd be grateful to hear your feedback on this new approach on the PR. Also thanks to @ryanofsky for giving me ideas (offline) to refine the approach.",
          "created_at": "2026-01-21T20:08:32Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 1242,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3803317605,
          "user": "purpleKarrot",
          "body": "The Kernel is not a service where multiple clients can connect to each with their own logger. Instead, it is a library that each client has unique control over. If clients want to write their logs to multiple places, they can do so with a single log handler. They  can decide whether and how they want to filter their log messages based on level, category and/or source location, as long as all this information is made available to them.\n\nI think the logging API after should be modelled after [set_terminate](https://en.cppreference.com/w/cpp/error/set_terminate.html) in the C++ standard library:\n\n```c\ntypedef void (*btck_LogHandler)(btck_LogEntry const* entry);\n\nBITCOINKERNEL_API btck_LogHandler btck_set_log(btck_LogHandler handler);\n```\n\nThat means:\n\n* A single log handler can be active at any given time.\n* Setting a new handler returns the previous one (which allows RAII style wrappers).\n* Logging can be reset to default by passing `NULL`.\n* C++ terminology is matched (terminate handler -> log handler, `set_terminate` -> `set_log`).",
          "created_at": "2026-01-27T06:17:20Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 1047,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3804580317,
          "user": "stickies-v",
          "body": "> They can decide whether and how they want to filter their log messages based on level, category and/or source location, as long as all this information is made available to them.\n\nClient-side filtering was a big driver behind my thinking too, but I also agree with @ajtowns's concerns about not incurring unnecessary overhead for logs that are later dropped. I don't think a user who's interested only in Info level logs should be forced to pay for all the (sometimes expensive, e.g. calculating memory usage) Debug and Trace statements that exist in the codebase. Also keep in mind that kernel and node share a lot of code, so we have to make sure changes make sense for all subsystems. This has led me to the approach adopted in #34374, where filtering is possible but it's entirely up to the client to implement it, so most of this complexity is kept out of kernel.\n\n> If clients want to write their logs to multiple places, they can do so with a single log handler. \n\nI agree. I don't see the need for more than a single connection per context, but I think supporting multiple logging contexts makes sense given our current context-aware interface.\n\n> A single log handler can be active at any given time.\n\nThere is an argument to be made for that approach, but I think it is awkward that some part of the interface is context-aware (e.g. ChainstateManager) and another part (e.g. logging) is global. I think, to keep the conversations somewhat focused, your thoughts on having a single handler might best be channeled to https://github.com/bitcoin/bitcoin/pull/30342 (and see also e.g. https://github.com/bitcoin/bitcoin/pull/30338 for a previous discussion)\n\n",
          "created_at": "2026-01-27T11:16:49Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 2,
            "text_length": 1667,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3806924598,
          "user": "purpleKarrot",
          "body": "> I think supporting multiple logging contexts makes sense\n\nMy point is that you have a single, global logging context with multiple dependent receivers.\n\nConsider the use case where a client wants to write info logs to the terminal and debug logs to a file. They can register two receivers, but setting the log level affects both, because both actually share the same single, global context.\n\n> it is awkward that some part of the interface is context-aware and another part (e.g. logging) is global.\n\nI find it more awkward that logging attempts to provide multiple \"connections\" to a single, global context.\n\nI see three valid approaches:\n\na) Support multiple *independent* receivers. Each receiver should respond to its own log level filtering.\nb) Embrace logs being global, with a single receiver and a single setting for log level filtering.\nc) Getting rid of global logging state. This is proposed in https://github.com/bitcoin/bitcoin/pull/30342\n\nThe current proposal seems to be a mix of a) and b), with multiple receivers that respond to a single, shared log level.",
          "created_at": "2026-01-27T18:52:47Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 1075,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3807307722,
          "user": "stickies-v",
          "body": "> I find it more awkward that logging attempts to provide multiple \"connections\" to a single, global context.\n\nI agree, but again, that's also the case on master, and not in scope for this proposal. Nothing changes here.\n\n> The current proposal seems to be a mix of a) and b)\n\nI disagree. The current proposal is orthogonal to the issue you're talking about here. The status quo on master is that we have a global logger, with a global config, and multiple connections that all hook into the same global logger. As far as I can tell, this proposal does not change anything about that. If you see it differently, can you point out what this proposal changes about the status quo wrt the global logger, its config and its connections?\n\n_Note: the original issue description mentioned this global logger awkwardness as one of kernel's current logging issues, but this was just informational and never something addressed in this RFC. I've now removed it reduce confusion._",
          "created_at": "2026-01-27T20:10:46Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 1,
            "text_length": 969,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3807456085,
          "user": "ryanofsky",
          "body": "I am sympathetic with purpleKarrot that it's a little awkward to support creating multiple logging receivers if the different receivers don't actually have many independent options, and setting an option on one of them sets it on all of them. If that's the case, probably better not to allow creating multiple receivers. Or not allow creating multiple receivers per log source.\n\nThis doesn't seem like a very major concern by itself though, and should be orthogonal to #34374 like stickies said.\n\nI think #33847 and #30342 and are a pretty straightforward way out of the \"We have to use a singleton here because of other singletons\" dilemma (https://github.com/bitcoin/bitcoin/pull/34374#discussion_r2730355874) and think those could move forward separately.",
          "created_at": "2026-01-27T20:47:05Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 758,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 6514,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3862308356,
      "number": 34423,
      "title": "uptime RPC returns 0 on first invocation",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nFirst time `bitcoin-cli uptime` is called, output is always zero.\n\n### Expected behaviour\n\nExpected behavior should be first time invocation of `bitcoin-cli uptime` shows the actual `bitcoind` uptime.\n\n### Steps to reproduce\n\nOn Linux:\n\n1. `./build/bin/bitcoind -regtest -daemon`\n2. `sleep 10`\n3. `./build/bin/bitcoin-cli -regtest uptime`\n\nOutput is zero, while non-zero is expected.\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nv30.99.0-c0e6556e4f51\n\n### Operating system and version\n\nUbuntu 22.04.5 LTS\n\n### Machine specifications\n\n_No response_",
      "state": "open",
      "user": "carloantinarella",
      "created_at": "2026-01-27T20:26:11Z",
      "updated_at": "2026-01-27T20:46:41Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34423",
      "labels": [
        "Bug",
        "RPC/REST/ZMQ"
      ],
      "comment_data": [
        {
          "id": 3807394592,
          "user": "carloantinarella",
          "body": "Probably caused by changes introduced in #34328 \n\nI guess the function `GetUptime()` shall be called at least once in the startup phase to initialize the static variable `g_startup_time`.\nAlso `rpc_uptime.py` could be updated with dedicated check.\n\nIf ok, I would be happy to contribute with a PR for this.",
          "created_at": "2026-01-27T20:31:06Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 306,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3807451581,
          "user": "maflcko",
          "body": "> I guess the function `GetUptime()` shall be called at least once in the startup phase to initialize the static variable `g_startup_time`.\n\nRight, good catch. I think this was introduced by me in https://github.com/bitcoin/bitcoin/pull/34328#discussion_r2704186705",
          "created_at": "2026-01-27T20:45:59Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 265,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 800,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 787449588,
      "number": 20949,
      "title": "Handling of duplicate keys in JSON",
      "body": "Our handling of duplicate keys in JSON dictionaries is different from that of other languages like Python, Javascript (and most others I know of).\r\n\r\nWhile those languages parse the JSON and build hash tables, the last assignment of a key is what takes effect. e.g.\r\n```python\r\n>>> json.loads('{\"a\": \"first\", \"a\": \"second\"}')\r\n{'a': 'second'}\r\n```\r\n\r\nOur  `univalue`, though, stores every (key,value) pair in an array, and when a key is queried it returns the *first* associated value.\r\n\r\n```c++\r\n#include <iostream>\r\n#include <univalue.h>\r\n\r\nint main() {\r\n    UniValue val;\r\n    val.read(\"{\\\"a\\\": \\\"first\\\", \\\"a\\\": \\\"second\\\"}\");\r\n    std::cout << val[\"a\"].write() << std::endl;\r\n    return 0;\r\n}\r\n```\r\n\r\n```bash\r\n$ g++ unitest.cpp -o unitest -Iunivalue/include -L src/univalue/.libs -lunivalue\r\n$ ./unitest \r\n\"first\"\r\n```\r\n\r\nThis is not generally a problem but can create subtle interoperability issues. For example a proxy that validates the allowed JSON-RPC commands and lets through only some combinations of command/argument (and doesn't take this into account) could be misled in this way.\r\n\r\nEither reversing this order or adding a \"strict mode\" that rejects duplicate keys might make sense. I don't know.\r\n\r\n(issue originally reported by Florian Mathieu)",
      "state": "open",
      "user": "laanwj",
      "created_at": "2021-01-16T11:47:26Z",
      "updated_at": "2026-01-27T19:58:31Z",
      "closed_at": null,
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/issues/20949",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "comment_data": [
        {
          "id": 3806198074,
          "user": "ubbabeck",
          "body": "Hi,\n\nI was investigating whether this issue still requires work and wanted to share my findings. I am fairly new to the bitcoin core codebase so excuse my ignorance.\n\n### Current State\n\nCommit 6bd1d20b (PR #26628, ) added duplicate detection **at the RPC layer** in https://github.com/bitcoin/bitcoin/blob/27aeeff630147cca35488752c01aaf5750b69fbc/src/rpc/server.cpp#L380. \n\nHowever, **UniValue itself** still:\n- Accepts duplicate keys during parsing\n- Stores both values internally but only returns the first\n- Makes duplicate values inaccessible (silent data loss)\n\n### Where Should Detection Happen?\n\n#### Option 1: Parser Level (UniValue)\n**Pros:** Complete protection everywhere, prevents data loss, consistent behavior\n**Cons:** Breaks test `rpc_tests.cpp:96-97` which expects RPC-specific error, generic error messages, performance cost\n\n#### Option 2: RPC Layer (Current)\n**Pros:** Already implemented, specific error messages, non-breaking\n**Cons:** Doesn't protect nested objects like `{\"outer\": {\"key\": 1, \"key\": 2}}`, inconsistent behavior across contexts\n\n### Questions for Discussion\n\n1. Should UniValue (general JSON library) enforce unique keys, or is this a consumer policy?\n2. Does the nested object vulnerability need parser-level protection?\n3. Should we add a strict parsing mode option to UniValue? as suggested in the issues description by @laanwj:\n\n### Proposed Solutions\n\nI am not aware if there already exists a plan for the UniValue implementation, but here a two possible solutions I see.\n\n**Short term:** Document current behavior and limitations\n\n**Long term:** Consider adding optional strict mode \n```cpp\nval.read(json, UniValue::STRICT_MODE);  // Rejects duplicates\n```\n\nThis allows RPC to use strict mode while maintaining backward compatibility for other uses.\n\nHappy to work on whichever approach maintainers prefer. I have a working parser-level implementation but it breaks the existing test expectations, suggesting RPC-layer detection was the intended design.\n",
          "created_at": "2026-01-27T16:32:31Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 1,
            "text_length": 1999,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3806430261,
          "user": "maflcko",
          "body": "Is there a use-case for silently continuing anywhere? I haven't looked deeper, but I think univalue should just reject duplicates at the lowest level while parsing or constructing any dict.",
          "created_at": "2026-01-27T17:11:48Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 0,
            "text_length": 189,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3806957014,
          "user": "ubbabeck",
          "body": "Whenever bitcoin core has any use-cases for silently continuing. I do not know, my assumption is no, but I will look further into this. \n\nWhen it comes to json, even the [rfc8259](https://www.rfc-editor.org/rfc/rfc8259#section-4) isn't clear on what is correct and states: `The names within an object SHOULD be unique.`.  Though from how I understand and work with JSON it's mentally mapped as a `MUST`, so I agree with @maflcko's statement that univalue should reject duplicates. \n\nOne use-case I found for duplicate keys is for merging of objects, but I have never encountered this in the wild during my career.\n\nWhen it comes to how to go about this. Do you think it makes more sense to thow a runtime error as in univalue_get.cpp?\n https://github.com/bitcoin/bitcoin/blob/c0e6556e4f51b454c3f6e9069044761c34e99f81/src/univalue/lib/univalue_get.cpp#L56\n\nConsidering how to implement this, do you believe it makes more sense to throw a runtime error, similar to what is done in univalue_get.cpp? This approach could allow developers to identify and handle exceptions effectively, instead of returning a `bool` as is done today.\n\n  ",
          "created_at": "2026-01-27T19:00:03Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 1,
            "text_length": 1132,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3807248571,
          "user": "maflcko",
          "body": "I would have recommended to start by adding sanity checks to pushKV (and friends), because they are only used internally and I think assumed/expected to not add duplicate keys, so they could throw a runtime error on a violation.\n\nHowever, this does not seem so trivial, because duplicate checking could bring the calls back to O(n^2), which apparently makes a difference in some cases: 710a7136f93133bf256d37dc8c8faf5a6b9ba89d",
          "created_at": "2026-01-27T19:58:31Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 426,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1298,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3519267236,
      "number": 33635,
      "title": "Intermittent issue in feature_assumeutxo.py\", line 629, in run_test                                        assert not self.has_blockfile(n1, \"00002\"), \"too many blockfiles\"",
      "body": "Seen locally in https://drahtbot.space/temp_scratch/feature_assumeutxo_265.tar.zstd:\n\ncommit should be roughly 40e7d4cd0d7f1d922b92b0c640d3d89eef059411 and the command was `RUN_UNIT_TESTS=false MAKEJOBS=\"-j8\" FILE_ENV=\"./ci/test/00_setup_env_native_nowallet_libbitcoinkernel.sh\" ./ci/test_run_all.sh`\n\n```\n node1 2025-10-15T18:56:48.763939Z [shutoff] [txdb.cpp:151] [virtual bool CCoinsViewDB::BatchWrite(CoinsViewCacheCursor &, const uint256 &)] [coindb] Writing final batch of 0.00 MiB \n node1 2025-10-15T18:56:48.763948Z [shutoff] [txdb.cpp:153] [virtual bool CCoinsViewDB::BatchWrite(CoinsViewCacheCursor &, const uint256 &)] [coindb] Committed 0 changed transaction outputs (out of 0) to coin database... \n node1 2025-10-15T18:56:48.763958Z [shutoff] [logging/timer.h:58] [void BCLog::Timer<std::chrono::duration<long long, std::ratio<1, 1000>>>::Log(const std::string &) [TimeType = std::chrono::duration<long long, std::ratio<1, 1000>>]] [bench] FlushStateToDisk: write coins cache to disk (0 coins, 256KiB) completed (0.02ms) \n node1 2025-10-15T18:56:48.763966Z [shutoff] [validationinterface.cpp:246] [void ValidationSignals::ChainStateFlushed(ChainstateRole, const CBlockLocator &)] [validation] Enqueuing ChainStateFlushed: block hash=5d3144f90878dbabd3a42352be3294df923c93198e1399b93d07292c9cd1e1ce \n node1 2025-10-15T18:56:48.763997Z [shutoff] [validation.cpp:2837] [bool Chainstate::FlushStateToDisk(BlockValidationState &, FlushStateMode, int)] [coindb] Writing chainstate to disk: flush mode=ALWAYS, prune=0, large=0, critical=0, periodic=0 \n node1 2025-10-15T18:56:48.764007Z [shutoff] [logging/timer.h:58] [void BCLog::Timer<std::chrono::duration<long long, std::ratio<1, 1000>>>::Log(const std::string &) [TimeType = std::chrono::duration<long long, std::ratio<1, 1000>>]] [bench] FlushStateToDisk: write block and undo data to disk started \n node1 2025-10-15T18:56:48.764041Z [shutoff] [logging/timer.h:58] [void BCLog::Timer<std::chrono::duration<long long, std::ratio<1, 1000>>>::Log(const std::string &) [TimeType = std::chrono::duration<long long, std::ratio<1, 1000>>]] [bench] FlushStateToDisk: write block and undo data to disk completed (0.03ms) \n node1 2025-10-15T18:56:48.764050Z [shutoff] [logging/timer.h:58] [void BCLog::Timer<std::chrono::duration<long long, std::ratio<1, 1000>>>::Log(const std::string &) [TimeType = std::chrono::duration<long long, std::ratio<1, 1000>>]] [bench] FlushStateToDisk: write block index to disk started \n node1 2025-10-15T18:56:48.764061Z [shutoff] [logging/timer.h:58] [void BCLog::Timer<std::chrono::duration<long long, std::ratio<1, 1000>>>::Log(const std::string &) [TimeType = std::chrono::duration<long long, std::ratio<1, 1000>>]] [bench] FlushStateToDisk: write block index to disk completed (0.01ms) \n node1 2025-10-15T18:56:48.764067Z [shutoff] [logging/timer.h:58] [void BCLog::Timer<std::chrono::duration<long long, std::ratio<1, 1000>>>::Log(const std::string &) [TimeType = std::chrono::duration<long long, std::ratio<1, 1000>>]] [bench] FlushStateToDisk: write coins cache to disk (0 coins, 256KiB) started \n node1 2025-10-15T18:56:48.764076Z [shutoff] [txdb.cpp:151] [virtual bool CCoinsViewDB::BatchWrite(CoinsViewCacheCursor &, const uint256 &)] [coindb] Writing final batch of 0.00 MiB \n node1 2025-10-15T18:56:48.764083Z [shutoff] [txdb.cpp:153] [virtual bool CCoinsViewDB::BatchWrite(CoinsViewCacheCursor &, const uint256 &)] [coindb] Committed 0 changed transaction outputs (out of 0) to coin database... \n node1 2025-10-15T18:56:48.764092Z [shutoff] [logging/timer.h:58] [void BCLog::Timer<std::chrono::duration<long long, std::ratio<1, 1000>>>::Log(const std::string &) [TimeType = std::chrono::duration<long long, std::ratio<1, 1000>>]] [bench] FlushStateToDisk: write coins cache to disk (0 coins, 256KiB) completed (0.02ms) \n node1 2025-10-15T18:56:48.764100Z [shutoff] [validationinterface.cpp:246] [void ValidationSignals::ChainStateFlushed(ChainstateRole, const CBlockLocator &)] [validation] Enqueuing ChainStateFlushed: block hash=6d9186a0db6df121d2006c40c7827c447afe6329b705666bca1744b72c71f0ad \n node1 2025-10-15T18:56:48.767027Z [shutoff] [init.cpp:410] [void Shutdown(NodeContext &)] Shutdown done \n test  2025-10-15T18:56:48.791717Z TestFramework.node1 (DEBUG): Node stopped \n test  2025-10-15T18:56:48.791816Z TestFramework (INFO): Checking that blocks are segmented on disk \n test  2025-10-15T18:56:48.791990Z TestFramework (ERROR): Unexpected exception \n                                   Traceback (most recent call last):\n                                     File \"/ci_container_base/test/functional/test_framework/test_framework.py\", line 198, in main\n                                       self.run_test()\n                                     File \"/ci_container_base/ci/scratch/build-x86_64-pc-linux-gnu/test/functional/feature_assumeutxo.py\", line 629, in run_test\n                                       assert not self.has_blockfile(n1, \"00002\"), \"too many blockfiles\"\n                                   AssertionError: too many blockfiles\n",
      "state": "open",
      "user": "maflcko",
      "created_at": "2025-10-15T19:15:40Z",
      "updated_at": "2026-01-27T18:26:48Z",
      "closed_at": null,
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/33635",
      "labels": [
        "CI failed"
      ],
      "comment_data": [
        {
          "id": 3799899091,
          "user": "b-l-u-e",
          "body": "> Seen locally in https://drahtbot.space/temp_scratch/feature_assumeutxo_265.tar.zstd:\n> \ni tried studying from the report shared above realized that maybe the assertion `assert not self.has_blockfile(n1, \"00002\")` was too strict perhaps maybe we can condition it  because segmentation works as  expected\n\ncoz with `-fastprune` it does 64KB blockfiles... coz node1 runs two chainstates concurrently NORMAL and ASSUMED...so this segmentation keeps their blocks separate\n\nso when NORMAL syncs enough blocks to fill blk00000.dat it creates blk00002.dat\n\nfrom node1/regtest/debug.log\n```\n[assumed] initializing blockfile cursor to BlockfileCursor(file_num=1)\n...\nLeaving block file 0: CBlockFileInfo(blocks=242, size=65331, heights=0...240) (onto 2) (height 241)\n```\ni think or rather maybe test should verify segmentation works blk00001.dat exists for ASSUMED blocks not just limit to 2 files",
          "created_at": "2026-01-26T14:30:58Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 889,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3806783779,
          "user": "maflcko",
          "body": "I think this is  `-stopatheight` not working?",
          "created_at": "2026-01-27T18:23:41Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 45,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3806798344,
          "user": "maflcko",
          "body": "Hmmm, maybe not, because this diff is passing:\n\n```diff\ndiff --git a/test/functional/feature_assumeutxo.py b/test/functional/feature_assumeutxo.py\nindex 20ebd823d1..959b3bbd9a 100755\n--- a/test/functional/feature_assumeutxo.py\n+++ b/test/functional/feature_assumeutxo.py\n@@ -606,7 +606,7 @@ class AssumeutxoTest(BitcoinTestFramework):\n         assert signed_txid in n1.getrawmempool()\n         assert not n1.gettxout(prev_tx['txid'], 0)\n \n-        PAUSE_HEIGHT = FINAL_HEIGHT - 40\n+        PAUSE_HEIGHT = FINAL_HEIGHT \n \n         self.log.info(\"Restarting node to stop at height %d\", PAUSE_HEIGHT)\n         self.restart_node(1, extra_args=[\n",
          "created_at": "2026-01-27T18:26:48Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 641,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 5226,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3825454472,
      "number": 34326,
      "title": "node uptime wrong",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nSystem is freshly booted but bitcoind show wrong uptime:\n\n```\nroot@raspberrypi5-c8-bf-64:~# bitcoin-cli -conf=/etc/bitcoin/bitcoin.conf uptime\n20120688\n\n```\n\nMy real uptime:\n```\nroot@raspberrypi5-c8-bf-64:~# uptime \n 15:53:22 up 10 min,  0 user,  load average: 0.61, 0.56, 0.31\n```\nversion:\n```\nroot@raspberrypi5-c8-bf-64:~# bitcoind --version\nBitcoin Core daemon version v30.2.0 bitcoind\nCopyright (C) 2009-2026 The Bitcoin Core developers\n\nPlease contribute if you find Bitcoin Core useful. Visit\n<https://bitcoincore.org/> for further information about the software.\nThe source code is available from <https://github.com/bitcoin/bitcoin>.\n\nThis is experimental software.\nDistributed under the MIT software license, see the accompanying file COPYING\nor <https://opensource.org/license/MIT>\n\n```\nbitcoin conf file:\n```\nroot@raspberrypi5-c8-bf-64:~# cat /etc/bitcoin/bitcoin.conf \n#############################################################\n# Bitcoin configuration file\n#############################################################\npid=/run/bitcoin/bitcoind.pid\nnodebuglogfile=1\ndatadir=/var/bitcoin\nloglevel=info\nproxy=127.0.0.1:9050\nsigner=/usr/bin/hwi\n\n# Settings for signet Network\nsignet=1\n\n[signet]\nwalletdir=/var/wallets\nlisten=1\nbind=127.0.0.1\nport=38333\n\n# RPC Settings\nrpcuser=satobox\nrpcport=38332\nrpcbind=127.0.0.1\nrpcallowip=127.0.0.1\nrpcauth=satobox:3381456077fa06cabce053c62a368693$263f4f1cbdc1b4b25233385b931807508f5d8bd59d2c46dc418e4ea2b23dfd09\nrpccookiefile=/run/bitcoin/cookie\nrpccookieperms=group\nserver=1\ndeprecatedrpc=warnings\n```\n\n### Expected behaviour\n\nshould show correct uptime\n\n### Steps to reproduce\n\njust build new bitcoin core and test with commands above\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nv30.2\n\n### Operating system and version\n\nlinux \n\n### Machine specifications\n\nraspberrypi5",
      "state": "closed",
      "user": "embetrix",
      "created_at": "2026-01-17T15:56:13Z",
      "updated_at": "2026-01-27T16:31:19Z",
      "closed_at": "2026-01-27T16:31:19Z",
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/issues/34326",
      "labels": [
        "Bug"
      ],
      "comment_data": [
        {
          "id": 3806129070,
          "user": "pinheadmz",
          "body": "Was this closed by https://github.com/bitcoin/bitcoin/pull/34328 ?",
          "created_at": "2026-01-27T16:18:53Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 66,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3806183076,
          "user": "l0rinc",
          "body": "yes, please close the issue.",
          "created_at": "2026-01-27T16:29:37Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 28,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 2053,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2627141112,
      "number": 31194,
      "title": "Remove libevent as a dependency (HTTP / cli / torcontrol)",
      "body": "Next PRs for review:\n\n- [x] https://github.com/bitcoin/bitcoin/pull/32408\n- [x] https://github.com/bitcoin/bitcoin/pull/32862\n- [x] https://github.com/bitcoin/bitcoin/pull/32747\n- [x] https://github.com/bitcoin/bitcoin/pull/34242\n- [ ] https://github.com/bitcoin/bitcoin/pull/32061\n- [ ] https://github.com/bitcoin/bitcoin/pull/34158\n- [ ] https://github.com/bitcoin/bitcoin/pull/34342\n\nThere is also a proof-of-concept branch including the above work as well as total removal of libevent from the build system:\n\n- [ ] https://github.com/bitcoin/bitcoin/pull/34411\n\n## Immediate advantages\n### UNIX domain sockets for JSON-RPC\n- Old feature request: https://github.com/bitcoin/bitcoin/issues/5029\n- UNIX sockets have been added to [ZMQ](https://github.com/bitcoin/bitcoin/pull/27679) and [Tor proxy](https://github.com/bitcoin/bitcoin/pull/27375) already \n- UNIX sockets with libevent [doesn't work](https://github.com/bitcoin/bitcoin/issues/5029#issuecomment-2203469108)\n### Remove a dependency\n- libevent hasn't had a release since 2020\n- [libevent is currently looking for new maintainers](github.com/libevent/libevent/issues/1812), a bit of a red flag\n- The [xz utils backdoor](https://en.wikipedia.org/wiki/XZ_Utils_backdoor) raised some concern among contributors in the [2024/04/18 IRC meeting](https://www.erisian.com.au/bitcoin-core-dev/log-2024-04-18.html#l-198)\n\n## Current libevent usage in the project\nSee [this report](https://gist.github.com/fjahr/c0c339a4b5021ae815d5bcff42e9fc57) by @fjahr. A few of these have already been addressed, like https://github.com/bitcoin/bitcoin/pull/29904\n",
      "state": "open",
      "user": "pinheadmz",
      "created_at": "2024-10-31T15:25:23Z",
      "updated_at": "2026-01-27T16:06:38Z",
      "closed_at": null,
      "comments": 14,
      "url": "https://github.com/bitcoin/bitcoin/issues/31194",
      "labels": [
        "RPC/REST/ZMQ",
        "P2P"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1661,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2809454642,
      "number": 31732,
      "title": "CMakeList.txt not part of the release tags",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nwhy the _CMakeList.txt_ is not present in the release tags/branches ?! how should that be built ?\n\n### Expected behaviour\n\nCMakeList.txt should be present\n\n### Steps to reproduce\n\njust check the release tags/branches\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nmaster\n\n### Operating system and version\n\nLinux\n\n### Machine specifications\n\n_No response_",
      "state": "closed",
      "user": "embetrix",
      "created_at": "2025-01-24T13:24:40Z",
      "updated_at": "2026-01-27T11:02:35Z",
      "closed_at": "2025-01-24T13:28:01Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/31732",
      "labels": [
        "Questions and Help"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 607,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2811242633,
      "number": 31737,
      "title": "Add French Language to the languages.",
      "body": "This will help French users to feel the need to use the page.",
      "state": "closed",
      "user": "Mmabiaa",
      "created_at": "2025-01-26T00:30:58Z",
      "updated_at": "2026-01-27T11:02:34Z",
      "closed_at": "2025-01-27T13:49:53Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/31737",
      "labels": [
        "GUI"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 99,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3575888633,
      "number": 33758,
      "title": "BlockTemplate Manager Tracking issue",
      "body": "The main motivation and design rationale are discussed in #33389.\n\nWhat to review\n\n* #33421\n\n### Plan\n\n* [ ] **Introduce the Block Template Cache (Manager) #33421**\n  Implement a cache layer. All newly created block templates should be stored along with their respective configuration options. Client requests for block templates will specify the **maximum age** of the template; that is, how fresh they want the template to be:\n\n  * If a template with matching options exists in the cache and the interval has not elapsed, a cached template is returned.\n  * If no template exists or the interval has elapsed, a new template is generated, stored in the cache, and returned.\n  * After insertion, the oldest template is evicted if the cache exceeds its maximum size.\n    The cache has a configurable maximum size (default: 10).\n    It also subscribes to the validation interface’s `BlockConnected` notification and clears the cache when a new block is connected or disconnected, preventing stale templates from being served.\n    This stage will also allow sharing of template metadata built from the mining interface for a fee estimation mechanism that requires building a block template to obtain package fee rates and use them for fee estimation, and vice versa. See the discussion in #33389.\n\n* [ ] Create a block template manager that will own the `BlockTemplateCache`. Block template requests from node components and other block template-related operations will be handled via this cache.\n\n* [ ] Prune `WaitAndCreateNewBlock` and move its implementation to the block template manager under `GetNext`. This method will use the block template cache for decisions to build a block template. This approach is cleaner and should allow reusing the logic in `getblocktemplate`, thereby removing the global state.\n  [https://github.com/bitcoin/bitcoin/blob/292ea0eb8982faef460c210bd4215d603f487463/src/rpc/mining.cpp#L776](https://github.com/bitcoin/bitcoin/blob/292ea0eb8982faef460c210bd4215d603f487463/src/rpc/mining.cpp#L776)\n  [https://github.com/bitcoin/bitcoin/blob/292ea0eb8982faef460c210bd4215d603f487463/src/rpc/mining.cpp#L859-L861](https://github.com/bitcoin/bitcoin/blob/292ea0eb8982faef460c210bd4215d603f487463/src/rpc/mining.cpp#L859-L861)\n  This will also allow pruning `WaitTipChanged` and exposing information to retrieve the metadata of the last built block template, enabling the removal of additional global state.\n  [https://github.com/bitcoin/bitcoin/blob/292ea0eb8982faef460c210bd4215d603f487463/src/node/miner.h#L186-L189](https://github.com/bitcoin/bitcoin/blob/292ea0eb8982faef460c210bd4215d603f487463/src/node/miner.h#L186-L189)\n\n* [ ] **Implement trimming of transactions** in larger block templates to enable reuse when configurations do not match (see the idea here: [https://github.com/bitcoin/bitcoin/issues/33389#issuecomment-3295505510](https://github.com/bitcoin/bitcoin/issues/33389#issuecomment-3295505510))\n  This will allow reusing block templates from `SENDTEMPLATE` for mining and fee estimation, but not vice versa, because `SENDTEMPLATE` builds templates larger than 4 MB.\n\n* [ ] **Introduce a push-based subscription mechanism** that allows clients to subscribe to fee updates for a given block template and receive a new template when the fee threshold is reached or when the tip changes. This is what `waitnext` should use.\n  See the related discussion here:\n  [https://delvingbitcoin.org/t/determining-blocktemplate-fee-increase-using-fee-rate-diagram/2052](https://delvingbitcoin.org/t/determining-blocktemplate-fee-increase-using-fee-rate-diagram/2052)\n  This feature depends on cluster mempool.\n\n",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2025-10-31T17:55:33Z",
      "updated_at": "2026-01-26T20:44:54Z",
      "closed_at": null,
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/33758",
      "labels": [
        "Mining",
        "Tracking Issue"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3679,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3680657459,
      "number": 33982,
      "title": "build: `guix` package was removed from debian",
      "body": "Apparently the `guix` debian package was no longer maintained, and was removed from debian recently (see https://lwn.net/Articles/1035491/). Ubuntu and other debian derivatives will likely follow.\n\nThis means we need new setup instructions for guix on debian in `contrib/guix/INSTALL.md`.",
      "state": "open",
      "user": "laanwj",
      "created_at": "2025-12-01T11:58:44Z",
      "updated_at": "2026-01-26T16:39:24Z",
      "closed_at": null,
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/issues/33982",
      "labels": [
        "Docs",
        "Build system"
      ],
      "comment_data": [
        {
          "id": 3784813664,
          "user": "fanquake",
          "body": "`v1.5.0` has been tagged: https://codeberg.org/guix/guix/src/tag/v1.5.0.",
          "created_at": "2026-01-22T14:51:05Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 72,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3790160137,
          "user": "fanquake",
          "body": "https://guix.gnu.org/en/blog/2026/gnu-guix-1.5.0-released/",
          "created_at": "2026-01-23T13:08:16Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 58,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3800550995,
          "user": "Sjors",
          "body": "On my Ubuntu x86_64 machine I have a manual Guix installation. As root I pulled it from `20dbf225f332ccc707578263ed710dcf2a8fb78e` (August 2024) to v1.5.0:\n\n```sh\nguix pull --commit=v1.5.0 --no-substitutes\n```\n\nAnd then also on the regular guix user.\n\nSanity checked with:\n\n```sh\nguix build --system=x86_64-linux  hello\n```\n\nWould the next step be to bump our time machine commit to that tag or a more recent commit?\n\nI'll update #32759 with my experience on Apple Silicon.\n\nHopefully this will show up in various distros over time too.",
          "created_at": "2026-01-26T16:39:24Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 536,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 334,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3149228636,
      "number": 32759,
      "title": "Guix build fails on M4 macOS host with Ubuntu in UTM",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nSince #32431 my macOS (M4 using UTM) Guix builds no longer work: \n\n```\nHOSTS=\"x86_64-linux-gnu\" contrib/guix/guix-build\n...\nguix shell: error: while setting up the build environment: cannot set armhf-linux personality: Invalid argument\n```\n\nThis seems to be something else than what I encountered on my native AMD Ubuntu machine: https://github.com/bitcoin/bitcoin/pull/32431#issuecomment-2966089437\n\nBut perhaps a common factor is that this PR pulled in a lot of new guix packages.\n\n### Expected behaviour\n\nGuix build should work, it does on c8abd972818f83d90bf50b250131f338034460ef.\n\n### Steps to reproduce\n\nSee below\n\n### Relevant log output\n\n```\n$ HOSTS=\"x86_64-linux-gnu\" contrib/guix/guix-build\nChecking that we can connect to the guix-daemon...\n\nHint: If this hangs, you may want to try turning your guix-daemon off and on\n      again.\n\nmake: Entering directory '/home/sjors/bitcoin/depends'\nmake[1]: Entering directory '/home/sjors/bitcoin/depends'\nmake[1]: Leaving directory '/home/sjors/bitcoin/depends'\nmake: Leaving directory '/home/sjors/bitcoin/depends'\nINFO: Building fed41b75fbfa for platform triple x86_64-linux-gnu:\n      ...using reference timestamp: 1749642062\n      ...running at most 10 jobs\n      ...from worktree directory: '/home/sjors/bitcoin'\n          ...bind-mounted in container to: '/bitcoin'\n      ...in build directory: '/home/sjors/bitcoin/guix-build-fed41b75fbfa/distsrc-fed41b75fbfa-x86_64-linux-gnu'\n          ...bind-mounted in container to: '/distsrc-base/distsrc-fed41b75fbfa-x86_64-linux-gnu'\n      ...outputting in: '/home/sjors/bitcoin/guix-build-fed41b75fbfa/output/x86_64-linux-gnu'\n          ...bind-mounted in container to: '/outdir-base/x86_64-linux-gnu'\n      ADDITIONAL FLAGS (if set)\n          ADDITIONAL_GUIX_COMMON_FLAGS: --max-jobs=4 --no-substitutes\n          ADDITIONAL_GUIX_ENVIRONMENT_FLAGS:\n          ADDITIONAL_GUIX_TIMEMACHINE_FLAGS:\nThe following derivations will be built:\n  /gnu/store/5kpjfn7qg25c4w1q3cczl565x0yi8mpb-python-lief-0.16.6.drv\n  /gnu/store/04dcmhmlhgj2pgnyspb88lm5j9rwbd60-python-typing-extensions-4.9.0.drv\n  /gnu/store/nd7dcikf5dnq113cxmb1r4w0q8ijs1qq-typing_extensions-4.9.0.tar.gz.drv\n  /gnu/store/25adw1ck5fvbgvrx405c0l6kjag49j9z-python-importlib-metadata-5.2.0.drv\n...\n  /gnu/store/c985sj9mqmk3qvsd55b0g11hlv26krbk-msgpack-1.0.4.tar.gz.drv\n  /gnu/store/x8vm49yz0k8wm3w2hgishy5q1svkcfaw-python-pymongo-4.1.1.drv\n  /gnu/store/6dv3fazv5hnhwvgfnnykm0f2lwnajgsq-pymongo-4.1.1.tar.gz.drv\n\nbuilding /gnu/store/ck789yrq1xslycd986zdh5fq8dknl3r3-rust-actix-derive-0.5.0.tar.gz.drv...\nbuilding /gnu/store/2xasv0pcv8gw6lafag6bkjfqkmlbj02f-rust-actix-http-1.0.1.tar.gz.drv...\nbuilding /gnu/store/qifi4hb8hjm6bk6nv4664fyw7cb25fgp-rust-actix-http-2.2.0.tar.gz.drv...\nbuilding /gnu/store/gm8l3rn479p9hf3zs1vj9pzchvcj42f8-rust-actix-macros-0.1.3.tar.gz.drv...\nThe following builds are still in progress:\n  /gnu/store/qifi4hb8hjm6bk6nv4664fyw7cb25fgp-rust-actix-http-2.2.0.tar.gz.drv\n  /gnu/store/ck789yrq1xslycd986zdh5fq8dknl3r3-rust-actix-derive-0.5.0.tar.gz.drv\n\nbuilding /gnu/store/grpq0sq301rwsz6h4vbdx9sgvi64wai4-Python-2.7.18.tar.xz.drv...\nThe following builds are still in progress:\n  /gnu/store/grpq0sq301rwsz6h4vbdx9sgvi64wai4-Python-2.7.18.tar.xz.drv\n  /gnu/store/qifi4hb8hjm6bk6nv4664fyw7cb25fgp-rust-actix-http-2.2.0.tar.gz.drv\n\nThe following builds are still in progress:\n  /gnu/store/grpq0sq301rwsz6h4vbdx9sgvi64wai4-Python-2.7.18.tar.xz.drv\n  /gnu/store/qifi4hb8hjm6bk6nv4664fyw7cb25fgp-rust-actix-http-2.2.0.tar.gz.drv\n\nbuilding /gnu/store/sf5wwnpy8mr9l8iic2xz5bmg3bppjrj9-asynctest-0.13.0.tar.gz.drv...\nbuilding /gnu/store/hiqwnz4mhiad1zcqyf250b1ws0s36djc-attrs-21.2.0.tar.gz.drv...\nThe following builds are still in progress:\n  /gnu/store/hiqwnz4mhiad1zcqyf250b1ws0s36djc-attrs-21.2.0.tar.gz.drv\n  /gnu/store/sf5wwnpy8mr9l8iic2xz5bmg3bppjrj9-asynctest-0.13.0.tar.gz.drv\n  /gnu/store/grpq0sq301rwsz6h4vbdx9sgvi64wai4-Python-2.7.18.tar.xz.drv\n\nnote: keeping build directory `/tmp/guix-build-Python-2.7.18.tar.xz.drv-2'\nnote: keeping build directory `/tmp/guix-build-bash.drv-2'\nnote: keeping build directory `/tmp/guix-build-asynctest-0.13.0.tar.gz.drv-2'\nnote: keeping build directory `/tmp/guix-build-attrs-21.2.0.tar.gz.drv-2'\nguix shell: error: while setting up the build environment: cannot set armhf-linux personality: Invalid argument\n```\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nmaster@fed41b75fbfa6d14cce852863271b1fb0206eef0\n\n### Operating system and version\n\nMacOS 15.5 with UTM, guest (virtualized) Ubuntu 24.10 (aarch64\n\n### Machine specifications\n\nM4",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2025-06-16T09:25:48Z",
      "updated_at": "2026-01-26T16:38:01Z",
      "closed_at": "2025-12-09T09:35:10Z",
      "comments": 20,
      "url": "https://github.com/bitcoin/bitcoin/issues/32759",
      "labels": [
        "Build system",
        "Upstream",
        "Questions and Help"
      ],
      "comment_data": [
        {
          "id": 3800544660,
          "user": "Sjors",
          "body": "Tried again with the new 1.5.0 release: https://guix.gnu.org/blog/2026/gnu-guix-1.5.0-released/\n\nTL&DR: things seem slightly better, but I still can't get it to work. I'll wait for a time machine bump to see if an guix build goes anywhere.\n\nI made a fresh Ubuntu 25.10 VM using UTM, https://ubuntu.com/download/server/arm. I use Qemu emulation, not Apple native.\n\nI used the install script method: https://guix.gnu.org/manual/1.5.0/en/html_node/Binary-Installation.html\n\nI disallowed substitutes, but otherwise just followed the defaults and installed `uidmap` and `nscd` as recommended.\n\n```sh\nguix build --list-systems\nThe available systems are:\n\n   - aarch64-linux [current]\n   - armhf-linux\n   - i586-gnu\n   - i686-linux\n   - mips64el-linux\n   - powerpc-linux\n   - powerpc64le-linux\n   - riscv64-linux\n   - x86_64-gnu\n   - x86_64-linux\n```\n\nI then tried:\n\n```\nguix build --system=aarch64-linux  hello\n```\n\nWhich eventually worked.\n\nLooks like the default App Armor exceptions don't do thick:\n\n```\nguix install: error: build of `/gnu/store/y7hi27kiiqvv604jgkjlbnnkf254ng03-profile.drv' failed\nsjors@ubuntu-25:~$ zcat /var/log/guix/drvs/5s/lgpfsb4d6l8hnb0sbcymjzbsky0z5l-guile-bootstrap-2.0.drv.gz\nwhile setting up the child process: in phase exec: executing `/gnu/store/chsrhxr7qap5560nvrisw9yp7bqs2bmp-bash': Permission denied\n```\n\nBut yolo, it's a VM, so I turned it off and proceeded.\n\nLater it ran out of disk space building gcc-14.3.0, my guess is the tmpfs was too small. Bumping RAM from 10 GB to 32 fixed it.\n\nBut other systems don't work, e.g.:\n\n```\nguix build --system=x86_64-linux  hello\n...\nbuilding /gnu/store/cm2h3sxzjpqsqg274j7n4kcrkwwmlns8-guile-bootstrap-2.0.drv...\nwhile setting up the child process: in phase exec: executing `/gnu/store/mzfkrxd4w8vqrmyrx169wj8wyw7r8i37-bash': No such file or directory\nbuilder for `/gnu/store/cm2h3sxzjpqsqg274j7n4kcrkwwmlns8-guile-bootstrap-2.0.drv' failed with exit code 1\n```\n\n```\nguix build --system=armhf-linux hello\n...\nkilling process 773746\nguix build: error: while setting up the child process: in phase setPersonality: cannot set personality: Invalid argument\n```\n\nI also tried installing Python lief again, which is now at 0.17.1:\n\n```\nguix install python-lief --no-substitutes\n```\n\nBut this fails as early as building automake-1.17:\n\n```\nchecking whether the C compiler works... no\nconfigure: error: in `/tmp/guix-build-automake-1.17.drv-0/automake-1.17/contrib/t/multilib.dir/build/libfoo':\nconfigure: error: C compiler cannot create executables\nSee `config.log' for more details\nconfigure: error: ../../libfoo/configure failed for libfoo\n```",
          "created_at": "2026-01-26T16:38:01Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 2611,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 4776,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3856656444,
      "number": 34414,
      "title": "guix: Re-evaluate fdebug-prefix-map",
      "body": "It could make sense to double check an re-evaluate if this is all right. Original comment follows:\r\n\r\nHowever, some source files are generated and reside in the build tree. So the mapping should be:\r\n\r\n```diff\r\n-HOST_CFLAGS+=\" -fdebug-prefix-map=${DISTSRC}/src=.\"\r\n+HOST_CFLAGS+=\" -fdebug-prefix-map=${DISTSRC}=.\"\r\n```\r\n\r\nOtherwise, paths become inconsistent and problematic for configuring source remapping in the debugger:\r\n```\r\n$ gdb ./bitcoin-fa37928536e0/libexec/bitcoin-node\r\n(gdb) break IsRoutable\r\nBreakpoint 1 at 0xb2aa40: file ./netaddress.cpp, line 463.\r\n(gdb) break mp::ProxyClient<ipc::capnp::messages::Init>::construct\r\nBreakpoint 2 at 0x5d82e0: file /distsrc-base/distsrc-fa37928536e0-x86_64-linux-gnu/build/src/ipc/capnp/init.capnp.proxy-client.c++, line 18.\r\n```\r\n\r\n_Originally posted by @hebasto in https://github.com/bitcoin/bitcoin/pull/34281#discussion_r2727335884_\r\n            ",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-26T16:21:01Z",
      "updated_at": "2026-01-26T16:23:33Z",
      "closed_at": null,
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34414",
      "labels": [
        "Build system"
      ],
      "comment_data": [
        {
          "id": 3800474288,
          "user": "maflcko",
          "body": "I haven't tested this, but I think the issue exists since the cmake migration.\n\nGiven that no one reported it, it seems low priority to fix, but it could still make sense to address, because the proposed fix looks simple enough.",
          "created_at": "2026-01-26T16:23:33Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 228,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 936,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3788772806,
      "number": 34220,
      "title": "Guix builds fail after 2026",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nWhile doing a mingw guix build on a clean image, `osslsigncode` fails to build with error\n```\n\\note: keeping build directory `/tmp/guix-build-osslsigncode-2.5.drv-0'\nbuilder for `/gnu/store/7sm633fs4y8n6cgd9lnqkc19ccrbkxr4-osslsigncode-2.5.drv' failed with exit code 1\nbuild of /gnu/store/7sm633fs4y8n6cgd9lnqkc19ccrbkxr4-osslsigncode-2.5.drv failed\nView build log at '/var/log/guix/drvs/7s/m633fs4y8n6cgd9lnqkc19ccrbkxr4-osslsigncode-2.5.drv.gz'.\nnote: keeping build directory `/tmp/guix-build-gcc-13.3.0.tar.xz.drv-0'\nnote: keeping build directory `/tmp/guix-build-binutils-2.38.tar.xz.drv-0'\nguix shell: error: build of `/gnu/store/7sm633fs4y8n6cgd9lnqkc19ccrbkxr4-osslsigncode-2.5.drv' failed\n```\n\nLooking at the logs, you can see that the error is produced by a failed test due to expired cert\n```\nError: Expired CA certificate:\n\tSigner #0:\n\t\tSubject: /C=PL/O=osslsigncode/OU=Certification Authority/CN=Intermediate CA\n\t\tIssuer : /C=PL/O=osslsigncode/OU=Certification Authority/CN=Root CA\n\t\tSerial : 50F083176D60DACA4AEF9E7B1D9521A92C4196D3\n\t\tCertificate expiration date:\n\t\t\tnotBefore : Jan  1 00:00:00 2018 GMT\n\t\t\tnotAfter : Jan  1 00:00:00 2026 GMT\n\n\nX509_verify_cert: certificate verify error: certificate has expired\nSignature CRL verification: failed\nSignature verification: failed\n```\n\nFaking the time to 2025 before the container preparation and then doing a normal build with the right time works normally.\n\n### Expected behaviour\n\nIdeally there should be no timebombs creating guix environments\n\n### Steps to reproduce\n\nTry a guix build from a recently created container, updating the whole time-machine\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nv30.1\n\n### Operating system and version\n\nFedora 43\n\n### Machine specifications\n\n_No response_",
      "state": "closed",
      "user": "psgreco",
      "created_at": "2026-01-07T13:27:01Z",
      "updated_at": "2026-01-26T14:43:34Z",
      "closed_at": "2026-01-09T11:11:46Z",
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/issues/34220",
      "labels": [
        "Upstream"
      ],
      "comment_data": [
        {
          "id": 3799957031,
          "user": "hebasto",
          "body": "Once we update the  `guix time-machine` commit to [`bb898f243ad0c10ba1c59ddbfbf7091c19c0277d`](https://codeberg.org/guix/guix/commit/bb898f243ad0c10ba1c59ddbfbf7091c19c0277d) or later, we can switch to the upstream `osslsigncode` package.",
          "created_at": "2026-01-26T14:43:34Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 238,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1996,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2882058716,
      "number": 31957,
      "title": "callgrind_annotate broken after cmake migration?",
      "body": "Steps to reproduce on a fresh install of Ubuntu LTS 24.04:\n\n* Install packages and clone repo: `( export DEBIAN_FRONTEND=noninteractive && apt update && apt install git ccache make build-essential libtool cmake autotools-dev automake pkg-config bsdmainutils python3     libevent-dev libboost-dev  libsqlite3-dev valgrind  -y && git clone https://github.com/bitcoin/bitcoin.git b-c ) && cd b-c`\n* `git checkout 338bc2cd261ba3daf7fb494f8cb4a534762e292c  # cmake migration (allows to test autotools and cmake on the same commit)`\n* Apply a diff to create more function calls in one hotspot (optional):\n\n```diff\ndiff --git a/src/test/util_tests.cpp b/src/test/util_tests.cpp\nindex c2c725d676..704c060749 100644\n--- a/src/test/util_tests.cpp\n+++ b/src/test/util_tests.cpp\n@@ -273,13 +273,15 @@ BOOST_AUTO_TEST_CASE(util_ReplaceAll)\n         ReplaceAll(test, search, substitute);\n         BOOST_CHECK_EQUAL(test, expected);\n     };\n-\n+    int i{10000};\n+while (i-->0){\n     test_replaceall(\"\", \"foo\", original);\n     test_replaceall(original, \"foo\", \"foo\");\n     test_replaceall(\"%s\", \"foo\", \"A test \\\"foo\\\" string 'foo'.\");\n     test_replaceall(\"\\\"\", \"foo\", \"A test foo%sfoo string '%s'.\");\n     test_replaceall(\"'\", \"foo\", \"A test \\\"%s\\\" string foo%sfoo.\");\n }\n+}\n \n BOOST_AUTO_TEST_CASE(util_TrimString)\n {\n```\n\n* Then create two out-of-tree builds, run a test in callgrind, and annotate it:\n* `./autogen.sh && rm -rf ./bld-a && mkdir bld-a && ( cd bld-a && ../configure && make -j$(nproc) )`\n* `rm -rf ./bld-c && cmake -B ./bld-c && cmake --build ./bld-c -j $(nproc)`\n* `valgrind --tool=callgrind --callgrind-out-file=cg-a-%p.out ./bld-a/src/test/test_bitcoin -t util_tests/util_ReplaceAll`\n* `valgrind --tool=callgrind --callgrind-out-file=cg-c-%p.out ./bld-c/src/test/test_bitcoin -t util_tests/util_ReplaceAll`\n* `callgrind_annotate ./cg-a-40328.out`\n* `callgrind_annotate ./cg-c-39984.out`\n\nThe cmake version of the last call will print a warning:\n\n```\n--------------------------------------------------------------------------------\nThe following files chosen for auto-annotation could not be found:\n--------------------------------------------------------------------------------\n  ./bld-c/src/crypto/./src/compat/byteswap.h\n  ./bld-c/src/crypto/./src/crypto/sha256.cpp\n  ./bld-c/src/crypto/./src/crypto/sha512.cpp\n  ./bld-c/src/test/./src/test/crypto_tests.cpp\n  ./bld-c/src/test/./src/test/util_tests.cpp\n  ./bld-c/src/util/./src/random.cpp\n  ./bld-c/src/util/./src/util/string.cpp\n...\n```\n\nIt also seems not possible to fix with `--include=dir`, as the path look a bit odd (non-existing)",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-02-26T15:48:13Z",
      "updated_at": "2026-01-26T13:56:01Z",
      "closed_at": "2026-01-26T13:56:01Z",
      "comments": 8,
      "url": "https://github.com/bitcoin/bitcoin/issues/31957",
      "labels": [
        "Build system",
        "Tests"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2643,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2629170491,
      "number": 31204,
      "title": "Source code mapping for debugger has changed since cmake",
      "body": "developer-notes.md says:\r\n\r\n\r\n>1. Configure source file mapping.\r\n>\r\n>For `gdb` create or append to `.gdbinit` file:\r\n>```\r\n>set substitute-path ./src /path/to/project/root/src\r\n>```\r\n>\r\n>For `lldb` create or append to `.lldbinit` file:\r\n>```\r\n>settings set target.source-map ./src /path/to/project/root/src\r\n>```\r\n\r\nBut I found I needed to create a `.lldbinit` file with these lines:\r\n```\r\nsettings append target.source-map build/src/test/ /Users/matthewzipkin/Desktop/work/bitcoin/\r\nsettings append target.source-map build/src/src/ /Users/matthewzipkin/Desktop/work/bitcoin/src/\r\n```\r\n\r\nHere's an example of lldb's confused guess of source location:\r\n\r\n```\r\n(lldb) image lookup -vn  ProcessMessages\r\n1 match found in /Users/matthewzipkin/Desktop/work/bitcoin/build/src/bitcoind:\r\n...\r\n      LineEntry: [0x00000001003302f4-0x000000010033032c): build/src/src/net_processing.cpp:5373\r\n```\r\n\r\nCould just be fixed by updating developer-notes.md -- would we ever include a `.lldbinit` file in the repo itself? Or am I missing something else.",
      "state": "closed",
      "user": "pinheadmz",
      "created_at": "2024-11-01T14:37:17Z",
      "updated_at": "2026-01-26T13:56:00Z",
      "closed_at": "2026-01-26T13:56:00Z",
      "comments": 16,
      "url": "https://github.com/bitcoin/bitcoin/issues/31204",
      "labels": [
        "Docs",
        "Build system",
        "Tests"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1094,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3699228979,
      "number": 34016,
      "title": "test: `interface_ipc.py` might start skipping if installed capnp version changes",
      "body": "Noticed this on a Fedora (Rawhide) Box that has capnp `1.2.0` (recently updated from 1.1.0) and `pycapnp` `2.1.0` installed, but was skipping `interface_ipc.py` as if the Python module was not available. The failure was that pycanp `2.1.0` tries to load an older shared lib, and fails:\n```bash\nRemaining jobs: [interface_ipc.py]\n1/1 - interface_ipc.py failed, Duration: 0 s\n\nstdout:\n\n\nstderr:\nTraceback (most recent call last):\n  File \"/root/ci_scratch/build/test/functional/interface_ipc.py\", line 20, in <module>\n    import capnp  # type: ignore[import] # noqa: F401\n    ^^^^^^^^^^^^\n  File \"/usr/local/lib64/python3.14/site-packages/capnp/__init__.py\", line 36, in <module>\n    from .version import version as __version__\n  File \"/usr/local/lib64/python3.14/site-packages/capnp/version.py\", line 1, in <module>\n    from .lib.capnp import _CAPNP_VERSION_MAJOR as LIBCAPNP_VERSION_MAJOR  # noqa: F401\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nImportError: libcapnpc.so.1.0.1: cannot open shared object file: No such file or directory\n```\nWe catch this and skip as if the module isn't available. Updating to `pycapnp` `2.2.1` solved the issue.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2025-12-05T14:38:18Z",
      "updated_at": "2026-01-26T13:21:10Z",
      "closed_at": null,
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/34016",
      "labels": [
        "Tests"
      ],
      "comment_data": [
        {
          "id": 3799532047,
          "user": "hebasto",
          "body": "> Noticed this on a Fedora (Rawhide) Box that has capnp `1.2.0` (recently updated from 1.1.0) and `pycapnp` `2.1.0` installed, but was skipping `interface_ipc.py` as if the Python module was not available. The failure was that pycanp `2.1.0` tries to load an older shared lib, and fails:\n> \n> ```bash\n> Remaining jobs: [interface_ipc.py]\n> 1/1 - interface_ipc.py failed, Duration: 0 s\n> \n> stdout:\n> \n> \n> stderr:\n> Traceback (most recent call last):\n>   File \"/root/ci_scratch/build/test/functional/interface_ipc.py\", line 20, in <module>\n>     import capnp  # type: ignore[import] # noqa: F401\n>     ^^^^^^^^^^^^\n>   File \"/usr/local/lib64/python3.14/site-packages/capnp/__init__.py\", line 36, in <module>\n>     from .version import version as __version__\n>   File \"/usr/local/lib64/python3.14/site-packages/capnp/version.py\", line 1, in <module>\n>     from .lib.capnp import _CAPNP_VERSION_MAJOR as LIBCAPNP_VERSION_MAJOR  # noqa: F401\n>     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> ImportError: libcapnpc.so.1.0.1: cannot open shared object file: No such file or directory\n> ```\n> \n> We catch this and skip as if the module isn't available. Updating to `pycapnp` `2.2.1` solved the issue.\n\nI can't reproduce the issue:\n```\n# dnf info capnproto 2>&1 | grep Version\nVersion         : 1.3.0\n# pip show pycapnp | grep Version\nVersion: 2.1.0\n# ./build/test/functional/test_runner.py interface_ipc\nTemporary test directory at /tmp/test_runner_₿_🏃_20260126_130625\nRemaining jobs: [interface_ipc.py]\n1/1 - interface_ipc.py passed, Duration: 7 s\n\nTEST             | STATUS    | DURATION\n\ninterface_ipc.py | ✓ Passed  | 7 s\n\nALL              | ✓ Passed  | 7 s (accumulated) \nRuntime: 7 s\n\n```",
          "created_at": "2026-01-26T13:09:32Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 1717,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3799549840,
          "user": "fanquake",
          "body": "> I can't reproduce the issue:\n\nIt's not clear what you tested here. You need to test the capnp shared libs being updated, without updating pycapnp.",
          "created_at": "2026-01-26T13:14:04Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 148,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3799576807,
          "user": "hebasto",
          "body": "> > I can't reproduce the issue:\n> \n> It's not clear what you tested here.\n\nI've tested this claim: \"The failure was that pycanp 2.1.0 tries to load an older shared lib, and fails:\". It wasn't clear that updating capnp is necessary for observing the issue.\n\n> You need to test the capnp shared libs being updated, without updating pycapnp.\n\nWell, this could be tricky as the Rawhide repository doesn't keep the previous `capnproto` version.",
          "created_at": "2026-01-26T13:20:30Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 440,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1256,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3846299633,
      "number": 34387,
      "title": "qa: failure in p2p_private_broadcast.py",
      "body": "Noticed on the test-each-commit job for #32857:\n\nhttps://github.com/bitcoin/bitcoin/actions/runs/21254115595/job/61163625701?pr=32857\n\n```\n node1 2026-01-22T16:33:40.225497Z [http] [httpserver.cpp:308] [http_request_cb] [http] Received a POST request for / from 127.0.0.1:40648 \n node1 2026-01-22T16:33:40.225559Z [httpworker.1] [rpc/request.cpp:243] [parse] [rpc] ThreadRPCServer method=getrawmempool user=__cookie__ \n test  2026-01-22T16:33:40.276527Z TestFramework.utils (ERROR): wait_until() failed. Predicate: '''' \n                                           self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n                                   '''\n test  2026-01-22T16:33:40.276665Z TestFramework (ERROR): Unexpected exception \n                                   Traceback (most recent call last):\n                                     File \"/home/runner/work/bitcoin/bitcoin/test/functional/test_framework/test_framework.py\", line 142, in main\n                                       self.run_test()\n                                     File \"/home/runner/work/bitcoin/bitcoin/ci_build/test/functional/p2p_private_broadcast.py\", line 331, in run_test\n                                       self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n                                     File \"/home/runner/work/bitcoin/bitcoin/test/functional/test_framework/test_framework.py\", line 746, in wait_until\n                                       return wait_until_helper_internal(test_function, timeout=timeout, timeout_factor=self.options.timeout_factor, check_interval=check_interval)\n                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/home/runner/work/bitcoin/bitcoin/test/functional/test_framework/util.py\", line 420, in wait_until_helper_internal\n                                       raise AssertionError(\"Predicate {} not true after {} seconds\".format(predicate_source, timeout))\n                                   AssertionError: Predicate ''''\n                                           self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n                                   ''' not true after 60 seconds\n test  2026-01-22T16:33:40.277541Z TestFramework (DEBUG): Closing down network thread \n test  2026-01-22T16:33:40.327831Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later. \n```",
      "state": "open",
      "user": "Sjors",
      "created_at": "2026-01-23T07:56:48Z",
      "updated_at": "2026-01-26T12:05:45Z",
      "closed_at": null,
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/34387",
      "labels": [
        "CI failed"
      ],
      "comment_data": [
        {
          "id": 3788887909,
          "user": "fanquake",
          "body": "cc @vasild ",
          "created_at": "2026-01-23T08:00:23Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 11,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3789870531,
          "user": "vasild",
          "body": "The failure is because a network-specific connection sneaked before the private broadcast one. It is a race in the test, I am considering how to best resolve it.\n\nLonger explanation: the tx originator bitcoind makes 10 initial connections as expected (apparently none of them are to Tor). Then the test sends a private broadcast and expects that the next connection to be made is a private broadcast and thus redirects it to `nodes[1]` instead of to a dummy Python P2P node. So, `nodes[1]` receives the network specific connection to Tor instead of the private broadcast connection. So, `nodes[1]` never receives the transaction and its mempool stays empty.",
          "created_at": "2026-01-23T11:44:26Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 657,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3799006179,
          "user": "maflcko",
          "body": "https://github.com/bitcoin/bitcoin/actions/runs/21301629469/job/61320536532?pr=34158#step:8:12747",
          "created_at": "2026-01-26T11:02:13Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 97,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3799237308,
          "user": "vasild",
          "body": "Fix in https://github.com/bitcoin/bitcoin/pull/34410",
          "created_at": "2026-01-26T12:05:45Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 52,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2582,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2753640191,
      "number": 31550,
      "title": "build: v28.1rc2 test/test_bitcoin-base58_tests.o errors on freebsd 14.2",
      "body": "### Is there an existing issue for this?\n\n- [X] I have searched the existing issues\n\n### Current behaviour\n\nRunning `gmake` errors when trying to build v28.1rc2 on FreeBSD 14.2:\r\n\r\n```\r\n% gmake\r\nMaking all in src\r\ngmake[1]: Entering directory '/home/user/builds/bitcoin/src'\r\ngmake[2]: Entering directory '/home/user/builds/bitcoin/src'\r\ngmake[3]: Entering directory '/home/user/builds/bitcoin'\r\ngmake[3]: Leaving directory '/home/user/builds/bitcoin'\r\n  GEN      obj/build.h\r\n  CXX      test/test_bitcoin-base58_tests.o\r\ntest/base58_tests.cpp:26:22: error: no matching function for call to 'read_json'\r\n   26 |     UniValue tests = read_json(json_tests::base58_encode_decode);\r\n      |                      ^~~~~~~~~\r\n./test/util/json.h:12:10: note: candidate function not viable: no known conversion from 'const unsigned char[1462]' to 'const std::string' (aka 'const basic_string<char>') for 1st argument\r\n   12 | UniValue read_json(const std::string& jsondata);\r\n      |          ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\ntest/base58_tests.cpp:46:22: error: no matching function for call to 'read_json'\r\n   46 |     UniValue tests = read_json(json_tests::base58_encode_decode);\r\n      |                      ^~~~~~~~~\r\n./test/util/json.h:12:10: note: candidate function not viable: no known conversion from 'const unsigned char[1462]' to 'const std::string' (aka 'const basic_string<char>') for 1st argument\r\n   12 | UniValue read_json(const std::string& jsondata);\r\n      |          ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n2 errors generated.\r\ngmake[2]: *** [Makefile:18443: test/test_bitcoin-base58_tests.o] Error 1\r\ngmake[2]: Leaving directory '/home/user/builds/bitcoin/src'\r\ngmake[1]: *** [Makefile:20315: all-recursive] Error 1\r\ngmake[1]: Leaving directory '/home/user/builds/bitcoin/src'\r\ngmake: *** [Makefile:755: all-recursive] Error 1\r\n```\n\n### Expected behaviour\n\nBuild should complete\n\n### Steps to reproduce\n\nAttempt to build v28.1rc2 on FreeBSD 14.2\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nv28.1rc2\n\n### Operating system and version\n\nfreebsd 14.2\n\n### Machine specifications\n\nx86_64 ",
      "state": "closed",
      "user": "grubles",
      "created_at": "2024-12-20T23:46:48Z",
      "updated_at": "2026-01-26T11:01:59Z",
      "closed_at": "2024-12-21T00:59:40Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/31550",
      "labels": [],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2278,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2811242936,
      "number": 31738,
      "title": "Implement dark mode",
      "body": "",
      "state": "closed",
      "user": "Mmabiaa",
      "created_at": "2025-01-26T00:31:48Z",
      "updated_at": "2026-01-26T11:01:58Z",
      "closed_at": "2025-01-26T09:55:22Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/31738",
      "labels": [
        "GUI"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 20,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 97306228,
      "number": 6476,
      "title": "Does not use bind to local address for outgoing connections",
      "body": "I have several IPv4 / IPv6 addresses on a host and I wish to use a specific one. So I set up the bind so it would use that.  It seems to be using that for the bind() in the listen socket but not for the outgoing connections.\n\nI've tried settings externalip.  That only seems to change the \"localaddresses\" returned by getnetworkinfo. I'm guessing that's mostly useful for NAT.\n",
      "state": "open",
      "user": "kroeckx",
      "created_at": "2015-07-26T10:38:32Z",
      "updated_at": "2026-01-26T04:30:37Z",
      "closed_at": null,
      "comments": 14,
      "url": "https://github.com/bitcoin/bitcoin/issues/6476",
      "labels": [
        "Feature",
        "P2P"
      ],
      "comment_data": [
        {
          "id": 3797857241,
          "user": "8144225309",
          "body": "I'm running 3 node implementations: Core, Knots, and Libre on one VPS with symlinked blocks, so I would benefit from this feature directly.  I'm going to do some reviews then take a crack at this unless someone else is still interested, or if anyone wants to share ideas for this.",
          "created_at": "2026-01-26T04:30:37Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 280,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 437,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2802353222,
      "number": 31702,
      "title": "Wrong/missing package content for macOS, ARM based packages (bitcoin-28.1...)",
      "body": "### Is there an existing issue for this?\n\n- [x] #31720\n\n### Current behaviour\n\nI believe the following two files have the same content (Bitcoin-Qt.app):\n- bitcoin-28.1-arm64-apple-darwin-unsigned.tar.gz\n- bitcoin-28.1-arm64-apple-darwin-unsigned.zip\n\nI think they ought to contain:\n- Bitcoin-Qt.app (bitcoin-28.1-arm64-apple-darwin-unsigned.zip)\n- bitcoind, bitcoin-cli, etc. (bitcoin-28.1-arm64-apple-darwin-unsigned.tar.gz)\n\n... but they both do not contain the bitcoind, bitcoin-cli, etc. (only the \"Bitcoin Core\" package)\n\nAlso the content for the signed versions is correct, and differs in package size.\n\n### Expected behaviour\n\nContent should be similar to the signed versions.\n\n### Steps to reproduce\n\nDownload the packages and look for the (missing) bitcoind, bitcoin-cli files in the unsigned .tar.gz version.\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nPre-built binaries\n\n### What version of Bitcoin Core are you using?\n\n28.1\n\n### Operating system and version\n\nmacOS Sequoia\n\n### Machine specifications\n\nApple Mac",
      "state": "closed",
      "user": "PaddyFlueckiger",
      "created_at": "2025-01-21T16:52:40Z",
      "updated_at": "2026-01-24T11:01:09Z",
      "closed_at": "2025-01-24T20:31:40Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/31702",
      "labels": [
        "macOS"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1136,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3848905564,
      "number": 34394,
      "title": "Closing, because the LLM/AI use here raises doubt that the author understands the change at all",
      "body": "Closing, because the LLM/AI use here raises doubt that the author understands the change at all\r\n\r\n_Originally posted by @maflcko in https://github.com/bitcoin/bitcoin/issues/34356#issuecomment-3790752753_\r\n            Don't know but the why he is taking me so personally. He can gave me some updates where i did the things wrong. I resolved the issue, no matter if i took a help from LLM, how can it reflect on me that i didn't understand the issue. How can he blame on me that i didn't know the changes, Did he ask me anything about this. Please maintain your code of conduct.",
      "state": "closed",
      "user": "crackedhandle",
      "created_at": "2026-01-23T19:42:54Z",
      "updated_at": "2026-01-23T19:45:26Z",
      "closed_at": "2026-01-23T19:45:26Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34394",
      "labels": [],
      "comment_data": [
        {
          "id": 3792057347,
          "user": "crackedhandle",
          "body": "@BitcoinPRReadingGroup the worst culuture of bitcoin is this.",
          "created_at": "2026-01-23T19:44:51Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 61,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 674,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3441918983,
      "number": 33458,
      "title": "Documentation trap when using -bind in conjunction with (automatically configured) Tor hidden services",
      "body": "To start with the conclusion: everything appears to work as _intended_, so this should probably not be considered a bug as such, but some logging and telemetry output could be improved to make things clearer.\n\nIf you use -bind to manually specify which (public) IPs to listen to, Bitcoin Core will also no longer create the (local) default socket for incoming Tor connections at 127.0.01:8334 unless you specify it manually in your list - this is probably working as intended. When automatically creating a Tor hidden service, it will instead be routed to the public IPv4 port, and incoming Tor connections still work just fine.\n\nHowever, without the dedicated Tor socket, Bitcoin Core is unable to distinguish between regular IPv4 connections and Tor connections, so all of the latter will be counted as the former.\n\nThe specific case that had me scratching my head for a bit: -netinfo reported zero incoming Tor connections\n\n```\n         ipv4    ipv6   onion   total   block\nin        291      28       0     319\nout         5       3       2      10       2\ntotal     296      31       2     329\n```\n\nwhile the true number of incoming Tor connections was 29.\n\n```\nss -tupan | grep tor | grep 8333 | wc -l\n29\n```\n\nAs expected, removing the -bind statements from the config and restarting fixed it.\n\n```\n         ipv4    ipv6   onion   total   block\nin         25       4       5      34\nout         4       1       5      10       2\ntotal      29       5      10      44\n```\n\nWhile the documentation for -bind hints towards why this is the case, Bitcoin Core gives no indication in the logs or the -netinfo output that the configuration is suboptimal, and I feel like maybe it should do that just to save people (like me) from getting confused.\n\nMaybe during startup, if no Tor socket is created and a Tor hidden service is created, it should add something like \"Warning: -bind was specified but lacks a dedicated Tor socket; incoming Tor connections will be counted as regular connections\", and when using -netinfo it should show a \"?\" or \"-\" instead of \"0\".",
      "state": "open",
      "user": "ArmchairCryptologist",
      "created_at": "2025-09-22T17:08:17Z",
      "updated_at": "2026-01-23T19:38:17Z",
      "closed_at": null,
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/33458",
      "labels": [
        "Docs"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2164,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2353376259,
      "number": 30289,
      "title": "Cluster mempool tracking issue",
      "body": "What to review next:\n\n* #34257 \n\n---\n\nPlan:\n* Lowest level: generic utilities:\n  * [x] [#29242 FeeFrac type](https://github.com/bitcoin/bitcoin/pull/29242)\n    * [x] [#30535 Add FeeFrac::EvaluateFee](https://github.com/bitcoin/bitcoin/pull/30535)\n      * [x] [#32240 Fix integer overflow in FeeFrac fuzz test](https://github.com/bitcoin/bitcoin/pull/32240)\n      * [x] [#32300 Fix different overflow in FeeFrac fuzz test](https://github.com/bitcoin/bitcoin/pull/32300)\n  * [x] [#30160 BitSet type](https://github.com/bitcoin/bitcoin/pull/30160)\n  * [x] [#30161 VecDeque type](https://github.com/bitcoin/bitcoin/pull/30161)\n* Low level: operations on `DepGraph` type (dependencies/linearizations for a single cluster)\n  * [x] [#30126 Base linearization algorithm](https://github.com/bitcoin/bitcoin/pull/30126)\n    * [x] [#30605 Split tests from tests-of-tests](https://github.com/bitcoin/bitcoin/pull/30605)\n    * [x] [#30857 Extend `DepGraph` functionality](https://github.com/bitcoin/bitcoin/pull/30857)\n  * [x] [#30285 Merging and postprocessing of linearizations](https://github.com/bitcoin/bitcoin/pull/30285)\n  * [x] [#30286 Optimized candidate search](https://github.com/bitcoin/bitcoin/pull/30286)\n  * [x] [#32545 Replace linearization with SFL](https://github.com/bitcoin/bitcoin/pull/32545)\n    * [x] [#34259 SFL chunk minimization](https://github.com/bitcoin/bitcoin/pull/34259)\n  * [ ] [#34023 SFL optimizations](https://github.com/bitcoin/bitcoin/pull/34023)\n    * [ ] [#34138 SFL cost model](https://github.com/bitcoin/bitcoin/pull/34138)\n* Intermediate level: operations on `TxGraph` type (dependencies/linearizations for the entire mempool)\n  * [x] [#31363 TxGraph basics](https://github.com/bitcoin/bitcoin/pull/31363)\n    * [x] [#32151 TxGraph basics follow-up](https://github.com/bitcoin/bitcoin/pull/32151)\n    * [x] [#32177 TxGraph increase fuzz coverage](https://github.com/bitcoin/bitcoin/pull/32177)\n    * [x] [#32191 Make TxGraph fuzzing more deterministic](https://github.com/bitcoin/bitcoin/pull/32191)\n    * [x] [#33354 Use enum Level instead of bool main_only](https://github.com/bitcoin/bitcoin/pull/33354)\n    * [x] [#33862 Drop support for `TxGraph::Ref` move assignment](https://github.com/bitcoin/bitcoin/pull/33862)\n    * ~~[#33335 Randomize order of transactions](https://github.com/bitcoin/bitcoin/pull/33335)~~\n    * [ ] [#34257 Deterministic order of transactions](https://github.com/bitcoin/bitcoin/pull/34257)\n  * [x] [#31444 TxGraph mining/eviction](https://github.com/bitcoin/bitcoin/pull/31444)\n    * [x] [#33469 Use `std::unordered_set` for skipped clusters](https://github.com/bitcoin/bitcoin/pull/33469)\n  * [x] [#31553 TxGraph reorgs](https://github.com/bitcoin/bitcoin/pull/31553)\n  * [x] [#32263 TxGraph work controls](https://github.com/bitcoin/bitcoin/pull/32263)\n  * [x] [#33157 TxGraph memory usage](https://github.com/bitcoin/bitcoin/pull/33157)\n  * [x] [#34085 TxGraph exploiting SFL better](https://github.com/bitcoin/bitcoin/pull/34085)\n* High level: changes to mempool/validation\n  * [x] [#31122 Changesets for mempool](https://github.com/bitcoin/bitcoin/pull/31122)\n  * [x] [#33629 Cluster mempool implementation](https://github.com/bitcoin/bitcoin/pull/33629)\n    * ~~[#28676 Old version](https://github.com/bitcoin/bitcoin/pull/28676)~~\n  * [x] [#33591 Cluster mempool optimizations and cleanups](https://github.com/bitcoin/bitcoin/pull/33591)\n  * [x] [#34384 Remove epoch-based graph traversal](https://github.com/bitcoin/bitcoin/pull/34384)",
      "state": "open",
      "user": "sipa",
      "created_at": "2024-06-14T13:21:36Z",
      "updated_at": "2026-01-23T18:36:36Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/30289",
      "labels": [
        "Tracking Issue"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3535,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3834142125,
      "number": 34354,
      "title": "Windows CI failure: restore wallet test case related to pruned blockchain in `wallet_assumeutxo.py` is failing.",
      "body": "ISTM that the [Windows, ucrt, test cross-built CI failure](https://github.com/bitcoin/bitcoin/actions/runs/21172425203/job/60894641918?pr=33014) is unrelated, a restore wallet test case related to pruned blockchain in `wallet_assumeutxo.py` is failing.\r\n\r\n<details open>\r\n<summary>From the logs:</summary>\r\n\r\n```zsh\r\n2026-01-20T13:41:07.2385503Z 2026-01-20T13:41:04.152353Z TestFramework (INFO): Ensuring wallet can't be restored from a backup that was created before the pruneheight (pruned node)\r\n2026-01-20T13:41:07.2386535Z \r\n2026-01-20T13:41:07.2386839Z 2026-01-20T13:41:06.479889Z TestFramework (ERROR): Unexpected exception\r\n2026-01-20T13:41:07.2387306Z \r\n2026-01-20T13:41:07.2387503Z Traceback (most recent call last):\r\n2026-01-20T13:41:07.2387815Z \r\n2026-01-20T13:41:07.2388269Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\util.py\", line 166, in try_rpc\r\n2026-01-20T13:41:07.2388901Z \r\n2026-01-20T13:41:07.2389049Z     fun(*args, **kwds)\r\n2026-01-20T13:41:07.2389318Z \r\n2026-01-20T13:41:07.2389432Z     ~~~^^^^^^^^^^^^^^^\r\n2026-01-20T13:41:07.2389660Z \r\n2026-01-20T13:41:07.2390180Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\coverage.py\", line 50, in __call__\r\n2026-01-20T13:41:07.2390808Z \r\n2026-01-20T13:41:07.2391156Z     return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n2026-01-20T13:41:07.2391651Z \r\n2026-01-20T13:41:07.2392093Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\authproxy.py\", line 156, in __call__\r\n2026-01-20T13:41:07.2392771Z \r\n2026-01-20T13:41:07.2392996Z     raise JSONRPCException(response['error'], status)\r\n2026-01-20T13:41:07.2393424Z \r\n2026-01-20T13:41:07.2395532Z test_framework.authproxy.JSONRPCException: filesystem error: cannot remove: The process cannot access the file because it is being used by another process [D:\\a\\_temp\\test_runner_₿_🏃_20260120_132914\\wallet_assumeutxo_56\\node3\\regtest\\w2\\wallet.dat] (-1)\r\n2026-01-20T13:41:07.2397271Z \r\n2026-01-20T13:41:07.2397277Z \r\n2026-01-20T13:41:07.2397281Z \r\n2026-01-20T13:41:07.2397613Z During handling of the above exception, another exception occurred:\r\n2026-01-20T13:41:07.2398102Z \r\n2026-01-20T13:41:07.2398107Z \r\n2026-01-20T13:41:07.2398112Z \r\n2026-01-20T13:41:07.2398334Z Traceback (most recent call last):\r\n2026-01-20T13:41:07.2398622Z \r\n2026-01-20T13:41:07.2399135Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\test_framework.py\", line 142, in main\r\n2026-01-20T13:41:07.2399796Z \r\n2026-01-20T13:41:07.2399922Z     self.run_test()\r\n2026-01-20T13:41:07.2400161Z \r\n2026-01-20T13:41:07.2400286Z     ~~~~~~~~~~~~~^^\r\n2026-01-20T13:41:07.2400474Z \r\n2026-01-20T13:41:07.2400948Z   File \"D:\\a\\bitcoin\\bitcoin/test/functional/wallet_assumeutxo.py\", line 267, in run_test\r\n2026-01-20T13:41:07.2401587Z \r\n2026-01-20T13:41:07.2401827Z     self.test_restore_wallet_pruneheight(n3)\r\n2026-01-20T13:41:07.2402338Z \r\n2026-01-20T13:41:07.2402476Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^\r\n2026-01-20T13:41:07.2402806Z \r\n2026-01-20T13:41:07.2403384Z   File \"D:\\a\\bitcoin\\bitcoin/test/functional/wallet_assumeutxo.py\", line 99, in test_restore_wallet_pruneheight\r\n2026-01-20T13:41:07.2404151Z \r\n2026-01-20T13:41:07.2404691Z     assert_raises_rpc_error(-4, error_message, n3.restorewallet, \"w2\", \"backup_w2.dat\")\r\n2026-01-20T13:41:07.2405294Z \r\n2026-01-20T13:41:07.2405553Z     ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n2026-01-20T13:41:07.2405970Z \r\n2026-01-20T13:41:07.2406496Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\util.py\", line 157, in assert_raises_rpc_error\r\n2026-01-20T13:41:07.2407238Z \r\n2026-01-20T13:41:07.2407544Z     assert try_rpc(code, message, fun, *args, **kwds), \"No exception raised\"\r\n2026-01-20T13:41:07.2408097Z \r\n2026-01-20T13:41:07.2408261Z            ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n2026-01-20T13:41:07.2408598Z \r\n2026-01-20T13:41:07.2409048Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\util.py\", line 170, in try_rpc\r\n2026-01-20T13:41:07.2409645Z \r\n2026-01-20T13:41:07.2410041Z     raise AssertionError(\"Unexpected JSONRPC error code %i\" % e.error[\"code\"])\r\n2026-01-20T13:41:07.2410583Z \r\n2026-01-20T13:41:07.2410797Z AssertionError: Unexpected JSONRPC error code -1\r\n2026-01-20T13:41:07.2411215Z \r\n2026-01-20T13:41:07.2411925Z 2026-01-20T13:41:06.484138Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\r\n2026-01-20T13:41:07.2412795Z \r\n2026-01-20T13:41:07.2413676Z 2026-01-20T13:41:06.484270Z TestFramework (WARNING): Not cleaning up dir D:\\a\\_temp\\test_runner_₿_🏃_20260120_132914\\wallet_assumeutxo_56\r\n2026-01-20T13:41:07.2414525Z \r\n2026-01-20T13:41:07.2415646Z 2026-01-20T13:41:06.484375Z TestFramework (ERROR): Test failed. Test logging available at D:\\a\\_temp\\test_runner_₿_🏃_20260120_132914\\wallet_assumeutxo_56/test_framework.log\r\n2026-01-20T13:41:07.2416737Z \r\n\r\n2026-01-20T13:42:33.3464929Z wallet_assumeutxo.py                                                             | ✖ Failed  | 8 s\r\n2026-01-20T13:42:33.3465209Z \r\n2026-01-20T13:42:33.3465460Z ALL                                                                              | ✖ Failed  | 2893 s (accumulated) \r\n2026-01-20T13:42:33.3465784Z Runtime: 796 s\r\n\r\n```\r\n</details>\r\n\r\n_Originally posted by @rkrux in https://github.com/bitcoin/bitcoin/issues/33014#issuecomment-3773073528_\r\n            ",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-20T15:07:00Z",
      "updated_at": "2026-01-23T12:57:16Z",
      "closed_at": null,
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/34354",
      "labels": [
        "Wallet",
        "Windows",
        "Tests",
        "CI failed"
      ],
      "comment_data": [
        {
          "id": 3783234678,
          "user": "fjahr",
          "body": "I proposed a fix here: [#34377](https://github.com/bitcoin/bitcoin/pull/34377)",
          "created_at": "2026-01-22T08:47:42Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 78,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3790072074,
          "user": "maflcko",
          "body": "https://github.com/bitcoin/bitcoin/actions/runs/21285353740/job/61266529251?pr=34388#step:12:276:\n\n```\n398/451 - wallet_assumeutxo.py failed, Duration: 8 s\n\nstdout:\n2026-01-23T12:31:24.007821Z TestFramework (INFO): PRNG seed is: 249974898428252399\n\n2026-01-23T12:31:24.037053Z TestFramework (INFO): Initializing test directory D:\\a\\_temp\\test_runner_₿_🏃_20260123_122001\\wallet_assumeutxo_56\n\n2026-01-23T12:31:25.327870Z TestFramework (INFO): -- Testing assumeutxo\n\n2026-01-23T12:31:25.328814Z TestFramework (INFO): Creating a UTXO snapshot at height 299\n\n2026-01-23T12:31:26.836907Z TestFramework (INFO): Loading snapshot into second node from D:\\a\\_temp\\test_runner_₿_🏃_20260123_122001\\wallet_assumeutxo_56\\node0\\regtest\\utxos.dat\n\n2026-01-23T12:31:26.851777Z TestFramework (INFO): Backup from the snapshot height can be loaded during background sync\n\n2026-01-23T12:31:26.859014Z TestFramework (INFO): Backup from before the snapshot height can't be loaded during background sync\n\n2026-01-23T12:31:26.865502Z TestFramework (INFO): Backup from the snapshot height can be loaded during background sync (pruned node)\n\n2026-01-23T12:31:26.891211Z TestFramework (INFO): Backup from before the snapshot height can't be loaded during background sync (pruned node)\n\n2026-01-23T12:31:26.897530Z TestFramework (INFO): Test loading descriptors during background sync\n\n2026-01-23T12:31:26.919150Z TestFramework (INFO): Test that rescanning blocks from before the snapshot fails when blocks are not available from the background sync yet\n\n2026-01-23T12:31:26.919801Z TestFramework (INFO): Restarting node to stop at height 359\n\n2026-01-23T12:31:27.580649Z TestFramework (INFO): Restarted node before snapshot validation completed, reloading...\n\n2026-01-23T12:31:28.106292Z TestFramework (INFO): Ensuring wallet can be restored from a backup that was created before the snapshot height\n\n2026-01-23T12:31:28.164076Z TestFramework (INFO): Check balance of a wallet that is active during snapshot completion\n\n2026-01-23T12:31:29.773917Z TestFramework (INFO): Ensuring descriptors can be loaded after background sync\n\n2026-01-23T12:31:29.817454Z TestFramework (INFO): Ensuring wallet can't be restored from a backup that was created before the pruneheight (pruned node)\n\n2026-01-23T12:31:31.955307Z TestFramework (ERROR): Unexpected exception\n\nTraceback (most recent call last):\n\n  File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\util.py\", line 166, in try_rpc\n\n    fun(*args, **kwds)\n\n    ~~~^^^^^^^^^^^^^^^\n\n  File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\coverage.py\", line 50, in __call__\n\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\n\n  File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\authproxy.py\", line 156, in __call__\n\n    raise JSONRPCException(response['error'], status)\n\ntest_framework.authproxy.JSONRPCException: filesystem error: cannot remove: The process cannot access the file because it is being used by another process [D:\\a\\_temp\\test_runner_₿_🏃_20260123_122001\\wallet_assumeutxo_56\\node3\\regtest\\w2_pruneheight\\wallet.dat] (-1)\n\n\n\nDuring handling of the above exception, another exception occurred:\n\n\n\nTraceback (most recent call last):\n\n  File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\test_framework.py\", line 142, in main\n\n    self.run_test()\n\n    ~~~~~~~~~~~~~^^\n\n  File \"D:\\a\\bitcoin\\bitcoin/test/functional/wallet_assumeutxo.py\", line 267, in run_test\n\n    self.test_restore_wallet_pruneheight(n3)\n\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^\n\n  File \"D:\\a\\bitcoin\\bitcoin/test/functional/wallet_assumeutxo.py\", line 99, in test_restore_wallet_pruneheight\n\n    assert_raises_rpc_error(-4, error_message, n3.restorewallet, \"w2_pruneheight\", \"backup_w2.dat\")\n\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n  File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\util.py\", line 157, in assert_raises_rpc_error\n\n    assert try_rpc(code, message, fun, *args, **kwds), \"No exception raised\"\n\n           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n  File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\util.py\", line 170, in try_rpc\n\n    raise AssertionError(\n\n        \"Expected substring not found in error message:\\nsubstring: '{}'\\nerror message: '{}'.\".format(\n\n            message, e.error['message']))\n\nAssertionError: Expected substring not found in error message:\n\nsubstring: 'Wallet loading failed. Prune: last wallet synchronisation goes beyond pruned data. You need to -reindex (download the whole blockchain again in case of a pruned node)'\n\nerror message: 'filesystem error: cannot remove: The process cannot access the file because it is being used by another process [D:\\a\\_temp\\test_runner_₿_🏃_20260123_122001\\wallet_assumeutxo_56\\node3\\regtest\\w2_pruneheight\\wallet.dat]'.\n\n2026-01-23T12:31:32.009883Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n\n2026-01-23T12:31:32.010026Z TestFramework (WARNING): Not cleaning up dir D:\\a\\_temp\\test_runner_₿_🏃_20260123_122001\\wallet_assumeutxo_56\n\n2026-01-23T12:31:32.010132Z TestFramework (ERROR): Test failed. Test logging available at D:\\a\\_temp\\test_runner_₿_🏃_20260123_122001\\wallet_assumeutxo_56/test_framework.log\n\n2026-01-23T12:31:32.010359Z TestFramework (ERROR): \n\n2026-01-23T12:31:32.010667Z TestFramework (ERROR): Hint: Call D:\\a\\bitcoin\\bitcoin\\test\\functional\\combine_logs.py 'D:\\a\\_temp\\test_runner_₿_🏃_20260123_122001\\wallet_assumeutxo_56' to consolidate all logs\n\n2026-01-23T12:31:32.010799Z TestFramework (ERROR): \n\n2026-01-23T12:31:32.010875Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\n\n2026-01-23T12:31:32.010978Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\n\n2026-01-23T12:31:32.011060Z TestFramework (ERROR): \n\n\n\nstderr:\n[node 3] Cleaning up leftover process\n\n[node 2] Cleaning up leftover process\n\n[node 1] Cleaning up leftover process\n\n[node 0] Cleaning up leftover process\n\n\n\nCombine the logs and print the last 99999999 lines ...\n\n============\nCombined log for D:\\a\\_temp/test_runner_₿_🏃_20260123_122001/wallet_assumeutxo_56:\n============\n",
          "created_at": "2026-01-23T12:43:21Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 6249,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3790120337,
          "user": "fjahr",
          "body": "Seems like the problem is rather internal to the `restorewallet`, probably better if someone with who has a windows enviroment can try to reproduce it, I would need to set it up first...",
          "created_at": "2026-01-23T12:57:16Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 186,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 5519,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2804781580,
      "number": 31708,
      "title": "build: `WITH_MULTIPROCESS=ON` should fail if libmultiprocess is missing",
      "body": "Currently it warns, and then just fails to properly configure:\n```bash\ncmake -B build -DWITH_MULTIPROCESS=ON\n<snip>\nCMake Warning at CMakeLists.txt:146 (find_package):\n  By not providing \"FindLibmultiprocess.cmake\" in CMAKE_MODULE_PATH this\n  project has asked CMake to find a package configuration file provided by\n  \"Libmultiprocess\", but CMake did not find one.\n\n  Could not find a package configuration file provided by \"Libmultiprocess\"\n  with any of the following names:\n\n    LibmultiprocessConfig.cmake\n    libmultiprocess-config.cmake\n\n  Add the installation prefix of \"Libmultiprocess\" to CMAKE_PREFIX_PATH or\n  set \"Libmultiprocess_DIR\" to a directory containing one of the above files.\n  If \"Libmultiprocess\" provides a separate development package or SDK, be\n  sure it has been installed.\n\n\n-- Could NOT find LibmultiprocessNative (missing: LibmultiprocessNative_DIR)\n<snip>\nCMake Error at src/ipc/CMakeLists.txt:12 (target_capnp_sources):\n  Unknown CMake command \"target_capnp_sources\".\n\n\n-- Configuring incomplete, errors occurred!\n```",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-01-22T16:06:12Z",
      "updated_at": "2026-01-23T11:00:27Z",
      "closed_at": "2025-01-23T09:46:45Z",
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/31708",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1121,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1928418208,
      "number": 28598,
      "title": "assumeutxo: Ensure transactions are not presented as confirmed until background sync is complete",
      "body": "AFAIK currently if assumeutxo were to be used, transactions might get shown as confirmed even while the entire chainstate is unconfirmed. This should be fixed before releasing with assumeutxo enabled for mainnet.",
      "state": "open",
      "user": "luke-jr",
      "created_at": "2023-10-05T14:21:03Z",
      "updated_at": "2026-01-23T09:54:17Z",
      "closed_at": null,
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/28598",
      "labels": [
        "Wallet"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 309,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3225420780,
      "number": 32955,
      "title": "Bitcoin Core v29.0 incorrectly enters IBD mode when only ~600 blocks behind, preventing normal sync",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nHi, I have a full node on a development machine that is not always run. It runs a self compiled none modified v29.0 node as systemd service on an Ubuntu 24.04 system. I had it twice now that the node, after not using it for a few days would go into IBD mode. This time I tried rebuilding the chain state but it would only go as far as the same block it was stuck on before. By running `bitcoin-cli -conf=/mnt/btc/.bitcoin/bitcoin.conf reconsiderblock 000000000000000000009d1dd2f71099471a348f4074285707b17e0588c41002` it would synced 48 blocks to then get stuck again. Running reconsiderblock again using `bitcoin-cli -conf=/mnt/btc/.bitcoin/bitcoin.conf reconsiderblock $(bitcoin-cli -conf=/mnt/btc/.bitcoin/bitcoin.conf getbestblockhash)` did not trigger the sync to continue. After restarting with parameters -minimumchainwork=0 -maxtipage=31536000 it is now syncing again normally.\n\n### Expected behaviour\n\nShould sync normally without manual intervention\n\n### Steps to reproduce\n\nTurn of the PC normally and let it fall behind a few days. I cannot say how reproducible this is since it only happened twice so far and it does not happen often that the machine is not used for more than ~12 hours. With shorter times offline it seems not to happen.\n\n### Relevant log output\n\nThis is my startup log from a try where it was in IBD:\n\nJul 12 10:48:31 linuxpc systemd[1]: Starting bitcoind.service - Bitcoin Daemon...\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Bitcoin Core version v29.0 (release build)\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Using the 'x86_shani(1way,2way)' SHA256 implementation\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Using RdSeed as an additional entropy source\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Using RdRand as an additional entropy source\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Default data directory /nonexistent/.bitcoin\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Using data directory /mnt/btc/.bitcoin\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config file: /mnt/btc/.bitcoin/bitcoin.conf\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config file arg: bind=\"0.0.0.0\"\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config file arg: checkblocks=\"24\"\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config file arg: checklevel=\"0\"\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config file arg: dbcache=\"8000\"\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config file arg: listen=\"1\"\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config file arg: maxconnections=\"24\"\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config file arg: port=\"8333\"\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config file arg: rpcallowip=\"192.168.1.0/24\"\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config file arg: rpcbind=\"0.0.0.0\"\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config file arg: rpcpassword=****\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config file arg: rpcport=\"8332\"\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config file arg: rpcuser=****\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config file arg: server=\"1\"\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config file arg: txindex=\"1\"\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Setting file arg: wallet = [\"cormorant\"]\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Command-line arg: conf=\"/mnt/btc/.bitcoin/bitcoin.conf\"\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Command-line arg: datadir=\"/mnt/btc/.bitcoin\"\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Command-line arg: startupnotify=\"systemd-notify --ready\"\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Using at most 24 automatic connections (65535 file descriptors available)\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z scheduler thread start\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Binding RPC on address 0.0.0.0 port 8332\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z WARNING: the RPC server is not safe to expose to untrusted networks such as the public internet\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcauth for rpcauth auth generation.\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Starting HTTP server with 16 worker threads\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Using wallet directory /mnt/btc/.bitcoin\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z init message: Verifying wallet(s)…\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Using SQLite Version 3.45.1\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Using wallet /mnt/btc/.bitcoin/cormorant\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Using /16 prefix for IP bucketing\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z init message: Loading P2P addresses…\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Loaded 67617 addresses from peers.dat  132ms\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z init message: Loading banlist…\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z SetNetworkActive: true\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Cache configuration:\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z * Using 2.0 MiB for block index database\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z * Using 1000.0 MiB for transaction index database\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z * Using 8.0 MiB for chain state database\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z * Using 6990.0 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Script verification uses 15 additional threads\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Using obfuscation key for blocksdir *.dat files (/mnt/btc/.bitcoin/blocks): 'cb7f2abf983a0e66'\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Opening LevelDB in /mnt/btc/.bitcoin/blocks/index\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Opened LevelDB successfully\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Using obfuscation key for /mnt/btc/.bitcoin/blocks/index: 0000000000000000\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Using 16 MiB out of 16 MiB requested for signature cache, able to store 524288 elements\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Using 16 MiB out of 16 MiB requested for script execution cache, able to store 524288 elements\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z init message: Loading block index…\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Assuming ancestors of block 00000000000000000001b658dd1120e82e66d2790811f89ede9742ada3ed6d77 have valid signatures.\nJul 12 10:48:31 linuxpc bitcoind[335661]: 2025-07-12T13:48:31Z Setting nMinimumChainWork=0000000000000000000000000000000000000000b1f3b93b65b16d035a82be84\nJul 12 10:48:34 linuxpc bitcoind[335661]: 2025-07-12T13:48:34Z LoadBlockIndexDB: last block file = 5021\nJul 12 10:48:34 linuxpc bitcoind[335661]: 2025-07-12T13:48:34Z LoadBlockIndexDB: last block file info: CBlockFileInfo(blocks=45, size=62616878, heights=904539...904606, time=2025-07-08...2025-07-08)\nJul 12 10:48:34 linuxpc bitcoind[335661]: 2025-07-12T13:48:34Z Checking all blk files are present...\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Initializing chainstate Chainstate [ibd] @ height -1 (null)\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Opening LevelDB in /mnt/btc/.bitcoin/chainstate\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Opened LevelDB successfully\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Using obfuscation key for /mnt/btc/.bitcoin/chainstate: 922d01a00a52f620\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Loaded best chain: hashBestChain=000000000000000000009d1dd2f71099471a348f4074285707b17e0588c41002 height=904558 date=2025-07-08T05:32:02Z progress=0.998569\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z init message: Verifying blocks…\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Verifying last 24 blocks at level 0\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Verification progress: 0%\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Verification progress: 12%\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Verification progress: 20%\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Verification progress: 33%\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Verification progress: 41%\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Verification progress: 50%\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Verification progress: 62%\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Verification progress: 70%\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Verification progress: 83%\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Verification progress: 91%\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Verification: No coin database inconsistencies in last 24 blocks (0 transactions)\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Block index and chainstate loaded\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Opening LevelDB in /mnt/btc/.bitcoin/indexes/txindex\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Opened LevelDB successfully\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Using obfuscation key for /mnt/btc/.bitcoin/indexes/txindex: 0000000000000000\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Using SQLite Version 3.45.1\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Using wallet /mnt/btc/.bitcoin/cormorant\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z init message: Loading wallet…\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z [cormorant] Wallet file version = 10500, last client version = 290000\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z [cormorant] Descriptors: 0, Descriptor Keys: 0 plaintext, 0 encrypted, 0 total.\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z [cormorant] Wallet completed loading in               0ms\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z [cormorant] setKeyPool.size() = 0\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z [cormorant] mapWallet.size() = 0\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z [cormorant] m_address_book.size() = 0\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Setting NODE_NETWORK on non-prune mode\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z block tree size = 904607\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z nBestHeight = 904558\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z initload thread start\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Bound to 0.0.0.0:8333\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z torcontrol thread start\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Loaded 0 addresses from \"anchors.dat\"\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Loading 14572 mempool transactions from file...\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z txindex thread start\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z 0 block-relay-only anchors will be tried for connections.\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z init message: Starting network threads…\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z net thread start\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z addcon thread start\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z dnsseed thread start\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Waiting 300 seconds before querying DNS seeds.\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z init message: Done loading\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z opencon thread start\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z msghand thread start\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z txindex is enabled at height 904559\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z txindex thread exit\nJul 12 10:48:35 linuxpc systemd[1]: Started bitcoind.service - Bitcoin Daemon.\nJul 12 10:48:35 linuxpc bitcoind[335661]: 2025-07-12T13:48:35Z Progress loading mempool transactions from file: 10% (tried 1458, 13114 remaining)\nJul 12 10:48:36 linuxpc bitcoind[335661]: 2025-07-12T13:48:36Z Progress loading mempool transactions from file: 20% (tried 2915, 11657 remaining)\nJul 12 10:48:36 linuxpc bitcoind[335661]: 2025-07-12T13:48:36Z Progress loading mempool transactions from file: 30% (tried 4372, 10200 remaining)\nJul 12 10:48:36 linuxpc bitcoind[335661]: 2025-07-12T13:48:36Z New outbound-full-relay v2 peer connected: version: 70016, blocks=905230, peer=0\nJul 12 10:48:36 linuxpc bitcoind[335661]: 2025-07-12T13:48:36Z Progress loading mempool transactions from file: 40% (tried 5829, 8743 remaining)\nJul 12 10:48:37 linuxpc bitcoind[335661]: 2025-07-12T13:48:37Z Progress loading mempool transactions from file: 50% (tried 7286, 7286 remaining)\nJul 12 10:48:37 linuxpc bitcoind[335661]: 2025-07-12T13:48:37Z Progress loading mempool transactions from file: 60% (tried 8744, 5828 remaining)\nJul 12 10:48:37 linuxpc bitcoind[335661]: 2025-07-12T13:48:37Z New outbound-full-relay v1 peer connected: version: 70016, blocks=905230, peer=1\nJul 12 10:48:37 linuxpc bitcoind[335661]: 2025-07-12T13:48:37Z Progress loading mempool transactions from file: 70% (tried 10201, 4371 remaining)\nJul 12 10:48:37 linuxpc bitcoind[335661]: 2025-07-12T13:48:37Z Progress loading mempool transactions from file: 80% (tried 11658, 2914 remaining)\nJul 12 10:48:37 linuxpc bitcoind[335661]: 2025-07-12T13:48:37Z Progress loading mempool transactions from file: 90% (tried 13115, 1457 remaining)\nJul 12 10:48:37 linuxpc bitcoind[335661]: 2025-07-12T13:48:37Z Imported mempool transactions from file: 14572 succeeded, 0 failed, 0 expired, 0 already there, 0 waiting for initial broadcast\nJul 12 10:48:37 linuxpc bitcoind[335661]: 2025-07-12T13:48:37Z initload thread exit\nJul 12 10:48:37 linuxpc bitcoind[335661]: 2025-07-12T13:48:37Z New outbound-full-relay v1 peer connected: version: 70016, blocks=905230, peer=2\nJul 12 10:48:38 linuxpc bitcoind[335661]: 2025-07-12T13:48:38Z New outbound-full-relay v1 peer connected: version: 70016, blocks=905230, peer=3\nJul 12 10:48:39 linuxpc bitcoind[335661]: 2025-07-12T13:48:39Z New outbound-full-relay v1 peer connected: version: 70016, blocks=905230, peer=4\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nv29.0\n\n### Operating system and version\n\nUbuntu 24.04 LTS\n\n### Machine specifications\n\nRyzen 7 5700G, 64GB Ram, NVME Disks, wired network with 550Mbit Optical Fibre Internet with good reliable connection.",
      "state": "open",
      "user": "anhilde",
      "created_at": "2025-07-12T14:30:04Z",
      "updated_at": "2026-01-23T09:53:13Z",
      "closed_at": null,
      "comments": 13,
      "url": "https://github.com/bitcoin/bitcoin/issues/32955",
      "labels": [
        "P2P",
        "Net"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 16126,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3842642077,
      "number": 34378,
      "title": "gethdkeys RPC throws for descriptors with partial xprvs",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nA non-watch-only wallet allows to import descriptors with partial\n    private keys, eg: a multisig descriptor with one private key and\n    one public key. In case an xpub is imported in any such descriptors\n    whose private key the wallet doesn't have, then the `gethdkeys` RPC\n    throws an unhandled error like below when the private keys are\n    requested.\n```\n    ➜ bitcoincli -named gethdkeys private=true\n    error code: -1\n    error message:\n    map::at:  key not found\n```\n\n### Expected behaviour\n\nThe RPC should properly handle the request and not throw.\n\n### Steps to reproduce\n\n1. Create a non watch only wallet.\n2. Call `importdescriptors` RPC with partial private keys, eg:\n```\n[{'desc': 'wsh(multi(2,tprv8ZgxMBicQKsPdaTnUf1FUTUtnupv4pHiwFLsVHPnNHhJtACT3sdj7eMRx1ixLchduVUD4XQzN5qNyZri9NYkrS4kt4tvgyhnW7byhxHzSHw/*,tpubD6NzVbkrYhZ4WzibfNc8tzv6GtMzQ4LnP5YRgM8X5Dia9iPdBdrx3QujdD9fzkwxnGQaBh3q4eFENqJxr8Fzj9bNZhwGndoWJgQQeKTNRWE/*))#m5xlzyqz', 'timestamp': 'now'}]\n```\n3. Call `gethdkeys` RPC.\n```\nbitcoincli -named gethdkeys private=true\n```\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nmaster@d7fd8c6952f288685bf16151b6c1139aad74ffea\n\n### Operating system and version\n\nMacOS\n\n### Machine specifications\n\n_No response_",
      "state": "open",
      "user": "rkrux",
      "created_at": "2026-01-22T12:08:22Z",
      "updated_at": "2026-01-23T09:08:22Z",
      "closed_at": null,
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/34378",
      "labels": [
        "Wallet",
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1499,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 640455898,
      "number": 19303,
      "title": "Replace all of the RecursiveMutex instances with the Mutex ones",
      "body": "**UPD 2023-04-18**. See a shortlist [here](https://github.com/bitcoin/bitcoin/issues/19303#issuecomment-1513337566).\n\n---\n\nThis is a tracking issue for the long-term goal to replace all of the `RecursiveMutex` instances with the `Mutex` ones throughout the code base.\n\nAnthony Williams (_C++ Concurrency in Action_, 2019, 3.3.3 Recursive locking):\n> Most of the time, if you think you want a recursive mutex, you probably need to change your design instead.\n\nAnthony Towns, https://github.com/bitcoin/bitcoin/issues/19303#issuecomment-646956780:\n> ... the actual goal is \"make locking logic easier to follow\" rather than \"remove RecurviseMutex\"\n\nShould be noted, to insure that mutex locking policy has not been changed by accident in non-trivial cases, all of the related code branches must be covered by appropriate lock assertions: `AssertLockHeld()` or `AssertLockNotHeld()`.\n\nAlso Clang Thread Safety Analysis annotations with [Negative Capabilities](https://clang.llvm.org/docs/ThreadSafetyAnalysis.html#negative) are very useful (see #19249) but are not a panacea, of course :)\n\n---\n\n- [x] `RecursiveMutex cs_Shutdown` (#19180)\n- [x] `RecursiveMutex cs_nTimeOffset` (#19189)\n- [x] `RecursiveMutex cs_proxyInfos` (#19190)\n- ~`RecursiveMutex csPathCached` (#19213)~\n- [x] `RecursiveMutex cs_warnings` (#19220)\n- [x] `RecursiveMutex CAddrMan::cs` (#19238)\n- [x] `RecursiveMutex BanMan::m_cs_banned` (#24092, #24097)\n- [x] `RecursiveMutex cs_mapLocalHost` (#24099)\n- [x] `RecursiveMutex CConnman::cs_totalBytesRecv` (#22829)\n- [x] `RecursiveMutex CConnman::cs_totalBytesSent` (#24157)\n- [x] `RecursiveMutex CConnman::m_addr_fetches_mutex` (#22829)\n- [x] `RecursiveMutex CConnman::cs_vAddedNodes` (#22829)\n- [ ] `RecursiveMutex CConnman::m_nodes_mutex` (#32394)\n- [x] `RecursiveMutex CNode::cs_vSend` (#19915)\n- [x] `RecursiveMutex CNode::cs_hSocket` (#19915)\n- [x] `RecursiveMutex CNode::cs_vRecv` (#19915)\n- ~`RecursiveMutex CNode::cs_vProcessMsg` (#24122)~\n- ~`RecursiveMutex CNode::cs_sendProcessing` (#25597)~\n- [x] `RecursiveMutex CNode::cs_SubVer` (#24079)\n- [x] `RecursiveMutex CNode::cs_inventory` (#19347)\n- [x] `RecursiveMutex CNode::cs_addrName` (removed in #22782)\n- [x] `RecursiveMutex CNode::cs_addrLocal` #24108\n- [ ] `RecursiveMutex Peer::TxRelay::m_bloom_filter_mutex`\n- [ ] `RecursiveMutex Peer::TxRelay::m_tx_inventory_mutex` (#24125)\n- [x] `RecursiveMutex CNode::TxRelay::cs_feeFilter` (#18819)\n- ~`RecursiveMutex g_cs_orphans`~\n- [x] `RecursiveMutex g_cs_recent_confirmed_transactions` (#19378)\n- [x] `RecursiveMutex cs_most_recent_block` (#24062)\n- [x] `RecursiveMutex CBlockPolicyEstimator::m_cs_fee_estimator` (#22014)\n- [x] `RecursiveMutex cs_rpcWarmup` (#19399)\n- [x] `RecursiveMutex SingleThreadedSchedulerClient::m_cs_callbacks_pending` (#24069)\n- [ ] `RecursiveMutex BlockManager::cs_LastBlockFile`\n- [ ] `RecursiveMutex FillableSigningProvider::cs_KeyStore`\n- [ ] `RecursiveMutex ArgsManager::cs_args`\n- [x] `RecursiveMutex CChainState::cs_nBlockSequenceId` (#22824)\n- [x] `RecursiveMutex CChainState::m_cs_chainstate` (#24103)\n- ~`RecursiveMutex cs_db`~\n- [ ] `RecursiveMutex DescriptorScriptPubKeyMan::cs_desc_man`\n- [x] `RecursiveMutex cs_wallets` (#19101)\n- [ ] `RecursiveMutex CWallet::cs_wallet` (#19773,  #19833)\n\nand\n\n- `RecursiveMutex CTxMemPool::cs` (#19306, ~#19647~, #19652, #19854, #19872, #19901, #19909, #19917)\n- `RecursiveMutex cs_main`\n",
      "state": "open",
      "user": "hebasto",
      "created_at": "2020-06-17T13:45:18Z",
      "updated_at": "2026-01-22T16:06:56Z",
      "closed_at": null,
      "comments": 18,
      "url": "https://github.com/bitcoin/bitcoin/issues/19303",
      "labels": [
        "Brainstorming",
        "Refactoring"
      ],
      "comment_data": [
        {
          "id": 3785239184,
          "user": "fanquake",
          "body": "[> Steps to reproduce on a fresh install of Fedora 42:](https://github.com/bitcoin/bitcoin/issues/19303#issuecomment-1514926359)\n\nStill reproduces with master (7041648ee5bde974c2361e326dabe624c13059a6) on Fedora 44:\n```bash\nnode0 2026-01-22T16:01:44.726576Z [msghand] [validationinterface.cpp:256] [BlockChecked] [validation] BlockChecked: block hash=3105cec1deeb7460133412e353df1d14e0190438e9efeac81c97e17375dded11 state=Valid \n node1 2026-01-22T16:01:45.040219Z [net] [net.cpp:2213] [SocketHandlerConnected] [net] socket closed, disconnecting peer=0 \n test  2026-01-22T16:01:45.040285Z TestFramework.p2p (DEBUG): Closed connection to: 127.0.0.1:11278 \n node1 2026-01-22T16:01:45.040356Z [net] [net.cpp:572] [CloseSocketDisconnect] [net] Resetting socket for peer=0 \n test  2026-01-22T16:01:45.040523Z TestFramework.p2p (DEBUG): Closed connection to: 127.0.0.1:11278 \n node1 2026-01-22T16:01:45.041358Z [net] [net_processing.cpp:1745] [FinalizeNode] [net] Cleared nodestate for peer=0 \n test  2026-01-22T16:01:45.075641Z TestFramework (ERROR): Unexpected exception \n                                   Traceback (most recent call last):\n                                     File \"/root/ci_scratch/test/functional/test_framework/test_framework.py\", line 142, in main\n                                       self.run_test()\n                                       ~~~~~~~~~~~~~^^\n                                     File \"/root/ci_scratch/./build/test/functional/p2p_segwit.py\", line 263, in run_test\n                                       self.test_v0_outputs_arent_spendable()\n                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n                                     File \"/root/ci_scratch/./build/test/functional/p2p_segwit.py\", line 113, in func_wrapper\n                                       func(self, *args, **kwargs)\n                                       ~~~~^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/root/ci_scratch/./build/test/functional/p2p_segwit.py\", line 481, in test_v0_outputs_arent_spendable\n                                       test_witness_block(self.nodes[0], self.test_node, block, accepted=True, with_witness=False)\n                                       ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/root/ci_scratch/./build/test/functional/p2p_segwit.py\", line 146, in test_witness_block\n                                       p2p.send_and_ping(msg_block(block) if with_witness else msg_no_witness_block(block))\n                                       ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/root/ci_scratch/test/functional/test_framework/p2p.py\", line 703, in send_and_ping\n                                       self.sync_with_ping(timeout=timeout)\n                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n                                     File \"/root/ci_scratch/test/functional/test_framework/p2p.py\", line 716, in sync_with_ping\n                                       self.wait_until(test_function, timeout=timeout)\n                                       ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/root/ci_scratch/test/functional/test_framework/p2p.py\", line 601, in wait_until\n                                       wait_until_helper_internal(test_function, timeout=timeout, lock=p2p_lock, timeout_factor=self.timeout_factor, check_interval=check_interval)\n                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/root/ci_scratch/test/functional/test_framework/util.py\", line 410, in wait_until_helper_internal\n                                       if predicate():\n                                          ~~~~~~~~~^^\n                                     File \"/root/ci_scratch/test/functional/test_framework/p2p.py\", line 598, in test_function\n                                       assert self.is_connected\n                                              ^^^^^^^^^^^^^^^^^\n                                   AssertionError\n test  2026-01-22T16:01:45.078950Z TestFramework (DEBUG): Closing down network thread \n test  2026-01-22T16:01:45.129629Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later. \n test  2026-01-22T16:01:45.129902Z TestFramework (WARNING): Not cleaning up dir /tmp/bitcoin_func_test_0ugn7oru \n test  2026-01-22T16:01:45.130065Z TestFramework (ERROR): Test failed. Test logging available at /tmp/bitcoin_func_test_0ugn7oru/test_framework.log \n test  2026-01-22T16:01:45.130371Z TestFramework (ERROR): \n test  2026-01-22T16:01:45.130583Z TestFramework (ERROR): Hint: Call /root/ci_scratch/test/functional/combine_logs.py '/tmp/bitcoin_func_test_0ugn7oru' to consolidate all logs \n test  2026-01-22T16:01:45.130682Z TestFramework (ERROR): \n test  2026-01-22T16:01:45.130766Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log. \n test  2026-01-22T16:01:45.130886Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues \n test  2026-01-22T16:01:45.130978Z TestFramework (ERROR): \n\n node0 stderr ==================\nWARNING: ThreadSanitizer: lock-order-inversion (potential deadlock) (pid=9169)\n  Cycle in lock order graph: M0 (0xffffad23e630) => M1 (0xffffaf007390) => M2 (0xffffae2cba58) => M0\n\n  Mutex M1 acquired here while holding mutex M0 in thread T8:\n    #0 pthread_mutex_lock <null> (bitcoind+0x10a890) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #1 __gthread_mutex_lock(pthread_mutex_t*) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/aarch64-redhat-linux/bits/gthr-default.h:795:12 (bitcoind+0x23ae84) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #2 __gthread_recursive_mutex_lock(pthread_mutex_t*) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/aarch64-redhat-linux/bits/gthr-default.h:857:10 (bitcoind+0x23ae84)\n    #3 std::recursive_mutex::lock() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/mutex:127:17 (bitcoind+0x23ae84)\n    #4 std::unique_lock<std::recursive_mutex>::lock() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/unique_lock.h:144:17 (bitcoind+0x23ae84)\n    #5 UniqueLock<AnnotatedMixin<std::recursive_mutex>>::Enter(char const*, char const*, int) /root/ci_scratch/build/src/./sync.h:158:15 (bitcoind+0x23ae84)\n    #6 UniqueLock<AnnotatedMixin<std::recursive_mutex>>::UniqueLock(AnnotatedMixin<std::recursive_mutex>&, char const*, char const*, int, bool) /root/ci_scratch/build/src/./sync.h:177:13 (bitcoind+0x23ae84)\n    #7 (anonymous namespace)::PeerManagerImpl::InitiateTxBroadcastToAll(transaction_identifier<false> const&, transaction_identifier<true> const&) /root/ci_scratch/build/src/./net_processing.cpp:2223:9 (bitcoind+0x23ae84)\n    #8 (anonymous namespace)::PeerManagerImpl::ProcessValidTx(long, std::shared_ptr<CTransaction const> const&, std::__cxx11::list<std::shared_ptr<CTransaction const>, std::allocator<std::shared_ptr<CTransaction const>>> const&) /root/ci_scratch/build/src/./net_processing.cpp:3133:5 (bitcoind+0x25c710) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #9 (anonymous namespace)::PeerManagerImpl::ProcessMessage(CNode&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>> const&, DataStream&, std::chrono::duration<long, std::ratio<1l, 1000000l>>, std::atomic<bool> const&) /root/ci_scratch/build/src/./net_processing.cpp:4512:13 (bitcoind+0x2425bc) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #10 (anonymous namespace)::PeerManagerImpl::ProcessMessages(CNode*, std::atomic<bool>&) /root/ci_scratch/build/src/./net_processing.cpp:5242:9 (bitcoind+0x249a0c) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #11 non-virtual thunk to (anonymous namespace)::PeerManagerImpl::ProcessMessages(CNode*, std::atomic<bool>&) /root/ci_scratch/build/src/./net_processing.cpp (bitcoind+0x24e308) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #12 CConnman::ThreadMessageHandler() /root/ci_scratch/build/src/./net.cpp:3156:49 (bitcoind+0x2066a8) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #13 CConnman::Start(CScheduler&, CConnman::Options const&)::$_6::operator()() const /root/ci_scratch/build/src/./net.cpp:3560:80 (bitcoind+0x214a6c) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #14 void std::__invoke_impl<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>(std::__invoke_other, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:63:14 (bitcoind+0x214a6c)\n    #15 std::enable_if<is_invocable_r_v<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>, void>::type std::__invoke_r<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>(CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:113:2 (bitcoind+0x214a6c)\n    #16 std::_Function_handler<void (), CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>::_M_invoke(std::_Any_data const&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_function.h:295:9 (bitcoind+0x214a6c)\n    #17 std::function<void ()>::operator()() const /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_function.h:581:9 (bitcoind+0xc0d0f4) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #18 util::TraceThread(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>) /root/ci_scratch/build/src/util/./util/thread.cpp:21:9 (bitcoind+0xc0d0f4)\n    #19 void std::__invoke_impl<void, void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>(std::__invoke_other, void (*&&)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*&&, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:63:14 (bitcoind+0x214988) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #20 std::__invoke_result<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>::type std::__invoke<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>(void (*&&)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*&&, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:98:14 (bitcoind+0x214988)\n    #21 void std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>::_M_invoke<0ul, 1ul, 2ul>(std::_Index_tuple<0ul, 1ul, 2ul>) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:303:13 (bitcoind+0x214988)\n    #22 std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>::operator()() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:310:11 (bitcoind+0x214988)\n    #23 std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>>::_M_run() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:255:13 (bitcoind+0x214988)\n    #24 <null> <null> (libstdc++.so.6+0xe429c) (BuildId: 2abb65e0f3f4e72b932c9437bf468850d633f626)\n\n  Mutex M0 previously acquired by the same thread here:\n    #0 pthread_mutex_lock <null> (bitcoind+0x10a890) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #1 __gthread_mutex_lock(pthread_mutex_t*) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/aarch64-redhat-linux/bits/gthr-default.h:795:12 (bitcoind+0x23add0) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #2 std::mutex::lock() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_mutex.h:116:17 (bitcoind+0x23add0)\n    #3 std::unique_lock<std::mutex>::lock() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/unique_lock.h:144:17 (bitcoind+0x23add0)\n    #4 UniqueLock<AnnotatedMixin<std::mutex>>::Enter(char const*, char const*, int) /root/ci_scratch/build/src/./sync.h:158:15 (bitcoind+0x23add0)\n    #5 UniqueLock<AnnotatedMixin<std::mutex>>::UniqueLock(AnnotatedMixin<std::mutex>&, char const*, char const*, int, bool) /root/ci_scratch/build/src/./sync.h:177:13 (bitcoind+0x23add0)\n    #6 (anonymous namespace)::PeerManagerImpl::InitiateTxBroadcastToAll(transaction_identifier<false> const&, transaction_identifier<true> const&) /root/ci_scratch/build/src/./net_processing.cpp:2217:5 (bitcoind+0x23add0)\n    #7 (anonymous namespace)::PeerManagerImpl::ProcessValidTx(long, std::shared_ptr<CTransaction const> const&, std::__cxx11::list<std::shared_ptr<CTransaction const>, std::allocator<std::shared_ptr<CTransaction const>>> const&) /root/ci_scratch/build/src/./net_processing.cpp:3133:5 (bitcoind+0x25c710) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #8 (anonymous namespace)::PeerManagerImpl::ProcessMessage(CNode&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>> const&, DataStream&, std::chrono::duration<long, std::ratio<1l, 1000000l>>, std::atomic<bool> const&) /root/ci_scratch/build/src/./net_processing.cpp:4512:13 (bitcoind+0x2425bc) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #9 (anonymous namespace)::PeerManagerImpl::ProcessMessages(CNode*, std::atomic<bool>&) /root/ci_scratch/build/src/./net_processing.cpp:5242:9 (bitcoind+0x249a0c) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #10 non-virtual thunk to (anonymous namespace)::PeerManagerImpl::ProcessMessages(CNode*, std::atomic<bool>&) /root/ci_scratch/build/src/./net_processing.cpp (bitcoind+0x24e308) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #11 CConnman::ThreadMessageHandler() /root/ci_scratch/build/src/./net.cpp:3156:49 (bitcoind+0x2066a8) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #12 CConnman::Start(CScheduler&, CConnman::Options const&)::$_6::operator()() const /root/ci_scratch/build/src/./net.cpp:3560:80 (bitcoind+0x214a6c) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #13 void std::__invoke_impl<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>(std::__invoke_other, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:63:14 (bitcoind+0x214a6c)\n    #14 std::enable_if<is_invocable_r_v<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>, void>::type std::__invoke_r<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>(CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:113:2 (bitcoind+0x214a6c)\n    #15 std::_Function_handler<void (), CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>::_M_invoke(std::_Any_data const&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_function.h:295:9 (bitcoind+0x214a6c)\n    #16 std::function<void ()>::operator()() const /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_function.h:581:9 (bitcoind+0xc0d0f4) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #17 util::TraceThread(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>) /root/ci_scratch/build/src/util/./util/thread.cpp:21:9 (bitcoind+0xc0d0f4)\n    #18 void std::__invoke_impl<void, void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>(std::__invoke_other, void (*&&)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*&&, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:63:14 (bitcoind+0x214988) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #19 std::__invoke_result<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>::type std::__invoke<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>(void (*&&)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*&&, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:98:14 (bitcoind+0x214988)\n    #20 void std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>::_M_invoke<0ul, 1ul, 2ul>(std::_Index_tuple<0ul, 1ul, 2ul>) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:303:13 (bitcoind+0x214988)\n    #21 std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>::operator()() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:310:11 (bitcoind+0x214988)\n    #22 std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>>::_M_run() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:255:13 (bitcoind+0x214988)\n    #23 <null> <null> (libstdc++.so.6+0xe429c) (BuildId: 2abb65e0f3f4e72b932c9437bf468850d633f626)\n\n  Mutex M2 acquired here while holding mutex M1 in thread T8:\n    #0 pthread_mutex_lock <null> (bitcoind+0x10a890) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #1 __gthread_mutex_lock(pthread_mutex_t*) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/aarch64-redhat-linux/bits/gthr-default.h:795:12 (bitcoind+0x1ca20c) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #2 __gthread_recursive_mutex_lock(pthread_mutex_t*) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/aarch64-redhat-linux/bits/gthr-default.h:857:10 (bitcoind+0x1ca20c)\n    #3 std::recursive_mutex::lock() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/mutex:127:17 (bitcoind+0x1ca20c)\n    #4 std::unique_lock<std::recursive_mutex>::lock() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/unique_lock.h:144:17 (bitcoind+0x1ca20c)\n    #5 UniqueLock<AnnotatedMixin<std::recursive_mutex>>::Enter(char const*, char const*, int) /root/ci_scratch/build/src/./sync.h:158:15 (bitcoind+0x1ca20c)\n    #6 UniqueLock<AnnotatedMixin<std::recursive_mutex>>::UniqueLock(AnnotatedMixin<std::recursive_mutex>&, char const*, char const*, int, bool) /root/ci_scratch/build/src/./sync.h:177:13 (bitcoind+0x1ca20c)\n    #7 (anonymous namespace)::PeerManagerImpl::SendMessages(CNode*) /root/ci_scratch/build/src/./net_processing.cpp:6058:21 (bitcoind+0x24c5f4) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #8 non-virtual thunk to (anonymous namespace)::PeerManagerImpl::SendMessages(CNode*) /root/ci_scratch/build/src/./net_processing.cpp (bitcoind+0x24e3a0) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #9 CConnman::ThreadMessageHandler() /root/ci_scratch/build/src/./net.cpp:3161:28 (bitcoind+0x206710) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #10 CConnman::Start(CScheduler&, CConnman::Options const&)::$_6::operator()() const /root/ci_scratch/build/src/./net.cpp:3560:80 (bitcoind+0x214a6c) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #11 void std::__invoke_impl<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>(std::__invoke_other, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:63:14 (bitcoind+0x214a6c)\n    #12 std::enable_if<is_invocable_r_v<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>, void>::type std::__invoke_r<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>(CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:113:2 (bitcoind+0x214a6c)\n    #13 std::_Function_handler<void (), CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>::_M_invoke(std::_Any_data const&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_function.h:295:9 (bitcoind+0x214a6c)\n    #14 std::function<void ()>::operator()() const /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_function.h:581:9 (bitcoind+0xc0d0f4) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #15 util::TraceThread(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>) /root/ci_scratch/build/src/util/./util/thread.cpp:21:9 (bitcoind+0xc0d0f4)\n    #16 void std::__invoke_impl<void, void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>(std::__invoke_other, void (*&&)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*&&, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:63:14 (bitcoind+0x214988) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #17 std::__invoke_result<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>::type std::__invoke<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>(void (*&&)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*&&, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:98:14 (bitcoind+0x214988)\n    #18 void std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>::_M_invoke<0ul, 1ul, 2ul>(std::_Index_tuple<0ul, 1ul, 2ul>) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:303:13 (bitcoind+0x214988)\n    #19 std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>::operator()() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:310:11 (bitcoind+0x214988)\n    #20 std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>>::_M_run() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:255:13 (bitcoind+0x214988)\n    #21 <null> <null> (libstdc++.so.6+0xe429c) (BuildId: 2abb65e0f3f4e72b932c9437bf468850d633f626)\n\n  Mutex M1 previously acquired by the same thread here:\n    #0 pthread_mutex_lock <null> (bitcoind+0x10a890) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #1 __gthread_mutex_lock(pthread_mutex_t*) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/aarch64-redhat-linux/bits/gthr-default.h:795:12 (bitcoind+0x1ca20c) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #2 __gthread_recursive_mutex_lock(pthread_mutex_t*) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/aarch64-redhat-linux/bits/gthr-default.h:857:10 (bitcoind+0x1ca20c)\n    #3 std::recursive_mutex::lock() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/mutex:127:17 (bitcoind+0x1ca20c)\n    #4 std::unique_lock<std::recursive_mutex>::lock() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/unique_lock.h:144:17 (bitcoind+0x1ca20c)\n    #5 UniqueLock<AnnotatedMixin<std::recursive_mutex>>::Enter(char const*, char const*, int) /root/ci_scratch/build/src/./sync.h:158:15 (bitcoind+0x1ca20c)\n    #6 UniqueLock<AnnotatedMixin<std::recursive_mutex>>::UniqueLock(AnnotatedMixin<std::recursive_mutex>&, char const*, char const*, int, bool) /root/ci_scratch/build/src/./sync.h:177:13 (bitcoind+0x1ca20c)\n    #7 (anonymous namespace)::PeerManagerImpl::SendMessages(CNode*) /root/ci_scratch/build/src/./net_processing.cpp:5950:17 (bitcoind+0x24bc6c) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #8 non-virtual thunk to (anonymous namespace)::PeerManagerImpl::SendMessages(CNode*) /root/ci_scratch/build/src/./net_processing.cpp (bitcoind+0x24e3a0) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #9 CConnman::ThreadMessageHandler() /root/ci_scratch/build/src/./net.cpp:3161:28 (bitcoind+0x206710) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #10 CConnman::Start(CScheduler&, CConnman::Options const&)::$_6::operator()() const /root/ci_scratch/build/src/./net.cpp:3560:80 (bitcoind+0x214a6c) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #11 void std::__invoke_impl<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>(std::__invoke_other, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:63:14 (bitcoind+0x214a6c)\n    #12 std::enable_if<is_invocable_r_v<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>, void>::type std::__invoke_r<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>(CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:113:2 (bitcoind+0x214a6c)\n    #13 std::_Function_handler<void (), CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>::_M_invoke(std::_Any_data const&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_function.h:295:9 (bitcoind+0x214a6c)\n    #14 std::function<void ()>::operator()() const /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_function.h:581:9 (bitcoind+0xc0d0f4) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #15 util::TraceThread(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>) /root/ci_scratch/build/src/util/./util/thread.cpp:21:9 (bitcoind+0xc0d0f4)\n    #16 void std::__invoke_impl<void, void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>(std::__invoke_other, void (*&&)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*&&, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:63:14 (bitcoind+0x214988) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #17 std::__invoke_result<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>::type std::__invoke<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>(void (*&&)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*&&, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:98:14 (bitcoind+0x214988)\n    #18 void std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>::_M_invoke<0ul, 1ul, 2ul>(std::_Index_tuple<0ul, 1ul, 2ul>) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:303:13 (bitcoind+0x214988)\n    #19 std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>::operator()() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:310:11 (bitcoind+0x214988)\n    #20 std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>>::_M_run() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:255:13 (bitcoind+0x214988)\n    #21 <null> <null> (libstdc++.so.6+0xe429c) (BuildId: 2abb65e0f3f4e72b932c9437bf468850d633f626)\n\n  Mutex M0 acquired here while holding mutex M2 in thread T8:\n    #0 pthread_mutex_lock <null> (bitcoind+0x10a890) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #1 __gthread_mutex_lock(pthread_mutex_t*) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/aarch64-redhat-linux/bits/gthr-default.h:795:12 (bitcoind+0x23801c) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #2 std::mutex::lock() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_mutex.h:116:17 (bitcoind+0x23801c)\n    #3 std::unique_lock<std::mutex>::lock() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/unique_lock.h:144:17 (bitcoind+0x23801c)\n    #4 UniqueLock<AnnotatedMixin<std::mutex>>::Enter(char const*, char const*, int) /root/ci_scratch/build/src/./sync.h:158:15 (bitcoind+0x23801c)\n    #5 UniqueLock<AnnotatedMixin<std::mutex>>::UniqueLock(AnnotatedMixin<std::mutex>&, char const*, char const*, int, bool) /root/ci_scratch/build/src/./sync.h:177:13 (bitcoind+0x23801c)\n    #6 (anonymous namespace)::PeerManagerImpl::GetPeerRef(long) const /root/ci_scratch/build/src/./net_processing.cpp:1767:5 (bitcoind+0x23801c)\n    #7 (anonymous namespace)::PeerManagerImpl::MaybeSetPeerAsAnnouncingHeaderAndIDs(long) /root/ci_scratch/build/src/./net_processing.cpp:1280:18 (bitcoind+0x23801c)\n    #8 (anonymous namespace)::PeerManagerImpl::BlockChecked(std::shared_ptr<CBlock const> const&, BlockValidationState const&) /root/ci_scratch/build/src/./net_processing.cpp:2192:13 (bitcoind+0x23801c)\n    #9 ValidationSignals::BlockChecked(std::shared_ptr<CBlock const> const&, BlockValidationState const&)::$_0::operator()(CValidationInterface&) const /root/ci_scratch/build/src/./validationinterface.cpp:257:75 (bitcoind+0x67290c) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #10 void ValidationSignalsImpl::Iterate<ValidationSignals::BlockChecked(std::shared_ptr<CBlock const> const&, BlockValidationState const&)::$_0>(ValidationSignals::BlockChecked(std::shared_ptr<CBlock const> const&, BlockValidationState const&)::$_0&&) /root/ci_scratch/build/src/./validationinterface.cpp:90:17 (bitcoind+0x67290c)\n    #11 ValidationSignals::BlockChecked(std::shared_ptr<CBlock const> const&, BlockValidationState const&) /root/ci_scratch/build/src/./validationinterface.cpp:257:18 (bitcoind+0x67290c)\n    #12 Chainstate::ConnectTip(BlockValidationState&, CBlockIndex*, std::shared_ptr<CBlock const>, ConnectTrace&, DisconnectedBlockTransactions&) /root/ci_scratch/build/src/./validation.cpp:3099:43 (bitcoind+0x615ccc) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #13 Chainstate::ActivateBestChainStep(BlockValidationState&, CBlockIndex*, std::shared_ptr<CBlock const> const&, bool&, ConnectTrace&) /root/ci_scratch/build/src/./validation.cpp:3295:18 (bitcoind+0x617dec) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #14 Chainstate::ActivateBestChain(BlockValidationState&, std::shared_ptr<CBlock const>) /root/ci_scratch/build/src/./validation.cpp:3435:22 (bitcoind+0x618730) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #15 ChainstateManager::ProcessNewBlock(std::shared_ptr<CBlock const> const&, bool, bool, bool*) /root/ci_scratch/build/src/./validation.cpp:4494:29 (bitcoind+0x6232b0) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #16 (anonymous namespace)::PeerManagerImpl::ProcessBlock(CNode&, std::shared_ptr<CBlock const> const&, bool, bool) /root/ci_scratch/build/src/./net_processing.cpp:3400:16 (bitcoind+0x260cb0) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #17 (anonymous namespace)::PeerManagerImpl::ProcessMessage(CNode&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>> const&, DataStream&, std::chrono::duration<long, std::ratio<1l, 1000000l>>, std::atomic<bool> const&) /root/ci_scratch/build/src/./net_processing.cpp:4873:9 (bitcoind+0x2445d4) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #18 (anonymous namespace)::PeerManagerImpl::ProcessMessages(CNode*, std::atomic<bool>&) /root/ci_scratch/build/src/./net_processing.cpp:5242:9 (bitcoind+0x249a0c) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #19 non-virtual thunk to (anonymous namespace)::PeerManagerImpl::ProcessMessages(CNode*, std::atomic<bool>&) /root/ci_scratch/build/src/./net_processing.cpp (bitcoind+0x24e308) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #20 CConnman::ThreadMessageHandler() /root/ci_scratch/build/src/./net.cpp:3156:49 (bitcoind+0x2066a8) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #21 CConnman::Start(CScheduler&, CConnman::Options const&)::$_6::operator()() const /root/ci_scratch/build/src/./net.cpp:3560:80 (bitcoind+0x214a6c) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #22 void std::__invoke_impl<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>(std::__invoke_other, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:63:14 (bitcoind+0x214a6c)\n    #23 std::enable_if<is_invocable_r_v<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>, void>::type std::__invoke_r<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>(CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:113:2 (bitcoind+0x214a6c)\n    #24 std::_Function_handler<void (), CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>::_M_invoke(std::_Any_data const&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_function.h:295:9 (bitcoind+0x214a6c)\n    #25 std::function<void ()>::operator()() const /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_function.h:581:9 (bitcoind+0xc0d0f4) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #26 util::TraceThread(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>) /root/ci_scratch/build/src/util/./util/thread.cpp:21:9 (bitcoind+0xc0d0f4)\n    #27 void std::__invoke_impl<void, void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>(std::__invoke_other, void (*&&)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*&&, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:63:14 (bitcoind+0x214988) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #28 std::__invoke_result<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>::type std::__invoke<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>(void (*&&)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*&&, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:98:14 (bitcoind+0x214988)\n    #29 void std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>::_M_invoke<0ul, 1ul, 2ul>(std::_Index_tuple<0ul, 1ul, 2ul>) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:303:13 (bitcoind+0x214988)\n    #30 std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>::operator()() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:310:11 (bitcoind+0x214988)\n    #31 std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>>::_M_run() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:255:13 (bitcoind+0x214988)\n    #32 <null> <null> (libstdc++.so.6+0xe429c) (BuildId: 2abb65e0f3f4e72b932c9437bf468850d633f626)\n\n  Mutex M2 previously acquired by the same thread here:\n    #0 pthread_mutex_lock <null> (bitcoind+0x10a890) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #1 __gthread_mutex_lock(pthread_mutex_t*) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/aarch64-redhat-linux/bits/gthr-default.h:795:12 (bitcoind+0x618588) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #2 __gthread_recursive_mutex_lock(pthread_mutex_t*) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/aarch64-redhat-linux/bits/gthr-default.h:857:10 (bitcoind+0x618588)\n    #3 std::recursive_mutex::lock() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/mutex:127:17 (bitcoind+0x618588)\n    #4 std::unique_lock<std::recursive_mutex>::lock() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/unique_lock.h:144:17 (bitcoind+0x618588)\n    #5 UniqueLock<AnnotatedMixin<std::recursive_mutex>>::Enter(char const*, char const*, int) /root/ci_scratch/build/src/./sync.h:158:15 (bitcoind+0x618588)\n    #6 UniqueLock<AnnotatedMixin<std::recursive_mutex>>::UniqueLock(AnnotatedMixin<std::recursive_mutex>*, char const*, char const*, int, bool) /root/ci_scratch/build/src/./sync.h:188:13 (bitcoind+0x618588)\n    #7 Chainstate::ActivateBestChain(BlockValidationState&, std::shared_ptr<CBlock const>) /root/ci_scratch/build/src/./validation.cpp:3411:13 (bitcoind+0x618588)\n    #8 ChainstateManager::ProcessNewBlock(std::shared_ptr<CBlock const> const&, bool, bool, bool*) /root/ci_scratch/build/src/./validation.cpp:4494:29 (bitcoind+0x6232b0) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #9 (anonymous namespace)::PeerManagerImpl::ProcessBlock(CNode&, std::shared_ptr<CBlock const> const&, bool, bool) /root/ci_scratch/build/src/./net_processing.cpp:3400:16 (bitcoind+0x260cb0) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #10 (anonymous namespace)::PeerManagerImpl::ProcessMessage(CNode&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>> const&, DataStream&, std::chrono::duration<long, std::ratio<1l, 1000000l>>, std::atomic<bool> const&) /root/ci_scratch/build/src/./net_processing.cpp:4873:9 (bitcoind+0x2445d4) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #11 (anonymous namespace)::PeerManagerImpl::ProcessMessages(CNode*, std::atomic<bool>&) /root/ci_scratch/build/src/./net_processing.cpp:5242:9 (bitcoind+0x249a0c) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #12 non-virtual thunk to (anonymous namespace)::PeerManagerImpl::ProcessMessages(CNode*, std::atomic<bool>&) /root/ci_scratch/build/src/./net_processing.cpp (bitcoind+0x24e308) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #13 CConnman::ThreadMessageHandler() /root/ci_scratch/build/src/./net.cpp:3156:49 (bitcoind+0x2066a8) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #14 CConnman::Start(CScheduler&, CConnman::Options const&)::$_6::operator()() const /root/ci_scratch/build/src/./net.cpp:3560:80 (bitcoind+0x214a6c) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #15 void std::__invoke_impl<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>(std::__invoke_other, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:63:14 (bitcoind+0x214a6c)\n    #16 std::enable_if<is_invocable_r_v<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>, void>::type std::__invoke_r<void, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&>(CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:113:2 (bitcoind+0x214a6c)\n    #17 std::_Function_handler<void (), CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>::_M_invoke(std::_Any_data const&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_function.h:295:9 (bitcoind+0x214a6c)\n    #18 std::function<void ()>::operator()() const /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_function.h:581:9 (bitcoind+0xc0d0f4) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #19 util::TraceThread(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>) /root/ci_scratch/build/src/util/./util/thread.cpp:21:9 (bitcoind+0xc0d0f4)\n    #20 void std::__invoke_impl<void, void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>(std::__invoke_other, void (*&&)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*&&, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:63:14 (bitcoind+0x214988) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #21 std::__invoke_result<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>::type std::__invoke<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>(void (*&&)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*&&, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6&&) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/invoke.h:98:14 (bitcoind+0x214988)\n    #22 void std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>::_M_invoke<0ul, 1ul, 2ul>(std::_Index_tuple<0ul, 1ul, 2ul>) /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:303:13 (bitcoind+0x214988)\n    #23 std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>::operator()() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:310:11 (bitcoind+0x214988)\n    #24 std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char>>, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6>>>::_M_run() /usr/bin/../lib/gcc/aarch64-redhat-linux/16/../../../../include/c++/16/bits/std_thread.h:255:13 (bitcoind+0x214988)\n    #25 <null> <null> (libstdc++.so.6+0xe429c) (BuildId: 2abb65e0f3f4e72b932c9437bf468850d633f626)\n\n  Thread T8 'b-msghand' (tid=9189, running) created by main thread at:\n    #0 pthread_create <null> (bitcoind+0x108580) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #1 std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State>>, void (*)()) <null> (libstdc++.so.6+0xe4424) (BuildId: 2abb65e0f3f4e72b932c9437bf468850d633f626)\n    #2 AppInitMain(node::NodeContext&, interfaces::BlockAndHeaderTipInfo*) /root/ci_scratch/build/src/./init.cpp:2233:24 (bitcoind+0x1bf1b4) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #3 AppInit(node::NodeContext&) /root/ci_scratch/build/src/./bitcoind.cpp:242:43 (bitcoind+0x19cbd0) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d)\n    #4 main /root/ci_scratch/build/src/./bitcoind.cpp:283:10 (bitcoind+0x19cbd0)\n\nSUMMARY: ThreadSanitizer: lock-order-inversion (potential deadlock) (/root/ci_scratch/build/bin/bitcoind+0x10a890) (BuildId: 9a0d0366f47b56c997e67da32c10136af2c5df6d) in pthread_mutex_lock\n```\n\n",
          "created_at": "2026-01-22T16:06:56Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 1,
            "text_length": 46682,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3451,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2517082860,
      "number": 30864,
      "title": "fuzz: `scriptpubkeyman`: heap-buffer-overflow miniscript.cpp in CScript BuildScript",
      "body": "```\r\n$ echo \"dHIoJTE3LzwyOzM+LGw6cGsoJTA4KSk=\" | base64 --decode > scriptpubkeyman.crash\r\n$ FUZZ=scriptpubkeyman src/test/fuzz/fuzz scriptpubkeyman.crash\r\n...\r\nSUMMARY: AddressSanitizer: heap-buffer-overflow miniscript.cpp in CScript BuildScript<opcodetype, CScript&, opcodetype, CScript&, opcodetype>(opcodetype&&, CScript&, opcodetype&&, CScript&, opcodetype&&)\r\n...\r\n```",
      "state": "closed",
      "user": "dergoegge",
      "created_at": "2024-09-10T17:25:37Z",
      "updated_at": "2026-01-22T10:58:19Z",
      "closed_at": "2025-01-22T11:23:13Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/30864",
      "labels": [],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 457,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2802724063,
      "number": 31705,
      "title": "-usehd=1 no longer works",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nHello! Tried to search through issues but I guess bitcoin uses a new kind of wallet I am not really familiar with. I am not sure how to generate the hd seed im used to, should I try an older version? Thanks for any help. I dont want to use the new kind of wallet. I want to use bitcoin to generate a seed phrase. \n\n### Expected behaviour\n\nim used to it working bitcoin forks\n\n### Steps to reproduce\n\nbitcoin/build/src/qt/bitcoin-qt --usehd=1\n\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\n Bitcoin Core 28.1\n\n### Operating system and version\n\nubuntu 22\n\n### Machine specifications\n\n_No response_",
      "state": "closed",
      "user": "ghost",
      "created_at": "2025-01-21T20:15:03Z",
      "updated_at": "2026-01-22T10:58:16Z",
      "closed_at": "2025-01-22T07:57:20Z",
      "comments": 20,
      "url": "https://github.com/bitcoin/bitcoin/issues/31705",
      "labels": [
        "Wallet",
        "Questions and Help"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 831,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2804643253,
      "number": 31707,
      "title": "Clear documentation on the bitcoin/bitcoin docker images on Dockerhub and their build process",
      "body": "### Please describe the feature you'd like to see added.\n\nExplanations around the Docker Images being built in the GitHub workflows.\n\n### Is your feature related to a problem, if so please describe it.\n\nAs of now, I was not able to find some clear reference of how the Docker images which are available [here](https://hub.docker.com/r/bitcoin/bitcoin) are being built. It would also be nice to have a short explanation for newcomers about the risks of using a pre-built image. And most importantly: How can I make sure that the DockerHub images are actually built from this repository? I can see some GitHub actions [here](https://github.com/bitcoin/bitcoin/blob/523520f8279987cd528a9e2db6db13dc56641eff/src/secp256k1/.github/actions/run-in-docker-action/action.yml), but I only found them by digging deep into the repo.\n\n### Describe the solution you'd like\n\nA clear explanation on how the Docker images are being built (referencing the GitHub workflows would be nice!) and also a clear statement about whether [this DockerHub page](https://hub.docker.com/r/bitcoin/bitcoin) is owned by the maintainers of this project.\n\n### Describe any alternatives you've considered\n\n_No response_\n\n### Please leave any additional context\n\nI am willing to contribute, if necessary.",
      "state": "closed",
      "user": "raweber42",
      "created_at": "2025-01-22T15:08:16Z",
      "updated_at": "2026-01-22T10:58:15Z",
      "closed_at": "2025-01-22T15:40:06Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/31707",
      "labels": [
        "Questions and Help"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1362,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1959828375,
      "number": 28722,
      "title": "Multiprocess tracking issue",
      "body": "This issue will be updated to reflect the current state of bitcoin core [multiprocess support](https://github.com/ryanofsky/bitcoin/tree/pr/ipc/doc/design/multiprocess.md).\n\n---\n\nPRs for review related to building & releasing:\n\n- [ ] #34284\n- [ ] #33795\n- [ ] #32387\n- [ ] Upstream [libmultiprocess pulls](https://github.com/chaincodelabs/libmultiprocess/pulls)\n\nPRs for review related to mining:\n\n- [ ] #32420\n- [ ] #33922 \n- [ ] #33936\n- [ ] #30437\n- [ ] #33421\n- [ ] #33965\n- [ ] #33966\n- [ ] #34020\n- [ ] Tracking issue #33777\n\nPRs for review related wallet & gui & cli:\n\n- [ ] #29409\n- [ ] #10102\n- [ ] #19460\n- [ ] #19461\n- [ ] #32297\n- [ ] #32898\n\nIssues:\n\n- [ ] #32669\n- [ ] #32802\n- [ ] #33341\n- [ ] #33387\n- [ ] #33756\n- [ ] #33897\n- [ ] #33899 \n- [ ] #33923 \n- [ ] #33940\n- [ ] #33994\n- [ ] #34014\n- [ ] #34250\n\nPRs / issues closed:\n\n- [X] ~#10242~\n- [X] ~#10295~\n- [X] ~#10600~\n- [X] ~#10244~\n- [X] ~#10605~\n- [X] ~#14636~\n- [X] ~#14437~\n- [X] ~#14711~\n- [X] ~#15342~\n- [X] ~#15373~\n- [X] ~#15288~\n- [X] ~#15531~\n- [X] ~#10973~\n- [X] ~#16839~\n- [X] ~#17906~\n- [X] ~#18278~\n- [X] ~#16367~\n- [X] ~#17999~\n- [X] ~#18743~\n- [X] ~#18587~\n- [X] ~#18677~\n- [X] ~#20494~\n- [X] ~#20046~\n- [X] ~#21035~\n- [X] ~#21732~\n- [X] ~#19160~\n- [X] ~#22216~\n- [X] ~#22214~\n- [X] ~#22218~\n- [X] ~bitcoin-core/gui#360~\n- [X] ~#22215~\n- [X] ~#22217~\n- [X] ~#19101~\n- [X] ~#22848~\n- [X] ~#22219~\n- [X] ~#23003~\n- [X] ~#23006~\n- [X] ~#23004~\n- [X] ~#23005~\n- [X] ~#23499~\n- [X] ~#28721~\n- [X] ~#28907~\n- [X] ~#28978~\n- [X] ~#28921~\n- [X] ~#28929~\n- [X] ~#30509~\n- [X] ~#30510~\n- [X] ~#31196~\n- [X] ~#31197~\n- [X] ~#30940~\n- [X] ~#30955~\n- [X] ~#31105~\n- [X] ~#31003~\n- [X] ~#31288~\n- [X] ~#31480~\n- [X] ~#31318~\n- [X] ~#31196~\n- [X] ~#31740~\n- [X] ~#31151~\n- [X] ~#31455~\n- [X] ~#31763~\n- [X] ~#31815~\n- [X] ~#31945~\n- [X] ~#31283~\n- [X] ~#31827~\n- [X] ~#31564~\n- [X] ~#31866~\n- [X] ~#31992~\n- [X] ~#31741~\n- [X] ~#30975~\n- [X] ~#31785~\n- [X] ~#32271~\n- [X] ~#32378~\n- [X] ~#31375~\n- [X] ~#32634~\n- [X] ~#32641~\n- [X] ~#32690~ \n- [X] ~#31981~\n- [X] ~#32760~\n- [X] ~#32781~\n- [X] ~#31679~\n- [X] ~#31802~\n- [X] ~#32345~\n- [X] ~#33190~\n- [X] ~#33322~\n- [X] ~#33222~\n- [X] ~#33233~\n- [X] ~#33241~\n- [X] ~#33219~\n- [X] ~#33235~\n- [X] ~#33290~\n- [X] ~#33315~\n- [X] ~#33201~\n- [X] ~#33176~\n- [X] ~#33308~\n- [X] ~#33279~\n- [X] ~#33281~\n- [X] ~#33312~\n- [X] ~#33256~\n- [X] ~#33342~\n- [X] ~#33348~\n- [X] ~#33412~\n- [X] ~#33244~\n- [X] ~#33277~\n- [X] ~#33380~\n- [X] ~#33372~\n- [X] ~#33374~\n- [X] ~#33459~\n- [X] ~#33229~\n- [X] ~#31618~\n- [X] ~#33417~\n- [X] ~#33420~\n- [X] ~#33518~\n- [X] ~#33519~\n- [X] ~#33517~\n- [X] ~#33647~\n- [X] ~#32275~\n- [X] ~#30983~\n- [X] ~#31109~\n  - caused by #31003\n  - resolved by #31283\n- [X] ~#31756~\n- [X] ~#33439~\n- [X] ~#31098~\n- [X] ~#33749~\n- [X] ~#33445~\n- [X] ~#33676~\n- [X] ~#33575~\n- [X] ~#33745~\n- [X] ~#33511~\n- [X] ~#33554~\n- [X] ~#33884~\n- [X] ~#33880~\n- [X] ~#33890~\n- [X] ~#33463~\n- [X] ~#33774~\n- [X] ~#33623~\n- [X] ~#34030~\n- [X] ~#34003~ \n- [X] ~#34102~\n- [X] ~#33819~\n- [X] ~#34363~\n- [X] ~#34187~\n- [X] ~#33576~\n\nLinks:\n\n* [Documentation](https://github.com/ryanofsky/bitcoin/tree/pr/ipc/doc/design/multiprocess.md)\n* [Project board](https://github.com/bitcoin/bitcoin/projects/10)\n* [Wiki](https://github.com/bitcoin-core/bitcoin-devwiki/wiki/Process-Separation)\n* [Presentation](https://docs.google.com/presentation/d/1AeJ-7gD-dItUgs5yH-HoEzLvXaEWe_2ZiGUUxYIXcws/edit) ([code shown](https://github.com/ryanofsky/bitcoin/compare/master...pr/ipc.21))\n* [Working group](https://signal.group/#CjQKIJBeCC9-Jbnd_3sPDFPy7TB6ZPkW3k1J5tjwQ-IN_Gu1EhDV_4urKfbKiNIAhdblAulp)\n* [List of working groups](https://github.com/bitcoin-core/bitcoin-devwiki/wiki/Working-Groups)",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2023-10-24T18:22:37Z",
      "updated_at": "2026-01-22T01:37:52Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/28722",
      "labels": [
        "Tracking Issue"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3711,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3496106332,
      "number": 33576,
      "title": "29.x: using a local libmultiprocess install will no-longer work",
      "body": "Given that the `29.x` branch doesn't have the changes to accomodate upstream changes in libmultiprocess, anyone who builds and installs libmultiprocess, and then tries to build Core with `-DWITH_MULTIPROCESS=ON`, will get a compile failure:\n```bash\n[ 34%] Building CXX object src/ipc/CMakeFiles/bitcoin_ipc.dir/capnp/protocol.cpp.o\n/bitcoin/src/ipc/capnp/protocol.cpp: In destructor 'virtual ipc::capnp::{anonymous}::CapnpProtocol::~CapnpProtocol()':\n/bitcoin/src/ipc/capnp/protocol.cpp:45:62: error: no matching function for call to 'std::unique_lock<std::mutex>::unique_lock(mp::Mutex&)'\n   45 |             std::unique_lock<std::mutex> lock(m_loop->m_mutex);\n      |                                                              ^\nIn file included from /usr/include/c++/13/mutex:46,\n                 from /bitcoin/src/threadsafety.h:9,\n                 from /bitcoin/src/logging.h:10,\n                 from /bitcoin/src/interfaces/node.h:10,\n                 from /bitcoin/src/interfaces/init.h:11,\n                 from /bitcoin/src/ipc/capnp/protocol.cpp:5:\n/usr/include/c++/13/bits/unique_lock.h:68:16: note: candidate: 'std::unique_lock<_Mutex>::unique_lock(mutex_type&) [with _Mutex = std::mutex; mutex_type = std::mutex]'\n   68 |       explicit unique_lock(mutex_type& __m)\n      |                ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:68:40: note:   no known conversion for argument 1 from 'mp::Mutex' to 'std::unique_lock<std::mutex>::mutex_type&' {aka 'std::mutex&'}\n   68 |       explicit unique_lock(mutex_type& __m)\n      |                            ~~~~~~~~~~~~^~~\n/usr/include/c++/13/bits/unique_lock.h:97:9: note: candidate: 'template<class _Rep, class _Period> std::unique_lock<_Mutex>::unique_lock(mutex_type&, const std::chrono::duration<_Rep, _Period>&) [with _Period = _Rep; _Mutex = std::mutex]'\n   97 |         unique_lock(mutex_type& __m,\n      |         ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:97:9: note:   template argument deduction/substitution failed:\n/bitcoin/src/ipc/capnp/protocol.cpp:45:62: note:   candidate expects 2 arguments, 1 provided\n   45 |             std::unique_lock<std::mutex> lock(m_loop->m_mutex);\n      |                                                              ^\n/usr/include/c++/13/bits/unique_lock.h:90:9: note: candidate: 'template<class _Clock, class _Duration> std::unique_lock<_Mutex>::unique_lock(mutex_type&, const std::chrono::time_point<_Clock, _Duration>&) [with _Duration = _Clock; _Mutex = std::mutex]'\n   90 |         unique_lock(mutex_type& __m,\n      |         ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:90:9: note:   template argument deduction/substitution failed:\n/bitcoin/src/ipc/capnp/protocol.cpp:45:62: note:   candidate expects 2 arguments, 1 provided\n   45 |             std::unique_lock<std::mutex> lock(m_loop->m_mutex);\n      |                                                              ^\n/usr/include/c++/13/bits/unique_lock.h:112:7: note: candidate: 'std::unique_lock<_Mutex>::unique_lock(std::unique_lock<_Mutex>&&) [with _Mutex = std::mutex]'\n  112 |       unique_lock(unique_lock&& __u) noexcept\n      |       ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:112:33: note:   no known conversion for argument 1 from 'mp::Mutex' to 'std::unique_lock<std::mutex>&&'\n  112 |       unique_lock(unique_lock&& __u) noexcept\n      |                   ~~~~~~~~~~~~~~^~~\n/usr/include/c++/13/bits/unique_lock.h:83:7: note: candidate: 'std::unique_lock<_Mutex>::unique_lock(mutex_type&, std::adopt_lock_t) [with _Mutex = std::mutex; mutex_type = std::mutex]'\n   83 |       unique_lock(mutex_type& __m, adopt_lock_t) noexcept\n      |       ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:83:7: note:   candidate expects 2 arguments, 1 provided\n/usr/include/c++/13/bits/unique_lock.h:79:7: note: candidate: 'std::unique_lock<_Mutex>::unique_lock(mutex_type&, std::try_to_lock_t) [with _Mutex = std::mutex; mutex_type = std::mutex]'\n   79 |       unique_lock(mutex_type& __m, try_to_lock_t)\n      |       ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:79:7: note:   candidate expects 2 arguments, 1 provided\n/usr/include/c++/13/bits/unique_lock.h:75:7: note: candidate: 'std::unique_lock<_Mutex>::unique_lock(mutex_type&, std::defer_lock_t) [with _Mutex = std::mutex; mutex_type = std::mutex]'\n   75 |       unique_lock(mutex_type& __m, defer_lock_t) noexcept\n      |       ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:75:7: note:   candidate expects 2 arguments, 1 provided\n/usr/include/c++/13/bits/unique_lock.h:64:7: note: candidate: 'std::unique_lock<_Mutex>::unique_lock() [with _Mutex = std::mutex]'\n   64 |       unique_lock() noexcept\n      |       ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:64:7: note:   candidate expects 0 arguments, 1 provided\n/bitcoin/src/ipc/capnp/protocol.cpp:46:21: error: 'class mp::EventLoop' has no member named 'removeClient'\n   46 |             m_loop->removeClient(lock);\n      |                     ^~~~~~~~~~~~\n/bitcoin/src/ipc/capnp/protocol.cpp: In lambda function:\n/bitcoin/src/ipc/capnp/protocol.cpp:87:66: error: no matching function for call to 'std::unique_lock<std::mutex>::unique_lock(mp::Mutex&)'\n   87 |                 std::unique_lock<std::mutex> lock(m_loop->m_mutex);\n      |                                                                  ^\n/usr/include/c++/13/bits/unique_lock.h:68:16: note: candidate: 'std::unique_lock<_Mutex>::unique_lock(mutex_type&) [with _Mutex = std::mutex; mutex_type = std::mutex]'\n   68 |       explicit unique_lock(mutex_type& __m)\n      |                ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:68:40: note:   no known conversion for argument 1 from 'mp::Mutex' to 'std::unique_lock<std::mutex>::mutex_type&' {aka 'std::mutex&'}\n   68 |       explicit unique_lock(mutex_type& __m)\n      |                            ~~~~~~~~~~~~^~~\n/usr/include/c++/13/bits/unique_lock.h:97:9: note: candidate: 'template<class _Rep, class _Period> std::unique_lock<_Mutex>::unique_lock(mutex_type&, const std::chrono::duration<_Rep, _Period>&) [with _Period = _Rep; _Mutex = std::mutex]'\n   97 |         unique_lock(mutex_type& __m,\n      |         ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:97:9: note:   template argument deduction/substitution failed:\n/bitcoin/src/ipc/capnp/protocol.cpp:87:66: note:   candidate expects 2 arguments, 1 provided\n   87 |                 std::unique_lock<std::mutex> lock(m_loop->m_mutex);\n      |                                                                  ^\n/usr/include/c++/13/bits/unique_lock.h:90:9: note: candidate: 'template<class _Clock, class _Duration> std::unique_lock<_Mutex>::unique_lock(mutex_type&, const std::chrono::time_point<_Clock, _Duration>&) [with _Duration = _Clock; _Mutex = std::mutex]'\n   90 |         unique_lock(mutex_type& __m,\n      |         ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:90:9: note:   template argument deduction/substitution failed:\n/bitcoin/src/ipc/capnp/protocol.cpp:87:66: note:   candidate expects 2 arguments, 1 provided\n   87 |                 std::unique_lock<std::mutex> lock(m_loop->m_mutex);\n      |                                                                  ^\n/usr/include/c++/13/bits/unique_lock.h:112:7: note: candidate: 'std::unique_lock<_Mutex>::unique_lock(std::unique_lock<_Mutex>&&) [with _Mutex = std::mutex]'\n  112 |       unique_lock(unique_lock&& __u) noexcept\n      |       ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:112:33: note:   no known conversion for argument 1 from 'mp::Mutex' to 'std::unique_lock<std::mutex>&&'\n  112 |       unique_lock(unique_lock&& __u) noexcept\n      |                   ~~~~~~~~~~~~~~^~~\n/usr/include/c++/13/bits/unique_lock.h:83:7: note: candidate: 'std::unique_lock<_Mutex>::unique_lock(mutex_type&, std::adopt_lock_t) [with _Mutex = std::mutex; mutex_type = std::mutex]'\n   83 |       unique_lock(mutex_type& __m, adopt_lock_t) noexcept\n      |       ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:83:7: note:   candidate expects 2 arguments, 1 provided\n/usr/include/c++/13/bits/unique_lock.h:79:7: note: candidate: 'std::unique_lock<_Mutex>::unique_lock(mutex_type&, std::try_to_lock_t) [with _Mutex = std::mutex; mutex_type = std::mutex]'\n   79 |       unique_lock(mutex_type& __m, try_to_lock_t)\n      |       ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:79:7: note:   candidate expects 2 arguments, 1 provided\n/usr/include/c++/13/bits/unique_lock.h:75:7: note: candidate: 'std::unique_lock<_Mutex>::unique_lock(mutex_type&, std::defer_lock_t) [with _Mutex = std::mutex; mutex_type = std::mutex]'\n   75 |       unique_lock(mutex_type& __m, defer_lock_t) noexcept\n      |       ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:75:7: note:   candidate expects 2 arguments, 1 provided\n/usr/include/c++/13/bits/unique_lock.h:64:7: note: candidate: 'std::unique_lock<_Mutex>::unique_lock() [with _Mutex = std::mutex]'\n   64 |       unique_lock() noexcept\n      |       ^~~~~~~~~~~\n/usr/include/c++/13/bits/unique_lock.h:64:7: note:   candidate expects 0 arguments, 1 provided\n/bitcoin/src/ipc/capnp/protocol.cpp:88:25: error: 'class mp::EventLoop' has no member named 'addClient'\n   88 |                 m_loop->addClient(lock);\n      |                         ^~~~~~~~~\ngmake[2]: *** [src/ipc/CMakeFiles/bitcoin_ipc.dir/build.make:178: src/ipc/CMakeFiles/bitcoin_ipc.dir/capnp/protocol.cpp.o] Error 1\ngmake[1]: *** [CMakeFiles/Makefile2:1208: src/ipc/CMakeFiles/bitcoin_ipc.dir/all] Error 2\ngmake: *** [Makefile:146: all] Error 2\n```\n\nUnless we backport a number of ipc related changes to this branch (unlikely), this will be broken for the rest of this branches life. This seems like something we might want to document.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-10-08T16:21:43Z",
      "updated_at": "2026-01-22T01:36:11Z",
      "closed_at": "2026-01-22T01:36:11Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/33576",
      "labels": [
        "Docs",
        "Build system",
        "interfaces"
      ],
      "comment_data": [
        {
          "id": 3782006642,
          "user": "ryanofsky",
          "body": "I think this is resolved with #33623. The dependencies document now mentions which versions are compatible https://github.com/bitcoin/bitcoin/blob/29.x/doc/dependencies.md#optional",
          "created_at": "2026-01-22T01:36:11Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 180,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 9781,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3799701007,
      "number": 34248,
      "title": "qa: `tool_bench_sanity_check.py --bench=MempoolCheck` failure",
      "body": "On NetBSD 10.1, https://github.com/hebasto/bitcoin-core-nightly/actions/runs/20872235098/job/59975888965:\n```\n90/455 - tool_bench_sanity_check.py --bench=MempoolCheck failed, Duration: 26 s\n\nstdout:\n2026-01-10T04:19:37.691064Z TestFramework (INFO): PRNG seed is: 4615966168349338210\n2026-01-10T04:19:37.692250Z TestFramework (INFO): Initializing test directory /home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test_runner_₿_🏃_20260110_041921/tool_bench_sanity_check_363\n2026-01-10T04:19:37.692513Z TestFramework (INFO): Starting: /home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/build/bin/bench_bitcoin -filter=MempoolCheck -sanity-check\nRunning with -sanity-check option, output is being suppressed as benchmark results will be useless.\n2026-01-10T04:19:38.567933Z TestFramework (INFO): Success!\n2026-01-10T04:20:03.637759Z TestFramework.utils (ERROR): wait_until() failed. Predicate: ''''\n        wait_until_helper_internal(lambda: not self.network_event_loop.is_running(), timeout=timeout)\n'''\n\n\nstderr:\nTraceback (most recent call last):\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/build/test/functional/tool_bench_sanity_check.py\", line 41, in <module>\n    BenchSanityCheck(__file__).main()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 154, in main\n    exit_code = self.shutdown()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 281, in shutdown\n    self.network_thread.close()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/p2p.py\", line 749, in close\n    wait_until_helper_internal(lambda: not self.network_event_loop.is_running(), timeout=timeout)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/util.py\", line 420, in wait_until_helper_internal\n    raise AssertionError(\"Predicate {} not true after {} seconds\".format(predicate_source, timeout))\nAssertionError: Predicate ''''\n        wait_until_helper_internal(lambda: not self.network_event_loop.is_running(), timeout=timeout)\n''' not true after 10.0 seconds\n\n\n```",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-01-10T13:16:07Z",
      "updated_at": "2026-01-21T16:42:25Z",
      "closed_at": "2026-01-21T16:42:25Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/34248",
      "labels": [
        "Tests"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2459,
        "has_nack": false,
        "has_ack": true
      }
    }
  ],
  "summary": {
    "total_prs": 301,
    "total_issues": 44,
    "total_comments": 48,
    "unique_participants": 102
  }
}