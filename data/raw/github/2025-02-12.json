{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T19:16:43.078221+00:00",
  "date": "2025-02-12",
  "pull_requests": [
    {
      "number": 31851,
      "title": "doc: build: Fix instructions for msvc gui builds",
      "body": "If the instructions in `doc/build-windows-msvc.md` are followed as-is, and \"Developer (PowerShell|Command Prompt) for VS 2022\" is used to execute the suggested build commands, the root directory of vcpkg (e.g. in VS 2022 Community edition: `C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\VC\\vcpkg`), is too long, and when vcpkg attempts to build any of the QT packages, it will fail because of build steps that require path lengths greater than Windows' `MAX_PATH` 260 character limit. This can be avoided without needing to move the vcpkg root dir by setting [`--x-buildtrees-root`](https://learn.microsoft.com/en-us/vcpkg/commands/common-options#buildtrees-root) to a short path, like `C:\\vcpkg`.\r\n\r\nSee e.g. https://github.com/microsoft/vcpkg/issues/28451, https://github.com/microsoft/vcpkg/issues/28083, https://github.com/microsoft/vcpkg/issues/24751.",
      "state": "closed",
      "user": "davidgumberg",
      "created_at": "2025-02-12T21:01:11Z",
      "updated_at": "2025-02-14T22:12:09Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/31851",
      "labels": [
        "Docs",
        "Windows",
        "Build system"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31851.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [hebasto](https://github.com/bitcoin/bitcoin/pull/31851#pullrequestreview-2616969253), [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/31851#pullrequestreview-2617147568), [achow101](https://github.com/bitcoin/bitcoin/pull/31851#issuecomment-2660364547) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n",
          "created_at": "2025-02-12T21:01:15Z"
        },
        {
          "user": "hebasto",
          "body": "My only concern is that [`--x-buildtrees-root=<path>`](https://learn.microsoft.com/en-us/vcpkg/commands/common-options#buildtrees-root) is labeled as:\r\n> an experimental feature of vcpkg which may change or be removed at any time.",
          "created_at": "2025-02-13T08:21:18Z"
        },
        {
          "user": "davidgumberg",
          "body": "I considered that, but this solution is much more sane than any of the others I managed to come up with, and the flag has been around for at least 4 years (https://github.com/microsoft/vcpkg/issues/13789#issuecomment-700140607) , and this is only documentation, if there is a better solution, especially one that doesn't require the user to intervene in any way, that would be ideal.",
          "created_at": "2025-02-14T05:20:57Z"
        },
        {
          "user": "davidgumberg",
          "body": "> ACK [c3fa043](https://github.com/bitcoin/bitcoin/commit/c3fa043ae560289759b6f836ac62736d97ba91bf)\r\n> \r\n> Am I misremembering or was this, or a similar workaround, part of the previous build instructions at some point?\r\n\r\nYep, #29048 added a similar note to the old `build_msvc/README.md`, which had instructions for doing a static build of Qt, but I guess during the cmake transition, there was a switch from manually building Qt to using vcpkg, but sadly, the same problem still exists.",
          "created_at": "2025-02-14T20:40:32Z"
        },
        {
          "user": "achow101",
          "body": "ACK c3fa043ae560289759b6f836ac62736d97ba91bf",
          "created_at": "2025-02-14T22:11:42Z"
        }
      ]
    },
    {
      "number": 31850,
      "title": "ci: switch MSAN to use prebuilt Clang binaries",
      "body": "Use the packages from https://apt.llvm.org/.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-02-12T17:45:01Z",
      "updated_at": "2025-07-17T08:55:20Z",
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/pull/31850",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31850.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#31906](https://github.com/bitcoin/bitcoin/pull/31906) (ci: Switch to gcr.io mirror to avoid rate limits by maflcko)\n* [#31802](https://github.com/bitcoin/bitcoin/pull/31802) (Add bitcoin-{node,gui} to release binaries for IPC by Sjors)\n* [#30975](https://github.com/bitcoin/bitcoin/pull/30975) (ci: build multiprocess on most jobs by Sjors)\n* [#28710](https://github.com/bitcoin/bitcoin/pull/28710) (Remove the legacy wallet and BDB dependency by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
          "created_at": "2025-02-12T17:45:04Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/37113437498</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
          "created_at": "2025-02-12T17:51:05Z"
        },
        {
          "user": "willcl-ark",
          "body": "Also looks good to me!\r\n\r\nA docker build (with `--no-cache` set, so only using a cached Ubuntu base image) on my 11700k went from:\r\n\r\n```bash\r\n[+] Building 1521.2s (9/9) FINISHED                                          \r\n```\r\n\r\nto\r\n\r\n```bash\r\n[+] Building 196.8s (9/9) FINISHED\r\n```\r\n\r\nShould be a nice win on CI runs (and for users) where a rebuild would have previously been triggered (which can be caused by almost anything).",
          "created_at": "2025-02-13T10:12:10Z"
        },
        {
          "user": "fanquake",
          "body": "Swapped to rc2. Needs a fixup for MSAN fuzz.",
          "created_at": "2025-02-13T11:17:05Z"
        },
        {
          "user": "willcl-ark",
          "body": "For fuzzing end-users, you might consider touching up the wording in:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/55cf39e4c54da6639a8f1f7c813c2909454cada1/doc/fuzzing.md?plain=1#L104-L112\r\n\r\n...to directly mention using pre-built llvm bins (although it does already say to use the CI job as a reference which is and will remain accurate).",
          "created_at": "2025-02-13T11:21:17Z"
        },
        {
          "user": "maflcko",
          "body": "> Needs a fixup for MSAN fuzz.\r\n\r\nWhat is the error?",
          "created_at": "2025-02-18T15:16:47Z"
        },
        {
          "user": "maflcko",
          "body": "> > Needs a fixup for MSAN fuzz.\r\n> \r\n> What is the error?\r\n\r\nYeah, I don't think this works. This is probably https://github.com/bitcoin/bitcoin/issues/24289",
          "created_at": "2025-02-20T09:48:15Z"
        },
        {
          "user": "fanquake",
          "body": "Yea, I don't think so. We can circle back around to this soon.",
          "created_at": "2025-02-20T15:14:51Z"
        },
        {
          "user": "fanquake",
          "body": "PIcked up in #32999.",
          "created_at": "2025-07-17T08:55:20Z"
        }
      ]
    },
    {
      "number": 31849,
      "title": "depends: set `CMAKE_*_COMPILER_TARGET` in toolchain",
      "body": "According to the CMake docs, this is the correct way to setup a toolchain file for cross-compilation using Clang. See https://cmake.org/cmake/help/latest/manual/cmake-toolchains.7.html#cross-compiling-using-clang\r\n\r\nInternally it looks like CMake will only take this variable into account if it detects the compiler to be Clang, so this shouldn't effect other builds, but in the case of our Apple cross builds, we'd end up with a duplicated `--target=$ARCH-apple-darwin` on the compiler line, given we are already setting `--target` for Darwin builds.\r\n\r\nWould fix #31748.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-02-12T17:00:20Z",
      "updated_at": "2025-03-28T18:35:31Z",
      "comments": 11,
      "url": "https://github.com/bitcoin/bitcoin/pull/31849",
      "labels": [
        "Build system"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31849.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [hebasto](https://github.com/bitcoin/bitcoin/pull/31849#pullrequestreview-2713381206) |\n| Concept ACK | [theuni](https://github.com/bitcoin/bitcoin/pull/31849#issuecomment-2657542305), [willcl-ark](https://github.com/bitcoin/bitcoin/pull/31849#issuecomment-2733025378) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n",
          "created_at": "2025-02-12T17:00:25Z"
        },
        {
          "user": "theuni",
          "body": "Concept ACK. Regarding the duplicate `--target`... this kind of thing has come up a few times now where we need to add something to cc/flags for depends but we don't want it exported in our toolchain. I have a branch where I've done something similar.\r\n\r\nAdditionally, for Xcode generators (and CMake 4.0), I think we'll want to handle the macOS sdk/include paths differently between depends and the toolchain file, since CMake has specific variables that it really wants set for handling those things, rather than making them part of the compiler.\r\n\r\nI think it makes sense to go ahead and add an abstraction for stuff we want for our depends builds that we _don't_ want exported to the toolchain. I'll work a PR for that for discussion.\r\n\r\nThat's not a blocker for this though, I don't think duplicate `--target` is the end of the world.",
          "created_at": "2025-02-13T19:35:17Z"
        },
        {
          "user": "fanquake",
          "body": "> This will become a persistent source of confusion and complains,\r\n\r\nIt's only visible during a verbose build, and only happens when cross-compiling for macOS, on Linux. Which is certainly a less common build for anyone to actually be doing (outside of a Guix build, where it also wouldn't be visible).\r\n\r\n> Would it be worth filtering out --target=$ARCH-apple-darwin from CMAKE_<LANG>_COMPILER in the toolchain file?\r\n\r\nIt probably depends on how much code is needed, but I'm not sure filtering should be done unless its generic.",
          "created_at": "2025-02-14T10:20:08Z"
        },
        {
          "user": "hebasto",
          "body": "> > Would it be worth filtering out --target=$ARCH-apple-darwin from CMAKE__COMPILER in the toolchain file?\r\n> \r\n> It probably depends on how much code is needed, but I'm not sure filtering should be done unless its generic.\r\n\r\nFor example:\r\n```diff\r\n--- a/depends/toolchain.cmake.in\r\n+++ b/depends/toolchain.cmake.in\r\n@@ -29,8 +29,15 @@ if(NOT DEFINED CMAKE_C_FLAGS_DEBUG_INIT)\r\n   set(CMAKE_C_FLAGS_DEBUG_INIT \"@CFLAGS_DEBUG@\")\r\n endif()\r\n \r\n+macro(fliter_flags compiler_invocation_line)\r\n+  if(CMAKE_SYSTEM_NAME STREQUAL \"Darwin\")\r\n+    list(FILTER ${compiler_invocation_line} EXCLUDE REGEX \"--target=@host@\")\r\n+  endif()\r\n+endmacro()\r\n+\r\n if(NOT DEFINED CMAKE_C_COMPILER)\r\n   set(CMAKE_C_COMPILER @CC@)\r\n+  fliter_flags(CMAKE_C_COMPILER)\r\n endif()\r\n \r\n if(NOT DEFINED CMAKE_CXX_FLAGS_INIT)\r\n@@ -48,6 +55,7 @@ endif()\r\n \r\n if(NOT DEFINED CMAKE_CXX_COMPILER)\r\n   set(CMAKE_CXX_COMPILER @CXX@)\r\n+  fliter_flags(CMAKE_CXX_COMPILER)\r\n   set(CMAKE_OBJCXX_COMPILER ${CMAKE_CXX_COMPILER})\r\n endif()\r\n \r\n```",
          "created_at": "2025-02-14T11:26:07Z"
        },
        {
          "user": "fanquake",
          "body": "> For example:\r\n\r\nI'm not entirely convinced, given this isn't generic. If duplicate flags is an issue, then we should be doing the same for duplication that already exists (in non-verbose builds), not just for this specific case.",
          "created_at": "2025-03-07T11:42:29Z"
        },
        {
          "user": "hebasto",
          "body": "> > For example:\r\n> \r\n> I'm not entirely convinced, given this isn't generic. If duplicate flags is an issue, then we should be doing the same for duplication that already exists (in non-verbose builds), not just for this specific case.\r\n\r\nI don't think that duplicate flags can break the build. It is rather a readability issue and a potential source of confusion.\r\n\r\nWhat are other flags are duplicated now?",
          "created_at": "2025-03-07T11:54:22Z"
        },
        {
          "user": "fanquake",
          "body": "> What are other flags are duplicated now?\r\n\r\nAny depends build currently has duplicated `-O` flags, i.e: https://cirrus-ci.com/task/5474870093414400?logs=ci#L852.",
          "created_at": "2025-03-07T11:58:34Z"
        },
        {
          "user": "willcl-ark",
          "body": "Concept ACK\r\n\r\nI forgot about this issue then bumped into it in docker again today trying to add the ability to cross-compile to arm64 to my Dockerfile:\r\n\r\n<details>\r\n<summary>Details</summary>\r\n\r\n```log\r\n#14 92.71 /usr/bin/ld: /src/bitcoin/depends/aarch64-linux-gnu/lib/libevent_core.a(buffer.c.o): Relocations in generic ELF (EM: 183)\r\n#14 92.71 /usr/bin/ld: /src/bitcoin/depends/aarch64-linux-gnu/lib/libevent_core.a(buffer.c.o): Relocations in generic ELF (EM: 183)\r\n#14 92.71 /usr/bin/ld: /src/bitcoin/depends/aarch64-linux-gnu/lib/libevent_core.a: error adding symbols: file in wrong format\r\n#14 92.71 clang: error: linker command failed with exit code 1 (use -v to see invocation)\r\n#14 92.71 gmake[2]: *** [src/CMakeFiles/bitcoin-cli.dir/build.make:108: bin/bitcoin-cli] Error 1\r\n#14 92.71 gmake[1]: *** [CMakeFiles/Makefile2:678: src/CMakeFiles/bitcoin-cli.dir/all] Error 2\r\n#14 92.71 gmake[1]: *** Waiting for unfinished jobs....\r\n#14 92.80 [ 98%] Built target bitcoin-tx\r\n#14 98.33 [ 98%] Linking CXX static library ../lib/libbitcoin_node.a\r\n#14 98.76 [ 98%] Built target bitcoin_node\r\n#14 98.76 gmake: *** [Makefile:136: all] Error 2\r\n#14 ERROR: process \"/bin/sh -c set -ex   && cmake -B build --toolchain \\\"depends/$HOST/toolchain.cmake\\\"     -DBUILD_TESTS=OFF     -DBUILD_TX=ON     -DBUILD_UTIL=OFF     -DCMAKE_BUILD_TYPE=RelWithDebInfo     -DCMAKE_CXX_COMPILER=clang++-16     -DCMAKE_C_COMPILER=clang-16     -DCMAKE_INSTALL_PREFIX:PATH=\\\"${BITCOIN_PREFIX}\\\"     -DWITH_CCACHE=ON   && cmake --build build -j$(nproc)   && strip build/bin/bitcoin-cli build/bin/bitcoin-tx build/bin/bitcoind   && cmake --install build\" did not complete successfully: exit code: 2\r\n------\r\n > [build 9/9] RUN set -ex   && cmake -B build --toolchain \"depends/aarch64-linux-gnu/toolchain.cmake\"     -DBUILD_TESTS=OFF     -DBUILD_TX=ON     -DBUILD_UTIL=OFF     -DCMAKE_BUILD_TYPE=RelWithDebInfo     -DCMAKE_CXX_COMPILER=clang++-16     -DCMAKE_C_COMPILER=clang-16     -DCMAKE_INSTALL_PREFIX:PATH=\"/opt/bitcoin\"     -DWITH_CCACHE=ON   && cmake --build build -j$(nproc)   && strip build/bin/bitcoin-cli build/bin/bitcoin-tx build/bin/bitcoind   && cmake --install build:\r\n92.71 /usr/bin/ld: /src/bitcoin/depends/aarch64-linux-gnu/lib/libevent_core.a(buffer.c.o): Relocations in generic ELF (EM: 183)\r\n92.71 /usr/bin/ld: /src/bitcoin/depends/aarch64-linux-gnu/lib/libevent_core.a: error adding symbols: file in wrong format\r\n92.71 clang: error: linker command failed with exit code 1 (use -v to see invocation)\r\n92.71 gmake[2]: *** [src/CMakeFiles/bitcoin-cli.dir/build.make:108: bin/bitcoin-cli] Error 1\r\n92.71 gmake[1]: *** [CMakeFiles/Makefile2:678: src/CMakeFiles/bitcoin-cli.dir/all] Error 2\r\n92.71 gmake[1]: *** Waiting for unfinished jobs....\r\n92.80 [ 98%] Built target bitcoin-tx\r\n98.33 [ 98%] Linking CXX static library ../lib/libbitcoin_node.a\r\n98.76 [ 98%] Built target bitcoin_node\r\n98.76 gmake: *** [Makefile:136: all] Error 2\r\n------\r\nDockerfile:52\r\n--------------------\r\n  51 |\r\n  52 | >>> RUN set -ex \\\r\n  53 | >>>   && cmake -B build --toolchain \"depends/$HOST/toolchain.cmake\" \\\r\n  54 | >>>     -DBUILD_TESTS=OFF \\\r\n  55 | >>>     -DBUILD_TX=ON \\\r\n  56 | >>>     -DBUILD_UTIL=OFF \\\r\n  57 | >>>     -DCMAKE_BUILD_TYPE=RelWithDebInfo \\\r\n  58 | >>>     -DCMAKE_CXX_COMPILER=clang++-16 \\\r\n  59 | >>>     -DCMAKE_C_COMPILER=clang-16 \\\r\n  60 | >>>     -DCMAKE_INSTALL_PREFIX:PATH=\"${BITCOIN_PREFIX}\" \\\r\n  61 | >>>     -DWITH_CCACHE=ON \\\r\n  62 | >>>   && cmake --build build -j$(nproc) \\\r\n  63 | >>>   && strip build/bin/bitcoin-cli build/bin/bitcoin-tx build/bin/bitcoind \\\r\n  64 | >>>   && cmake --install build\r\n  65 |\r\n--------------------\r\nERROR: failed to solve: process \"/bin/sh -c set -ex   && cmake -B build --toolchain \\\"depends/$HOST/toolchain.cmake\\\"     -DBUILD_TESTS=OFF     -DBUILD_TX=ON     -DBUILD_UTIL=OFF     -DCMAKE_BUILD_TYPE=RelWithDebInfo     -DCMAKE_CXX_COMPILER=clang++-16     -DCMAKE_C_COMPILER=clang-16     -DCMAKE_INSTALL_PREFIX:PATH=\\\"${BITCOIN_PREFIX}\\\"     -DWITH_CCACHE=ON   && cmake --build build -j$(nproc)   && strip build/bin/bitcoin-cli build/bin/bitcoin-tx build/bin/bitcoind   && cmake --install build\" did not complete successfully: exit code: 2\r\n```\r\n\r\n</details>\r\n\r\nBuilding using this branch worked perfectly.\r\n\r\nNB: (unrelated to this PR) that is, until I tried to `strip` the binaries:\r\n\r\n```log\r\n#15 105.7 [100%] Built target bitcoind\r\n#15 105.7 + strip build/bin/bitcoin-cli build/bin/bitcoin-tx build/bin/bitcoind\r\n#15 105.7 strip: Unable to recognise the format of the input file `build/bin/bitcoin-cli'\r\n#15 105.7 strip: Unable to recognise the format of the input file `build/bin/bitcoin-tx'\r\n#15 105.7 strip: Unable to recognise the format of the input file `build/bin/bitcoind'\r\n```\r\n\r\nI never considered that `strip` might be platform-specific too... It seems like `eu-strip` from `elfutils` can do the job though.",
          "created_at": "2025-03-18T12:20:56Z"
        },
        {
          "user": "hebasto",
          "body": "My Guix build:\r\n```\r\naarch64\r\n02c610ee1471cc2671588a999e5ef914547cd55352ddc084faf7a9a55d79098b  guix-build-963355037fe7/output/aarch64-linux-gnu/SHA256SUMS.part\r\n11c1779525e0ebfbb55badd50c818cc02ac85a113077cc6074e6d11d4bd98677  guix-build-963355037fe7/output/aarch64-linux-gnu/bitcoin-963355037fe7-aarch64-linux-gnu-debug.tar.gz\r\n5ef64bbfadca863a09fada8da1b6cf4543c318bb4208f67c7473718c5dec6f55  guix-build-963355037fe7/output/aarch64-linux-gnu/bitcoin-963355037fe7-aarch64-linux-gnu.tar.gz\r\n80beeb5b6f5b08910e2c3dc0ffc5af3a1542449c4b944f824c1d18083657c080  guix-build-963355037fe7/output/arm-linux-gnueabihf/SHA256SUMS.part\r\nc6df0bba1c574e0fd3065c1a1d6cb0551b5063482d24b3830cf813b5caf8326e  guix-build-963355037fe7/output/arm-linux-gnueabihf/bitcoin-963355037fe7-arm-linux-gnueabihf-debug.tar.gz\r\ndf2a372f6d2e9cd3018f161bf74b3d14acc3581cca409f258ed6101886f94f93  guix-build-963355037fe7/output/arm-linux-gnueabihf/bitcoin-963355037fe7-arm-linux-gnueabihf.tar.gz\r\n9372f0922b80f636b247e4a7c5c1a4e28406335317b21c6a4209d39b14560021  guix-build-963355037fe7/output/arm64-apple-darwin/SHA256SUMS.part\r\n73c9b0888d7735a623845fdfb63db96681d681f96f742c1fc4b598dfa573bf3d  guix-build-963355037fe7/output/arm64-apple-darwin/bitcoin-963355037fe7-arm64-apple-darwin-codesigning.tar.gz\r\n89f9be0bec91b22815f2f3a9d3bdf157c1dbc756fbf3b8b15e65ceb51a21b968  guix-build-963355037fe7/output/arm64-apple-darwin/bitcoin-963355037fe7-arm64-apple-darwin-unsigned.tar.gz\r\na08a0affd36ca22788604d32840015b96ef1b978a2e29533fd4cdf1e0dbca262  guix-build-963355037fe7/output/arm64-apple-darwin/bitcoin-963355037fe7-arm64-apple-darwin-unsigned.zip\r\n4f0150a1a95cefc5c57ba962d54164c59d3fba2e6422d275c9ccbef79a909727  guix-build-963355037fe7/output/dist-archive/bitcoin-963355037fe7.tar.gz\r\n358d594a07decdb3475383dd7f9108735d594a22d05f59e40a8e48ce9f79030c  guix-build-963355037fe7/output/powerpc64-linux-gnu/SHA256SUMS.part\r\ndbf2a751f7dc5b18662074dac7a38e99522e2f2fd7d4bc460f4e51c261fe1b2d  guix-build-963355037fe7/output/powerpc64-linux-gnu/bitcoin-963355037fe7-powerpc64-linux-gnu-debug.tar.gz\r\n1bff2ad47c82eed095250e704357f11b5df6843e72aaaadef47e8f7053557ef2  guix-build-963355037fe7/output/powerpc64-linux-gnu/bitcoin-963355037fe7-powerpc64-linux-gnu.tar.gz\r\ne6d455535798882be7ea36571349b0cb240a080954494556ec8a289dc9cfa08e  guix-build-963355037fe7/output/riscv64-linux-gnu/SHA256SUMS.part\r\na380ae0fec78c671a06d7354ce9cc074b49bdbd35041a99a9504d5265af628f4  guix-build-963355037fe7/output/riscv64-linux-gnu/bitcoin-963355037fe7-riscv64-linux-gnu-debug.tar.gz\r\n2f706b563997b4ef3297d5b8429d97c537f417a72b04ca853fae21b1a019e85a  guix-build-963355037fe7/output/riscv64-linux-gnu/bitcoin-963355037fe7-riscv64-linux-gnu.tar.gz\r\n741d20133c46146ee9afaa618ae38947a48bdc64d11d2cf8564eb228c495e431  guix-build-963355037fe7/output/x86_64-apple-darwin/SHA256SUMS.part\r\n1cb1b8319b69203c1ff7c25aa3b5870384066f59a6923d12a9285a3ce3921ee5  guix-build-963355037fe7/output/x86_64-apple-darwin/bitcoin-963355037fe7-x86_64-apple-darwin-codesigning.tar.gz\r\n00dfa559a0ebe3124219801a17522b8b0b1ed3c0961bf3ea03ab1ea7a7e9cb3b  guix-build-963355037fe7/output/x86_64-apple-darwin/bitcoin-963355037fe7-x86_64-apple-darwin-unsigned.tar.gz\r\n39b8cc81245f20fa37577845eb5fed3644f17da55f8ef32b0d754c7e8ebcf4b9  guix-build-963355037fe7/output/x86_64-apple-darwin/bitcoin-963355037fe7-x86_64-apple-darwin-unsigned.zip\r\n4e46a3c27faf902981012cf7cb0602a472286cf0b45bed65bb9d9daae48c4cc6  guix-build-963355037fe7/output/x86_64-linux-gnu/SHA256SUMS.part\r\nc447b02d2b4f24348d69316e5306928a3674e2b698c3b437300e9c7927f1e0aa  guix-build-963355037fe7/output/x86_64-linux-gnu/bitcoin-963355037fe7-x86_64-linux-gnu-debug.tar.gz\r\n14fa59ba892c38b00db08e48615e586a6a9d1f74efa9aaec9860cbdedc9d5be3  guix-build-963355037fe7/output/x86_64-linux-gnu/bitcoin-963355037fe7-x86_64-linux-gnu.tar.gz\r\n848031e43a9e3e198d4f0b237d72d29b1766c60efd8972a25c9daddc3c7f7758  guix-build-963355037fe7/output/x86_64-w64-mingw32/SHA256SUMS.part\r\n5f6cdd69b1b7425a3cd687b3ed2ba887e7ef49df1b6dfa51d8583e7cea4c570b  guix-build-963355037fe7/output/x86_64-w64-mingw32/bitcoin-963355037fe7-win64-codesigning.tar.gz\r\nb8396da5768b19b5d0a2a9f0c4de33f058844d54e49f7fe52cb8643fdc298ca1  guix-build-963355037fe7/output/x86_64-w64-mingw32/bitcoin-963355037fe7-win64-debug.zip\r\nb7d05febab0456cf14fc7f0929af917fddd2cc1f6855ba929a42dba26264482a  guix-build-963355037fe7/output/x86_64-w64-mingw32/bitcoin-963355037fe7-win64-setup-unsigned.exe\r\nb9f017d2d56e15b5571794e980e078943f10974cc92b6e5e6797c55d22d58419  guix-build-963355037fe7/output/x86_64-w64-mingw32/bitcoin-963355037fe7-win64-unsigned.zip\r\n```",
          "created_at": "2025-03-25T16:45:53Z"
        },
        {
          "user": "fanquake",
          "body": "Guix Build (x86_64):\r\n```bash\r\n02c610ee1471cc2671588a999e5ef914547cd55352ddc084faf7a9a55d79098b  guix-build-963355037fe7/output/aarch64-linux-gnu/SHA256SUMS.part\r\n11c1779525e0ebfbb55badd50c818cc02ac85a113077cc6074e6d11d4bd98677  guix-build-963355037fe7/output/aarch64-linux-gnu/bitcoin-963355037fe7-aarch64-linux-gnu-debug.tar.gz\r\n5ef64bbfadca863a09fada8da1b6cf4543c318bb4208f67c7473718c5dec6f55  guix-build-963355037fe7/output/aarch64-linux-gnu/bitcoin-963355037fe7-aarch64-linux-gnu.tar.gz\r\n80beeb5b6f5b08910e2c3dc0ffc5af3a1542449c4b944f824c1d18083657c080  guix-build-963355037fe7/output/arm-linux-gnueabihf/SHA256SUMS.part\r\nc6df0bba1c574e0fd3065c1a1d6cb0551b5063482d24b3830cf813b5caf8326e  guix-build-963355037fe7/output/arm-linux-gnueabihf/bitcoin-963355037fe7-arm-linux-gnueabihf-debug.tar.gz\r\ndf2a372f6d2e9cd3018f161bf74b3d14acc3581cca409f258ed6101886f94f93  guix-build-963355037fe7/output/arm-linux-gnueabihf/bitcoin-963355037fe7-arm-linux-gnueabihf.tar.gz\r\n9372f0922b80f636b247e4a7c5c1a4e28406335317b21c6a4209d39b14560021  guix-build-963355037fe7/output/arm64-apple-darwin/SHA256SUMS.part\r\n73c9b0888d7735a623845fdfb63db96681d681f96f742c1fc4b598dfa573bf3d  guix-build-963355037fe7/output/arm64-apple-darwin/bitcoin-963355037fe7-arm64-apple-darwin-codesigning.tar.gz\r\n89f9be0bec91b22815f2f3a9d3bdf157c1dbc756fbf3b8b15e65ceb51a21b968  guix-build-963355037fe7/output/arm64-apple-darwin/bitcoin-963355037fe7-arm64-apple-darwin-unsigned.tar.gz\r\na08a0affd36ca22788604d32840015b96ef1b978a2e29533fd4cdf1e0dbca262  guix-build-963355037fe7/output/arm64-apple-darwin/bitcoin-963355037fe7-arm64-apple-darwin-unsigned.zip\r\n4f0150a1a95cefc5c57ba962d54164c59d3fba2e6422d275c9ccbef79a909727  guix-build-963355037fe7/output/dist-archive/bitcoin-963355037fe7.tar.gz\r\n358d594a07decdb3475383dd7f9108735d594a22d05f59e40a8e48ce9f79030c  guix-build-963355037fe7/output/powerpc64-linux-gnu/SHA256SUMS.part\r\ndbf2a751f7dc5b18662074dac7a38e99522e2f2fd7d4bc460f4e51c261fe1b2d  guix-build-963355037fe7/output/powerpc64-linux-gnu/bitcoin-963355037fe7-powerpc64-linux-gnu-debug.tar.gz\r\n1bff2ad47c82eed095250e704357f11b5df6843e72aaaadef47e8f7053557ef2  guix-build-963355037fe7/output/powerpc64-linux-gnu/bitcoin-963355037fe7-powerpc64-linux-gnu.tar.gz\r\ne6d455535798882be7ea36571349b0cb240a080954494556ec8a289dc9cfa08e  guix-build-963355037fe7/output/riscv64-linux-gnu/SHA256SUMS.part\r\na380ae0fec78c671a06d7354ce9cc074b49bdbd35041a99a9504d5265af628f4  guix-build-963355037fe7/output/riscv64-linux-gnu/bitcoin-963355037fe7-riscv64-linux-gnu-debug.tar.gz\r\n2f706b563997b4ef3297d5b8429d97c537f417a72b04ca853fae21b1a019e85a  guix-build-963355037fe7/output/riscv64-linux-gnu/bitcoin-963355037fe7-riscv64-linux-gnu.tar.gz\r\n741d20133c46146ee9afaa618ae38947a48bdc64d11d2cf8564eb228c495e431  guix-build-963355037fe7/output/x86_64-apple-darwin/SHA256SUMS.part\r\n1cb1b8319b69203c1ff7c25aa3b5870384066f59a6923d12a9285a3ce3921ee5  guix-build-963355037fe7/output/x86_64-apple-darwin/bitcoin-963355037fe7-x86_64-apple-darwin-codesigning.tar.gz\r\n00dfa559a0ebe3124219801a17522b8b0b1ed3c0961bf3ea03ab1ea7a7e9cb3b  guix-build-963355037fe7/output/x86_64-apple-darwin/bitcoin-963355037fe7-x86_64-apple-darwin-unsigned.tar.gz\r\n39b8cc81245f20fa37577845eb5fed3644f17da55f8ef32b0d754c7e8ebcf4b9  guix-build-963355037fe7/output/x86_64-apple-darwin/bitcoin-963355037fe7-x86_64-apple-darwin-unsigned.zip\r\n4e46a3c27faf902981012cf7cb0602a472286cf0b45bed65bb9d9daae48c4cc6  guix-build-963355037fe7/output/x86_64-linux-gnu/SHA256SUMS.part\r\nc447b02d2b4f24348d69316e5306928a3674e2b698c3b437300e9c7927f1e0aa  guix-build-963355037fe7/output/x86_64-linux-gnu/bitcoin-963355037fe7-x86_64-linux-gnu-debug.tar.gz\r\n14fa59ba892c38b00db08e48615e586a6a9d1f74efa9aaec9860cbdedc9d5be3  guix-build-963355037fe7/output/x86_64-linux-gnu/bitcoin-963355037fe7-x86_64-linux-gnu.tar.gz\r\n848031e43a9e3e198d4f0b237d72d29b1766c60efd8972a25c9daddc3c7f7758  guix-build-963355037fe7/output/x86_64-w64-mingw32/SHA256SUMS.part\r\n5f6cdd69b1b7425a3cd687b3ed2ba887e7ef49df1b6dfa51d8583e7cea4c570b  guix-build-963355037fe7/output/x86_64-w64-mingw32/bitcoin-963355037fe7-win64-codesigning.tar.gz\r\nb8396da5768b19b5d0a2a9f0c4de33f058844d54e49f7fe52cb8643fdc298ca1  guix-build-963355037fe7/output/x86_64-w64-mingw32/bitcoin-963355037fe7-win64-debug.zip\r\nb7d05febab0456cf14fc7f0929af917fddd2cc1f6855ba929a42dba26264482a  guix-build-963355037fe7/output/x86_64-w64-mingw32/bitcoin-963355037fe7-win64-setup-unsigned.exe\r\nb9f017d2d56e15b5571794e980e078943f10974cc92b6e5e6797c55d22d58419  guix-build-963355037fe7/output/x86_64-w64-mingw32/bitcoin-963355037fe7-win64-unsigned.zip\r\n```",
          "created_at": "2025-03-27T07:31:15Z"
        },
        {
          "user": "glozow",
          "body": "Backported in #32136",
          "created_at": "2025-03-28T18:35:27Z"
        }
      ]
    },
    {
      "number": 31848,
      "title": "test, tracing: don't use problematic `bpf_usdt_readarg_p()`",
      "body": "Instead of using the undocumented bcc helper `bpf_usdt_readarg_p()`, use [`bpf_usdt_readarg()`][1] and [`bpf_probe_read_user()`][2]/[`bpf_probe_read_user_str()`][3] as documented in the [bcc USDT reference guide][1].\r\n\r\nNote that the `bpf_probe_read_user()` documentation says the following:\r\n> For safety, all user address space memory reads must pass through bpf_probe_read_user().\r\n\r\nIt's [assumed](https://github.com/bitcoin/bitcoin/issues/27380#issuecomment-2286505348) that using `bpf_usdt_readarg_p()` caused a lifetime issue. With `bpf_usdt_readarg()` and `bpf_probe_read_user()`, this doesn't [seem](https://github.com/bitcoin/bitcoin/issues/27380#issuecomment-2528671656) to be a problem anymore.\r\n\r\nThis allows to revert https://github.com/bitcoin/bitcoin/commit/faed5337435f025811caeb5f782ecbf9683a24b3 and closes #27380.\r\n\r\n  [1]: https://github.com/iovisor/bcc/blob/master/docs/reference_guide.md#6-usdt-probes\r\n  [2]: https://github.com/iovisor/bcc/blob/master/docs/reference_guide.md#10-bpf_probe_read_user\r\n  [3]: https://github.com/iovisor/bcc/blob/master/docs/reference_guide.md#11-bpf_probe_read_user_str",
      "state": "closed",
      "user": "0xB10C",
      "created_at": "2025-02-12T16:07:01Z",
      "updated_at": "2025-07-29T09:22:02Z",
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/pull/31848",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31848.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [i-am-yuvi](https://github.com/bitcoin/bitcoin/pull/31848#pullrequestreview-2647016062), [willcl-ark](https://github.com/bitcoin/bitcoin/pull/31848#pullrequestreview-2657887971) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n",
          "created_at": "2025-02-12T16:07:06Z"
        },
        {
          "user": "0xB10C",
          "body": "I did [>15 re-runs](https://github.com/0xB10C/bitcoin/actions/runs/12912670830 ) of https://github.com/bitcoin/bitcoin/compare/master...0xB10C:bitcoin:2024-12-dont-use-bpf_usdt_readarg_p-testing similar to the 20 runs in https://github.com/bitcoin/bitcoin/issues/27380#issuecomment-2528671656 to make sure this won't intermittently fail again. ",
          "created_at": "2025-02-12T16:14:09Z"
        },
        {
          "user": "willcl-ark",
          "body": "Approach ACK\r\n\r\nSo if I understand the change correctly, the new (documented/recommended) behaviour is to always first `read_arg()` which gets the memory location of the data, then `read_user[_str]()` which then actually performs the copy from user memory to the BPF memory space.\r\n\r\nIf I have this correct, then using the documented, seemingly more-reliable, and more explicit approach seems fine to me.\r\n\r\nNot sure how I could test the reliability of this myself, but https://github.com/bitcoin/bitcoin/pull/31848#issuecomment-2654199608 looks promising.",
          "created_at": "2025-02-13T11:29:36Z"
        },
        {
          "user": "0xB10C",
          "body": "> So if I understand the change correctly, the new (documented/recommended) behaviour is to always first read_arg() which gets the memory location of the data, then read_user{_str}() which then actually performs the copy from user memory to the BPF memory space.\r\n\r\nCorrect. Here's an example from the `mempool:added` tracepoint test.\r\n\r\n- (1) initialize a null-pointer `phash`\r\n- (2) read the first tracepoint argument (a user-space address) into the `phash` pointer\r\n- (3) copy the value behind the `phash` pointer into `added.hash`\r\n```C\r\n  void *phash = NULL;                                              // (1)\r\n  bpf_usdt_readarg(1, ctx, &phash);                                // (2)\r\n  bpf_probe_read_user(&added.hash, sizeof(added.hash), phash);     // (3)\r\n```\r\n\r\n`bpf_usdt_readarg_p()` is a helper that does this, but apparently not safely enough",
          "created_at": "2025-02-13T13:14:49Z"
        },
        {
          "user": "laanwj",
          "body": "> bpf_usdt_readarg_p() is a helper that does this, but apparently not safely enough\r\n\r\ni looked into it a bit; the implementation of `bpf_usdt_readarg_p` is here:\r\nhttps://github.com/iovisor/bcc/blob/master/src/cc/frontends/clang/b_frontend_action.cc#L1270\r\n\r\nIt's a macro implemented in the clang frontend:\r\n```c++\r\n        } else if (Decl->getName() == \"bpf_usdt_readarg_p\") {\r\n          text = \"({ u64 __addr = 0x0; \";\r\n          text += \"_bpf_readarg_\" + current_fn_ + \"_\" + args[0] + \"(\" +\r\n                  args[1] + \", &__addr, sizeof(__addr));\";\r\n\r\n          bool overlap_addr = false;\r\n          text += check_bpf_probe_read_user(StringRef(\"bpf_probe_read_user\"),\r\n                  overlap_addr);\r\n          if (overlap_addr) {\r\n            error(GET_BEGINLOC(Call), \"bpf_probe_read_user not found. Use latest kernel\");\r\n            return false;\r\n          }\r\n\r\n          text += \"(\" + args[2] + \", \" + args[3] + \", (void *)__addr);\";\r\n          text += \"})\";\r\n          rewriter_.ReplaceText(expansionRange(Call->getSourceRange()), text);\r\n        }\r\n```\r\n\r\nAt first glance it generates the exact same code: a `bpf_readarg` folllowed by `bpf_probe_read_user` of that address. So it's unclear why the explicit formulation would change anything.\r\n\r\nHowever, [`check_bpf_probe_read_user`](https://github.com/iovisor/bcc/blob/master/src/cc/frontends/clang/b_frontend_action.cc#L149) does not always return `bpf_probe_read_user`! If the symbol cannot be resolved for the specific kernel it returns `bpf_probe_read` instead. \r\nMaybe that's it, and calling `check_bpf_probe_read_user` works around it? Not sure.\r\n\r\nOn the other hand there's also [some #defining](https://github.com/iovisor/bcc/blob/master/src/cc/frontends/clang/b_frontend_action.cc#L1821) going on which does the same (but not sure it's under the same conditions).",
          "created_at": "2025-02-13T14:52:17Z"
        },
        {
          "user": "glozow",
          "body": "@willcl-ark you acked your commit on top of the PR. It is effectively an ack, but do you mind editing your comment?",
          "created_at": "2025-03-04T19:39:47Z"
        },
        {
          "user": "willcl-ark",
          "body": "Thanks Gloria, nice catch :)\r\n\r\nComment amended.",
          "created_at": "2025-03-05T10:29:24Z"
        },
        {
          "user": "laanwj",
          "body": "Post-merge code review ACK a0b66b4bffaa6bc354c293785b785c2da2cef4de",
          "created_at": "2025-03-05T15:28:32Z"
        },
        {
          "user": "fanquake",
          "body": "Followup to this in #33086.",
          "created_at": "2025-07-29T09:22:02Z"
        }
      ]
    },
    {
      "number": 31847,
      "title": "[WIP] build: name install targets as components",
      "body": "Adds component names to the CMake install targets to allow for component-based installs. Such installs are helpful when a user only wants to install `bitcoind` or `bitcoin-cli` executables specifically, for example.\r\n\r\nAt present, the component names use Pascal case to follow the existing convention for the only pre-existing named component `Kernel`, however, there is a convincing case to be made for using kebab-case to more intuitively match the names of the executable binaries.\r\n\r\nComponent based installs can be performed using:\r\n```\r\ncmake -B build\r\ncmake --build build --target bitcoind bitcoin-cli\r\ncmake --install build --component BitcoinD BitcoinCli\r\n```\r\n\r\nSupported targets:\r\n- `BitcoinWallet`\r\n- `BitcoinD`\r\n- `BitcoinNode`\r\n- `BitcoinCli`\r\n- `BitcoinTx`\r\n- `BitcoinUtil`\r\n\r\nAttempts to close #31745.\r\n\r\nPossible improvements:\r\n- Scour other nested `CMakeLists.txt` files for additional targets.\r\n- Switch to kebab-case\r\n\r\nNew contributor here; new to Bitcoin, new to CMake, happy to help, learn and receive feedback.\r\n\r\nCurrently submitted as a draft to inspect build results as a PoC.",
      "state": "closed",
      "user": "s373nZ",
      "created_at": "2025-02-12T12:54:02Z",
      "updated_at": "2025-02-12T15:14:18Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/31847",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31847.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
          "created_at": "2025-02-12T12:54:07Z"
        },
        {
          "user": "fanquake",
          "body": "Thank, although there is already a PR open to do this in #31844.",
          "created_at": "2025-02-12T14:11:56Z"
        },
        {
          "user": "s373nZ",
          "body": "Closing in favor of #31844.",
          "created_at": "2025-02-12T15:14:18Z"
        }
      ]
    },
    {
      "number": 31846,
      "title": "test: Remove stale gettime test",
      "body": "The `gettime` test is stale:\r\n\r\n* It was added to sanity check the `time` implementation in the mingw toolchain to catch a 32-bit vs 64-bit mismatch in commit eaafa23cbd83b7bda4b28779138c62446bbdea2a. However, since commit 0000a63689036dc4368d04c0648a55fdf507932f, `std::chrono::system_clock` is used.\r\n* Even though `system_clock` may also return incorrect values, such an error should affect *all* `GetTime<>` calls (not only the second-precision ones). (I expect such an error to lead to a signed integer overflow in the normal nanosecond precision, so it should be caught by ubsan or by the `assert(ret > 0s)`. If not, the error should be apparent on startup in the debug log.)\r\n\r\nSo remove it for now. An alternative would be to extend the test to cover `time` again, and adjust the comment to say that the test should be fixed along with the block header timestamp. Since that timestamp can't grow beyond 2106 anyway, see the `_test_y2106` functional test.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-02-12T11:18:18Z",
      "updated_at": "2025-02-14T10:40:42Z",
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/pull/31846",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31846.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [laanwj](https://github.com/bitcoin/bitcoin/pull/31846#pullrequestreview-2611675848), [l0rinc](https://github.com/bitcoin/bitcoin/pull/31846#issuecomment-2653744003) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n",
          "created_at": "2025-02-12T11:18:24Z"
        },
        {
          "user": "l0rinc",
          "body": "ACK fa3a4eafa11ee03fccea1c2a16df5bf2ab164159\r\n\r\nYour explanations make sense to me here.",
          "created_at": "2025-02-12T13:39:39Z"
        },
        {
          "user": "hodlinator",
          "body": "Would probably have leaned towards just updating the comment and leaving the test just out of paranoia, even though so much is different with the `std::chrono` implementation that anything similar is unlikely to re-occur. Getting rid of lines to maintain has value too.",
          "created_at": "2025-02-13T17:17:44Z"
        },
        {
          "user": "laanwj",
          "body": "Sure. It was good to have this test at the time to prove the issue was fixed. But it's been a decade, it's super unlikely that this specific toolchain ABI compatibility issue will ever pop up again in our builds, we can't keep the tests for every possible eventuality.\r\n\r\nGenerally we should have tests that test our code, we can't assure the sanity of the entire OS and system libraries.",
          "created_at": "2025-02-13T19:11:16Z"
        },
        {
          "user": "maflcko",
          "body": "> so much is different with the `std::chrono` implementation that anything similar is unlikely to re-occur.\r\n\r\nTo give some more context, if this exact issue were to re-appear, it would now be caught by other tests (maybe).\r\n\r\nFor testing, I took the constant offset from https://github.com/bitcoin/bitcoin/issues/3494#issuecomment-31849134: `std::chrono::seconds{0x0000ffc4'00000000}` and applied it to the system clock as offset. Given that the system clock is normally in nanosecond precision, this will lead to a signed integer overflow, so it will be caught by ubsan. Though, on the windows cross build, likely no one tests with ubsan.\r\n\r\nStill, there is some chance and not a guarantee (signed integer overflow is UB) that the following assert will catch it: \r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/2549fc6fd1cc958a0e2d59838907c8808fd129b3/src/util/time.cpp#L36\r\n\r\nOn Linux, it did locally, but I haven't tested on Windows.",
          "created_at": "2025-02-14T07:43:20Z"
        },
        {
          "user": "hodlinator",
          "body": "Yeah, was experimenting with something like this as an extra sanity check.\r\n```diff\r\ndiff --git a/src/util/time.cpp b/src/util/time.cpp\r\nindex cafc27e0d0..419ddb3702 100644\r\n--- a/src/util/time.cpp\r\n+++ b/src/util/time.cpp\r\n@@ -34,6 +34,7 @@ NodeClock::time_point NodeClock::now() noexcept\r\n             mocktime :\r\n             std::chrono::system_clock::now().time_since_epoch()};\r\n     assert(ret > 0s);\r\n+    assert(ret < std::chrono::years{200});\r\n     return time_point{ret};\r\n };\r\n```\r\nBut on the way there I realized the underlying representation of `ret` was closer to nanoseconds than seconds, and also managed to trigger the overflow/wrap issue, which made me see the old test as slightly less useful.",
          "created_at": "2025-02-14T10:40:40Z"
        }
      ]
    },
    {
      "number": 31845,
      "title": "Add -pruneduringinit option to temporarily use another prune target during IBD",
      "body": "Low prune sizes can force flushing long before dbcache is full, making a significant impact on real-world IBD time.\r\n\r\nThis new option allows a higher (or lower) prune size during IBD to mitigate this. When assumeutxo is active, the entire additional budget is allocated to the background chainstate.",
      "state": "closed",
      "user": "luke-jr",
      "created_at": "2025-02-12T01:29:01Z",
      "updated_at": "2025-10-22T15:10:20Z",
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/pull/31845",
      "labels": [
        "Needs Benchmark"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31845.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Approach NACK | [stickies-v](https://github.com/bitcoin/bitcoin/pull/31845#pullrequestreview-2615366818) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#31260](https://github.com/bitcoin/bitcoin/pull/31260) (scripted-diff: Type-safe settings retrieval by ryanofsky)\n* [#30214](https://github.com/bitcoin/bitcoin/pull/30214) (refactor: Improve assumeutxo state representation by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
          "created_at": "2025-02-12T01:29:05Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/37065721535</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
          "created_at": "2025-02-12T01:33:09Z"
        },
        {
          "user": "andrewtoth",
          "body": "After #28280 and #30039 how significant is the impact of this?",
          "created_at": "2025-02-12T02:10:25Z"
        },
        {
          "user": "luke-jr",
          "body": ">After #28280 and #30039 how significant is the impact of this?\r\n\r\nI don't know, but logically I would expect this to still improve things significantly.",
          "created_at": "2025-02-12T02:14:20Z"
        },
        {
          "user": "andrewtoth",
          "body": "Can't we just do an IBD without pruning, then shutdown and restart with a prune height set? Or just call `pruneblockchain` after we are done IBD?",
          "created_at": "2025-02-12T21:41:57Z"
        },
        {
          "user": "sedited",
          "body": "> Approach NACK, I don't think this needs a separate startup option. If benchmarks agree, I think a PR that improves the --prune documentation would be worthwhile.\r\n\r\nWhile I think I agree that this does not need a separate startup option, the current flushing behaviour does indeed feel backwards. That should just be independently addressed though. I also echo l0rincs intuition from before, why are we writing to disk at all? At least to the assume valid height, I can't think of any good reason to do so, and even beyond a target height calculated on the fly from the prune target and the best header, still seems acceptable. Maybe @sipa can help us understand the threshold tradeoffs here?",
          "created_at": "2025-06-11T14:53:06Z"
        },
        {
          "user": "achow101",
          "body": "This PR does not seem to have attracted much attention from reviewers. As such, it does not seem important enough right now to keep it sitting idle in the list of open PRs.\r\n\r\nClosing due to lack of interest.",
          "created_at": "2025-10-22T15:10:20Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 31853,
      "title": "Wallet Passpharse",
      "body": "### Issues, reports or feature requests related to the GUI should be opened directly on the GUI repo\n\n- [x] I still think this issue should be opened here\n\n### Report\n\nCurrent behaviour\nIâ€™m using a passphrase for my encrypted walletsâ€”8 in total.\n\nThis passphrase is: (space â€œthekeyâ€ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ )\nâ€œ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ )â€\n\nI use this passphrase for all my wallets (total: 2.4 BTC), but now it doesnâ€™t work as usual. I tried creating a new wallet with the same passphrase, and I encountered the same issue.\n\nYou can review my question and all the comments here,\n\nhttps://bitcoin.stackexchange.com/questions/125573/bitcoin-core-doesnt-executing-commands?noredirect=1#comment142713_125573\n\nwhere I describe the bug in your software. I hope this is something important because I feel like Iâ€™ve lost all my money.\n\nFeel free to email me: [abuseedou@gmail.com](mailto:abuseedou@gmail.com)",
      "state": "closed",
      "user": "InnDe",
      "created_at": "2025-02-12T23:29:21Z",
      "updated_at": "2025-02-13T00:31:44Z",
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/31853",
      "labels": [
        "GUI"
      ]
    },
    {
      "number": 31852,
      "title": "Wallet passpharse",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\n\nIâ€™m using a passphrase for my encrypted walletsâ€”8 in total.\n\nThis passphrase is: (space â€œthekeyâ€ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\) \nâ€œ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\)â€\n\nI use this passphrase for all my wallets (total: 2.4 BTC), but now it doesnâ€™t work as usual. I tried creating a new wallet with the same passphrase, and I encountered the same issue.\n\nYou can review my question and all the comments here, \n\nhttps://bitcoin.stackexchange.com/questions/125573/bitcoin-core-doesnt-executing-commands?noredirect=1#comment142713_125573\n\nwhere I describe the bug in your software. I hope this is something important because I feel like Iâ€™ve lost all my money.\n\nFeel free to email me: abuseedou@gmail.com\n\n### Expected behaviour\n\nAll described above \n\n### Steps to reproduce\n\nAll described above \n\n### Relevant log output\n\nAll described above \n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\n28\n\n### Operating system and version\n\nWindows 11 \n\n### Machine specifications\n\n_No response_",
      "state": "closed",
      "user": "InnDe",
      "created_at": "2025-02-12T22:23:26Z",
      "updated_at": "2025-07-31T19:15:30Z",
      "comments": 35,
      "url": "https://github.com/bitcoin/bitcoin/issues/31852",
      "labels": [
        "GUI",
        "Wallet",
        "Windows"
      ]
    }
  ],
  "summary": {
    "pull_requests": 7,
    "issues": 2
  }
}