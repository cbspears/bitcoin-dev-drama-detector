{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T20:14:00.307439+00:00",
  "date": "2025-09-12",
  "pull_requests": [
    {
      "number": 33382,
      "title": "Bash completion for bitcoin(1) wrapper",
      "body": "Uses `bitcoin --help` / `bitcoin help` to list available commands and options for the `bitcoin` wrapper.\r\nIntegrates completions for `bitcoind`, `bitcoin-cli`, and `bitcoin-tx`.\r\n\r\nPlaced under `contrib/` so it can be installed or used easily by distros/users who want completion.",
      "state": "closed",
      "user": "caesrcd",
      "created_at": "2025-09-12T23:00:10Z",
      "updated_at": "2025-09-15T14:26:12Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/pull/33382",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "‚ôªÔ∏è Automatically closing for now based on heuristics. Please leave a comment, if this was erroneous. Generally, please focus on creating high-quality, original content that demonstrates a clear understanding of the project's requirements and goals.",
          "created_at": "2025-09-12T23:00:18Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33382.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (‚ú® experimental)\n\nPossible typos and grammar issues:\n\n- senseful -> sensible [‚Äúsenseful‚Äù is nonstandard/incorrect English; ‚Äúsensible‚Äù (or ‚Äúmeaningful‚Äù) conveys the intended meaning]\n\n<sup>drahtbot_id_5_m</sup>\n",
          "created_at": "2025-09-12T23:00:20Z"
        }
      ]
    },
    {
      "number": 33381,
      "title": "test: Fix TestFlushBehavior when  coin has non-zero dynamic memory usage",
      "body": "If the random coin in this test has a non-null scriptpubkey, `cache->SanityCheck();` fails an assertion because the `BOOST_CHECK_THROW` line leaves `CCoinsViewCache::cachedCoinsUsage` in a corrupted state: the erroring `AddCoin` call decrements the value to 0 even though the coin is still in the cache, then the next `SpendCoin` call decrements the value again causing a `size_t` underflow.\r\n\r\nMove the `BOOST_CHECK_THROW` test to its own suite, so that other flush tests are not affected by the caches's inconsistent state \r\n",
      "state": "closed",
      "user": "PiRK",
      "created_at": "2025-09-12T19:45:10Z",
      "updated_at": "2025-10-20T20:03:14Z",
      "comments": 10,
      "url": "https://github.com/bitcoin/bitcoin/pull/33381",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33381.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-09-12T19:45:15Z"
        },
        {
          "user": "PiRK",
          "body": "I force pushed to fix a use-after-move bug",
          "created_at": "2025-09-12T20:01:49Z"
        },
        {
          "user": "achow101",
          "body": "This change breaks the test.",
          "created_at": "2025-09-17T20:47:39Z"
        },
        {
          "user": "PiRK",
          "body": "let's see if this works. I moved the problematic test line to its own test suite, where it does not affect other flush tests.\r\n\r\nThe failure I'm trying to solve seems intermittent.  It happens about 75% of the time on master if I just add the scriptPubKey to MakeCoin. \r\nAfter my commit I get no failure in 10 runs of `./build/bin/test_bitcoin  --run_test=coins_tests`\r\n",
          "created_at": "2025-09-19T16:26:05Z"
        },
        {
          "user": "PiRK",
          "body": "To clarify the rationale for this PR: the `SanityCheck` test added to `flush_all` in https://github.com/bitcoin/bitcoin/pull/28280/commits/a14edada8a051e280af6fedd5130be40247e2d7a does not have full coverage if `cachedCoinsUsage` is not exercised.\r\n\r\nThis PR ensure that the   `cachedCoinsUsage`  part of `SanityCheck` now actually does something useful for  the `TestFlushBehavior` suite.",
          "created_at": "2025-09-19T16:31:47Z"
        },
        {
          "user": "PiRK",
          "body": "Rebased, the phantom commit is gone now\r\n",
          "created_at": "2025-09-24T06:51:41Z"
        },
        {
          "user": "l0rinc",
          "body": "@PiRK, can you please check if this was already fixed by https://github.com/bitcoin/bitcoin/pull/32313?",
          "created_at": "2025-10-20T02:42:26Z"
        },
        {
          "user": "PiRK",
          "body": "@l0rinc Yes, #32313 fixes it.\r\n\r\nTested with this patch:\r\n```\r\ndiff --git a/src/test/coins_tests.cpp b/src/test/coins_tests.cpp\r\nindex a1152d245f..a3ee441c42 100644\r\n--- a/src/test/coins_tests.cpp\r\n+++ b/src/test/coins_tests.cpp\r\n@@ -880,6 +880,7 @@ Coin MakeCoin()\r\n {\r\n     Coin coin;\r\n     coin.out.nValue = m_rng.rand32();\r\n+    coin.out.scriptPubKey.assign(m_rng.randbits(6), 0);\r\n     coin.nHeight = m_rng.randrange(4096);\r\n     coin.fCoinBase = 0;\r\n     return coin;\r\n```\r\ncoins_tests fails as expected on the commit just before #32313 was merged\r\n```\r\n./test/coins_tests.cpp(1050): Entering test case \"ccoins_flush_behavior\"\r\ntest_bitcoin: ./coins.cpp:345: void CCoinsViewCache::SanityCheck() const: Assertion `recomputed_usage == cachedCoinsUsage' failed.\r\n```\r\nAnd the test now passes on master.\r\n\r\nNot sure if setting the scriptPubkey in `ccoins_flush_behavior` now adds any useful coverage after you've added a dedicated unit test and extra assertions in the other PR. I'll let you judge, and close this PR accordingly.\r\n",
          "created_at": "2025-10-20T06:48:59Z"
        },
        {
          "user": "PiRK",
          "body": "AFAICT the issue my patch raised was only reachable after suppressing a `std::logic_error`, which shouldn't happen in production code.",
          "created_at": "2025-10-20T07:05:24Z"
        },
        {
          "user": "l0rinc",
          "body": "Was a good find, thanks, I agree that it doesn't make a lot of sense anymore to keep this around, if you agree, please consider closing the PR",
          "created_at": "2025-10-20T19:55:37Z"
        }
      ]
    },
    {
      "number": 33380,
      "title": "test: Add submitblock test in interface_ipc",
      "body": "Expands the ipc mining test a bit with submitting a solved block and checking its validity.",
      "state": "closed",
      "user": "sedited",
      "created_at": "2025-09-12T17:59:53Z",
      "updated_at": "2025-09-16T16:45:03Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/pull/33380",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33380.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [Sjors](https://github.com/bitcoin/bitcoin/pull/33380#issuecomment-3292933671), [marcofleon](https://github.com/bitcoin/bitcoin/pull/33380#pullrequestreview-3229240434), [zaidmstrr](https://github.com/bitcoin/bitcoin/pull/33380#pullrequestreview-3230558328) |\n| Stale ACK | [sipa](https://github.com/bitcoin/bitcoin/pull/33380#pullrequestreview-3218428079) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-09-12T17:59:58Z"
        },
        {
          "user": "Sjors",
          "body": "ACK 557644ee9499583b6d00efda289fb65e8359e084\r\n\r\nCould expand it a bit:\r\n\r\n```diff\r\ndiff --git a/test/functional/interface_ipc.py b/test/functional/interface_ipc.py\r\nindex 1651b53bda..89c1fd7d31 100755\r\n--- a/test/functional/interface_ipc.py\r\n+++ b/test/functional/interface_ipc.py\r\n@@ -186,20 +186,33 @@ class IPCInterfaceTest(BitcoinTestFramework):\r\n             balance = miniwallet.get_balance()\r\n             coinbase.vout[0].scriptPubKey = miniwallet.get_output_script()\r\n             coinbase.vout[0].nValue = COIN\r\n             block.vtx[0] = coinbase\r\n             block.hashMerkleRoot = block.calc_merkle_root()\r\n+\r\n+            # Ensure the block is invalid by setting version to 0\r\n+            original_version = block.nVersion\r\n+            block.nVersion = 0\r\n+            block.solve()\r\n+            res = await mining.result.checkBlock(block.serialize(), check_opts)\r\n+            assert_equal(res.result, False)\r\n+            assert_equal(res.reason, \"bad-version(0x00000000)\")\r\n+            res = await template.result.submitSolution(ctx, block.nVersion, block.nTime, block.nNonce, coinbase.serialize())\r\n+            assert_equal(res.result, False)\r\n+\r\n+            block.nVersion = original_version\r\n             block.solve()\r\n             res = await mining.result.checkBlock(block.serialize(), check_opts)\r\n             assert_equal(res.result, True)\r\n             res = await template.result.submitSolution(ctx, block.nVersion, block.nTime, block.nNonce, coinbase.serialize())\r\n             assert_equal(res.result, True)\r\n             assert_equal(self.nodes[0].getchaintips()[0][\"height\"], current_block_height + 1)\r\n             miniwallet.rescan_utxos()\r\n             assert_equal(miniwallet.get_balance(), balance + 1)\r\n             res = await mining.result.checkBlock(block.serialize(), check_opts)\r\n             assert_equal(res.result, False)\r\n+            assert_equal(res.reason, \"inconclusive-not-best-prevblk\")\r\n\r\n             self.log.debug(\"Destroy template objects\")\r\n             template.result.destroy(ctx)\r\n```",
          "created_at": "2025-09-15T08:27:20Z"
        },
        {
          "user": "sedited",
          "body": "Updated 557644ee9499583b6d00efda289fb65e8359e084 -> 0a26731c4cc182e887ce959cdd301227cdc752d7 ([interface_ipc_submitblock_0](https://github.com/TheCharlatan/bitcoin/tree/interface_ipc_submitblock_0) -> [interface_ipc_submitblock_1](https://github.com/TheCharlatan/bitcoin/tree/interface_ipc_submitblock_1), [compare](https://github.com/TheCharlatan/bitcoin/compare/interface_ipc_submitblock_0..interface_ipc_submitblock_1))\r\n\r\n* Added @Sjors's [suggested patch](https://github.com/bitcoin/bitcoin/pull/33380#issuecomment-3291011638).",
          "created_at": "2025-09-15T13:33:54Z"
        },
        {
          "user": "Sjors",
          "body": "ACK 0a26731c4cc182e887ce959cdd301227cdc752d7",
          "created_at": "2025-09-15T16:10:22Z"
        }
      ]
    },
    {
      "number": 33379,
      "title": "cmake: Fix regression in `secp256k1.cmake`",
      "body": "This PR fixes a regression introduced in https://github.com/bitcoin/bitcoin/pull/33101 (mea culpa).\r\n\r\nFrom the CMake [docs](https://cmake.org/cmake/help/latest/command/enable_language.html):\r\n> The following restrictions apply to where `enable_language()` may be called:\r\n>\r\n>    - It must be called in file scope, not in a function call.\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/33153.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-09-12T17:00:41Z",
      "updated_at": "2025-09-15T22:33:47Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/pull/33379",
      "labels": [
        "Build system"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33379.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/33379#pullrequestreview-3218326877), [furszy](https://github.com/bitcoin/bitcoin/pull/33379#pullrequestreview-3218377417) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-09-12T17:00:45Z"
        },
        {
          "user": "fanquake",
          "body": "Backported to 30.x in #33356.",
          "created_at": "2025-09-15T08:53:08Z"
        }
      ]
    },
    {
      "number": 33378,
      "title": "Remove unnecessary casts when calling socket operations",
      "body": "During review of https://github.com/bitcoin/bitcoin/pull/32747 several casting operations were questioned in existing code that had been copied or moved. That lead me to find a few other similar casts in the codebase.\r\n\r\nIt turns out that since the `Sock` class wraps syscalls with its own internal casting (see https://github.com/bitcoin/bitcoin/pull/24357 and https://github.com/bitcoin/bitcoin/pull/20788 written in 2020-2022) we no longer need to cast the arguments when calling these functions. The original argument-casts are old and were cleaned up a bit in https://github.com/bitcoin/bitcoin/pull/12855 written in 2018.\r\n\r\nThe casting is only needed for windows compatibility, where those syscalls require a data argument to be of type `char*` specifically:\r\n\r\nhttps://learn.microsoft.com/en-us/windows/win32/api/winsock/nf-winsock-getsockopt\r\n\r\n```\r\nint getsockopt(\r\n  [in]      SOCKET s,\r\n  [in]      int    level,\r\n  [in]      int    optname,\r\n  [out]     char   *optval,\r\n  [in, out] int    *optlen\r\n);\r\n```\r\n\r\nbut on POSIX the argument is `void*`:\r\n\r\nhttps://www.man7.org/linux/man-pages/man2/getsockopt.2.html\r\n\r\n```\r\n       int getsockopt(socklen *restrict optlen;\r\n                      int sockfd, int level, int optname,\r\n                      void optval[_Nullable restrict *optlen],\r\n                      socklen_t *restrict optlen);\r\n```",
      "state": "closed",
      "user": "pinheadmz",
      "created_at": "2025-09-12T16:55:47Z",
      "updated_at": "2025-09-18T20:54:09Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/33378",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33378.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [hodlinator](https://github.com/bitcoin/bitcoin/pull/33378#pullrequestreview-3229478311), [vasild](https://github.com/bitcoin/bitcoin/pull/33378#pullrequestreview-3229896344), [Raimo33](https://github.com/bitcoin/bitcoin/pull/33378#issuecomment-3304898737), [davidgumberg](https://github.com/bitcoin/bitcoin/pull/33378#pullrequestreview-3236853659), [achow101](https://github.com/bitcoin/bitcoin/pull/33378#issuecomment-3309658082) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29641](https://github.com/bitcoin/bitcoin/pull/29641) (scripted-diff: Use LogInfo over LogPrintf [WIP, NOMERGE, DRAFT] by maflcko)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-09-12T16:55:53Z"
        },
        {
          "user": "fanquake",
          "body": "https://github.com/bitcoin/bitcoin/actions/runs/17680889551/job/50254583517?pr=33378#step:12:357:\r\n```bash\r\n D:\\a\\bitcoin\\bitcoin\\src\\test\\sock_tests.cpp(37): Entering test case \"constructor_and_destructor\"\r\n2025-09-12T17:23:00.992709Z [unknown] [D:\\a\\bitcoin\\bitcoin\\src\\test\\util\\random.cpp:48] [void __cdecl SeedRandomStateForTest(enum SeedRand)] Setting random seed for current tests to RANDOM_CTX_SEED=936d3154550e893420e302712f2c7f1031a35cebf124c36896c0cee3e5c2ece2\r\n2025-09-12T17:23:00.994377Z [test] [D:\\a\\bitcoin\\bitcoin\\src\\init\\common.cpp:153] [void __cdecl init::LogPackageVersion(void)] Bitcoin Core version v30.99.0-5ee8bacfaf42 (release build)\r\n2025-09-12T17:23:00.995687Z [test] [D:\\a\\bitcoin\\bitcoin\\src\\kernel\\context.cpp:20] [auto __cdecl kernel::Context::{ctor}::<lambda_1>::operator ()(void) const] Using the 'standard' SHA256 implementation\r\nD:/a/bitcoin/bitcoin/src/test/sock_tests.cpp(42): error: in \"sock_tests/constructor_and_destructor\": check !SocketIsClosed(s) has failed\r\nD:\\a\\bitcoin\\bitcoin\\src\\test\\sock_tests.cpp(37): Leaving test case \"constructor_and_destructor\"; testing time: 4943us\r\n```",
          "created_at": "2025-09-13T09:16:53Z"
        },
        {
          "user": "pinheadmz",
          "body": "Thanks for the edit @fanquake ü•∞",
          "created_at": "2025-09-16T12:51:48Z"
        },
        {
          "user": "Raimo33",
          "body": "ACK 67f632b6deb8b4aa190c458b71d2bc8c793626d5",
          "created_at": "2025-09-18T00:02:31Z"
        },
        {
          "user": "achow101",
          "body": "ACK 67f632b6deb8b4aa190c458b71d2bc8c793626d5",
          "created_at": "2025-09-18T20:43:05Z"
        }
      ]
    },
    {
      "number": 33377,
      "title": ".",
      "body": "<!--\n*** Please remove the following help text before submitting: ***\n\nPull requests without a rationale and clear improvement may be closed\nimmediately.\n\nGUI-related pull requests should be opened against\nhttps://github.com/bitcoin-core/gui\nfirst. See CONTRIBUTING.md\n-->\n\n<!--\nPlease provide clear motivation for your patch and explain how it improves\nBitcoin Core user experience or Bitcoin Core developer experience\nsignificantly:\n\n* Any test improvements or new tests that improve coverage are always welcome.\n* All other changes should have accompanying unit tests (see `src/test/`) or\n  functional tests (see `test/`). Contributors should note which tests cover\n  modified code. If no tests exist for a region of modified code, new tests\n  should accompany the change.\n* Bug fixes are most welcome when they come with steps to reproduce or an\n  explanation of the potential issue as well as reasoning for the way the bug\n  was fixed.\n* Features are welcome, but might be rejected due to design or scope issues.\n  If a feature is based on a lot of dependencies, contributors should first\n  consider building the system outside of Bitcoin Core, if possible.\n* Refactoring changes are only accepted if they are required for a feature or\n  bug fix or otherwise improve developer experience significantly. For example,\n  most \"code style\" refactoring changes require a thorough explanation why they\n  are useful, what downsides they have and why they *significantly* improve\n  developer experience or avoid serious programming bugs. Note that code style\n  is often a subjective matter. Unless they are explicitly mentioned to be\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\n  changes are usually rejected.\n-->\n\n<!--\nBitcoin Core has a thorough review process and even the most trivial change\nneeds to pass a lot of eyes and requires non-zero or even substantial time\neffort to review. There is a huge lack of active reviewers on the project, so\npatches often sit for a long time.\n-->\n",
      "state": "closed",
      "user": "justinjsd",
      "created_at": "2025-09-12T13:29:28Z",
      "updated_at": "2025-09-12T13:30:48Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/33377",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "üìÅ Archived release notes are archived and should not be modified.",
          "created_at": "2025-09-12T13:30:21Z"
        },
        {
          "user": "DrahtBot",
          "body": "‚ôªÔ∏è Automatically closing for now based on heuristics. Please leave a comment, if this was erroneous. Generally, please focus on creating high-quality, original content that demonstrates a clear understanding of the project's requirements and goals.",
          "created_at": "2025-09-12T13:30:22Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33377.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-09-12T13:30:24Z"
        }
      ]
    },
    {
      "number": 33376,
      "title": "[WIP] cache: remove redundant find() call",
      "body": "## Summary\r\n\r\nThis PR halves the number of implicit calls to `::find()` by using an optimistic approach: insert preemptively, remove in O(1) if already spent. \r\n\r\n## Motivation\r\n\r\nCurrently, the `::find()` calls that originate from `CCoinsViewCache::BatchWrite()` account for ~2.9% of total IBD time as shown by this flamegraph from issue #32832\r\n\r\n![flamegraph](https://github.com/user-attachments/assets/76990846-9290-48b8-88e1-3c1732b5d9b0)\r\n\r\n## Benchmarks\r\n\r\nBenchmarks can't currently measure this change in a realistic manner, because they don't account for cache common related scenarios (see #33375).\r\nThis change cannot possibly be a regression since `::try_emplace()` is a call to `::find()` under the hood. And `::erase(it)` is constant time in the worst case.\r\n\r\nI'm marking this PR as draft because I ultimately want to measure the impact on a real IBD run.",
      "state": "closed",
      "user": "Raimo33",
      "created_at": "2025-09-12T13:18:24Z",
      "updated_at": "2025-09-12T20:55:32Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/33376",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33376.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#33018](https://github.com/bitcoin/bitcoin/pull/33018) (coins: remove SetFresh method from CCoinsCacheEntry by andrewtoth)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-09-12T13:18:29Z"
        },
        {
          "user": "l0rinc",
          "body": "Multiple people have pushed this already, e.g. [`723c49b` (#32128)](https://github.com/bitcoin/bitcoin/pull/32128/commits/723c49b63bb10da843fbb6efc6928dca415cc47f) or [l0rinc/bitcoin@`b23c6a1` (#34)](https://github.com/l0rinc/bitcoin/pull/34/commits/b23c6a1fc8f9a44561add79427d2f3fff4c3718f). \r\nI was about to push my change from my fork after I finished all IBD measurements.",
          "created_at": "2025-09-12T17:56:05Z"
        },
        {
          "user": "Raimo33",
          "body": "Following up in https://github.com/l0rinc/bitcoin/pull/34/commits/b23c6a1fc8f9a44561add79427d2f3fff4c3718f as reviewer/coauthor",
          "created_at": "2025-09-12T20:32:43Z"
        }
      ]
    },
    {
      "number": 33374,
      "title": "mining: add applySolution() to interface",
      "body": "Unlike the `submitblock` RPC which takes a fully serialized block, when a block solution is received via IPC the client only provides the nonce, coinbase and a few other fields. It may not have all the information it needs to reconstruct the block. This makes debugging difficult when the block is invalid.\r\n\r\nThis PR adds `applySolution()` which returns the reconstructed block and can be used by the client for debugging. It's assigned `@11` in the `.cap` file, and will not break existing client software.\r\n\r\nIt can also be used by the client for an alternative broadcast mechanism.\r\n\r\nThe tests cover both mainnet (unit tests) and regtest (functional tests), because the latter has SegWit active.\r\n\r\nThe second commit documents the fact that `applySolution()` as well as the (already existing) `submitSolution` are slightly different from the `submitsolution` RPC in that they expect a complete coinbase transaction and will not automatically add a witness. This behavior is also covered in the functional test of the first commit.\r\n\r\nThis is alternative or complimentary approach to:\r\n- #33372 ",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2025-09-12T11:48:32Z",
      "updated_at": "2025-11-03T10:43:25Z",
      "comments": 12,
      "url": "https://github.com/bitcoin/bitcoin/pull/33374",
      "labels": [
        "Mining"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33374.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [ryanofsky](https://github.com/bitcoin/bitcoin/pull/33374#pullrequestreview-3224409033) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (‚ú® experimental)\n\nPossible typos and grammar issues:\n\n- submitsolution -> submitSolution [references a method/RPC name; correct capitalization makes the reference unambiguous]\n\n<sup>drahtbot_id_5_m</sup>\n",
          "created_at": "2025-09-12T11:48:37Z"
        },
        {
          "user": "Sjors",
          "body": "Fixed typo.",
          "created_at": "2025-09-12T17:05:16Z"
        },
        {
          "user": "Sjors",
          "body": "On second thought I don't think mutating the block is a problem.\r\n\r\n> I think this assumes that the provided coinbase tx includes the coinbase witness, which is different to how `submitblock` behaves. (In particular `submitblock` includes a call to `chainman.UpdateUncommittedBlockStructures`, whereas `AddMerkleRootAndCoinbase` doesn't) That seems like it might be a source of bugs -- might at least be worth adding a check and having an explicit log message if the coinbase requires a witness but doesn't have it?\r\n\r\nIIUC only the `submitblock` **RPC** adds the coinbase witness, whereas `submitSolution()` and `applySolution()` IPC calls both don't.\r\n\r\nThis has been a source of confusion:\r\n- https://github.com/stratum-mining/sv2-spec/discussions/156\r\n- https://github.com/Sjors/sv2-tp/pull/10\r\n\r\nSo far the SRI software has been giving us a complete coinbase, including the coinbase witness. But this involved a hardcoded assumption about its value. The current ambition is to have the Template Provider communicate this value (eventually, no rush).\r\n\r\nBut it seems the approach in RPC land was different: we don't communicate the coinbase witness to pool software and just fix it when they submit the solution. The description of says \"This is safe for submitted blocks.\", but that's only true if the pool took our SegWit `OP_RETURN`.\r\n\r\nThe latter is not unreasonable, but I would prefer that we pick one approach:\r\n1. Give pools both the `OP_RETURN` and coinbase witness; or\r\n2. The pool figures out both values\r\n\r\nI prefer (1).\r\n\r\ncc @plebhash.\r\n\r\n> FWIW I think `miner_tests` is being run against mainnet params for ~100 blocks, which means that segwit is never active (it activates at block 481824), so the witness-specific code isn't being tested there.\r\n\r\nI rebased this on #33380 and added a test on regtest. This checks that dropping the coinbase witness has an effect. You can verify this test by modifying `applySolution()`:\r\n\r\n```cpp\r\nAddMerkleRootAndCoinbase(m_block_template->block, std::move(coinbase), version, timestamp, nonce);\r\nLOCK(cs_main);\r\n# yolo\r\nchainman().UpdateUncommittedBlockStructures(m_block_template->block, chainman().ActiveTip());\r\nreturn m_block_template->block;\r\n```\r\n",
          "created_at": "2025-09-16T14:49:27Z"
        },
        {
          "user": "plebhash",
          "body": "> The current ambition is to have the Template Provider communicate this value (eventually, no rush).\r\n\r\nthis would require a change to the Sv2 spec so that `NewTemplate` message carries a new field called `coinbase_witness `. \r\n\r\nbut unfortunately, changing Sv2 spec is usually received with resistance from the current players.\r\n\r\nif/when a softfork happens and we start committing stuff to the coinbases' `witness reserved value`, that could be stronger motivation.\r\n\r\nbut until that day comes, this spec change would be merely motivated for making Sv2 \"future-proof\" with regards to this hypothetical soft fork.\r\n\r\nso this is all to put some extra emphasis on the **(eventually, no rush)** quoted above.\r\n\r\n---\r\n\r\n> 1. Give pools both the OP_RETURN and coinbase witness; or\r\n> 2. The pool figures out both values\r\n>\r\n> I prefer (1).\r\n\r\nIn Sv2 terms, option 2. would incur in extra round trips (`RequestTransactionData/.Success`) and computation of witness root, which would translate into undesired delays.\r\n\r\nSo I'd prefer 1 as well. Even if Bitcoin Core continues to redundantly provide `0x000...000` as coinbase witness and Sv2 spec continues sticking to the assumption that coinbase witness always has this same value.\r\n\r\nSo whenever we get consensus a Sv2 spec change (either preemptively or forced by a soft-fork), the Sv2 TP would already have means to fill `NewTemplate.coinbase_witness` with appropriate values coming from Bitcoin Core via IPC.\r\n\r\n---\r\n\r\nBut AFAIU, that's somewhat different from the proposal on this PR, right?\r\n\r\nIIUC this PR is only adding a new `applySolution`, and the discussion point now is simply the assumptions about how such solution would be crafted by Sv2 software.",
          "created_at": "2025-09-16T15:32:19Z"
        },
        {
          "user": "Sjors",
          "body": "@plebhash indeed this PR just introduces the extra method and clarifies in the documentation that `submitSolution` and `applySolution` are slightly different from the `submitsolution` RPC.",
          "created_at": "2025-09-16T16:38:31Z"
        },
        {
          "user": "Sjors",
          "body": "Rebased after https://github.com/bitcoin/bitcoin/pull/33380 landed and updated the PR description.",
          "created_at": "2025-09-17T08:53:16Z"
        },
        {
          "user": "ryanofsky",
          "body": "Have a few questions and comments:\r\n\r\n1. Main question is why is this new applySolution method needed at all if submitSolution() modifies the block and there is already a getBlock() method?\r\n2. I think it would be good if submitSolution documented fact that calling it changes getBlockHeader, getBlock, getCoinbaseTx values.\r\n3. New comments say that coinbase witness is not added automatically, but it's not really clear what happens if client doesn't add it. Block is rejected or invalid? Behavior is undefined? Would be helpful to indicate.\r\n4. If result is not well defined, I think it would be good for submitSolution to raise an error in this case since it seems it seems easy to detect. Code could just throw std::runtime_exception, since libmultiprocess can pass along standard exceptions as [Text](https://github.com/ryanofsky/bitcoin/blob/c1e070d76166f1230758bdcf7a4463008eea46d9/src/ipc/capnp/node.capnp#L26C81-L26C115) return values\r\n5. I'm not actually sure why the IPC interface being different than the RPC interface is good, and what the downside is of filling in the OP_RETURN and witness like the RPC does. Doing this seems basically the same as your option (1) \"Give pools both the OP_RETURN and coinbase witness\" exceptit gives the values after submitting instead of before? If you wanted to fully support option 1 would you just add some extra accessors here that could be called before submitSolution?\r\n6. It might be a good idea to add a BlockSubmitOptions struct passed to SubmitSolution, similar to existing BlockCreateOptions, BlockWaitOptions, BlockCheckOptions structs. A \"pretend\" option might be useful for only updating the block without submitting it, like applySolution. It might also be useful to have options controlling the coinbase withness behavior and whether to return validation errors.",
          "created_at": "2025-09-19T20:03:55Z"
        },
        {
          "user": "Sjors",
          "body": "> 1. Main question is why is this new applySolution method needed at all if `submitSolution()` modifies the block and there is already a `getBlock()` method?\r\n\r\nThis is a great point. Let's just embrace the fact that `submitSolution()` modifies the block.\r\n\r\nI'll extract some of the documentation improvements, and add some based on your comments, and PR those later. Ditto for the extra test coverage.",
          "created_at": "2025-09-20T13:58:41Z"
        },
        {
          "user": "Sjors",
          "body": "@ryanofsky wrote:\r\n\r\n> 3. New comments say that coinbase witness is not added automatically, but it's not really clear what happens if client doesn't add it. Block is rejected or invalid? Behavior is undefined? Would be helpful to indicate.\r\n\r\nIt turns out we accept such an invalid block. The reason for that is a cached `m_checked_witness_commitment`. Fixed in #33745 which also adds documentation from this PR.",
          "created_at": "2025-10-30T12:04:24Z"
        },
        {
          "user": "Sjors",
          "body": "Github (not the moderators) completely disappeared the (very useful) earlier feedback from Plebhash. Hopefully his account gets restored, but meanwhile see the @0xB10C backup: https://mirror.b10c.me/bitcoin-bitcoin/33374#issuecomment-3299309843",
          "created_at": "2025-10-31T15:58:56Z"
        },
        {
          "user": "0xB10C",
          "body": "Note that the @plebhash comments were actually remove from the archive (as it just pulls the GitHub API. Gone from the GitHub API means gone from the latest version of the archive and mirroring) and might thus be missing from the mirroring after the next rebuild..\r\n\r\nSee https://github.com/bitcoin-data/github-metadata-backup-bitcoin-bitcoin/commit/9ca6ff3e35249f8ccb710de7cee6ff13e028f0ee#diff-a4bfd29817b2ed302dbaf2c9bd4514ace8aa1ffeacf02046400d93b526b8ab02L847 \r\n\r\n<img width=\"1124\" height=\"1182\" alt=\"image\" src=\"https://github.com/user-attachments/assets/b8209adc-1f93-4a3f-a60c-dfe108499a73\" />\r\n",
          "created_at": "2025-10-31T16:50:51Z"
        },
        {
          "user": "Sjors",
          "body": "@plebhash's account has been restored and his comments and issues came back.",
          "created_at": "2025-11-03T10:43:25Z"
        }
      ]
    },
    {
      "number": 33373,
      "title": "depends: systemtap 5.3",
      "body": "The diff in the copied header is:\r\n```diff\r\n< #if __STDC_VERSION__ >= 199901L\r\n---\r\n> #if defined(__STDC_VERSION__) && __STDC_VERSION__ >= 199901L\r\n```\r\n\r\nFrom\r\nhttps://sourceware.org/git/?p=systemtap.git;a=commit;h=b8345d8e07b725a943a97b19aa4866e74baadd98.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-09-12T11:01:41Z",
      "updated_at": "2025-09-16T10:21:06Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/33373",
      "labels": [
        "Build system"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33373.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [0xB10C](https://github.com/bitcoin/bitcoin/pull/33373#pullrequestreview-3223791227) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-09-12T11:01:46Z"
        },
        {
          "user": "fanquake",
          "body": "Guix Build:\r\n```bash\r\n860c39a3db7eb7e8aaf8165cd6834d2fd87afc69b82b20203a013c7ad7e7b057  guix-build-28efd724b478/output/aarch64-linux-gnu/SHA256SUMS.part\r\n841aea1c04fd996bc437ae0d7a59f4e7feb52a21c0d810489aa87654c38d7b55  guix-build-28efd724b478/output/aarch64-linux-gnu/bitcoin-28efd724b478-aarch64-linux-gnu-debug.tar.gz\r\n1b5fee5de6da1981518dd6c04542e0194a810abe9911ee4844f9c8c546279b6a  guix-build-28efd724b478/output/aarch64-linux-gnu/bitcoin-28efd724b478-aarch64-linux-gnu.tar.gz\r\n43d8427e5b93fb909ee3fa258e9dc31fbdc5b6c52345a533eeda03540f9bb34e  guix-build-28efd724b478/output/arm-linux-gnueabihf/SHA256SUMS.part\r\n93e470a5e562d18cb8b3ffa94e1ef01acd589515ab194155a8c235764ab87626  guix-build-28efd724b478/output/arm-linux-gnueabihf/bitcoin-28efd724b478-arm-linux-gnueabihf-debug.tar.gz\r\nd43ba457e0f0b8f2a94c0ca275e4362f2de51dfed604242846e7bbfe62eedc96  guix-build-28efd724b478/output/arm-linux-gnueabihf/bitcoin-28efd724b478-arm-linux-gnueabihf.tar.gz\r\n4ec1277362492e81fb04e5e4ed1650f6e164d32475719852da696be21054f8fe  guix-build-28efd724b478/output/arm64-apple-darwin/SHA256SUMS.part\r\n5921117fd6b4326316f121de66fd760477eae8d7c95d998658a739e7d503a8db  guix-build-28efd724b478/output/arm64-apple-darwin/bitcoin-28efd724b478-arm64-apple-darwin-codesigning.tar.gz\r\n2680dee361d7bc11c5514d26516298cdce21bdb8f300fb2d687f4a6d5968f0b6  guix-build-28efd724b478/output/arm64-apple-darwin/bitcoin-28efd724b478-arm64-apple-darwin-unsigned.tar.gz\r\n43fb74424ec70638b82c9d21528ed23a4bab463a528799f1f5d7118a26180887  guix-build-28efd724b478/output/arm64-apple-darwin/bitcoin-28efd724b478-arm64-apple-darwin-unsigned.zip\r\n942a4b2df0c1b3fc678874da2e8498ecb76b809f1a1b2cafd140ef8eb7a7c3c4  guix-build-28efd724b478/output/dist-archive/bitcoin-28efd724b478.tar.gz\r\n3f8581bb77de1ef56f433c41b6c2df106058d17ac2e12989fed7ad7316eb26f9  guix-build-28efd724b478/output/powerpc64-linux-gnu/SHA256SUMS.part\r\n2b153f8d9dc73c812258c399d9f69b26e88c938c2e96cc8f2bac59bf9b9f2776  guix-build-28efd724b478/output/powerpc64-linux-gnu/bitcoin-28efd724b478-powerpc64-linux-gnu-debug.tar.gz\r\nb69da88ca19821f641f44aa29080ab16e26ca86c6ad07e4442a49baf68402c89  guix-build-28efd724b478/output/powerpc64-linux-gnu/bitcoin-28efd724b478-powerpc64-linux-gnu.tar.gz\r\ndb557e2c78dbbaa242298e712bae99c897ef5e61ac4077bce1fae34f1c76641d  guix-build-28efd724b478/output/riscv64-linux-gnu/SHA256SUMS.part\r\n1841206a9c9544ae439ca0acad124c812d5ad553585a97ef2f450125cee47f40  guix-build-28efd724b478/output/riscv64-linux-gnu/bitcoin-28efd724b478-riscv64-linux-gnu-debug.tar.gz\r\nf73237c499930f018d85f39bdc21edcbf545c1ceba3a257ceba51b1a0a91e119  guix-build-28efd724b478/output/riscv64-linux-gnu/bitcoin-28efd724b478-riscv64-linux-gnu.tar.gz\r\n7570bfd25ab6298961544f339004c37020677a4bcf457bdd7971dacc27dd60aa  guix-build-28efd724b478/output/x86_64-apple-darwin/SHA256SUMS.part\r\n784120520010258483e41e62cb01aa80daa2f8610fa678abaa434b88564e04c6  guix-build-28efd724b478/output/x86_64-apple-darwin/bitcoin-28efd724b478-x86_64-apple-darwin-codesigning.tar.gz\r\n9b38a1b50a486572e1c10185c3c3233273a20b251fcf91bebf6bd8d55ca44fc6  guix-build-28efd724b478/output/x86_64-apple-darwin/bitcoin-28efd724b478-x86_64-apple-darwin-unsigned.tar.gz\r\nb0a4acb2cdbad5be226a6f892b22eb02a6808c02bcdd6ab86138dde53d34bd9c  guix-build-28efd724b478/output/x86_64-apple-darwin/bitcoin-28efd724b478-x86_64-apple-darwin-unsigned.zip\r\nbdbc32eb313c895476a4a57ceeda9c916fa375742dc49e168c364f2ff413f070  guix-build-28efd724b478/output/x86_64-linux-gnu/SHA256SUMS.part\r\nc244eaae72d9846c2c508b02b8af19a08f4f061f6067d5828378f31f5569d677  guix-build-28efd724b478/output/x86_64-linux-gnu/bitcoin-28efd724b478-x86_64-linux-gnu-debug.tar.gz\r\nd7c926c87d39edbf29bda975fad7e525923ddbfe8ccf18700fb6520e3e6204af  guix-build-28efd724b478/output/x86_64-linux-gnu/bitcoin-28efd724b478-x86_64-linux-gnu.tar.gz\r\n78c041aec1453304181a689abf36d2f0db26ed6f0030a52248be17aae873950d  guix-build-28efd724b478/output/x86_64-w64-mingw32/SHA256SUMS.part\r\ndf44eb40ba69c699b21bbe7251391b4b2ddcaa105e7843374c428c6b7261acc0  guix-build-28efd724b478/output/x86_64-w64-mingw32/bitcoin-28efd724b478-win64-codesigning.tar.gz\r\n1416475f5ec2505f0f1e67e5fa6a96a9cac156008071eaf6dd6e66f3a69bc6c1  guix-build-28efd724b478/output/x86_64-w64-mingw32/bitcoin-28efd724b478-win64-debug.zip\r\n1421ffa73d1fc603bc2086edc8637a38ada6d90a9f2cbf82e1537f2d625d2a40  guix-build-28efd724b478/output/x86_64-w64-mingw32/bitcoin-28efd724b478-win64-setup-unsigned.exe\r\n34a2ceb2d535d173add5fb4e2cbff6ca58d8a4136c127ebda4d5f6791afe47bb  guix-build-28efd724b478/output/x86_64-w64-mingw32/bitcoin-28efd724b478-win64-unsigned.zip\r\n```",
          "created_at": "2025-09-12T12:18:24Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--9cd9c72976c961c55c7acef8f6ba82cd-->\n### Guix builds (on x86_64) [untrusted test-only build, possibly unsafe, not for production use]\n\n| File | commit 9a5ba154bea183fb13d413e095df0c14990e2bf6<br>(master) | commit 5a95127cd4414da10365e4dc8b7597879dec9a60<br>(pull/33373/merge) |\n|--|--|--|\n| *-aarch64-linux-gnu-debug.tar.gz | [`1af123edb13ff40e...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-aarch64-linux-gnu-debug.tar.gz) | [`75f9025e8d1443db...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-aarch64-linux-gnu-debug.tar.gz) |\n| *-aarch64-linux-gnu.tar.gz | [`3727c3d28a2d988a...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-aarch64-linux-gnu.tar.gz) | [`8a4fbcf9f092772c...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-aarch64-linux-gnu.tar.gz) |\n| *-arm-linux-gnueabihf-debug.tar.gz | [`d27ee65a4b794c26...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-arm-linux-gnueabihf-debug.tar.gz) | [`036910b3a1f1cd9f...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-arm-linux-gnueabihf-debug.tar.gz) |\n| *-arm-linux-gnueabihf.tar.gz | [`1dcf5ad499f4f8f8...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-arm-linux-gnueabihf.tar.gz) | [`7505a589e687db45...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-arm-linux-gnueabihf.tar.gz) |\n| *-arm64-apple-darwin-codesigning.tar.gz | [`f905df9242955966...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-arm64-apple-darwin-codesigning.tar.gz) | [`04a9a0ecc2a2e9a0...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-arm64-apple-darwin-codesigning.tar.gz) |\n| *-arm64-apple-darwin-unsigned.tar.gz | [`66689984ab12cb0d...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-arm64-apple-darwin-unsigned.tar.gz) | [`78ae859682d581e2...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-arm64-apple-darwin-unsigned.tar.gz) |\n| *-arm64-apple-darwin-unsigned.zip | [`26fef77e3eb67221...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-arm64-apple-darwin-unsigned.zip) | [`7a537ec971e8fd73...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-arm64-apple-darwin-unsigned.zip) |\n| *-powerpc64-linux-gnu-debug.tar.gz | [`eab16c01109c6260...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-powerpc64-linux-gnu-debug.tar.gz) | [`fd15e5734de7e3cd...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-powerpc64-linux-gnu-debug.tar.gz) |\n| *-powerpc64-linux-gnu.tar.gz | [`5e0bc03fed4c533c...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-powerpc64-linux-gnu.tar.gz) | [`54ad14d4dd087866...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-powerpc64-linux-gnu.tar.gz) |\n| *-riscv64-linux-gnu-debug.tar.gz | [`2f3129246d45865e...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-riscv64-linux-gnu-debug.tar.gz) | [`a6f97d0bbe2feb20...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-riscv64-linux-gnu-debug.tar.gz) |\n| *-riscv64-linux-gnu.tar.gz | [`02a523d33ea3f489...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-riscv64-linux-gnu.tar.gz) | [`350ccf16341e5903...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-riscv64-linux-gnu.tar.gz) |\n| *-x86_64-apple-darwin-codesigning.tar.gz | [`1c1c8c9fbe4f5cdf...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-x86_64-apple-darwin-codesigning.tar.gz) | [`05715a7f811ec88c...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-x86_64-apple-darwin-codesigning.tar.gz) |\n| *-x86_64-apple-darwin-unsigned.tar.gz | [`402e422ef96cfd1a...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-x86_64-apple-darwin-unsigned.tar.gz) | [`9f2ad8aea34059ab...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-x86_64-apple-darwin-unsigned.tar.gz) |\n| *-x86_64-apple-darwin-unsigned.zip | [`9f8691358e6ad9ed...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-x86_64-apple-darwin-unsigned.zip) | [`300137fa1b31e8e2...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-x86_64-apple-darwin-unsigned.zip) |\n| *-x86_64-linux-gnu-debug.tar.gz | [`1e53e28945180b42...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-x86_64-linux-gnu-debug.tar.gz) | [`a7c218a44cc971f3...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-x86_64-linux-gnu-debug.tar.gz) |\n| *-x86_64-linux-gnu.tar.gz | [`62eae6bb64ba7fa7...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1-x86_64-linux-gnu.tar.gz) | [`acf96486bad08234...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441-x86_64-linux-gnu.tar.gz) |\n| *.tar.gz | [`66dda3393f3f7819...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/bitcoin-9a5ba154bea1.tar.gz) | [`45b77af3a94d848d...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/bitcoin-5a95127cd441.tar.gz) |\n| SHA256SUMS.part | [`b36ed65a2fe8db0f...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/SHA256SUMS.part) | [`a9cd57b78afbee37...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/SHA256SUMS.part) |\n| guix_build.log | [`255e6f4b074e832c...`](https://drahtbot.space/guix/monotree/9a5ba154bea183fb13d413e095df0c14990e2bf6/guix_build.log) | [`65a598152c952ab4...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/guix_build.log) |\n| guix_build.log.diff |  | [`5084cde87eb37265...`](https://drahtbot.space/guix/monotree/5a95127cd4414da10365e4dc8b7597879dec9a60/guix_build.log.diff) |\n\n",
          "created_at": "2025-09-13T02:33:41Z"
        }
      ]
    },
    {
      "number": 33372,
      "title": "mining: log failed blocks in submitSolution()",
      "body": "Unlike the `submitblock` RPC which takes a fully serialized block, when a block solution is received via IPC the client only provides the nonce, coinbase and a few other fields to `submitSolution()`. It may not have all the information it needs to reconstruct the block. This makes debugging difficult when the block is invalid.\r\n\r\nThis commit therefore logs the fully serialized block if it's rejected. This is in addition to the failure reason logged by `ProcessNewBlock()`.\r\n\r\nExample on a custom signet:\r\n\r\n```\r\n2025-09-12T09:18:32Z [error] ProcessNewBlock: AcceptBlock FAILED (bad-signet-blksig, signet block signature validation failure)\r\n2025-09-12T09:18:32Z 000000204c002429741856d602d981fc9b8868d4cfe53d26f10ec5bed90186dbe2000000be72ddf01d23f7f1c3c165276c457b7a41bc0bac7b67096be4dd48e42d41612e6be5c368ae77031ef134b9a401020000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff36016200112f536a6f72736e61646f20506f6f6c2f2f20000100000000000000000000000000000000000000000000000000000000000100000000010000000000000000225120f140a01a8eed90d0d410af4e25eeca9c313915d2245e0f12321493d63b8be8550120000000000000000000000000000000000000000000000000000000000000000000000000\r\n```\r\n\r\nOn mainnet this would be a huge message, but the IPC connection is trusted.",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2025-09-12T09:31:17Z",
      "updated_at": "2025-09-15T06:42:43Z",
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/pull/33372",
      "labels": [
        "Mining"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33372.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-09-12T09:31:23Z"
        },
        {
          "user": "ajtowns",
          "body": "> On mainnet this would be a huge message, but the IPC connection is trusted.\r\n\r\nIf this is for IPC, wouldn't it make more sense to return the value over IPC as part of an error response? Otherwise, having it be a LogDebug or even LogTrace seems more sensible?",
          "created_at": "2025-09-12T09:54:06Z"
        },
        {
          "user": "Sjors",
          "body": "@ajtowns currently the return value is a boolean. I could indeed change it to return both a boolean and a string. But ideally I'd like to back port this to v30, so keeping it as simple as possible without changing the interface.\r\n\r\n(changing the interface would also break clients, but that's fine at this early testing stage)\r\n\r\nI picked `LogInfo` because, especially on mainnet, the information seems critical enough to log by default.",
          "created_at": "2025-09-12T10:13:28Z"
        },
        {
          "user": "Sjors",
          "body": "I opened #33374 as an alternative or complimentary approach.",
          "created_at": "2025-09-12T11:49:09Z"
        },
        {
          "user": "Sjors",
          "body": "The other PR has the additional benefit that the client can broadcast the block in additional ways, and/or inspect it with `checkBlock()`.",
          "created_at": "2025-09-12T17:06:11Z"
        },
        {
          "user": "ajtowns",
          "body": "I think logging failed blocks would run afoul of rate limiting (#32604) unless it were special-cased similarly to the UpdateTip log message.",
          "created_at": "2025-09-15T06:42:43Z"
        }
      ]
    },
    {
      "number": 33371,
      "title": ".",
      "body": "Utilizamos par√°metros personalizados listos para conexion grupal de 5 nodos y ejecutamos bloque minando exactamente 20 dle garcoin. Documentaci√≥n en garcoin md",
      "state": "closed",
      "user": "George11Albadr",
      "created_at": "2025-09-12T04:47:31Z",
      "updated_at": "2025-09-12T07:19:58Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/pull/33371",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33371.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-09-12T04:47:36Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 33375,
      "title": "bench: unrealistic ConnectBlock benchmarks",
      "body": "The current `ConnectBlock` benchmarks in `bench/connectblock.cpp` do not reflect realistic mainnet workloads due to three key issues:\n\n#### 1. Unrealistic block composition\n\nEvery benchmarked block is constructed with a highly artificial transaction pattern:\n\n```c\n/*\n * - Each transaction has the same number of inputs and outputs\n * - All Taproot inputs use simple key path spends (no script path spends)\n * - All signatures use SIGHASH_ALL (default sighash)\n * - Each transaction spends all outputs from the previous transaction\n */\n```\n\nThis setup avoids realistic UTXO set fragmentation and script diversity. The benchmark effectively measures validation of a synthetic \"ladder\" of transactions rather than a block resembling mainnet traffic.\n\n#### 2. Unrealistic UTXO cache state\n\nBefore benchmarking, the code creates a block that produces the outputs, then immediately spends them all in the benchmark block. This keeps the entire UTXO set hot in memory (`CoinsTip()`).\n\nIn reality:\n\n* Many UTXO lookups hit LevelDB and require disk access.\n* Cache misses and eviction policies significantly impact block validation cost.\n\n#### 3. Unrealistic repetition\n\nEach benchmark repeatedly validates the same synthetic block:\n\n```cpp\n    const auto& test_block{CreateTestBlock(test_setup, keys, outputs)};\n    bench.unit(\"block\").run([&] {\n        /* ... */\n    });\n```\n\nThere is no variability in transaction graph, script mix, or UTXO evolution across iterations. As a result, the benchmark never exercises cache churn, block-to-block dependency patterns, or realistic workload diversity.\n\n---\n\n### Why this matters\n\nThese issues mean the benchmark results do not reflect real-world `ConnectBlock` performance. Instead, they measure a best-case, memory-only workload on a synthetic block structure.\n",
      "state": "open",
      "user": "Raimo33",
      "created_at": "2025-09-12T12:53:02Z",
      "updated_at": "2026-01-14T15:18:23Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/33375",
      "labels": [
        "Validation"
      ],
      "comment_list": [
        {
          "user": "davidgumberg",
          "body": "I am [skeptical](https://github.com/bitcoin/bitcoin/pull/31689#issuecomment-2655685417) of trying to measure end-to-end performance of Bitcoin Core systems like block connection including LevelDB performance using a microbenchmark suite. In my opinion, these benchmarks work best at measuring the performance of specific components and functions a-la unit tests, and I would not object to adding more scenarios to `ConnectBlock()` that are meant to exercise the performance of certain segments of block connection, but I think to get measurements of realistic scenarios, there is no substitute for just measuring Bitcoin Core nodes doing IBD, of interest might be the benchkit project for measuring IBD's: https://github.com/bitcoin-dev-tools/benchkit.",
          "created_at": "2025-09-13T00:06:14Z"
        },
        {
          "user": "Raimo33",
          "body": "it's not \"a little bit of faithfulness\" that you sacrifice. you're ignoring the cache completely.",
          "created_at": "2025-09-13T14:44:05Z"
        },
        {
          "user": "l0rinc",
          "body": "@Raimo33 if you can provide an alternative that's reasonably simple for a micro-benchmark, I will happily review it.\n\nBut note that I already have a few micro-benchmark improvements in that area where review is needed:\n* https://github.com/bitcoin/bitcoin/pull/32554 - creates a configurable block so that we can measure the composition of the block\n* https://github.com/bitcoin/bitcoin/pull/32729/files#diff-547fa26a77a99ccd77aca7ce1c69c0544666f788d463dc7bff664001f9ff1c88R40 - splits checkblock measurements from serialization\n* https://github.com/bitcoin/bitcoin/pull/31868/files#diff-547fa26a77a99ccd77aca7ce1c69c0544666f788d463dc7bff664001f9ff1c88R24 - adding separate benchmark for serialization size counting\n* https://github.com/bitcoin/bitcoin/pull/31682/files#diff-99f9f77ae4c2d8d3d3b611b8a38ee08b48239dcc30417179b07b1b092b1d9dd6R138 - dedicated transaction processing benchmark",
          "created_at": "2025-09-15T02:11:47Z"
        },
        {
          "user": "HowHsu",
          "body": "I can confirm that this issue is true, during my testing for my PRÔºö [https://github.com/bitcoin/bitcoin/pull/32791](url) .\nTo test ConnectBlock() realistically, I think we can leverage `CVerifyDB::VerifyDB()`, it is called on node init. It mainly replays\nthe latest `-check_blocks` blocks in the best chain when you set `-check_level` to 4. Considering cache state, you have to manually\nset it at the begining (flush it for no-cache case, pre-load entries for cache-hit case, .etc).Surely you have to find a good height range of blocks first.",
          "created_at": "2025-09-15T13:34:49Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 11,
    "issues": 1
  }
}