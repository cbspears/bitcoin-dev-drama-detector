{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T20:04:22.262303+00:00",
  "date": "2025-08-06",
  "pull_requests": [
    {
      "number": 33145,
      "title": "CI: silent merge check",
      "body": "With the upcoming potential migration to cirrus runners (#32989) we need a way to periodically check for a silent merge conflict. Cirrus CI currently does this every week.\r\n\r\nThis is part of a proposal that will look for a label on a PR as a trigger to run the lint and get_previous_releases test. This label could be added manually or better, Drahtbot could periodically add (and remove) this label.\r\n\r\nAn example of this running on a test org: https://github.com/testing-cirrus-runners/bitcoin/actions/runs/16780213204/job/47516540034",
      "state": "open",
      "user": "m3dwards",
      "created_at": "2025-08-06T14:53:08Z",
      "updated_at": "2025-11-21T16:52:52Z",
      "comments": 11,
      "url": "https://github.com/bitcoin/bitcoin/pull/33145",
      "labels": [
        "Tests",
        "Needs rebase"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33145.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [fjahr](https://github.com/bitcoin/bitcoin/pull/33145#issuecomment-3563843760) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32989](https://github.com/bitcoin/bitcoin/pull/32989) (ci: Migrate CI to hosted Cirrus Runners by willcl-ark)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-08-06T14:53:13Z"
        },
        {
          "user": "Sammie05",
          "body": "Nice work on this! The label-based trigger for PeriodicMergeCICheck is a clean approach.\r\n\r\nOne thought  though since this is driven by label events, do we need to consider cases where multiple labels are applied at once? Would the condition still behave as expected?\r\n\r\nAlso agree with the suggestion from @maflcko  having a vector of task names could as well improve flexibility",
          "created_at": "2025-08-06T19:54:22Z"
        },
        {
          "user": "maflcko",
          "body": "Other stuff to check would be that this works at all and doesn't just re-run an ancient commit, like https://github.com/bitcoin/bitcoin/pull/32989#issuecomment-3133536724",
          "created_at": "2025-08-07T08:32:04Z"
        },
        {
          "user": "m3dwards",
          "body": "> Other stuff to check would be that this works at all and doesn't just re-run an ancient commit, like [#32989 (comment)](https://github.com/bitcoin/bitcoin/pull/32989#issuecomment-3133536724)\r\n\r\nJust ran a test to specifically test for this by updating the default (master) branch and adding and removing the label and it correctly picked an updated merge commit based on the PR merged into the updated master.",
          "created_at": "2025-08-07T14:26:27Z"
        },
        {
          "user": "m3dwards",
          "body": "> Have you considered doing something like the following in `.github/workflows/ci.yml` to avoid having to maintain separate files?\r\n\r\nCould be a good shout, seems a bit of a verbose check if that has to be included in each job. I'll have a think about it. This is exactly the type of feedback that's good to consider.\r\n",
          "created_at": "2025-08-08T16:10:54Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\nüêô This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
          "created_at": "2025-09-03T10:37:50Z"
        },
        {
          "user": "maflcko",
          "body": "concept ack, but I don't have the slightest idea if this is even possible (or how) with GHA",
          "created_at": "2025-09-04T09:43:59Z"
        },
        {
          "user": "m3dwards",
          "body": "Currently working on an alternative approach of one job that loops through PRs, might close this PR in favour of the other one based on feedback.",
          "created_at": "2025-09-04T13:26:33Z"
        },
        {
          "user": "maflcko",
          "body": "Any updates here? Just asking, because it is a bit tedious to manually search for all silent merge conflicts. Example ref: https://github.com/bitcoin/bitcoin/pull/29136#issuecomment-3409544132",
          "created_at": "2025-10-16T07:29:45Z"
        },
        {
          "user": "fjahr",
          "body": "Concept ACK",
          "created_at": "2025-11-21T16:47:32Z"
        },
        {
          "user": "maflcko",
          "body": "I think what could work (hacky, untested):\r\n\r\n* Setup a separate \"silent-merge-check\" repo with the desired ci config\r\n* Push the selected ci runs to it on the desired schedule\r\n* Get the result, and on failure, pass it back to the upstream repo",
          "created_at": "2025-11-21T16:52:52Z"
        }
      ]
    },
    {
      "number": 33144,
      "title": "build: Set AUTHOR_WARNING on warnings",
      "body": "Now that the cmake setting `-Werror=dev` is set since commit 6a13a6106e3c1ebe95ba6430184d6260a7b942bd for the CI, guix and the dev cmake preset, it could make sense to notify developers about any warnings.\r\n\r\nSo do that with a single `AUTHOR_WARNING`.\r\n\r\nThis can be tested by introducing a bug, like:\r\n\r\n```diff\r\ndiff --git a/CMakeLists.txt b/CMakeLists.txt\r\nindex 6017775fa7..5610e03c66 100644\r\n--- a/CMakeLists.txt\r\n+++ b/CMakeLists.txt\r\n@@ -589,7 +589,7 @@ set(Python3_FIND_FRAMEWORK LAST CACHE STRING \"\")\r\n # improves compatibility with Python version managers that use shims.\r\n set(Python3_FIND_UNVERSIONED_NAMES FIRST CACHE STRING \"\")\r\n mark_as_advanced(Python3_FIND_FRAMEWORK Python3_FIND_UNVERSIONED_NAMES)\r\n-find_package(Python3 3.10 COMPONENTS Interpreter)\r\n+find_package(Python3 3.210 COMPONENTS Interpreter)\r\n if(NOT TARGET Python3::Interpreter)\r\n   list(APPEND configure_warnings\r\n     \"Minimum required Python not found.\"\r\n```\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/31476.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2025-08-06T14:27:56Z",
      "updated_at": "2025-11-23T11:28:41Z",
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/pull/33144",
      "labels": [
        "Build system"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33144.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [l0rinc](https://github.com/bitcoin/bitcoin/pull/33144#issuecomment-3161213864), [stickies-v](https://github.com/bitcoin/bitcoin/pull/33144#pullrequestreview-3174447010) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-08-06T14:28:02Z"
        },
        {
          "user": "l0rinc",
          "body": "Rebased, tested it with:\r\n```patch\r\ndiff --git a/CMakeLists.txt b/CMakeLists.txt\r\n--- a/CMakeLists.txt\t(revision 27e4b8c6856194fa8db028b6f7356f83ea3d7e3a)\r\n+++ b/CMakeLists.txt\t(date 1754504896922)\r\n@@ -186,6 +186,7 @@\r\n string(APPEND CMAKE_CXX_LINK_EXECUTABLE \" ${APPEND_LDFLAGS}\")\r\n\r\n set(configure_warnings)\r\n+list(APPEND configure_warnings \"Testing https://github.com/bitcoin/bitcoin/pull/33144\")\r\n\r\n include(CheckLinkerSupportsPIE)\r\n check_linker_supports_pie(configure_warnings)\r\n```\r\n\r\nrunning:\r\n```bash\r\nrm -rfd build && cmake -B build 2>&1 | grep -C1 Warning\r\n```\r\n\r\nPrints before the change:\r\n```bash\r\nCMake Warning at CMakeLists.txt:709 (message):\r\n  Testing https://github.com/bitcoin/bitcoin/pull/33144\r\n```\r\n\r\nAfter the change:\r\n```bash\r\nCMake Warning at CMakeLists.txt:709 (message):\r\n  Testing https://github.com/bitcoin/bitcoin/pull/33144\r\n--\r\n\r\nCMake Warning (dev) at CMakeLists.txt:712 (message):\r\n  Warnings have been encountered!\r\nThis warning is for project developers.  Use -Wno-dev to suppress it.\r\n```\r\n\r\n\r\nACK fa6497ba71e9573d341c1c051af09b3ec2fc8d74",
          "created_at": "2025-08-06T18:45:33Z"
        },
        {
          "user": "maflcko",
          "body": "Sounds good. Happy to put this in draft for now to see if your removal of `configure_warnings` makes it in, but I haven't looked at 2. and 3., if they make sense.",
          "created_at": "2025-09-02T07:22:35Z"
        },
        {
          "user": "stickies-v",
          "body": "> Sounds good.\r\n\r\nThanks for the feedback, I've opened #33278.\r\n\r\n> Happy to put this in draft for now\r\n\r\nThe changes in this/your PR are small, straightforward, can easily be reverted, and offer immediate practical benefit, so I think it makes sense to not block this on my much less straightforward alternative, so my ACK still stands and I'd be happy if this makes progress.",
          "created_at": "2025-09-02T11:55:13Z"
        },
        {
          "user": "davidgumberg",
          "body": "I don't see how abusing the semantics of `AUTHOR_WARNING` is preferable to adding our own flag (#31665), but I prefer fixing #31476, so not a big deal.\r\n\r\n--- \r\n\r\n~I think the changes implemented by @stickies-v in https://github.com/bitcoin/bitcoin/compare/7cc9a087069bfcdb79a08ce77eb3a60adf9483af...stickies-v:2025-09/cmake-remove-configure-warnings make sense individually, but the sum total of this approach is that it shifts the experience of building bitcoin core from `cmake -B build` doing what it can to configure a reasonable build for you given what it can find to: attempt build, read errors to see what it's mad about, install a dependency or disable a feature, repeat, and that is a much worse experience in my opinion.~\r\n\r\n~Trying our best to configure a build and printing warnings and letting mindful users read and address them, and fixing #31476 so that warnings are never tolerated in CI / dev preset builds seems like a better approach to me.~\r\n\r\nEdit: On further thought, https://github.com/bitcoin/bitcoin/compare/7cc9a087069bfcdb79a08ce77eb3a60adf9483af...stickies-v:2025-09/cmake-remove-configure-warnings wouldn't really be a shift from the current approach, we don't generally change build configuration based on what is found on the user's system, that was true in the old build system: \r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/44d8b13c81e5276eb610c99f227a4d090cc532f6/build-aux/m4/bitcoin_qt.m4#L5-L17\r\n\r\nEdit: Edit:\r\n\r\nAlso see discussion here: https://github.com/bitcoin/bitcoin/pull/33290#issuecomment-3256100512",
          "created_at": "2025-09-04T22:07:41Z"
        },
        {
          "user": "maflcko",
          "body": "+GHA CI",
          "created_at": "2025-09-07T11:20:26Z"
        },
        {
          "user": "hebasto",
          "body": "cc @purpleKarrot ",
          "created_at": "2025-11-23T11:28:41Z"
        }
      ]
    },
    {
      "number": 33143,
      "title": "[28.x] Backports",
      "body": "Backports:\r\n* #33133",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-08-06T11:16:25Z",
      "updated_at": "2025-08-15T16:15:10Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/pull/33143",
      "labels": [
        "Backport",
        "CI failed"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33143.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [willcl-ark](https://github.com/bitcoin/bitcoin/pull/33143#pullrequestreview-3124380691) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-08-06T11:16:35Z"
        }
      ]
    },
    {
      "number": 33142,
      "title": "test: Run bench sanity checks in parallel with functional tests",
      "body": "The ctest target `bench_sanity_check` has many issues:\r\n\r\n* With sanitizers enabled, it is one of the slowest targets, often taking several minutes. See https://github.com/bitcoin/bitcoin/issues/32770#issuecomment-2984264066.\r\n* There is no insight from ctest into how long each individual sanity check takes.\r\n* On a timeout, or OOM issue, there is no insight into which sub-bench failed. The failure will generally just look like `75/153 Test   #9: bench_sanity_check ...................***Failed  770.84 sec    out of memory`\r\n* Places that can't use ctest (like the Windows-cross CI task) have to explicitly run it, or risk forgetting to run it.\r\n* All benchmarks are run sequentially, when they could run in parallel instead.\r\n\r\nBoth issues can lead to CI timeouts and leave CPU unused during testing.\r\n\r\nFix all issues by running it as part of the functional tests instead. This is similar to the rpcauth tests (https://github.com/bitcoin/bitcoin/pull/32881) and util tests [bitcoin-tx, and bitcoin-util] (https://github.com/bitcoin/bitcoin/pull/32697).",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-08-06T08:30:17Z",
      "updated_at": "2026-01-06T14:03:00Z",
      "comments": 19,
      "url": "https://github.com/bitcoin/bitcoin/pull/33142",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33142.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [l0rinc](https://github.com/bitcoin/bitcoin/pull/33142#pullrequestreview-3622033487), [janb84](https://github.com/bitcoin/bitcoin/pull/33142#pullrequestreview-3625907801), [willcl-ark](https://github.com/bitcoin/bitcoin/pull/33142#pullrequestreview-3626996331), [achow101](https://github.com/bitcoin/bitcoin/pull/33142#issuecomment-3712455279) |\n| Concept NACK | [purpleKarrot](https://github.com/bitcoin/bitcoin/pull/33142#issuecomment-3334810848) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#33483](https://github.com/bitcoin/bitcoin/pull/33483) (CMake: Add dynamic test discovery by purpleKarrot)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-08-06T08:30:23Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `lint`: https://github.com/bitcoin/bitcoin/runs/47488255049</sub>\n<sub>LLM reason (‚ú® experimental): The CI failure is due to errors from the Python linting check.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-08-06T08:56:03Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `lint`: https://github.com/bitcoin/bitcoin/runs/47498178413</sub>\n<sub>LLM reason (‚ú® experimental): The CI failure is caused by a lint error due to an unused import detected by ruff.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-08-06T10:52:01Z"
        },
        {
          "user": "willcl-ark",
          "body": "I get an error compiling this without `bench_bitcoin`:\r\n\r\n```\r\n‚ùØ cmake -B build; and cmake --build build; and ./build/test/functional/test_runner.py -j14\r\n-- The CXX compiler identification is Clang 19.1.7\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Check for working CXX compiler: /etc/profiles/per-user/will/bin/c++ - skipped\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\n-- Setting build type to \"RelWithDebInfo\" as none was specified\r\n-- Performing Test CXX_SUPPORTS__WERROR\r\n-- Performing Test CXX_SUPPORTS__WERROR - Success\r\n-- Performing Test CXX_SUPPORTS__G3\r\n-- Performing Test CXX_SUPPORTS__G3 - Success\r\n-- Performing Test LINKER_SUPPORTS__G3\r\n-- Performing Test LINKER_SUPPORTS__G3 - Success\r\n-- Performing Test CXX_SUPPORTS__FTRAPV\r\n-- Performing Test CXX_SUPPORTS__FTRAPV - Success\r\n-- Performing Test LINKER_SUPPORTS__FTRAPV\r\n-- Performing Test LINKER_SUPPORTS__FTRAPV - Success\r\n-- Found SQLite3: /nix/store/92gwa4j45skp8d096csmnj2a8jcn0q9w-sqlite-3.48.0-dev/include (found suitable version \"3.48.0\", minimum required is \"3.7.17\")\r\n-- Performing Test LINKER_SUPPORTS__WL___FATAL_WARNINGS\r\n-- Performing Test LINKER_SUPPORTS__WL___FATAL_WARNINGS - Success\r\n-- Performing Test CMAKE_HAVE_LIBC_PTHREAD\r\n-- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Success\r\n-- Found Threads: TRUE\r\n-- Performing Test NO_DIAGNOSTICS_BOOST_NO_CXX98_FUNCTION_BASE\r\n-- Performing Test NO_DIAGNOSTICS_BOOST_NO_CXX98_FUNCTION_BASE - Failed\r\n-- Found PkgConfig: /nix/store/2crk9xnq5x9v7yf0r2nwkgj8qsmxr4ly-pkg-config-wrapper-0.29.2/bin/pkg-config (found version \"0.29.2\")\r\n-- Found Libevent: /nix/store/yai7mpy5d4rw0jvflyxdf0vzjkiqxhv6-libevent-2.1.12/lib (found suitable version \"2.1.12-stable\", minimum required is \"2.1.8\")\r\n-- Performing Test HAVE_EVHTTP_CONNECTION_GET_PEER_CONST_CHAR\r\n-- Performing Test HAVE_EVHTTP_CONNECTION_GET_PEER_CONST_CHAR - Failed\r\n-- Looking for O_CLOEXEC\r\n-- Looking for O_CLOEXEC - found\r\n-- Looking for fdatasync\r\n-- Looking for fdatasync - found\r\n-- Looking for fork\r\n-- Looking for fork - found\r\n-- Looking for pipe2\r\n-- Looking for pipe2 - found\r\n-- Looking for setsid\r\n-- Looking for setsid - found\r\n-- Performing Test IFADDR_LINKS_WITHOUT_LIBSOCKET\r\n-- Performing Test IFADDR_LINKS_WITHOUT_LIBSOCKET - Success\r\n-- Performing Test STD_ATOMIC_LINKS_WITHOUT_LIBATOMIC\r\n-- Performing Test STD_ATOMIC_LINKS_WITHOUT_LIBATOMIC - Success\r\n-- Looking for std::system\r\n-- Looking for std::system - found\r\n-- Looking for ::_wsystem\r\n-- Looking for ::_wsystem - not found\r\n-- Performing Test STRERROR_R_CHAR_P\r\n-- Performing Test STRERROR_R_CHAR_P - Success\r\n-- Looking for malloc_info\r\n-- Looking for malloc_info - found\r\n-- Performing Test HAVE_MALLOPT_ARENA_MAX\r\n-- Performing Test HAVE_MALLOPT_ARENA_MAX - Success\r\n-- Performing Test HAVE_POSIX_FALLOCATE\r\n-- Performing Test HAVE_POSIX_FALLOCATE - Success\r\n-- Performing Test HAVE_STRONG_GETAUXVAL\r\n-- Performing Test HAVE_STRONG_GETAUXVAL - Success\r\n-- Performing Test HAVE_SOCKADDR_UN\r\n-- Performing Test HAVE_SOCKADDR_UN - Success\r\n-- Performing Test HAVE_GETRANDOM\r\n-- Performing Test HAVE_GETRANDOM - Success\r\n-- Performing Test HAVE_GETENTROPY_RAND\r\n-- Performing Test HAVE_GETENTROPY_RAND - Success\r\n-- Performing Test HAVE_SYSCTL\r\n-- Performing Test HAVE_SYSCTL - Failed\r\n-- Performing Test HAVE_SYSCTL_ARND\r\n-- Performing Test HAVE_SYSCTL_ARND - Failed\r\n-- Performing Test HAVE_SSE41\r\n-- Performing Test HAVE_SSE41 - Success\r\n-- Performing Test HAVE_AVX2\r\n-- Performing Test HAVE_AVX2 - Success\r\n-- Performing Test HAVE_X86_SHANI\r\n-- Performing Test HAVE_X86_SHANI - Success\r\n-- Performing Test HAVE_ARM_SHANI\r\n-- Performing Test HAVE_ARM_SHANI - Failed\r\n-- Performing Test CXX_SUPPORTS__WALL\r\n-- Performing Test CXX_SUPPORTS__WALL - Success\r\n-- Performing Test CXX_SUPPORTS__WEXTRA\r\n-- Performing Test CXX_SUPPORTS__WEXTRA - Success\r\n-- Performing Test CXX_SUPPORTS__WGNU\r\n-- Performing Test CXX_SUPPORTS__WGNU - Success\r\n-- Performing Test CXX_SUPPORTS__WFORMAT__WFORMAT_SECURITY\r\n-- Performing Test CXX_SUPPORTS__WFORMAT__WFORMAT_SECURITY - Success\r\n-- Performing Test CXX_SUPPORTS__WVLA\r\n-- Performing Test CXX_SUPPORTS__WVLA - Success\r\n-- Performing Test CXX_SUPPORTS__WSHADOW_FIELD\r\n-- Performing Test CXX_SUPPORTS__WSHADOW_FIELD - Success\r\n-- Performing Test CXX_SUPPORTS__WTHREAD_SAFETY\r\n-- Performing Test CXX_SUPPORTS__WTHREAD_SAFETY - Success\r\n-- Performing Test CXX_SUPPORTS__WTHREAD_SAFETY_POINTER\r\n-- Performing Test CXX_SUPPORTS__WTHREAD_SAFETY_POINTER - Failed\r\n-- Performing Test CXX_SUPPORTS__WLOOP_ANALYSIS\r\n-- Performing Test CXX_SUPPORTS__WLOOP_ANALYSIS - Success\r\n-- Performing Test CXX_SUPPORTS__WREDUNDANT_DECLS\r\n-- Performing Test CXX_SUPPORTS__WREDUNDANT_DECLS - Success\r\n-- Performing Test CXX_SUPPORTS__WUNUSED_MEMBER_FUNCTION\r\n-- Performing Test CXX_SUPPORTS__WUNUSED_MEMBER_FUNCTION - Success\r\n-- Performing Test CXX_SUPPORTS__WDATE_TIME\r\n-- Performing Test CXX_SUPPORTS__WDATE_TIME - Success\r\n-- Performing Test CXX_SUPPORTS__WCONDITIONAL_UNINITIALIZED\r\n-- Performing Test CXX_SUPPORTS__WCONDITIONAL_UNINITIALIZED - Success\r\n-- Performing Test CXX_SUPPORTS__WDUPLICATED_BRANCHES\r\n-- Performing Test CXX_SUPPORTS__WDUPLICATED_BRANCHES - Failed\r\n-- Performing Test CXX_SUPPORTS__WDUPLICATED_COND\r\n-- Performing Test CXX_SUPPORTS__WDUPLICATED_COND - Failed\r\n-- Performing Test CXX_SUPPORTS__WLOGICAL_OP\r\n-- Performing Test CXX_SUPPORTS__WLOGICAL_OP - Failed\r\n-- Performing Test CXX_SUPPORTS__WOVERLOADED_VIRTUAL\r\n-- Performing Test CXX_SUPPORTS__WOVERLOADED_VIRTUAL - Success\r\n-- Performing Test CXX_SUPPORTS__WSUGGEST_OVERRIDE\r\n-- Performing Test CXX_SUPPORTS__WSUGGEST_OVERRIDE - Success\r\n-- Performing Test CXX_SUPPORTS__WIMPLICIT_FALLTHROUGH\r\n-- Performing Test CXX_SUPPORTS__WIMPLICIT_FALLTHROUGH - Success\r\n-- Performing Test CXX_SUPPORTS__WUNREACHABLE_CODE\r\n-- Performing Test CXX_SUPPORTS__WUNREACHABLE_CODE - Success\r\n-- Performing Test CXX_SUPPORTS__WDOCUMENTATION\r\n-- Performing Test CXX_SUPPORTS__WDOCUMENTATION - Success\r\n-- Performing Test CXX_SUPPORTS__WSELF_ASSIGN\r\n-- Performing Test CXX_SUPPORTS__WSELF_ASSIGN - Success\r\n-- Performing Test CXX_SUPPORTS__WBIDI_CHARS_ANY\r\n-- Performing Test CXX_SUPPORTS__WBIDI_CHARS_ANY - Failed\r\n-- Performing Test CXX_SUPPORTS__WUNDEF\r\n-- Performing Test CXX_SUPPORTS__WUNDEF - Success\r\n-- Performing Test CXX_SUPPORTS__WUNUSED_PARAMETER\r\n-- Performing Test CXX_SUPPORTS__WUNUSED_PARAMETER - Success\r\n-- Performing Test CXX_SUPPORTS__FNO_EXTENDED_IDENTIFIERS\r\n-- Performing Test CXX_SUPPORTS__FNO_EXTENDED_IDENTIFIERS - Failed\r\n-- Performing Test CXX_SUPPORTS__FDEBUG_PREFIX_MAP_A_B\r\n-- Performing Test CXX_SUPPORTS__FDEBUG_PREFIX_MAP_A_B - Success\r\n-- Performing Test CXX_SUPPORTS__FMACRO_PREFIX_MAP_A_B\r\n-- Performing Test CXX_SUPPORTS__FMACRO_PREFIX_MAP_A_B - Success\r\n-- Performing Test CXX_SUPPORTS__FSTACK_REUSE_NONE\r\n-- Performing Test CXX_SUPPORTS__FSTACK_REUSE_NONE - Failed\r\n-- Performing Test CXX_SUPPORTS__U_FORTIFY_SOURCE__D_FORTIFY_SOURCE_3_2d08\r\n-- Performing Test CXX_SUPPORTS__U_FORTIFY_SOURCE__D_FORTIFY_SOURCE_3_2d08 - Success\r\n-- Performing Test LINKER_SUPPORTS__U_FORTIFY_SOURCE__D_FORTIFY_SOURCE_3_2d08\r\n-- Performing Test LINKER_SUPPORTS__U_FORTIFY_SOURCE__D_FORTIFY_SOURCE_3_2d08 - Success\r\n-- Performing Test CXX_SUPPORTS__WSTACK_PROTECTOR\r\n-- Performing Test CXX_SUPPORTS__WSTACK_PROTECTOR - Success\r\n-- Performing Test CXX_SUPPORTS__FSTACK_PROTECTOR_ALL\r\n-- Performing Test CXX_SUPPORTS__FSTACK_PROTECTOR_ALL - Success\r\n-- Performing Test LINKER_SUPPORTS__FSTACK_PROTECTOR_ALL\r\n-- Performing Test LINKER_SUPPORTS__FSTACK_PROTECTOR_ALL - Success\r\n-- Performing Test CXX_SUPPORTS__FCF_PROTECTION_FULL\r\n-- Performing Test CXX_SUPPORTS__FCF_PROTECTION_FULL - Success\r\n-- Performing Test LINKER_SUPPORTS__FCF_PROTECTION_FULL\r\n-- Performing Test LINKER_SUPPORTS__FCF_PROTECTION_FULL - Success\r\n-- Performing Test CXX_SUPPORTS__FSTACK_CLASH_PROTECTION\r\n-- Performing Test CXX_SUPPORTS__FSTACK_CLASH_PROTECTION - Success\r\n-- Performing Test LINKER_SUPPORTS__FSTACK_CLASH_PROTECTION\r\n-- Performing Test LINKER_SUPPORTS__FSTACK_CLASH_PROTECTION - Success\r\n-- Performing Test LINKER_SUPPORTS__WL___ENABLE_RELOC_SECTION\r\n-- Performing Test LINKER_SUPPORTS__WL___ENABLE_RELOC_SECTION - Failed\r\n-- Performing Test LINKER_SUPPORTS__WL___DYNAMICBASE\r\n-- Performing Test LINKER_SUPPORTS__WL___DYNAMICBASE - Failed\r\n-- Performing Test LINKER_SUPPORTS__WL___NXCOMPAT\r\n-- Performing Test LINKER_SUPPORTS__WL___NXCOMPAT - Failed\r\n-- Performing Test LINKER_SUPPORTS__WL___HIGH_ENTROPY_VA\r\n-- Performing Test LINKER_SUPPORTS__WL___HIGH_ENTROPY_VA - Failed\r\n-- Performing Test LINKER_SUPPORTS__WL__Z_RELRO\r\n-- Performing Test LINKER_SUPPORTS__WL__Z_RELRO - Success\r\n-- Performing Test LINKER_SUPPORTS__WL__Z_NOW\r\n-- Performing Test LINKER_SUPPORTS__WL__Z_NOW - Success\r\n-- Performing Test LINKER_SUPPORTS__WL__Z_SEPARATE_CODE\r\n-- Performing Test LINKER_SUPPORTS__WL__Z_SEPARATE_CODE - Success\r\n-- Found Python3: /nix/store/yqy95kjk7mz7y62www64krlkrrs4w7fh-python3-3.13.3-env/bin/python3 (found suitable version \"3.13.3\", minimum required is \"3.10\") found components: Interpreter\r\n-- Could NOT find Doxygen (missing: DOXYGEN_EXECUTABLE dot)\r\n-- Performing Test HAVE_BUILTIN_PREFETCH\r\n-- Performing Test HAVE_BUILTIN_PREFETCH - Success\r\n-- Performing Test HAVE_MM_PREFETCH\r\n-- Performing Test HAVE_MM_PREFETCH - Success\r\n-- Performing Test HAVE_SSE42\r\n-- Performing Test HAVE_SSE42 - Success\r\n-- Performing Test HAVE_ARM64_CRC32C\r\n-- Performing Test HAVE_ARM64_CRC32C - Failed\r\n-- Looking for F_FULLFSYNC\r\n-- Looking for F_FULLFSYNC - not found\r\n-- Performing Test HAVE_CLMUL\r\n-- Performing Test HAVE_CLMUL - Success\r\n\r\nConfiguring secp256k1 subtree...\r\n-- The C compiler identification is Clang 19.1.7\r\n-- Detecting C compiler ABI info\r\n-- Detecting C compiler ABI info - done\r\n-- Check for working C compiler: /etc/profiles/per-user/will/bin/cc - skipped\r\n-- Detecting C compile features\r\n-- Detecting C compile features - done\r\n-- Performing Test HAVE_X86_64_ASM\r\n-- Performing Test HAVE_X86_64_ASM - Success\r\n-- Could NOT find Valgrind (missing: Valgrind_INCLUDE_DIR Valgrind_WORKS)\r\n-- Performing Test C_SUPPORTS__WALL\r\n-- Performing Test C_SUPPORTS__WALL - Success\r\n-- Performing Test C_SUPPORTS__PEDANTIC\r\n-- Performing Test C_SUPPORTS__PEDANTIC - Success\r\n-- Performing Test C_SUPPORTS__WCAST_ALIGN\r\n-- Performing Test C_SUPPORTS__WCAST_ALIGN - Success\r\n-- Performing Test C_SUPPORTS__WCAST_ALIGN_STRICT\r\n-- Performing Test C_SUPPORTS__WCAST_ALIGN_STRICT - Failed\r\n-- Performing Test C_SUPPORTS__WCONDITIONAL_UNINITIALIZED\r\n-- Performing Test C_SUPPORTS__WCONDITIONAL_UNINITIALIZED - Success\r\n-- Performing Test C_SUPPORTS__WEXTRA\r\n-- Performing Test C_SUPPORTS__WEXTRA - Success\r\n-- Performing Test C_SUPPORTS__WNESTED_EXTERNS\r\n-- Performing Test C_SUPPORTS__WNESTED_EXTERNS - Success\r\n-- Performing Test C_SUPPORTS__WNO_LONG_LONG\r\n-- Performing Test C_SUPPORTS__WNO_LONG_LONG - Success\r\n-- Performing Test C_SUPPORTS__WNO_OVERLENGTH_STRINGS\r\n-- Performing Test C_SUPPORTS__WNO_OVERLENGTH_STRINGS - Success\r\n-- Performing Test C_SUPPORTS__WNO_UNUSED_FUNCTION\r\n-- Performing Test C_SUPPORTS__WNO_UNUSED_FUNCTION - Success\r\n-- Performing Test C_SUPPORTS__WRESERVED_IDENTIFIER\r\n-- Performing Test C_SUPPORTS__WRESERVED_IDENTIFIER - Success\r\n-- Performing Test C_SUPPORTS__WSHADOW\r\n-- Performing Test C_SUPPORTS__WSHADOW - Success\r\n-- Performing Test C_SUPPORTS__WSTRICT_PROTOTYPES\r\n-- Performing Test C_SUPPORTS__WSTRICT_PROTOTYPES - Success\r\n-- Performing Test C_SUPPORTS__WUNDEF\r\n-- Performing Test C_SUPPORTS__WUNDEF - Success\r\n\r\n\r\nsecp256k1 configure summary\r\n===========================\r\nBuild artifacts:\r\n  library type ........................ Static\r\nOptional modules:\r\n  ECDH ................................ OFF\r\n  ECDSA pubkey recovery ............... ON\r\n  extrakeys ........................... ON\r\n  schnorrsig .......................... ON\r\n  musig ............................... ON\r\n  ElligatorSwift ...................... ON\r\nParameters:\r\n  ecmult window size .................. 15\r\n  ecmult gen table size ............... 86 KiB\r\nOptional features:\r\n  assembly ............................ x86_64\r\n  external callbacks .................. OFF\r\nOptional binaries:\r\n  benchmark ........................... OFF\r\n  noverify_tests ...................... ON\r\n  tests ............................... ON\r\n  exhaustive tests .................... ON\r\n  ctime_tests ......................... OFF\r\n  examples ............................ OFF\r\n\r\nCross compiling ....................... FALSE\r\nAPI visibility attributes ............. ON\r\nValgrind .............................. OFF\r\nPreprocessor defined macros ........... ECMULT_WINDOW_SIZE=15 COMB_BLOCKS=43 COMB_TEETH=6 USE_ASM_X86_64=1\r\nC compiler ............................ Clang 19.1.7, /etc/profiles/per-user/will/bin/cc\r\nCFLAGS ................................\r\nCompile options ....................... -Wall -pedantic -Wcast-align -Wconditional-uninitialized -Wextra -Wnested-externs -Wno-long-long -Wno-overlength-strings -Wno-unused-function -Wreserved-identifier -Wshadow -Wstrict-prototypes -Wundef\r\nBuild type:\r\n - CMAKE_BUILD_TYPE ................... RelWithDebInfo\r\n - CFLAGS ............................. -O2 -g\r\n - LDFLAGS for executables ............\r\n - LDFLAGS for shared libraries .......\r\n\r\n\r\n\r\nConfigure summary\r\n=================\r\nExecutables:\r\n  bitcoin ............................. ON\r\n  bitcoind ............................ ON\r\n  bitcoin-node (multiprocess) ......... OFF\r\n  bitcoin-qt (GUI) .................... OFF\r\n  bitcoin-gui (GUI, multiprocess) ..... OFF\r\n  bitcoin-cli ......................... ON\r\n  bitcoin-tx .......................... ON\r\n  bitcoin-util ........................ ON\r\n  bitcoin-wallet ...................... ON\r\n  bitcoin-chainstate (experimental) ... OFF\r\n  libbitcoinkernel (experimental) ..... OFF\r\nOptional features:\r\n  wallet support ...................... ON\r\n  external signer ..................... ON\r\n  ZeroMQ .............................. OFF\r\n  IPC ................................. OFF\r\n  USDT tracing ........................ OFF\r\n  QR code (GUI) ....................... OFF\r\n  DBus (GUI) .......................... OFF\r\nTests:\r\n  test_bitcoin ........................ ON\r\n  test_bitcoin-qt ..................... OFF\r\n  bench_bitcoin ....................... OFF\r\n  fuzz binary ......................... OFF\r\n\r\nCross compiling ....................... FALSE\r\nC++ compiler .......................... Clang 19.1.7, /etc/profiles/per-user/will/bin/c++\r\nCMAKE_BUILD_TYPE ...................... RelWithDebInfo\r\nPreprocessor defined macros ...........\r\nC++ compiler flags .................... -O2 -g -std=c++20 -fPIC -fdebug-prefix-map=/home/will/src/core/bitcoin/src=. -fmacro-prefix-map=/home/will/src/core/bitcoin/src=. -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=3 -Wstack-protector -fstack-protector-all -fcf-protection=full -fstack-clash-protection -Wall -Wextra -Wgnu -Wformat -Wformat-security -Wvla -Wshadow-field -Wthread-safety -Wloop-analysis -Wredundant-decls -Wunused-member-function -Wdate-time -Wconditional-uninitialized -Woverloaded-virtual -Wsuggest-override -Wimplicit-fallthrough -Wunreachable-code -Wdocumentation -Wself-assign -Wundef -Wno-unused-parameter\r\nLinker flags .......................... -O2 -g -fstack-protector-all -fcf-protection=full -fstack-clash-protection -Wl,-z,relro -Wl,-z,now -Wl,-z,separate-code -fPIE -pie\r\n\r\nNOTE: The summary above may not exactly match the final applied build flags\r\n      if any additional CMAKE_* or environment variables have been modified.\r\n      To see the exact flags applied, build with the --verbose option.\r\n\r\nTreat compiler warnings as errors ..... OFF\r\nUse ccache for compiling .............. ON\r\n\r\n\r\n-- Configuring done (15.7s)\r\n-- Generating done (0.0s)\r\n-- Build files have been written to: /home/will/src/core/bitcoin/build\r\n[566/566] Linking CXX executable bin/test_bitcoin\r\nTemporary test directory at /tmp/test_runner_‚Çø_üèÉ_20250806_151617\r\nTraceback (most recent call last):\r\n  File \"/home/will/src/core/bitcoin/./build/test/functional/test_runner.py\", line 931, in <module>\r\n    main()\r\n    ~~~~^^\r\n  File \"/home/will/src/core/bitcoin/./build/test/functional/test_runner.py\", line 521, in main\r\n    bench_list = subprocess.check_output(bench_cmd).decode(\"ascii\").splitlines()\r\n                 ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^\r\n  File \"/nix/store/2mab9iiwhcqwk75qwvp3zv0bvbiaq6cs-python3-3.13.3/lib/python3.13/subprocess.py\", line 472, in check_output\r\n    return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,\r\n           ~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n               **kwargs).stdout\r\n               ^^^^^^^^^\r\n  File \"/nix/store/2mab9iiwhcqwk75qwvp3zv0bvbiaq6cs-python3-3.13.3/lib/python3.13/subprocess.py\", line 554, in run\r\n    with Popen(*popenargs, **kwargs) as process:\r\n         ~~~~~^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/nix/store/2mab9iiwhcqwk75qwvp3zv0bvbiaq6cs-python3-3.13.3/lib/python3.13/subprocess.py\", line 1039, in __init__\r\n    self._execute_child(args, executable, preexec_fn, close_fds,\r\n    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n                        pass_fds, cwd, env,\r\n                        ^^^^^^^^^^^^^^^^^^^\r\n    ...<5 lines>...\r\n                        gid, gids, uid, umask,\r\n                        ^^^^^^^^^^^^^^^^^^^^^^\r\n                        start_new_session, process_group)\r\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/nix/store/2mab9iiwhcqwk75qwvp3zv0bvbiaq6cs-python3-3.13.3/lib/python3.13/subprocess.py\", line 1854, in _execute_child\r\n    self._posix_spawn(args, executable, env, restore_signals, close_fds,\r\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n                      p2cread, p2cwrite,\r\n                      ^^^^^^^^^^^^^^^^^^\r\n                      c2pread, c2pwrite,\r\n                      ^^^^^^^^^^^^^^^^^^\r\n                      errread, errwrite)\r\n                      ^^^^^^^^^^^^^^^^^^\r\n  File \"/nix/store/2mab9iiwhcqwk75qwvp3zv0bvbiaq6cs-python3-3.13.3/lib/python3.13/subprocess.py\", line 1798, in _posix_spawn\r\n    self.pid = os.posix_spawn(executable, args, env, **kwargs)\r\n               ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nFileNotFoundError: [Errno 2] No such file or directory: '/home/will/src/core/bitcoin/build/bin/bench_bitcoin'\r\n\r\n  ```",
          "created_at": "2025-08-06T14:17:45Z"
        },
        {
          "user": "maflcko",
          "body": "> bench_bitcoin ....................... OFF\r\n\r\nthx, fixed",
          "created_at": "2025-08-06T15:03:33Z"
        },
        {
          "user": "l0rinc",
          "body": "Concept ACK, thanks for fixing this!",
          "created_at": "2025-09-05T17:40:34Z"
        },
        {
          "user": "purpleKarrot",
          "body": "Concept NACK. I think this development goes into the wrong direction. \r\n\r\n> * With sanitizers enabled, it is one of the slowest targets, often taking several minutes.\r\n\r\nThe test could be sharded to allow better parallelization. (Nit: \"target\" is the wrong terminology here)\r\n\r\n> * There is no insight from ctest into how long each individual sanity check takes.\r\n\r\nCTest can provide much more detailed statistics, with duration, memory usage and custom measurements. It just needs to be configured properly.\r\n\r\n> * Places that can't use ctest (like the Windows-cross CI task) have to explicitly run it, or risk forgetting to run it.\r\n\r\nWhy can't CTest be used in the Windows-cross CI task? That should be fixed.\r\n\r\n> * All benchmarks are run sequentially, when they could run in parallel instead.\r\n\r\nAgree. But this is possible with CTest.\r\n\r\n> Both issues can lead to CI timeouts and leave CPU unused during testing.\r\n\r\nCTest can schedule tests depending on their resource usage.\r\n\r\n> Fix all issues by running it as part of the functional tests instead.\r\n\r\nInstead of migrating away from CTest, we should fully embrace i.",
          "created_at": "2025-09-25T15:44:29Z"
        },
        {
          "user": "maflcko",
          "body": "> Why can't CTest be used in the Windows-cross CI task? That should be fixed.\r\n\r\nIt is documented right in the file: `        # Can't use ctest here like other jobs as we don't have a CMake build tree.`\r\n\r\nNo one is anyone holding back from fixing that, but personally I don't think it is possible, or only possible with massive code and maintenance overhead. Edit: In any case, the fix for that is ideally done in a separate pull independently, not here, as the issue exists on master.\r\n\r\n> Instead of migrating away from CTest, we should fully embrace i.\r\n\r\nIf you want to implement all of this in CTest, please go for it. However, I don't think the functional test framework is going to be removed any time soon. It is well understood and tested. Also, the diff here is mostly move-only and the remaining python logic is trivial.\r\n\r\nI won't mind if someone is re-writing the Python code to Cmake code, but I think blocking an improvement based on the language used seems a bit subjective.",
          "created_at": "2025-09-25T15:59:40Z"
        },
        {
          "user": "willcl-ark",
          "body": "I have had a play with porting this to cmake-native (ctest) code, and IMO the main difference is that (in my implementation) it just that it feels more obscure to collect the benchmarks, cost them (not implemented in this PR), and run them in parallel using cmake files vs a few lines of python.\r\n\r\nPerhaps I'm doing it wrong, but I found I needed a whole new target `generate_bench_tests` to dynamically parse benchmark names _after_ bitcoin_bench was built, which can then create the necessary `ctest` file, which can then be run in \"true parallel\" by `ctest`.\r\n\r\nWe already have a parallel test runner which as @maflcko says is unlikely to go away soon, so it seems easier to me to just run from there.\r\n\r\nAre there any tangible benefits we are missing from doing it this way, other than \"not being ctest-native\"?",
          "created_at": "2025-09-26T09:27:00Z"
        },
        {
          "user": "maflcko",
          "body": "> Perhaps I'm doing it wrong, but I found I needed a whole new target `generate_bench_tests` to dynamically parse benchmark names _after_ bitcoin_bench was built, which can then create the necessary `ctest` file, which can then be run in \"true parallel\" by `ctest`.\r\n\r\nYes, it is possible (and thanks for trying), see also https://habla.news/u/purplekarrot.net/cmake-and-test-suites. However,\r\n\r\n* it requires more code, and the review for it.\r\n* the win-cross issue is pre-existing and even if the cmake tree was copied, the paths would have to adjusted. A suggested fix for a pre-existing issue is best put in a separate pull, not mixed with other changes.\r\n* i am not going to re-write the functional test framework to cmake, as it is pre-existing. A suggested rewrite is best put in a separate pull or issue, not mixed with other changes.",
          "created_at": "2025-09-26T09:46:52Z"
        },
        {
          "user": "willcl-ark",
          "body": "Ah interesting, that is quite similar in the end to my \"workaround\" (of building first, then a `generate_bench_tests` target).\r\n\r\nI am Concept ACK using the python framework then, in the absence of any other benefits.",
          "created_at": "2025-09-26T13:35:27Z"
        },
        {
          "user": "purpleKarrot",
          "body": "Please see https://github.com/bitcoin/bitcoin/pull/33483 for dynamic test discovery.",
          "created_at": "2025-09-26T17:30:53Z"
        },
        {
          "user": "maflcko",
          "body": "rebased after https://github.com/bitcoin/bitcoin/pull/33313 (queue refactor)",
          "created_at": "2025-09-29T12:12:04Z"
        },
        {
          "user": "l0rinc",
          "body": "@maflcko, @purpleKarrot, can you help reviewers understand the relation between this and https://github.com/bitcoin/bitcoin/pull/33483?\r\nAre the two mutually exclusive or is this a temporary optimization until the other one lands (which would make this obsolete)?",
          "created_at": "2025-12-19T13:00:11Z"
        },
        {
          "user": "maflcko",
          "body": "> @maflcko, @purpleKarrot, can you help reviewers understand the relation between this and #33483?\r\n\r\nIt is basically the same thing, just written in different languages. I don't really care about the language it is written in. Though, I don't think anyone is going to review the other pull, which  looks unmaintained? https://github.com/bitcoin/bitcoin/pull/33483#issuecomment-3559735371",
          "created_at": "2025-12-19T13:04:57Z"
        },
        {
          "user": "maflcko",
          "body": "Given that this pull request has been maintained for almost half a year, with the goal of fixing all the annoying QA issues listed in the pull description, my recommendation would be to go ahead and review this one, merge  it, and possibly revert it in https://github.com/bitcoin/bitcoin/pull/33483, if and when that is ready. The review, testing, and revert should be not too hard.\r\n\r\nFor testing notes (since someone asked privately): I think compiling once master, and once this pull request (possibly with heavy sanitizers and/or debugging enabled) should be enough. Then, check that the new approach is faster (albeit speed is just one of the QA issues to fix, and probably the least important):\r\n\r\n* on master: `ctest --test-dir ./bld-cmake --tests-regex bench_sanity_check` (obviously `-j` won't make a difference here)\r\n* on this pull (should take half the time): `./bld-cmake/test/functional/test_runner.py -j 128 tool_bench_sanity_check.py`\r\n",
          "created_at": "2025-12-26T09:48:04Z"
        },
        {
          "user": "l0rinc",
          "body": "Before (9s):\r\n```bash\r\ngit checkout master && \\\r\ncmake -B build -DCMAKE_BUILD_TYPE=Release -DBUILD_BENCH=ON && \\\r\ncmake --build build -j$(nproc) && \\\r\ntime ctest --test-dir build --tests-regex bench_sanity_check\r\n```\r\nresults in:\r\n```bash\r\nTest project /Users/lorinc/IdeaProjects/bitcoin/build\r\n    Start 7: bench_sanity_check\r\n1/1 Test #7: bench_sanity_check ...............   Passed    9.11 sec\r\n\r\n100% tests passed, 0 tests failed out of 1\r\n\r\nTotal Test time (real) =   9.11 sec\r\n```\r\n\r\n--------\r\n\r\nAfter (3s):\r\n```bash\r\ngit checkout fafb0b495235a32b7622f2d9be07ebfbb5344a05 && \\\r\ncmake -B build -DCMAKE_BUILD_TYPE=Release -DBUILD_BENCH=ON && \\\r\ncmake --build build -j$(nproc) && \\\r\ntime ./build/test/functional/test_runner.py tool_bench_sanity_check.py -j$(nproc)\r\n```\r\nresults in:\r\n```\r\nTEST                                                                             | STATUS    | DURATION\r\n\r\ntool_bench_sanity_check.py --bench=AddAndRemoveDisconnectedBlockTransactions10   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=AddAndRemoveDisconnectedBlockTransactions90   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=AddAndRemoveDisconnectedBlockTransactionsAll  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=AddrManAdd                                    | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=AddrManAddThenGood                            | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=AddrManGetAddr                                | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=AddrManSelect                                 | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=AddrManSelectByNetwork                        | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=AddrManSelectFromAlmostEmpty                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=AssembleBlock                                 | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=Base58CheckEncode                             | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=Base58Decode                                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=Base58Encode                                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=Bech32Decode                                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=Bech32Encode                                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BenchLockedPool                               | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BenchRIPEMD160                                | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BenchTimeDeprecated                           | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BenchTimeMillis                               | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BenchTimeMillisSys                            | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BenchTimeMock                                 | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BIP324_ECDH                                   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BlockAssemblerAddPackageTxns                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BlockEncodingLargeExtra                       | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BlockEncodingNoExtra                          | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BlockEncodingStdExtra                         | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BlockFilterIndexSync                          | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BlockToJsonVerboseWrite                       | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BlockToJsonVerbosity1                         | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BlockToJsonVerbosity2                         | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BlockToJsonVerbosity3                         | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=BnBExhaustion                                 | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=CCheckQueueSpeedPrevectorJob                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=CCoinsCaching                                 | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=CHACHA20_1MB                                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=CHACHA20_256BYTES                             | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=CHACHA20_64BYTES                              | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=CheckBlockIndex                               | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=CoinSelection                                 | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=ComplexMemPool                                | ‚úì Passed  | 1 s\r\ntool_bench_sanity_check.py --bench=ConnectBlockAllEcdsa                          | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=ConnectBlockAllSchnorr                        | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=ConnectBlockMixedEcdsaSchnorr                 | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=DeserializeAndCheckBlockTest                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=DeserializeBlockTest                          | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=DuplicateInputs                               | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=EllSwiftCreate                                | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=EvictionProtection0Networks250Candidates      | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=EvictionProtection1Networks250Candidates      | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=EvictionProtection2Networks250Candidates      | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=EvictionProtection3Networks050Candidates      | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=EvictionProtection3Networks100Candidates      | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=EvictionProtection3Networks250Candidates      | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=ExpandDescriptor                              | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=FastRandom_rand32                             | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=FastRandom_rand64                             | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=FastRandom_randbits                           | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=FastRandom_randbool                           | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=FastRandom_randrange100                       | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=FastRandom_randrange1000                      | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=FastRandom_randrange1000000                   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=FastRandom_stdshuffle100                      | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=FindByte                                      | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=FSCHACHA20POLY1305_1MB                        | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=FSCHACHA20POLY1305_256BYTES                   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=FSCHACHA20POLY1305_64BYTES                    | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=GCSBlockFilterGetHash                         | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=GCSFilterConstruct                            | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=GCSFilterDecode                               | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=GCSFilterDecodeSkipCheck                      | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=GCSFilterMatch                                | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=HexParse                                      | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=HexStrBench                                   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=InsecureRandom_rand32                         | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=InsecureRandom_rand64                         | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=InsecureRandom_randbits                       | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=InsecureRandom_randbool                       | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=InsecureRandom_randrange100                   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=InsecureRandom_randrange1000                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=InsecureRandom_randrange1000000               | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=InsecureRandom_stdshuffle100                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=LinearizeOptimallyPerCost                     | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=LinearizeOptimallyTotal                       | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=LoadExternalBlockFile                         | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=LogWithDebug                                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=LogWithoutDebug                               | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=LogWithoutThreadNames                         | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=LogWithoutWriteToFile                         | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=LogWithThreadNames                            | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=MemPoolAddTransactions                        | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=MemPoolAncestorsDescendants                   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=MempoolCheck                                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=MempoolCheckEphemeralSpends                   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=MempoolEviction                               | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=MerkleRoot                                    | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=MuHash                                        | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=MuHashDiv                                     | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=MuHashFinalize                                | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=MuHashMul                                     | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=MuHashPrecompute                              | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=ObfuscationBench                              | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=OrphanageEraseForBlock                        | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=OrphanageEraseForPeer                         | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=OrphanageMultiPeerEviction                    | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=OrphanageSinglePeerEviction                   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=POLY1305_1MB                                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=POLY1305_256BYTES                             | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=POLY1305_64BYTES                              | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PoolAllocator_StdUnorderedMap                 | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PoolAllocator_StdUnorderedMapWithPoolResource | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PostLinearize16TxWorstCase                    | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PostLinearize32TxWorstCase                    | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PostLinearize48TxWorstCase                    | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PostLinearize64TxWorstCase                    | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PostLinearize75TxWorstCase                    | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PostLinearize99TxWorstCase                    | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PrePadded                                     | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PrevectorClearNontrivial                      | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PrevectorClearTrivial                         | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PrevectorDeserializeNontrivial                | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PrevectorDeserializeTrivial                   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PrevectorDestructorNontrivial                 | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PrevectorDestructorTrivial                    | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PrevectorFillVectorDirectNontrivial           | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PrevectorFillVectorDirectTrivial              | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PrevectorFillVectorIndirectNontrivial         | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PrevectorFillVectorIndirectTrivial            | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PrevectorResizeNontrivial                     | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=PrevectorResizeTrivial                        | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=ReadBlockBench                                | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=ReadRawBlockBench                             | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=RegularPadded                                 | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=RollingBloom                                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=RollingBloomReset                             | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=RpcMempool                                    | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SHA1                                          | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SHA256_32b_AVX2                               | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SHA256_32b_SHANI                              | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SHA256_32b_SSE4                               | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SHA256_32b_STANDARD                           | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SHA256_AVX2                                   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SHA256_SHANI                                  | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SHA256_SSE4                                   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SHA256_STANDARD                               | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SHA256D64_1024_AVX2                           | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SHA256D64_1024_SHANI                          | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SHA256D64_1024_SSE4                           | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SHA256D64_1024_STANDARD                       | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SHA3_256_1M                                   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SHA512                                        | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SignSchnorrWithMerkleRoot                     | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SignSchnorrWithNullMerkleRoot                 | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SignTransactionECDSA                          | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SignTransactionSchnorr                        | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=SipHash_32b                                   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=Trig                                          | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=TxGraphTrim                                   | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=VerifyNestedIfScript                          | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=VerifyScriptBench                             | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=WalletAvailableCoins                          | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=WalletBalanceClean                            | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=WalletBalanceDirty                            | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=WalletBalanceMine                             | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=WalletBalanceWatch                            | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=WalletCreateEncrypted                         | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=WalletCreatePlain                             | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=WalletCreateTxUseOnlyPresetInputs             | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=WalletCreateTxUsePresetInputsAndCoinSelection | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=WalletIsMineDescriptors                       | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=WalletIsMineMigratedDescriptors               | ‚úì Passed  | 0 s\r\ntool_bench_sanity_check.py --bench=WalletLoadingDescriptors                      | ‚úì Passed  | 1 s\r\ntool_bench_sanity_check.py --bench=WalletMigration                               | ‚úì Passed  | 2 s\r\ntool_bench_sanity_check.py --bench=WriteBlockBench                               | ‚úì Passed  | 0 s\r\n\r\nALL                                                                              | ‚úì Passed  | 4 s (accumulated) \r\nRuntime: 3 s\r\n```\r\n\r\nConcept ACK - I will review the code a bit later.",
          "created_at": "2025-12-30T21:13:01Z"
        },
        {
          "user": "willcl-ark",
          "body": "Also verified the speedup:\r\n\r\nmaster:\r\n```bash\r\nsrc/core/bitcoin on ÓÇ† master [$?‚áï] via ‚ñ≥ v4.1.2 via üêç v3.13.9 via ‚ùÑÔ∏è  impure (nix-shell-env)\r\n‚ùØ ctest --test-dir ./build --tests-regex bench_sanity_check\r\nTest project /home/will/src/core/bitcoin/build\r\n    Start 7: bench_sanity_check\r\n1/1 Test #7: bench_sanity_check ...............   Passed   18.20 sec\r\n\r\n100% tests passed, 0 tests failed out of 1\r\n\r\nTotal Test time (real) =  18.21 sec\r\n```\r\n\r\nPR #33142:\r\n```bash\r\nsrc/core/bitcoin on ÓÇ† pr-33142 [$?] via ‚ñ≥ v4.1.2 via üêç v3.13.9 via ‚ùÑÔ∏è  impure (nix-shell-env) took 25s\r\n‚ùØ build/test/functional/test_runner.py -j 128 tool_bench_sanity_check.py\r\nTemporary test directory at /tmp/test_runner_‚Çø_üèÉ_20260105_135859\r\n<snip>\r\nALL                                                                              | ‚úì Passed  | 272 s (accumulated)\r\nRuntime: 8 s\r\n```",
          "created_at": "2026-01-05T14:04:09Z"
        },
        {
          "user": "achow101",
          "body": "ACK fa65bc0e79dab8a97e0e3f9f31540f1c029a2f6e\r\n\r\nMerging this, but this is not saying that this direction is set in stone. This PR gives us some immediate wins that are useful to all developers with a fairly small amount of code changed. However, rewriting everything to utilize ctest is still on the table, but that does seem like a much larger task that will take significantly longer to implement and review.",
          "created_at": "2026-01-05T23:27:19Z"
        }
      ]
    },
    {
      "number": 33141,
      "title": "test: Remove polling loop from test_runner (take 2)",
      "body": "(This picks up my prior attempt from https://github.com/bitcoin/bitcoin/pull/13384)\r\n\r\nCurrently, the test_runner is using a `time.sleep` before polling to check if any tests have completed. This is largely fine when running a few tests, or when the tests take a long time.\r\n\r\nHowever, when running many fast tests, this can accumulate and leave the CPU idle for no reason.\r\n\r\nA trivial improvement would be to only sleep when really needed:\r\n\r\n```diff\r\ndiff --git a/test/functional/test_runner.py b/test/functional/test_runner.py\r\nindex 7c8c15f391..1d9f28cee4 100755\r\n--- a/test/functional/test_runner.py\r\n+++ b/test/functional/test_runner.py\r\n@@ -747,7 +747,6 @@ class TestHandler:\r\n         dot_count = 0\r\n         while True:\r\n             # Return all procs that have finished, if any. Otherwise sleep until there is one.\r\n-            time.sleep(.5)\r\n             ret = []\r\n             for job in self.jobs:\r\n                 (name, start_time, proc, testdir, log_out, log_err) = job\r\n@@ -771,6 +770,7 @@ class TestHandler:\r\n                     ret.append((TestResult(name, status, int(time.time() - start_time)), testdir, stdout, stderr, skip_reason))\r\n             if ret:\r\n                 return ret\r\n+            time.sleep(.5)\r\n             if self.use_term_control:\r\n                 print('.', end='', flush=True)\r\n             dot_count += 1\r\n```\r\n\r\nHowever, ideally there is no sleep at all. So do that by using a `ThreadPoolExecutor`.\r\n\r\nThis can be tested via something like:\r\n\r\n```\r\ntime ./bld-cmake/test/functional/test_runner.py $(for i in {1..200}; do echo -n \"tool_rpcauth \"; done) -j 200\r\n```\r\n\r\nThe result should show:\r\n\r\n* Current `master` is the slowest\r\n* The \"sleep patch\" from above is a bit faster (1.5x improvement)\r\n* This pull request is the fastest (2x improvement)",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-08-06T07:56:32Z",
      "updated_at": "2025-09-26T10:31:25Z",
      "comments": 8,
      "url": "https://github.com/bitcoin/bitcoin/pull/33141",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33141.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [l0rinc](https://github.com/bitcoin/bitcoin/pull/33141#pullrequestreview-3186496990), [Eunovo](https://github.com/bitcoin/bitcoin/pull/33141#pullrequestreview-3199158399), [achow101](https://github.com/bitcoin/bitcoin/pull/33141#issuecomment-3282443734) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#33313](https://github.com/bitcoin/bitcoin/pull/33313) (test/refactor: use test deque to avoid quadratic iteration by l0rinc)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-08-06T07:56:38Z"
        },
        {
          "user": "l0rinc",
          "body": "I ran the 3 versions you mentioned with hyperfine, 10 runs each:\r\n```python\r\nCOMMITS=\"d767503b6a2618e0c99407acf98f3bd19fb7defd 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7 35e91b899dac689b24a8a95fcef083affc695d1e\"; \\\r\nPARALLEL=200; RUNS=10; \\\r\nCC=gcc; CXX=g++; \\\r\nBUILD='Release'; \\\r\nTEST_LIST=$(python3 -c \"print('tool_rpcauth ' * $PARALLEL)\"); \\\r\n(echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done; echo \"\") && \\\r\nhyperfine \\\r\n  --sort command \\\r\n  --runs $RUNS \\\r\n  --parameter-list COMMIT ${COMMITS// /,} \\\r\n  --prepare \"git checkout {COMMIT}; git clean -fxd; git reset --hard && cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=${BUILD} && ninja -C build\" \\\r\n  \"build/test/functional/test_runner.py $TEST_LIST -j$PARALLEL\"\r\n```\r\n\r\n> d767503b6a Merge bitcoin/bitcoin#33039: refactor,test: follow-ups to multi-byte block obfuscation\r\n> 5bb380ec87 test: sleep patch\r\n> 35e91b899d test: Remove polling loop from test_runner\r\n\r\n<details>\r\n<summary>runs</summary>\r\n\r\n```bash\r\nBenchmark 1: ./build/test/functional/test_runner.py tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth too\r\nl_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_r\r\npcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpca\r\nuth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth  -j200 (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n  Time (mean ¬± œÉ):      7.233 s ¬±  0.057 s    [User: 41.885 s, System: 4.270 s]\r\n  Range (min ‚Ä¶ max):    7.085 s ‚Ä¶  7.286 s    10 runs\r\n\r\nBenchmark 2: ./build/test/functional/test_runner.py tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth too\r\nl_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_r\r\npcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpca\r\nuth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth  -j200 (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n  Time (mean ¬± œÉ):      3.827 s ¬±  0.127 s    [User: 41.717 s, System: 4.300 s]\r\n  Range (min ‚Ä¶ max):    3.726 s ‚Ä¶  4.174 s    10 runs\r\n\r\nBenchmark 3: ./build/test/functional/test_runner.py tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth too\r\nl_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_r\r\npcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpca\r\nuth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth  -j200 (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n  Time (mean ¬± œÉ):      3.696 s ¬±  0.026 s    [User: 41.489 s, System: 4.324 s]\r\n  Range (min ‚Ä¶ max):    3.681 s ‚Ä¶  3.768 s    10 runs\r\n```\r\n\r\n</details>\r\n\r\nAnd I'm getting slightly different results than you:\r\n```python\r\nRelative speed comparison\r\n    1.96 ¬±  0.02  ./build/test/functional/test_runner.py tool_rpcauth [...] tool_rpcauth -j200 (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n    1.04 ¬±  0.04  ./build/test/functional/test_runner.py tool_rpcauth [...] tool_rpcauth -j200 (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n    1.00          ./build/test/functional/test_runner.py tool_rpcauth [...] tool_rpcauth -j200 (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n```\r\n\r\nTried a few different combinations:\r\n\r\n<details>\r\n<summary>gcc with debug (3 runs)</summary>\r\n\r\n```\r\nCOMMITS=\"d767503b6a2618e0c99407acf98f3bd19fb7defd 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7 35e91b899dac689b24a8a95fcef083affc695d1e\"; \\\r\nPARALLEL=200; RUNS=3; \\\r\nCC=gcc; CXX=g++; \\\r\nBUILD='Debug'; \\\r\nTEST_LIST=$(python3 -c \"print('tool_rpcauth ' * $PARALLEL)\"); \\\r\n(echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done; echo \"\") && \\\r\nhyperfine \\\r\n  --sort command \\\r\n  --runs $RUNS \\\r\n  --parameter-list COMMIT ${COMMITS// /,} \\\r\n  --prepare \"git checkout {COMMIT}; git clean -fxd; git reset --hard && cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=${BUILD} && ninja -C build\" \\\r\n  \"./build/test/functional/test_runner.py $TEST_LIST -j$PARALLEL\"\r\n\r\nd767503b6a Merge bitcoin/bitcoin#33039: refactor,test: follow-ups to multi-byte block obfuscation\r\n5bb380ec87 test: sleep patch\r\n35e91b899d test: Remove polling loop from test_runner\r\n\r\nBenchmark 1: ./build/test/functional/test_runner.py tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth  -j200 (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n  Time (mean ¬± œÉ):      7.716 s ¬±  0.013 s    [User: 42.081 s, System: 4.335 s]\r\n  Range (min ‚Ä¶ max):    7.704 s ‚Ä¶  7.731 s    3 runs\r\n\r\nBenchmark 2: ./build/test/functional/test_runner.py tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth  -j200 (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n  Time (mean ¬± œÉ):      4.301 s ¬±  0.034 s    [User: 42.486 s, System: 4.310 s]\r\n  Range (min ‚Ä¶ max):    4.263 s ‚Ä¶  4.328 s    3 runs\r\n\r\nBenchmark 3: ./build/test/functional/test_runner.py tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth  -j200 (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n  Time (mean ¬± œÉ):      4.169 s ¬±  0.028 s    [User: 41.859 s, System: 4.345 s]\r\n  Range (min ‚Ä¶ max):    4.140 s ‚Ä¶  4.195 s    3 runs\r\n\r\nRelative speed comparison\r\n        1.85 ¬±  0.01  ./build/test/functional/test_runner.py tool_rpcauth [...] tool_rpcauth  -j200 (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n        1.03 ¬±  0.01  ./build/test/functional/test_runner.py tool_rpcauth [...] tool_rpcauth  -j200 (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n        1.00          ./build/test/functional/test_runner.py tool_rpcauth [...] tool_rpcauth  -j200 (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n```\r\n\r\n\r\n\r\n</details>\r\n\r\n<details>\r\n<summary>clang with release (10 runs, different machine)</summary>\r\n\r\n```\r\nCOMMITS=\"d767503b6a2618e0c99407acf98f3bd19fb7defd 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7 35e91b899dac689b24a8a95fcef083affc695d1e\"; \\\r\nPARALLEL=200; RUNS=10; \\\r\nCC=clang; CXX=clang++;\r\nBUILD='Release'; \\\r\nTEST_LIST=$(python3 -c \"print('tool_rpcauth ' * $PARALLEL)\"); \\\r\n(echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done; echo \"\") && \\\r\nhyperfine \\\r\n  --sort command \\\r\n  --runs $RUNS \\\r\n  --parameter-list COMMIT ${COMMITS// /,} \\\r\n  --prepare \"git checkout {COMMIT}; git clean -fxd; git reset --hard && cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=${BUILD} && ninja -C build\" \\\r\n  \"build/test/functional/test_runner.py $TEST_LIST -j$PARALLEL\"\r\n\r\nd767503b6a Merge bitcoin/bitcoin#33039: refactor,test: follow-ups to multi-byte block obfuscation\r\n5bb380ec87 test: sleep patch\r\n35e91b899d test: Remove polling loop from test_runner\r\n\r\nBenchmark 1: ./build/test/functional/test_runner.py tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth  -j200 (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n  Time (mean ¬± œÉ):      9.829 s ¬±  0.183 s    [User: 38.943 s, System: 4.407 s]\r\n  Range (min ‚Ä¶ max):    9.694 s ‚Ä¶ 10.320 s    10 runs\r\n\r\nBenchmark 2: ./build/test/functional/test_runner.py tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth  -j200 (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n  Time (mean ¬± œÉ):      7.063 s ¬±  0.193 s    [User: 38.883 s, System: 4.408 s]\r\n  Range (min ‚Ä¶ max):    6.796 s ‚Ä¶  7.267 s    10 runs\r\n\r\nBenchmark 3: ./build/test/functional/test_runner.py tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth tool_rpcauth  -j200 (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n  Time (mean ¬± œÉ):      6.904 s ¬±  0.213 s    [User: 38.949 s, System: 4.386 s]\r\n  Range (min ‚Ä¶ max):    6.649 s ‚Ä¶  7.267 s    10 runs\r\n\r\nRelative speed comparison\r\n        1.42 ¬±  0.05  ./build/test/functional/test_runner.py [...] tool_rpcauth  -j200 (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n        1.02 ¬±  0.04  ./build/test/functional/test_runner.py [...] tool_rpcauth tool_rpcauth  -j200 (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n        1.00          ./build/test/functional/test_runner.py [...] tool_rpcauth tool_rpcauth  -j200 (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n```\r\n\r\n</details>\r\n\r\nSo this is obviously faster for many tiny tests, will run the same for the full test suite and do a full code review later.\r\nConcept ACK",
          "created_at": "2025-08-07T03:59:27Z"
        },
        {
          "user": "maflcko",
          "body": "> So this is obviously faster for many tiny tests, will run the same for the full test suite and do a full code review later.\r\n\r\nNice. Thanks for testing and confirming that the code without any sleep is the fastest of the 3 versions. I think benchmarking the full test suite may be difficult, because it has internal noise higher than the savings here. At least back in https://github.com/bitcoin/bitcoin/pull/13384#issuecomment-394335449, it was hard to measure, but maybe there is less noise now and this can be measured now.",
          "created_at": "2025-08-07T06:29:24Z"
        },
        {
          "user": "l0rinc",
          "body": "> it has internal noise higher than the savings here\r\n\r\nSure, but I'm just running them a lot of times, the trends are obvious this way.\r\n\r\n> will run the same for the full test suite\r\n\r\nI have measured running the tests with the 3 setups with 1-6x the nproc for parallelism.\r\nThe 3 solutions all scale well beyond the number of cpus (I'm now running the same until 8x on a different platform to confirm the findings).\r\n\r\n<details>\r\n<summary>Details</summary>\r\n\r\n```\r\nCOMMITS=\"d767503b6a2618e0c99407acf98f3bd19fb7defd 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7 35e91b899dac689b24a8a95fcef083affc695d1e\"; \\\r\nRUNS=3; \\\r\nCC=gcc; CXX=g++; \\\r\nBUILD='Release'; \\\r\n(echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done; echo \"\") && \\\r\nhyperfine \\\r\n  --sort command \\\r\n  --runs $RUNS \\\r\n  --parameter-list COMMIT ${COMMITS// /,} \\\r\n  --parameter-list FACTOR $(seq -s, 1 6) \\\r\n  --prepare \"git checkout {COMMIT}; git clean -fxd; git reset --hard &&  cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=${BUILD} && ninja -C build \" \\\r\n  \"build/test/functional/test_runner.py -j\\$(({FACTOR} * $(nproc))) || true\"\r\n\r\nd767503b6a Merge bitcoin/bitcoin#33039: refactor,test: follow-ups to multi-byte block obfuscation\r\n5bb380ec87 test: sleep patch\r\n35e91b899d test: Remove polling loop from test_runner\r\n\r\nBenchmark 1: build/test/functional/test_runner.py -j$((1 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n  Time (mean ¬± œÉ):     161.044 s ¬± 14.549 s    [User: 727.494 s, System: 95.580 s]\r\n  Range (min ‚Ä¶ max):   151.727 s ‚Ä¶ 177.809 s    3 runs\r\n \r\nBenchmark 2: build/test/functional/test_runner.py -j$((1 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n  Time (mean ¬± œÉ):     162.738 s ¬±  4.422 s    [User: 745.107 s, System: 95.168 s]\r\n  Range (min ‚Ä¶ max):   157.762 s ‚Ä¶ 166.217 s    3 runs\r\n \r\nBenchmark 3: build/test/functional/test_runner.py -j$((1 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n  Time (mean ¬± œÉ):     164.559 s ¬±  2.955 s    [User: 740.193 s, System: 96.168 s]\r\n  Range (min ‚Ä¶ max):   161.401 s ‚Ä¶ 167.256 s    3 runs\r\n \r\nBenchmark 4: build/test/functional/test_runner.py -j$((2 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n  Time (mean ¬± œÉ):     123.475 s ¬±  0.815 s    [User: 881.995 s, System: 112.519 s]\r\n  Range (min ‚Ä¶ max):   122.815 s ‚Ä¶ 124.385 s    3 runs\r\n \r\nBenchmark 5: build/test/functional/test_runner.py -j$((2 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n  Time (mean ¬± œÉ):     123.129 s ¬±  2.608 s    [User: 881.362 s, System: 112.607 s]\r\n  Range (min ‚Ä¶ max):   121.520 s ‚Ä¶ 126.137 s    3 runs\r\n \r\n  Warning: Statistical outliers were detected. Consider re-running this benchmark on a quiet system without any interferences from other programs. It might help to use the '--warmup' or '--prepare' options.\r\n \r\nBenchmark 6: build/test/functional/test_runner.py -j$((2 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n  Time (mean ¬± œÉ):     122.078 s ¬±  0.827 s    [User: 857.404 s, System: 113.242 s]\r\n  Range (min ‚Ä¶ max):   121.211 s ‚Ä¶ 122.858 s    3 runs\r\n \r\nBenchmark 7: build/test/functional/test_runner.py -j$((3 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n  Time (mean ¬± œÉ):     111.159 s ¬±  1.883 s    [User: 900.148 s, System: 123.057 s]\r\n  Range (min ‚Ä¶ max):   109.349 s ‚Ä¶ 113.108 s    3 runs\r\n \r\nBenchmark 8: build/test/functional/test_runner.py -j$((3 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n  Time (mean ¬± œÉ):     110.060 s ¬±  0.637 s    [User: 909.104 s, System: 123.203 s]\r\n  Range (min ‚Ä¶ max):   109.374 s ‚Ä¶ 110.634 s    3 runs\r\n \r\nBenchmark 9: build/test/functional/test_runner.py -j$((3 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n  Time (mean ¬± œÉ):     107.698 s ¬±  0.202 s    [User: 908.138 s, System: 123.326 s]\r\n  Range (min ‚Ä¶ max):   107.530 s ‚Ä¶ 107.922 s    3 runs\r\n \r\nBenchmark 10: build/test/functional/test_runner.py -j$((4 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n  Time (mean ¬± œÉ):     99.439 s ¬±  0.353 s    [User: 876.245 s, System: 123.568 s]\r\n  Range (min ‚Ä¶ max):   99.055 s ‚Ä¶ 99.750 s    3 runs\r\n \r\nBenchmark 11: build/test/functional/test_runner.py -j$((4 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n  Time (mean ¬± œÉ):     100.665 s ¬±  0.930 s    [User: 878.436 s, System: 123.433 s]\r\n  Range (min ‚Ä¶ max):   99.654 s ‚Ä¶ 101.483 s    3 runs\r\n \r\nBenchmark 12: build/test/functional/test_runner.py -j$((4 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n  Time (mean ¬± œÉ):     98.818 s ¬±  0.490 s    [User: 891.573 s, System: 122.992 s]\r\n  Range (min ‚Ä¶ max):   98.278 s ‚Ä¶ 99.234 s    3 runs\r\n \r\nBenchmark 13: build/test/functional/test_runner.py -j$((5 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n  Time (mean ¬± œÉ):     96.018 s ¬±  1.705 s    [User: 847.227 s, System: 123.800 s]\r\n  Range (min ‚Ä¶ max):   95.008 s ‚Ä¶ 97.986 s    3 runs\r\n \r\n  Warning: The first benchmarking run for this command was significantly slower than the rest (97.986 s). This could be caused by (filesystem) caches that were not filled until after the first run. You are already using the '--prepare' option which can be used to clear caches. If you did not use a cache-clearing command with '--prepare', you can either try that or consider using the '--warmup' option to fill those caches before the actual benchmark.\r\n \r\nBenchmark 14: build/test/functional/test_runner.py -j$((5 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n  Time (mean ¬± œÉ):     97.786 s ¬±  1.161 s    [User: 854.971 s, System: 123.509 s]\r\n  Range (min ‚Ä¶ max):   96.573 s ‚Ä¶ 98.888 s    3 runs\r\n \r\nBenchmark 15: build/test/functional/test_runner.py -j$((5 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n  Time (mean ¬± œÉ):     97.968 s ¬±  1.246 s    [User: 876.036 s, System: 123.396 s]\r\n  Range (min ‚Ä¶ max):   96.862 s ‚Ä¶ 99.317 s    3 runs\r\n \r\nBenchmark 16: build/test/functional/test_runner.py -j$((6 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n  Time (mean ¬± œÉ):     97.557 s ¬±  0.795 s    [User: 864.526 s, System: 124.178 s]\r\n  Range (min ‚Ä¶ max):   96.685 s ‚Ä¶ 98.242 s    3 runs\r\n \r\nBenchmark 17: build/test/functional/test_runner.py -j$((6 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n  Time (mean ¬± œÉ):     98.179 s ¬±  1.145 s    [User: 863.995 s, System: 124.434 s]\r\n  Range (min ‚Ä¶ max):   97.295 s ‚Ä¶ 99.473 s    3 runs\r\n \r\nBenchmark 18: build/test/functional/test_runner.py -j$((6 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n  Time (mean ¬± œÉ):     96.079 s ¬±  0.906 s    [User: 857.862 s, System: 124.003 s]\r\n  Range (min ‚Ä¶ max):   95.159 s ‚Ä¶ 96.970 s    3 runs\r\n \r\nRelative speed comparison\r\n        1.68 ¬±  0.15  build/test/functional/test_runner.py -j$((1 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n        1.69 ¬±  0.06  build/test/functional/test_runner.py -j$((1 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n        1.71 ¬±  0.04  build/test/functional/test_runner.py -j$((1 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n        1.29 ¬±  0.02  build/test/functional/test_runner.py -j$((2 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n        1.28 ¬±  0.04  build/test/functional/test_runner.py -j$((2 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n        1.27 ¬±  0.02  build/test/functional/test_runner.py -j$((2 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n        1.16 ¬±  0.03  build/test/functional/test_runner.py -j$((3 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n        1.15 ¬±  0.02  build/test/functional/test_runner.py -j$((3 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n        1.12 ¬±  0.02  build/test/functional/test_runner.py -j$((3 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n        1.04 ¬±  0.02  build/test/functional/test_runner.py -j$((4 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n        1.05 ¬±  0.02  build/test/functional/test_runner.py -j$((4 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n        1.03 ¬±  0.02  build/test/functional/test_runner.py -j$((4 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n        1.00          build/test/functional/test_runner.py -j$((5 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n        1.02 ¬±  0.02  build/test/functional/test_runner.py -j$((5 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n        1.02 ¬±  0.02  build/test/functional/test_runner.py -j$((5 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n        1.02 ¬±  0.02  build/test/functional/test_runner.py -j$((6 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n        1.02 ¬±  0.02  build/test/functional/test_runner.py -j$((6 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n        1.00 ¬±  0.02  build/test/functional/test_runner.py -j$((6 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n```\r\n\r\n</details>\r\n\r\n<img width=\"1000\" alt=\"image\" src=\"https://github.com/user-attachments/assets/baf5da85-751f-4bf5-bc28-629eadc3b0a1\" />\r\n\r\nWhich indicates to me that the new solution scales a bit better - but since we haven't even hit the bottom yet (surprisingly), I'll post those in a follow-up.\r\n",
          "created_at": "2025-08-07T16:56:16Z"
        },
        {
          "user": "maflcko",
          "body": "> Which indicates to me that the new solution scales a bit better - but since we haven't even hit the bottom yet (surprisingly), I'll post those in a follow-up.\r\n\r\nThanks for the benchmarks, but honestly, I can't see that the new solution scales better. You only did 3 runs for each point, and the error bars overlap with the other points each time. Also the hyperfine output has warnings about outliers. I guess you'd have to run at least 100 times for each data point (not saying you should :sweat_smile:, I am happy with the  previous benchmarks already).\r\n\r\nAlso, I am thinking you are already saturated at 100 seconds, because the slowest test likely takes this amount of time. No amount of parallelism can make it faster.",
          "created_at": "2025-08-07T17:09:52Z"
        },
        {
          "user": "l0rinc",
          "body": "Redid only 1-4x, with 20 runs for stability to see if these speedups apply to our test suite as well.\r\n\r\nRunning it on a more powerful i9 with SSD:\r\n<img width=\"1200\" alt=\"image\" src=\"https://github.com/user-attachments/assets/0f6baa59-2b6a-4981-a739-1b08b1093eaf\" />\r\n\r\n<details>\r\n<summary>Details</summary>\r\n\r\n```\r\nd767503b6a Merge bitcoin/bitcoin#33039: refactor,test: follow-ups to multi-byte block obfuscation\r\n5bb380ec87 test: sleep patch\r\n35e91b899d test: Remove polling loop from test_runner\r\n\r\nBenchmark 1: build/test/functional/test_runner.py -j$((1 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n  Time (mean ¬± œÉ):     162.617 s ¬±  4.057 s    [User: 742.563 s, System: 95.831 s]\r\n  Range (min ‚Ä¶ max):   153.539 s ‚Ä¶ 169.594 s    20 runs\r\n \r\nBenchmark 2: build/test/functional/test_runner.py -j$((1 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n  Time (mean ¬± œÉ):     166.120 s ¬±  1.751 s    [User: 746.994 s, System: 95.786 s]\r\n  Range (min ‚Ä¶ max):   162.345 s ‚Ä¶ 170.193 s    20 runs\r\n \r\nBenchmark 3: build/test/functional/test_runner.py -j$((1 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n  Time (mean ¬± œÉ):     165.285 s ¬±  1.679 s    [User: 743.584 s, System: 96.084 s]\r\n  Range (min ‚Ä¶ max):   162.273 s ‚Ä¶ 168.493 s    20 runs\r\n \r\nBenchmark 4: build/test/functional/test_runner.py -j$((2 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n  Time (mean ¬± œÉ):     123.485 s ¬±  1.311 s    [User: 861.322 s, System: 112.273 s]\r\n  Range (min ‚Ä¶ max):   121.381 s ‚Ä¶ 125.718 s    20 runs\r\n \r\nBenchmark 5: build/test/functional/test_runner.py -j$((2 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n  Time (mean ¬± œÉ):     123.578 s ¬±  1.149 s    [User: 865.509 s, System: 112.239 s]\r\n  Range (min ‚Ä¶ max):   121.861 s ‚Ä¶ 126.296 s    20 runs\r\n \r\nBenchmark 6: build/test/functional/test_runner.py -j$((2 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n  Time (mean ¬± œÉ):     122.229 s ¬±  1.581 s    [User: 867.603 s, System: 112.883 s]\r\n  Range (min ‚Ä¶ max):   119.546 s ‚Ä¶ 124.407 s    20 runs\r\n \r\nBenchmark 7: build/test/functional/test_runner.py -j$((3 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n  Time (mean ¬± œÉ):     110.005 s ¬±  1.110 s    [User: 904.411 s, System: 122.869 s]\r\n  Range (min ‚Ä¶ max):   108.654 s ‚Ä¶ 111.472 s    20 runs\r\n \r\nBenchmark 8: build/test/functional/test_runner.py -j$((3 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n  Time (mean ¬± œÉ):     111.199 s ¬±  1.291 s    [User: 902.330 s, System: 122.718 s]\r\n  Range (min ‚Ä¶ max):   108.685 s ‚Ä¶ 114.161 s    20 runs\r\n \r\nBenchmark 9: build/test/functional/test_runner.py -j$((3 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n  Time (mean ¬± œÉ):     109.771 s ¬±  1.615 s    [User: 897.538 s, System: 122.906 s]\r\n  Range (min ‚Ä¶ max):   107.295 s ‚Ä¶ 113.223 s    20 runs\r\n \r\nBenchmark 10: build/test/functional/test_runner.py -j$((4 * 16)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n  Time (mean ¬± œÉ):     100.538 s ¬±  1.568 s    [User: 890.148 s, System: 123.298 s]\r\n  Range (min ‚Ä¶ max):   97.325 s ‚Ä¶ 103.165 s    20 runs\r\n \r\nBenchmark 11: build/test/functional/test_runner.py -j$((4 * 16)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n  Time (mean ¬± œÉ):     100.561 s ¬±  1.307 s    [User: 881.061 s, System: 123.444 s]\r\n  Range (min ‚Ä¶ max):   98.469 s ‚Ä¶ 103.547 s    20 runs\r\n \r\nBenchmark 12: build/test/functional/test_runner.py -j$((4 * 16)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n  Time (mean ¬± œÉ):     100.220 s ¬±  1.769 s    [User: 876.089 s, System: 123.136 s]\r\n  Range (min ‚Ä¶ max):   97.393 s ‚Ä¶ 103.823 s    20 runs\r\n  ```\r\n\r\n</details>\r\n\r\nAnd on a slowe2 i7 with HDD:\r\n<img width=\"1200\"  alt=\"image\" src=\"https://github.com/user-attachments/assets/f3f219d5-afa5-4850-8361-540ea6d100ba\" />\r\n\r\n<details>\r\n<summary>Details</summary>\r\n\r\n```\r\nCOMMITS=\"d767503b6a2618e0c99407acf98f3bd19fb7defd 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7 35e91b899dac689b24a8a95fcef083affc695d1e\"; RUNS=20; CC=gcc; CXX=g++; BUILD='Release'; (echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done; echo \"\") && hyperfine   --sor\r\nt command   --runs $RUNS   --parameter-list COMMIT ${COMMITS// /,}   --parameter-list FACTOR $(seq -s, 1 4)   --prepare \"git checkout {COMMIT}; git clean -fxd; git reset --hard &&  cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=${BUILD} && ninja -C build \"   \"build/test/functional/test_runner.py -j\\$(({FACTOR} * $(nproc))) || true\"                                           \r\n                                                                                                                                                                                                                                                                                                                                                                                    \r\nd767503b6a Merge bitcoin/bitcoin#33039: refactor,test: follow-ups to multi-byte block obfuscation                                                                                                                                                                                                                                                                                   \r\n5bb380ec87 test: sleep patch                                                                 \r\n35e91b899d test: Remove polling loop from test_runner                                        \r\n\r\nBenchmark 1: build/test/functional/test_runner.py -j$((1 * 8)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)                                                                \r\n  Time (mean ¬± œÉ):     536.561 s ¬± 10.213 s    [User: 741.217 s, System: 100.037 s]          \r\n  Range (min ‚Ä¶ max):   518.267 s ‚Ä¶ 556.539 s    20 runs                                      \r\n                                                                                             \r\nBenchmark 2: build/test/functional/test_runner.py -j$((1 * 8)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)                                                                \r\n  Time (mean ¬± œÉ):     543.853 s ¬±  7.098 s    [User: 747.414 s, System: 100.004 s]\r\n  Range (min ‚Ä¶ max):   532.029 s ‚Ä¶ 556.266 s    20 runs\r\n                                                                                             \r\nBenchmark 3: build/test/functional/test_runner.py -j$((1 * 8)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n  Time (mean ¬± œÉ):     534.225 s ¬± 14.423 s    [User: 743.823 s, System: 100.001 s]\r\n  Range (min ‚Ä¶ max):   502.162 s ‚Ä¶ 552.954 s    20 runs\r\n                                                                                             \r\nBenchmark 4: build/test/functional/test_runner.py -j$((2 * 8)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)\r\n  Time (mean ¬± œÉ):     398.433 s ¬± 13.789 s    [User: 816.850 s, System: 108.760 s]\r\n  Range (min ‚Ä¶ max):   368.803 s ‚Ä¶ 420.022 s    20 runs\r\n                                                                                             \r\nBenchmark 5: build/test/functional/test_runner.py -j$((2 * 8)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)\r\n  Time (mean ¬± œÉ):     405.140 s ¬±  8.846 s    [User: 817.834 s, System: 109.110 s]\r\n  Range (min ‚Ä¶ max):   388.287 s ‚Ä¶ 422.856 s    20 runs\r\n                                                                                             \r\nBenchmark 6: build/test/functional/test_runner.py -j$((2 * 8)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)\r\n  Time (mean ¬± œÉ):     397.259 s ¬±  8.343 s    [User: 814.290 s, System: 108.749 s]\r\n  Range (min ‚Ä¶ max):   378.060 s ‚Ä¶ 412.245 s    20 runs\r\n                                                                                             \r\nBenchmark 7: build/test/functional/test_runner.py -j$((3 * 8)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)     \r\n  Time (mean ¬± œÉ):     351.179 s ¬±  8.515 s    [User: 855.037 s, System: 113.145 s]          \r\n  Range (min ‚Ä¶ max):   336.721 s ‚Ä¶ 368.320 s    20 runs                                      \r\n                                                                                             \r\nBenchmark 8: build/test/functional/test_runner.py -j$((3 * 8)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)                                                                \r\n  Time (mean ¬± œÉ):     350.855 s ¬±  9.233 s    [User: 862.762 s, System: 113.541 s]          \r\n  Range (min ‚Ä¶ max):   334.352 s ‚Ä¶ 366.530 s    20 runs                                      \r\n                                                                                             \r\nBenchmark 9: build/test/functional/test_runner.py -j$((3 * 8)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)                                                                \r\n  Time (mean ¬± œÉ):     357.291 s ¬±  8.876 s    [User: 854.476 s, System: 114.151 s]          \r\n  Range (min ‚Ä¶ max):   340.714 s ‚Ä¶ 369.699 s    20 runs                                      \r\n                                                                                             \r\nBenchmark 10: build/test/functional/test_runner.py -j$((4 * 8)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)                                                               \r\n  Time (mean ¬± œÉ):     338.878 s ¬±  5.938 s    [User: 881.142 s, System: 116.883 s]          \r\n  Range (min ‚Ä¶ max):   328.316 s ‚Ä¶ 348.831 s    20 runs                                      \r\n                                                                                             \r\nBenchmark 11: build/test/functional/test_runner.py -j$((4 * 8)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)                                                               \r\n  Time (mean ¬± œÉ):     330.988 s ¬±  8.537 s    [User: 889.021 s, System: 116.644 s]          \r\n  Range (min ‚Ä¶ max):   313.327 s ‚Ä¶ 344.076 s    20 runs                                      \r\n                                                                                             \r\nBenchmark 12: build/test/functional/test_runner.py -j$((4 * 8)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)                                                               \r\n  Time (mean ¬± œÉ):     324.608 s ¬±  8.837 s    [User: 875.886 s, System: 116.579 s]          \r\n  Range (min ‚Ä¶ max):   304.882 s ‚Ä¶ 341.161 s    20 runs                                      \r\n                                                                                             \r\nRelative speed comparison                                                                    \r\n        1.65 ¬±  0.05  build/test/functional/test_runner.py -j$((1 * 8)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)                                                       \r\n        1.68 ¬±  0.05  build/test/functional/test_runner.py -j$((1 * 8)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)                                                       \r\n        1.65 ¬±  0.06  build/test/functional/test_runner.py -j$((1 * 8)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)                                                       \r\n        1.23 ¬±  0.05  build/test/functional/test_runner.py -j$((2 * 8)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)                                                       \r\n        1.25 ¬±  0.04  build/test/functional/test_runner.py -j$((2 * 8)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)                                                       \r\n        1.22 ¬±  0.04  build/test/functional/test_runner.py -j$((2 * 8)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)                                                       \r\n        1.08 ¬±  0.04  build/test/functional/test_runner.py -j$((3 * 8)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)                                                       \r\n        1.08 ¬±  0.04  build/test/functional/test_runner.py -j$((3 * 8)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)                                                       \r\n        1.10 ¬±  0.04  build/test/functional/test_runner.py -j$((3 * 8)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)                                                       \r\n        1.04 ¬±  0.03  build/test/functional/test_runner.py -j$((4 * 8)) || true (COMMIT = d767503b6a2618e0c99407acf98f3bd19fb7defd)                                                       \r\n        1.02 ¬±  0.04  build/test/functional/test_runner.py -j$((4 * 8)) || true (COMMIT = 5bb380ec87af93ed5543ba10e1f8465aca7bcfe7)                                                       \r\n        1.00          build/test/functional/test_runner.py -j$((4 * 8)) || true (COMMIT = 35e91b899dac689b24a8a95fcef083affc695d1e)      \r\n```\r\n\r\n</details>\r\n\r\n\r\nNot sure we can claim that it's faster, but makes more sense conceptually, maybe we can blow up the heavy tests and scale better.\r\n",
          "created_at": "2025-08-13T06:13:15Z"
        },
        {
          "user": "maflcko",
          "body": "Force pushed with a tiny refactor turning a list into a dict. Should be easy to re-review.",
          "created_at": "2025-09-03T08:58:04Z"
        },
        {
          "user": "achow101",
          "body": "ACK fa4885ef2fde2b9fd9eb7367564a2946a45f20ac",
          "created_at": "2025-09-11T20:00:14Z"
        }
      ]
    },
    {
      "number": 33140,
      "title": "test: Avoid shutdown race in NetworkThread",
      "body": "Locally, I am seeing rare intermittent exceptions in the network thread:\r\n\r\n```\r\nstderr:\r\nException in thread NetworkThread:\r\nTraceback (most recent call last):\r\nFile \"/python3.10/threading.py\", line 1016, in _bootstrap_inner\r\nself.run()\r\nFile \"./test/functional/test_framework/p2p.py\", line 744, in run\r\nself.network_event_loop.run_forever()\r\nFile \"/python3.10/asyncio/base_events.py\", line 603, in run_forever\r\nself._run_once()\r\nFile \"/python3.10/asyncio/base_events.py\", line 1871, in _run_once\r\nevent_list = self._selector.select(timeout)\r\nAttributeError: 'NoneType' object has no attribute 'select'\r\n```\r\n\r\nI can reproduce this intermittently via `while ./bld-cmake/test/functional/test_runner.py $(for i in {1..400}; do echo -n \"tool_rpcauth \"; done)  -j 400 ; do true ; done`.\r\n\r\nI suspect this is a race where the shutdown starts the close of the network thread while it is starting.\r\n\r\nA different exception showing this race can be reproduced via:\r\n\r\n```diff\r\ndiff --git a/test/functional/test_framework/p2p.py b/test/functional/test_framework/p2p.py\r\nindex 610aa4ccca..64561e157c 100755\r\n--- a/test/functional/test_framework/p2p.py\r\n+++ b/test/functional/test_framework/p2p.py\r\n@@ -741,6 +741,7 @@ class NetworkThread(threading.Thread):\r\n \r\n     def run(self):\r\n         \"\"\"Start the network thread.\"\"\"\r\n+        import time;time.sleep(.1)\r\n         self.network_event_loop.run_forever()\r\n \r\n     def close(self, *, timeout=10):\r\n```\r\n\r\nIt is trivial to reproduce via any test (e.g. `./bld-cmake/test/functional/tool_rpcauth.py`) and shows a similar traceback to the one above:\r\n\r\n```\r\nException in thread NetworkThread:\r\nTraceback (most recent call last):\r\n  File \"/python3.10/threading.py\", line 1016, in _bootstrap_inner\r\n    self.run()\r\n  File \"./test/functional/test_framework/p2p.py\", line 745, in run\r\n    self.network_event_loop.run_forever()\r\n  File \"/python3.10/asyncio/base_events.py\", line 591, in run_forever\r\n    self._check_closed()\r\n  File \"/python3.10/asyncio/base_events.py\", line 515, in _check_closed\r\n    raise RuntimeError('Event loop is closed')\r\nRuntimeError: Event loop is closed\r\n```\r\n\r\nSo fix the second runtime error in hope of fixing the first one as well.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-08-06T07:25:51Z",
      "updated_at": "2026-01-10T15:29:11Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/pull/33140",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33140.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [brunoerg](https://github.com/bitcoin/bitcoin/pull/33140#pullrequestreview-3389226941) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-08-06T07:25:58Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 33147,
      "title": "build: `test_bitcoin` link failure with `-flto=thin` & address sanitizer",
      "body": "```bash\nclang --version\nclang version 20.1.8 (Fedora 20.1.8-3.fc43)\nTarget: aarch64-redhat-linux-gnu\nThread model: posix\nInstalledDir: /usr/bin\nConfiguration file: /etc/clang/aarch64-redhat-linux-gnu-clang.cfg\n```\n```bash\nexport CC=clang\nexport CXX=clang++\n# CMAKE_INTERPROCEDURAL_OPTIMIZATION is -flto=thin for clang\ncmake -B build -DCMAKE_INTERPROCEDURAL_OPTIMIZATION=ON -DSANITIZERS=address\n<snip>\n[ 54%] Built target bitcoin-util\n[ 55%] Built target bitcoin-wallet\n[ 72%] Built target bitcoin_node\n[ 73%] Built target bitcoind\n[ 73%] Linking CXX executable ../../bin/test_bitcoin\n/usr/bin/ld: error: Failed to link module ../../lib/libbitcoin_consensus.a.llvm.20628.arith_uint256.cpp: Expected at most one ThinLTO module per bitcode file\nclang++: error: linker command failed with exit code 1 (use -v to see invocation)\n```\n\nWe have seen the same issue in oss-fuzz: https://github.com/google/oss-fuzz/blob/564805ba6f3d5b3b9386ae68aaa919ffcf8b50da/projects/bitcoin-core/build.sh#L33.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-08-06T15:46:01Z",
      "updated_at": "2025-09-29T19:07:18Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/33147",
      "labels": [
        "Build system",
        "Upstream"
      ],
      "comment_list": [
        {
          "user": "hebasto",
          "body": "Using a [supported linker](https://clang.llvm.org/docs/ThinLTO.html#linkers), such as `lld` on Ubuntu, helps.",
          "created_at": "2025-09-16T16:11:15Z"
        },
        {
          "user": "maflcko",
          "body": "Can be closed as fixed? Edit: Or rather closed as upstream bug?",
          "created_at": "2025-09-25T17:36:14Z"
        },
        {
          "user": "fanquake",
          "body": "I think either, given we've got this working in oss-fuzz again.",
          "created_at": "2025-09-29T19:07:18Z"
        }
      ]
    },
    {
      "number": 33146,
      "title": "doc: GUI Python dependency is not documented",
      "body": "See this thread: https://github.com/bitcoin/bitcoin/pull/31233#discussion_r2182425599\n\n> (Actually, while testing, a missing python is now a hard error already when -DBUILD_GUI=ON. So I don't think the wording \"refactor\" accurately represents the changes here.)\n\n> This bug still exists. rm -rf ./bld-cmake && cmake -B ./bld-cmake -DBUILD_GUI=ON now fails with:\n\n> So it would be good to revert this pull, or adjust the docs:\n\nWe need to decide whether to document the GUI dep, or re-adjust the code. cc @hebasto ",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-08-06T15:31:29Z",
      "updated_at": "2025-08-19T12:47:45Z",
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/33146",
      "labels": [
        "Docs"
      ]
    }
  ],
  "summary": {
    "pull_requests": 6,
    "issues": 2
  }
}