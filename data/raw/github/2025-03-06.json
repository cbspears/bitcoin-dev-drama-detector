{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T19:22:35.044611+00:00",
  "date": "2025-03-06",
  "pull_requests": [
    {
      "number": 32010,
      "title": "qa: Fix TxIndex race conditions",
      "body": "- Add synchronization in 3 places where if the Transaction Index happens to be slow, we get rare test failures when querying it for transactions (one such case experienced on Windows, prompting investigation).\r\n- Remove unnecessary TxIndex initialization in some tests.\r\n- Add some test coverage where TxIndex aspect could be tested in feature_init.py.",
      "state": "closed",
      "user": "hodlinator",
      "created_at": "2025-03-06T23:08:57Z",
      "updated_at": "2025-04-01T14:21:11Z",
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/pull/32010",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32010.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [fjahr](https://github.com/bitcoin/bitcoin/pull/32010#issuecomment-2711162276), [mzumsande](https://github.com/bitcoin/bitcoin/pull/32010#pullrequestreview-2671833519), [furszy](https://github.com/bitcoin/bitcoin/pull/32010#pullrequestreview-2683350728) |\n| Concept ACK | [Prabhat1308](https://github.com/bitcoin/bitcoin/pull/32010#pullrequestreview-2687270174) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n",
          "created_at": "2025-03-06T23:09:00Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/38344306947</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
          "created_at": "2025-03-06T23:13:37Z"
        },
        {
          "user": "fjahr",
          "body": "re-ACK 3301d2cbe8c3b76c97285d75fa59637cb6952d0b\r\n\r\nOnly change was to make the helper internals a bit nicer.",
          "created_at": "2025-03-10T16:28:06Z"
        },
        {
          "user": "Prabhat1308",
          "body": "Are the files mentioned in `files_to_delete` and `files_to_perturb` comments just for informational purposes that they don't trigger an error or you want to indicate that these files should trigger an error but currently they don't.",
          "created_at": "2025-03-13T04:05:28Z"
        },
        {
          "user": "hodlinator",
          "body": "> Are the files mentioned in `files_to_delete` and `files_to_perturb` comments just for informational purposes that they don't trigger an error or you want to indicate that these files should trigger an error but currently they don't.\r\n\r\nYes, some of them at least probably should trigger an error, but I'm not knowledgeable of those aspects of LevelDB. It would probably be good to dig deeper into that, but I wanted to keep the focus of this PR on the tx index race conditions.\r\n\r\nThe reason I touched *feature_init.py* was because I was trying to eliminate unnecessary `-txindex` usage, eliminating the possibility for these race conditions - but it felt bad to just strip it out there, so I preferred to at least add file patterns in the test for what could be checked without changing the C++ code.",
          "created_at": "2025-03-13T19:30:33Z"
        },
        {
          "user": "hodlinator",
          "body": "Thanks for testing!\r\n\r\n> I could not recreate a race condition but I have\r\n\r\nDid you try the recommended approach in the commit message of 3301d2cbe8c3b76c97285d75fa59637cb6952d0b? It is a bit terse.\r\n\r\n* Make sure you don't have the added `sync_txindex` fix on the Python side.\r\n* Add the `sleep_for()` in the recommended place in the C++ side, (build).\r\n* You should be able to get the individual tests to fail (simplest is to run the test_runner.py suite so the `--args` get sent in correctly).\r\n\r\nHave a feeling I needed slightly different sleep-duration on Windows/Linux due to differences in native/Python execution speed, so maybe it would help to insert slightly longer durations than recommended on Mac to reproduce the issue?\r\n\r\nEdit: Should have also mentioned that one might have to tweak the `--timeout_factor=` value to not time out in unrelated ways (such as tests waiting for more blocks to be synced than in the fixed tests).",
          "created_at": "2025-03-15T21:41:29Z"
        }
      ]
    },
    {
      "number": 32009,
      "title": "contrib: turn off compression of macOS SDK to fix determinism (across distros)",
      "body": "This includes three changes. The first is to more selectively pick files for inclusion into our macOS SDK tarball (skip manpages, binaries etc), which is nice because it redues the size of the tarball (from ~80mb to 20mb), and makes the size increase that happens with the next commit, less-bad.\r\n\r\nThe second change removes compression of the tarball. Starting with Python 3.11, Pythons gzip might delegate to zlib. Depending on the OS, i.e Ubuntu vs Fedora, the underlying zlib implementation might differ, resulting in different output.\r\n\r\nFor now, or until a better solution exists, remove compression. This results in the SDK increasing in size to ~157mb. Which is not unreasonable, to regain determinism (and would be significantly worse without the previous commit).\r\n\r\nSee: https://docs.python.org/3/library/gzip.html#gzip.compress\r\n\r\nThe third renames `gen-sdk` to `gen-sdk.py`, so that it will be linted, along with the rest of our Python files.\r\n\r\nFixes #31873. We could probably also put this into 30.x.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-03-06T16:23:34Z",
      "updated_at": "2025-12-03T11:34:22Z",
      "comments": 30,
      "url": "https://github.com/bitcoin/bitcoin/pull/32009",
      "labels": [
        "Scripts and tools"
      ]
    },
    {
      "number": 32008,
      "title": "chore: update copyright year to present",
      "body": "",
      "state": "closed",
      "user": "xiaobei0715",
      "created_at": "2025-03-06T14:03:37Z",
      "updated_at": "2025-03-06T14:03:56Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/pull/32008",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32008.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
          "created_at": "2025-03-06T14:03:40Z"
        }
      ]
    },
    {
      "number": 32006,
      "title": "docs: remove passing CI section in guidelines for PR merging as it's common sense",
      "body": "Removing passing CI section in guidelines for PR merging as it's common sens",
      "state": "closed",
      "user": "suiyuan1314",
      "created_at": "2025-03-06T02:22:06Z",
      "updated_at": "2025-04-22T18:10:17Z",
      "comments": 11,
      "url": "https://github.com/bitcoin/bitcoin/pull/32006",
      "labels": [
        "Docs"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32006.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [jonatack](https://github.com/bitcoin/bitcoin/pull/32006#issuecomment-2815704455), [rkrux](https://github.com/bitcoin/bitcoin/pull/32006#pullrequestreview-2779915055), [maflcko](https://github.com/bitcoin/bitcoin/pull/32006#issuecomment-2818560151) |\n| Concept NACK | [pinheadmz](https://github.com/bitcoin/bitcoin/pull/32006#issuecomment-2818394106), [achow101](https://github.com/bitcoin/bitcoin/pull/32006#issuecomment-2822066744) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter\n\n<details><summary>Possible typos and grammar issues (âœ¨ LLM generated, experimental)</summary>\n\nMake sure pull request has verified build and test compatibility across environments â†’ Make sure the pull request has verified build and test compatibility across environments\n\n</details>\n",
          "created_at": "2025-03-06T02:22:09Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/38893801821</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
          "created_at": "2025-03-17T16:19:56Z"
        },
        {
          "user": "fanquake",
          "body": "@suiyuan1314 what's the status of this? Concept ~0.",
          "created_at": "2025-04-17T12:08:19Z"
        },
        {
          "user": "suiyuan1314",
          "body": "> @suiyuan1314 what's the status of this? Concept ~0.\r\n\r\nHi sir, I have updated the suggestion changes. Thanks for your review",
          "created_at": "2025-04-17T13:20:15Z"
        },
        {
          "user": "jonatack",
          "body": "> My preference would be to either remove it or keep it short\r\n\r\nSame, suggest removing the section completely. It's very handhold-y, and the few people who might need to read this information are probably the least likely to do so (edit: and maintainers know this already).",
          "created_at": "2025-04-17T17:59:56Z"
        },
        {
          "user": "suiyuan1314",
          "body": "> > My preference would be to either remove it or keep it short\r\n> \r\n> Same, suggest removing the section completely. It's very handhold-y, and the few people who might need to read this information are probably the least likely to do so.\r\n\r\nRemoved this section now :)",
          "created_at": "2025-04-18T15:38:16Z"
        },
        {
          "user": "jonatack",
          "body": "ACK 17a1630f226e1c8eb13eb7c7425290e933ad9368\r\n\r\n\"Make sure pull requests pass CI before merging.\" -> Indeed, this line seems pointless (maintainers are aware), ACK on removing it.",
          "created_at": "2025-04-18T16:05:06Z"
        },
        {
          "user": "pinheadmz",
          "body": "NACK, it may not be common sense for new contributors. Also the tip about adding passing tests before code changes in commit history is useful. I'm not gonna push back if others really want to merge this change, it just doesn't seem useful.",
          "created_at": "2025-04-21T13:18:30Z"
        },
        {
          "user": "maflcko",
          "body": "lgtm ACK 17a1630f226e1c8eb13eb7c7425290e933ad9368\r\n\r\nMakes sense to remove this, because it is common sense, and also redundant with the readme sections https://github.com/bitcoin/bitcoin/blob/master/README.md#automated-testing and https://github.com/bitcoin/bitcoin/blob/master/README.md#manual-quality-assurance-qa-testing.  ",
          "created_at": "2025-04-21T14:31:58Z"
        },
        {
          "user": "achow101",
          "body": "NACK, agree with @pinheadmz ",
          "created_at": "2025-04-22T17:54:27Z"
        },
        {
          "user": "maflcko",
          "body": "Closing for now, due to controversy. ",
          "created_at": "2025-04-22T18:10:17Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 32007,
      "title": "build: cmake --install fails after --target deploy",
      "body": "Somewhat similar to #31745. If you build `--target deploy` and then try and `cmake --install`, it will fail:\n```bash\ncmake -B build --toolchain /root/ci_scratch/depends/x86_64-w64-mingw32/toolchain.cmake -DCMAKE_INSTALL_PREFIX=/root/testing\ncmake --build build --target deploy\n\ncmake --install build\n-- Install configuration: \"RelWithDebInfo\"\n-- Installing: /root/testing/bin/bitcoin-wallet.exe\n-- Installing: /root/testing/share/man/man1/bitcoin-wallet.1\n-- Installing: /root/testing/bin/bitcoind.exe\n-- Installing: /root/testing/share/man/man1/bitcoind.1\n-- Installing: /root/testing/bin/bitcoin-cli.exe\n-- Installing: /root/testing/share/man/man1/bitcoin-cli.1\n-- Installing: /root/testing/bin/bitcoin-tx.exe\n-- Installing: /root/testing/share/man/man1/bitcoin-tx.1\n-- Installing: /root/testing/bin/bitcoin-util.exe\n-- Installing: /root/testing/share/man/man1/bitcoin-util.1\n-- Installing: /root/testing/bin/bitcoin-qt.exe\n-- Installing: /root/testing/share/man/man1/bitcoin-qt.1\nCMake Error at build/src/qt/test/cmake_install.cmake:41 (file):\n  file INSTALL cannot find\n  \"/root/ci_scratch/build/src/qt/test/test_bitcoin-qt.exe\": No such file or\n  directory.\nCall Stack (most recent call first):\n  build/src/qt/cmake_install.cmake:56 (include)\n  build/src/cmake_install.cmake:142 (include)\n  build/cmake_install.cmake:52 (include)\n```\n\nMaybe this isn't a supported workflow? Not completely sure, but I can imagine someone running into this after using the Windows build docs. I did testing #32002.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-03-06T10:42:44Z",
      "updated_at": "2025-05-08T17:26:37Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/32007",
      "labels": [
        "Build system"
      ],
      "comment_list": [
        {
          "user": "hebasto",
          "body": "I think this behaviour is expected since `test_bitcoin-qt.exe` is not part of the Windows installer and is not required for the `deploy` target.\n\nAdditionally, in [WINDOWS BUILD NOTES](https://github.com/bitcoin/bitcoin/blob/a9a2b669f3e07266ae739574e9c1cef5af711db7/doc/build-windows.md), `cmake --install build` follows `cmake --build build`, and this sequence always works.",
          "created_at": "2025-03-07T07:45:08Z"
        },
        {
          "user": "fanquake",
          "body": "Note that this isn't Windows specific. The same happens for macOS build.",
          "created_at": "2025-03-07T09:37:30Z"
        },
        {
          "user": "hebasto",
          "body": "From the CMake [docs](https://cmake.org/cmake/help/latest/variable/CMAKE_SKIP_INSTALL_ALL_DEPENDENCY.html):\n> By default, the `install` target depends on the `all` target. This has the effect, that when `make install` is invoked or `INSTALL` is built, first the `all` target is built, then the installation starts.\n\n[On the other hand](https://cmake.org/cmake/help/latest/manual/cmake.1.html#install-a-project), the `cmake --install <dir>` command:\n> ... may be used _after_ building a project to run installation _without_ using the generated build system or the native build tool.\n\nTherefore, Iâ€™d say that the workflow described in the OP is unsupported. However, the user could instead use the following one:\n```\ncmake -B build --toolchain /root/ci_scratch/depends/x86_64-w64-mingw32/toolchain.cmake -DCMAKE_INSTALL_PREFIX=/root/testing\ncmake --build build --target deploy\ncmake --build build --target install\n```",
          "created_at": "2025-05-08T15:30:05Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 4,
    "issues": 1
  }
}