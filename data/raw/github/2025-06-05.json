{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T19:48:08.060873+00:00",
  "date": "2025-06-05",
  "pull_requests": [
    {
      "number": 32685,
      "title": "wallet: Allow read-only database access for info and dump commands",
      "body": "## Problem\r\n\r\nFixes #29559\r\n\r\nThe `bitcoin-wallet info` and `bitcoin-wallet dump` commands currently fail when wallet files are write-protected, throwing \"Database opened in readonly mode but read-write permissions are needed\" errors. This prevents users from safely inspecting write-protected wallet files, which is important for:\r\n\r\n- Security-conscious setups where wallets are stored on read-only filesystems\r\n- Forensic analysis of wallet files without risk of modification\r\n- Backup verification without accidentally corrupting wallet data\r\n- Compliance with principle of least privilege (read-only operations should only require read access)\r\n\r\n## Solution\r\n\r\nThis PR adds comprehensive read-only database support to enable `bitcoin-wallet info` and `dump` commands to work with write-protected wallet files.\r\n\r\n### Key Changes\r\n\r\n**Database Layer (`src/wallet/db.h`, `src/wallet/sqlite.h`, `src/wallet/sqlite.cpp`)**\r\n- Add `read_only` boolean option to `DatabaseOptions` structure  \r\n- Add `IsReadOnly()` virtual method to `WalletDatabase` interface\r\n- Modify `SQLiteDatabase` to properly handle read-only mode:\r\n  - Use `SQLITE_OPEN_READONLY` flag when `read_only=true`\r\n  - Skip write operations (pragma settings, table creation) in read-only mode\r\n  - Maintain full read capability for queries and data retrieval\r\n\r\n**Wallet Tool (`src/wallet/wallettool.cpp`)**\r\n- Update `bitcoin-wallet info` command to use `options.read_only = true`\r\n- Update `bitcoin-wallet dump` command to use `options.read_only = true`\r\n\r\n**Wallet Loading (`src/wallet/walletdb.cpp`)**\r\n- Enhance `LoadWallet()` to detect read-only mode via `database.IsReadOnly()`\r\n- Skip version updates and other write operations when in read-only mode\r\n- Prevent \"Wallet corrupted\" errors during read-only access\r\n\r\n**Legacy Support (`src/wallet/migrate.h`)**\r\n- Add `IsReadOnly()` method to `BerkeleyRODatabase` for consistency\r\n\r\n## Testing\r\n\r\nThe implementation has been thoroughly tested:\r\n\r\n### Manual Testing\r\n- ‚úÖ Created test wallets and made them read-only (`chmod 444`)\r\n- ‚úÖ Verified `bitcoin-wallet info` works with read-only files\r\n- ‚úÖ Verified `bitcoin-wallet dump` works with read-only files\r\n- ‚úÖ Confirmed identical output between read-write and read-only access\r\n- ‚úÖ Verified normal read-write operations remain unaffected\r\n\r\n### Unit Tests\r\nAll existing wallet tests continue to pass, confirming no regression in normal wallet operations.\r\n\r\n### Safety Verification\r\n- File permissions are respected (no writes attempted on read-only files)\r\n- Data integrity maintained (read-only access produces identical results)\r\n- Backwards compatibility preserved (existing workflows unaffected)\r\n\r\n## Security Considerations\r\n\r\nThis change **improves** security by:\r\n- Enabling inspection of wallet files without write access (principle of least privilege)\r\n- Preventing accidental wallet corruption during read-only operations\r\n- Supporting secure forensic analysis workflows\r\n- Reducing attack surface for read-only operations\r\n\r\nThe implementation is conservative and safe:\r\n- Only affects explicitly read-only operations (`info` and `dump` commands)\r\n- No changes to consensus or validation logic\r\n- No impact on normal wallet operations\r\n- Uses SQLite's built-in read-only mode for safety\r\n\r\n## Backwards Compatibility\r\n\r\nFull backwards compatibility is maintained:\r\n- Existing wallet operations work identically\r\n- No API changes for normal use cases  \r\n- No changes to wallet file formats\r\n- No impact on other Bitcoin Core components\r\n\r\n## Related Work\r\n\r\nThis builds upon existing read-only database patterns in Bitcoin Core, particularly the `BerkeleyRODatabase` class used for wallet migration scenarios. \r\n\r\n#28116 ",
      "state": "open",
      "user": "PeterWrighten",
      "created_at": "2025-06-05T20:36:09Z",
      "updated_at": "2026-01-13T13:01:46Z",
      "comments": 27,
      "url": "https://github.com/bitcoin/bitcoin/pull/32685",
      "labels": [
        "Wallet"
      ]
    },
    {
      "number": 32684,
      "title": "[28.x] 28.2rc2",
      "body": "Backports #32568.\r\nBumps to `rc2`.\r\n#32563 & #32639 haved landed since `rc1`.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-06-05T13:52:05Z",
      "updated_at": "2025-06-09T15:19:15Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/pull/32684",
      "labels": [
        "Backport",
        "CI failed"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32684.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [willcl-ark](https://github.com/bitcoin/bitcoin/pull/32684#pullrequestreview-2907337580), [glozow](https://github.com/bitcoin/bitcoin/pull/32684#issuecomment-2956100913) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (‚ú® experimental)\n\nPossible typos and grammar issues:\n\n- guix: accomodate migration ‚Üí accommodate [spelling error]\n\n<sup>drahtbot_id_4_m</sup>\n",
          "created_at": "2025-06-05T13:52:08Z"
        },
        {
          "user": "fanquake",
          "body": "Guix Build:\r\n```bash\r\nbe30f094366c71bd7251247319dbb0cf1b5674d13e210685328daff1bf855766  guix-build-3b05c498a08e/output/aarch64-linux-gnu/SHA256SUMS.part\r\n1823e9b3d7c97a533ab77540095223bc48759216b9e9fe757f24575f2323680f  guix-build-3b05c498a08e/output/aarch64-linux-gnu/bitcoin-3b05c498a08e-aarch64-linux-gnu-debug.tar.gz\r\n8fd4d3a844e845ae13a95d165ae2cd1fea735295c24bc68b3fd28cb91f59c397  guix-build-3b05c498a08e/output/aarch64-linux-gnu/bitcoin-3b05c498a08e-aarch64-linux-gnu.tar.gz\r\nb86f8537ceb5f364d6be26a488dc21580697ecfb9d7cc7e1a9d691a611c57324  guix-build-3b05c498a08e/output/arm-linux-gnueabihf/SHA256SUMS.part\r\n516a8e1220b18f656f5d1d946ab96f825556d83f32d1ce41fc3f483a246d918b  guix-build-3b05c498a08e/output/arm-linux-gnueabihf/bitcoin-3b05c498a08e-arm-linux-gnueabihf-debug.tar.gz\r\n6d211598a16829142b608f2b85d138c0346ae7057a21e834f7293f9d04d80dea  guix-build-3b05c498a08e/output/arm-linux-gnueabihf/bitcoin-3b05c498a08e-arm-linux-gnueabihf.tar.gz\r\nd133dc0b3081a7048bcf6c7cd0d61333b2372f2763154887069b32ff8ac8ec13  guix-build-3b05c498a08e/output/arm64-apple-darwin/SHA256SUMS.part\r\n863ac4e5fcb95766b81039cd85b2740791a3f65e4b6fd0d39fe57cb182e299aa  guix-build-3b05c498a08e/output/arm64-apple-darwin/bitcoin-3b05c498a08e-arm64-apple-darwin-codesigning.tar.gz\r\n765aed969c45f09fc1df4ba3c802d137ad5776101833d63a0d4957ab0802c0b0  guix-build-3b05c498a08e/output/arm64-apple-darwin/bitcoin-3b05c498a08e-arm64-apple-darwin-unsigned.tar.gz\r\n47a51e1078002b929c3750cf7c292f576448a42c9fa096efdcb5722682c95f18  guix-build-3b05c498a08e/output/arm64-apple-darwin/bitcoin-3b05c498a08e-arm64-apple-darwin-unsigned.zip\r\n3dd79826cbce2e43f1767c15b6b8ed529f0278f6ef721a11fd5e1bdd6aebe8b6  guix-build-3b05c498a08e/output/dist-archive/bitcoin-3b05c498a08e.tar.gz\r\nc4764be65da14dddd84eff11b014cb7d9e01ab8445bf2fe025615455a867aea6  guix-build-3b05c498a08e/output/powerpc64-linux-gnu/SHA256SUMS.part\r\n4b10398475e242acb88b07f550d18e1c7201d6af277489cdd9d626bc966c505d  guix-build-3b05c498a08e/output/powerpc64-linux-gnu/bitcoin-3b05c498a08e-powerpc64-linux-gnu-debug.tar.gz\r\n67fa43a82454fe19048cff94f9b3a9fd875cace5081db517b623ee62d1625a61  guix-build-3b05c498a08e/output/powerpc64-linux-gnu/bitcoin-3b05c498a08e-powerpc64-linux-gnu.tar.gz\r\ndf16a3f91cff89c05285d447687036847e5ddacde10fa1978f5e8fd0a05a0dc0  guix-build-3b05c498a08e/output/riscv64-linux-gnu/SHA256SUMS.part\r\n46a3159a395b460b969a34424534ecfe8d2124012c35b4eec41c5039f7729657  guix-build-3b05c498a08e/output/riscv64-linux-gnu/bitcoin-3b05c498a08e-riscv64-linux-gnu-debug.tar.gz\r\n30cad7f8bb940bc2553ab6b332eaa8fab5b0f58f0c08f03fa236cda7cc0f898e  guix-build-3b05c498a08e/output/riscv64-linux-gnu/bitcoin-3b05c498a08e-riscv64-linux-gnu.tar.gz\r\n6e3329a9e7eb492d4e0af3a86b204da17cb2716c30aa56e6ee701e88d712fc78  guix-build-3b05c498a08e/output/x86_64-apple-darwin/SHA256SUMS.part\r\ne0a93c6aae317f108aee97aa5625eeb94513e03913a1adb80f64a1525c442398  guix-build-3b05c498a08e/output/x86_64-apple-darwin/bitcoin-3b05c498a08e-x86_64-apple-darwin-codesigning.tar.gz\r\n8809523d83765ef203f20502c20abe2a0503ffee96f5d259ac938648f2e9006d  guix-build-3b05c498a08e/output/x86_64-apple-darwin/bitcoin-3b05c498a08e-x86_64-apple-darwin-unsigned.tar.gz\r\n8a0408595e3f46fe07cfd8eaa7e90a58d508d8d4204eef3e8903e00c8fc757ca  guix-build-3b05c498a08e/output/x86_64-apple-darwin/bitcoin-3b05c498a08e-x86_64-apple-darwin-unsigned.zip\r\n0633262002f982db8925af044457d3440b49b4462af29f1cc5766ce17f7160a6  guix-build-3b05c498a08e/output/x86_64-linux-gnu/SHA256SUMS.part\r\n3369dbbe926b844a44e9629aed18f91ab9894b353be96bf861a5ffb56265f876  guix-build-3b05c498a08e/output/x86_64-linux-gnu/bitcoin-3b05c498a08e-x86_64-linux-gnu-debug.tar.gz\r\n6beb32dd287210021a883112663d0298761ae9c2fb5ecec960debc3805893a4e  guix-build-3b05c498a08e/output/x86_64-linux-gnu/bitcoin-3b05c498a08e-x86_64-linux-gnu.tar.gz\r\n1f5edb8d261c48722648f2df3c95ca687d08e6d3f15f2e5afa94f6e51406c104  guix-build-3b05c498a08e/output/x86_64-w64-mingw32/SHA256SUMS.part\r\nb89a8df1360bed7aed3d41242b5ba205441df3e6c44c4d36902571372f290c8b  guix-build-3b05c498a08e/output/x86_64-w64-mingw32/bitcoin-3b05c498a08e-win64-codesigning.tar.gz\r\n646855d3bff2b7b824d58dbdc5ec2981374641c9cdaacc7dce5a78babf99573b  guix-build-3b05c498a08e/output/x86_64-w64-mingw32/bitcoin-3b05c498a08e-win64-debug.zip\r\nbf13ad6e60d699aa33cab7c9dad72a32edc60cb2c512393dd9dcfbe8d3a64fc8  guix-build-3b05c498a08e/output/x86_64-w64-mingw32/bitcoin-3b05c498a08e-win64-setup-unsigned.exe\r\n74f0251c369e49162ddbf745df389ee50f70734bcdfb8a6ca5c38ae93acd4f48  guix-build-3b05c498a08e/output/x86_64-w64-mingw32/bitcoin-3b05c498a08e-win64-unsigned.zip\r\n```",
          "created_at": "2025-06-06T08:43:48Z"
        },
        {
          "user": "willcl-ark",
          "body": "```\r\n‚ùØ find guix-build-$(git rev-parse --short=12 HEAD)/output/ -type f -print0 | env LC_ALL=C sort -z | xargs -r0 sha256sum\r\nbe30f094366c71bd7251247319dbb0cf1b5674d13e210685328daff1bf855766  guix-build-3b05c498a08e/output/aarch64-linux-gnu/SHA256SUMS.part\r\n1823e9b3d7c97a533ab77540095223bc48759216b9e9fe757f24575f2323680f  guix-build-3b05c498a08e/output/aarch64-linux-gnu/bitcoin-3b05c498a08e-aarch64-linux-gnu-debug.tar.gz\r\n8fd4d3a844e845ae13a95d165ae2cd1fea735295c24bc68b3fd28cb91f59c397  guix-build-3b05c498a08e/output/aarch64-linux-gnu/bitcoin-3b05c498a08e-aarch64-linux-gnu.tar.gz\r\nb86f8537ceb5f364d6be26a488dc21580697ecfb9d7cc7e1a9d691a611c57324  guix-build-3b05c498a08e/output/arm-linux-gnueabihf/SHA256SUMS.part\r\n516a8e1220b18f656f5d1d946ab96f825556d83f32d1ce41fc3f483a246d918b  guix-build-3b05c498a08e/output/arm-linux-gnueabihf/bitcoin-3b05c498a08e-arm-linux-gnueabihf-debug.tar.gz\r\n6d211598a16829142b608f2b85d138c0346ae7057a21e834f7293f9d04d80dea  guix-build-3b05c498a08e/output/arm-linux-gnueabihf/bitcoin-3b05c498a08e-arm-linux-gnueabihf.tar.gz\r\nd133dc0b3081a7048bcf6c7cd0d61333b2372f2763154887069b32ff8ac8ec13  guix-build-3b05c498a08e/output/arm64-apple-darwin/SHA256SUMS.part\r\n863ac4e5fcb95766b81039cd85b2740791a3f65e4b6fd0d39fe57cb182e299aa  guix-build-3b05c498a08e/output/arm64-apple-darwin/bitcoin-3b05c498a08e-arm64-apple-darwin-codesigning.tar.gz\r\n765aed969c45f09fc1df4ba3c802d137ad5776101833d63a0d4957ab0802c0b0  guix-build-3b05c498a08e/output/arm64-apple-darwin/bitcoin-3b05c498a08e-arm64-apple-darwin-unsigned.tar.gz\r\n47a51e1078002b929c3750cf7c292f576448a42c9fa096efdcb5722682c95f18  guix-build-3b05c498a08e/output/arm64-apple-darwin/bitcoin-3b05c498a08e-arm64-apple-darwin-unsigned.zip\r\n3dd79826cbce2e43f1767c15b6b8ed529f0278f6ef721a11fd5e1bdd6aebe8b6  guix-build-3b05c498a08e/output/dist-archive/bitcoin-3b05c498a08e.tar.gz\r\nc4764be65da14dddd84eff11b014cb7d9e01ab8445bf2fe025615455a867aea6  guix-build-3b05c498a08e/output/powerpc64-linux-gnu/SHA256SUMS.part\r\n4b10398475e242acb88b07f550d18e1c7201d6af277489cdd9d626bc966c505d  guix-build-3b05c498a08e/output/powerpc64-linux-gnu/bitcoin-3b05c498a08e-powerpc64-linux-gnu-debug.tar.gz\r\n67fa43a82454fe19048cff94f9b3a9fd875cace5081db517b623ee62d1625a61  guix-build-3b05c498a08e/output/powerpc64-linux-gnu/bitcoin-3b05c498a08e-powerpc64-linux-gnu.tar.gz\r\ndf16a3f91cff89c05285d447687036847e5ddacde10fa1978f5e8fd0a05a0dc0  guix-build-3b05c498a08e/output/riscv64-linux-gnu/SHA256SUMS.part\r\n46a3159a395b460b969a34424534ecfe8d2124012c35b4eec41c5039f7729657  guix-build-3b05c498a08e/output/riscv64-linux-gnu/bitcoin-3b05c498a08e-riscv64-linux-gnu-debug.tar.gz\r\n30cad7f8bb940bc2553ab6b332eaa8fab5b0f58f0c08f03fa236cda7cc0f898e  guix-build-3b05c498a08e/output/riscv64-linux-gnu/bitcoin-3b05c498a08e-riscv64-linux-gnu.tar.gz\r\n6e3329a9e7eb492d4e0af3a86b204da17cb2716c30aa56e6ee701e88d712fc78  guix-build-3b05c498a08e/output/x86_64-apple-darwin/SHA256SUMS.part\r\ne0a93c6aae317f108aee97aa5625eeb94513e03913a1adb80f64a1525c442398  guix-build-3b05c498a08e/output/x86_64-apple-darwin/bitcoin-3b05c498a08e-x86_64-apple-darwin-codesigning.tar.gz\r\n8809523d83765ef203f20502c20abe2a0503ffee96f5d259ac938648f2e9006d  guix-build-3b05c498a08e/output/x86_64-apple-darwin/bitcoin-3b05c498a08e-x86_64-apple-darwin-unsigned.tar.gz\r\n8a0408595e3f46fe07cfd8eaa7e90a58d508d8d4204eef3e8903e00c8fc757ca  guix-build-3b05c498a08e/output/x86_64-apple-darwin/bitcoin-3b05c498a08e-x86_64-apple-darwin-unsigned.zip\r\n0633262002f982db8925af044457d3440b49b4462af29f1cc5766ce17f7160a6  guix-build-3b05c498a08e/output/x86_64-linux-gnu/SHA256SUMS.part\r\n3369dbbe926b844a44e9629aed18f91ab9894b353be96bf861a5ffb56265f876  guix-build-3b05c498a08e/output/x86_64-linux-gnu/bitcoin-3b05c498a08e-x86_64-linux-gnu-debug.tar.gz\r\n6beb32dd287210021a883112663d0298761ae9c2fb5ecec960debc3805893a4e  guix-build-3b05c498a08e/output/x86_64-linux-gnu/bitcoin-3b05c498a08e-x86_64-linux-gnu.tar.gz\r\n1f5edb8d261c48722648f2df3c95ca687d08e6d3f15f2e5afa94f6e51406c104  guix-build-3b05c498a08e/output/x86_64-w64-mingw32/SHA256SUMS.part\r\nb89a8df1360bed7aed3d41242b5ba205441df3e6c44c4d36902571372f290c8b  guix-build-3b05c498a08e/output/x86_64-w64-mingw32/bitcoin-3b05c498a08e-win64-codesigning.tar.gz\r\n646855d3bff2b7b824d58dbdc5ec2981374641c9cdaacc7dce5a78babf99573b  guix-build-3b05c498a08e/output/x86_64-w64-mingw32/bitcoin-3b05c498a08e-win64-debug.zip\r\nbf13ad6e60d699aa33cab7c9dad72a32edc60cb2c512393dd9dcfbe8d3a64fc8  guix-build-3b05c498a08e/output/x86_64-w64-mingw32/bitcoin-3b05c498a08e-win64-setup-unsigned.exe\r\n74f0251c369e49162ddbf745df389ee50f70734bcdfb8a6ca5c38ae93acd4f48  guix-build-3b05c498a08e/output/x86_64-w64-mingw32/bitcoin-3b05c498a08e-win64-unsigned.zip\r\n\r\n```",
          "created_at": "2025-06-06T12:29:35Z"
        },
        {
          "user": "glozow",
          "body": "ACK fb6239327700acc8b038d7d241c33439e3f6916e",
          "created_at": "2025-06-09T15:15:20Z"
        }
      ]
    },
    {
      "number": 32682,
      "title": "wallet: have external signer use PSBT error code EXTERNAL_SIGNER_NOT_FOUND",
      "body": "When attempting to sign a transaction involving an external signer, if the device isn't connected we throw an `std::runtime_error`. This prevents the (mainly GUI) code that's actually supposed to handle this case from running.\r\n\r\nThis PR returns a `PSBTError::EXTERNAL_SIGNER_NOT_FOUND` instead of throwing.\r\n\r\nThe first commit is a refactor to have `GetExternalSigner()` return a `util::Result<ExternalSigner>` so the caller can decide how to handle the error. There are two other places where call `GetExternalSigner()` which this PR doesn't change (which I think is fine there).\r\n\r\nBefore:\r\n![before](https://github.com/user-attachments/assets/2e08863b-fe76-479f-9cc0-60571b357a27)\r\n\r\nAfter (the translation already exist):\r\n![after](https://github.com/user-attachments/assets/0e91c7ed-7d44-4030-beec-20d1694c270c)\r\n\r\nFixes #32426\r\n\r\nAdditionally use `LogWarning` instead of `std::cerr` for both a missing signer and failure to sign.",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2025-06-05T10:06:47Z",
      "updated_at": "2025-06-27T09:18:54Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/32682",
      "labels": [
        "Wallet"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32682.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [achow101](https://github.com/bitcoin/bitcoin/pull/32682#issuecomment-2972013372), [brunoerg](https://github.com/bitcoin/bitcoin/pull/32682#pullrequestreview-2933066331) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-06-05T10:06:49Z"
        },
        {
          "user": "achow101",
          "body": "ACK 0a4ee93529d68a31f3ba6c7c6009954be47bbbd6",
          "created_at": "2025-06-09T21:45:15Z"
        },
        {
          "user": "achow101",
          "body": "ACK 9dfc61d95f0082672a9b90528386e6bcd7014a78",
          "created_at": "2025-06-14T00:12:42Z"
        },
        {
          "user": "Sjors",
          "body": "cc @theStack, @naiyoma",
          "created_at": "2025-06-16T11:25:12Z"
        },
        {
          "user": "naiyoma",
          "body": "Post Merge TAck   9dfc61d\r\nI tested this by setting up HWI and using Trezor as my external signer\r\nI noticed while reviewing this that some tests have been commented out ‚Äî> https://github.com/bitcoin/bitcoin/blob/master/test/functional/wallet_signer.py#L81 and also \r\nhttps://github.com/bitcoin/bitcoin/blob/master/test/functional/wallet_signer.py#L171\r\nPerhaps a good follow-up would be to work on as well, ?",
          "created_at": "2025-06-27T09:18:54Z"
        }
      ]
    },
    {
      "number": 32680,
      "title": "ci: Rewrite test-each-commit as py script",
      "body": "This was requested in https://github.com/bitcoin/bitcoin/pull/32573#issuecomment-2897546693, as it is currently not possible to catch this type of error in a Bash linter (https://github.com/bitcoin/bitcoin/pull/32573#pullrequestreview-2857077463). Also, reviewers are not familiar with it and didn't catch the above bug either. (Thus, it is discouraged in the dev notes: https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#scripts)\r\n\r\n\r\nSo just use a simple python script.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-06-05T07:44:32Z",
      "updated_at": "2025-06-11T06:21:04Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/32680",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32680.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [janb84](https://github.com/bitcoin/bitcoin/pull/32680#pullrequestreview-2904243167), [ryanofsky](https://github.com/bitcoin/bitcoin/pull/32680#pullrequestreview-2913521833), [achow101](https://github.com/bitcoin/bitcoin/pull/32680#issuecomment-2960210974) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#31665](https://github.com/bitcoin/bitcoin/pull/31665) (build: Make config warnings fatal if -DWCONFIGURE_ERROR=ON by davidgumberg)\n* [#30595](https://github.com/bitcoin/bitcoin/pull/30595) (kernel: Introduce initial C header API by TheCharlatan)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-06-05T07:44:35Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `lint`: https://github.com/bitcoin/bitcoin/runs/43523418048</sub>\n<sub>LLM reason (‚ú® experimental): Lint test failed due to permission issue on a script file.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-06-05T08:01:28Z"
        },
        {
          "user": "ryanofsky",
          "body": "If I compare the [added rust script](https://github.com/bitcoin/bitcoin/blob/fa9aced60a320904405e4add6998fb20e64cd7e5/.github/ci-test-each-commit-exec.rs) to the [removed bash script](https://github.com/bitcoin/bitcoin/blob/a980918f51d710806acbb3bc4e77cb6be63cc04b/.github/ci-test-each-commit-exec.sh), the bash script does seem significantly simpler to me. I understand the rust script could have other improvements and maintenance advantages though, so no objections to this change.\r\n\r\n",
          "created_at": "2025-06-05T18:06:02Z"
        },
        {
          "user": "maflcko",
          "body": "Hmm, yeah the boilerplate overhead is a bit unfortunate. I switched to python, which still has downsides such as https://github.com/bitcoin/bitcoin/pull/29068#issuecomment-1852746032, but it seems manageable here. Also, updated the pull description.\r\n\r\nI think the danger of Bash, that it looks harmless and superficially simple and correct, but in many such \"harmless\" constructs can silently drop a failing return status is reason enough to prefer a slightly more verbose language. Maybe rust is too verbose here, but python seems acceptable. Bash also has many other issues, for example the version shipped by macOS is so ancient that it is older than Bitcoin itself and writing a CI script on a modern platform that uses a newer Bash feature will then only fail in CI when the pull is created/pushed. (Failing loudly if you are lucky, failing silently, if you are not)",
          "created_at": "2025-06-06T06:20:33Z"
        },
        {
          "user": "achow101",
          "body": "ACK fa9cfdf3be754b01e6ce73a0cc2f998b81e12970",
          "created_at": "2025-06-10T18:17:44Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 32683,
      "title": "Internal bug detected: Fee needed > fee paid",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nwalletcreatefundedpsbt errors out\n\n```\n walletcreatefundedpsbt \"[]\" '{\"<readacted_addr>\":0.01}'\nerror code: -4\nerror message:\nInternal bug detected: Fee needed > fee paid\n./wallet/spend.cpp:1320 (CreateTransactionInternal)\nBitcoin Core v29.0.0\nPlease report this issue here: https://github.com/bitcoin/bitcoin/issues\n```\n\n### Expected behaviour\n\nwalletcreatefundedpsbt should not error out.\n\n\n### Steps to reproduce\n\nCreate a watch only wallet\nImport a P2SH publickey\nTry to create an unsigned TX using the TXOs of the descriptor\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nBitcoin Core daemon version v29.0.0\n\n### Operating system and version\n\nUbuntu 22.04 LTS\n\n### Machine specifications\n\n_No response_",
      "state": "open",
      "user": "Fuzion24",
      "created_at": "2025-06-05T13:01:23Z",
      "updated_at": "2025-06-10T18:22:36Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/32683",
      "labels": [
        "Wallet"
      ],
      "comment_list": [
        {
          "user": "Fuzion24",
          "body": "I had previously tried with an explicit feeRate, but here's exactly your example and it's output:\n\n```\nwalletcreatefundedpsbt \"[]\" '{\"<redacted address>\":0.1}' 0 '{\"feeRate\":0.0001}'\nerror code: -4\nerror message:\nInternal bug detected: Fee needed > fee paid\n./wallet/spend.cpp:1320 (CreateTransactionInternal)\nBitcoin Core v29.0.0\nPlease report this issue here: https://github.com/bitcoin/bitcoin/issues\n```",
          "created_at": "2025-06-05T16:46:31Z"
        },
        {
          "user": "maflcko",
          "body": "@Muniru0 Please do not post LLM generated blobs blindly. As can be seen, this isn't helpful.\n\n\nSimilar report: https://github.com/bitcoin/bitcoin/issues/29398\n\n@Fuzion24 It would be helpful if the issue could be reproduced step-by-step on a freshly created regtest testing wallet.",
          "created_at": "2025-06-05T16:54:45Z"
        },
        {
          "user": "Muniru0",
          "body": "> [@Muniru0](https://github.com/Muniru0) Please do not post LLM generated blobs blindly. As can be seen, this isn't helpful.\n> \n> Similar report: [#29398](https://github.com/bitcoin/bitcoin/issues/29398)\n> \n> [@Fuzion24](https://github.com/Fuzion24) It would be helpful if the issue could be reproduced step-by-step on a freshly created regtest testing wallet.\n\nThanks  a lot @maflcko. I can that in good faith. I had an idea and used an LLM to try to make it more professional I guess that was my bad. I will try to reproduce the error using the guidelines. I will research thoroughly about this using #29398.\n\n",
          "created_at": "2025-06-05T17:36:13Z"
        },
        {
          "user": "achow101",
          "body": ">  Import a P2SH publickey\n\nCan you be more specific as to what you imported? P2SH is, by definition, more than just a public key nor do P2SH scripts necessarily have to have a public key.",
          "created_at": "2025-06-05T18:39:47Z"
        },
        {
          "user": "achow101",
          "body": "> Should you be allowed to create a transaction on a watch only wallet?\n\nYes, that's pretty much the point of a watch-only wallet: to create unsigned transactions that the offline wallet can sign.",
          "created_at": "2025-06-10T17:43:57Z"
        }
      ]
    },
    {
      "number": 32681,
      "title": "ci: libFuzzer disabled leak detection after every mutation",
      "body": "https://cirrus-ci.com/task/4646509657980928?logs=ci#L91\n```bash\n[05:44:30.094] INFO: libFuzzer disabled leak detection after every mutation.\n[05:44:30.094]       Most likely the target function accumulates allocated\n[05:44:30.094]       memory in a global state w/o actually leaking it.\n[05:44:30.094]       You may try running this binary with -trace_malloc=[12]      to get a trace of mallocs and frees.\n[05:44:30.094]       If LeakSanitizer is enabled in this process it will still\n[05:44:30.094]       run on the process shutdown.\n```\n\nHappening in at least `txgraph` & `transaction`. Not sure I've seen this before.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2025-06-05T09:51:51Z",
      "updated_at": "2025-06-05T09:56:07Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/32681",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "maflcko",
          "body": "See https://github.com/bitcoin/bitcoin/pull/31481",
          "created_at": "2025-06-05T09:56:06Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 4,
    "issues": 2
  }
}