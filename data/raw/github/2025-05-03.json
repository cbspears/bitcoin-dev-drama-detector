{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T19:38:07.454603+00:00",
  "date": "2025-05-03",
  "pull_requests": [
    {
      "number": 32415,
      "title": "scripted-diff: adapt script error constant names in feature_taproot.py",
      "body": "While reviewing #31622 I noticed that the constant name `(SCRIPT_)ERR_SIG_HASHTYPE` is used for two different script verification error codes, namely one for legacy and one for Schnorr signatures:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/eba5f9c4b63fe46261fbb3e71b9a94832d105b23/src/script/script_error.cpp#L56-L57\r\nhttps://github.com/bitcoin/bitcoin/blob/eba5f9c4b63fe46261fbb3e71b9a94832d105b23/test/functional/feature_taproot.py#L600\r\n\r\nIn order to resolve this confusion, this PR adapts all script error constant names in the functional tests (currently only in feature_taproot.py) to the ones used in our C++ codebase (see [script_error.cpp](https://github.com/bitcoin/bitcoin/blob/master/src/script/script_error.cpp)) with a scripted diff. This also makes checking whether we have test coverage for a certain script error easier.",
      "state": "closed",
      "user": "theStack",
      "created_at": "2025-05-03T18:28:30Z",
      "updated_at": "2025-05-06T23:06:41Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/32415",
      "labels": [
        "Refactoring"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32415.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [jamesob](https://github.com/bitcoin/bitcoin/pull/32415#issuecomment-2848902968), [rkrux](https://github.com/bitcoin/bitcoin/pull/32415#pullrequestreview-2814701995), [stratospher](https://github.com/bitcoin/bitcoin/pull/32415#pullrequestreview-2816937496), [achow101](https://github.com/bitcoin/bitcoin/pull/32415#issuecomment-2856231027) |\n| Concept ACK | [sipa](https://github.com/bitcoin/bitcoin/pull/32415#issuecomment-2848808851) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32301](https://github.com/bitcoin/bitcoin/pull/32301) (test: cover invalid codesep positions for signature in taproot by instagibbs)\n* [#32270](https://github.com/bitcoin/bitcoin/pull/32270) (test: fix pushdata scripts by instagibbs)\n* [#32247](https://github.com/bitcoin/bitcoin/pull/32247) (BIP-348 (OP_CHECKSIGFROMSTACK) (regtest only) by jamesob)\n* [#29491](https://github.com/bitcoin/bitcoin/pull/29491) ([EXPERIMENTAL] Schnorr batch verification for blocks by fjahr)\n* [#29371](https://github.com/bitcoin/bitcoin/pull/29371) (test: Add `leaf_version` parameter to `taproot_tree_helper()` by Christewart)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (‚ú® experimental)\n\nPossible typos and grammar issues:\n\nError: ‚Äúneither compressed or uncompressed‚Äù ‚Üí ‚Äúneither compressed nor uncompressed‚Äù\n\n",
          "created_at": "2025-05-03T18:28:33Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `lint`: https://github.com/bitcoin/bitcoin/runs/41591166714</sub>\n<sub>LLM reason (‚ú® experimental): The CI failure is caused by errors in the lint check related to script evaluation failures, specifically ERR_EVAL_FALSE errors.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-05-03T18:32:50Z"
        },
        {
          "user": "sipa",
          "body": "Concept ACK",
          "created_at": "2025-05-03T21:06:35Z"
        },
        {
          "user": "jamesob",
          "body": "crACK https://github.com/bitcoin/bitcoin/pull/32415/commits/b5f580c580257d28d295cae3f787b55eb1863f16\r\n\r\nScripted-diff/func-test-only makes this an easy review. Good cleanup for this daunting file.",
          "created_at": "2025-05-04T01:45:15Z"
        },
        {
          "user": "achow101",
          "body": "ACK b5f580c580257d28d295cae3f787b55eb1863f16",
          "created_at": "2025-05-06T22:10:23Z"
        }
      ]
    },
    {
      "number": 32414,
      "title": "validation: periodically flush dbcache during reindex-chainstate",
      "body": "After #30611 we periodically do a non-erasing flush of the dbcache to disk roughly every hour during IBD.\r\nThe intention was to also do this periodic flush during reindex-chainstate, so we would not risk losing progress during a system failure when reindexing with a high dbcache value.\r\n\r\nIt was discovered that reindex-chainstate does not perform a PERIODIC flush until it has already reached the tip. Since reindexing to tip usually happens within 24 hours, this behaviour was unnoticed with the previous periodic flush interval. Note that reindex-chainstate still does IF_NEEDED flushes during `ConnectBlock`, so this also would not be noticed when running with a lower dbcache value.\r\n\r\nThis patch moves the PERIODIC flush from after the outer loop in `ActivateBestChain` to inside the outer loop after we release `cs_main`. This will periodically flush during IBD, reindex-chainstate, and steady state.",
      "state": "closed",
      "user": "andrewtoth",
      "created_at": "2025-05-03T12:55:59Z",
      "updated_at": "2025-12-11T19:56:26Z",
      "comments": 12,
      "url": "https://github.com/bitcoin/bitcoin/pull/32414",
      "labels": [
        "Validation"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32414.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [l0rinc](https://github.com/bitcoin/bitcoin/pull/32414#issuecomment-2872303093), [sipa](https://github.com/bitcoin/bitcoin/pull/32414#pullrequestreview-3552937494), [achow101](https://github.com/bitcoin/bitcoin/pull/32414#issuecomment-3643539057) |\n| Concept ACK | [shahsb](https://github.com/bitcoin/bitcoin/pull/32414#pullrequestreview-2813733894) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#30214](https://github.com/bitcoin/bitcoin/pull/30214) (refactor: Improve assumeutxo state representation by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-03T12:56:03Z"
        },
        {
          "user": "andrewtoth",
          "body": "Thanks to @l0rinc for discovering this behaviour, and @mzumsande for the suggested fix.",
          "created_at": "2025-05-03T12:57:20Z"
        },
        {
          "user": "l0rinc",
          "body": "I can confirm that this fixes the periodic flushes for `-reindex-chainstate`:\r\n\r\n<details>\r\n<summary>Details</summary>\r\n\r\n```\r\ncat debug-7fc8d7f9c1f0fe3795b397327e38465ee6f76b83-1746277780.log | grep FlushStateToDisk\r\n2025-05-03T14:14:56Z [coindb] FlushStateToDisk write: flush mode=PERIODIC, prune=0, cache_large=0, cache_critical=0, periodic=1\r\n2025-05-03T15:16:31Z [coindb] FlushStateToDisk write: flush mode=PERIODIC, prune=0, cache_large=0, cache_critical=0, periodic=1\r\n2025-05-03T16:16:31Z [coindb] FlushStateToDisk write: flush mode=PERIODIC, prune=0, cache_large=0, cache_critical=0, periodic=1\r\n2025-05-03T16:36:48Z [coindb] FlushStateToDisk write: flush mode=ALWAYS, prune=0, cache_large=0, cache_critical=0, periodic=0\r\n2025-05-03T16:39:20Z [coindb] FlushStateToDisk write: flush mode=ALWAYS, prune=0, cache_large=0, cache_critical=0, periodic=0\r\n```\r\n\r\n</details>\r\n\r\n![height_vs_time](https://github.com/user-attachments/assets/36076de9-44a9-4dd5-96bd-3a6152e68aee)\r\n![cache_vs_time](https://github.com/user-attachments/assets/536494bb-8397-41d1-b371-570214583d7f)\r\n\r\n\r\n----\r\n\r\nNit: is this comment still accurate? https://github.com/bitcoin/bitcoin/blob/master/src/validation.cpp#L2782 Guess it just refers to the size based trigger, not the time based - which is probably fine given its small context.",
          "created_at": "2025-05-03T18:07:00Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `lint`: https://github.com/bitcoin/bitcoin/runs/41595509701</sub>\n<sub>LLM reason (‚ú® experimental): The CI failure is caused by a trailing whitespace error detected during the lint check.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-05-03T23:33:54Z"
        },
        {
          "user": "andrewtoth",
          "body": "> is this comment still accurate? https://github.com/bitcoin/bitcoin/blob/master/src/validation.cpp#L2782 Guess it just refers to the size based trigger, not the time based - which is probably fine given its small context.\r\n\r\nI think it's still accurate, and #30611 doesn't make it stale. I think the comment https://github.com/bitcoin/bitcoin/blob/master/src/validation.cpp#L2861 describes the behavior.\r\n\r\n> Regardless, I think we should cover this with a test - do you think we could extend e.g. https://github.com/bitcoin/bitcoin/blob/master/test/functional/feature_reindex.py with an assert_debug_log checking the periodic write logs of https://github.com/bitcoin/bitcoin/pull/32404?\r\n\r\nHmm I was wondering if we could do something with mocktime and validation interface to confirm it flushes. ",
          "created_at": "2025-05-03T23:55:19Z"
        },
        {
          "user": "l0rinc",
          "body": "You didn't mean to close it, right?\r\n\r\n------\r\n\r\nI can confirm that this change retains the flushing behavior during IBD as well as far as I can tell from the plots:\r\n![height_vs_time](https://github.com/user-attachments/assets/1998e3fe-6fbb-460e-9739-87cde10f9e4e)\r\n\r\n![cache_coins_vs_time](https://github.com/user-attachments/assets/b657672e-1ecc-4083-b8ae-a7684b145201)\r\n\r\n---\r\n\r\n\r\nI'll compare the `reindex-chainstate` performance next, before & after, let's see if there's a regression (we do expect a 4% slowdown for max cache, like in IBD).\r\n",
          "created_at": "2025-05-04T08:12:59Z"
        },
        {
          "user": "l0rinc",
          "body": "Finished measuring `reindex-chainstate` performance for max dbcache (best case scenario), where this PR shines most (i.e. to avoid the worst-case scenario of doing everything in-memory and crashing at the end without anything saved).\r\n\r\nMeasured it on an HDD with i7 processor, so disk writes are expensive here - would likely be better on SSD.\r\nUnfortunately this change results in a 11% slowdown for scenarios that were hoarding memory, since it has to flush intermediary results regularly, so the invalidations happen on disk now instead of in-memory.\r\n\r\n<details>\r\n<summary>Benchmark</summary>\r\n\r\n```bash\r\nCOMMITS=\"eba5f9c4b63fe46261fbb3e71b9a94832d105b23 b56a7e2e983c78eca9acdf12a77f60a3cc6b53a0\"; \\                                \r\nSTOP_HEIGHT=888888; DBCACHE=45000; \\                                                                                                                                                      \r\nCC=gcc; CXX=g++; \\                                                                                                                                                                        \r\nBASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/BitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; \\                                                                                                 \r\n(echo \"\"; for c in $COMMITS; do git fetch origin $c -q && git log -1 --pretty=format:'%h %s' $c || exit 1; done; echo \"\") && \\                                                            \r\nhyperfine \\                                                                                                                                                                               \r\n  --sort 'command' \\                                                                                                                                                                      \r\n  --runs 2 \\                                                                                                                                                                              \r\n  --export-json \"$BASE_DIR/rdx-${COMMITS// /-}-$STOP_HEIGHT-$DBCACHE-$CC.json\" \\                                                                                                          \r\n  --parameter-list COMMIT ${COMMITS// /,} \\\r\n  --prepare \"killall bitcoind; rm -f $DATA_DIR/debug.log; git checkout {COMMIT}; git clean -fxd; git reset --hard; \\\r\n    cmake -B build -DCMAKE_BUILD_TYPE=Release -DENABLE_WALLET=OFF && cmake --build build -j$(nproc) --target bitcoind && \\\r\n    ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP_HEIGHT -dbcache=5000 -printtoconsole=0; sleep 100\" \\\r\n  --cleanup \"cp $DATA_DIR/debug.log $LOG_DIR/debug-{COMMIT}-$(date +%s).log\" \\\r\n  \"COMPILER=$CC ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP_HEIGHT -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 -dbcache=$DBCACHE\"\r\n```\r\n\r\n> eba5f9c4b6 Merge bitcoin/bitcoin#32403: test: remove Boost SIGCHLD workaround.\r\n> b56a7e2e98 validation: periodically flush dbcache during reindex-chainstate\r\n\r\n```python\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=888888 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 -dbcache=45000 (COMMIT = eba5f9c4b63fe46261fbb3e71b9a94832d105b23) \r\n  Time (mean ¬± œÉ):     22404.449 s ¬± 77.811 s    [User: 20909.449 s, System: 563.985 s]\r\n  Range (min ‚Ä¶ max):   22349.428 s ‚Ä¶ 22459.469 s    2 runs\r\n  \r\nBenchmark 2: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=888888 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 -dbcache=45000 (COMMIT = b56a7e2e983c78eca9acdf12a77f60a3cc6b53a0) \r\n  Time (mean ¬± œÉ):     24821.312 s ¬± 19.392 s    [User: 22218.160 s, System: 746.676 s]\r\n  Range (min ‚Ä¶ max):   24807.600 s ‚Ä¶ 24835.024 s    2 runs\r\n```\r\n\r\n```python\r\nRelative speed comparison\r\n        1.00          COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=888888 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 -dbcache=45000 (COMMIT = eba5f9c4b63fe46261fbb3e71b9a94832d105b23)\r\n        1.11 ¬±  0.00  COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=888888 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 -dbcache=45000 (COMMIT = b56a7e2e983c78eca9acdf12a77f60a3cc6b53a0)\r\n```\r\n\r\n</details>\r\n\r\nIt's unfortunate to lose this much performance, as suggested before, maybe the change from 24 hours to 1 hour was too big - what if we tried an average of 100 minutes instead?\r\n\r\nWill measure IBD with latest changes now.",
          "created_at": "2025-05-06T11:49:56Z"
        },
        {
          "user": "andrewtoth",
          "body": "> It's unfortunate to lose this much performance, as suggested before, maybe the change from 24 hours to 1 hour was too big - what if we tried an average of 100 minutes instead?\r\n\r\nI'm not sure it's worth bike shedding over the amount of time to periodically flush. The difference with an HDD is 6 hours 13 minutes vs 6 hours 53 minutes. So we could be saving a maximum of 40 minutes over something that takes over 6 hours anyways.",
          "created_at": "2025-05-06T15:38:04Z"
        },
        {
          "user": "l0rinc",
          "body": "> I'll compare the reindex-chainstate performance next, before & after, let's see if there's a regression (we do expect a 4% slowdown for max cache, like in IBD).\r\n\r\nIBD seems to be basically the same as before, this change indeed only affects `reindex-chainstate`.\r\n\r\n<details>\r\n<summary>Details</summary>\r\n\r\n```bash\r\nCOMMITS=\"baa848b8d38187ce6b24a57cfadf1ea180209711 c822dd1f355b6f403191072cdd3c9c3e234bbcaa\"; \\\r\nSTOP_HEIGHT=888888; DBCACHE=45000; \\\r\nCC=gcc; CXX=g++; \\\r\nBASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/BitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; \\\r\n(echo \"\"; for c in $COMMITS; do git fetch origin $c -q && git log -1 --pretty=format:'%h %s' $c || exit 1; done; echo \"\") && \\\r\nhyperfine \\\r\n  --sort 'command' \\\r\n  --runs 1 \\\r\n  --export-json \"$BASE_DIR/ibd-${COMMITS// /-}-$STOP_HEIGHT-$DBCACHE-$CC.json\" \\\r\n  --parameter-list COMMIT ${COMMITS// /,} \\\r\n  --prepare \"killall bitcoind; rm -rf $DATA_DIR/*; git checkout {COMMIT}; git clean -fxd; git reset --hard; \\\r\n    cmake -B build -DCMAKE_BUILD_TYPE=Release -DENABLE_WALLET=OFF && cmake --build build -j$(nproc) --target bitcoind && \\\r\n    ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=1 -printtoconsole=0; sleep 10\" \\\r\n  --cleanup \"cp $DATA_DIR/debug.log $LOG_DIR/debug-{COMMIT}-$(date +%s).log\" \\\r\n  \"COMPILER=$CC ./build/bin/bitcoind -datadir=$DATA_DIR -blocksonly -printtoconsole=0 -stopatheight=$STOP_HEIGHT -dbcache=$DBCACHE\"\r\n```\r\n\r\n> baa848b8d3 Merge bitcoin/bitcoin#32405: build: replace header checks with `__has_include`\r\n> c822dd1f35 refactor: consolidate 3 separate locks into one block\r\n\r\n```python\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -blocksonly -printtoconsole=0 -stopatheight=888888 -dbcache=45000 (COMMIT = baa848b8d38187ce6b24a57cfadf1ea180209711)\r\n  Time (abs ‚â°):        38323.520 s               [User: 36485.235 s, System: 2391.492 s]\r\n \r\nBenchmark 2: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -blocksonly -printtoconsole=0 -stopatheight=888888 -dbcache=45000 (COMMIT = c822dd1f355b6f403191072cdd3c9c3e234bbcaa)\r\n  Time (abs ‚â°):        38063.544 s               [User: 35628.341 s, System: 1952.398 s]\r\n```\r\n\r\n```python \r\nRelative speed comparison\r\n        1.01          COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -blocksonly -printtoconsole=0 -stopatheight=888888 -dbcache=45000 (COMMIT = baa848b8d38187ce6b24a57cfadf1ea180209711)\r\n        1.00          COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -blocksonly -printtoconsole=0 -stopatheight=888888 -dbcache=45000 (COMMIT = c822dd1f355b6f403191072cdd3c9c3e234bbcaa)\r\n```\r\n\r\n</details>\r\n\r\n> So we could be saving a maximum of 40 minutes\r\n\r\nYes, it's a significant difference. I'll retry it with 100 minutes to see if it would fix the situation.",
          "created_at": "2025-05-07T09:24:55Z"
        },
        {
          "user": "l0rinc",
          "body": ">  I'll retry it with 100 minutes to see if it would fix the situation.\r\n\r\nWith 100 mins it's **7%** slower instead of **11%** - still quite bad, but we shouldn't have to choose between performance and persistence, so let's find ways to reduce that. And IBD is the usecase that matters most anyway.\r\n\r\n<details>\r\n<summary>Details</summary>\r\n\r\n```bash\r\nCOMMITS=\"59d3e4ed34eb55cb40928d524cb0bd5e183ed85a cf75a7b599fe459935b7aa4776e91526fcfb0fcc\"; \\\r\nSTOP_HEIGHT=888888; DBCACHE=45000; \\\r\nCC=gcc; CXX=g++; \\\r\nBASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/BitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; \\\r\n(echo \"\"; for c in $COMMITS; do git fetch origin $c -q && git log -1 --pretty=format:'%h %s' $c || exit 1; done; echo \"\") && \\\r\nhyperfine \\\r\n  --sort 'command' \\\r\n  --runs 2 \\\r\n  --export-json \"$BASE_DIR/rdx-${COMMITS// /-}-$STOP_HEIGHT-$DBCACHE-$CC.json\" \\\r\n  --parameter-list COMMIT ${COMMITS// /,} \\\r\n  --prepare \"killall bitcoind; rm -f $DATA_DIR/debug.log; git checkout {COMMIT}; git clean -fxd; git reset --hard; \\\r\n    cmake -B build -DCMAKE_BUILD_TYPE=Release -DENABLE_WALLET=OFF && cmake --build build -j$(nproc) --target bitcoind && \\\r\n    ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP_HEIGHT -dbcache=5000 -printtoconsole=0; sleep 10\" \\\r\n  --cleanup \"cp $DATA_DIR/debug.log $LOG_DIR/debug-{COMMIT}-$(date +%s).log\" \\\r\n  \"COMPILER=$CC ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP_HEIGHT -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 -dbcache=$DBCACHE\"\r\n````\r\n\r\n> 59d3e4ed34 Merge bitcoin/bitcoin#32415: scripted-diff: adapt script error constant names in feature_taproot.py\r\n> cf75a7b599 DATABASE_WRITE_INTERVAL ~100min\r\n\r\n```python\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=888888 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 -dbcache=45000 (COMMIT = 59d3e4ed34eb55cb40928d524cb0bd5e183ed85a)\r\n  Time (mean ¬± œÉ):     22098.816 s ¬±  5.810 s    [User: 20814.326 s, System: 557.473 s]\r\n  Range (min ‚Ä¶ max):   22094.707 s ‚Ä¶ 22102.924 s    2 runs\r\n \r\nBenchmark 2: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=888888 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 -dbcache=45000 (COMMIT = cf75a7b599fe459935b7aa4776e91526fcfb0fcc)\r\n  Time (mean ¬± œÉ):     23737.633 s ¬± 159.720 s    [User: 21704.678 s, System: 682.595 s]\r\n  Range (min ‚Ä¶ max):   23624.694 s ‚Ä¶ 23850.572 s    2 runs\r\n```\r\n\r\n```python\r\nRelative speed comparison\r\n        1.00          COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=888888 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 -dbcache=45000 (COMMIT = 59d3e4ed34eb55cb40928d524cb0bd5e183ed85a)\r\n        1.07 ¬±  0.01  COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=888888 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 -dbcache=45000 (COMMIT = cf75a7b599fe459935b7aa4776e91526fcfb0fcc)\r\n```\r\n\r\n</details>\r\n\r\nACK c1e554d3e5834a140f2a53854018499a3bfe6822\r\n\r\nNit: I'd squash the first two commits, they should be split by features, not by files.\r\nThe test demonstrates the need for the solution, it's weird to have the answer first, followed by the question.",
          "created_at": "2025-05-12T12:07:57Z"
        },
        {
          "user": "sipa",
          "body": "Concept ACK",
          "created_at": "2025-11-03T20:10:55Z"
        },
        {
          "user": "achow101",
          "body": "ACK c1e554d3e5834a140f2a53854018499a3bfe6822",
          "created_at": "2025-12-11T19:49:21Z"
        }
      ]
    },
    {
      "number": 32413,
      "title": "test: test that descriptorprocesspsbt removes non witness utxos in PSBT",
      "body": "`descriptorprocesspsbt` RPC uses a different flow internally from the `walletprocesspsbt` RPC, which was already tested in the tests.\r\n\r\nThis patch ensures that `descriptorprocesspsbt` RPC can correctly sign the PSBT while removing the non witness UTXOs in case of Segwit V1 only inputs.\r\n\r\nThis was identified in the review of #31622 PR.\r\nRef: https://github.com/bitcoin/bitcoin/pull/31622#discussion_r1979463960\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "closed",
      "user": "rkrux",
      "created_at": "2025-05-03T11:49:24Z",
      "updated_at": "2025-07-16T09:52:36Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/pull/32413",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32413.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-03T11:49:26Z"
        },
        {
          "user": "rkrux",
          "body": "Closing for now, will reopen later if this piques someone's interest.",
          "created_at": "2025-07-16T09:52:36Z"
        }
      ]
    },
    {
      "number": 32412,
      "title": "Musig2 fields followups",
      "body": "<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "closed",
      "user": "rkrux",
      "created_at": "2025-05-03T08:59:12Z",
      "updated_at": "2025-07-31T05:57:01Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/pull/32412",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32412.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [theStack](https://github.com/bitcoin/bitcoin/pull/32412#pullrequestreview-2864492651) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-03T08:59:15Z"
        },
        {
          "user": "rkrux",
          "body": "Closing this one now.",
          "created_at": "2025-07-31T05:57:01Z"
        }
      ]
    },
    {
      "number": 32411,
      "title": "doc: update CWallet::SignTransaction doc to mention SIGHASH_DEFAULT",
      "body": "While `SIGHASH_DEFAULT` & `SIGHASH_ALL` are effectively the same, it's helpful to mention in the function doc exactly what's present in the code.\r\n\r\nIt can be seen in the function implementation that `SIGHASH_DEFAULT` is passed to the overloaded `SignTransaction` function.\r\n\r\nRef: https://github.com/bitcoin/bitcoin/blob/f490f5562d4b20857ef8d042c050763795fd43da/src/wallet/wallet.cpp#L2177-L2194\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "closed",
      "user": "rkrux",
      "created_at": "2025-05-03T08:21:28Z",
      "updated_at": "2025-05-26T08:33:13Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/pull/32411",
      "labels": [
        "Docs"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32411.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-03T08:21:32Z"
        },
        {
          "user": "Sjors",
          "body": "They're only the same for Taproot inputs. \r\n\r\ncc @achow101",
          "created_at": "2025-05-13T11:49:30Z"
        },
        {
          "user": "achow101",
          "body": "DEFAULT and ALL are effectively the same for Taproot inputs, and DEFAULT is an alias for ALL for non-taproot inputs. I don't think that this change is meaningfully useful as ALL and DEFAULT are essentially aliases for each other, and mean basically the same thing.",
          "created_at": "2025-05-13T17:34:31Z"
        },
        {
          "user": "rkrux",
          "body": "True. The main reason for this change was that I didn't see any benefit in leaving ALL around in the function documentation when the implementation uses DEFAULT.\r\n\r\nI am open to closing this PR later if this doesn't seem like a strong enough reason.",
          "created_at": "2025-05-13T17:49:18Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 32416,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "Ari4ka",
      "created_at": "2025-05-03T18:48:58Z",
      "updated_at": "2025-05-12T09:10:10Z",
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/32416",
      "labels": []
    },
    {
      "number": 32410,
      "title": "Enhancement: Persist User Settings Across Sessions in Bitcoin Core GUI",
      "body": "Currently, the Bitcoin Core GUI does not retain user preferences such as window size, position, and selected tabs between sessions. This requires users to reconfigure their interface each time they launch the application, which can be inconvenient.",
      "state": "closed",
      "user": "QuantumAlchemist03",
      "created_at": "2025-05-03T07:40:55Z",
      "updated_at": "2025-05-03T07:41:18Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/32410",
      "labels": [],
      "comment_list": [
        {
          "user": "QuantumAlchemist03",
          "body": "Implement a mechanism to save user interface settings upon application exit and restore them upon startup. This could involve storing preferences in a configuration file or utilizing platform-specific settings storage.",
          "created_at": "2025-05-03T07:41:15Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 5,
    "issues": 2
  }
}