{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T20:39:30.520391+00:00",
  "date": "2025-12-12",
  "pull_requests": [
    {
      "number": 34063,
      "title": "Make `transaction_indentifier` hex string constructor evaluated at comptime",
      "body": "Suggested by l0rinc as a comment in #34004.\r\n\r\nThere are tests that utilize `FromHex` that will only fail during runtime if malformed. Adds a compile time constructor that can be caught by LSPs.",
      "state": "closed",
      "user": "rustaceanrob",
      "created_at": "2025-12-12T16:25:31Z",
      "updated_at": "2025-12-17T17:16:36Z",
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/pull/34063",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34063.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [l0rinc](https://github.com/bitcoin/bitcoin/pull/34063#issuecomment-3649780755), [maflcko](https://github.com/bitcoin/bitcoin/pull/34063#issuecomment-3654215634), [rkrux](https://github.com/bitcoin/bitcoin/pull/34063#pullrequestreview-3578359222) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#33034](https://github.com/bitcoin/bitcoin/pull/33034) (wallet: Store transactions in a separate sqlite table by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-12-12T16:25:39Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `Windows-cross to x86_64, ucrt`: https://github.com/bitcoin/bitcoin/actions/runs/20173084809/job/57923462319</sub>\n<sub>LLM reason (‚ú® experimental): Compilation failed due to -Werror treating unused-value warnings as errors in merkleblock_tests.cpp.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-12-12T21:41:24Z"
        },
        {
          "user": "l0rinc",
          "body": "It seems you've hit https://gcc.gnu.org/bugzilla/show_bug.cgi?id=117501\r\nCreated https://godbolt.org/z/xb5TMaPs6, we should be able to fix it with an explicit `constexpr` for the declarations.\r\n\r\nI have pushed an alternative to https://github.com/l0rinc/bitcoin/pull/63, please cherry-pick it if it passes CI.\r\nNote that I've also changed some constructors to use brace init and extended the commit message with the issue and the godbolt reproducer. Also added a missing `#include <string_view>`.",
          "created_at": "2025-12-12T21:59:17Z"
        },
        {
          "user": "rustaceanrob",
          "body": "Co-authorship attribution, rebased into single commit, brace initialization throughout the commit, and `constexpr` fix in 5ac35795206d252c9f464e967b84521ddaad38f1",
          "created_at": "2025-12-13T20:14:19Z"
        },
        {
          "user": "l0rinc",
          "body": "ACK 5ac35795206d252c9f464e967b84521ddaad38f1\r\n\r\nI'm fine with this version and with @ajtowns's [suggestion](https://github.com/bitcoin/bitcoin/pull/34063#discussion_r2615793433) as well - let's see what others think.",
          "created_at": "2025-12-13T20:29:33Z"
        },
        {
          "user": "maflcko",
          "body": "review ACK 5ac35795206d252c9f464e967b84521ddaad38f1 ü¶é\r\n\r\n<details><summary>Show signature</summary>\r\n\r\nSignature:\r\n\r\n```\r\nuntrusted comment: signature from minisign secret key on empty file; verify via: minisign -Vm \"${path_to_any_empty_file}\" -P RWTRmVTMeKV5noAMqVlsMugDDCyyTSbA3Re5AkUrhvLVln0tSaFWglOw -x \"${path_to_this_whole_four_line_signature_blob}\"\r\nRUTRmVTMeKV5npGrKx1nqXCw5zeVHdtdYURB/KlyA/LMFgpNCs+SkW9a8N95d+U4AP1RJMi+krxU1A3Yux4bpwZNLvVBKy0wLgM=\r\ntrusted comment: review ACK 5ac35795206d252c9f464e967b84521ddaad38f1 ü¶é\r\nsRW+9c4Xa164fJzsatQut371BfPuwGZUQxpppVTpFOQgXGpNPuQo4Opj5UF5Aj7N2DWpc2h/TNJrMWmGFrKmBA==\r\n```\r\n\r\n</details>\r\n",
          "created_at": "2025-12-15T07:48:39Z"
        }
      ]
    },
    {
      "number": 34061,
      "title": "fuzz: Fix bugs in `clusterlin_postlinearize_tree` target",
      "body": "Addresses two issues in the `clusterlin_postlinearize_tree` target:\r\n\r\n1. The loop iteration while creating tree dependency graphs was incorrect.\r\n2. We were accidentally passing in `post_linearization` to `PostLinearize` instead of the copy we just made, resulting in an ineffective check.",
      "state": "closed",
      "user": "marcofleon",
      "created_at": "2025-12-12T15:25:37Z",
      "updated_at": "2025-12-14T12:16:35Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/34061",
      "labels": [
        "Tests",
        "Fuzzing"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34061.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [sipa](https://github.com/bitcoin/bitcoin/pull/34061#issuecomment-3647032758), [instagibbs](https://github.com/bitcoin/bitcoin/pull/34061#pullrequestreview-3572724599) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-12-12T15:26:01Z"
        },
        {
          "user": "fanquake",
          "body": "cc @sipa @instagibbs @glozow ",
          "created_at": "2025-12-12T15:28:18Z"
        },
        {
          "user": "sipa",
          "body": "ACK a70a14a3f4f4d66025302c00eb4ff8108835cc5d",
          "created_at": "2025-12-12T15:33:59Z"
        }
      ]
    },
    {
      "number": 34060,
      "title": "test: fix race condition in p2p_v2_misbehaving.py peerid assertion",
      "body": "Remove the hard-coded peer id from the debug message in `p2p_v2_misbehaving.py`.\r\n\r\nasyncio's non-deterministic task scheduling might cause [peer2](https://github.com/bitcoin/bitcoin/blob/938d7aacabd0bb3784bb3e529b1ed06bb2891864/test/functional/p2p_v2_misbehaving.py#L181)'s connection to happen before [peer1](https://github.com/bitcoin/bitcoin/blob/938d7aacabd0bb3784bb3e529b1ed06bb2891864/test/functional/p2p_v2_misbehaving.py#L179)'s. since we test that peer2 [remains connected](https://github.com/bitcoin/bitcoin/blob/938d7aacabd0bb3784bb3e529b1ed06bb2891864/test/functional/p2p_v2_misbehaving.py#L182), any disconnection must originate from peer1, making the specific peer id not necessary for test correctness. so we can remove the hard coded peer id from the expected debug log message.\r\n\r\nFixes #34035.",
      "state": "closed",
      "user": "stratospher",
      "created_at": "2025-12-12T15:05:48Z",
      "updated_at": "2025-12-16T13:56:01Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/34060",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34060.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [mzumsande](https://github.com/bitcoin/bitcoin/pull/34060#pullrequestreview-3579684981), [maflcko](https://github.com/bitcoin/bitcoin/pull/34060#issuecomment-3660373452) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-12-12T15:05:57Z"
        },
        {
          "user": "fanquake",
          "body": "cc @mzumsande ",
          "created_at": "2025-12-14T12:37:20Z"
        },
        {
          "user": "maflcko",
          "body": "lgtm ACK 09dfa4d3f8dfbea61a73d4add79e2464ca776571",
          "created_at": "2025-12-16T12:49:14Z"
        }
      ]
    },
    {
      "number": 34059,
      "title": "refactor: Use NodeClock::time_point for m_addr_token_timestamp",
      "body": "It is a bit confusing to have some code use the deprecated `GetTime`, which returns a duration and not a time point, and other code to use `NodeClock` time points.\r\n\r\nFix one place `m_addr_token_timestamp` to use `NodeClock::time_point`.\r\n\r\nAlso:\r\n\r\n* Extract a `ProcessAddrs` helper, similar to the other `Process*()` helpers, to cut down the `ProcessMessage` with a massive scope.\r\n* Rename the confusing `current_a_time` to `now_seconds`. (The `a` in this context refers to the removed \"adjusted\" time, see commit fadd8b2676f6d68ec87189871461c9a6a6aa3cac, which removed adjusted time here)\r\n* Clean-up a test, to make `ProcessMessage` private again. Also, change pointers to references to avoid the mental and literal overhead of (redundantly) checking for nullptr every time.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2025-12-12T14:15:29Z",
      "updated_at": "2026-01-12T21:47:33Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/34059",
      "labels": [
        "Refactoring",
        "Needs rebase"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34059.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Approach ACK | [ajtowns](https://github.com/bitcoin/bitcoin/pull/34059#issuecomment-3648529415) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#34181](https://github.com/bitcoin/bitcoin/pull/34181) (refactor: [p2p] Make ProcessMessage private again, Use references when non-null by maflcko)\n* [#33854](https://github.com/bitcoin/bitcoin/pull/33854) (fix assumevalid is ignored during reindex by Eunovo)\n* [#32278](https://github.com/bitcoin/bitcoin/pull/32278) (doc: better document NetEventsInterface and the deletion of \"CNode\"s by vasild)\n* [#31650](https://github.com/bitcoin/bitcoin/pull/31650) (refactor: Avoid copies by using const references or by move-construction by maflcko)\n* [#29415](https://github.com/bitcoin/bitcoin/pull/29415) (Broadcast own transactions only via short-lived Tor or I2P connections by vasild)\n* [#27052](https://github.com/bitcoin/bitcoin/pull/27052) (test: rpc: add last block announcement time to getpeerinfo result by LarryRuane)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-12-12T14:15:40Z"
        },
        {
          "user": "ajtowns",
          "body": "What do you think of getting all the `peer->foo` to `peer.foo` noise done first, rather than doing it bit by bit? Here's a scripted-diff approach that might be easy to review: https://github.com/ajtowns/bitcoin/commits/202512-peer-by-ref/\r\n\r\nApproach ACK otherwise",
          "created_at": "2025-12-12T23:45:16Z"
        },
        {
          "user": "maflcko",
          "body": "> What do you think of getting all the `peer->foo` to `peer.foo` noise done first, rather than doing it bit by bit? Here's a scripted-diff approach that might be easy to review: https://github.com/ajtowns/bitcoin/commits/202512-peer-by-ref/\r\n\r\nNice branch. I re-created it to avoid refactoring real code to accommodate tests, which are better served by just using the pre-existing `ConnmanTestMsg` helpers.",
          "created_at": "2025-12-16T09:40:38Z"
        },
        {
          "user": "maflcko",
          "body": "Let's review https://github.com/bitcoin/bitcoin/pull/34181 first (the first few commits), as they are likely useful more generally.",
          "created_at": "2025-12-30T16:34:32Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\nüêô This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
          "created_at": "2026-01-12T21:47:33Z"
        }
      ]
    },
    {
      "number": 34058,
      "title": "test: Improve code coverage for pubkey checks",
      "body": "Cover these branches in `IsCompressedOrUncompressedPubKey` and `IsCompressedPubKey`:\r\n- `Non-canonical public key: invalid length for uncompressed key`\r\n- `Non-canonical public key: invalid length for compressed key`\r\n- `Non-canonical public key: invalid prefix for compressed key`\r\n\r\nSee the missed branches here: https://maflcko.github.io/b-c-cov/total.coverage/src/script/interpreter.cpp.gcov.html\r\n\r\n`script_tests` succeed on my end.",
      "state": "closed",
      "user": "billymcbip",
      "created_at": "2025-12-12T13:05:32Z",
      "updated_at": "2025-12-18T12:36:11Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/34058",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34058.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [rkrux](https://github.com/bitcoin/bitcoin/pull/34058#issuecomment-3656051220) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-12-12T13:05:41Z"
        },
        {
          "user": "rkrux",
          "body": "tACK a00332ffb3b57b36b6cdaf2627a856c8dfab6ea7",
          "created_at": "2025-12-15T14:49:11Z"
        },
        {
          "user": "billymcbip",
          "body": "@rkrux I created a new PR with the exact same changes: https://github.com/bitcoin/bitcoin/pull/34099. I hope the code coverage job will run correctly on that PR.",
          "created_at": "2025-12-18T12:36:11Z"
        }
      ]
    },
    {
      "number": 34057,
      "title": "test: add tests for cluster chunks",
      "body": "Add tests for cluster chunks, including:\r\n    - GetWorstMainChunk() tests, which picks the worst chunk from txgraph.\r\n    - GetCurrentChunk(), which returns chunks in linearization order after calling it iteratively.\r\n",
      "state": "open",
      "user": "HowHsu",
      "created_at": "2025-12-12T13:04:16Z",
      "updated_at": "2025-12-30T09:59:23Z",
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/pull/34057",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34057.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [sipa](https://github.com/bitcoin/bitcoin/pull/34057#issuecomment-3646694648), [rkrux](https://github.com/bitcoin/bitcoin/pull/34057#pullrequestreview-3577063050) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (‚ú® experimental)\n\n\n\nPossible typos and grammar issues:\n\n- everytime -> every time [‚Äúeverytime‚Äù is nonstandard; the correct two-word form is ‚Äúevery time‚Äù.]\n\n\n\n<sup>2025-12-30</sup>\n",
          "created_at": "2025-12-12T13:04:25Z"
        },
        {
          "user": "fanquake",
          "body": "cc @sipa ",
          "created_at": "2025-12-12T13:07:11Z"
        },
        {
          "user": "brunoerg",
          "body": "FWIW `txgraph` has a lot of unkilled mutants (some in GetWorstMainChunk) that could be addressed: https://corecheck.dev/mutation/src/txgraph.cpp",
          "created_at": "2025-12-12T13:13:50Z"
        },
        {
          "user": "HowHsu",
          "body": "> FWIW `txgraph` has a lot of unkilled mutants (some in GetWorstMainChunk) that could be addressed: https://corecheck.dev/mutation/src/txgraph.cpp\r\n\r\nThanks, I'll take a look.",
          "created_at": "2025-12-12T13:41:44Z"
        },
        {
          "user": "sipa",
          "body": "Concept ACK.\r\n\r\nNice start, we can certainly use more unit tests in this area, as significant parts of `txgraph` are only tested through fuzz tests, If you want to add more, looking for unkilled mutants found by @brunoerg is a good idea.",
          "created_at": "2025-12-12T14:27:19Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `Windows-cross to x86_64, ucrt`: https://github.com/bitcoin/bitcoin/actions/runs/20208904989/job/58011715272</sub>\n<sub>LLM reason (‚ú® experimental): C++ compile error: conflicting declarations of 'chunk' in txgraph_tests.cpp causing test_bitcoin build failure.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-12-14T14:47:52Z"
        }
      ]
    },
    {
      "number": 34054,
      "title": "net processing: Add ibd check before processing block for txdownloadman",
      "body": "Calculating the rolling bloom filters for the txorphanage takes some CPU time from the scheduler thread. This can be observed for example in [this flamegraph](https://bitcoin-dev-tools.github.io/benchcoin/results/pr-172/20066462508/mainnet-default-instrumented-base-flamegraph.svg?x=920203898521&y=780), where handling the filter takes about 2.6% of total time (and most of the scheduler thread's time). \r\n\r\nDuring ibd the entries in the tx download bloom filter are just continuously rolled over and aren't consumed, since no mempool entries are created by incoming transactions from peers during ibd. The mempool does accept transactions via RPC, or the wallet at the time, however these don't interact with the orphanage and the txdownloadman, because adding anything to those is guarded by IsInitialBlockDownload() checks as well.\r\n\r\nWe're usually latching ibd to false a few blocks before catching up to the tip, so this should also not significantly degrade the performance of the filter once fully caught up.",
      "state": "open",
      "user": "sedited",
      "created_at": "2025-12-12T09:06:28Z",
      "updated_at": "2026-01-12T10:46:21Z",
      "comments": 11,
      "url": "https://github.com/bitcoin/bitcoin/pull/34054",
      "labels": [
        "P2P"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34054.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [mzumsande](https://github.com/bitcoin/bitcoin/pull/34054#pullrequestreview-3609289387), [fjahr](https://github.com/bitcoin/bitcoin/pull/34054#issuecomment-3691757904) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-12-12T09:06:37Z"
        },
        {
          "user": "maflcko",
          "body": "> During ibd the entries in the tx download bloom filter are just continuously rolled over, and aren't consumed, since no mempool is maintained at the time.\r\n\r\nI think this could be clarified a bit, why this is safe. My understanding is that a mempool does exist and is maintained (albeit it will normally be empty). The mempool will also happily accept transactions via RPC, or the wallet. However, this is fine, because they don't interact with the orphanage and the txdownloadman, because adding anything to those is guarded by `IsInitialBlockDownload()` checks as well?\r\n\r\nRef:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/8da8ff30a57f0fe7f627d121c5e40466f1ecb0b2/src/net_processing.cpp#L4258-L4268\r\n\r\nand\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/8da8ff30a57f0fe7f627d121c5e40466f1ecb0b2/src/net_processing.cpp#L3987-L3990",
          "created_at": "2025-12-12T10:17:21Z"
        },
        {
          "user": "sedited",
          "body": "Re https://github.com/bitcoin/bitcoin/pull/34054#issuecomment-3645846544\r\n\r\n> I think this could be clarified a bit, why this is safe.\r\n\r\nThanks, that was not precise. Slightly reworded your explanation and added it to the pull request description. I was curious if the ibd check might cause a performance regression, since we're probably triggering fewer de-allocs on the scheduler thread. I tried to get some results in [benchcoin](https://github.com/bitcoin-dev-tools/benchcoin/pull/175#issuecomment-3651662220). The results were kind of mixed, but there is clearly no more work being done through the txdownloadman during ibd.",
          "created_at": "2025-12-15T20:21:26Z"
        },
        {
          "user": "maflcko",
          "body": "> fewer de-allocs on the scheduler thread.\r\n\r\nI think this patch does not change whether the event is run on the scheduler thread, or not, but rather if the event runs faster in the scheduler thread with the early return. So I think this should not move destructor calls between threads. Or am I missing something?",
          "created_at": "2025-12-16T12:32:13Z"
        },
        {
          "user": "sedited",
          "body": "Re https://github.com/bitcoin/bitcoin/pull/34054#issuecomment-3660303557\r\n\r\n> but rather if the event runs faster in the scheduler thread with the early return.\r\n\r\nYes, and I was curious if this might change where the final decrement for the block's shared pointer happens.",
          "created_at": "2025-12-16T12:52:18Z"
        },
        {
          "user": "maflcko",
          "body": "Oh, I see. I guess if the behavior should be enforced at compile-time, the blocks could be `std::moved` into the event",
          "created_at": "2025-12-16T13:31:05Z"
        },
        {
          "user": "sedited",
          "body": "Rebased 2233420fcff7c9c3d7d5727880a8ae1e6173eb89 -> 42dc1725b978329e0808db5e2c3a64c038c35de3 ([txdownloadman_ibd_check_0](https://github.com/TheCharlatan/bitcoin/tree/txdownloadman_ibd_check_0) -> [txdownloadman_ibd_check_1](https://github.com/TheCharlatan/bitcoin/tree/txdownloadman_ibd_check_1), [compare](https://github.com/TheCharlatan/bitcoin/compare/txdownloadman_ibd_check_0..txdownloadman_ibd_check_1))\r\n\r\n* Fixed conflict with #30214",
          "created_at": "2025-12-16T15:26:36Z"
        },
        {
          "user": "sedited",
          "body": "> Also, this introduces a cs_main lock in the scheduler thread, which could cause some lock contention with msghand - not sure how important this it, but it might go well together with https://github.com/bitcoin/bitcoin/pull/32885.\r\n\r\nYes, the original PR explicitly worked around this by introducing a variable to track the ibd state: https://github.com/bitcoin/bitcoin/pull/32730/files#diff-b1e19192258d83199d8adaa5ac31f067af98f63554bfdd679bd8e8073815e69dL1911-L1912 . A prior approach of that PR passes the ibd state directly in the `BlockConnected` callback. I think blocking here might be fine (which is why it opened this), but it's not great either. What do you think of drafting this for now, and we try to make progress with #32885, or do you prefer one of the other approaches?",
          "created_at": "2025-12-24T09:32:25Z"
        },
        {
          "user": "fjahr",
          "body": "Concept ACK",
          "created_at": "2025-12-25T21:28:56Z"
        },
        {
          "user": "mzumsande",
          "body": "> What do you think of drafting this for now, and we try to make progress with https://github.com/bitcoin/bitcoin/pull/32885, or do you prefer one of the other approaches?\r\n\r\nI think I like the approach from #32885 because it addresses the issue at its root (so that many IBD checks would benefit, not just this one). As to whether this should be drafted I'm unsure - it's probably an improvement even with the added locking due to the saved work, but given the mixed results from benchcoin maybe we'd need more testing?",
          "created_at": "2025-12-26T18:51:43Z"
        },
        {
          "user": "maflcko",
          "body": "> given the mixed results from benchcoin maybe we'd need more testing?\r\n\r\nThe latest runs shows a speedup in both scenarios, but the earlier run showed a slowdown in `mainnet-default-uninstrumented`, but the only difference was a rebase, so this seems to indicate that the benchcoin run itself is not stable?\r\n\r\n(Commit 8da8ff30a57f0fe7f627d121c5e40466f1ecb0b2 was deleted by GitHub, so I am just going after the comment https://github.com/bitcoin/bitcoin/pull/34054#issuecomment-3661120464)",
          "created_at": "2026-01-12T10:46:21Z"
        }
      ]
    },
    {
      "number": 34053,
      "title": "lint: Remove confusing, redundant, and brittle lint-spelling",
      "body": "`codespell` was a fun experiment. However, it has many issues, when used in this project:\r\n\r\n* The number of false-positives and true-positives are in the same ballpark. There are also many false-negatives, so the overall net-benefit is questionable.\r\n* There is often confusion around spelling errors leading to a failing CI (they do not, which was intended).\r\n* LLMs released this year are capable to detect typos with less false-positives and less false-negatives, so the `codespell` integration is a bit redundant in that sense.\r\n\r\nFix all issues by removing it.\r\n\r\nGoing forward, anyone is free to continue to use `codespell`, or any LLM, or any other tool, locally. Also, DrahtBot has the LLM typo linter integrated in the summary comment. I think the options are plenty, and are more than sufficient for now.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-12-12T08:22:34Z",
      "updated_at": "2025-12-17T18:19:35Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/34053",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34053.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [l0rinc](https://github.com/bitcoin/bitcoin/pull/34053#issuecomment-3645520119), [rkrux](https://github.com/bitcoin/bitcoin/pull/34053#pullrequestreview-3571429071), [pablomartin4btc](https://github.com/bitcoin/bitcoin/pull/34053#pullrequestreview-3573513114) |\n| Concept ACK | [sedited](https://github.com/bitcoin/bitcoin/pull/34053#issuecomment-3645523026), [stickies-v](https://github.com/bitcoin/bitcoin/pull/34053#issuecomment-3645998330) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#33968](https://github.com/bitcoin/bitcoin/pull/33968) (ci: remove `doc/release-notes.md` from lint-spelling.py by JeremyRubin)\n* [#33522](https://github.com/bitcoin/bitcoin/pull/33522) (guix: use LIEF 0.17.1 by fanquake)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-12-12T08:22:45Z"
        },
        {
          "user": "l0rinc",
          "body": "ACK fa904fc683c0892eb800ddb986fdc0c646721077",
          "created_at": "2025-12-12T08:46:47Z"
        },
        {
          "user": "sedited",
          "body": "Concept ACK",
          "created_at": "2025-12-12T08:47:46Z"
        },
        {
          "user": "stickies-v",
          "body": "Concept ACK. Didn't seem to be a useful test, so best to remove it.",
          "created_at": "2025-12-12T10:58:46Z"
        },
        {
          "user": "fanquake",
          "body": "I think it's ok for linters to be removed as long as they aren't causing failures / enforcing anything.",
          "created_at": "2025-12-17T17:18:44Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 34064,
      "title": "Wallet: gettransaction(txid).details changes after confirmation of RBF replacement",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nFor a replaced transaction (txA), the output of gettransaction(txA, true).details\nchanges after the replacement transaction (txB) is confirmed.\n\nSpecifically, a 'receive' entry present after bumpfee disappears once txB is\nconfirmed, even though the queried txid remains txA.\n\nAfter confirmation, repeated calls are stable.\n\n\n### Expected behaviour\n\nFor a given txid, gettransaction(txid).details should be stable once the\nreplacement transaction has been confirmed, or at minimum should not\nretroactively add or remove details entries in a way that changes accounting\ninterpretation for the same transaction id.\n\n\n### Steps to reproduce\n\n1. Create a transaction (txA) from a descriptor wallet.\n2. Replace txA using bumpfee, creating txB.\n3. Query gettransaction(txA, true) and record details.\n4. Mine blocks to confirm txB.\n5. Query gettransaction(txA, true) again and compare details.\n\nA minimal reproduction package and proof artifacts are attached below.\n\n[x3_mini_package.tar.gz](https://github.com/user-attachments/files/24134210/x3_mini_package.tar.gz)\n\nSHA-256 (x3_mini_package.tar.gz):\n47413632eab190a2c2477b0d2f8128bc956326ae3765d8fbf6b2a9da5046a617\n\n### Relevant log output\n\nNo debug.log output is required; the issue is observable via wallet RPC output.\n\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\n27.0\n\n### Operating system and version\n\nUbuntu 22.04 LTS (regtest environment)\n\n### Machine specifications\n\nStandard x86_64 Linux host, SSD storage, regtest environment.",
      "state": "open",
      "user": "husstege-e",
      "created_at": "2025-12-12T19:53:39Z",
      "updated_at": "2025-12-22T21:43:37Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34064",
      "labels": [
        "Wallet",
        "RPC/REST/ZMQ"
      ],
      "comment_list": [
        {
          "user": "achow101",
          "body": "This is expected behavior. When a transaction becomes conflicted (i.e. a conflict is confirmed in the main chain), we don't want to show any details that might make the user think they have more or less money than they actually do.",
          "created_at": "2025-12-22T21:43:37Z"
        }
      ]
    },
    {
      "number": 34062,
      "title": "RFC: separate kernel logging infrastructure",
      "body": "tl;dr: kernel logging is cumbersome. I propose we layer logging so we can enable structured logging and a much simplified kernel logging interface without overcomplicating node logging.\n\n## Motivation\n\nThe `bitcoinkernel` library (#27587) [exposes](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L698-L778) functionality to interface with the kernel logging. This includes registering callbacks for log statements, level/category filtering, string formatting options, and more.\n\nKernel logging has a few problems:\n- **P1**: [callbacks](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L304) operate on formatted strings, so users need to parse the string to get the timestamp, category, level, ... based on which options are set. This is cumbersome, brittle, and inefficient.\n- **P2**: the [filtering interface](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L737) is not really intuitive, requiring users to call combinations of `btck_logging_set_level_category` and `btck_logging_enable_category` when they want to produce `debug` or `trace` logs. The level/category system makes sense for node, because it directly controls what gets written to disk and stdout, and there are quite a lot more categories producing logs. Kernel doesn't really need this - users control what happens to the logs, and can do any filtering/manipulation in the callback they provide.\n- **P3**: the node logging infrastructure has quite a bit more functionality than is necessary for a library, including ratelimiting, log formatting, outputting, buffering, ... This introduces unnecessary code and interface complexity.\n- **P4**: it [uses](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.cpp#L237) the global (node) logger, which goes against the otherwise context local (or stateless) design of the `bitcoinkernel` interface.\n\n## Approach\n\nI propose we address problems P1, P2 and P3 by layering the logging infrastructure. Roughly, this would mean:\n1. Implement a minimal `util::log::Logger` class (see [Appendix](#Appendix)) that dispatches structured log entries to registered callbacks. This is a low-level logger that does not perform formatting, rate limiting, or category filtering - it simply dispatches to callbacks.\n2. Refactor `BCLog::Logger` into `BCLog::Sink`, which registers a callback on `util::log::GetLogger()` and handles all node-specific functionality (category filtering, rate limiting, file output, formatting, ...).\n3. Update kernel code to include `util/log.h` instead of `logging.h`. The existing logging macros (`LogInfo`, `LogDebug`, etc.) continue to work unchanged.\n4. Simplify `bitcoinkernel` C API to reflect the simpler `util::log::Logger` interface (structured logging, level-based, ...), we can now completely remove `btck_LoggingOptions`.\n5. Remove `logging.h` and `logging.cpp` from the kernel library completely.\n\n**Note:** I'm leaving problem P4 out of scope for this proposal. I think it already has sufficient merit with a global logger, and I want to keep scope limited. However, I do believe layered logging infrastructure will make implementing P4 easier.\n\n## Balance\n\nThe main benefits and downsides of this approach:\n\n**Benefits:**\n- **B1:** a kernel-native structured logging interface that minimizes complexity and makes for a much more ergonomic interface, enabling structured logging instead of string parsing.\n- **B2:** doesn't complicate node logging purely for the purpose of accommodating diverging requirements for kernel. For example, I suspect projects like #30342 should be much easier with layered kernel logging.\n- **B3:** reduces friction if/when node migrates to use the public `bitcoinkernel` interface by having already completely decoupled logging.\n- ... (what have I missed?)\n\n**Downsides:**\n- **D1:** levels-based filtering has some performance overhead by formatting all (kernel) debug log strings instead of just the subset of categories specified. Note that this _only_ applies when debug is enabled, and that kernel has a lot less logging than node.\n- ... (what have I missed?)\n\n## Scope\n\nI have implemented this approach in https://github.com/bitcoin/bitcoin/compare/master...stickies-v:bitcoin:2025-12/kernel-logging-layering. Most of the changes are quite straightforward, including refactoring `BCLog::Logger` to `BCLog::Sink`, adding tests, and adding a `util::log::Logger` interface.\n\n## Appendix\n\n### Interfaces\n#### util::log::Logger\n\n```cpp\nclass Logger\n{\npublic:\n    using Callback = std::function<void(const Entry&)>;\n    using CallbackHandle = std::list<Callback>::iterator;\n\n    //! Register a callback to receive log entries. Returns a handle for unregistration.\n    [[nodiscard]] CallbackHandle RegisterCallback(Callback callback);\n\n    //! Unregister a previously registered callback.\n    void UnregisterCallback(CallbackHandle handle);\n\n    //! Set the minimum log level. Messages below this level are discarded.\n    void SetMinLevel(Level level);\n\n    //! Get the current minimum log level.\n    Level GetMinLevel() const;\n\n    //! Returns true if a message at the given level would be logged.\n    bool WillLog(Level level) const;\n\n    //! Returns true if any callbacks are registered.\n    bool Enabled() const;\n\n    //! Format message and dispatch to all registered callbacks. No-op if minimum log level not met.\n    template <typename... Args>\n    void Log(Level level, uint64_t category, std::source_location loc, bool should_ratelimit,\n             util::ConstevalFormatString<sizeof...(Args)> fmt, const Args&... args);\n};\n```\n\n#### `bitcoinkernel` C logging interface\n\n```c\ntypedef void (*btck_LogCallback)(void* user_data, const btck_LogEntry* entry);\n\nstruct btck_LogEntry {\n    const char* message;       //!< Log message\n    size_t message_len;        //!< Log message length\n    const char* file_name;     //!< Source file name\n    size_t file_name_len;      //!< Source file name length\n    const char* function_name; //!< Source function name\n    size_t function_name_len;  //!< Source function name length\n    const char* thread_name;   //!< Thread name\n    size_t thread_name_len;    //!< Thread name length\n    int64_t timestamp_ns;      //!< Timestamp in nanoseconds since epoch\n    uint32_t line;             //!< Source line number\n    btck_LogLevel level;       //!< Log level\n    btck_LogCategory category; //!< Log category\n};\n\nBITCOINKERNEL_API void btck_logging_set_min_level(btck_LogLevel level);\n\nBITCOINKERNEL_API btck_LoggingConnection* BITCOINKERNEL_WARN_UNUSED_RESULT btck_logging_connection_create(\n    btck_LogCallback log_callback,\n    void* user_data,\n    btck_DestroyCallback user_data_destroy_callback) BITCOINKERNEL_ARG_NONNULL(1);\n\nBITCOINKERNEL_API void btck_logging_connection_destroy(btck_LoggingConnection* logging_connection);\n```\n",
      "state": "open",
      "user": "stickies-v",
      "created_at": "2025-12-12T15:43:10Z",
      "updated_at": "2026-01-14T15:14:47Z",
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/issues/34062",
      "labels": [
        "Brainstorming",
        "Utils/log/libs"
      ],
      "comment_list": [
        {
          "user": "ryanofsky",
          "body": "Nice work. The new interface proposed here and implemented in your branch seem much better than the current interface, and well thought out. I feel like we could pretty easily wire it into the existing Logger class without introducing a new class and new macros though, and without needing to change validation & util code.\n\nI wonder if there may be difficulties doing that I'm not aware of, or if it just seemed easier to start with a clean state in the current branch.\n\nI do think it would preferable to have one Logger class and one set of macros instead of two. I also think using kernel logging functions in util code (only `src/util/fs_helpers.cpp` right now but it seems like usage might expand) would probably not be desirable, since the dependency is supposed  to to the other way with kernel depending on util, not util depending on kernel. Also, the wallet and GUI are supposed to use util but should not depend on the kernel. This could be another reason to want to try improving the `Logger` class instead of replacing it.",
          "created_at": "2025-12-12T16:24:02Z"
        },
        {
          "user": "stickies-v",
          "body": "Thanks for looking into this, @ryanofsky! Upgrading vs separating is indeed the important decision to make here. I initially started wiring it into the existing `Logger` class, but changed my approach when I realized that when `kernel` becomes its own project, they will each need to have their own code anyway. Complicating `node` logging to accommodate kernel's different requirements, to then take it away again, feels like unnecessary friction and code complexity (e.g. plumbing a level-based system on top of a cateogory-level-based system). On the other hand, prematurely optimizing for a future split that may never happen is a risk. _(note: I don't think we're prematurely optimizing, because the kernel logger is so light-weight)_\n\nA different approach that I'm happy to explore, and I think could make more sense than wiring low-level `kernel` into higher-level `node` logging, is to ~move the `kernel::Logger` to `util::Logger`, and have _all_ logging (instead of just `kernel`) go through these structured callbacks. This way, the low-level logging interface is in `util`, and all the opinionated node stuff (i/o, ratelimiting, log formatting, ...) would live in `common`. This would mean node logging fundamentally also becomes level-based (i.e. debug string formatting is all-or-nothing), but I think that's a pretty small price to pay?\n\n> and new macros though, and without needing to change validation\n\nIn the mvp branch, I chose new `KernelLog...` macros just to keep things straightforward, and I'd be open to using macro/compile flag magic to minimize the diff there. However, I think the reality is that logging signatures in kernel code will have to change (for every single callsite) to make it context-aware, so I don't think a new macro name is all that important?\n\n>  I also think using kernel logging functions in util code...\n\nI agree with most of your observations in this paragraph, and kernel macros should not be leaking into util, wallet, GUI. I think the proper solution here is to remove logging from util though. In my view, low-level (i.e. util) code should not be logging at all. I've implemented one way of doing that in https://github.com/bitcoin/bitcoin/compare/master...stickies-v:bitcoin:2025-12/util-no-logging. It seems the scope of that change is rather limited, but there are many approaches possible, so that would warrant its own discussion.\n",
          "created_at": "2025-12-15T12:47:12Z"
        },
        {
          "user": "sedited",
          "body": "Thanks for taking charge of this! The C interface you laid out looks really nice too and should be easier to wire against whatever is required.\n\n> hey will each need to have their own code anyway\n\nOne point that might be nice to mention here too is that we are also defining a bunch of categories that the kernel should not have to know about.\n\nReading through your comment, I actually like what you are laying out as an alternative. Maybe a refinement of that idea could be to split the logger into a low-level and high-level implementation. Both can be implemented as global instances for now. The low-level class could take care of formatting, level detection, and providing a unified macro for all users. It can then feed into a higher level class through a callback. For a global logger, this would mean we'd retain a global low level logger, and introduce a global higher-level instance. We only initialize the global callback into the higher level logger when it is actually required by the respective binary, similar to what we do currently with the translations. For the kernel library itself, we can then surface this callback to the user through the API with the interface you are suggesting here.\n\n> This would mean node logging fundamentally also becomes level-based (i.e. debug string formatting is all-or-nothing), but I think that's a pretty small price to pay?\n\nI'm not really following why we can't have a set of categories defined to filter against pre formatting. Are you suggesting this, because we'd ideally want to split off non-kernel categories?",
          "created_at": "2025-12-16T11:40:32Z"
        },
        {
          "user": "stickies-v",
          "body": "> The low-level class could take care of formatting, level detection, and providing a unified macro for all users. It can then feed into a higher level class through a callback.\n\nThat sounds like the new design I'm currently working on. So far, it seems like it'll be a much bigger code diff than the [seperation branch](https://github.com/bitcoin/bitcoin/compare/master...stickies-v:bitcoin:2025-12/kernel-logging-separation) (because a _lot_ of `logging.{h,cpp}` code will need to move around, but there should be 1) less duplication and 2) more contained logging logic, so I think overall this might work out nicely.\n\n> I'm not really following why we can't have a set of categories defined to filter against pre formatting. Are you suggesting this, because we'd ideally want to split off non-kernel categories?\n\nCategory filtering to me feels like a high-level (i/o) logging output concern rather than a low-level logging concern. We _could_ make the low-level interface filter based on categories, but that I think would needlessly clutter the interface for users that don't need it (incl kernel), so I'd much rather keep it purely levels-based. So for e.g. `node`, that would mean that if only a single debug category is enabled, all debug logs would be formatted*, but only the one enabled category printed. Unless measurements indicate it really is too much overhead, I think that's not going to be a big deal when you're in debug mode already?\n\n*note: there are 2 formatting steps: 1 the `LogInfo(fmt, args...)` formatting, and then 2) the formatting where we produce a single string containing timestamp, level, msg, ... I'm generally talking about the first step. The second is of course only done when needed.",
          "created_at": "2025-12-16T12:25:01Z"
        },
        {
          "user": "stickies-v",
          "body": "I have implemented a new approach (\"Layering\") in https://github.com/bitcoin/bitcoin/compare/master...stickies-v:bitcoin:2025-12/kernel-logging-layering. The Layering approach turned out much less invasive than my initial attempts showed, and now has my preference.\n\nIn a nutshell:\n- we distinguish between a (low-level) logger that produces log statements (`util::log::Logger`) and (higher-level) log sinks (`BCLog::Sink`, `btck_LoggingConnection`) that consume the logs by registering a callback on the logger.\n- the `bitcoinkernel.h` API is ~identical between both versions, as are the `util::log::Logger` and `kernel::Logger` interfaces\n- the total diff is quite small, ~500 lines diff excluding tests, including complete removal of `logging.{h,cpp}` from kernel\n\nConceptually, it's quite similar to the earlier Separation approach, but just organizes the code differently, reducing code churn and duplication.\n\n@ryanofsky I think this addresses your [concerns](https://github.com/bitcoin/bitcoin/issues/34062#issuecomment-3647259207) about duplicated macros, about util code depending on kernel code, and about minimizing changes to validation and util code. It still introduces a new class, I don't immediately see an elegant way around that that also allows `kernel` to not depend on node logging code. Does that seem like a reasonable enough trade-off to you to warrant opening a PR and discuss the details?\n\nI'll open a PR if/when people are happy about the concept and initial approach, that's probably a better place to discuss code in more depth.\n",
          "created_at": "2025-12-17T21:08:34Z"
        },
        {
          "user": "sedited",
          "body": "> I'll open a PR if/when people are happy about the concept and initial approach, that's probably a better place to discuss code in more depth.\n\nThis newest approach looks good to me. I think some people might still have reservations about unconditionally logging all categories. I tend to agree with your opinion on this though. Once debug logging is activated, expectations on string serialization overhead should be the same, no matter the category selected.",
          "created_at": "2025-12-17T21:54:27Z"
        },
        {
          "user": "ajtowns",
          "body": "> I have implemented this approach in [master...stickies-v:bitcoin:2025-12/kernel-logging-separation](https://github.com/bitcoin/bitcoin/compare/master...stickies-v:bitcoin:2025-12/kernel-logging-separation)\n\nGross. Changing all the validation logs prefix the macro with `Kernel` and changing `BCLog::` to `kernel::Category` is not an improvement.\n\n> * **D2:** levels-based filtering has some performance overhead by formatting all (kernel) debug log strings instead of just the subset of categories specified.\n\nThat pretty much destroys the use case of Trace logging which is intended for high-rate logging that's probably not performant enough for regular usage. Which is fine today, because we only do trace logging in the wallet. But being able to do it for mempool analysis/debugging would also be useful.\n\nLikewise for:\n\n> Category filtering to me feels like a high-level (i/o) logging output concern rather than a low-level logging concern.\n\nThat's not the case.\n\nAs far as the problem statements go:\n\n> * **P1**: [callbacks](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L304) operate on formatted strings,\n\nOutside of the kernel, the callbacks are only used in tests, so changing how the callbacks work seems trivial, not justification for a major rework.\n\n>     * **P2**: the [filtering interface](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L737) is not really intuitive, requiring users to call combinations of `btck_logging_set_level_category` and `btck_logging_enable_category` when they want to produce `debug` or `trace` logs.\n\nThat interface isn't a good design even for the node software. #34038 removes it from being exposed to users (via the `-loglevel` config option), so that a [followup](https://github.com/ajtowns/bitcoin/tree/202512-log-atomic) can simplify it further.\n\nAt that point, having `btck_logging_trace(VALIDATION)` or `btck_logging_setlevel(VALIDATION, TRACE)` to enable trace logging for validation at a cost of slower validation, seems fine to me.\n\n> I propose we address problems P1, P2 and P3 by completely separating the kernel logging infrastructure from the node logging infrastructure. Roughly, this would mean:\n> \n>     1. Implement a minimal `kernel::Logger` interface\n\nThis seems exactly backwards to me; I would instead have approached it as \"let's rip out the node specific stuff from logging into node/loghandler, and have it register itself in a similar way to how kernel users will register their log handling code\".",
          "created_at": "2025-12-20T04:20:50Z"
        },
        {
          "user": "ajtowns",
          "body": "> Outside of the kernel, the callbacks are only used in tests, so changing how the callbacks work seems trivial, not justification for a major rework.\n\nFor example, https://github.com/ajtowns/bitcoin/commit/57e6ba1739dff27b78819fbb9594ec88daff609f",
          "created_at": "2025-12-21T03:08:35Z"
        },
        {
          "user": "stickies-v",
          "body": "I have updated the [Issue description](https://github.com/bitcoin/bitcoin/issues/34062#issue-3723882082) to reflect the [new layering approach](https://github.com/bitcoin/bitcoin/issues/34062#issuecomment-3667169341) that minimizes churn and code duplication, wiring all logging into a low-level `util::log::Logger` addressing review feedback ([1](https://github.com/bitcoin/bitcoin/issues/34062#issuecomment-3647259207), [2](https://github.com/bitcoin/bitcoin/issues/34062#issuecomment-3660108518)) \n\n---\n\n@ajtowns thank you for the review, and apologies for the slow response - I was off for a little while. I wish I'd updated the Issue description earlier, because I think a lot of your concerns were already addressed in the new approach. Apologies for not doing that earlier.\n\n> For example, https://github.com/ajtowns/bitcoin/commit/57e6ba1739dff27b78819fbb9594ec88daff609f\n\nStructured callbacks can be done with a much smaller diff indeed, but I think it doesn't address two concerns:\n1) a lot of the `node` logging logic is irrelevant for `kernel` (e.g. non-kernel categories, ratelimiting, string formatting, ...), so keeping `node` logging logic separate would be good\n2) it limits how much we can simplify the `bitcoinkernel` logging interface, forcing the user to do category configuration\n\n> This seems exactly backwards to me; I would instead have approached it as \"let's rip out the node specific stuff from logging into node/loghandler, and have it register itself in a similar way to how kernel users will register their log handling code\".\n\nAgreed, see [an earlier update](https://github.com/bitcoin/bitcoin/issues/34062#issuecomment-3667169341) (which is now the documented approach in this Issue).\n\n> That pretty much destroys the use case of Trace logging which is intended for high-rate logging that's probably not performant enough for regular usage. Which is fine today, because we only do trace logging in the wallet. But being able to do it for mempool analysis/debugging would also be useful.\n\nMy understanding of your concern is: \"with level-only filtering at the low (`util::log::Logger`) level, enabling `Trace` means paying formatting overhead for all trace logs regardless of category, making high-frequency trace logging impractical.\" Is my understanding correct? I think we'll have to add a LOT more `Trace` logging before that actually becomes a concern. I'm not sure we ever will, but if/when we ever need it, I think that can still be easily addressed later by adding a category filter predicate to `util::log::Logger`? Optimizing for that now seems premature to me? _(Just in case there's any confusion, my suggested approach still uses levels-based filtering to avoid unnecessary log string formatting.)_",
          "created_at": "2026-01-05T11:07:15Z"
        }
      ]
    },
    {
      "number": 34056,
      "title": "Wallet RPC semantics: gettransaction.confirmations returns large negative values for RBF-replaced transactions (undocumented behavior)",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nWhen using Replace-By-Fee (RBF) in combination with wallet rescans, the wallet RPC reports transactions with negative confirmation counts (e.g. -900, -1200), long after the replacing transaction has been confirmed.\n\nThese negative confirmation values persist even when:\n- the replacement transaction is deeply confirmed\n- the original transaction is fully conflicted and no longer in the mempool\n- wallet balances and UTXO sets are otherwise correct\n\nThe negative value appears to encode ‚Äúdistance since replacement‚Äù rather than an actual confirmation count.\n\n\n### Expected behaviour\n\nOnce a transaction has been replaced via RBF and the replacement transaction is confirmed, the original transaction should report a stable and documented state.\n\nSpecifically:\n- `confirmations` should not become increasingly negative over time\n- confirmation values should have a clear and documented semantic meaning\n- wallet RPC consumers should not need to infer hidden meanings from confirmation numbers\n\n\n### Steps to reproduce\n\n1. Create a wallet on regtest\n2. Send a transaction with BIP125 replaceable flag enabled\n3. Trigger a wallet rescan\n4. Perform a bumpfee (RBF replacement)\n5. Mine blocks to deeply confirm the replacement transaction\n6. Query `gettransaction` for the original transaction\n\nObservation:\nThe original transaction reports large negative confirmation counts (e.g. -900, -1200), even though the replacement transaction is confirmed.\n\n\n- regtest mode\n- default wallet settings\n- descriptor wallet\n- RBF enabled\n- wallet rescan invoked via RPC\n\n\n### Relevant log output\n\nSee attached JSON excerpts showing:\n- negative confirmation values\n- walletconflicts\n- replaced_by_txid relationships\n\nThe following excerpts show a replaced RBF transaction reporting large negative\nconfirmation counts long after its replacement has been deeply confirmed.\nThere is no chain reorg and wallet balances are correct.\n\nThe negative confirmation value continues to decrease as new blocks are mined,\neven though the replacing transaction is already confirmed.\n\nThis raises a question about RPC semantics: is `confirmations` for replaced\ntransactions intended to represent a negative distance to the replacing\ntransaction‚Äôs confirmation height, and if so, where is this behavior documented?\n\n\n[gettransaction.json](https://github.com/user-attachments/files/24125876/gettransaction.json)\n[gettransaction-replace.txt](https://github.com/user-attachments/files/24125875/gettransaction-replace.txt)\n[getbalance.txt](https://github.com/user-attachments/files/24125874/getbalance.txt)\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nv27.0\n\n### Operating system and version\n\nUbuntu 22.04 LTS\n\n### Machine specifications\n\nx86_64 system, local regtest environment, SSD storage\n",
      "state": "closed",
      "user": "husstege-e",
      "created_at": "2025-12-12T11:12:57Z",
      "updated_at": "2025-12-12T11:54:56Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34056",
      "labels": [
        "Docs",
        "Wallet",
        "RPC/REST/ZMQ",
        "Questions and Help"
      ],
      "comment_list": [
        {
          "user": "maflcko",
          "body": "> undocumented\n\nTo get the documentation, you can use the `help` RPC. It will explain and document the output. E.g.\n\n```\n  \"confirmations\" : n,              (numeric) The number of confirmations for the transaction. Negative confirmations means the\n                                    transaction conflicted that many blocks ago.",
          "created_at": "2025-12-12T11:54:46Z"
        }
      ]
    },
    {
      "number": 34055,
      "title": "Showing error:- Error unlocking wallet: some keys decrypt but not all. Your wallet file may be corrupt.",
      "body": "When i am trying to transfer funds from my bitcoin core wallet it is showing a error which says:- Error unlocking wallet: some keys decrypt but not all. Your wallet file may be corrupt.\nIt is also showing the same error in console of bitcoin core app after entering passphrase when i tried to dumpwallet\n\n![Image](https://github.com/user-attachments/assets/e2141d24-15f9-45a4-b315-eab1e14c8eb3)\n\n![Image](https://github.com/user-attachments/assets/6feae494-3bbd-4484-8bf4-1d125c36d85f)\n\n1. Does it means mine wallet.dat is corrupt?\n2. Password is wrong ?\n3. bitcoin core is not synced fully ?\n\nPlease Help me",
      "state": "closed",
      "user": "Manishdudi700",
      "created_at": "2025-12-12T10:12:23Z",
      "updated_at": "2025-12-12T10:41:30Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34055",
      "labels": [
        "Wallet",
        "Data corruption",
        "Questions and Help"
      ],
      "comment_list": [
        {
          "user": "maflcko",
          "body": "> 1. Does it means mine wallet.dat is corrupt?\n> \n>     2. Password is wrong ?\n> \n>     3. bitcoin core is not synced fully ?\n> \n> \n> Please Help me\n\n\n\nWhen it says \"Error unlocking wallet: some keys decrypt but not all. Your wallet file may be corrupt.\", then it means \"Error unlocking wallet: some keys decrypt but not all. Your wallet file may be corrupt.\".\n\nYou can continue at your own risk, but my recommendation would be to backup your wallet.dat, and also restore an old backup and double check if everything is correct.\n\n",
          "created_at": "2025-12-12T10:40:59Z"
        },
        {
          "user": "maflcko",
          "body": "Usually the issue tracker is used to track technical issues related to the Bitcoin Core code base.\n\nGeneral bitcoin questions and/or support requests are best directed to the [Bitcoin StackExchange](https://bitcoin.stackexchange.com) or the `#bitcoin` IRC channel on Libera Chat, or one of the Bitcoin subreddits, or any other place that you feel is well suited.\n\n ",
          "created_at": "2025-12-12T10:41:12Z"
        }
      ]
    },
    {
      "number": 34052,
      "title": "Bitcoin to send field is nearly invisible",
      "body": "### Issues, reports or feature requests related to the GUI should be opened directly on the GUI repo\n\n- [x] I still think this issue should be opened here\n\n### Report\n\nBitcoin to send field is nearly invisible, it works, but the up and down arrows completely obfuscate the text area.",
      "state": "closed",
      "user": "memeticae",
      "created_at": "2025-12-12T00:11:38Z",
      "updated_at": "2025-12-12T00:22:14Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34052",
      "labels": [
        "GUI"
      ],
      "comment_list": [
        {
          "user": "pinheadmz",
          "body": "See https://github.com/bitcoin-core/gui/issues/906",
          "created_at": "2025-12-12T00:21:21Z"
        },
        {
          "user": "pinheadmz",
          "body": "Or otherwise search open issues in https://github.com/bitcoin-core/gui/issues before opening a new issue",
          "created_at": "2025-12-12T00:22:14Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 8,
    "issues": 5
  }
}