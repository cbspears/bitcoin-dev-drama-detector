{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T19:50:42.109077+00:00",
  "date": "2025-06-18",
  "pull_requests": [
    {
      "number": 32773,
      "title": "cmake: Create subdirectories in build tree in advance",
      "body": "While reviewing https://github.com/bitcoin/bitcoin/pull/32697, I noticed that symlink creation fails when the target subdirectory does not exist. In such cases, `file(CREATE_LINK ... COPY_ON_ERROR SYMBOLIC)` falls back to copying, which implicitly creates the required path. As a result, a single file is copied instead of symlinked for subdirectories in `test/functional`. \r\n\r\nThis PR ensures that necessary subdirectories are created in advance, so that subsequent symlink creation does not fail due to missing paths.\r\n\r\nFor example:\r\n- on the master branch:\r\n```\r\n$ cmake -B build\r\n$ ls -l build/test/functional/mocks/\r\ntotal 8\r\n-rwxrwxr-x 1 hebasto hebasto 2683 Jul  3 14:11 invalid_signer.py\r\nlrwxrwxrwx 1 hebasto hebasto   64 Jul  3 14:11 multi_signers.py -> /home/hebasto/dev/bitcoin/test/functional/mocks/multi_signers.py\r\nlrwxrwxrwx 1 hebasto hebasto   60 Jul  3 14:11 no_signer.py -> /home/hebasto/dev/bitcoin/test/functional/mocks/no_signer.py\r\nlrwxrwxrwx 1 hebasto hebasto   57 Jul  3 14:11 signer.py -> /home/hebasto/dev/bitcoin/test/functional/mocks/signer.py\r\n```\r\n- with this PR:\r\n```\r\n$ cmake -B build\r\n$ ls -l build/test/functional/mocks/\r\ntotal 4\r\nlrwxrwxrwx 1 hebasto hebasto 65 Jul  3 13:51 invalid_signer.py -> /home/hebasto/dev/bitcoin/test/functional/mocks/invalid_signer.py\r\nlrwxrwxrwx 1 hebasto hebasto 64 Jul  3 13:51 multi_signers.py -> /home/hebasto/dev/bitcoin/test/functional/mocks/multi_signers.py\r\nlrwxrwxrwx 1 hebasto hebasto 60 Jul  3 13:51 no_signer.py -> /home/hebasto/dev/bitcoin/test/functional/mocks/no_signer.py\r\nlrwxrwxrwx 1 hebasto hebasto 57 Jul  3 13:51 signer.py -> /home/hebasto/dev/bitcoin/test/functional/mocks/signer.py\r\n```",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-06-18T19:52:41Z",
      "updated_at": "2025-11-07T17:22:17Z",
      "comments": 14,
      "url": "https://github.com/bitcoin/bitcoin/pull/32773",
      "labels": [
        "Build system",
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32773.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [m3dwards](https://github.com/bitcoin/bitcoin/pull/32773#issuecomment-3502318619) |\n| Stale ACK | [BrandonOdiwuor](https://github.com/bitcoin/bitcoin/pull/32773#pullrequestreview-3011416264), [janb84](https://github.com/bitcoin/bitcoin/pull/32773#pullrequestreview-3032634011) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-06-18T19:52:44Z"
        },
        {
          "user": "maflcko",
          "body": "would it make sense to at least replace the recursive glob with a normal glob now, iterating over the given folders, given that they are listed anyway?",
          "created_at": "2025-06-18T20:01:48Z"
        },
        {
          "user": "hebasto",
          "body": "> would it make sense to at least replace the recursive glob with a normal glob now, iterating over the given folders, given that they are listed anyway?\r\n\r\nSure! Added a commit.",
          "created_at": "2025-06-19T09:31:30Z"
        },
        {
          "user": "janb84",
          "body": "Any hints how to verify / test this ? \r\n\r\nHave tried to see any difference between this PR and master but it's not clear to me what difference I should see. \r\nWhen used on #32697 there is a difference that without this PR `build/test/functional/data/util/*` is populated with this PR the util directory is not being created (looking at the source this is logical but unsure if there needs to be things done after 32697 is merged or not having the directory is intentional ) ",
          "created_at": "2025-06-23T17:37:36Z"
        },
        {
          "user": "purpleKarrot",
          "body": "Is this setting up the environment for tests to run? Ideally, things like that should be done as [test fixture](https://cmake.org/cmake/help/latest/prop_test/FIXTURES_REQUIRED.html) and not executed during build system generation.",
          "created_at": "2025-06-24T10:01:14Z"
        },
        {
          "user": "hebasto",
          "body": "Rebased.\r\n\r\n@janb84 \r\n> Any hints how to verify / test this ?\r\n> \r\n> Have tried to see any difference between this PR and master but it's not clear to me what difference I should see. When used on #32697 there is a difference that without this PR `build/test/functional/data/util/*` is populated with this PR the util directory is not being created (looking at the source this is logical but unsure if there needs to be things done after 32697 is merged or not having the directory is intentional )\r\n\r\nI've updated the PR description with the relevant example.\r\n\r\n@purpleKarrot \r\n> Is this setting up the environment for tests to run? Ideally, things like that should be done as [test fixture](https://cmake.org/cmake/help/latest/prop_test/FIXTURES_REQUIRED.html) and not executed during build system generation.\r\n\r\nAt this moment, functional tests are not managed by ctest/cmake.",
          "created_at": "2025-07-03T13:16:31Z"
        },
        {
          "user": "hebasto",
          "body": "Rebased to resolve conflict with merged https://github.com/bitcoin/bitcoin/pull/32881.",
          "created_at": "2025-07-17T15:43:37Z"
        },
        {
          "user": "hebasto",
          "body": "The [feedback](https://github.com/bitcoin/bitcoin/pull/32773#discussion_r2491364489) from @m3dwards has been addressed.",
          "created_at": "2025-11-04T21:14:05Z"
        },
        {
          "user": "m3dwards",
          "body": "ACK 76dae5d6911b600fafa3a417a740f14b299284f3\r\n\r\nTested on arm Mac.",
          "created_at": "2025-11-07T12:37:28Z"
        },
        {
          "user": "fanquake",
          "body": "cc @purpleKarrot ",
          "created_at": "2025-11-07T12:39:14Z"
        },
        {
          "user": "purpleKarrot",
          "body": "My position is that code like this is **not** something that belongs in a `CMakeLists.txt` file.\r\n\r\nIdeally, tests should have their environment set up in a way that they find necessary files in the source tree, without any symlinks or copies.\r\n\r\nIf directories/symlinks are needed by tests that are executed with ctest, a temporary workaround could be to create them in a test fixture, like I mentioned [here](https://github.com/bitcoin/bitcoin/pull/32773#issuecomment-2999638262).\r\n\r\nAs long as functional tests are launched by some other means (like a shell script) the directories and symlinks should be created by that script.",
          "created_at": "2025-11-07T15:48:50Z"
        },
        {
          "user": "maflcko",
          "body": "> Ideally, tests should have their environment set up in a way that they find necessary files in the source tree, without any symlinks or copies.\r\n\r\nI think there is no explanation in the code, but the reason why the copies/symlinks are created is that it keeps the source dir clean of `.pyc` files. \r\n\r\n\r\n\r\n> If directories/symlinks are needed by tests that are executed with ctest, a temporary workaround could be to create them in a test fixture, like I mentioned [here](https://github.com/bitcoin/bitcoin/pull/32773#issuecomment-2999638262).\r\n\r\nThey are not executed with ctest, so a fixture can not be used.\r\n\r\n\r\n\r\n> As long as functional tests are launched by some other means (like a shell script) the directories and symlinks should be created by that script.\r\n\r\nThe functional tests are launched by a runner. However, it is also possible to run individual tests. So they are stand-alone scripts and so they can't create their own symlink.",
          "created_at": "2025-11-07T16:24:15Z"
        },
        {
          "user": "purpleKarrot",
          "body": "> I think there is no explanation in the code, but the reason why the copies/symlinks are created is that it keeps the source dir clean of `.pyc` files.\r\n\r\nThe generation of `.pyc` files can be suppressed with python's `-B` option or `PYTHONDONTWRITEBYTECODE` env var.\r\nSee: https://docs.python.org/3/using/cmdline.html#envvar-PYTHONDONTWRITEBYTECODE",
          "created_at": "2025-11-07T17:11:23Z"
        },
        {
          "user": "maflcko",
          "body": "I know, but `-B` does not help to fix the other problems: (1) They are not run via ctest, and (2) they are stand-alone scripts, where the user/dev would have to specify it every time, or set the env var. ",
          "created_at": "2025-11-07T17:22:17Z"
        }
      ]
    },
    {
      "number": 32772,
      "title": "fuzz: wallet: remove `FundTx` from `FuzzedWallet`",
      "body": "`FundTx` was used by the `wallet_notifications` target which we recently removed. So it's now unused and can be removed.",
      "state": "closed",
      "user": "brunoerg",
      "created_at": "2025-06-18T19:21:18Z",
      "updated_at": "2025-10-30T13:58:11Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/pull/32772",
      "labels": [
        "Tests",
        "Fuzzing"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32772.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [maflcko](https://github.com/bitcoin/bitcoin/pull/32772#issuecomment-2985522773), [dergoegge](https://github.com/bitcoin/bitcoin/pull/32772#pullrequestreview-2942377696), [kevkevinpal](https://github.com/bitcoin/bitcoin/pull/32772#issuecomment-2988095843) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32750](https://github.com/bitcoin/bitcoin/pull/32750) (refactor: CFeeRate encapsulates FeeFrac internally by polespinasa)\n* [#32618](https://github.com/bitcoin/bitcoin/pull/32618) (wallet: Remove ISMINE_WATCHONLY and watchonly from RPCs by achow101)\n* [#32523](https://github.com/bitcoin/bitcoin/pull/32523) (wallet: Remove watchonly behavior and isminetypes by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-06-18T19:21:22Z"
        },
        {
          "user": "brunoerg",
          "body": "cc @maflcko ",
          "created_at": "2025-06-18T19:22:11Z"
        },
        {
          "user": "maflcko",
          "body": "lgtm ACK cd1ae1b4dfdb1bb11dec2558448a453f43cb2ac3",
          "created_at": "2025-06-18T19:55:21Z"
        },
        {
          "user": "kevkevinpal",
          "body": "ACK [cd1ae1b](https://github.com/bitcoin/bitcoin/pull/32772/commits/cd1ae1b4dfdb1bb11dec2558448a453f43cb2ac3)\r\n\r\nmakes sense to remove dead code",
          "created_at": "2025-06-19T13:25:17Z"
        }
      ]
    },
    {
      "number": 32771,
      "title": "contrib: tracing: Fix read of `pmsg_type` in p2p_monitor.py",
      "body": "This fixes a bug in the contrib tracing script `p2p_monitor.py`. currently the script fails to read the `msg_type` of inbound and outbound messages, which is useful in the per-peer message view.\r\n\r\n<details>\r\n<summary>Screenshot of p2p_monitor.py on master</summary>\r\n\r\n![Screenshot From 2025-06-18 11-37-43](https://github.com/user-attachments/assets/56612088-54d7-465c-b0b6-1b425b919785)\r\n</details>\r\n\r\n\r\n<details>\r\n<summary>Screenshot of p2p_monitor.py on this branch</summary>\r\n\r\n![Screenshot From 2025-06-18 11-41-38](https://github.com/user-attachments/assets/4438a483-938c-450b-a12e-6d6909b2c37e)\r\n\r\n</details>\r\n\r\n",
      "state": "closed",
      "user": "davidgumberg",
      "created_at": "2025-06-18T18:45:12Z",
      "updated_at": "2025-06-23T09:03:21Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/pull/32771",
      "labels": [
        "Scripts and tools"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32771.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [janb84](https://github.com/bitcoin/bitcoin/pull/32771#pullrequestreview-2941951210), [0xB10C](https://github.com/bitcoin/bitcoin/pull/32771#pullrequestreview-2944847773), [yuvicc](https://github.com/bitcoin/bitcoin/pull/32771#issuecomment-2992851936) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-06-18T18:45:17Z"
        },
        {
          "user": "yuvicc",
          "body": "Concept ACK \r\n\r\nIt would be good to have the message type with the size of message in `p2p_monitor.py`",
          "created_at": "2025-06-20T20:38:09Z"
        },
        {
          "user": "yuvicc",
          "body": "ACK 3473986fe10e2689fe36cc93e1e50013649ac14b\r\n\r\n## Testing\r\n\r\n### On master\r\n\r\n<details>\r\n<summary>Screenshot</summary>\r\n\r\n![Screenshot from 2025-06-21 02-21-57](https://github.com/user-attachments/assets/e79fe784-1181-4475-827b-1de583fd0936)\r\n\r\n</details>\r\n\r\n### commit 3473986fe10e2689fe36cc93e1e50013649ac14b\r\n\r\n<details>\r\n<summary>Screenshot</summary>\r\n\r\n![Screenshot from 2025-06-21 02-31-21](https://github.com/user-attachments/assets/c886684e-7ce0-4cc8-9ab4-14e8bc226f2b)\r\n\r\n</details>",
          "created_at": "2025-06-20T21:03:15Z"
        },
        {
          "user": "fanquake",
          "body": "Backported to 29.x in #32589.",
          "created_at": "2025-06-23T09:03:21Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 32770,
      "title": "Slow unit tests delay functional tests and leave CPU unused",
      "body": "When running the unit and functional tests under a sanitizer (as done in some CI tasks), the CPU usage could be better. Currently, one or two slow running unit tests idle along on a single CPU thread. \n\nCan be seen in this graph, which shows an initial spike during compilation, then the slow unit tests, and finally the functional test CPU usage:\n![Image](https://github.com/user-attachments/assets/66e21580-24d4-474f-9a95-b704f964f4cf)\n\nIt would be nice to somehow fix this. Options are:\n\n* Speed up the unit tests (not sure how easy this is, or if this is possible at all)\n* Run the functional tests along with the ctest-tests in parallel somehow\n* Something else?",
      "state": "open",
      "user": "maflcko",
      "created_at": "2025-06-18T13:07:41Z",
      "updated_at": "2026-01-06T14:14:52Z",
      "comments": 18,
      "url": "https://github.com/bitcoin/bitcoin/issues/32770",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "willcl-ark",
          "body": "I have noticed similar when investigating tangential Ci changes. It is possible to run more unit tests in parallel, but we still always wait for the slowest test.\n\nIf I recall itâ€™s a secp256 test, and there was perhaps a suggestion to disable it (mostly), or have it run weekly or something?",
          "created_at": "2025-06-18T13:14:58Z"
        },
        {
          "user": "maflcko",
          "body": "Looking at https://github.com/bitcoin/bitcoin/actions/runs/15714959524/job/44282297642#step:6:4481, it seems there are several affected tests:\n\n```\n...\n135/142 Test  #66: net_tests ............................   Passed  243.14 sec\n136/142 Test #139: wallet_tests .........................   Passed  108.31 sec\n137/142 Test #138: wallet_crypto_tests ..................   Passed  116.03 sec\n138/142 Test   #5: secp256k1_noverify_tests .............   Passed  426.46 sec\n139/142 Test #129: coinselector_tests ...................   Passed  268.56 sec\n140/142 Test   #9: bench_sanity_check ...................   Passed  487.70 sec\n141/142 Test  #32: coins_tests ..........................   Passed  559.64 sec\n142/142 Test   #6: secp256k1_tests ......................   Passed  590.82 sec\n```\n\nedit:\n\nTsan:\n\n```\n[20:37:36.776] 136/142 Test  #32: coins_tests ..........................   Passed  122.51 sec\n[20:37:38.388] 137/142 Test  #30: checkqueue_tests .....................   Passed  124.34 sec\n[20:37:46.297] 138/142 Test #139: wallet_tests .........................   Passed   29.87 sec\n[20:38:40.235] 139/142 Test   #9: bench_sanity_check ...................   Passed  193.33 sec\n[20:38:42.459] 140/142 Test #129: coinselector_tests ...................   Passed   98.51 sec\n[20:42:20.591] 141/142 Test   #5: secp256k1_noverify_tests .............   Passed  413.70 sec\n[20:48:11.703] 142/142 Test   #6: secp256k1_tests ......................   Passed  764.81 sec\n```\n\nmsan:\n\n```\n[13:02:32.115] 134/141 Test  #31: coins_tests ..........................   Passed   98.23 sec\n[13:02:40.482] 135/141 Test #138: wallet_tests .........................   Passed   22.38 sec\n[13:02:53.347] 136/141 Test #114: txvalidationcache_tests ..............   Passed   67.72 sec\n[13:03:29.497] 137/141 Test #128: coinselector_tests ...................   Passed   78.19 sec\n[13:03:32.923] 138/141 Test  #29: checkqueue_tests .....................   Passed  163.40 sec\n[13:04:12.828] 139/141 Test   #8: bench_sanity_check ...................   Passed  207.55 sec\n[13:05:08.881] 140/141 Test   #5: secp256k1_noverify_tests .............   Passed  263.61 sec\n[13:08:27.015] 141/141 Test   #6: secp256k1_tests ......................   Passed  461.74 sec\n```",
          "created_at": "2025-06-18T13:38:37Z"
        },
        {
          "user": "willcl-ark",
          "body": "It would be helpful to know when we should run these secp256k1 tests in this repo. I think they are run in the libsecp repo as part of CI based on [`make \"$BUILD\"` defaulting to `make check`](https://github.com/bitcoin-core/secp256k1/blob/95db29b144b7708dc93e90e2c157ec3a67695cef/.github/workflows/ci.yml#L22), but I've not verified too closely.\n\nI am not sure I see any point to re-running them here on every change. What sounds more sensible to me is to build and run them on subtree updates only. I have a demo branch adding such a CI job which I can tidy and open as a PR, if something like this is wanted?\n\nThis perhaps won't \"fix\" this issue entirely, but should make a difference of a few minutes per job on a few of our jobs.",
          "created_at": "2025-06-19T15:08:06Z"
        },
        {
          "user": "maflcko",
          "body": "> I am not sure I see any point to re-running them here on every change. What sounds more sensible to me is to build and run them on subtree updates only. I have a demo branch adding such a CI job which I can tidy and open as a PR, if something like this is wanted?\n\nNo objection from my side.\n\n\n\n> This perhaps won't \"fix\" this issue entirely\n\nI guess the easiest fix would be to call `ctest --test-dir ./bld-cmake --show-only=human` from the functional test runner and then run those listed in separate processes (when an option like `--run-ctest-tests`) is given?",
          "created_at": "2025-06-19T15:43:02Z"
        },
        {
          "user": "willcl-ark",
          "body": "I opened a draft for disabling the secp256 tests by default, running them only on subtree updates.\n\nRegarding running unit tests from the functional tests, the simplest would probably be to run `ctest --test-dir build -j$(nproc)` using a new process from `multiprocessing`, then dump stdout/stderr in the results section and forward on the return code (if non-zero) to the runner.\n\nBut it sounds like you are proposing something more like enumerating all tests and running them singly from the runner using the existing infrastructure?",
          "created_at": "2025-06-20T09:33:07Z"
        },
        {
          "user": "maflcko",
          "body": "yeah, I am not sure if it is fine to double prarallelize (nproc unit tests at the same time with nproc functional tests), but I guess it just means the early launced functional tests will be a bit slower, which should be fine",
          "created_at": "2025-06-20T09:37:13Z"
        },
        {
          "user": "willcl-ark",
          "body": "It appears to work on my machine OK running them both with `nproc` in parallel. In fact on my 16 core machine I can run ctest at `-j16` and `test_runner.py --jobs=20` together without issue.\n\nJust to be clear, would we want the `ctest` output included and integrated in the `test_runner` results section? If so this will I think involve parsing the ctest output (and therefore more code). If we are happy just to run it using multiprocess and dump stdout/err at the end, and record the exit code, the change will be a fair bit smaller (but the output possibly messier!) ",
          "created_at": "2025-06-20T09:55:37Z"
        },
        {
          "user": "ajtowns",
          "body": "cf #32945 maybe?\n\nChanging test_runner.py from python to cmake logic might make running the functional and unit tests in parallel more plausible?",
          "created_at": "2025-07-17T00:23:42Z"
        },
        {
          "user": "maflcko",
          "body": "> cf [#32945](https://github.com/bitcoin/bitcoin/pull/32945) maybe?\n\nCan't hurt, but depending on the sanitizer, it is a different test that is the slowest: https://github.com/bitcoin/bitcoin/issues/32770#issuecomment-2984264066 so the approach would have to be done for other tests as well.\n\nSubmitted https://github.com/bitcoin/bitcoin/pull/33000 for the ci in the meantime.",
          "created_at": "2025-07-17T11:38:16Z"
        },
        {
          "user": "maflcko",
          "body": "`bench_sanity_check` could make sense to split up as well. With sanitizers enabled, it takes several minutes, even on fast hardware. See https://github.com/bitcoin/bitcoin/pull/28676#issuecomment-3146639801. So I created https://github.com/bitcoin/bitcoin/pull/33142",
          "created_at": "2025-08-06T08:46:58Z"
        },
        {
          "user": "fanquake",
          "body": "`coinselector_tests` is a good candidate for speedup, under Valgrind, it is the slowest after `bench_sanity_check`:\n```bash\n141/144 Test  #78: random_tests .........................   Passed  227.62 sec\n142/144 Test  #30: coins_tests_dbbase ...................   Passed  336.61 sec\n143/144 Test #130: coinselector_tests ...................   Passed  459.29 sec\n144/144 Test   #6: bench_sanity_check ...................   Passed  793.02 sec\n```\n\nSame for `wallet_miniscript.py` in the functional tests. Under Valgrind, it is the slowest test by at least 2x any other test. `tool_signet_miner.py` and `wallet_taproot.py` are also very slow.",
          "created_at": "2025-08-06T09:57:54Z"
        },
        {
          "user": "murchandamus",
          "body": "I started looking into that as it aligns well with one of my projects to migrate the `coinselector_tests` to an updated test suite `coinselection_tests`.",
          "created_at": "2025-08-06T20:30:02Z"
        },
        {
          "user": "murchandamus",
          "body": "In the context of `coinselector_tests` being slow, I found looking at some flamegraphs that much of the time is spent on Knapsack and BnB. I have a [rewrite of BnB](https://github.com/bitcoin/bitcoin/pull/32150) open, that I would expect to improve BnBâ€™s performance (and thus improve this testâ€™s performance, in case someone is interested to review) and I have been prototyping another coin selection algorithm that I hope will bring the last missing piece to obsolete Knapsack (consolidatory behavior at low feerates) for which I have recently refurbished the coin selection simulation framework and have been running some exploratory simulations. The migration of the first part of the `coinselector_tests` to `coinselection_tests`  was recently merged  via #29532, so I hope to get around to opening a PR for the next part soonish.",
          "created_at": "2025-08-06T22:16:24Z"
        },
        {
          "user": "fanquake",
          "body": "> Same for wallet_miniscript.py in the functional tests. Under Valgrind, it is the slowest test by at least 2x any other test. \n\nSeems to be ~4 times slower than the next slowest test: https://github.com/bitcoin/bitcoin/pull/33411#issuecomment-3302327390.",
          "created_at": "2025-09-17T10:27:56Z"
        },
        {
          "user": "maflcko",
          "body": "On the general topic, there was commit https://github.com/bitcoin/bitcoin/commit/636b611781154f32c8d7ae8ea301d12b1464c151, so someone could some time in the future check if it helps.",
          "created_at": "2025-10-16T07:33:18Z"
        },
        {
          "user": "furszy",
          "body": "On the libsecp notes, since https://github.com/bitcoin-core/secp256k1/pull/1734 we can parallelize tests. Tagging @hebasto as he had a patch to do it.",
          "created_at": "2025-10-16T13:35:01Z"
        },
        {
          "user": "hebasto",
          "body": "> On the libsecp notes, since [bitcoin-core/secp256k1#1734](https://github.com/bitcoin-core/secp256k1/pull/1734) we can parallelize tests. Tagging [@hebasto](https://github.com/hebasto) as he had a patch to do it.\n\nSee https://github.com/bitcoin-core/secp256k1/pull/1760.",
          "created_at": "2025-10-16T14:30:51Z"
        },
        {
          "user": "maflcko",
          "body": "https://github.com/bitcoin/bitcoin/pull/33142 was merged and the same approach could trivially be used for the unit tests, but there the motivating QA issues listed in the pulls description are less pressing for the unit tests right now, so I'll wait a few months before working on this again. In the meantime, /pull/33483 could be picked up.",
          "created_at": "2026-01-06T14:14:52Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 3,
    "issues": 1
  }
}