{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T20:18:12.368735+00:00",
  "date": "2025-09-28",
  "pull_requests": [
    {
      "number": 33487,
      "title": "ci: use latest versions of lint deps",
      "body": "Some of the versions used here are > 2 years old. i.e `mypy`. Use the latest avilable versions, except for LIEF, which is generally changed with Guix.\r\n\r\nSide note. I can't remember the last time one of these tools (mypy, ruff, vulture) actually caught an issue in the lint job.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-09-28T22:14:39Z",
      "updated_at": "2025-09-30T13:24:27Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/pull/33487",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33487.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [maflcko](https://github.com/bitcoin/bitcoin/pull/33487#issuecomment-3350234120), [janb84](https://github.com/bitcoin/bitcoin/pull/33487#pullrequestreview-3282863818), [hebasto](https://github.com/bitcoin/bitcoin/pull/33487#pullrequestreview-3282958097) |\n| Stale ACK | [stickies-v](https://github.com/bitcoin/bitcoin/pull/33487#pullrequestreview-3280415193) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-09-28T22:14:43Z"
        },
        {
          "user": "maflcko",
          "body": "> Side note. I can't remember the last time one of these tools (mypy, ruff, vulture) actually caught an issue in the lint job.\r\n\r\nThe last thing mypy found was a false positive: https://github.com/bitcoin/bitcoin/pull/33201#issuecomment-3192610057 and https://github.com/bitcoin/bitcoin/pull/33201#discussion_r2284671990\r\n\r\nRuff is doing basically all python checks and finds stuff frequently: E.g. https://github.com/bitcoin/bitcoin/pull/33270#issuecomment-3236372196\r\n\r\nvulture is only doing small checks, so I am not sure either.",
          "created_at": "2025-09-29T07:33:42Z"
        },
        {
          "user": "maflcko",
          "body": "lgtm ACK aeab2c7f1d151beda3eff94fb4effc85a4d4a344",
          "created_at": "2025-09-29T07:34:31Z"
        },
        {
          "user": "maflcko",
          "body": "lgtm ACK d4f47f97715c7b6a2879e99c62f09ccead8cc4cd",
          "created_at": "2025-09-30T06:51:16Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 33488,
      "title": "[29.x] guix build failure on ppc with xcb",
      "body": "Doing a guix build on the 29.x branch (both with v29.1, v29.2rc1 and f6d49d0a0995ad736c3462bb5cd9d2177d77c970) fails for me on powerpc (and powerpcle) seemingly related to xcb. Previous failures have just given me an error abort after some xcb install commands without indicating what failed, the latest failure gave this error:\n\n```\nchecking that generated files are newer than configure... done\nconfigure: creating ./config.status\nconfig.status: creating Makefile\nconfig.status: creating xkbcommon.pc\nconfig.status: creating xkbcommon-x11.pc\nconfig.status: creating doc/Doxyfile\nconfig.status: creating src/config.h\nconfig.status: src/config.h is unchanged\nconfig.status: executing depfiles commands\nconfig.status: executing libtool commands\n\n        libxkbcommon 0.8.4\n\n        libxkbcommon:            yes\n        libxkbcommon-x11:        yes\n        Wayland utilities:       no\n        documentation:           no\n\n        default XKB rules:       evdev\n        default XKB model:       pc105\n        default XKB layout:      us\n        default XKB variant:\n        default XKB options:\n\n        prefix:                  /bitcoin/depends/powerpc64-linux-gnu\n        includedir:              ${prefix}/include\n        lib dir:                 ${exec_prefix}/lib\n        datarootdir:             ${prefix}/share\n        XKB config root:         ${datarootdir}/X11/xkb\n        X11 locale root:         ${datarootdir}/X11/locale\n\nBuilding libxkbcommon...\nmake[1]: Entering directory '/bitcoin/depends/work/build/powerpc64-linux-gnu/libxkbcommon/0.8.4-527b23ff69b'\nmake  all-am\nmake[2]: Entering directory '/bitcoin/depends/work/build/powerpc64-linux-gnu/libxkbcommon/0.8.4-527b23ff69b'\n  CCLD     libxkbcommon-x11.la\npowerpc64-linux-gnu-ld: warning: /bitcoin/depends/powerpc64-linux-gnu/lib/libxcb-xkb.so has a corrupt string table index - ignoring\npowerpc64-linux-gnu-ld: error: /bitcoin/depends/powerpc64-linux-gnu/lib/libxcb-xkb.so: ELF section name out of range\ncollect2: error: ld returned 1 exit status\nmake[2]: *** [Makefile:1302: libxkbcommon-x11.la] Error 1\nmake[2]: Leaving directory '/bitcoin/depends/work/build/powerpc64-linux-gnu/libxkbcommon/0.8.4-527b23ff69b'\nmake[1]: *** [Makefile:1080: all] Error 2\nmake[1]: Leaving directory '/bitcoin/depends/work/build/powerpc64-linux-gnu/libxkbcommon/0.8.4-527b23ff69b'\nmake: *** [funcs.mk:303: /bitcoin/depends/work/build/powerpc64-linux-gnu/libxkbcommon/0.8.4-527b23ff69b/./.stamp_built] Error 2\nmake: Leaving directory '/bitcoin/depends'\n```",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2025-09-28T23:41:59Z",
      "updated_at": "2025-10-02T12:14:54Z",
      "comments": 8,
      "url": "https://github.com/bitcoin/bitcoin/issues/33488",
      "labels": [
        "Build system",
        "Upstream",
        "Questions and Help"
      ],
      "comment_list": [
        {
          "user": "maflcko",
          "body": "> Previous failures have just given me an error abort after some xcb install commands without indicating what failed, the latest failure gave this error:\n\nSo the failure is non-deterministic? Does it happen with a fully clean git repo?",
          "created_at": "2025-09-29T05:42:00Z"
        },
        {
          "user": "ajtowns",
          "body": "> > Previous failures have just given me an error abort after some xcb install commands without indicating what failed, the latest failure gave this error:\n> \n> So the failure is non-deterministic? Does it happen with a fully clean git repo?\n\nIt's part of the \"depends\" setup, which caches the downloaded source and build between runs afaics? I think that's the source of the differences in error. I tried it from a cleaned out checkout before, but will try again to see the exact error.",
          "created_at": "2025-09-29T06:23:37Z"
        },
        {
          "user": "ajtowns",
          "body": "Ah, there we go; these look like relevant lines:\n\n```\n$ HOSTS=powerpc64-linux-gnu contrib/guix/guix-build\n...\nxcb_auth.c:74:37: warning: initialization discards 'const' qualifier from pointer target type [-Wdiscarded-qualifiers]\n   74 | #define AUTH_PROTO_MIT_MAGIC_COOKIE \"MIT-MAGIC-COOKIE-1\"\n      |                                     ^~~~~~~~~~~~~~~~~~~~\nxcb_auth.c:80:5: note: in expansion of macro 'AUTH_PROTO_MIT_MAGIC_COOKIE'\n   80 |     AUTH_PROTO_MIT_MAGIC_COOKIE,\n      |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~\n...\nlibtool: warning: relinking 'libxcb-randr.la'\nlibtool: install: (cd /bitcoin/depends/work/build/powerpc64-linux-gnu/libxcb/1.14-3622160b92f/src; /bin/sh \"/bitcoin/depends/work/build/powerpc64-linux-gnu/libxcb/1.14-3622160b92f/libtool\"  --silent --tag CC --mode=relink powerpc64-linux-gnu-gcc -Wall -Wpointer-arith -Wmissing-declarations -Wformat=2 -Wstrict-prototypes -Wmissing-prototypes -Wnested-externs -Wbad-function-cast -Wold-style-definition -Wdeclaration-after-statement -Wunused -Wuninitialized -Wshadow -Wmissing-noreturn -Wmissing-format-attribute -Wredundant-decls -Wlogical-op -Werror=implicit -Werror=nonnull -Werror=init-self -Werror=main -Werror=missing-braces -Werror=sequence-point -Werror=return-type -Werror=trigraphs -Werror=array-bounds -Werror=write-strings -Werror=address -Werror=int-to-pointer-cast -Werror=pointer-to-int-cast -I//bitcoin/depends/powerpc64-linux-gnu/include -pipe -std=c11 -O2 -version-info 1:0:1 -no-undefined -L/bitcoin/depends/powerpc64-linux-gnu/lib -o libxcb-randr.la -rpath /bitcoin/depends/powerpc64-linux-gnu/lib randr.lo libxcb.la -inst-prefix-dir /bitcoin/depends/work/staging/powerpc64-linux-gnu/libxcb/1.14-3622160b92f)\n...\npowerpc64-linux-gnu-ld: warning: /bitcoin/depends/work/staging/powerpc64-linux-gnu/libxcb/1.14-3622160b92f/bitcoin/depends/powerpc64-linux-gnu/lib/libxcb.so has a corrupt string table index - ignoring\npowerpc64-linux-gnu-ld: error: /bitcoin/depends/work/staging/powerpc64-linux-gnu/libxcb/1.14-3622160b92f/bitcoin/depends/powerpc64-linux-gnu/lib/libxcb.so: ELF section name out of range\ncollect2: error: ld returned 1 exit status\nlibtool:   error: error: relink 'libxcb-randr.la' with the above command before installing it\nmake[4]: *** [Makefile:851: install-libLTLIBRARIES] Error 1\nmake[4]: *** Waiting for unfinished jobs....\n```\n\nThe \"install\" stuff I was seeing was the unfinished jobs, I guess, and I just didn't look carefully enough to find meatier errors.\n\nUsing guix 1.4.0-9 from debian unstable, on commit f6d49d0a0995ad736c3462bb5cd9d2177d77c970.",
          "created_at": "2025-09-29T06:33:33Z"
        },
        {
          "user": "willcl-ark",
          "body": "I suspect might be the same fundamental issue we saw here: https://github.com/bitcoin/bitcoin/pull/33494#issuecomment-3351288235\n\nWhere a cached package is found in depends (and used) despite the package definition having changed.\n\n@ajtowns do you have set/are you using `$BASE_CACHE` ?",
          "created_at": "2025-09-30T13:17:12Z"
        },
        {
          "user": "ajtowns",
          "body": "No? I just untarred the Xcode SDK in a clean environment, set HOSTS and ran guix-build. The depends/sources files all seem to match the hashes from depends/packages as far as I can see for what that's worth.",
          "created_at": "2025-09-30T16:42:34Z"
        },
        {
          "user": "willcl-ark",
          "body": "Ah I see.\n\nFWIW I am using the same guix version via nix but can't reproduce :(\n\n```\n[100%] Built target check-symbols\n-- Install configuration: \"RelWithDebInfo\"\n-- Installing: /distsrc-base/distsrc-f6d49d0a0995-powerpc64-linux-gnu/installed/bitcoin-f6d49d0a0995/bin/bitcoin-wallet\n-- Installing: /distsrc-base/distsrc-f6d49d0a0995-powerpc64-linux-gnu/installed/bitcoin-f6d49d0a0995/share/man/man1/bitcoin-wallet.1\n-- Installing: /distsrc-base/distsrc-f6d49d0a0995-powerpc64-linux-gnu/installed/bitcoin-f6d49d0a0995/bin/bitcoind\n-- Installing: /distsrc-base/distsrc-f6d49d0a0995-powerpc64-linux-gnu/installed/bitcoin-f6d49d0a0995/share/man/man1/bitcoind.1\n-- Installing: /distsrc-base/distsrc-f6d49d0a0995-powerpc64-linux-gnu/installed/bitcoin-f6d49d0a0995/bin/bitcoin-cli\n-- Installing: /distsrc-base/distsrc-f6d49d0a0995-powerpc64-linux-gnu/installed/bitcoin-f6d49d0a0995/share/man/man1/bitcoin-cli.1\n-- Installing: /distsrc-base/distsrc-f6d49d0a0995-powerpc64-linux-gnu/installed/bitcoin-f6d49d0a0995/bin/bitcoin-tx\n-- Installing: /distsrc-base/distsrc-f6d49d0a0995-powerpc64-linux-gnu/installed/bitcoin-f6d49d0a0995/share/man/man1/bitcoin-tx.1\n-- Installing: /distsrc-base/distsrc-f6d49d0a0995-powerpc64-linux-gnu/installed/bitcoin-f6d49d0a0995/bin/bitcoin-util\n-- Installing: /distsrc-base/distsrc-f6d49d0a0995-powerpc64-linux-gnu/installed/bitcoin-f6d49d0a0995/share/man/man1/bitcoin-util.1\n-- Installing: /distsrc-base/distsrc-f6d49d0a0995-powerpc64-linux-gnu/installed/bitcoin-f6d49d0a0995/bin/bitcoin-qt\n-- Installing: /distsrc-base/distsrc-f6d49d0a0995-powerpc64-linux-gnu/installed/bitcoin-f6d49d0a0995/share/man/man1/bitcoin-qt.1\n-- Installing: /distsrc-base/distsrc-f6d49d0a0995-powerpc64-linux-gnu/installed/bitcoin-f6d49d0a0995/bin/test_bitcoin\n```",
          "created_at": "2025-10-01T14:01:11Z"
        },
        {
          "user": "ajtowns",
          "body": "Running guix-build from a mostly clean build directly three times gives me these logs, if that helps:\n\nhttps://gist.github.com/ajtowns/e670603ba85bb7720cea8fc5e1215172\n\nMaybe my guix profile is corrupted or otherwise wrong somehow?",
          "created_at": "2025-10-02T00:33:58Z"
        },
        {
          "user": "maflcko",
          "body": "I'd try to setup a fresh guix (maybe in a container) and build from there to check if something is wrong with your CPU/memory or the guix install.\n\nIt should be roughly:\n\n```sh\ndocker run --privileged -it --rm ubuntu:24.04\n\n(inside the container, assuming the guix apt package still exists:)\n\nexport DEBIAN_FRONTEND=noninteractive && apt update && apt install git vim htop guix bash curl make -y && git clone https://github.com/bitcoin/bitcoin.git --depth=1 /bitcoin-core && cd /bitcoin-core && groupadd --system guixbuild && for i in `seq -w 1 10`; do useradd -g guixbuild -G guixbuild -d /var/empty -s `which nologin` -c \"Guix build user $i\" --system guixbuilder$i; done\nLC_ALL=en_US.UTF-8 guix-daemon --build-users-group=guixbuild &\n\nHOSTS=powerpc64-linux-gnu V=1 VERBOSE=1 ./contrib/guix/guix-build\n```\n\nIt works for me, but I am using different hardware, and I've updated the guix to a more recent one:\n\n```\n# uname --machine && find guix-build-$(git rev-parse --short=12 HEAD)/output/ -type f -print0 | env LC_ALL=C sort -z | xargs -r0 sha256sum\nriscv64\n46c169fb02a62391e8d31df45269152bb60185081333b9b345f02fe212d1673b  guix-build-f6d49d0a0995/output/dist-archive/bitcoin-f6d49d0a0995.tar.gz\n2355930789826759937046198efe16a5d01bb1d5e9f731bd46d4f7631e07685f  guix-build-f6d49d0a0995/output/powerpc64-linux-gnu/SHA256SUMS.part\n5a64896ef92dbeb29f37dcb4e5b3eb64e1c06d5fd64c8853b5ed8d3b6b8b0b13  guix-build-f6d49d0a0995/output/powerpc64-linux-gnu/bitcoin-f6d49d0a0995-powerpc64-linux-gnu-debug.tar.gz\nbf262448b9144561bd3adc14a855147154197e4ed4bb9eddfb229add5fb57740  guix-build-f6d49d0a0995/output/powerpc64-linux-gnu/bitcoin-f6d49d0a0995-powerpc64-linux-gnu.tar.gz\n\n# guix describe\nGeneration 1    Sep 01 2025 17:43:44    (current)\n  guix 5cb84f2\n    repository URL: https://codeberg.org/guix/guix.git\n    commit: 5cb84f2013c5b1e48a7d0e617032266f1e6059e2\n",
          "created_at": "2025-10-02T07:04:00Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 1,
    "issues": 1
  }
}