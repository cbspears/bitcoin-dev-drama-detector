{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T19:19:22.299447+00:00",
  "date": "2025-02-20",
  "pull_requests": [
    {
      "number": 31920,
      "title": "build: create Depends build type for depends and use it by default for depends builds",
      "body": "As discussed a good bit with fanquake and hebasto. Would be nice to have for v29, but it's very late, so no worries if it doesn't make it.\r\n\r\nFundamentally, this creates a \"Depends\" build type which represents the flags that were used to build depends as opposed to colliding with the other types.\r\n\r\nThis allows the forwarding of optional flags into the CMake build for the \"Depends\" build type, but the user can now optionally use an existing (Debug/RelWitDebInfo/etc.) type to ignore the optimization flags set by depends and use the ones from that type instead.\r\n\r\nAs an example, a user may do:\r\nmake -C depends\r\ncmake --toolchain depends/arm64-apple-darwin/toolchain.cmake -DCMAKE_BUILD_TYPE=Debug\r\n\r\nThis would compile depends with the default optimization flags for depends (-O2) but build Core with the default debug optimization flags from CMake\r\n\r\nDepends note:\r\nFor hosts, $host_*FLAGS variables now represent the mandatory flags for compiling and will be forwarded to all Core builds via the toolchain file, regardless of the build type. For most platforms they should be empty, but are useful at least for darwin.\r\n\r\nWhen setting (for example) CFLAGS from the command line when building depends, these flags will be stored in $host_release_CFLAGS (or _debug_), and will only be forwarded to the Depends build type.",
      "state": "open",
      "user": "theuni",
      "created_at": "2025-02-20T21:08:17Z",
      "updated_at": "2025-09-26T11:57:40Z",
      "comments": 8,
      "url": "https://github.com/bitcoin/bitcoin/pull/31920",
      "labels": [
        "Build system"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31920.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n",
          "created_at": "2025-02-20T21:08:20Z"
        },
        {
          "user": "maflcko",
          "body": "How does this interact with the depends DEBUG build? It looks like this is a breaking change for people (and the ci) picking the Debug build type afterwards. It would be good to clarify this and also adjust the CI scripts, if needed.",
          "created_at": "2025-02-20T21:16:10Z"
        },
        {
          "user": "ryanofsky",
          "body": "Current integration between depends and cmake builds definitely does not seem ideal, but it's hard for me to figure out if this PR makes the situation better. Maybe the PR description can be updated to state some advantages of this new approach? Or some problems with the current approach that this new approach solves?\r\n\r\nI listed a few aspects of the cmake/depends integration that I thought seemed broken and counterintuitive in  https://github.com/bitcoin/bitcoin/issues/30813#issuecomment-2329412411 (after \"Specifically in the current system...\"), and it seems like none of these things are changing after this PR, so I can imagine this PR solving a different set of problems, but I'm not sure which problems.",
          "created_at": "2025-02-20T21:39:26Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/37567255430</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
          "created_at": "2025-02-21T01:54:07Z"
        },
        {
          "user": "theuni",
          "body": "\r\n> Current integration between depends and cmake builds definitely does not seem ideal, but it's hard for me to figure out if this PR makes the situation better. Maybe the PR description can be updated to state some advantages of this new approach? Or some problems with the current approach that this new approach solves?\r\n> \r\n> I listed a few aspects of the cmake/depends integration that I thought seemed broken and counterintuitive in [#30813 (comment)](https://github.com/bitcoin/bitcoin/issues/30813#issuecomment-2329412411) (after \"Specifically in the current system...\"), and it seems like none of these things are changing after this PR, so I can imagine this PR solving a different set of problems, but I'm not sure which problems.\r\n\r\nYeah, I don't think this is intended to address any of those concerns. This is intended to define a sane way of forwarding compile flags from depends. I do agree feature options aren't ideal at the moment though.\r\n\r\n> How does this interact with the depends DEBUG build? It looks like this is a breaking change for people (and the ci) picking the Debug build type afterwards. It would be good to clarify this and also adjust the CI scripts, if needed.\r\n\r\nWith this, building depends with DEBUG simply means that the \"Depends\" type now holds the debug flags (currently `-O1 -g` from depends).\r\n\r\nHere's a quick before/after reference:\r\n\r\n```\r\nmake -C depends\r\ncmake -B build --toolchain depends/x86_64-pc-linux-gnu/toolchain.cmake\r\nresulting cxxflags before: -pipe -std=c++20 -O2 -O2 -g\r\nresulting cxxflags after:  -O2\r\n\r\nmake -C depends\r\ncmake -B build --toolchain depends/x86_64-pc-linux-gnu/toolchain.cmake -DCMAKE_BUILD_TYPE=Debug\r\nresulting cxxflags before: -pipe -std=c++20 -O0 -ftrapv -g3\r\nresulting cxxflags after:  -O0 -ftrapv -g3\r\n\r\nmake -C depends DEBUG=1\r\ncmake -B build --toolchain depends/x86_64-pc-linux-gnu/toolchain.cmake\r\nresulting cxxflags before: -pipe -std=c++20 -O2 -g\r\nresulting cxxflags after:  -O1 -g\r\n\r\nmake -C depends DEBUG=1\r\ncmake -B build --toolchain depends/x86_64-pc-linux-gnu/toolchain.cmake -DCMAKE_BUILD_TYPE=Debug\r\nresulting cxxflags before: -pipe -std=c++20 -O0 -ftrapv -O1 -g3 -g3\r\nresulting cxxflags after:  -O0 -ftrapv -g3\r\n```\r\n\r\nBasically, the \"Depends\" build type now comes from the debug/release flags, and the rest are mandatory that get passed to all build types.\r\n\r\nI think this is a much saner system, but it did change/break a few things, so it's not ready to go in as-is. Will convert to draft. Curious to see if there are any Concept ACKs here though. It's not ideal, but at least it's not arbitrary clobbering as we have now.\r\n\r\nThe issues specifically are:\r\n- `-g` is now off for a default depends Core build because it's off for the \"release\" depends builds\r\n- only the \"Depends\" build works for Linux with DEBUG=1 because `-D_GLIBCXX_DEBUG` is then required unconditionally (Debug/Release/RelWithDebInfo won't work)\r\n- Guix would probably need to be explicitly set to RelWithDebInfo so that it's allowed to diverge from depends\r\n- ci builds that use the Debug type would need to be updated as that's probably not necessary anymore (this one is actually a good thing)",
          "created_at": "2025-02-21T20:18:45Z"
        },
        {
          "user": "ryanofsky",
          "body": "It might be nice to move the first commit 40a01e9d30b0c7deabd5996867f248637f3d1a08 into a separate PR because it seems straightforwardly good (deduplicating code and moving flags that aren't host specific out of host-specific configurations) and it would remove complexity from this PR.\r\n\r\n> Yeah, I don't think this is intended to address any of those concerns. This is intended to define a sane way of forwarding compile flags from depends.\r\n\r\nCan you explain what specific problems or concerns this PR is addressing?\r\n\r\nI can see looking at the current toolchain file that it does some odd things, but it looks to me like those things could be directly fixed using an approach like I described https://github.com/bitcoin/bitcoin/issues/30813#issuecomment-2329412411, where we define a clear precedence order like \"the depends toolchain file should be able to see and freely override cmake defaults, and users should be able to see and freely override depends defaults\" and then implement it.\r\n\r\nIn this PR, instead of choosing a precedence order, this adds a new \"depends\" build type that gives users a choice of whether to ignore cmake defaults and use depends defaults by using the new \"depends\" build type, or to ignore depends defaults and use cmake defaults by using an ordinary build type.\r\n\r\nThis seems kludgy to me because the both choices seem suboptimal and the choice itself should be unnecessary when cmake seems to provide everything the depends system needs to set sane default values for existing build types without introducing a new build type.\r\n\r\nBut it's hard to evaluate this PR without knowing what specific problems it is trying to address, since maybe they are not the same as the ones I can see.",
          "created_at": "2025-03-25T16:08:32Z"
        },
        {
          "user": "fanquake",
          "body": "> It might be nice to move the first commit https://github.com/bitcoin/bitcoin/commit/40a01e9d30b0c7deabd5996867f248637f3d1a08 into a separate PR because it seems straightforwardly good (deduplicating code and moving flags that aren't host specific out of host-specific configurations) and it would remove complexity from this PR.\r\n\r\nI've done that in #32584, as I've got some changes that will build on top of this.",
          "created_at": "2025-05-22T09:33:37Z"
        },
        {
          "user": "fanquake",
          "body": "40a01e9d30b0c7deabd5996867f248637f3d1a08 has been merged via #32584.",
          "created_at": "2025-07-31T10:12:41Z"
        }
      ]
    },
    {
      "number": 31919,
      "title": "Refactor file handling with context managers in multiple files",
      "body": "**Description:**  \r\nThis pull request refactors multiple instances of file handling across different files by replacing direct `open()` calls with context managers. The change does not affect the core functionality of the application but improves resource management by ensuring that files are properly closed after use. This results in cleaner code and better resource handling without altering any existing behavior.",
      "state": "closed",
      "user": "mahdirahimi1999",
      "created_at": "2025-02-20T20:50:03Z",
      "updated_at": "2025-02-20T20:55:36Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/pull/31919",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31919.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
          "created_at": "2025-02-20T20:50:05Z"
        }
      ]
    },
    {
      "number": 31918,
      "title": "fuzz: add basic TxOrphanage::EraseForBlock cov",
      "body": "Currently uncovered",
      "state": "closed",
      "user": "instagibbs",
      "created_at": "2025-02-20T19:07:49Z",
      "updated_at": "2025-02-24T16:14:55Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/pull/31918",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31918.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [dergoegge](https://github.com/bitcoin/bitcoin/pull/31918#pullrequestreview-2632437674), [marcofleon](https://github.com/bitcoin/bitcoin/pull/31918#pullrequestreview-2632830776) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n",
          "created_at": "2025-02-20T19:07:54Z"
        }
      ]
    },
    {
      "number": 31917,
      "title": "fuzz: provide more realistic values to the base58(check) decoders",
      "body": "This is a follow-up to https://github.com/bitcoin/bitcoin/pull/30746, expanding coverage by:\r\n* restricting every input for the base58 conversions, capping max sizes to `100` instead of `1000` or all available input (suggested by marcofleon in https://github.com/bitcoin/bitcoin/pull/30746#discussion_r1963718683) since most actual usage has lengths of e.g. `21`, `34`, `78`.\r\n* providing more valid values to the decoder (suggested by maflcko in https://github.com/bitcoin/bitcoin/pull/30746#discussion_r1957847712) by randomly providing a random input or a valid encoded one; this also enables unifying the roundtrip tests to a single roundtrip per fuzz.",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2025-02-20T16:23:37Z",
      "updated_at": "2025-03-17T02:15:13Z",
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/pull/31917",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31917.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [mzumsande](https://github.com/bitcoin/bitcoin/pull/31917#issuecomment-2722394679), [maflcko](https://github.com/bitcoin/bitcoin/pull/31917#issuecomment-2726501066) |\n| Concept ACK | [arejula27](https://github.com/bitcoin/bitcoin/pull/31917#issuecomment-2676854804) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n",
          "created_at": "2025-02-20T16:23:40Z"
        },
        {
          "user": "arejula27",
          "body": "Concept ACK [`a63c5c1a8a012b694`](https://github.com/bitcoin/bitcoin/pull/31917/commits/a63c5c1a8a012b694b8e260fd5d2fda3c8785e98)\r\n\r\nIâ€™ve reviewed the changes and have one main observation:\r\n\r\n## 1. Fuzz Test Limitations\r\n\r\nLimiting fuzz to the most common sizes makes sense for efficiency. However, if long strings are still expected to be supported, there should be explicit test coverage for them.\r\n\r\nI checked the unit tests for Base58 in `src/test/base58_tests.cpp`, which reads test cases from `test/data/base58_encode_decode.json`. The longest existing test case appears on `line 18`, with a hex-encoded string of size 512. Given that this PR removes the long string test from the fuzz tests, it may be beneficial to **add a new test case** in `base58_encode_decode.json` to verify behaviour at **1000 characters**.\r\n## 2. Fuzz Test Execution\r\nAfter static review, I ran the fuzz tests using:\r\n\r\n```bash\r\n$ cmake --preset=libfuzzer\r\n$ cmake --build build_fuzz -j \"$(($(nproc)+1))\"\r\n\r\n$ FUZZ=base58_encode_decode build_fuzz/src/test/fuzz/fuzz -max_total_time=30 -\r\n$ FUZZ=base58check_encode_decode build_fuzz/src/test/fuzz/fuzz -max_total_time=30\r\n$ FUZZ=base32_encode_decode build_fuzz/src/test/fuzz/fuzz -max_total_time=30 \r\n$ FUZZ=base64_encode_decode build_fuzz/src/test/fuzz/fuzz -max_total_time=30 \r\n$ FUZZ=psbt_base64_decode build_fuzz/src/test/fuzz/fuzz -max_total_time=30 \r\n``` \r\nAll tests passed successfully within the 30-second run.",
          "created_at": "2025-02-23T13:15:53Z"
        },
        {
          "user": "mzumsande",
          "body": "Code Review / lightly tested ACK d5537c18a9034647ba4c9ed4008abd7fee33989e",
          "created_at": "2025-03-13T18:54:26Z"
        },
        {
          "user": "maflcko",
          "body": "review ACK d5537c18a9034647ba4c9ed4008abd7fee33989e ðŸš›\r\n\r\n<details><summary>Show signature</summary>\r\n\r\nSignature:\r\n\r\n```\r\nuntrusted comment: signature from minisign secret key on empty file; verify via: minisign -Vm \"${path_to_any_empty_file}\" -P RWTRmVTMeKV5noAMqVlsMugDDCyyTSbA3Re5AkUrhvLVln0tSaFWglOw -x \"${path_to_this_whole_four_line_signature_blob}\"\r\nRUTRmVTMeKV5npGrKx1nqXCw5zeVHdtdYURB/KlyA/LMFgpNCs+SkW9a8N95d+U4AP1RJMi+krxU1A3Yux4bpwZNLvVBKy0wLgM=\r\ntrusted comment: review ACK d5537c18a9034647ba4c9ed4008abd7fee33989e ðŸš›\r\nlZRbdgnghqtziDGBOrJTlPhuDIsZdigxD/VS2S8f5+dWrvPvXpUWSzcRe/nWCWjUTD2bz/MArCoV2/DrCVmxDA==\r\n```\r\n\r\n</details>\r\n",
          "created_at": "2025-03-15T12:47:48Z"
        },
        {
          "user": "maflcko",
          "body": "(In theory this could be backported to 29.0 to avoid a fuzz timeout there, but it isn't too important, up to the backport maintainer)",
          "created_at": "2025-03-15T12:50:51Z"
        },
        {
          "user": "glozow",
          "body": "Backported in #32062",
          "created_at": "2025-03-17T02:14:47Z"
        }
      ]
    },
    {
      "number": 31916,
      "title": "init: Handle dropped UPnP support more gracefully",
      "body": "Closes bitcoin-core/gui#843.\r\n\r\nIn that issue it was brought up that users likely don't care what kind of port forwarding is used, and that the setting is opportunistic anyway, so instead of showing an extensive warning, we can simply \"upgrade\" from UPNP to NAT-PMP+PCP.\r\n \r\n- Change the logic for removed runtime setting `-upnp` to set `-natpmp` instead, and log a message.\r\n\r\n- Also remove any lingering `upnp` from `settings.json` and replace it with `natpmp`, when it makes sense (this is important so that the UI shows the right values in the settings):\r\n\r\n```json\r\n{\r\n    \"upnp\": true\r\n}\r\n```\r\nbecomes\r\n```json\r\n{\r\n    \"natpmp\": true\r\n}\r\n```\r\n\r\nand\r\n\r\n```json\r\n{\r\n    \"upnp\": false\r\n}\r\n```\r\nbecomes\r\n```json\r\n{\r\n    \"natpmp\": false\r\n}\r\n```",
      "state": "closed",
      "user": "laanwj",
      "created_at": "2025-02-20T16:08:30Z",
      "updated_at": "2025-03-04T00:40:46Z",
      "comments": 26,
      "url": "https://github.com/bitcoin/bitcoin/pull/31916",
      "labels": [
        "GUI",
        "Settings"
      ]
    },
    {
      "number": 31915,
      "title": ".",
      "body": "<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "closed",
      "user": "stephenmiracle4",
      "created_at": "2025-02-20T15:06:13Z",
      "updated_at": "2025-02-20T15:06:46Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/pull/31915",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31915.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
          "created_at": "2025-02-20T15:06:19Z"
        }
      ]
    },
    {
      "number": 31914,
      "title": ".",
      "body": "<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "closed",
      "user": "stephenmiracle4",
      "created_at": "2025-02-20T15:02:15Z",
      "updated_at": "2025-02-20T15:07:00Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/pull/31914",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31914.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
          "created_at": "2025-02-20T15:02:20Z"
        }
      ]
    },
    {
      "number": 31912,
      "title": "random: Initialize variables in hardware RNG functions",
      "body": "Re-create This PR since previous(https://github.com/bitcoin/bitcoin/pull/31902) failed to compile.\n\nMaybe we could re-consider and re-review this after 29.0 branch-off:\n\n1. https://github.com/bitcoin/bitcoin/pull/31902#issuecomment-2669021440\n2. https://github.com/bitcoin/bitcoin/pull/31902#issuecomment-2669380644\n\n",
      "state": "closed",
      "user": "eval-exec",
      "created_at": "2025-02-20T02:46:58Z",
      "updated_at": "2025-04-11T07:57:04Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/31912",
      "labels": [
        "Upstream",
        "Utils/log/libs"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31912.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29641](https://github.com/bitcoin/bitcoin/pull/29641) (scripted-diff: Use LogInfo over LogPrintf [WIP, NOMERGE, DRAFT] by maflcko)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
          "created_at": "2025-02-20T02:47:01Z"
        },
        {
          "user": "maflcko",
          "body": "Has someone tried to report or fix this upstream in the linux kernel or elsewhere? See https://github.com/bitcoin/bitcoin/pull/31908#issuecomment-2669309907",
          "created_at": "2025-02-20T07:21:13Z"
        },
        {
          "user": "giahuy98",
          "body": "2498dd8dbd5acdede03e1a57c5873ca022903023 works on Samsung S25 with the log: `Using RNDR as an additional entropy source`.",
          "created_at": "2025-02-21T20:41:46Z"
        },
        {
          "user": "maflcko",
          "body": "The pull request title and commit message looks off. Also there seems to be an ongoing discussion in https://github.com/bitcoin/bitcoin/pull/31908#issuecomment-2687917758",
          "created_at": "2025-03-09T14:14:41Z"
        },
        {
          "user": "maflcko",
          "body": "Closing this for now, because it is a stale draft. Let's continue discussion in https://github.com/bitcoin/bitcoin/pull/32248 or https://github.com/bitcoin/bitcoin/issues/31817 to keep this focussed",
          "created_at": "2025-04-11T07:57:04Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 31921,
      "title": "intermittent ipc_tests (Timeout)",
      "body": "https://cirrus-ci.com/task/4822889158934528?logs=ci#L4124\n\n```\ntest/ipc_tests.cpp(11): Entering test suite \"ipc_tests\"\ntest/ipc_tests.cpp(12): Entering test case \"ipc_tests\"\n2025-02-20T19:40:40.807963Z [unknown] [test/util/random.cpp:48] [SeedRandomStateForTest] Setting random seed for current tests to RANDOM_CTX_SEED=d9d17e81b3c451b4796c66be71a75826f4089e0ed585b15f9fe9784685ea3f80\n2025-02-20T19:40:40.809986Z [test] [init/common.cpp:151] [LogPackageVersion] Bitcoin Core version v28.99.0-46a9c73083e0-dirty (debug build)\n2025-02-20T19:40:40.810894Z [test] [kernel/context.cpp:20] [operator()] Using the 'standard,sse41(4way),avx2(8way)' SHA256 implementation\n2025-02-20T19:40:40.810937Z [test] [random.cpp:114] [ReportHardwareRand] Using RdSeed as an additional entropy source\n2025-02-20T19:40:40.810975Z [test] [random.cpp:117] [ReportHardwareRand] Using RdRand as an additional entropy source\n2025-02-20T19:40:40.826220Z [test] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8395} IPC client first request from current thread, constructing waiter\n2025-02-20T19:40:40.827720Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8395} IPC client send FooInterface.add$Params (a = 1, b = 2)\n2025-02-20T19:40:40.828045Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8396} IPC server recv request  #1 FooInterface.add$Params (a = 1, b = 2)\n2025-02-20T19:40:40.828157Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8396} IPC server send response #1 FooInterface.add$Results (result = 3)\n2025-02-20T19:40:40.828302Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8395} IPC client recv FooInterface.add$Results (result = 3)\n2025-02-20T19:40:40.832153Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8395} IPC client send FooInterface.passOutPoint$Params (arg = \"d\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\310\\\\000\\\\000\\\\000\")\n2025-02-20T19:40:40.832304Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8396} IPC server recv request  #2 FooInterface.passOutPoint$Params (arg = \"d\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\310\\\\000\\\\000\\\\000\")\n2025-02-20T19:40:40.832425Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8396} IPC server send response #2 FooInterface.passOutPoint$Results (result = \"d\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\310\\\\000\\\\000\\\\000\")\n2025-02-20T19:40:40.832517Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8395} IPC client recv FooInterface.passOutPoint$Results (result = \"d\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\310\\\\000\\\\000\\\\000\")\n2025-02-20T19:40:40.832728Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8395} IPC client send FooInterface.passUniValue$Params (arg = \"{\\\\\"i\\\\\":1,\\\\\"s\\\\\":\\\\\"two\\\\\"}\")\n2025-02-20T19:40:40.832922Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8396} IPC server recv request  #3 FooInterface.passUniValue$Params (arg = \"{\\\\\"i\\\\\":1,\\\\\"s\\\\\":\\\\\"two\\\\\"}\")\n2025-02-20T19:40:40.833020Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8396} IPC server send response #3 FooInterface.passUniValue$Results (result = \"{\\\\\"i\\\\\":1,\\\\\"s\\\\\":\\\\\"two\\\\\"}\")\n2025-02-20T19:40:40.833140Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8395} IPC client recv FooInterface.passUniValue$Results (result = \"{\\\\\"i\\\\\":1,\\\\\"s\\\\\":\\\\\"two\\\\\"}\")\n2025-02-20T19:40:40.833338Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8395} IPC client send FooInterface.passTransaction$Params (arg = \"\\\\002\\\\000\\\\000\\\\000\\\\001d\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\310\\\\000\\\\000\\\\000\\\\000\\\\377\\\\377\\\\377\\\\377\\\\001\\\\000\\\\341\\\\365\\\\005\\\\000\\\\000\\\\000\\\\000\\\\000\\\\003\\\\000\\\\000\\\\000\")\n2025-02-20T19:40:40.833528Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8396} IPC server recv request  #4 FooInterface.passTransaction$Params (arg = \"\\\\002\\\\000\\\\000\\\\000\\\\001d\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\310\\\\000\\\\000\\\\000\\\\000\\\\377\\\\377\\\\377\\\\377\\\\001\\\\000\\\\341\\\\365\\\\005\\\\000\\\\000\\\\000\\\\000\\\\000\\\\003\\\\000\\\\000\\\\000\")\n2025-02-20T19:40:40.833680Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8396} IPC server send response #4 FooInterface.passTransaction$Results (result = \"\\\\002\\\\000\\\\000\\\\000\\\\001d\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\310\\\\000\\\\000\\\\000\\\\000\\\\377\\\\377\\\\377\\\\377\\\\001\\\\000\\\\341\\\\365\\\\005\\\\000\\\\000\\\\000\\\\000\\\\000\\\\003\\\\000\\\\000\\\\000\")\n2025-02-20T19:40:40.833790Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8395} IPC client recv FooInterface.passTransaction$Results (result = \"\\\\002\\\\000\\\\000\\\\000\\\\001d\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\000\\\\310\\\\000\\\\000\\\\000\\\\000\\\\377\\\\377\\\\377\\\\377\\\\001\\\\000\\\\341\\\\365\\\\005\\\\000\\\\000\\\\000\\\\000\\\\000\\\\003\\\\000\\\\000\\\\000\")\n2025-02-20T19:40:40.833984Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8395} IPC client send FooInterface.passVectorChar$Params (arg = \"Hello\")\n2025-02-20T19:40:40.834140Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8396} IPC server recv request  #5 FooInterface.passVectorChar$Params (arg = \"Hello\")\n2025-02-20T19:40:40.834235Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8396} IPC server send response #5 FooInterface.passVectorChar$Results (result = \"Hello\")\n2025-02-20T19:40:40.834336Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8395} IPC client recv FooInterface.passVectorChar$Results (result = \"Hello\")\n2025-02-20T19:40:40.834535Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8395} IPC client send FooInterface.passBlockState$Params (arg = (mode = 1, result = 8, rejectReason = \"reject reason\", debugMessage = \"debug message\"))\n2025-02-20T19:40:40.834732Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8396} IPC server recv request  #6 FooInterface.passBlockState$Params (arg = (mode = 1, result = 8, rejectReason = \"reject reason\", debugMessage = \"debug message\"))\n2025-02-20T19:40:40.834826Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8396} IPC server send response #6 FooInterface.passBlockState$Results (result = (mode = 1, result = 8, rejectReason = \"reject reason\", debugMessage = \"debug message\"))\n2025-02-20T19:40:40.834941Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8395} IPC client recv FooInterface.passBlockState$Results (result = (mode = 1, result = 8, rejectReason = \"reject reason\", debugMessage = \"debug message\"))\n2025-02-20T19:40:40.835129Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8395} IPC client send FooInterface.passBlockState$Params (arg = (mode = 0, result = 0, rejectReason = \"\", debugMessage = \"\"))\n2025-02-20T19:40:40.835274Z [unknown] [test/ipc_test.cpp:60] [operator()] LOG0: {IpcPipeTest-8395/b-test-8396} IPC server recv request  #7 FooInterface.passBlockState$Params (arg = (mode = 0, result = 0, rejectReason = \"\", debugMessage = \"\"))\n99% tests passed, 1 tests failed out of 140\nTotal Test time (real) = 2508.25 sec\nThe following tests FAILED:\n\t140 - ipc_tests (Timeout)\nErrors while running CTest\nExit status: 8\n",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-02-20T22:27:23Z",
      "updated_at": "2025-02-25T14:57:24Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/31921",
      "labels": [
        "CI failed"
      ],
      "comment_list": [
        {
          "user": "ryanofsky",
          "body": "Seems possible this is the same bug as https://github.com/chaincodelabs/libmultiprocess/issues/154 but causing a deadlock instead of a \"mutex lock failed\" error due to platform differences. The fix for the bug is https://github.com/chaincodelabs/libmultiprocess/pull/159 and is included in 1746618e081d582673b458091c46bb3f71ba3a56 from #31741. But maybe I should make that commit a separate PR?",
          "created_at": "2025-02-20T23:09:24Z"
        },
        {
          "user": "maflcko",
          "body": "Yeah, it looks like https://github.com/bitcoin/bitcoin/pull/31741 needs rebase and feature freeze was yesterday, so I am not sure if it is going to make it in as a bugfix into 29.x.\n\nMight be best carve out the bugfix commit for now.",
          "created_at": "2025-02-21T07:55:23Z"
        },
        {
          "user": "ryanofsky",
          "body": "> Might be best carve out the bugfix commit for now.\n\nThanks I moved the commit bumping libmultiprocess version from #31741 to a new PR #31945",
          "created_at": "2025-02-24T12:59:47Z"
        }
      ]
    },
    {
      "number": 31913,
      "title": "build: x86 afl++ ASan build broken \"error: inline assembly requires more registers than available\"",
      "body": "Dockerfile to reproduce: https://gist.github.com/dergoegge/fc97743028f60719759b5498f5f022bf\n\nBuilding with `clang-19` and `-fsantize=address` fails with:\n\n```\n7.574 /bitcoin/src/secp256k1/src/scalar_4x64_impl.h:356:5: error: inline assembly requires more registers than available\n7.574   356 |     \"movq 32(%%rsi), %%r11\\n\"\n7.574       |     ^\n7.575 /bitcoin/src/secp256k1/src/scalar_4x64_impl.h:356:5: error: inline assembly requires more registers than available\n7.575 /bitcoin/src/secp256k1/src/scalar_4x64_impl.h:356:5: error: inline assembly requires more registers than available\n7.643 [ 24%] Building CXX object src/CMakeFiles/bitcoin_consensus.dir/uint256.cpp.o\n7.722 3 errors generated.\n7.738 gmake[3]: *** [src/secp256k1/src/CMakeFiles/secp256k1.dir/build.make:76: src/secp256k1/src/CMakeFiles/secp256k1.dir/secp256k1.c.o] Error 1\n7.738 gmake[2]: *** [CMakeFiles/Makefile2:1020: src/secp256k1/src/CMakeFiles/secp256k1.dir/all] Error 2\n```\n\nSince this looks secp256k1 related I tried reproducing on a separate secp build but couldn't. This could very well be a compiler/linker bug.\n\nI am surprised that I'm the only one running into this, we don't have a x86 ASan job anywhere? I think I first observed this sometime mid last year.",
      "state": "closed",
      "user": "dergoegge",
      "created_at": "2025-02-20T11:27:31Z",
      "updated_at": "2025-05-08T08:08:44Z",
      "comments": 25,
      "url": "https://github.com/bitcoin/bitcoin/issues/31913",
      "labels": [
        "Build system"
      ]
    }
  ],
  "summary": {
    "pull_requests": 8,
    "issues": 2
  }
}