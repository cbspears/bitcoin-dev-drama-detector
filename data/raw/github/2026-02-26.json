{
  "source": "github",
  "repo": "bitcoin/bitcoin",
  "fetched_at": "2026-02-26T16:52:26.091419+00:00",
  "date_range": {
    "since": "2026-02-19T16:52:26.091363+00:00",
    "until": "2026-02-26T16:52:26.091363+00:00"
  },
  "pull_requests": [
    {
      "id": 3331553763,
      "number": 34683,
      "title": "RFC: Support a format description of our JSON-RPC interface",
      "body": "Ref #29912.\r\n\r\nThis draft PR adds a machine-readable[ OpenRPC](https://www.open-rpc.org/) 1.3.2 specification of out JSON-RPC interface, auto-generated from existing `RPCHelpMan` metadata.\r\n\r\nThere is currently no formal, machine-readable specification of the RPC API. As discussed in #29912, this has knock-on consequences:\r\n\r\n- Client libraries re-implement the API manually, leading to bugs like unit mistakes (sats vs BTC, vB vs kvB) and missing/incorrect argument types. No existing client library fully and correctly implements the API in a type-safe manner.\r\n- When the API changes, every downstream client must manually discover and adapt, creating downstream maintenance burden. There is no artifact they can diff between releases.\r\n- Implementing a new client in a new language requires reading C++ source or help text and transcribing it, which is error-prone and tedious, and represents an on-going porting cost.\r\n- Existing documentation is either stale or not machine-readable. The developer.bitcoin.org docs are wrong/outdated in places, and the bitcoincore.org/en/doc/ pages are rendered from help output but not in a standard schema format.\r\n- (new/extra) AI/LLM tooling increasingly builds on structured API specifications. A standard spec format enables AI-assisted client generation and integration without the ambiguity of parsing human-readable help text.\r\n\r\nThis draft builds on prior art by @casey and the observations by @laanwj, @stickies-v, @kilianmh, @hodlinator, and @cdecker in #29912. Casey's work demonstrated that RPCHelpMan already contains all the structured information needed, which makes this feasible without duplicating any API definitions.\r\n\r\nThis differs from Casey's branches in two ways: i) it uses the OpenRPC standard rather than an ad-hoc format or raw JSON Schema, and ii) it generates a static artifact checked into the repo rather than exposing a new RPC command.\r\n\r\n### Why OpenRPC\r\n\r\nI seletced OpenRPC for a number of reasons:\r\n\r\n- It's purpose-built for JSON-RPC APIs (suggested by @stickies-v, @nflatrea, and @kilianmh).\r\n- It wraps JSON schema for params/results, so consumers get both the method-level structure and the type-level schemas.\r\n- Unlike OpenAPI, it is not path-centric, which better fits our single-endpoint JSON-RPC model (concern raised by @hodlinator).\r\n  - Although it therefore does not cover our REST interface.\r\n- It's _kind of_ a standard format with (_some_) existing tooling for type generation (TypeScript, Rust, Python, Go) and client scaffolding, though maturity varies by language. More importantly though, IMO, a ~standardised format is inherently more useful than any ad-hoc one: any JSON Schema validator works, any LLM can consume it directly, and anyone can write a bespoke generator against a known schema rather than parsing help text.\r\n\r\n### Approach\r\n\r\nC++ `RPCHelpMan` definitions\r\n    → `ToDescriptionValue()` methods (new)\r\n    → `help dump_all_command_descriptions` (new internal RPC)\r\n    → Python gen-openrpc.py\r\n    → doc/openrpc.json (the artifact that gets committed)\r\n\r\nThe Python generator is a pure transformer from Bitcoin Core's internal type vocabulary to OpenRPC/JSON Schema and the single source of truth therefore remains as the C++ `RPCHelpMan` definitions.\r\n\r\nThe rationale for implementing this as using a python transformer, rather than adding a native rpc which emits openrpc schema directly, is mainly that I consider the openrpc format/schema to not really belong in the bitcoin core binary, much like e.g. manpage generation. Also, it's much easier to transform in python than using univalue in cpp :) The tradeoff is that being able to emit the \"active spec\" from a running binary, which admittedly would be pretty nice.\r\n\r\n#### Does this belong in this repo?\r\n\r\nThis begs the question: does this belong in bitcoin/bitcoin at all? Perhaps not. We could choose take only the cpp changes here, and support the new `dump_all_command_descriptions` RPC, and move the python generator functions into a seperate repo. Which is quite a nice option from a maintenance PoV, especially considering I added a function test, which could irritate devs changing RPCs (see below).\r\n\r\n### Tradeoffs\r\n\r\nvs an ad-hoc format OpenRPC gives us interoperability with the (admittedly surprisingly limited) tooling, documentation generators, code generators, and validators, at the cost of needing x-bitcoin-* extensions for Bitcoin-specific concepts. As Casey noted after trying both approaches, JSON Schema \"is probably not a great fit\". OpenRPC's method-level framing on top of JSON Schema addresses the ergonomic issues while keeping the schema benefits. After testing both, I think I agree.\r\n\r\nStatic artifact vs live RPC: As noted above, the spec is a living commited file in the repo. This means at checkout (or release) the file will always match, although it does not consider when optional modules are not built (e.g. wallet, external signer, zmq). it could also cause more work for devs who change an rpc, as the workflow may involve:\r\n\r\n```bash\r\nchange rpc -> notice rpc_openrpc.py test failure -> copy/commit updated schema from failure dump -> re-run\r\n```\r\n\r\nI haven't thought of a good way around this yet, other than not testing the spec file, and relying on remembering to update it at release time... Having this be a \"live rpc\" would generally avoid this.\r\n\r\nTypes: JSON Schema cannot natively express units like \"BTC/kvB\" or semantic distinctions like \"this hex string is a txid.\" These are preserved in description text and x-bitcoin-type-str extensions, but are *not* machine-enforceable from the schema alone. This was recognized as a fundamental limitation by several commenters in the issue. Future work could enrich the x-bitcoin-* extensions with a more structured unit vocabulary.\r\n\r\nSome RPCs return different types depending on argument values (e.g. verbosity levels). These are represented as `oneOf` in the result schema with free-text condition descriptions. This is accurate but not fully machine-parseable — a code generator cannot automatically determine which result variant corresponds to which argument value without parsing the description. I still we have enough information to satisfy humans an agents alike though.\r\n\r\n### Regenerating the spec\r\n\r\nWhen any RPC method's signature, arguments, or results change, the rpc_openrpc.py functional test will fail. To regenerate, something like the following can be run:\r\n\r\n```bash\r\ncmake -B build --preset dev-mode\r\ncmake --build build -j$(nproc)\r\n./build/bin/bitcoind -daemon\r\ncontrib/devtools/gen-openrpc.py --output doc/openrpc.json -c ./build/bin/bitcoin-cli\r\n./build/bin/bitcoin-cli stop\r\n```\r\n\r\nThe build must have wallet, ZMQ, and external signer enabled (the default dev-mode preset works).\r\n\r\nIf the failure is emitted from CI, where all modules are already built, the test is currently programmed to emit what it believes the correct spec is, which the author can copy, diff, and commit if in agreement.\r\n\r\nThe idea is to try ang guarantee that the spec never silently drifts from the implementation, make RPC changes self-documenting, and catch missing regeneration before merge.\r\n\r\nHowever, this adds a manual regeneration step to the workflow when modifying RPCs. This mirrors the existing pattern for gen-manpages.py and gen-bitcoin-conf.sh, although these don't have tests that fail on PRs...\r\n\r\n### Discussion questions\r\n\r\n- Is this valuable/wanted?\r\n- If so, should it live in this repo?\r\n- Do we like openrpc format? (less relevant if we don't want this in this repo, as another repo could generate one or many definitions).\r\n\r\nMy personal thoughts are that this is very nice to have, but we might want to consider housing the python and json in a different repo, although having the schema tightly-coupled to any commit in this repo, is quite nice.",
      "state": "open",
      "user": "willcl-ark",
      "created_at": "2026-02-26T15:22:35Z",
      "updated_at": "2026-02-26T16:48:50Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34683",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 7907,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3102178109,
      "number": 34075,
      "title": "fees: Introduce Mempool Based Fee Estimation to reduce overestimation",
      "body": "This PR is another attempt to fix #27995 using a better approach.\r\n\r\nFor background and motivation, see #27995 and the discussion in the Delving Bitcoin post [Mempool Based Fee Estimation on Bitcoin Core](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703)\r\nThis PR is currently limited to using the mempool only to lower what is recommended by the Block Policy Estimator.\r\nAccurate and safe fee estimation using the mempool is challenging. There are open questions about how to prevent mempool games that are theoretically possible for miners [(a variant of the Finney attack)](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/6)\r\n\r\nThis is one of the reasons I opted to use the mempool only to lower the Block Policy Estimator, which itself is not gameable, and therefore this mechanism is not susceptible to this attack.\r\n\r\nThe underlying assumption here is that, with the current tools and work done to make RBF and CPFP feasible and guarantee (TRUC transaction relay, ephemeral anchors, cluster size 2 package rbf), it is safer to underestimate rather than overestimate.\r\nWe now assume it is relatively easy to fee-bump later if a transaction does not confirm, whereas once a fee is overestimated there is no way to recover from that.\r\n\r\nAnother open question when using the mempool for fee estimation is how to account for incoming transaction inflow.\r\n[Bitcoin Augur](https://github.com/block/bitcoin-augur) does this by using past inflow plus a constant expected inflow to predict future inflow. I find this unconvincing for fee estimation and potentially prone to more overestimation, as past conditions are not always representative of the future. See my [review of the Augur fee rate estimator and open questions](https://github.com/block/bitcoin-augur/issues/3).\r\n\r\nThis PR uses a much simpler approach based on current user behavior, similar to the widely used method employed by mempool.space: looking at the top block of the mempool and selecting a percentile feerate depending on whether the user is economical or conservative.\r\n\r\nEmpirical data from both myself and Clara Shikhelman shows that the 75th percentile feerate for economical users and the 50th percentile feerate for conservative users provide positive confirmation guarantees, hence this is what is used in this PR.\r\n\r\nParallel research by René Pickhardt and his student suggests that using the [average fee per byte of the block template performs well](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/12).\r\n\r\nAll of these are constants that can be adjusted, there is parallel work exploring these constants and running benchmarks across fee estimators to find a sweet spot.\r\n\r\nSee also work in LND, the [LND Budget Sweeper](https://delvingbitcoin.org/t/lnds-deadline-aware-budget-sweeper/1512), which applies this idea successfully. Their approach is to estimate fees initially with bitcoind, then increment gradually as the confirmation deadline approaches, using a fixed fee budget.\r\n\r\nHistorical data indicates that by doing only the approach in this PR, we are able to [reduce overestimation quite significantly (~29%)](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/8).\r\n\r\nThis is particularly useful in scenarios where the Block Policy Estimator recommends a high feerate while the mempool is empty.\r\n<img width=\"1800\" height=\"1090\" alt=\"56f3ba26c0184521c42bb82ec9d8c9f2224d4f8e\" src=\"https://github.com/user-attachments/assets/c035c40c-8ece-42a7-b290-d29f1ac9bf4d\" />\r\n\r\nAs seen in the image above, there is only one remaining unfixed case: when there is a sudden inflow of transactions and the feerate rises, the Block Policy Estimator takes time to reflect this. In that case, users will continue to see a low feerate estimate until it slowly updates. From the historical data linked above, [this occurs about ~26% of the time](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/8)).\r\n\r\nOverall, we observe a **73% success rate with 0% overestimation, and 26% underestimation** with this approach.\r\n\r\nThis PR also includes refactors that enable this work. Rather than splitting the PR and implementing changes incrementally, I opted for an end-to-end implementation:\r\n\r\n### 1. Refactors\r\n\r\n* Separation of feerate format from the fee estimate mode enumerator (separation of concerns, as they are semantically distinct)\r\n* Move logging after fee estimation estimateSmartFee from the wallet to the Block Policy Estimator internal method (also separation of concerns and avoiding leaking fee estimator internals). This change also comes with updating `createTransactionInternal` to log only the fee and its source (fee estimator, fallback fee, etc.), which is more appropriate.\r\n* Separate the fee estimate mode enum from the fee source enumerator (separation of concerns, as they are semantically distinct). This introduces a minor breaking change: the wallet RPCs now return fee *source* instead of fee *reason*, which is more accurate. Let me know if we prefer to keep the field name unchanged while returning the fee source.\r\n* Move the `StringForReason` enum from `common` to the Block Policy Estimator (also separation of concerns)\r\n* Various test file updates and renames for improved accuracy\r\n* Update Block Policy Estimator unit tests to be independent of the mempool and the validation interface\r\n\r\n### 2. Introduce Mempool-Based Fee Estimator and Fee Estimator Manager\r\n\r\n* Introduce a new abstract fee estimator base class that all fee estimators must implement\r\n\r\n* Introduce `FeeRateEstimateResult` as the response type, containing metadata and avoiding the use of out-parameters. This is easily extensible and makes future changes less invasive, as method signatures do not need to change.\r\n\r\n* Add `FeeEstimatorType` enum to identify different fee estimators\r\n\r\n* Make `CBlockPolicyEstimator` derive from the new fee estimator base class\r\n\r\n* Add `FeeRateEstimatorManager`, responsible for managing all fee estimators\r\n\r\n* Update the node context to store a `unique_ptr` to `FeeRateEstimatorManager` instead of `CBlockPolicyEstimator`\r\n\r\n* Update `CBlockPolicyEstimator` to no longer subscribe directly to the validation interface; instead, `FeeRateEstimatorManager` subscribes and forwards relevant notifications\r\n\r\n* Add a percentile calculation function that takes the chunk feerates of a block template and returns feerate percentiles; this can also be reused by the `getblockstats` RPC\r\n\r\n* Add a mempool fee estimator that generates a block template when called, calculates a percentile feerate, and returns the 75th percentile for economical mode or the 50th percentile for conservative mode\r\n\r\n* Add caching to the mempool estimator so that new estimates are generated only every 7 seconds, assuming enough [transactions have propagated](https://bitcoin.stackexchange.com/questions/125776/how-long-does-it-take-for-a-transaction-to-propagate-through-the-network/125777#125777) to make a meaningful difference.\r\n  This heuristic will likely be replaced by requesting block templates via the general-purpose block template cache proposed here: [https://github.com/bitcoin/bitcoin/issues/33389](https://github.com/bitcoin/bitcoin/issues/33389)\r\n\r\n* Update `MempoolTransactionRemovedForBlock` to return the actual block transactions as well\r\n\r\n* Track the weight of block transactions and evicted transactions after each block connection\r\n  This data is tracked for the last 6 mined blocks. A mempool feerate estimate is returned only when the average ratio of mempool transaction weight evicted due to `BLOCK` reasons to block transaction weight is greater than 75%. This heuristic provides rough confidence that the node’s mempool matches that of the majority of the hashrate. The 75% threshold is arbitrary and can be adjusted.\r\n\r\nThere is a caveat when transactions in the local mempool are consistently not mined by the network, as described in #27995 (e.g., due to filtering).\r\nAccounting for these transactions during fee estimation is not necessary, as they should be evicted from the mempool itself (see #33510). Handling this again within fee estimation would be redundant.\r\n\r\n* Persist statistics for the 6 most recent blocks to disk during periodic flushes and shutdown, so this data is available after restarts\r\n* Expose this data to users when running `estimatesmartfee` with verbosity > 2\r\n\r\n<details>\r\n<summary>see example output</summary>\r\n\r\n```\r\nbitcoin-cli estimatesmartfee 1 \"conservative\" 2\r\n```\r\n\r\n```\r\n{\r\n  \"feerate\": 0.00002133,\r\n  \"errors\": [],\r\n  \"blocks\": 2,\r\n  \"mempool_health_statistics\": [\r\n    {\r\n      \"block_height\": 927953,\r\n      \"block_weight\": 3991729,\r\n      \"mempool_txs_weight\": 3942409,\r\n      \"ratio\": 0.987644451815241\r\n    },\r\n    ...\r\n  ]\r\n}\r\n```\r\n\r\n</details>",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2025-12-15T11:53:35Z",
      "updated_at": "2026-02-26T16:47:35Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34075",
      "labels": [
        "TX fees and policy",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 1,
        "text_length": 8927,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3289598409,
      "number": 34597,
      "title": "util: Fix UB in SetStdinEcho when ENOTTY",
      "body": "The call to `tcgetattr` may fail with `ENOTTY`, leaving the struct possibly uninitialized (UB).\r\n\r\nFix this UB by returning early when `isatty` fails, or when `tcgetattr` fails. (Same for Windows)\r\n\r\n\r\nThis can be tested by a command that fails valgrind before the change and passes after:\r\n\r\n```\r\necho 'pipe' | valgrind --quiet ./bld-cmake/bin/bitcoin-cli -stdinrpcpass uptime",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-02-16T11:37:29Z",
      "updated_at": "2026-02-26T16:42:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34597",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 418,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 578665495,
      "number": 21283,
      "title": "Implement BIP 370 PSBTv2",
      "body": "BIP 370 PSBTv2 introduces several new fields and different invariants for PSBT. This PR implements those new fields and restructures the PSBT implementation to match PSBTv2 but still remain compatible with PSBTv0.",
      "state": "open",
      "user": "achow101",
      "created_at": "2021-02-23T18:29:20Z",
      "updated_at": "2026-02-26T16:41:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/21283",
      "labels": [
        "Wallet",
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 238,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 991865101,
      "number": 25573,
      "title": "guix: produce a `-static-pie` bitcoind",
      "body": "Use Guix to produce a `-static-pie` bitcoind using GCC `14.3.0` and glibc `2.43`. Using glibc for static builds, would be less of a leap compared to switching to musl libc (POC in #23203).\r\n\r\n[`-static-pie`](https://gcc.gnu.org/onlinedocs/gcc/Link-Options.html)\r\n> Produce a static position independent executable on targets that support it.\r\nA static position independent executable is similar to a static executable,\r\nbut can be loaded at any address without a dynamic linker.\r\n\r\n```bash\r\n# file bitcoind\r\n\tELF 64-bit LSB pie executable, x86-64, version 1 (GNU/Linux), static-pie linked, for GNU/Linux 3.2.0, stripped\r\n\r\n# ldd bitcoind\r\n\tstatically linked\r\n```\r\n\r\n`x86_64-linux-gnu` size comparison:\r\nmaster (a7e80676104b5c90c5b5e3bfab815d55a9061052) `bitcoind` is `15.35` megabytes.\r\nThis PR (597b5296d3adc693001ce39626fe32b9545eb604) `bitcoind` is `17.45` megabytes.\r\n\r\nFixes #19075.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2022-07-08T16:49:48Z",
      "updated_at": "2026-02-26T16:37:32Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/25573",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 926,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3329966718,
      "number": 34679,
      "title": "ci: Download script_assets_test.json for Windows CI",
      "body": "Fixes https://github.com/bitcoin/bitcoin/issues/34670 by adding a new `download_script_assets` Python helper and calling it.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-02-26T09:28:53Z",
      "updated_at": "2026-02-26T16:37:05Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34679",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 176,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1004149182,
      "number": 25665,
      "title": "refactor: Add util::Result failure types and ability to merge result values",
      "body": "Add `util::Result` support for returning more error information and make use of it in [LoadChainstate method](https://github.com/bitcoin/bitcoin/pull/25665/commits/0263614685582fed2290494f5233dbe038fc350c) as an initial application. Followup PRs [#25722](https://github.com/bitcoin/bitcoin/pull/25722) and [#29700](https://github.com/bitcoin/bitcoin/pull/29700) use it more broadly to return errors and warnings from wallet and kernel functions as well.\r\n\r\nThis change adds two major features to the result class:\r\n\r\n- For better error handling, adds the ability to return a value on failure, not just a value on success. This is a key missing feature that makes the result class not useful for functions like `LoadChainstate()` which produce different errors that need to be handled differently [^1].\r\n\r\n[^1]: Ability to return error values was actually present in the original implementation of [#25218](https://github.com/bitcoin/bitcoin/pull/25218), but unfortunately removed in later iterations. See [design notes](https://github.com/bitcoin-core/bitcoin-devwiki/wiki/util::Result-design-notes).\r\n\r\n- For better error reporting, adds the ability to return warning messages and multiple errors, not just a single error string. This provides a way for functions to report errors and warnings in a standard way, and simplifies interfaces:\r\n\r\n    ```diff\r\n    -virtual std::unique_ptr<Wallet> loadWallet(const std::string& name, bilingual_str& error, std::vector<bilingual_str>& warnings) = 0;\r\n    +virtual util::Result<std::unique_ptr<Wallet>> loadWallet(const std::string& name) = 0;\r\n    ```\r\n\r\n    ```diff\r\n    -std::unique_ptr<WalletDatabase> MakeDatabase(const fs::path& path, const DatabaseOptions& options, DatabaseStatus& status, bilingual_str& error);\r\n    +util::Result<std::unique_ptr<WalletDatabase>, DatabaseError> MakeDatabase(const fs::path& path, const DatabaseOptions& options);\r\n   ```\r\n\r\nThis change also makes some more minor improvements:\r\n\r\n- Smaller type size. `util::Result<int>` is 16 bytes, and `util::Result<void>` is 8 bytes. Previously both were 72 bytes.\r\n\r\n- Broader type compatibility. Supports noncopyable and nonmovable success and error types.\r\n\r\n### Comparison with `std::expected`\r\n\r\nCurrently, the `util::Result` class is useful for error reporting—returning translated, user-facing error strings—but not as useful for error handling, where callers need structured failure information to decide how to proceed. By contrast, `std::expected` / `util::Expected` (#34005, #34006) is good for error handling but less helpful for reporting. This PR closes the gap between the two classes.\r\n\r\nWith this PR, `std::expected` remains a good choice for lower-level functions or simple functions that fail in only a few well-defined ways. Meanwhile,\r\n\r\n- `Result` becomes a better choice for operations that can fail in many different ways—loading a wallet, connecting a block, etc.—where callers may want complete error traces, not just low-level errors without context or high-level errors without detail. (Followup [#25722](https://github.com/bitcoin/bitcoin/pull/25722) applies this to wallet-loading functions.) \r\n- `Result` can also be more useful than `expected` when merging status information from multiple calls. (Followup [#29700](https://github.com/bitcoin/bitcoin/pull/29700) uses this to reliably propagate flush and fatal-error status from validation code that can internally trigger flushes or shutdowns.)\r\n- `Result` may also be a better choice than `std::expected` when returning pointer values. (Followup [#26022](https://github.com/bitcoin/bitcoin/pull/26022) adds a `ResultPtr` specialization that avoids double dereferencing.) \r\n- `Result` can be more efficient than `std::expected` when failures are rare but failure objects are large, since failure values are heap-allocated.\r\n\r\nThis PR effectively makes `Result` a superset of `expected`, making the representations compatible and allowing them to be used together.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2022-07-21T12:46:09Z",
      "updated_at": "2026-02-26T16:33:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/25665",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 4045,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1047758233,
      "number": 26022,
      "title": "Add util::ResultPtr class",
      "body": "<!-- begin based-on -->\n**This is based on #25665.** The non-base commits are:\n\n- [`5142f017eaa` Add util::ResultPtr class](https://github.com/bitcoin/bitcoin/pull/26022/commits/5142f017eaa3b3f6d0109fc9f836e6243349d541)\n- [`8ef747c80fc` Use ResultPtr<unique_ptr> instead of Result<unique_ptr>](https://github.com/bitcoin/bitcoin/pull/26022/commits/8ef747c80fc3e39ecb2bb5856a489cbfc5737f48)<!-- end -->\n\n---\n\nThe `util::ResultPtr` class is a wrapper for `util::Result` providing syntax sugar to make it less awkward to use with returned pointers. Instead of needing to be deferenced twice with `**result` or `(*result)->member`, it only needs to be dereferenced once with `*result` or `result->member`. Also when it is used in a boolean context, instead of evaluating to true when there is no error and the pointer is null, it evaluates to false so it is straightforward to determine whether the result points to something.\n\nThis PR is only partial a solution to #26004 because while it makes it easier to check for null pointer values, it does not make it impossible to return a null pointer value inside a successful result. It would be possible to enforce that successful results always contain non-null pointers by using a `not_null` type (https://github.com/bitcoin/bitcoin/issues/24423) in combination with `ResultPtr`, though.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2022-09-06T15:57:14Z",
      "updated_at": "2026-02-26T16:30:04Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/26022",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1358,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3324961565,
      "number": 34667,
      "title": "test: ensure FastWalletRescanFilter is correctly updated during scanning",
      "body": "Part of https://github.com/bitcoin/bitcoin/pull/34400\r\n\r\nOn master, the `wallet_fast_rescan.py` test will pass even if the fast rescan filters are not updated during wallet rescan. This PR improves the `wallet_fast_rescan.py` test so that this no longer happens. Testers can verify by commenting out https://github.com/bitcoin/bitcoin/blob/master/src/wallet/wallet.cpp#L1901 and running the `wallet_fast_rescan.py` test. The test will pass on master but fail on this PR.",
      "state": "open",
      "user": "Eunovo",
      "created_at": "2026-02-25T10:26:44Z",
      "updated_at": "2026-02-26T16:28:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34667",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 543,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3309768200,
      "number": 34641,
      "title": "node: scale `-dbcache` default from total system RAM",
      "body": "### Problem\r\n\r\n`-dbcache` controls how much RAM Bitcoin Core uses for the in-memory view of the UTXO set, while the authoritative chainstate remains on disk.\r\nThe default is still the fixed `450 MiB` value, chosen almost a decade ago, even though chainstate size and typical hardware profiles have changed significantly since then.\r\n\r\nIn practice, a fixed 450 MiB default is often too conservative on modern systems, where larger cache sizes can reduce flush churn and disk roundtrips during validation, especially in IBD. At the same time, memory pressure remains important on smaller systems.\r\n\r\n### Historical changes\r\n\r\n| Date       | dbcache change | PR                                                                                                                                                                                                    |\r\n|------------|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\r\n| 2016-07-06 | 100 -> 300     | [#8273: Bump -dbcache default to 300MiB](https://github.com/bitcoin/bitcoin/commit/32cab91278651d07a11132b7636dc3d21144e616#diff-d102b6032635ce90158c1e6e614f03b50e4449aa46ce23370da5387a658342fdR25) |\r\n| 2017-04-05 | 300 -> 450     | [#10133: Clean up calculations of pcoinsTip memory usage](https://github.com/bitcoin/bitcoin/pull/10133/changes#diff-d102b6032635ce90158c1e6e614f03b50e4449aa46ce23370da5387a658342fdR31)             |\r\n\r\n### IRC\r\n\r\nThe Feb 17-19, 2026 discussion converged on avoiding a single new fixed `-dbcache` value and moving to RAM-aware defaults instead, balancing performance gains on modern hardware against OOM risk on lower-memory systems.\r\n\r\n<details>\r\n<summary>IRC log links</summary>\r\n\r\n* https://bitcoin-irc.chaincode.com/bitcoin-core-dev/2026-02-17\r\n* https://bitcoin-irc.chaincode.com/bitcoin-core-dev/2026-02-18\r\n* https://bitcoin-irc.chaincode.com/bitcoin-core-dev/2026-02-19\r\n\r\n</details>\r\n\r\n### Node provider defaults\r\n\r\n* [RaspiBlitz](https://x.com/RaspiBlitz/status/2026625309563388353) sets a higher dbcache during IBD (when no other apps are running), then lowers it after\r\n* [Start9](https://x.com/start9labs/status/2026651195167944775) can set the default dynamically based on total RAM; currently creates a user task to lower dbcache after IBD if it was increased\r\n* [MyNode](https://x.com/mynodebtc/status/2026694281541374418) automatically adjusts based on system memory (4 GB RAM → 1 GB cache, 8 GB RAM → 2.5 GB cache, 16 GB RAM → 4 GB cache) and also scales max mempool size\r\n* [Umbrel](https://x.com/lukechilds/status/2026899284474356081) used to default to 50% RAM during IBD then reduce to 200 MiB post-IBD, but removed that logic because dedicating that much RAM caused issues when users ran other apps; now ships Core defaults\r\n\r\n### Containerization\r\n\r\nThe container memory constraints are sometimes respected, but currently we rather warn if `cgroup` are detected.\r\nE.g. with `24 GiB` container (on a 64 GiB Mac) the related logs are:\r\n> Warning: Automatic -dbcache sizing may not reflect external memory limits. Set -dbcache explicitly if needed.\r\n2026-02-25T19:05:10Z Automatic -dbcache=2.9 GiB calculated using detected system memory of 23.4 GiB.\r\n2026-02-25T19:05:10Z * Using 2.9 GiB for in-memory UTXO set (plus up to 286 MiB of unused mempool space)\r\n\r\n<details><summary>Dockerization reproducer</summary>\r\n\r\n```bash\r\ndocker run --rm -it -v \"$PWD\":/work -w /work ubuntu:24.04 bash -lc 'set -euo pipefail && \\\r\nexport DEBIAN_FRONTEND=noninteractive && apt-get -qq update >/dev/null 2>&1 && apt-get -qq install -y --no-install-recommends ca-certificates build-essential cmake pkg-config ccache libevent-dev libboost-dev libsqlite3-dev libssl-dev zlib1g-dev >/dev/null 2>&1 && \\\r\ncmake -B build_docker -DBUILD_GUI=OFF -DENABLE_IPC=OFF >/dev/null 2>&1 && cmake --build build_docker --target bitcoind -j >/dev/null 2>&1 && \\\r\ntimeout 100s ./build_docker/bin/bitcoind -regtest -printtoconsole=1 -stopatheight=1 2>&1 | grep -E -- \"Automatic -dbcache|dbcache.*may be too large|in-memory UTXO set|UTXO set\" || true'\r\n```\r\n\r\n</details>\r\n\r\n### Fix\r\n\r\nReplace the fixed default with a RAM-aware policy:\r\n```math\r\n\\text{default\\_dbcache}=\\mathrm{clamp}\\left(100\\,\\mathrm{MiB},\\ 0.25\\cdot\\left(\\text{system RAM}-2\\,\\mathrm{GiB}\\right),\\ 3000\\,\\mathrm{MiB}\\right)\r\n```\r\n\r\nIf system RAM cannot be determined, assume 4 GiB on 64-bit builds and 2 GiB on 32-bit builds.\r\nManual `-dbcache` values are unchanged and still override the automatic default.\r\n\r\n### Warning threshold update\r\n\r\nOversized `-dbcache` warnings are kept and aligned with the new policy - warn if:\r\n- `dbcache > default-dbcache` when `RAM < fallback RAM` (4 GiB on 64-bit, 2 GiB on 32-bit)\r\n- `dbcache` > `75% of total RAM`, otherwise\r\n\r\n### Performance measurements\r\n\r\n#### reindex-chainstate\r\n\r\n<details><summary>N150 (Umbrel) - 1.20x faster reindex-chainstate with new default dbcache</summary>\r\n\r\n```bash\r\nfor DBCACHE in 450 1000 2000 3000; do \\\r\n  COMMITS=\"097c18239b58a8ee03794b3ebc6e722a0da30d8d\"; \\\r\n  STOP=936639; CC=gcc; CXX=g++; \\\r\n  BASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/BitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; \\\r\n  (echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done) && \\\r\n  (echo \"\" && echo \"$(date -I) | reindex-chainstate | ${STOP} blocks | dbcache ${DBCACHE} | $(hostname) | $(uname -m) | $(lscpu | grep 'Model name' | head -1 | cut -d: -f2 | xargs) | $(nproc) cores | $(free -h | awk '/^Mem:/{print $2}') RAM | $(lsblk -no ROTA $(df --output=source $BASE_DIR | tail -1) | grep -q 1 && echo HDD || echo SSD)\"; echo \"\") && \\\r\n  hyperfine \\\r\n    --sort command \\\r\n    --runs 1 \\\r\n    --export-json \"$BASE_DIR/rdx-$(sed -E 's/(\\w{8})\\w+ ?/\\1-/g;s/-$//'<<<\"$COMMITS\")-$STOP-$DBCACHE-$CC.json\" \\\r\n    --parameter-list COMMIT ${COMMITS// /,} \\\r\n    --prepare \"killall -9 bitcoind 2>/dev/null; rm -f ./build/bin/bitcoind; git clean -fxd; git reset --hard {COMMIT} && \\\r\n      cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=Release -DENABLE_IPC=OFF && ninja -C build bitcoind -j1 && \\\r\n      ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=1000 -printtoconsole=0; sleep 20; rm -f $DATA_DIR/debug.log\" \\\r\n    --conclude \"killall bitcoind || true; sleep 5; grep -q 'height=0' $DATA_DIR/debug.log && grep -q 'Disabling script verification at block #1' $DATA_DIR/debug.log && grep -q 'height=$STOP' $DATA_DIR/debug.log && grep 'Bitcoin Core version' $DATA_DIR/debug.log | grep -q \"$(printf %.12s {COMMIT})\"; \\\r\n                cp $DATA_DIR/debug.log $LOG_DIR/debug-{COMMIT}-$(date +%s).log\" \\\r\n    \"COMPILER=$CC ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=$DBCACHE -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0\";\r\ndone\r\n```\r\n\r\n> 097c18239b Merge bitcoin/bitcoin#34385: subprocess: Fix `-Wunused-private-field` when building with clang-cl on Windows\r\n\r\n> 2026-02-19 | reindex-chainstate | 936639 blocks | dbcache 450 | umbrel | x86_64 | Intel(R) N150 | 4 cores | 15Gi RAM | SSD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=936639 -dbcache=450 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n  Time (abs ≡):        33619.332 s               [User: 61450.140 s, System: 5671.449 s]\r\n```\r\n\r\n> 2026-02-25 | reindex-chainstate | 936639 blocks | dbcache 1000 | umbrel | x86_64 | Intel(R) N150 | 4 cores | 15Gi RAM | SSD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=936639 -dbcache=1000 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n\r\n  Time (abs ≡):        29948.973 s               [User: 51470.950 s, System: 3405.477 s]\r\n```\r\n\r\n> 2026-02-25 | reindex-chainstate | 936639 blocks | dbcache 2000 | umbrel | x86_64 | Intel(R) N150 | 4 cores | 15Gi RAM | SSD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=936639 -dbcache=2000 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n  Time (abs ≡):        28352.766 s               [User: 46633.422 s, System: 2298.085 s]\r\n```\r\n\r\n> 2026-02-20 | reindex-chainstate | 936639 blocks | dbcache 3000 | umbrel | x86_64 | Intel(R) N150 | 4 cores | 15Gi RAM | SSD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=936639 -dbcache=3000 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n  Time (abs ≡):        27910.440 s               [User: 44917.351 s, System: 2090.958 s]\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Rpi5 (16) - 1.21x faster reindex-chainstate with new default dbcache</summary>\r\n\r\n```bash\r\nfor DBCACHE in 450 1000 2000 3000; do \\\r\n  COMMITS=\"097c18239b58a8ee03794b3ebc6e722a0da30d8d\"; \\\r\n  STOP=936639; CC=gcc; CXX=g++; \\\r\n  BASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/BitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; \\\r\n  (echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done) && \\\r\n  (echo \"\" && echo \"$(date -I) | reindex-chainstate | ${STOP} blocks | dbcache ${DBCACHE} | $(hostname) | $(uname -m) | $(lscpu | grep 'Model name' | head -1 | cut -d: -f2 | xargs) | $(nproc) cores | $(free -h | awk '/^Mem:/{print $2}') RAM | $(lsblk -no ROTA $(df --output=source $BASE_DIR | tail -1) | grep -q 1 && echo HDD || echo SSD)\"; echo \"\") && \\\r\n  hyperfine \\\r\n    --sort command \\\r\n    --runs 1 \\\r\n    --export-json \"$BASE_DIR/rdx-$(sed -E 's/(\\w{8})\\w+ ?/\\1-/g;s/-$//'<<<\"$COMMITS\")-$STOP-$DBCACHE-$CC.json\" \\\r\n    --parameter-list COMMIT ${COMMITS// /,} \\\r\n    --prepare \"killall -9 bitcoind 2>/dev/null; rm -f ./build/bin/bitcoind; git clean -fxd; git reset --hard {COMMIT} && \\\r\n      cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=Release -DENABLE_IPC=OFF && ninja -C build bitcoind -j1 && \\\r\n      ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=1000 -printtoconsole=0; sleep 20; rm -f $DATA_DIR/debug.log\" \\\r\n    --conclude \"killall bitcoind || true; sleep 5; grep -q 'height=0' $DATA_DIR/debug.log && grep -q 'Disabling script verification at block #1' $DATA_DIR/debug.log && grep -q 'height=$STOP' $DATA_DIR/debug.log && grep 'Bitcoin Core version' $DATA_DIR/debug.log | grep -q \"$(printf %.12s {COMMIT})\"; \\\r\n                cp $DATA_DIR/debug.log $LOG_DIR/debug-{COMMIT}-$(date +%s).log\" \\\r\n    \"COMPILER=$CC ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=$DBCACHE -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0\";\r\ndone\r\n```\r\n\r\n> 097c18239b Merge bitcoin/bitcoin#34385: subprocess: Fix `-Wunused-private-field` when building with clang-cl on Windows\r\n\r\n> 2026-02-19 | reindex-chainstate | 936639 blocks | dbcache 450 | rpi5-16-2 | aarch64 | Cortex-A76 | 4 cores | 15Gi RAM | SSD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=936639 -dbcache=450 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n  Time (abs ≡):        48933.904 s               [User: 94560.562 s, System: 7823.574 s]\r\n```\r\n\r\n> 2026-02-24 | reindex-chainstate | 936639 blocks | dbcache 1000 | rpi5-16-2 | aarch64 | Cortex-A76 | 4 cores | 15Gi RAM | SSD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=936639 -dbcache=1000 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n  Time (abs ≡):        43856.539 s               [User: 78451.084 s, System: 5183.434 s]\r\n```\r\n\r\n> 2026-02-25 | reindex-chainstate | 936639 blocks | dbcache 2000 | rpi5-16-2 | aarch64 | Cortex-A76 | 4 cores | 15Gi RAM | SSD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=936639 -dbcache=2000 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n  Time (abs ≡):        39259.025 s               [User: 69044.492 s, System: 3227.006 s]\r\n```\r\n\r\n> 2026-02-20 | reindex-chainstate | 936639 blocks | dbcache 3000 | rpi5-16-2 | aarch64 | Cortex-A76 | 4 cores | 15Gi RAM | SSD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=936639 -dbcache=3000 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n  Time (abs ≡):        40586.782 s               [User: 65901.116 s, System: 3260.832 s]\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Rpi5 (8) - 1.43x faster reindex-chainstate with new default dbcache</summary>\r\n\r\n```bash\r\nfor DBCACHE in 450 1000 1536 2000; do \\\r\n  COMMITS=\"097c18239b58a8ee03794b3ebc6e722a0da30d8d\"; \\\r\n  STOP=936639; CC=gcc; CXX=g++; \\\r\n  BASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/BitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; \\\r\n  (echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done) && \\\r\n  (echo \"\" && echo \"$(date -I) | reindex-chainstate | ${STOP} blocks | dbcache ${DBCACHE} | $(hostname) | $(uname -m) | $(lscpu | grep 'Model name' | head -1 | cut -d: -f2 | xargs) | $(nproc) cores | $(free -h | awk '/^Mem:/{print $2}') RAM | $(lsblk -no ROTA $(df --output=source $BASE_DIR | tail -1) | grep -q 1 && echo HDD || echo SSD)\"; echo \"\") && \\\r\n  hyperfine \\\r\n    --sort command \\\r\n    --runs 1 \\\r\n    --export-json \"$BASE_DIR/rdx-$(sed -E 's/(\\w{8})\\w+ ?/\\1-/g;s/-$//'<<<\"$COMMITS\")-$STOP-$DBCACHE-$CC.json\" \\\r\n    --parameter-list COMMIT ${COMMITS// /,} \\\r\n    --prepare \"killall -9 bitcoind 2>/dev/null; rm -f ./build/bin/bitcoind; git clean -fxd; git reset --hard {COMMIT} && \\\r\n      cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=Release -DENABLE_IPC=OFF && ninja -C build bitcoind -j1 && \\\r\n      ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=1000 -printtoconsole=0; sleep 20; rm -f $DATA_DIR/debug.log\" \\\r\n    --conclude \"killall bitcoind || true; sleep 5; grep -q 'height=0' $DATA_DIR/debug.log && grep -q 'Disabling script verification at block #1' $DATA_DIR/debug.log && grep -q 'height=$STOP' $DATA_DIR/debug.log && grep 'Bitcoin Core version' $DATA_DIR/debug.log | grep -q \"$(printf %.12s {COMMIT})\"; \\\r\n                cp $DATA_DIR/debug.log $LOG_DIR/debug-{COMMIT}-$(date +%s).log\" \\\r\n    \"COMPILER=$CC ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=$DBCACHE -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0\";\r\ndone\r\n```\r\n\r\n> 097c18239b Merge bitcoin/bitcoin#34385: subprocess: Fix `-Wunused-private-field` when building with clang-cl on Windows\r\n\r\n> 2026-02-19 | reindex-chainstate | 936639 blocks | dbcache 450 | rpi5-8 | aarch64 | Cortex-A76 | 4 cores | 7.7Gi RAM | SSD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=936639 -dbcache=450 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n  Time (abs ≡):        187564.724 s               [User: 98927.942 s, System: 19100.209 s]\r\n```\r\n\r\n> 2026-02-22 | reindex-chainstate | 936639 blocks | dbcache 1536 | rpi5-8 | aarch64 | Cortex-A76 | 4 cores | 7.7Gi RAM | SSD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=936639 -dbcache=1536 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n  Time (abs ≡):        131061.887 s               [User: 71355.478 s, System: 12038.086 s]\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Apple M4 Max - 2.87x faster reindex-chainstate with new default dbcache</summary>\r\n\r\n```bash\r\nfor DBCACHE in 450 1000 2000 3000; do \\\r\n  COMMITS=\"097c18239b58a8ee03794b3ebc6e722a0da30d8d\"; \\\r\n  STOP=900000; \\\r\n  DATA_DIR=\"$HOME/Library/Application Support/Bitcoin\"; LOG_DIR=\"$HOME/bitcoin-reindex-logs\"; mkdir -p \"$LOG_DIR\"; \\\r\n  COMMA_COMMITS=${COMMITS// /,}; \\\r\n  (echo \"\"; for c in $(echo $COMMITS); do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done) && \\\r\n  (echo \"\" && echo \"$(date -I) | reindex-chainstate | ${STOP} blocks | dbcache ${DBCACHE} | $(hostname) | $(uname -m) | $(sysctl -n machdep.cpu.brand_string) | $(nproc) cores | $(printf '%.1fGiB' \"$(( $(sysctl -n hw.memsize)/1024/1024/1024 ))\") RAM | SSD | $(sw_vers -productName) $(sw_vers -productVersion) $(sw_vers -buildVersion) | $(xcrun clang --version | head -1)\"; echo \"\") && \\\r\n  hyperfine \\\r\n    --sort command \\\r\n    --runs 1 \\\r\n    --export-json \"$LOG_DIR/rdx-$(echo \"$COMMITS\" | sed -E 's/([a-f0-9]{8})[a-f0-9]+ ?/\\1-/g;s/-$//')-$STOP-$DBCACHE-appleclang.json\" \\\r\n    --parameter-list COMMIT \"$COMMA_COMMITS\" \\\r\n    --prepare \"killall -9 bitcoind 2>/dev/null || true; rm -f \\\"$DATA_DIR\\\"/debug.log; git checkout {COMMIT}; git reset --hard && \\\r\n      cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=Release && ninja -C build bitcoind -j2 && \\\r\n      ./build/bin/bitcoind -datadir=\\\"$DATA_DIR\\\" -stopatheight=$STOP -dbcache=1000 -printtoconsole=0; sleep 20\" \\\r\n    --conclude \"killall bitcoind 2>/dev/null || true; sleep 5; grep -q 'height=0' \\\"$DATA_DIR\\\"/debug.log && grep -q 'Disabling script verification at block #1' \\\"$DATA_DIR\\\"/debug.log && grep -q \\\"height=$STOP\\\" \\\"$DATA_DIR\\\"/debug.log || { echo 'debug.log assertions failed'; exit 1; }; \\\r\n                cp \\\"$DATA_DIR\\\"/debug.log \\\"$LOG_DIR\\\"/debug-{COMMIT}-\\$(date +%s).log 2>/dev/null || true\" \\\r\n    \"./build/bin/bitcoind -datadir=\\\"$DATA_DIR\\\" -stopatheight=$STOP -dbcache=$DBCACHE -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0\";\r\ndone\r\n```\r\n\r\n> 097c18239b Merge bitcoin/bitcoin#34385: subprocess: Fix `-Wunused-private-field` when building with clang-cl on Windows\r\n\r\n> 2026-02-21 | reindex-chainstate | 900000 blocks | dbcache 450 | M4-Max.local | arm64 | Apple M4 Max | 16 cores | 64.0GiB RAM | SSD | macOS 26.2 25C56 | Apple clang version 17.0.0 (clang-1700.6.3.2)\r\n\r\n```bash\r\nBenchmark 1: ./build/bin/bitcoind -datadir=\"/Users/lorinc/Library/Application Support/Bitcoin\" -stopatheight=900000 -dbcache=450 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n  Time (abs ≡):        20261.315 s               [User: 18768.521 s, System: 4271.673 s]\r\n```\r\n\r\n> 2026-02-21 | reindex-chainstate | 900000 blocks | dbcache 3000 | M4-Max.local | arm64 | Apple M4 Max | 16 cores | 64.0GiB RAM | SSD | macOS 26.2 25C56 | Apple clang version 17.0.0 (clang-1700.6.3.2)\r\n\r\n```bash\r\nBenchmark 1: ./build/bin/bitcoind -datadir=\"/Users/lorinc/Library/Application Support/Bitcoin\" -stopatheight=900000 -dbcache=3000 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n  Time (abs ≡):        7064.184 s               [User: 7701.391 s, System: 668.060 s]\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>i7 HDD - 1.55x faster reindex-chainstate with new default dbcache</summary>\r\n\r\n```bash\r\nfor DBCACHE in 450 1000 2000 3000; do \\\r\n  COMMITS=\"097c18239b58a8ee03794b3ebc6e722a0da30d8d\"; \\\r\n  STOP=936639; CC=gcc; CXX=g++; \\\r\n  BASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/BitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; \\\r\n  (echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done) && \\\r\n  (echo \"\" && echo \"$(date -I) | reindex-chainstate | ${STOP} blocks | dbcache ${DBCACHE} | $(hostname) | $(uname -m) | $(lscpu | grep 'Model name' | head -1 | cut -d: -f2 | xargs) | $(nproc) cores | $(free -h | awk '/^Mem:/{print $2}') RAM | $(lsblk -no ROTA $(df --output=source $BASE_DIR | tail -1) | grep -q 1 && echo HDD || echo SSD)\"; echo \"\") && \\\r\n  hyperfine \\\r\n    --sort command \\\r\n    --runs 1 \\\r\n    --export-json \"$BASE_DIR/rdx-$(sed -E 's/(\\w{8})\\w+ ?/\\1-/g;s/-$//'<<<\"$COMMITS\")-$STOP-$DBCACHE-$CC.json\" \\\r\n    --parameter-list COMMIT ${COMMITS// /,} \\\r\n    --prepare \"killall -9 bitcoind 2>/dev/null; rm -f ./build/bin/bitcoind; git clean -fxd; git reset --hard {COMMIT} && \\\r\n      cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=Release -DENABLE_IPC=OFF && ninja -C build bitcoind -j1 && \\\r\n      ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=1000 -printtoconsole=0; sleep 20; rm -f $DATA_DIR/debug.log\" \\\r\n    --conclude \"killall bitcoind || true; sleep 5; grep -q 'height=0' $DATA_DIR/debug.log && grep -q 'Disabling script verification at block #1' $DATA_DIR/debug.log && grep -q 'height=$STOP' $DATA_DIR/debug.log && grep 'Bitcoin Core version' $DATA_DIR/debug.log | grep -q \"$(printf %.12s {COMMIT})\"; \\\r\n                cp $DATA_DIR/debug.log $LOG_DIR/debug-{COMMIT}-$(date +%s).log\" \\\r\n    \"COMPILER=$CC ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=$DBCACHE -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0\";\r\ndone\r\n```\r\n\r\n> 097c18239b Merge bitcoin/bitcoin#34385: subprocess: Fix `-Wunused-private-field` when building with clang-cl on Windows\r\n\r\n> 2026-02-21 | reindex-chainstate | 936639 blocks | dbcache 450 | i7-hdd | x86_64 | Intel(R) Core(TM) i7-7700 CPU @ 3.60GHz | 8 cores | 62Gi RAM | HDD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=936639 -dbcache=450 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n  Time (abs ≡):        47384.896 s               [User: 54460.024 s, System: 3388.557 s]\r\n```\r\n\r\n> 2026-02-24 | reindex-chainstate | 936639 blocks | dbcache 1000 | i7-hdd | x86_64 | Intel(R) Core(TM) i7-7700 CPU @ 3.60GHz | 8 cores | 62Gi RAM | HDD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=936639 -dbcache=1000 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n  Time (abs ≡):        37486.190 s               [User: 46563.682 s, System: 2189.609 s]\r\n```\r\n\r\n> 2026-02-25 | reindex-chainstate | 936639 blocks | dbcache 2000 | i7-hdd | x86_64 | Intel(R) Core(TM) i7-7700 CPU @ 3.60GHz | 8 cores | 62Gi RAM | HDD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=936639 -dbcache=2000 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n  Time (abs ≡):        31379.903 s               [User: 41546.866 s, System: 1383.556 s]\r\n```\r\n\r\n> 2026-02-21 | reindex-chainstate | 936639 blocks | dbcache 3000 | i7-hdd | x86_64 | Intel(R) Core(TM) i7-7700 CPU @ 3.60GHz | 8 cores | 62Gi RAM | HDD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=936639 -dbcache=3000 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 097c18239b58a8ee03794b3ebc6e722a0da30d8d)\r\n  Time (abs ≡):        30633.603 s               [User: 39511.869 s, System: 1116.371 s]\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Windows Xeon - 1.24x faster reindex-chainstate with new default dbcache</summary>\r\n\r\n```bash\r\nfor DBCACHE in 450 1000 2000 3000; do \\\r\n  COMMITS=\"5401e673d56198f2c0bad366581e70d5d9cd765c\"; \\\r\n  STOP=933339; \\\r\n  HOST=x86_64-w64-mingw32; \\\r\n  XPACK=\"/home/win/xpack-mingw-w64-gcc-15.2.0-2\"; \\\r\n  BASE_DIR=\"/mnt/c/my_storage\"; DATA_DIR=\"$BASE_DIR/BitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; \\\r\n  WIN_DATA_DIR='C:\\\\my_storage\\\\BitcoinData'; \\\r\n  export PATH=\"$XPACK/bin:$PATH\"; \\\r\n  mkdir -p \"$LOG_DIR\"; \\\r\n  (echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done) && \\\r\n  (echo \"\" && echo \"$(date -I) | reindex-chainstate | ${STOP} blocks | dbcache ${DBCACHE} | $(hostname) | $(uname -m) | $(lscpu | grep 'Model name' | head -1 | cut -d: -f2 | xargs) | $(nproc) cores | $(free -h | awk '/^Mem:/{print $2}') RAM | win64-gcc15\"; echo \"\") && \\\r\n  hyperfine \\\r\n    --sort command \\\r\n    --runs 1 \\\r\n    --export-json \"$BASE_DIR/rdx-$(sed -E 's/(\\w{8})\\w+ ?/\\1-/g;s/-$//'<<<\"$COMMITS\")-$STOP-$DBCACHE-win64.json\" \\\r\n    --parameter-list COMMIT ${COMMITS// /,} \\\r\n    --prepare \"taskkill.exe /IM bitcoind.exe /F 2>/dev/null; rm -f ./build/bin/bitcoind.exe; rm -f $DATA_DIR/debug.log; git clean -fxd -e depends/built -e depends/sources -e depends/$HOST; git reset --hard {COMMIT} && \\\r\n      make -C depends HOST=$HOST NO_QT=1 NO_ZMQ=1 CC=\\\"$XPACK/bin/x86_64-w64-mingw32-gcc\\\" CXX=\\\"$XPACK/bin/x86_64-w64-mingw32-g++\\\" -j\\$(nproc) && \\\r\n      cmake -B build -G Ninja --toolchain depends/$HOST/toolchain.cmake -DCMAKE_BUILD_TYPE=Release -DBUILD_GUI=OFF -DWITH_ZMQ=OFF -DBUILD_TESTS=OFF -DBUILD_BENCH=OFF && \\\r\n      ninja -C build bitcoind -j\\$(nproc) && \\\r\n      ./build/bin/bitcoind.exe -datadir=\\\"$WIN_DATA_DIR\\\" -stopatheight=$STOP -dbcache=1000 -printtoconsole=0; sleep 20; rm -f $DATA_DIR/debug.log\" \\\r\n    --conclude \"taskkill.exe /IM bitcoind.exe /F 2>/dev/null; sleep 5; grep -q 'height=0' $DATA_DIR/debug.log && grep -q 'height=$STOP' $DATA_DIR/debug.log && grep 'Bitcoin Core version' $DATA_DIR/debug.log | grep -q \"$(printf %.12s {COMMIT})\"; \\\r\n      cp $DATA_DIR/debug.log $LOG_DIR/debug-{COMMIT}-\\$(date +%s).log\" \\\r\n    \"./build/bin/bitcoind.exe -datadir=\\\"$WIN_DATA_DIR\\\" -stopatheight=$STOP -dbcache=$DBCACHE -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0\"; \\\r\ndone\r\n```\r\n\r\n> 5401e673d5 Merge bitcoin/bitcoin#33604: p2p: Allow block downloads from peers without snapshot block after assumeutxo validation\r\n\r\n> 2026-02-10 | reindex-chainstate | 933339 blocks | dbcache 450 | WIN-A2EHOAU4JET | x86_64 | Intel(R) Xeon(R) CPU E5-2637 v2 @ 3.50GHz | 8 cores | 31Gi RAM | win64-gcc15\r\n\r\n```bash\r\nBenchmark 1: ./build/bin/bitcoind.exe -datadir=\"C:\\\\my_storage\\\\BitcoinData\" -stopatheight=933339 -dbcache=450 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 5401e673d56198f2c0bad366581e70d5d9cd765c)\r\n  Time (abs ≡):        37691.648 s               [User: 0.000 s, System: 0.001 s]\r\n```\r\n\r\n> 2026-02-24 | reindex-chainstate | 933339 blocks | dbcache 1000 | WIN-A2EHOAU4JET | x86_64 | Intel(R) Xeon(R) CPU E5-2637 v2 @ 3.50GHz | 8 cores | 31Gi RAM | win64-gcc15\r\n\r\n```bash\r\nBenchmark 1: ./build/bin/bitcoind.exe -datadir=\"C:\\\\my_storage\\\\BitcoinData\" -stopatheight=933339 -dbcache=1000 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 5401e673d56198f2c0bad366581e70d5d9cd765c)\r\n  Time (abs ≡):        34250.996 s               [User: 0.002 s, System: 0.000 s]\r\n```\r\n\r\n> 2026-02-21 | reindex-chainstate | 933339 blocks | dbcache 3000 | WIN-A2EHOAU4JET | x86_64 | Intel(R) Xeon(R) CPU E5-2637 v2 @ 3.50GHz | 8 cores | 31Gi RAM | win64-gcc15\r\n\r\n```bash\r\nBenchmark 2: ./build/bin/bitcoind.exe -datadir=\"C:\\\\my_storage\\\\BitcoinData\" -stopatheight=933339 -dbcache=3000 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 5401e673d56198f2c0bad366581e70d5d9cd765c)\r\n  Time (abs ≡):        30276.311 s               [User: 0.001 s, System: 0.000 s]\r\n```\r\n\r\n</details>\r\n\r\n#### pruned IBD\r\n\r\n<details><summary>i9 SSD - 1.05x faster pruned IBD with new default dbcache</summary>\r\n\r\n```bash\r\nfor DBCACHE in 450 1000 2000 3000; do \\\r\n  COMMITS=\"5a8a427610ed9672f485ebfefbb8e63b55282636\"; \\\r\n  STOP=933339; PRUNE=550; \\\r\n  CC=gcc; CXX=g++; \\\r\n  BASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/ShallowBitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; \\\r\n  (echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done) && \\\r\n  (echo \"\" && echo \"$(date -I) | pruned IBD | ${STOP} blocks | dbcache ${DBCACHE} | pruning ${PRUNE} | $(hostname) | $(uname -m) | $(lscpu | grep 'Model name' | head -1 | cut -d: -f2 | xargs) | $(nproc) cores | $(free -h | awk '/^Mem:/{print $2}') RAM | $(df -T $BASE_DIR | awk 'NR==2{print $2}') | $(lsblk -no ROTA $(df --output=source $BASE_DIR | tail -1) | grep -q 1 && echo HDD || echo SSD)\"; echo \"\") &&\\\r\n  hyperfine \\\r\n    --sort command \\\r\n    --runs 2 \\\r\n    --export-json \"$BASE_DIR/ibd-$(sed -E 's/(\\w{8})\\w+ ?/\\1-/g;s/-$//'<<<\"$COMMITS\")-$STOP-$DBCACHE-$CC.json\" \\\r\n    --parameter-list COMMIT ${COMMITS// /,} \\\r\n    --prepare \"killall -9 bitcoind 2>/dev/null; rm -rf $DATA_DIR/*; git clean -fxd; git reset --hard {COMMIT} && \\\r\n      cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=Release && ninja -C build bitcoind -j2 && \\\r\n      ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=1 -prune=$PRUNE -printtoconsole=0; sleep 20\" \\\r\n    --conclude \"killall bitcoind || true; sleep 5; grep -q 'height=0' $DATA_DIR/debug.log && grep -q 'Disabling script verification at block #1' $DATA_DIR/debug.log && grep -q 'height=$STOP' $DATA_DIR/debug.log && grep 'Bitcoin Core version' $DATA_DIR/debug.log | grep -q \"$(printf %.12s {COMMIT})\"; \\\r\n                cp $DATA_DIR/debug.log $LOG_DIR/debug-{COMMIT}-$(date +%s).log\" \\\r\n    \"COMPILER=$CC ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=$DBCACHE -blocksonly -prune=$PRUNE -printtoconsole=0\";\r\ndone\r\n```\r\n\r\n> 5a8a427610 Merge bitcoin/bitcoin#32745: scripted-diff: Update DeriveType enum values to mention ranged derivations\r\n\r\n> 2026-02-19 | pruned IBD | 933339 blocks | dbcache 450 | pruning 550 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | xfs | SSD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/ShallowBitcoinData -stopatheight=933339 -dbcache=450 -blocksonly -prune=550 -printtoconsole=0 (COMMIT = 5a8a427610ed9672f485ebfefbb8e63b55282636)\r\n  Time (mean ± σ):     33256.735 s ± 954.998 s    [User: 74373.368 s, System: 4904.305 s]\r\n  Range (min … max):   32581.449 s … 33932.020 s    2 runs\r\n```\r\n\r\n> 2026-02-24 | pruned IBD | 933339 blocks | dbcache 1000 | pruning 550 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | xfs | SSD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/ShallowBitcoinData -stopatheight=933339 -dbcache=1000 -blocksonly -prune=550 -printtoconsole=0 (COMMIT = 5a8a427610ed9672f485ebfefbb8e63b55282636)\r\n  Time (mean ± σ):     32411.395 s ± 344.595 s    [User: 73219.225 s, System: 5052.158 s]\r\n  Range (min … max):   32167.729 s … 32655.060 s    2 runs\r\n```\r\n\r\n> 2026-02-25 | pruned IBD | 933339 blocks | dbcache 2000 | pruning 550 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | xfs | SSD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/ShallowBitcoinData -stopatheight=933339 -dbcache=2000 -blocksonly -prune=550 -printtoconsole=0 (COMMIT = 5a8a427610ed9672f485ebfefbb8e63b55282636)\r\n  Time (mean ± σ):     32817.496 s ± 153.570 s    [User: 72174.756 s, System: 4840.234 s]\r\n  Range (min … max):   32708.905 s … 32926.086 s    2 runs\r\n```\r\n\r\n> 5a8a427610 Merge bitcoin/bitcoin#32745: scripted-diff: Update DeriveType enum values to mention ranged derivations\r\n\r\n> 2026-02-20 | pruned IBD | 933339 blocks | dbcache 3000 | pruning 550 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | xfs | SSD\r\n\r\n```bash\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/ShallowBitcoinData -stopatheight=933339 -dbcache=3000 -blocksonly -prune=550 -printtoconsole=0 (COMMIT = 5a8a427610ed9672f485ebfefbb8e63b55282636)\r\n  Time (mean ± σ):     31670.463 s ± 621.972 s    [User: 70829.639 s, System: 4403.924 s]\r\n  Range (min … max):   31230.663 s … 32110.264 s    2 runs\r\n```\r\n\r\n</details>\r\n\r\n### Quick reference (64 bit)\r\n\r\n| System RAM | Automatic default | Warning fires above |\r\n|------------|-------------------|---------------------|\r\n| 1 GiB      | 100 MiB           | 100 MiB             |\r\n| 2 GiB      | 100 MiB           | 100 MiB             |\r\n| 4 GiB      | 512 MiB           | 3071 MiB            |\r\n| 8 GiB      | 1536 MiB          | 6143 MiB            |\r\n| 16 GiB     | 3000 MiB          | 12287 MiB           |\r\n| 32 GiB     | 3000 MiB          | 24575 MiB           |\r\n\r\n<img width=\"1384\" height=\"583\" alt=\"image\" src=\"https://github.com/user-attachments/assets/2ccca03e-9130-457c-b386-f8aea15de955\" />\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-02-20T23:00:45Z",
      "updated_at": "2026-02-26T16:25:30Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34641",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 32361,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3203071670,
      "number": 34389,
      "title": "net/log: standardize peer+addr log formatting via `LogPeer`",
      "body": "This is an alternative to #34293, but aims to address the remaining logging inconsistencies more broadly.\r\nIt extends the example fixed there to every instance, restores the original separator behavior, applies it consistently via a single helper, and adds tests for `logips` (covering both current and new behavior).\r\n\r\n### Problem\r\nAfter #28521 centralized peer address logging into `CNode::LogIP()`, the original comma separator before `peeraddr=` was lost, resulting in inconsistent formatting across net (and recent private broadcast) logs.\r\nSome lines also had double spaces, empty fields, or mismatched format specifiers.\r\n\r\n### Fix\r\nIntroduces `CNode::LogPeer(bool)` which always emits `peer=<id>` and, when `-logips=1`, appends `, peeraddr=<addr>`. This eliminates hand-rolled separators and makes peer identification predictable.\r\nMinor issues (double spaces, empty placeholders, format specifiers) are fixed along the way in separate commits.\r\n\r\n### Reproducer\r\nRun with `-debug=net -logips=1` and observe peer log lines now show `peer=<id>, peeraddr=<addr>` (comma-separated). The new assertion in `feature_logging.py` automates this check.\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-23T12:09:26Z",
      "updated_at": "2026-02-26T16:24:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34389",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1214,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3207254787,
      "number": 34400,
      "title": "wallet: parallel fast rescan (approx 5x speed up with 16 threads)",
      "body": "EDIT: Some parts of this PR have been split into https://github.com/bitcoin/bitcoin/pull/34667 and  https://github.com/bitcoin/bitcoin/pull/34681 to ease review. This PR will be put in draft until the previous PRs have been merged.\r\n\r\nThis PR uses the [ThreadPool](https://github.com/bitcoin/bitcoin/blob/master/src/util/threadpool.h) to implement parallel fast rescan.\r\n\r\nThis PR:\r\n- Adds a `ThreadPool` to the `WalletContext` to be shared by all the wallets\r\n- Adds `-walletpar` parameter to configure the number of threads to be used for parallel scanning \r\n- Updates the `wallet_fast_rescan.py` test to ensure it catches cases where the FastRescan filter wasn't properly updated. This is crucial to ensure that changes in the PR do not cause newly added output scripts to be missed.\r\n- Refactors `ScanForWalletTransactions` to make the implementation of parallel scanning easier.\r\n- Implements parallel scanning\r\n\r\nBenchmarks:\r\n**NOTE: to reproduce, please tune your system with `pyperf system tune`**\r\n\r\n_EDIT\r\nSet up your node to use block filters by setting `blockfilterindex=1` in your bitcoin.conf file and ensure your blockfilterindex is synced to tip before attempting to reproduce._\r\n\r\nUsing the following command on mainnet with a wallet with no scripts and hyperfine version `1.20.0`:\r\n```\r\nhyperfine --show-output --export-markdown results.md --export-json results.json  \\\r\n--sort command \\\r\n--runs 3 \\\r\n-L commit ef847e8,37d356b \\\r\n-L num_threads 1,2,4,8,16 \\\r\n--prepare 'git checkout {commit} && cmake --build build -j 20 && build/bin/bitcoind -blockfilterindex=1 -walletpar={num_threads} && sleep 10 && build/bin/bitcoin-cli loadwalllet <wallet-name>' \\\r\n--conclude 'build/bin/bitcoin-cli stop && sleep 10' \\\r\n'build/bin/bitcoin-cli rescanblockchain 500000 900000'\r\n```\r\nI obtained the following results:\r\n| Command | Mean [s] | Min [s] | Max [s] | Relative |\r\n|:---|---:|---:|---:|---:|\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = baseline, num_threads = ..)` | 536.996 ± 0.722 | 536.257 | 537.701 | 4.64 ± 0.01 |\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = parallel_scan, num_threads = 1)` | 540.210 ± 2.696 | 537.172 | 542.320 | 4.67 ± 0.03 |\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = parallel_scan, num_threads = 2)` | 358.190 ± 0.515 | 357.675 | 358.706 | 3.10 ± 0.01 |\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = parallel_scan, num_threads = 4)` | 230.217 ± 2.321 | 228.814 | 232.896 | 1.99 ± 0.02 |\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = parallel_scan, num_threads = 8)` | 151.144 ± 1.748 | 149.506 | 152.984 | 1.31 ± 0.02 |\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = parallel_scan, num_threads = 16)` | 115.642 ± 0.305 | 115.390 | 115.982 | 1.00 |\r\n\r\nSystem information:\r\n```\r\nArchitecture:             x86_64\r\n  CPU op-mode(s):         32-bit, 64-bit\r\n  Address sizes:          46 bits physical, 48 bits virtual\r\n  Byte Order:             Little Endian\r\nCPU(s):                   20\r\n  On-line CPU(s) list:    0-19\r\nVendor ID:                GenuineIntel\r\n  Model name:             Intel(R) Core(TM) Ultra 7 265\r\n    CPU family:           6\r\n    Model:                198\r\n    Thread(s) per core:   1\r\n    Core(s) per socket:   1\r\n    Socket(s):            20\r\n    Stepping:             2\r\n    CPU(s) scaling MHz:   41%\r\n    CPU max MHz:          4800.0000\r\n    CPU min MHz:          800.0000\r\n    BogoMIPS:             4761.60\r\n```\r\n\r\nFurther benchmarks were performed using a [python script](https://github.com/Eunovo/rescan-benchmark) with custom chains designed with payments at specified intervals, and the following graph was produced:\r\n\r\n<img width=\"4760\" height=\"8950\" alt=\"benchmark_comparison\" src=\"https://github.com/user-attachments/assets/1ba8c64d-cfca-4360-af06-1f034a30e307\" />\r\n\r\nThis graph was produced from a laptop with the following CPU specifications:\r\n```\r\nArchitecture:                x86_64\r\n  CPU op-mode(s):            32-bit, 64-bit\r\n  Address sizes:             48 bits physical, 48 bits virtual\r\n  Byte Order:                Little Endian\r\nCPU(s):                      16\r\n  On-line CPU(s) list:       0-15\r\nVendor ID:                   AuthenticAMD\r\n  Model name:                AMD Ryzen 9 8945HS w/ Radeon 780M Graphics\r\n    CPU family:              25\r\n    Model:                   117\r\n    Thread(s) per core:      2\r\n    Core(s) per socket:      8\r\n    Socket(s):               1\r\n    Stepping:                2\r\n    Frequency boost:         enabled\r\n    CPU(s) scaling MHz:      63%\r\n    CPU max MHz:             5263.0000\r\n    CPU min MHz:             400.0000\r\n```\r\n\r\nAll materials for the custom benchmarks can be found [here](https://github.com/Eunovo/rescan-benchmark).\r\n\r\nAlthough not explicitly checked with Valgrind, hyperfine reported that memory usage stayed the same across all runs. I'm not sure to what degree hyperfine's memory usage report can be trusted, but the PR limits the amount of block hashes that can be held in memory for processing to `1000` (not configurable by the user).\r\n\r\n\r\nAll benchmarks were performed against https://github.com/bitcoin/bitcoin/pull/34400/commits/37d356bbbe3efed3c7c9e64fae1bac3f4d0ec6eb instead of master because `-walletpar` is implemented here, and the benchmark scripts would otherwise break, or more complicated scripts would be required to accommodate master.\r\n",
      "state": "open",
      "user": "Eunovo",
      "created_at": "2026-01-24T19:46:16Z",
      "updated_at": "2026-02-26T16:22:10Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34400",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 5492,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1185011431,
      "number": 26812,
      "title": "test: add end-to-end tests for CConnman and PeerManager",
      "body": "Add unit tests that write data to a mocked socket and inspect what CConnman/PeerManager have written back to the socket, or check the internal state to verify that the behavior is as expected.\r\n\r\nThis is now possible, after most of https://github.com/bitcoin/bitcoin/pull/21878 has been merged - we don't do any syscalls (e.g. `connect()`, `recv()`) from the high level code and using a mocked socket allows testing the entire networking stack without opening actual network connections.",
      "state": "open",
      "user": "vasild",
      "created_at": "2023-01-04T14:39:37Z",
      "updated_at": "2026-02-26T16:21:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/26812",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 543,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3227556540,
      "number": 34459,
      "title": "[30.x] Backports",
      "body": "Backports:\r\n* #34409\r\n* #34434\r\n* #34445\r\n* #34453\r\n* #34461\r\n* #34510\r\n* #34549\r\n* #34554\r\n* #34561\r\n* #34608\r\n* #34627\r\n* #34671",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-30T11:55:58Z",
      "updated_at": "2026-02-26T16:21:47Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34459",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 147,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3068399395,
      "number": 34001,
      "title": "test: fix test_limit_enforcement_package",
      "body": "The current test has a couple issues:\r\n\r\n1) the parent_tx_good is regenerating the exact same transaction that is already in the cluster, so it's resulting in no replacements on submission\r\n2) once fixed, the additional fee needs to be allocated to the parent transaction in the package, not the child. If the RBF fees are allocated to the child, this triggers the package RBF logic, which requires no in-mempool ancestors to be present.\r\n\r\nFix the bug and add a few assertions to protect against regressions.\r\n\r\n",
      "state": "closed",
      "user": "instagibbs",
      "created_at": "2025-12-03T18:00:12Z",
      "updated_at": "2026-02-26T16:14:40Z",
      "merged_at": "2026-02-26T16:14:39Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34001",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 554,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3273018592,
      "number": 34564,
      "title": "COPYING: Correct start date for \"The Bitcoin Core developers\" copyright line",
      "body": "## Summary\n\nCorrects `2009` → `2014` for \"The Bitcoin Core developers\" in the COPYING file,\nreflecting when that project name came into use.\n\nCloses #34563\n\n## Change\n\n**Before:**\n```\nCopyright (c) 2009-2026 The Bitcoin Core developers\nCopyright (c) 2009-2026 Bitcoin Developers\n```\n\n**After:**\n```\nCopyright (c) 2014-2026 The Bitcoin Core developers\nCopyright (c) 2009-2026 Bitcoin Developers\n```\n\n## Rationale\n\nThe git history shows:\n- Satoshi replaced his own name with \"Bitcoin Developers\" in his final v0.3.19\n  release (Dec 2010, `fc73ad644f0b`)\n- The project was known as \"Bitcoin\" with \"Bitcoin Developers\" until the v0.9.0\n  rebrand to \"Bitcoin Core\" (March 2014; see #3203, #3408)\n- In 2015, `3b00e7c23164` replaced \"Bitcoin Developers\" with \"The Bitcoin Core\n  developers\" and backdated it to 2009\n- #11318 (gmaxwell, 2017) partially addressed this by restoring \"Bitcoin\n  Developers\" as a second line — sipa identified `3b00e7c` as having introduced\n  the naming error. However, the start date was not corrected\n\nThis is a single-number fix consistent with the project's preference for\naccurate copyright notices, as demonstrated by #11318. No change to the license\ntext itself.\n\nThis change reflects historical naming, not contributor scope — early\ncontributors' work is fully covered under \"Bitcoin Developers.\"",
      "state": "closed",
      "user": "melvincarvalho",
      "created_at": "2026-02-11T18:49:38Z",
      "updated_at": "2026-02-26T16:07:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34564",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1402,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3331446521,
      "number": 34682,
      "title": "ci: fix vcpkg tools cache key collision between windows matrix jobs",
      "body": "The standard and fuzz matrix jobs share the same github.job value\r\n(windows-native-dll), so both try to save the vcpkg tools cache with the\r\nsame key.\r\n\r\nSince the tools are identical across build types, let them share a\r\nsingle cache entry by restricting the save to the standard job only.",
      "state": "closed",
      "user": "willcl-ark",
      "created_at": "2026-02-26T14:59:52Z",
      "updated_at": "2026-02-26T15:59:39Z",
      "merged_at": "2026-02-26T15:59:39Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34682",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 358,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1566486194,
      "number": 28690,
      "title": "build: Introduce internal kernel library",
      "body": "This PR introduces a new `libbitcoin_kernel` internal library. It completes the internal library design as laid out in [doc/design/libraries.md](https://github.com/bitcoin/bitcoin/blob/master/doc/design/libraries.md). Since the `util` library contains a bunch of modules that are not required by the kernel library, a new `kernel_util` library is introduced as well that only consists of the modules required by the kernel library. The external `libbitcoinkernel` library now re-uses the compiled objects from the internal libraries. \r\n\r\nThere is a trade-off to this. Since we don't manually export symbols from the kernel library yet, this would make the library unusable if `REDUCE_EXPORTS=ON`. For now this means that the patch here introduces a separate source file list for the external library that gets populated by the source files of its static dependents.",
      "state": "open",
      "user": "sedited",
      "created_at": "2023-10-20T11:01:03Z",
      "updated_at": "2026-02-26T15:55:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28690",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 906,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3315849712,
      "number": 34656,
      "title": "doc: clarify confusing `git range-diff` add/delete output",
      "body": "### Problem\r\nRange diffs in git are useful after PR rebases, but it has an easy-to-misread failure mode: if it cannot match a commit between the old and new ranges, it will show the old commit as removed (<) and the new commit as added (>), without showing any patch contents for that commit.\r\nIt can look like there were no code changes when in reality the commit was just treated as unrelated and needs full re-review.\r\n\r\n### Example\r\n\r\n```bash\r\ngit fetch upstream ff338fdb53a66ab40a36e1277e7371941fc89840 dd76338a57b9b1169ac27f7b783d6d0d4c6e38ab\r\ngit range-diff ff338fdb53a6...dd76338a57b9\r\n```\r\n\r\nThis produced output like:\r\n```patch\r\n1:  0ca4295f2e = 93:  139aa4b27e bench: add on-disk `HaveInputs` benchmark\r\n2:  4b32181dbb <  -:  ---------- test: add `HaveInputs` call-path unit tests\r\n-:  ---------- > 94:  277c57f0c5 test: add `HaveInputs` call-path unit tests\r\n3:  8c57687f86 ! 95:  c0c94ec986 dbwrapper: have `Read` and `Exists` reuse `ReadRaw`\r\n@@ Metadata\r\n## Commit message ##\r\n   dbwrapper: have `Read` and `Exists` reuse `ReadRaw`\r\n\r\n-    `ExistsImpl` was removed since it duplicates `CDBWrapper::ReadImpl` (except that it copies the resulting string on success, but that will be needed for caching anyway).\r\n+    `ExistsImpl` was removed since it duplicates `CDBWrapper::ReadImpl`.\r\n```\r\n\r\nEven though the subject matches, there is no diff shown because the commits did not match - the reviewer could think that only the commit message was changed.\r\nThis should be treated as **unmatched** rather than **unchanged**.\r\nIf you expected a match, you can try increasing the search effort:\r\n```bash\r\ngit range-diff --creation-factor=95 ff338fdb53a6...dd76338a57b9\r\n```\r\nwhich would show for example:\r\n```patch\r\n1:  0ca4295f2e = 93:  139aa4b27e bench: add on-disk `HaveInputs` benchmark\r\n2:  4b32181dbb ! 94:  277c57f0c5 test: add `HaveInputs` call-path unit tests\r\n@@ Commit message\r\n \r\n     The tests document that `HaveInputs()` consults the cache first and that a cache miss pulls from the backing view via `GetCoin()`.\r\n \r\n+    Co-authored-by: Novo <eunovo9@gmail.com>\r\n+\r\n  ## src/test/coins_tests.cpp ##\r\n @@ src/test/coins_tests.cpp: BOOST_FIXTURE_TEST_CASE(ccoins_flush_behavior, FlushTest)\r\n      }\r\n  }\r\n  \r\n-+BOOST_AUTO_TEST_CASE(ccoins_haveinputs_cache_miss_uses_base_getcoin)\r\n++BOOST_AUTO_TEST_CASE(ccoins_cache_behavior)\r\n```\r\n\r\n### Fix\r\nThis PR updates `doc/productivity.md` to raise awareness and document this pitfall and mentions `--creation-factor` as a knob to try when the output seems unexpectedly empty.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-02-23T12:48:54Z",
      "updated_at": "2026-02-26T15:47:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34656",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2597,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3272293478,
      "number": 34559,
      "title": "ci: split vcpkg tools cache into restore/save",
      "body": "The vcpkg tools cache was using the combined actions/cache action, which by default saves on every run regardless of branch. Split it into the restore/save pattern used by the other caches, so that saves only happen on default branch pushes.\r\n\r\nThis will have little impact in bitcoin/bitcoin (which uses few branches), but on forks, if you don't update master branch frequently (which saves all caches), then all cache space will eventually be taken up by multiple vckpg tools caches, resulting in bad cache hit rates in all other jobs.",
      "state": "closed",
      "user": "willcl-ark",
      "created_at": "2026-02-11T15:49:52Z",
      "updated_at": "2026-02-26T15:00:22Z",
      "merged_at": "2026-02-13T11:34:53Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34559",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 583,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3251091686,
      "number": 34520,
      "title": "refactor: Add [[nodiscard]] to functions returning bool+mutable ref",
      "body": "Legacy code often used a function signature of the form `bool Get...(const& in, mut& in_out);` to implement a getter that optionally returns a value.\r\n\r\nIn modern code, this can be replaced by `std::optional<_> Get...(const& in);`.\r\n\r\nHowever, some legacy code remains. To ensure that the \"imaginary optional\" is not unwrapped when the getter returns false, add a C++17 `[[nodiscard]]` attribute to all those legacy functions.\r\n\r\nThere were only a few places that ignored the return value. I've fixed them in separate commits.\r\n\r\nThis should be easy to review via `--word-diff-regex=.` and then confirming that the attribute was added to such a getter.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-02-05T16:58:07Z",
      "updated_at": "2026-02-26T14:53:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34520",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 720,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3272817290,
      "number": 34562,
      "title": "ThreadPool follow-ups, proactive shutdown and HasReason dependency cleanup",
      "body": "A few follow-ups to #33689, includes:\r\n\r\n1) `ThreadPool` active-wait during shutdown:\r\nInstead of just waiting for workers to finish processing tasks, `Stop()` now helps them actively.\r\nThis speeds up the JSON-RPC and REST server shutdown, resulting in a faster node shutdown when many requests remain unhandled. This wasn't included in the original PR due to the behavior change this introduces.\r\n\r\n2) Decouple `HasReason` from the unit test framework machinery\r\nThis avoids providing the entire unit test framework dependency to low-level tests that only require access to the `HasReason` utility class. Examples are: `reverselock_tests.cpp`, `sync_tests.cpp`, `util_check_tests.cpp`, `util_string_tests.cpp`, `script_parse_tests.cpp` and `threadpool_tests.cpp`. These tests no longer gain access to unnecessary components like the chainstate, node context, caches, etc. It includes @l0rinc's `threadpool_tests.cpp` `HasReason` changes.\r\n\r\n3) Include response body in non-JSON HTTP error messages\r\nStraight from @pinheadmz [comment](https://github.com/bitcoin/bitcoin/pull/33689#discussion_r2783817192), it makes debugging CI issues easier.",
      "state": "open",
      "user": "furszy",
      "created_at": "2026-02-11T18:00:13Z",
      "updated_at": "2026-02-26T14:52:52Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34562",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1217,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2217053399,
      "number": 31425,
      "title": "RFC: Riscv bare metal CI job",
      "body": "This adds a CI job for building the static consensus library and linking it to an executable. It uses newlib-cygwin as a C library for the final linking step. This ensure compatibility with this target going forward and can serve as a starting point for enabling bare metal builds for the entire kernel library. This would have also caught the error fixed in #31365.",
      "state": "open",
      "user": "sedited",
      "created_at": "2024-12-05T08:30:01Z",
      "updated_at": "2026-02-26T14:43:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31425",
      "labels": [
        "Build system",
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 395,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2294479432,
      "number": 31723,
      "title": "qa: Facilitate debugging bitcoind inside functional tests",
      "body": "Facilitates debugging specific instances of bitcoind *in the context of Python tests, inside of an editor/IDE/debugger*.\r\n\r\nMakes bitcoind spin during startup, waiting for a debugger to be attached, so that breakpoints during process init can be debugged.\r\n\r\n### Example usage\r\n\r\n1. Generate build files with `-DENABLE_WAIT_FOR_DEBUGGER=ON` & build.\r\n   \r\n   ```\r\n   cmake -B build -DCMAKE_BUILD_TYPE=Debug -DENABLE_WAIT_FOR_DEBUGGER=ON && cmake --build build -j$(nproc)\r\n   ```\r\n\r\n2. Set breakpoints in the C++ code in your editor/IDE/debugger.\r\n\r\n3. Start a Python functional test with a debugger command such as:\r\n   - LLDB inside an already started Tmux pane (append ` -o continue` to the LLDB args to have the debugger continue automatically):\r\n     ```\r\n     ./build/test/functional/feature_loadblock.py --debug_runs 2 --debug_cmd \"tmux split-window -h lldb -p \\$PID\\$\"\r\n     ```\r\n   - Sublime Text Debugger, allows a running session to attach:\r\n     ```\r\n     ./build/test/functional/feature_loadblock.py --debug_runs 2 --debug_cmd \"subl --command \\\"debugger {\\\\\\\"action\\\\\\\": \\\\\\\"start\\\\\\\", \\\\\\\"configuration\\\\\\\": {\\\\\\\"name\\\\\\\": \\\\\\\"foo\\\\\\\", \\\\\\\"type\\\\\\\": \\\\\\\"lldb\\\\\\\", \\\\\\\"request\\\\\\\": \\\\\\\"attach\\\\\\\", \\\\\\\"program\\\\\\\": \\\\\\\"dummyprogram\\\\\\\", \\\\\\\"pid\\\\\\\": \\\\\\\"\\$PID\\$\\\\\\\"}}\\\"\"\r\n     ```\r\n   - Don't specify `--debug_cmd ...\\$PID\\$...`, instead have the test framework log which bitcoind PID you should manually attach to:\r\n     ```\r\n     ./build/test/functional/feature_loadblock.py --debug_runs 2\r\n     ```\r\n\r\n5. Experience how debugger hits breakpoints as the functional test executes RPCs.\r\n\r\nUsing `-debug_runs <RUN_INDEX>` often requires doing a dry-run of a functional test with `-ldebug` and examining the log to see which run index is the one we want to debug:\r\n```\r\n2025-...Z TestFramework.node0 (DEBUG): bitcoind started (run #1, node #0), waiting for RPC to come up\r\n``` \r\n\r\n### Alternative usage\r\n\r\nTweak functional test code to specify `wait_for_debugger` when (re)starting a node:\r\n\r\n```diff\r\n-        self.restart_node(0)\r\n+        self.restart_node(0, wait_for_debugger=True)\r\n```\r\nWhile it can be messy to modify files while moving between commits, and cumbersome inside of loops, it might be more straightforward than `-debug_runs <RUN_INDEX>` in a given case.\r\n\r\n### *Needed before merge*\r\n\r\n- [ ] Testing on Mac to confirm -waitfordebugger on the C++ side behaves as expected.",
      "state": "open",
      "user": "hodlinator",
      "created_at": "2025-01-23T13:18:06Z",
      "updated_at": "2026-02-26T14:23:10Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31723",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2460,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3220617054,
      "number": 34435,
      "title": "refactor: use `_MiB`/`_GiB` consistently for byte conversions",
      "body": "### Problem\r\nByte-size conversions in the codebase currently show up in many equivalent formats (multiplication/division chains, shifts, hex/binary literals), which creates a maintenance burden and makes review error-prone - especially considering the architectural differences of `size_t`.\r\nInspired by https://github.com/bitcoin/bitcoin/pull/34305#discussion_r2734720002, it seemed appropriate to unify `Mebibyte` usage across the codebase and add `Gibibyte` support with 32/64 bit `size_t` validation.\r\n\r\n### Fix\r\nThis PR refactors those call sites to use `\"\"_MiB` (existing) and `\"\"_GiB` (new), and adds the encountered value/pattern replacements to unit tests to make review straightforward, and to ensure the conversions remain valid.\r\nThe literals are overflow-checked when converting to `size_t`, and unit tests cover the 32-bit boundary cases.\r\n\r\nConcretely, it replaces patterns such as:\r\n* `1024*1024`, `1<<20`, `0x100000`, `1048576`, `/ 1024 / 1024`, `* (1.0 / 1024 / 1024)` → `1_MiB` or `double(1_MiB)`\r\n* `1024*1024*1024`, `1<<30`, `0x40000000`, `1024_MiB`, `>> 30` → `1_GiB`\r\n\r\n### Note\r\nIn the few places where arithmetic involves signed values, the result is identical to the previous code assuming those quantities never become negative.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-28T21:26:10Z",
      "updated_at": "2026-02-26T14:13:22Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34435",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1317,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2540992851,
      "number": 32606,
      "title": "p2p: Drop unsolicited CMPCTBLOCK from non-HB peer",
      "body": "Processing unsolicited `CMPCTBLOCK`'s from a peer that has not been marked high bandwidth is not well-specified behavior in BIP-0152, in fact the BIP seems to imply that it is not permitted:\r\n\r\n> \"[...] method is not useful for compact blocks because `cmpctblock` blocks can be sent unsolicitedly in high-bandwidth mode\"\r\n\r\nSee https://github.com/bitcoin/bips/blob/master/bip-0152.mediawiki#separate-version-for-segregated-witness\r\n\r\nThis partially mitigates a mempool leak described in #28272, making it only possible for peers selected as high bandwidth to discover a node's mempool.",
      "state": "open",
      "user": "davidgumberg",
      "created_at": "2025-05-23T21:58:15Z",
      "updated_at": "2026-02-26T14:06:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32606",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 635,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2391882324,
      "number": 32061,
      "title": "Replace libevent with our own HTTP and socket-handling implementation",
      "body": "This is a major component of [removing libevent as a dependency of the project](https://github.com/bitcoin/bitcoin/issues/31194), by replacing the HTTP server used for RPC and REST with one implemented entirely within the Bitcoin Core codebase. The new `HTTPServer` class runs its own I/O thread, handling socket connections with code based on #30988, but tailored specifically for HTTP.\r\n\r\nSome functional tests were added in #32408 to cover libevent behaviors that remain consistent with this branch. \r\n\r\nCommit strategy:\r\n- Implement a few helper functions for strings, timestamps, etc needed by HTTP protocol\r\n- Isolate the existing libevent-based HTTP server in a namespace `http_libevent`\r\n- Implement HTTP in a new namespace `http_bitcoin` (classes like `HTTPRequest`, `HTTPClient`, etc...)\r\n- Switch bitcoind from the libevent server to the new server\r\n- Clean up (delete `http_libevent`)\r\n\r\nI am currently seeing about a 10% speed up in the functional tests on my own arm/macos machine.\r\n\r\n## Integration testing:\r\n\r\nI am testing the new HTTP server by forking projects that integrate with bitcoin via HTTP and running their integration tests with bitcoind built from this branch (on Github actions). I will continue adding integrations over time, and re-running these CI tests as this branch gets rebased:\r\n\r\n- [NodeJS `rpc-bitcoin`](https://github.com/pinheadmz/rpc-bitcoin/pull/1)\r\n- [electrs](https://github.com/pinheadmz/electrs/pull/1)\r\n- [lnd](https://github.com/pinheadmz/lnd/pull/1)\r\n- [eclair](https://github.com/pinheadmz/eclair/pull/1)\r\n- [corepc](https://github.com/pinheadmz/corepc/pull/1)\r\n- [bitcoinjs-lib](https://github.com/pinheadmz/bitcoinjs-lib/pull/1)",
      "state": "open",
      "user": "pinheadmz",
      "created_at": "2025-03-13T19:32:14Z",
      "updated_at": "2026-02-26T14:05:52Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32061",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1752,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3330547465,
      "number": 34681,
      "title": "wallet: refactor ScanForWalletTransactions",
      "body": "Part of https://github.com/bitcoin/bitcoin/pull/34400\r\n\r\nThis PR refactors the wallet scanning logic for improved readability and maintainability, and prepares the scanning logic for the changes in https://github.com/bitcoin/bitcoin/pull/34400.\r\n\r\n`ScanForWalletTransactions` is expanded into a class, and the main scanning loop is simplified by delegating some logic to member functions. No behaviour change is introduced in this PR.",
      "state": "open",
      "user": "Eunovo",
      "created_at": "2026-02-26T11:36:35Z",
      "updated_at": "2026-02-26T13:59:23Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34681",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 477,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3328427974,
      "number": 34677,
      "title": "kernel: Chainparams and headerssync updates pre-31.0",
      "body": "Update chainparams and headerssync params per the release process.\r\n\r\nAlso added new assumeutxo snapshots for each network. I've uploaded snapshots to https://achow101.com/files/utxo-snapshots/",
      "state": "open",
      "user": "achow101",
      "created_at": "2026-02-26T00:33:30Z",
      "updated_at": "2026-02-26T13:21:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34677",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 246,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3328131223,
      "number": 34673,
      "title": "contrib: Update fixed seeds pre-31.0",
      "body": "",
      "state": "open",
      "user": "achow101",
      "created_at": "2026-02-25T22:39:52Z",
      "updated_at": "2026-02-26T13:12:55Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34673",
      "labels": [
        "Scripts and tools"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 37,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3216048052,
      "number": 34422,
      "title": "Update libmultiprocess subtree to be more stable with rust IPC client",
      "body": "Includes:\r\n\r\n- https://github.com/bitcoin-core/libmultiprocess/pull/241\r\n- https://github.com/bitcoin-core/libmultiprocess/pull/240\r\n- https://github.com/bitcoin-core/libmultiprocess/pull/244\r\n- https://github.com/bitcoin-core/libmultiprocess/pull/245\r\n\r\nThe main change is https://github.com/bitcoin-core/libmultiprocess/pull/240 which fixes issues with asynchronous requests (https://github.com/bitcoin/bitcoin/issues/33923) and unclean disconnects (https://github.com/bitcoin/bitcoin/issues/34250) that happen with the rust mining client. It also adds tests for these fixes which had some previous review in #34284 (that PR was closed to simplify dependencies between PRs).\r\n\r\nThe changes can be verified by running `test/lint/git-subtree-check.sh src/ipc/libmultiprocess` as described in [developer notes](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#subtrees) and [lint instructions](https://github.com/bitcoin/bitcoin/tree/master/test/lint#git-subtree-checksh)\r\n\r\nResolves #33923 and #34250\r\n",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2026-01-27T20:06:40Z",
      "updated_at": "2026-02-26T13:04:16Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34422",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1093,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2784259944,
      "number": 33270,
      "title": "stabilize translations by reverting old ids by text content",
      "body": "### Summary\r\n\r\nRegenerating the Qt translation template (`src/qt/locale/bitcoin_en.xlf`) previously used sequential `_msg<N>` IDs. When strings moved within the sorted message list, IDs shifted, creating large diffs and making translation platforms treat unchanged strings as new.\r\n\r\nThis PR switches XLF `<trans-unit id=...>` values to stable IDs derived from a SHA256 hash of the message context and source text.\r\n\r\n### Details\r\n\r\nAs mentioned in https://github.com/bitcoin/bitcoin/pull/33224#issuecomment-3234820665, any change that moves a translatable string within the sorted messages can renumber subsequent entries when IDs are sequential.\r\n\r\nSome English texts can appear in multiple places (e.g. “Clear”) with different meanings depending on the Qt context. To avoid collisions, the hash includes the `<group resname=...>` context.\r\n\r\n### Fix\r\n\r\nThe `translate` target already runs `contrib/devtools/stabilize_xlf_ids.py`. Instead of trying to preserve/renumber `_msg<N>` IDs by matching old/new units, the script now rewrites every `<trans-unit id>` to:\r\n\r\n- `sha256(resname + \"\\0\" + source-text)` (hex)\r\n- keeping the existing plural `[N]` suffix for plural forms\r\n\r\nThe script also checks for duplicate IDs and aborts if any are detected.\r\n\r\nNote: this is a one-time mass change from `_msg<N>` IDs to hashes; after that, rerunning `translate` on an unchanged tree should not churn IDs.\r\n\r\nWith this PR applied, IDs become stable hashes so ordering changes no longer cause renumbering churn.\r\n\r\n### Reproducer\r\n\r\nYou can test the replacer by changing any translatable text:\r\n```patch\r\ndiff --git a/src/qt/bitcoingui.cpp b/src/qt/bitcoingui.cpp\r\n--- a/src/qt/bitcoingui.cpp\t(revision a38b8cf788922174538161cda81ce28f2ac462ec)\r\n+++ b/src/qt/bitcoingui.cpp\t(date 1767310724675)\r\n@@ -258,7 +258,7 @@\r\n     connect(modalOverlay, &ModalOverlay::triggered, tabGroup, &QActionGroup::setEnabled);\r\n \r\n     overviewAction = new QAction(platformStyle->SingleColorIcon(\":/icons/overview\"), tr(\"&Overview\"), this);\r\n-    overviewAction->setStatusTip(tr(\"Show general overview of wallet\"));\r\n+    overviewAction->setStatusTip(tr(\"Show general overview of Wallet\"));\r\n     overviewAction->setToolTip(overviewAction->statusTip());\r\n     overviewAction->setCheckable(true);\r\n     overviewAction->setShortcut(QKeySequence(QStringLiteral(\"Alt+1\")));\r\n```\r\nand regenerating the translations\r\n```bash\r\ncmake --preset dev-mode -DWITH_USDT=OFF && cmake --build build_dev_mode --target translate\r\n```\r\nYou will notice that the new text moved to a different place with a different hash, but all other messages retained their IDs.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-08-29T09:23:56Z",
      "updated_at": "2026-02-26T12:59:49Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33270",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2676,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3309769545,
      "number": 34642,
      "title": "wallet: call SyncWithValidationInterfaceQueue after disconnecting chain notifications",
      "body": "When the wallet disconnects chain notifications, it is expecting no further notifications to execute, but this is not the case. This results in test failures such as in #34354. Instead of disconnecting the notifications and continuing shutdown, we should wait for the validation interface queue to be drained before the rest of wallet shutdown. This is achieved by adding an `interfaces::Handler::sync()` function which calls `SyncWithValidationInterfaceQueue()`.\r\n\r\nFixes #34354",
      "state": "open",
      "user": "achow101",
      "created_at": "2026-02-20T23:01:26Z",
      "updated_at": "2026-02-26T12:31:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34642",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 565,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3300999675,
      "number": 34620,
      "title": "[28.x] backports and 28.4rc2",
      "body": "Backports:\r\n\r\n* #34370\r\n\r\nAnd the rc2 release process things",
      "state": "open",
      "user": "achow101",
      "created_at": "2026-02-19T01:17:55Z",
      "updated_at": "2026-02-26T12:24:15Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34620",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 89,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1943443355,
      "number": 30354,
      "title": "doc: external-signer, example 'createwallet' RPC call requires eight argument",
      "body": "The eight argument 'true' is necessary to invoke the external signer upon creating the wallet. The parameter defaults to 'false' otherwise.",
      "state": "open",
      "user": "cobratbq",
      "created_at": "2024-06-28T01:53:11Z",
      "updated_at": "2026-02-26T12:17:49Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30354",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 217,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3163940035,
      "number": 34256,
      "title": "test: support `get_bind_addrs` and `feature_bind_extra` on macOS",
      "body": "### Problem\r\n\r\nSome functional tests are shown as skipped when running on macOS because `test_framework/netutil.py` only implemented the Linux-specific logic for checking which TCP sockets a node is listening on.\r\n\r\n### Fix\r\n\r\nAdd macOS implementations in `test/functional/test_framework/netutil.py` so tests can query:\r\n\r\n* which TCP sockets a node is listening on (`get_bind_addrs()`, via `lsof`)\r\n* a non-loopback interface address (`all_interfaces()`, via `ifconfig`)\r\n\r\nThen enable the previously Linux-only tests by switching to a shared platform guard.\r\n\r\n### Commands\r\n<details>\r\n<summary><code>get_bind_addrs()</code> (<code>lsof</code> + regex)</summary>\r\n\r\n> Command used\r\n```bash\r\nlsof -nP -a -p <pid> -iTCP -sTCP:LISTEN -Ftn\r\n```\r\n\r\n> Flags\r\n\r\n- -n: no hostname resolution\r\n- -P: no service/port-name resolution\r\n- -a: AND all conditions\r\n- -p <pid>: filter by process ID\r\n- -iTCP: TCP sockets only\r\n- -sTCP:LISTEN: listening sockets only\r\n- -Ftn: machine-readable output (fields: type t, name n)\r\n\r\n> Regex parser\r\n\r\n```regex\r\nt(IPv[46])\\nn(\\*|\\[.+?]|[^:]+):(\\d+)\r\n```\r\n> Captured groups\r\n\r\n- group 1: IPv4 / IPv6 (used to disambiguate *)\r\n- group 2: host (*, [::1], 127.0.0.1, …)\r\n- group 3: port\r\n</details>\r\n\r\n<details>\r\n<summary><code>all_interfaces()</code> (<code>ifconfig</code> + regex)</summary>\r\n\r\n> Command used\r\n\r\n```bash\r\nifconfig -au\r\n```\r\n\r\n> Regex parsing\r\n\r\nInterface blocks:\r\n```regex\r\n(?m)^(?P<iface>\\S+):(?P<block>[^\\n]*(?:\\n[ \\t]+[^\\n]*)*)\r\n```\r\n\r\nIPv4 extraction within each block:\r\n```regex\r\ninet (\\S+)\r\n```\r\n</details>\r\n\r\n### Notes\r\n\r\nThe only remaining platform skips on macOS are the USDT/BPF tracing tests (interface_usdt_*.py).\r\n\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-11T21:42:11Z",
      "updated_at": "2026-02-26T11:48:57Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34256",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1738,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2713577873,
      "number": 33117,
      "title": "Interfaces: Expose UTXO Snapshot Loading and Add Progress Notifications",
      "body": "# Add UTXO Snapshot Loading Interface and Progress Notifications\r\n\r\nThis PR implements a complete interface for loading UTXO snapshots through the GUI, including progress notifications to provide user feedback during the loading process.\r\n\r\n---\r\n\r\n## Changes\r\n\r\n### Commit 1: `interfaces: expose UTXO snapshot loading in node interface`\r\n\r\n- Added a new virtual method `loadSnapshot` to the node interface for loading UTXO snapshots.\r\n- Updated the implementation in `interfaces.cpp` to activate the snapshot using the provided file and metadata.\r\n- This change enhances the user's ability to load UTXO snapshots through the GUI.\r\n\r\n### Commit 2: `notifications: Implement snapshot load progress notifications`\r\n\r\n- Added a new signal `SnapshotLoadProgress` for snapshot load progress in the UI interface.\r\n- Updated the notifications interface to include a method for reporting snapshot loading progress.\r\n- Enhanced the `ChainstateManager` to report progress during snapshot loading.\r\n- Implemented the necessary handler in the kernel notifications to relay progress updates.\r\n- This change improves user feedback during the snapshot loading process.\r\n\r\n### Commit 3: `rpc: refactor loadtxoutset to use snapshot interface`\r\n\r\n- Updated the loadtxoutset RPC to call the new snapshot interface instead of directly working with chainstate internals.\r\n- Added getMetadata and getActivationResult methods to the snapshot interface to provide parity with the legacy RPC.\r\n- Improves modularity by consolidating snapshot handling through the interface layer.\r\n\r\n---\r\n\r\n## Technical Details\r\n\r\nThe implementation includes:\r\n\r\n- **UI Interface Enhancement**\r\n  Added `SnapshotLoadProgress` signal to `CClientUIInterface` with corresponding signal declaration and implementation.\r\n\r\n- **Node Interface**\r\n  Added `loadSnapshot` virtual method to the node interface with implementation in `interfaces.cpp`.\r\n\r\n- **Progress Notifications**\r\n  Implemented `snapshotLoadProgress` method in `KernelNotifications` class to relay progress updates to the UI.\r\n\r\n- **Base Interface**\r\n  Added `snapshotLoadProgress` virtual method to the kernel notifications interface.\r\n\r\n---\r\n\r\n## Benefits\r\n\r\n- **User Experience**\r\n  Provides real-time feedback during UTXO snapshot loading operations.\r\n\r\n- **GUI Integration**\r\n  Enables loading UTXO snapshots directly through the Bitcoin Core GUI.\r\n\r\n- **Progress Tracking**\r\n  Users can monitor the progress of snapshot loading operations.\r\n\r\n- **Consistent Interface**\r\n  Follows the existing pattern for progress notifications in the codebase.\r\n\r\n## Testing\r\n\r\n- **Daemon** build and launch `bitcoind` then with `bitcoin-cli` load a snapshot using:\r\n```bash\r\n./bitcoin-cli -rpcclienttimeout=0 -signet loadtxoutset /path/to/utxo-snapsshot.dat\r\n```\r\n- **QT Widgets**: build and run [this](https://github.com/bitcoin-core/gui/pull/870) draft PR in legacy gui repo \r\n- **QML** version: for a modern look build and run [this](https://github.com/bitcoin-core/gui-qml/pull/488) PR in the newly updated gui-qml repo \r\n",
      "state": "open",
      "user": "D33r-Gee",
      "created_at": "2025-08-01T15:31:46Z",
      "updated_at": "2026-02-26T11:38:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33117",
      "labels": [
        "interfaces"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 3107,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2836114252,
      "number": 33414,
      "title": "tor: enable PoW defenses for automatically created hidden services",
      "body": "Enable [PoW defenses](https://tpo.pages.torproject.net/onion-services/ecosystem/technology/security/pow/) for hidden services that we create via Tor Control using the [`ADD_ONION` command](https://spec.torproject.org/control-spec/commands.html#add_onion).\r\n\r\nThe ability to do that has been added in [tor-0.4.9.2-alpha](https://gitlab.torproject.org/tpo/core/tor/-/commit/02c18044464bfe45f168b55297a785244094cfd5). Previous versions return a syntax error to the `ADD_ONION` command with `PoWDefensesEnabled=1`, so the approach here is to try with PoW and if we get syntax error, then retry without PoW.\r\n\r\nAlso update `doc/tor.md` with a hint on enabling PoW on manually configured Tor hidden services.",
      "state": "open",
      "user": "vasild",
      "created_at": "2025-09-17T10:40:41Z",
      "updated_at": "2026-02-26T10:36:42Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33414",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 769,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3095820892,
      "number": 34054,
      "title": "net processing: Add ibd check before processing block for txdownloadman",
      "body": "Calculating the rolling bloom filters for the txorphanage takes some CPU time from the scheduler thread. This can be observed for example in [this flamegraph](https://bitcoin-dev-tools.github.io/benchcoin/results/pr-172/20066462508/mainnet-default-instrumented-base-flamegraph.svg?x=920203898521&y=780), where handling the filter takes about 2.6% of total time (and most of the scheduler thread's time). \r\n\r\nDuring ibd the entries in the tx download bloom filter are just continuously rolled over and aren't consumed, since no mempool entries are created by incoming transactions from peers during ibd. The mempool does accept transactions via RPC, or the wallet at the time, however these don't interact with the orphanage and the txdownloadman, because adding anything to those is guarded by IsInitialBlockDownload() checks as well.\r\n\r\nWe're usually latching ibd to false a few blocks before catching up to the tip, so this should also not significantly degrade the performance of the filter once fully caught up.",
      "state": "closed",
      "user": "sedited",
      "created_at": "2025-12-12T09:06:28Z",
      "updated_at": "2026-02-26T10:33:35Z",
      "merged_at": "2026-02-26T10:33:35Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34054",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1087,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3272437576,
      "number": 34561,
      "title": "wallet: rpc: manpage: fix example missing `fee_rate` argument",
      "body": "The function signature for the `send` RPC is:\r\n```\r\nsend [{\"address\":amount,...},{\"data\":\"hex\"},...] ( conf_target \"estimate_mode\" fee_rate options version )\r\n```\r\n\r\nThe last example in the manpage is missing the `fee_rate` arg, but is trying to specify the `options` arg, by index. The parser confuses the intended `options` arg as the missing `fee_rate` arg.\r\n\r\nSee:\r\n```\r\n$ bitcoin-cli -rpcuser=doggman -rpcpassword=donkey -rpcport=18554 -regtest send '{\"bcrt1qusm48zmlzwr32csxdw4ar7atw260h22c9ten9l\": 0.1}' 1 economical '{\"add_to_wallet\": false, \"inputs\": [{\"txid\":\"0b7e1a471dc948b7a6187936b16e6d7d9833629b2f9dd8a392eb89928f63aaad\", \"vout\":0}]}'\r\nerror code: -8\r\nerror message:\r\nCannot specify both conf_target and fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\r\n```\r\nvs\r\n```\r\n$ bitcoin-cli -rpcuser=doggman -rpcpassword=donkey -rpcport=18554 -regtest send '{\"bcrt1qusm48zmlzwr32csxdw4ar7atw260h22c9ten9l\": 0.1}' 1 economical null '{\"add_to_wallet\": false, \"inputs\": [{\"txid\":\"0b7e1a471dc948b7a6187936b16e6d7d9833629b2f9dd8a392eb89928f63aaad\", \"vout\":0}]}'\r\n{\r\n  \"psbt\": \"cHNidP8BAHECAAAAAa2qY4+SieuSo9idL5tiM5h9bW6xNnkYprdIyR1HGn4LAAAAAAD9////AkR2DwQAAAAAFgAUpLDwJu+wFRHLQAgKAb0psk7UVd2AlpgAAAAAABYAFOQ3U4t/E4cVYgZrq9H7q3K0+6lYAAAAAAABAIUCAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////wQC4wMA/////wLIF6gEAAAAABYAFLMY1zihXrefAA0DA5nld4MCPjkrAAAAAAAAAAAmaiSqIant4vYcP3HR3v0/qZnfo2lTdVxpBol5mWK0i+vYNpdOjPkAAAAAAQEfyBeoBAAAAAAWABSzGNc4oV63nwANAwOZ5XeDAj45KwEIawJHMEQCIElTV4pbUrsPR9qHWcioowVv3QVWHizxwevfD0u/I8YyAiBCY3OzF81PSLM00h4ueQkehYuxDFZu7Jk51iejphKnnwEhA0VKdYVSyBpWoxBwTDOupB58Fi3mEBs+u+OOqEYVd2sZACICA98YLWyH7dBCfXVxe7woiLSTgV1mJN8Zc8KgZ77pVSg+GNBMeT5UAACAAQAAgAAAAIABAAAAbAAAAAAA\",\r\n  \"txid\": \"625b71b314a6ac4f738634e29dc007cd5edc0427c1ae96ab706d06a62910cea2\",\r\n  \"hex\": \"02000000000101adaa638f9289eb92a3d89d2f9b6233987d6d6eb1367918a6b748c91d471a7e0b0000000000fdffffff0244760f0400000000160014a4b0f026efb01511cb40080a01bd29b24ed455dd8096980000000000160014e437538b7f13871562066babd1fbab72b4fba9580247304402204953578a5b52bb0f47da8759c8a8a3056fdd05561e2cf1c1ebdf0f4bbf23c6320220426373b317cd4f48b334d21e2e79091e858bb10c566eec9939d627a3a612a79f012103454a758552c81a56a310704c33aea41e7c162de6101b3ebbe38ea84615776b1900000000\",\r\n  \"complete\": true\r\n}\r\n```",
      "state": "closed",
      "user": "SomberNight",
      "created_at": "2026-02-11T16:24:24Z",
      "updated_at": "2026-02-26T10:12:36Z",
      "merged_at": "2026-02-24T22:27:21Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34561",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2397,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3327185871,
      "number": 34671,
      "title": "doc: Update Guix install for Debian/Ubuntu",
      "body": "Fixes https://github.com/bitcoin/bitcoin/issues/33982",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-02-25T18:50:20Z",
      "updated_at": "2026-02-26T10:12:27Z",
      "merged_at": "2026-02-25T21:28:01Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34671",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 96,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3309713624,
      "number": 34640,
      "title": "wallet: rpc: Improve error message for low feerates.",
      "body": "Giving the user a hint about what action to take when they encounter an error related to a feerate that is below the minimum. I encountered this myself not knowing about `-mintxfee` and the manpage was slightly less than clear,\r\n\r\n```\r\n       -mintxfee=<amt>\r\n\r\n              Fee rates (in BTC/kvB) smaller than this are considered zero fee for  transaction  creation\r\n              (default: 0.00001)\r\n```",
      "state": "open",
      "user": "davidgumberg",
      "created_at": "2026-02-20T22:38:55Z",
      "updated_at": "2026-02-26T10:11:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34640",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 459,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3330158241,
      "number": 34680,
      "title": "[29.x] Backports",
      "body": "Backports:\r\n* #34510\r\n* #34561\r\n* #34671",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-02-26T10:11:22Z",
      "updated_at": "2026-02-26T10:11:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34680",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 57,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2902093523,
      "number": 33593,
      "title": "guix: Use UCRT runtime for Windows release binaries",
      "body": "This PR:\r\n1. Switches Windows release binaries to UCRT.\r\n2. Update docs.\r\n3. Drops MSVCRT workarounds.\r\n\r\nCloses https://github.com/bitcoin/bitcoin/issues/30210.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-10-09T21:46:43Z",
      "updated_at": "2026-02-26T10:04:24Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33593",
      "labels": [
        "Windows",
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 213,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3249183758,
      "number": 34510,
      "title": "doc: fix broken bpftrace installation link",
      "body": "The bpftrace project has moved from the `iovisor` organization to its own\r\n`bpftrace` organization on GitHub. The old installation documentation link\r\n(`https://github.com/iovisor/bpftrace/blob/master/INSTALL.md`) is now broken (404).\r\n\r\nThe project also restructured their documentation - installation instructions\r\nare now in the README.md under the \"Quick Start\" section rather than a\r\nseparate INSTALL.md file.",
      "state": "closed",
      "user": "jayvaliya",
      "created_at": "2026-02-05T08:48:30Z",
      "updated_at": "2026-02-26T09:59:55Z",
      "merged_at": "2026-02-05T09:36:53Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34510",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 457,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3281425700,
      "number": 34583,
      "title": "ci: [refactor] Drop last use of pwsh",
      "body": "The use of pwsh was a bit confusing and inconsistent around the exit code. See also https://github.com/bitcoin/bitcoin/pull/32672\r\n\r\nI think it is fine to drop it and purely use Bash/Python.\r\n\r\nThis also moves a bit of code from the github yaml to the python script.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-02-13T15:40:57Z",
      "updated_at": "2026-02-26T08:36:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34583",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 303,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3320837654,
      "number": 34661,
      "title": "ipc mining: Prevent ``Assertion `m_node.chainman' failed`` errors on early startup",
      "body": "This fixes ``Assertion `m_node.chainman' failed`` errors first reported https://github.com/bitcoin/bitcoin/issues/33994#issuecomment-3602551596 when IPC mining methods are called before ChainstateManager is loaded.\r\n\r\nThe fix works by making the `Init.makeMining` method wait until chainstate data is loaded. It's probably the simplest possible fix but other alternatives like moving the wait to `Mining.createNewBlock` were discussed in the thread https://github.com/bitcoin/bitcoin/pull/34661#discussion_r2848176298 and could be implemented later without changes to clients.\r\n\r\n\r\n\r\n",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2026-02-24T13:39:31Z",
      "updated_at": "2026-02-26T08:30:57Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34661",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 667,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3034182041,
      "number": 33922,
      "title": "mining: add getMemoryLoad() and track template non-mempool memory footprint",
      "body": "Implements a way to track the memory footprint of all non-mempool transactions that are still being referenced by block templates, see discussion in  #33899. It does not impose a limit.\r\n\r\nIPC clients can query this footprint (total, across all clients) using the `getMemoryLoad()` IPC method. Its client-side usage is demonstrated here:\r\n- https://github.com/stratum-mining/sv2-tp/pull/63\r\n\r\nAdditionally, the functional test in `interface_ipc.py` is expanded to demonstrate how template memory management works: templates are not released until the client drops references to them, or calls the template destroy method, or disconnects. The destroy method is called automatically by clients using [libmultiprocess](https://github.com/bitcoin-core/libmultiprocess), as [sv2-tp](https://github.com/stratum-mining/sv2-tp) does. In the Python tests it also happens when references are destroyed or go out of scope.\r\n\r\nThe PR starts with preparation refactor commits:\r\n\r\n1. Tweaks `interface_ipc.py` so `destroy()` calls happen in an order that's useful to later demonstrate memory management\r\n2. Change `std::unique_ptr<BlockTemplate> block_template` from a `static` defined in `rpc/mining.cpp` to `NodeContext`. This prevents a crash when we switch to a non-trivial destructor later (which uses `m_node`).\r\n\r\nThen the main commits:\r\n\r\n3. Add `template_tx_refs` to `NodeContext` to track how many templates contain any given transaction. This map is updated by the `BlockTemplate` constructor and destructor.\r\n4. Add `GetTemplateMemoryUsage()` which loops over this map and sums up the memory footprint for transactions outside the mempool\r\n5. Expose this information to IPC clients via `getMemoryLoad()` and add test coverage\r\n",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-21T15:34:14Z",
      "updated_at": "2026-02-26T08:30:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33922",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1801,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3056547139,
      "number": 33974,
      "title": "cmake: Check dependencies after build option interaction",
      "body": "At present, `CMakeLists.txt` interleaves configuration-option handling with dependency discovery. As a result, unnecessary checks may be performed. For example:\r\n```\r\n$ cmake -B build --preset dev-mode -DBUILD_FOR_FUZZING=ON\r\n<snip>\r\n-- Found PkgConfig: /usr/bin/pkg-config (found version \"2.3.0\")\r\n-- Found ZeroMQ: /usr/lib64 (found suitable version \"4.3.5\", minimum required is \"4.0.0\")\r\n-- Performing Test HAVE_USDT_H\r\n-- Performing Test HAVE_USDT_H - Success\r\n-- Found USDT: /usr/include\r\n-- Found QRencode: /usr/lib64/libqrencode.so (found version \"4.1.1\")\r\n-- Performing Test CMAKE_HAVE_LIBC_PTHREAD\r\n-- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Success\r\n-- Found Threads: TRUE\r\n-- Performing Test HAVE_STDATOMIC\r\n-- Performing Test HAVE_STDATOMIC - Success\r\n-- Found WrapAtomic: TRUE\r\n-- Found OpenGL: /usr/lib64/libOpenGL.so\r\n-- Found WrapOpenGL: TRUE\r\n-- Found WrapVulkanHeaders: /usr/include\r\n-- Found Qt: /usr/lib64/cmake/Qt6 (found suitable version \"6.10.1\", minimum required is \"6.2\")\r\nCMake Warning at CMakeLists.txt:206 (message):\r\n  BUILD_FOR_FUZZING=ON will disable all other targets and force\r\n  BUILD_FUZZ_BINARY=ON.\r\n\r\n<snip>\r\n```\r\n\r\nThis PR restructures the code to ensure that all dependencies are checked only after the final build option interaction.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-11-30T15:50:06Z",
      "updated_at": "2026-02-26T08:18:51Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33974",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1331,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3110851566,
      "number": 34093,
      "title": "netif: fix compilation warning in QueryDefaultGatewayImpl()",
      "body": "```\r\nsrc/common/netif.cpp:137:51: error: comparison of integers of different signs: 'int64_t' (aka 'long') and 'unsigned long' [-Werror,-Wsign-compare]\r\n  137 |         for (nlmsghdr* hdr = (nlmsghdr*)response; NLMSG_OK(hdr, recv_result); hdr = NLMSG_NEXT(hdr, recv_result)) {\r\n      |                                                   ^~~~~~~~~~~~~~~~~~~~~~~~~~\r\n/usr/include/netlink/netlink.h:220:31: note: expanded from macro 'NLMSG_OK'\r\n  220 | #define NLMSG_OK(_hdr, _len)            NL_ITEM_OK(_hdr, _len, NLMSG_HDRLEN, _NLMSG_LEN)\r\n      |                                         ^                ~~~~  ~~~~~~~~~~~~\r\n/usr/include/netlink/netlink.h:203:10: note: expanded from macro 'NL_ITEM_OK'\r\n  203 |         ((_len) >= _hlen && _LEN_M(_ptr) >= _hlen && _LEN_M(_ptr) <= (_len))\r\n      |           ~~~~  ^  ~~~~~\r\n1 error generated.\r\n```\r\n\r\nHappens on FreeBSD 15.0, with the default compiler (Clang 19).\r\n\r\nOn FreeBSD 14, `/usr/include/netlink/netlink.h` contains:\r\n```\r\n #define NLMSG_HDRLEN                    ((int)sizeof(struct nlmsghdr))\r\n```\r\n\r\nOn FreeBSD 15, `/usr/include/netlink/netlink.h` contains:\r\n```\r\n #define NLMSG_HDRLEN                    (sizeof(struct nlmsghdr))\r\n```\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "open",
      "user": "vasild",
      "created_at": "2025-12-17T17:45:19Z",
      "updated_at": "2026-02-26T08:12:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34093",
      "labels": [
        "Needs backport (30.x)"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 3321,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3088060609,
      "number": 34038,
      "title": "logging: replace -loglevel with -trace, various API improvements",
      "body": "Various API improvements:\r\n                                                                                                    \r\nFor users:      \r\n\r\n  - A new -trace option controls trace-level logging, using the same syntax as -debug. So `-debug=net` enables debug logs for net, `-trace=net` adds trace logs too. This replaces the `-loglevel` option, which had different syntax and had to be combined with `-debug` to take effect.\r\n - The logging RPC gains trace support: a new trace parameter enables trace-level logging per category, and the output now distinguishes excluded/debug/trace categories. (`-deprecatedrpc=logging` preserves the old format.)\r\n\r\nFor developers:\r\n\r\n  - `STDLOCK()` macro for `StdMutex`, enabling clang thread-safety analysis to catch annotation gaps.\r\n  - `util::log::NO_RATE_LIMIT` lets you write LogInfo(util::log::NO_RATE_LIMIT, \"...\") instead of using the internal `LogPrintLevel` function.\r\n  - Cleaner internals: `LogPrintLevel` moves to a `detail_` namespace, `GetLogCategory` moves into `Logger`, and more\r\n  files switch from `logging.h` to the lighter `util/log.h` (continuing the separation started in #34465).",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2025-12-10T05:56:20Z",
      "updated_at": "2026-02-26T07:49:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34038",
      "labels": [
        "Needs release note"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1215,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3187823761,
      "number": 34342,
      "title": "cli: Replace libevent usage with simple http client",
      "body": "Part of the effort to remove the libevent dependency altogether, see #31194\r\n\r\nThis takes the [`HTTPHeaders` class](https://github.com/bitcoin/bitcoin/pull/32061/commits/d549f01caab659f1c431ccabf0f5ff1800debcfe) from #32061 and puts it into [`common/http.h|cpp`](https://github.com/bitcoin/bitcoin/pull/34342/commits/634d4dcfa428f17f0a12c2e2742c2c08e2345033). While it would not be strictly required for that PR to go in first, it might be better to review it first or simultaneously.\r\n\r\nOtherwise the change itself replaces the libevent-based HTTP client with a simple synchronous implementation which uses the `Sock` class directly.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2026-01-19T13:27:54Z",
      "updated_at": "2026-02-26T06:08:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34342",
      "labels": [
        "Scripts and tools"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 686,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3210441228,
      "number": 34411,
      "title": "[POC] Full Libevent removal",
      "body": "This builds on all the work being done by pinheadmz and fjahr (#32061, #34342, #34158), to demo a libevent-less bitcoind.\r\n\r\nOne thing we could decide to change, or not, is the `libevent` logging catergory. Other than that, any remaining references to libevent, should be in documentation/code comments.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-26T12:35:26Z",
      "updated_at": "2026-02-26T05:22:04Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34411",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 331,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3329031729,
      "number": 34678,
      "title": "net: drop connection on unknown socket family in AcceptConnection",
      "body": "When `SetSockAddr()` fails in` AcceptConnection()`, the code logs a warning but continues processing the connection with a default empty CService address. This means ban checks, whitelist matching, and all downstream logic operate on an invalid address.\r\n\r\nReturn early on failure instead, consistent with other error paths in the same function.\"",
      "state": "open",
      "user": "chriszeng1010",
      "created_at": "2026-02-26T04:52:29Z",
      "updated_at": "2026-02-26T04:52:47Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34678",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 412,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3223998841,
      "number": 34448,
      "title": "ci, iwyu: Fix warnings in `src/util` and treat them as errors",
      "body": "This PR [continues](https://github.com/bitcoin/bitcoin/pull/33725#issuecomment-3466897433) the ongoing effort to enforce IWYU warnings.\r\n\r\nSee [Developer Notes](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#using-iwyu).",
      "state": "open",
      "user": "hebasto",
      "created_at": "2026-01-29T15:38:39Z",
      "updated_at": "2026-02-26T04:45:22Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34448",
      "labels": [
        "Refactoring",
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 305,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3237671040,
      "number": 34486,
      "title": "net: Reduce local network activity when networkactive=0",
      "body": "Fixes https://github.com/bitcoin/bitcoin/issues/34190\r\n\r\nWhen `networkactive=0` is set, NAT-PMP port mapping and Tor **control connections**\r\nstill run in the background, mapping ports and logging retry attempts despite\r\nthe node being \"inactive.\"\r\n\r\nThis wires both subsystems to CConnman::SetNetworkActive so they start and stop\r\nwith the network state:\r\n\r\n- mapport: EnableMapPort is injected as a callback via CConnman::Options.\r\n  SetNetworkActive and SetMapPortEnabled both gate on network state.\r\n\r\n- torcontrol: is injected similarly. The callback dispatches onto the tor event loop via \r\n  event_base_once to respect thread ownership. `EVLOOP_NO_EXIT_ON_EMPTY` is \r\n  used to keep the event loop alive without keepalive timers, so the controller starts disconnected and waits for CConnman::Start() to signal.",
      "state": "open",
      "user": "willcl-ark",
      "created_at": "2026-02-02T17:46:47Z",
      "updated_at": "2026-02-26T04:11:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34486",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 873,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3243034362,
      "number": 34495,
      "title": "Replace boost signals with minimal compatible implementation",
      "body": "This drops our dependency on `boost::signals2`, leaving `boost::multi_index` as the only remaining boost dependency for bitcoind.\r\n\r\n`boost::signals2` is a complex beast, but we only use a small portion of it. Namely: it's a way for multiple subscribers to connect to the same event, and the ability to later disconnect individual subscribers from that event.\r\n\r\n`btcsignals` adheres to the subset of the `boost::signals2` API that we currently use, and thus is a drop-in replacement. Rather than implementing a complex `slot` tracking class that we never used anyway (and which was much more useful in the days before std::function existed), callbacks are simply wrapped directly in `std::function`s.\r\n\r\nThe new tests work with either `boost::signals2` or the new `btcsignals` implementation. Reviewers can verify\r\nfunctional equivalency by running the tests in the commit that introduces them against `boost::signals2`, then again with `btcsignals`.\r\n\r\nThe majority of the commits in this PR are preparation and cleanup. Once `boost::signals2` is no longer needed, it is removed from depends. Additionally, a few CMake targets no longer need boost includes as they were previously only required for signals.\r\n\r\nI think this is actually pretty straightforward to review. I kept things simple, including keeping types unmovable/uncopyable where possible rather than trying to define those semantics. In doing so, the new implementation has even fewer type requirements than boost, which I believe is due to a boost bug. I've opened a PR upstream for that to attempt to maintain parity between the implementations.\r\n\r\nSee individual commits for more details.\r\n\r\nCloses #26442.",
      "state": "open",
      "user": "theuni",
      "created_at": "2026-02-03T21:27:43Z",
      "updated_at": "2026-02-26T03:54:30Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34495",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1736,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3266545660,
      "number": 34547,
      "title": "lint: modernise lint tooling",
      "body": "Modernise our lint tooling by:\r\n\r\n\\- Replacing pyenv + pip with [uv](https://docs.astral.sh/uv/) for better Python environment and dependency management\r\n\\- Replacing mypy with https://github.com/astral-sh/ty\r\n\\- Replacing the 01_install.sh runtime install script with COPY --from multi-stage Docker image imports for uv, ruff, shellcheck, mlc, and ty\r\n\\- Moving ruff lint rules from hardcoded Rust array (in lint_py.rs) into a top-level ruff.toml, and add ty.toml for the type checker\r\n\\- Extracting all remaining pip dependencies into dedicated ci/lint/requirements.txt\r\n\r\nExtra rationale:\r\n\r\n`COPY --from` pulls pre-built binaries from upstream images instead of compiling/downloading at runtime. Containerfile layer optimisations reduce rebuild frequency further.\r\n\r\n`ty` is significantly faster/more modern/maintained than `mypy`, and configured declaratively.\r\n\r\nAdding root-level `[ty|ruff].toml` config files means contributors can easily run `ty check` or `ruff check` locally without running the full linter, along with being accessible to other tooling (similarly for requriements.txt).\r\n\r\nPinning tool versions in the dockerfile makes it more excplicit and easier to find.\r\n\r\nThe tradeoff we make here is that there is no longer a bare install script to install tooling on a local machine. However I think this is OK, as it currently only works for `apt`-based OSes anyway, and I don't think running the linter outside of the container is such a valuable use-case as it is with some of the other CI jobs.\r\n\r\nFurther work can drop individual rules from `ty.toml` fixing up the infringing code as necessary.\r\n\r\nI can split this up if wanted, but IMO it makes sense to do it altogether.",
      "state": "open",
      "user": "willcl-ark",
      "created_at": "2026-02-10T10:25:27Z",
      "updated_at": "2026-02-26T03:10:33Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34547",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1724,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3284200855,
      "number": 34589,
      "title": "ci: Temporarily use clang in valgrind tasks",
      "body": "valgrind currently does not work on GCC compiled executables, due to an upstream bug. https://bugs.kde.org/show_bug.cgi?id=472329\r\n\r\nSo temporarily switch to clang, so that a long term solution can be figured out in the meantime.\r\n\r\nAlso, expand the first valgrind suppression, so that it works with newer clang versions as well.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-02-14T09:39:26Z",
      "updated_at": "2026-02-26T02:34:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34589",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 373,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3310552312,
      "number": 34644,
      "title": "mining: add submitBlock to IPC Mining interface",
      "body": "This PR adds a `submitBlock` method to the IPC Mining interface, equivalent to the `submitblock` RPC. It accepts a serialized block over IPC, validates/processes it via the normal block-processing path.\r\n\r\nThe method uses the same result shape as `checkBlock`: `bool` + `reason/debug out-params`. It reports duplicate, inconclusive, and invalid-block rejection details, and initializes reason/debug on every call.\r\n\r\nCloses #34626",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2026-02-21T08:47:59Z",
      "updated_at": "2026-02-26T01:27:01Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34644",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 478,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3214411194,
      "number": 34418,
      "title": "qa: Make wallet_multiwallet.py Windows crossbuild-compatible",
      "body": "Makes the functional test compatible with *Linux->Windows cross-built executables*.\r\n\r\nMain parts:\r\n* Commit \"qa: Check for platform-independent part of error message\" switches to match on platform-independent part of error message.\r\n* Commit \"qa: Test scanning errors individually\" disentangles code causing the same error message substring, based on #31410.\r\n* Commit \"qa: Disable parts of the test when running under Windows or root\" enables the test to be run on Windows, based in part on https://github.com/bitcoin/bitcoin/pull/31410#issuecomment-3554721014.\r\n\r\nAlso:\r\n* Removes unused option in wallet_multiwallet.py.\r\n* Breaks apart wallet_multiwallet.py's `run_test()` into smaller test functions.\r\n* Improves `assert_equal()` output for dicts.\r\n\r\nFixes #31409.",
      "state": "open",
      "user": "hodlinator",
      "created_at": "2026-01-27T12:35:18Z",
      "updated_at": "2026-02-26T01:21:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34418",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 830,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3320853437,
      "number": 34662,
      "title": "ci: use LLVM/Clang 22 in tidy job",
      "body": "Changes needed for moving to Clang 22 in the tidy job.\r\n\r\nBased on #34422.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-02-24T13:43:51Z",
      "updated_at": "2026-02-26T01:06:28Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34662",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 108,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3327924207,
      "number": 34672,
      "title": "mining: add reason/debug to `submitSolution` and unify with `submitBlock`",
      "body": "Built on top of https://github.com/bitcoin/bitcoin/pull/34644\r\nPreferred to open a separate PR to keep the other one focused on `submitBlock`.\r\n\r\nThis PR:\r\n- Extracts a shared `ProcessBlock` helper that wraps `ProcessNewBlock` with `SubmitBlockStateCatcher` to capture `BlockValidationState`\r\n - Adds `reason` and `debug` output parameters to `submitSolution`, matching `submitBlock`\r\n - Makes both methods delegate to the same helper, eliminating duplicated logic",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2026-02-25T21:40:25Z",
      "updated_at": "2026-02-26T00:52:57Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34672",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 538,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3328427704,
      "number": 34676,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "1amhesus",
      "created_at": "2026-02-26T00:33:21Z",
      "updated_at": "2026-02-26T00:34:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34676",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3328406467,
      "number": 34675,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "1amhesus",
      "created_at": "2026-02-26T00:25:02Z",
      "updated_at": "2026-02-26T00:25:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34675",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3326623224,
      "number": 34669,
      "title": "feefrac: drop comparison and operator{<<,>>} for sorted wrappers",
      "body": "Instead of having an unintuitive but strong implicit sort order on `FeeFrac` (first increasing feerate, then decreasing size), and separate overloaded `operator<<` and `operator>>` that implement a weak ordering that only looks at feerate, replace these with explicit wrapper classes which make the behavior more explicit (`ByRatio` and `ByRatioNegSize`).\r\n\r\nThis allows for things like `ByRatio{a} <= ByRatio{b}`, instead of the earlier `!(a >> b)`. It also supports usage inside `std::min`/`std::max`/`std::less`, and `std::greater`, so one can use:\r\n* `std::max<ByRatioNegSize<FeeFrac>>(a, b)` to get the highest-feerate `FeeFrac`, tie-breaking by smallest size.\r\n* `std::ranges::sort(v, std::greater<ByRatioNegSize<FeeFrac>>{});` to sort a vector that way.\r\n\r\nSuggested in https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2780475893.\r\n",
      "state": "open",
      "user": "sipa",
      "created_at": "2026-02-25T16:39:08Z",
      "updated_at": "2026-02-25T23:06:16Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34669",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 913,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3079464109,
      "number": 34028,
      "title": "p2p: Prevent integer overflow in LocalServiceInfo::nScore",
      "body": "The `nScore` field in `LocalServiceInfo` could overflow during version handshakes that wrap from `INT_MAX to INT_MIN` triggering undefined behavior in address selection\r\n\r\n`SeenLocal()` now saturates `nScore` at `std::numeric_limits <int>::max()`, so further increments stay capped\r\n\r\nThe test `LocalAddress_nScore_Overflow` covers the saturation behavior \r\n\r\nThis should fix the issue #24049",
      "state": "open",
      "user": "codeabysss",
      "created_at": "2025-12-07T20:08:41Z",
      "updated_at": "2026-02-25T22:47:02Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34028",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 450,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3328150278,
      "number": 34674,
      "title": "net: prevent signed integer overflow in AddLocal nScore update",
      "body": "When `AddLocal()` is called for an address already in mapLocalHost, it increments nScore by 1. If nScore is at INT_MAX, this is signed integer overflow (undefined behavior).\r\n\r\nUse `SaturatingAdd `from` util/overflow.h` to cap at INT_MAX instead.\r\n\r\nThis is the same class of bug addressed for `SeenLocal()` in #[34028](https://github.com/bitcoin/bitcoin/pull/34028/changes/3fc5948e1feeb13babeeb7c4e32c97dc35f630d5), but in a different call site.\r\n",
      "state": "open",
      "user": "chriszeng1010",
      "created_at": "2026-02-25T22:46:32Z",
      "updated_at": "2026-02-25T22:46:52Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34674",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 511,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1389230610,
      "number": 27865,
      "title": "wallet: Track no-longer-spendable TXOs separately",
      "body": "In #27286, the wallet keeps track of all of its transaction outputs, even if they are already spent or are otherwise unspendable. This TXO set is iterated for balance checking and coin selection preparation, which can still be slow for wallets that have had a lot of activity. This PR aims to improve the performance of such wallets by moving UTXOs that are definitely no longer spendable to a different map in the wallet so that far fewer TXOs need to be iterated for the aforementioned functions.\r\n\r\nUnspendable TXOs (not to be confused with Unspent TXOs) are those which have a spending transaction that has been confirmed, or are no longer valid due to reorgs. TXOs that are spent in unconfirmed transactions remain in the primary TXO set, and are filtered out of balance and coin selection as before.\r\n\r\nDepends on #27286",
      "state": "open",
      "user": "achow101",
      "created_at": "2023-06-12T18:40:10Z",
      "updated_at": "2026-02-25T21:13:47Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/27865",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 876,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1640676570,
      "number": 29060,
      "title": "Policy: Report debug message why inputs are non standard",
      "body": "This PR is another attempt at  #13525.\r\n\r\nTransactions that fail `PreChecks` Validation due to non-standard inputs now  returns invalid validation state`TxValidationResult::TX_INPUTS_NOT_STANDARD` along with a debug error message.\r\n\r\nPreviously, the debug error message for non-standard inputs do not specify why the inputs were considered non-standard. \r\nInstead, the same error string, `bad-txns-nonstandard-inputs`, used for all types of non-standard input scriptSigs.\r\n\r\nThis PR updates the `AreInputsStandard`  to include the reason why inputs are non-standard in the debug message.\r\nThis improves the `Precheck` debug message to be more descriptive.\r\n\r\nFurthermore, I have addressed all remaining comments from #13525 in this PR.\r\n",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2023-12-12T13:16:05Z",
      "updated_at": "2026-02-25T20:56:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29060",
      "labels": [
        "TX fees and policy"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 794,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1655695603,
      "number": 29136,
      "title": "wallet: `addhdkey` RPC to add just keys to wallets via new `unused(KEY)` descriptor",
      "body": "It is sometimes useful for the wallet to have keys that it can sign with but are not (initially) involved in any scripts, e.g. for setting up a multisig. Ryanofsky [suggested](https://github.com/bitcoin/bitcoin/pull/26728#issuecomment-1867721948) A `unused(KEY)` descriptor which allows for a key to be specified, but produces no scripts. These can be imported into the wallet, and subsequently retrieved with `gethdkeys`. Additionally, `listdescriptors` will output these descriptors so that they can be easily backed up.\r\n\r\nIn order to make it easier for people to add HD keys to their wallet, and to generate a new one if they want to rotate their descriptors, an `addhdkey` RPC is also added. Without arguments, it will generate a new HD key and add it to the wallet via a `unused(KEY)` descriptor. If provided a private key, it will construct the descriptor and add it to the wallet.\r\n\r\nSee also: https://github.com/bitcoin/bitcoin/pull/26728#issuecomment-1866961865\r\n\r\nBased on #29130 as `gethdkeys` is useful for testing this.",
      "state": "open",
      "user": "achow101",
      "created_at": "2023-12-22T23:40:15Z",
      "updated_at": "2026-02-25T20:52:55Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29136",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1117,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1685623460,
      "number": 29278,
      "title": "Wallet:  Add `maxfeerate` wallet startup option",
      "body": "This PR fixes #29220\r\n\r\n- The PR adds a wallet `-maxfeerate` startup option, as the upper limit of wallet transactions fee rate.\r\n\r\n- This fixes the ambiguity of using `maxtxfee` value to check the upper limit of transactions fee rate.\r\n\r\n-  Wallet will not create a transaction with fee rate above `maxfeerate` value. And you can not set wallet fee rate with `settxfee` RPC above `maxfeerate` value.\r\n\r\n- This PR adds a functional test that ensure the behavior is enforced.\r\n \r\n\r\n\r\n",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2024-01-18T22:23:49Z",
      "updated_at": "2026-02-25T20:45:58Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29278",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 531,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2138649533,
      "number": 31132,
      "title": "validation: fetch block inputs on parallel threads 3x faster IBD",
      "body": "_Parts of this PR are isolated in independent smaller PRs to ease review:_\r\n\r\n* [x] _https://github.com/bitcoin/bitcoin/pull/34164_\r\n* [x] _https://github.com/bitcoin/bitcoin/pull/34165_\r\n* [ ] _https://github.com/bitcoin/bitcoin/pull/34576_\r\n\r\n---\r\n\r\nThis PR parallelizes fetching all input prevouts of a block during block connection, achieving over 3x faster IBD performance in some scenarios[^1][^2][^3][^4][^5].\r\n\r\n### Problem\r\n\r\nCurrently, when fetching inputs in `ConnectBlock`, each input is fetched from the cache sequentially. A cache miss requires a round trip to the disk database to fetch the outpoint and insert it into the cache. Since the database is read-only during `ConnectBlock`, we can fetch all inputs of a block in parallel on multiple threads while connecting.\r\n\r\n### Solution\r\n\r\nWe add a ThreadPool to CoinsViewOverlay to fetch block inputs in parallel. The block is passed to the `CoinsViewOverlay` view before entering `ConnectBlock`, which kicks off the worker threads to begin fetching the inputs. The cache returns fetched coins as they become available via the overridden `FetchCoinFromBase` method. If not available yet, the main thread also fetches coins as it waits.\r\n\r\n### Implementation Details\r\n\r\nThe `CoinsViewOverlay` implements a lock-free MPSC (Multiple Producer, Single Consumer) queue design:\r\n\r\n- **Work Distribution**: Collects all input prevouts into a queue and uses a barrier to start all worker threads simultaneously\r\n- **Synchronization**: Worker threads use an atomic counter to claim which inputs to fetch, and each input has an atomic flag to signal completion to the main thread\r\n- **Main Thread Processing**: The main thread waits for inputs in order and moves their `Coin` into the `cacheCoins` map as they become available.\r\n- **Work Stealing**: If the main thread catches up to the workers, it assists with fetching to maximize parallelism\r\n- **Completion**: All thread futures are waited on in StopFetching, which is called from any mutating method (Flush/Sync/SetBackend/Reset). The ResetGuard going out of scope ensure this happens before the block is destroyed.\r\n\r\n### Safety and Correctness\r\n\r\n- The `CoinsViewOverlay` works on a block that has not been fully validated, but it does not interfere or modify any of the validation during `ConnectBlock`\r\n- It simply fetches inputs in parallel, which must be fetched before a transaction is validated anyways\r\n- **Invalid blocks**: If an invalid block is mined, the temporary cache is reset without being flushed. This is an improvement over the current behavior, where existing inputs are inserted into the main `CoinsTip()` cache when pulled through for an invalid block\r\n\r\n### Performance\r\n\r\nBenchmarks show over 3x faster IBD performance in a cloud environment with network connected storage[^1], 3x faster IBD for an M4 Mac and up to 46% faster with directly connected storage[^2][^3][^4][^5]. The parallelization of expensive disk lookups provides significant speedup.\r\n\r\n[Flamegraphs show how the execution is changed](https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3617315125).\r\n\r\n### Credits\r\n\r\nInspired by [this comment](https://github.com/bitcoin/bitcoin/pull/18941#issuecomment-638553680).\r\n\r\nResolves https://github.com/bitcoin/bitcoin/issues/34121.\r\n\r\n[^1]: https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3678847806\r\n[^2]: https://github.com/bitcoin/bitcoin/pull/31132#pullrequestreview-3515011880\r\n[^3]: https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3463894000\r\n[^4]: https://github.com/bitcoin/bitcoin/pull/31132#pullrequestreview-3347436866\r\n[^5]: https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3488760623",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2024-10-22T14:40:28Z",
      "updated_at": "2026-02-25T20:13:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31132",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3747,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3251388923,
      "number": 34521,
      "title": "validation: fix UB in `LoadChainTip`",
      "body": "Addresses https://github.com/bitcoin/bitcoin/issues/34503. See this issue for more details as well.\r\n\r\nFixes a bug where, under certain conditions, `setBlockIndexCandidates` had blocks in it that were worse than the tip. Removing the tip from `setBlockIndexCandidates` before modifying its `nSequenceId` avoids the undefined behavior that results from modification of the sequence id field while the tip is still in the set.\r\n\r\n",
      "state": "open",
      "user": "marcofleon",
      "created_at": "2026-02-05T18:23:00Z",
      "updated_at": "2026-02-25T20:11:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34521",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 465,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2285701879,
      "number": 31682,
      "title": "[IBD] specialize CheckBlock's input & coinbase checks",
      "body": "This change is part of [[IBD] - Tracking PR for speeding up Initial Block Download](https://github.com/bitcoin/bitcoin/pull/32043)\r\n\r\n### Summary\r\n`CheckBlock`'s latency is critical for efficiently validating correct inputs during transaction validation, including mempool acceptance and new block creation.\r\n\r\nThis PR improves performance and maintainability by introducing the following changes:\r\n* Simplified checks for the most common cases (1 or 2 inputs - [70-90% of transactions have a single input](https://transactionfee.info/charts/transactions-1in)).\r\n* Optimized the general case by replacing `std::set` with sorted `std::vector` for improved locality.\r\n* Simplified Null prevout checks from linear to constant time.\r\n\r\n### Context, concerns\r\n\r\nAs noted by Sipa in https://github.com/bitcoin/bitcoin/pull/31682#pullrequestreview-2570273162, this is consensus-critical code (especially since we've had an actual inflation bug related to duplicate checking).\r\nHowever, the changes here are very confined to a single function, easily reviewed, and I have a general preference for avoiding `std::set` when sorted `std::vector` works too as well.\r\n\r\nThe goal of this change is to [make block validation faster](https://github.com/bitcoin/bitcoin/pull/14387#issuecomment-442748969) via a low-risk alternative.\r\n\r\n### Measurements\r\n\r\n<details>\r\n<summary>C++ compiler .......................... AppleClang 16.0.0.16000026</summary>\r\n\r\n> Before:\r\n\r\n|            ns/block |             block/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|          372,743.63 |            2,682.81 |    1.1% |     10.99 | `CheckBlockBench`\r\n\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|        3,304,694.54 |              302.60 |    0.5% |     11.05 | `DuplicateInputs`\r\n|            9,585.10 |          104,328.55 |    0.1% |     11.03 | `ProcessTransactionBench`\r\n\r\n> After:\r\n\r\n|            ns/block |             block/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|          179,971.00 |            5,556.45 |    0.3% |     11.02 | `CheckBlockBench`\r\n\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|          963,177.98 |            1,038.23 |    1.7% |     10.92 | `DuplicateInputs`\r\n|            9,410.90 |          106,259.75 |    0.3% |     11.01 | `ProcessTransactionBench`\r\n\r\n</details>\r\n\r\n* 2.07x faster `CheckBlockBench`\r\n* 3.4x faster `DuplicateInputs`\r\n* 1.8% faster `ProcessTransactionBench`\r\n\r\n-----\r\n\r\n<details>\r\n<summary>C++ compiler .......................... GNU 13.3.0</summary>\r\n\r\n> Before:\r\n\r\n|            ns/block |             block/s |    err% |       ins/block |       cyc/block |    IPC |      bra/block |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|        1,096,261.84 |              912.19 |    0.1% |    7,963,390.88 |    3,487,375.26 |  2.283 |   1,266,941.00 |    1.8% |     11.03 | `CheckBlockBench`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|        8,366,309.48 |              119.53 |    0.0% |   23,865,177.67 |   26,620,160.23 |  0.897 |   5,972,887.41 |    4.0% |     10.78 | `DuplicateInputs`\r\n|           56,199.57 |           17,793.73 |    0.1% |      229,263.01 |      178,766.31 |  1.282 |      15,509.97 |    0.5% |     10.91 | `ProcessTransactionBench`\r\n\r\n> After:\r\n\r\n|            ns/block |             block/s |    err% |       ins/block |       cyc/block |    IPC |      bra/block |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|          834,855.94 |            1,197.81 |    0.0% |    6,518,548.86 |    2,656,039.78 |  2.454 |     919,160.84 |    1.5% |     10.78 | `CheckBlockBench`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|        4,261,492.75 |              234.66 |    0.0% |   17,379,823.40 |   13,559,793.33 |  1.282 |   4,265,714.28 |    3.4% |     11.00 | `DuplicateInputs`\r\n|           55,819.53 |           17,914.88 |    0.1% |      227,828.15 |      177,520.09 |  1.283 |      15,184.36 |    0.4% |     10.91 | `ProcessTransactionBench`\r\n\r\n</details>\r\n\r\n* 31% faster `CheckBlockBench`\r\n* 2x faster `DuplicateInputs`\r\n* 0.5% faster `ProcessTransactionBench`\r\n\r\n----\r\n\r\nWhile the point of the change isn't necessarily to speed up IBD, but you can see the measurements at https://github.com/bitcoin/bitcoin/pull/31682#issuecomment-2606765689\r\n\r\n----\r\n\r\nRelated PRs: \r\n* https://github.com/bitcoin/bitcoin/pull/14397 - very similar solution, I only found it after pushing the PR (was closed for inactivity)\r\n* https://github.com/bitcoin/bitcoin/pull/14837 - a faster, but a lot more complex alternative (was closed for complexity and inactivity).",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-01-18T15:03:56Z",
      "updated_at": "2026-02-25T19:39:51Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31682",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 5734,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2426922942,
      "number": 32162,
      "title": "depends: Switch from multilib to platform-specific toolchains",
      "body": "Using the multilib GCC toolchain, as currently documented in [`depends/README.md`](https://github.com/bitcoin/bitcoin/blob/4c1906a500cacab385b09e780b54271b0addaf4b/depends/README.md), has several issues, such as:\r\n\r\n1. The [`g++-multilib`](https://packages.ubuntu.com/noble/g++-multilib) package conflicts with platform-specific cross-compiler packages. This means it is not possible to cross compile for `i686` and other platforms using the same set of installed packages.\r\n\r\n2. The [`g++-multilib`](https://packages.ubuntu.com/noble/g++-multilib) package is not available for `arm64`:\r\n```sh\r\n$ sudo apt install g++-multilib\r\nReading package lists... Done\r\nBuilding dependency tree... Done\r\nReading state information... Done\r\nE: Unable to locate package g++-multilib\r\n```\r\n\r\n3. Managing the multilib GCC toolchain requires additional code in both depends and Guix scripts.\r\n\r\nThis PR addresses all the issues mentioned above by switching from multilib to platform-specific toolchains.\r\n\r\nAlso see https://github.com/bitcoin/bitcoin/pull/22456.\r\n\r\n---\r\n\r\nHere are examples of building for different scenarions:\r\n\r\n- Linux, `x86_64` or `arm64`, building with depends natively:\r\n```sh\r\n$ gmake -C depends -j $(nproc)\r\n$ cmake -B build --toolchain depends/$(./depends/config.sub $(./depends/config.guess))/toolchain.cmake\r\n$ cmake --build build -j $(nproc)\r\n```\r\n\r\n- Linux, `x86_64` or `arm64`, cross compiling for `i686-pc-linux-gnu`:\r\n```sh\r\n$ sudo apt install g++-i686-linux-gnu binutils-i686-linux-gnu\r\n$ export HOST=i686-linux-gnu\r\n$ gmake -C depends -j $(nproc)\r\n$ cmake -B build-${HOST} --toolchain depends/${HOST}/toolchain.cmake\r\n$ cmake --build build-${HOST} -j $(nproc)\r\n```\r\n\r\n- Linux, `x86_64`, cross compiling for `arm64`:\r\n```sh\r\n$ sudo apt install g++-aarch64-linux-gnu binutils-aarch64-linux-gnu\r\n$ export HOST=aarch64-linux-gnu\r\n$ gmake -C depends -j $(nproc)\r\n$ cmake -B build-${HOST} --toolchain depends/${HOST}/toolchain.cmake\r\n$ cmake --build build-${HOST} -j $(nproc)\r\n```\r\n\r\n- Linux, `arm64`, cross compiling for `x86_64`:\r\n```sh\r\n$ sudo apt install g++-x86-64-linux-gnu binutils-x86-64-linux-gnu\r\n$ export HOST=x86_64-linux-gnu\r\n$ gmake -C depends -j $(nproc)\r\n$ cmake -B build-${HOST} --toolchain depends/${HOST}/toolchain.cmake\r\n$ cmake --build build-${HOST} -j $(nproc)\r\n```\r\n",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-03-29T13:34:59Z",
      "updated_at": "2026-02-25T19:12:03Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32162",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2364,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3070554287,
      "number": 34004,
      "title": "Implementation of SwiftSync",
      "body": "Link to the original protocol writeup found [here](https://gist.github.com/RubenSomsen/a61a37d14182ccd78760e477c78133cd). See the [Delving Bitcoin post](https://delvingbitcoin.org/t/swiftsync-speeding-up-ibd-with-pre-generated-hints-poc/1562) for initial works and discussion.\r\n\r\n# Motivation\r\n\r\nWhile many coins are available in cache when spent, every cache miss requires a trip to the disk. Memory can be scarce for single board machines, so cache misses are expected to be far more frequent. A trip to disk is all-the-more severe on low end hardware, so any minimization of disk interactions can speed up initial block download for limited resource devices. One such example may be a block template provider serving a home miner.\r\n\r\n# Intuition\r\n\r\nThe vast majority of coins created are later spent. The cost of this observation is many coins will be written to disk, only to be removed later. The SwiftSync protocol alleviates the problem by recording what coins have been added and removed with a small, in-memory aggregate. This allows for the removal of intermediate coin states until SwiftSync has completed. The state of the aggregate is verified at a predetermined chain height, and IBD continues as usual thereafter.\r\n\r\nFor any chain height, we know `all outputs - all inputs = UTXO set`, which is equivalently `all outputs - UTXO set = all inputs`. The goal is to verify the set `all outputs - UTXO set` is equal to `all inputs`. Addition and subtraction modulo a field offers a way to do so. For any set, if we add all elements of the set and subtract them, regardless of ordering, we will arrive at zero. In the current implementation, the set elements being compared are hashed outpoints.\r\n\r\nThe SwiftSync protocol is comprised of two structures. First, the aggregate that will record the state of what outpoints have been added (created) or subtracted (spent). Next, notice that the UTXO set must be reported in order to verify `all outputs - UTXO set = all inputs`. SwiftSync introduces a hints file, which may be provided to the client at startup. This hints file is nothing more than a pointer to each unspent output by recording the block height and the indexes that will remain unspent. By using this file, a client may omit outpoints that will be in the UTXO set when updating the aggregate. Note this file is not trusted. If a malicious actor provides a faulty UTXO set, the set comparison above will fail, and the client may begin a reindex.\r\n# Implementation\r\n\r\n## Aggregate\r\n\r\nThe hash aggregate takes outpoints, hashes them with a salted hasher, and updates 4, 64-bit limbs with wrapping modulo arithmetic. The choice of 4, 64-bit limbs with no carries between limbs was made to: 1. minimize code complexity within the aggregate 2. conform to existing APIs, namely `uint256`. After adding and subtracting some arbitrary list of outpoints, we may poll if the sets were equivalent with `IsZero`.\r\n## Hintsfile\r\n\r\nThe hints file is a map of block height to the indexes of the outputs in that block that _will_ be in the UTXO set. To construct this file for a particular UTXO set state, each block must be read and queried to find the outputs in that block that remain unspent. Because this is a read-only operation, this may be done on parallel threads in the future. To allow for parallelization, the hints file contains a \"contents\" section, which denotes the height and corresponding file position to find the hints for that block.\r\n\r\nTo save space when representing the indexes that remain unspent in a block, an easy choice is to take the difference between the last coin that was unspent and the next one in the block. AFICT this is a version of run-length-encoding. These indexes are encoded using `compactSize` to further save space, the run-lengths should normally fit into at least 16 bits, often 8 bits.\r\n## Parameter Interaction\r\n\r\nA side effect of omitting intermediate UTXO states while performing IBD is the \"undo data\" cannot be derived. There are already configurations that do not have full undo data history, namely pruned nodes. To avoid additional complexity in this PR, this version of accelerated IBD is only made available to pruned nodes, as the undo data would have been removed regardless of the this setting.\r\n\r\nOther parameter interactions, not yet implemented:\r\n- `assumeutxo`: Startup should fail if both are configured. A hints file will have no effect, as the UTXO set is already present.\r\n- `assumevalid`: A natural choice is to only allow SwiftSync when using `assumevalid`, and to only allow a hints file that commits to the `assumevalid` block. Similar to `assumeutxo`, a hash of the hints file may be committed to in the binary, which would be resistant to griefing attacks.\r\n# Open Questions\r\n\r\n- Given the outcome of SwiftSync is pass/fail, and there is no use of intermediate states, should blocks be persisted to disk at all during the protocol?\r\n- To what degree should a hints file be committed to in the binary. No commitment allows for a server to provide hints for an arbitrary height, providing a convenience for the client, but opens up the possibility of a grief attack. Of course the server risks losing reputation for serving faulty files.\r\n\r\n# Future Iteration\r\n\r\nThis is the first iteration of the SwiftSync proposal, however more optimizations may be made. Namely, because set elements may be added or subtracted from the aggregate in any order, blocks may be downloaded in parallel from multiple peers. If you are interested in benchmarking the performance of a fully-parallel version, see the [Rust implementation](https://github.com/2140-dev/swiftsync).\r\n",
      "state": "open",
      "user": "rustaceanrob",
      "created_at": "2025-12-04T09:50:39Z",
      "updated_at": "2026-02-25T19:07:57Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34004",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 1,
        "text_length": 5666,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2471245988,
      "number": 32317,
      "title": "kernel: Separate UTXO set access from validation functions",
      "body": "The current code makes it hard to call functions for checking the consensus-correctness of a block without having a full UTXO set at hand. This makes implementing features such as Utreexo and non-assumevalid swiftsync, where maintaining a full UTXO set defeats their purpose, through the kernel API difficult. Checks like the coinbase subsidy, or block sigops are only available through `ConnectBlock`, which requires a complete coins cache.\r\n\r\nSolve this by moving accessing coins and the responsibility of spending them out of `ConnectBlock` and into a new separate function called `SpendBlock`. Pass a block's spent coins through the existing `CBlockUndo` data structure to `ConnectBlock`. \r\n\r\nWhile the change is largely a refactor, some smaller behaviour changes were unavoidable. These should be highlighted in the commit messages. The last commit contains the most important part of the coins logic move, the commits before attempt to prepare it piecemeal.\r\n\r\nThis pull request was benchmarked on [benchcoin](https://github.com/bitcoin-dev-tools/benchcoin/pull/162), which showed no performance regression. While discussing this pull request it was noted that pre-fetching and eliminating the need for some additional map lookups might improve performance a bit, but this does not make a measurable difference in the grand scheme of things and was not the motivation for this pull request.\r\n\r\nIn future changes, ConnectBlock could be made even more self contained, accessing the coins from the internal map could be further optimized by consolidating existence checking and spending, and the function eventually exposed in an external kernel API (as done [here](https://github.com/sedited/bitcoin/commit/09e05493010119fc60d310d3e7ffc388de441f9a#diff-f638e65d9278276b2a6ac42ffbbd26d079c3dba752feed5038a25a1ee565d320R947))",
      "state": "open",
      "user": "sedited",
      "created_at": "2025-04-21T13:15:46Z",
      "updated_at": "2026-02-25T18:58:05Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32317",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1886,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3200991905,
      "number": 34382,
      "title": "test: wallet: Check fallbackfee default argument behavior.",
      "body": "In an unmerged branch of #32636 (https://github.com/bitcoin/bitcoin/commit/097e00f90765915b0f8353a4eb5ebb18ceae2a66) I unintentionally broke default `-fallbackfee` behavior, but this was not caught by any tests. See https://github.com/bitcoin/bitcoin/pull/32636#discussion_r2706178076.\r\n\r\nSomething like the following diff does not cause any test failures on master despite causing a behavior change:\r\n\r\n```diff\r\ndiff --git a/src/wallet/wallet.cpp b/src/wallet/wallet.cpp\r\nindex bc27018cd2..079610fba0 100644\r\n--- a/src/wallet/wallet.cpp\r\n+++ b/src/wallet/wallet.cpp\r\n@@ -3048,24 +3048,24 @@ std::shared_ptr<CWallet> CWallet::Create(WalletContext& context, const std::stri\r\n     if (const auto arg{args.GetArg(\"-fallbackfee\")}) {\r\n         std::optional<CAmount> fallback_fee = ParseMoney(*arg);\r\n         if (!fallback_fee) {\r\n             error = strprintf(_(\"Invalid amount for %s=<amount>: '%s'\"), \"-fallbackfee\", *arg);\r\n             return nullptr;\r\n         } else if (fallback_fee.value() > HIGH_TX_FEE_PER_KB) {\r\n             warnings.push_back(AmountHighWarn(\"-fallbackfee\") + Untranslated(\" \") +\r\n                                _(\"This is the transaction fee you may pay when fee estimates are not available.\"));\r\n         }\r\n         walletInstance->m_fallback_fee = CFeeRate{fallback_fee.value()};\r\n+        // Disable fallback fee in case value was set to 0, enable if non-null value\r\n+        walletInstance->m_allow_fallback_fee = walletInstance->m_fallback_fee.GetFeePerK() != 0;\r\n     }\r\n\r\n-    // Disable fallback fee in case value was set to 0, enable if non-null value\r\n-    walletInstance->m_allow_fallback_fee = walletInstance->m_fallback_fee.GetFeePerK() != 0;\r\n```\r\n\r\nThis PR adds a functional test check that when no `-fallbackfee` argument is set and fee estimation is not possible, that sending fails because `-fallbackfee` is disabled by default.",
      "state": "open",
      "user": "davidgumberg",
      "created_at": "2026-01-22T21:15:04Z",
      "updated_at": "2026-02-25T18:45:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34382",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1935,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3265664984,
      "number": 34545,
      "title": "doc: Update Guix installation instructions for Debian/Ubuntu",
      "body": " The `guix` package was removed from Debian repositories due to security \r\n vulnerabilities (CVE-2025-46415, CVE-2025-46416) affecting guix-daemon. \r\n See https://lwn.net/Articles/1035491/\r\n     \r\n Ubuntu and Debian derivatives will likely follow.\r\n     \r\n Updates the Debian/Ubuntu section to warn users and redirect to alternative \r\n installation methods already documented in the file.\r\n\r\n\r\n Fixes #33982\r\n",
      "state": "closed",
      "user": "ToRyVand",
      "created_at": "2026-02-10T06:05:27Z",
      "updated_at": "2026-02-25T18:43:37Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34545",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 470,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2511642895,
      "number": 32468,
      "title": "rpc: generateblock to allow multiple outputs",
      "body": "## Generatetomany\r\n\r\nFirst approach was to create a `generatetomany` rpc call. That approach can be seen here https://github.com/polespinasa/bitcoin/pull/3\r\n\r\n## Generateblock\r\nModifies `generateblock` to allow a user to set multiple outputs in the coinbase transaction. If an empty set is provided, the block will be empty. If no set of transactions is provided, the block will mine the mempool. If a set of transactions is provided only that set of txs will be mined.\r\n\r\n```\r\n$./bitcoin-cli -rpcport=18443 generateblock bcrt1qw6qkj8wtw5hraxwxjp08m4aymkntms3yhqyacj\r\n{\r\n  \"hash\": \"7359a3ed7af0f18f4016e6cb29193bd787a2452c584781135c585d5204b9ec5b\"\r\n}\r\n\r\n$ ./bitcoin-cli -rpcport=18443 generateblock '[\"bcrt1qal6p633hvwz2yp5mav0qy7u2az8gkn2xywnj6v\", \"bcrt1qvr3qgyhw6y0e0zj97v0j5yc40xtpea4wqj0g43\"]'\r\n{\r\n  \"hash\": \"6db028454b26d6667dd6df45be2772844121fb44f86433f6bbfbafa429974684\"\r\n}\r\n\r\n$ ./bitcoin-cli -rpcport=18443 generateblock '[\"bcrt1qal6p633hvwz2yp5mav0qy7u2az8gkn2xywnj6v\", \"bcrt1qvr3qgyhw6y0e0zj97v0j5yc40xtpea4wqj0g43\"]' []\r\n\r\n{\r\n  \"hash\": \"33e2ddc52546ddb0edf28bef5b295ee8fbd487b8aca19c97018467e2477877df\"\r\n}\r\n\r\n```\r\n\r\n### Motivation\r\nhttps://x.com/SuperTestnet/status/1921220086645342550\r\n\r\nCitating @supertestnet \r\n> When mining a block on regtest, the command \"generatetoaddress\" is available if you want to send the entire coinbase to 1 address. Let's add generatetomany in case you want to split up the coinbase among multiple addresses, similar to how the \"sendtoaddress\" and \"sendmany\" commands both exist and let you send money to (1) one address or (2) multiple addresses. The generatetomany command would be particularly useful for simulating protocols that send money to multiple recipients directly from a coinbase, as several pools do now, like ocean and braidpool.\r\n\r\n### Notes\r\n- ~Needs release note~\r\n- ~Changes on `generateblock` are not backwards compatible as now it takes an array of outputs instead a single output. This should not be critical as it is a test RPC.~ ",
      "state": "open",
      "user": "polespinasa",
      "created_at": "2025-05-10T17:34:29Z",
      "updated_at": "2026-02-25T18:36:41Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32468",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2041,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2517768893,
      "number": 32489,
      "title": "wallet: Add `exportwatchonlywallet` RPC to export a watchonly version of a wallet",
      "body": "Currently, if a user wants to use an airgapped setup, they need to manually create the watchonly wallet that will live on the online node by importing the public descriptors. This PR introduces `exportwatchonlywallet` which will create a wallet file with the public descriptors to avoid exposing the specific internals to the user. Additionally, this RPC will copy any existing labels, transactions, and wallet flags. This ensures that the exported watchonly wallet is almost entirely a copy of the original wallet but without private keys.",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-05-13T22:22:00Z",
      "updated_at": "2026-02-25T18:33:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32489",
      "labels": [
        "Wallet",
        "Review club"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 622,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3049721564,
      "number": 33959,
      "title": "test: use ForkGenerator to deduplicate reorg test code",
      "body": "Deduplicate reorg test code by introducing `ForkGenerator` utility class in `blocktools.py`.\r\n\r\n### Changes\r\n  - Add `ForkGenerator` class with `prepare_fork()` / `trigger_reorg()` / `reset()` methods\r\n  - Removes duplicated `trigger_reorg()` methods across tests\r\n  - Update mempool tests to use the new utility\r\n  \r\nFor now I am keeping it as draft as we need to address other tests to eliminate use of `invalidate_block` for reorg scenario. Also, optional args for non-empty forks to test mix-and-match cases of transactions re-entering mempool as suggested by instagibbs in https://github.com/bitcoin/bitcoin/pull/32587#issuecomment-3549356286.",
      "state": "open",
      "user": "yuvicc",
      "created_at": "2025-11-27T05:49:29Z",
      "updated_at": "2026-02-25T18:16:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33959",
      "labels": [
        "Tests",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 703,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2607107167,
      "number": 32784,
      "title": "wallet: derivehdkey RPC to get xpub at arbitrary path",
      "body": "Given a (blank) wallet with an `unused(KEY)` descriptor, `derivehdkey \"m/87h/0h/0h\"` gets the xpub or xpriv at any given path.\r\n\r\nThis is particularly useful for multisig setup where it's not desirable to use our default derivations (e.g. 44h).\r\n\r\nI updated the multisig tutorial and the functional test.\r\n\r\nBased on:\r\n- #29136",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-06-20T11:04:39Z",
      "updated_at": "2026-02-25T18:00:58Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32784",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 381,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2637847621,
      "number": 32861,
      "title": "Have createwalletdescriptor auto-detect an unused(KEY)",
      "body": "The `createwalletdescriptor` was introduced in #29130 to let users add a `tr()` descriptor to an existing SegWit wallet. The new `addhdkey` method from #29136 introduces a new potential workflow: start from a blank wallet, generate an HD and then add only the descriptors you need, e.g.:\r\n\r\n```sh\r\nbitcoin rpc createwallet TaprootMaxi blank=true\r\nbitcoin rpc addhdkey\r\nbitcoin rpc createwalletdescriptor bech32m\r\n```\r\n\r\nBefore this PR the last line would fail, requiring the user to call `gethdkeys` and copy-paste the xpub.\r\n\r\nThis PR makes `createwalletdescriptor` a bit smarter so it just finds the `unused(KEY)` generated by `hdkey` and uses that.\r\n\r\nIf multiple `unused(KEY)` descriptors are present the user still has to pick one.\r\n\r\nA potential followup is to make our [multisig tutorial](https://github.com/bitcoin/bitcoin/blob/master/doc/multisig-tutorial.md) slightly safer to use. Rather than creating a full wallet, the instruction could be changed to start with a blank wallet and only generate the default legacy descriptor. This avoids accidental use of single sig `p2sh-segwit` and `bech32` addresses.\r\n\r\n(I might do that in #32784, which introduces some other improvements to the tutorial. The situation is still not great; ideally the `importdescriptors` RPC is enhanced to detect when an `xpub` is a child of an hd key and then treats it as if an xpriv was imported.)\r\n\r\nBuilds on #29136.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-07-03T08:55:40Z",
      "updated_at": "2026-02-25T17:46:51Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32861",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1462,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2647773300,
      "number": 32895,
      "title": "wallet: Prepare for future upgrades by recording versions of last client to open and decrypt",
      "body": "When a wallet is automatically upgraded, we always do so in a way that allows the user to load their wallet in an older version. When the user loads their wallet into an upgraded version again, the wallet may not perform the automatic upgrade and end up with upgraded and non-upgraded material in the wallet.\r\n\r\nIf we write some information about the last client to open the wallet, we would be able to detect these upgrade-downgrade-upgrade situations and perform another upgrade if so. However, in order for this to work, we need to have implemented writing such information into versions prior to the ones which introduce new automatic upgrades.\r\n\r\nWe are already writing the CLIENT_VERSION into all wallets in a \"version\" record, although this record is not updated in the same way across all previous versions. Since v24.0, we are always updating the record when the client version differs, but prior to that, the record would only be updated when the client version is newer. Even so, we can use this record to store the last client version.\r\n\r\nThe first commit decouples the written client version from the node version. This aids in development of new features. The version is entirely decoupled from previous versions by requiring all versions to have bit 30 set, and the initial version being `0 | (1 << 30)`. The versions just need to be at least 299900, and forcing bit 30 to be set was an easy way to achieve this.\r\n\r\nHowever, using version numbers is not as flexible as feature flags, so the second commit introduces the concept of Wallet Client Features. These flags are distinct from the existing Wallet Feature Flags since they are conceptually different. These are written in a separate record, and the wallet client version is incremented to `(1 << 0) | (1 << 30)`.\r\n\r\nLastly, since some upgrades may need private keys and can only occur after the wallet is decrypted, the third commit also adds a last decrypted features flags record to record the features of the last client to decrypt the wallet.\r\n\r\nThe result is that we will now be able to detect a downgrade down to v24.0 and be able to implement in parallel multiple features that require automatic upgrades.",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-07-07T20:13:08Z",
      "updated_at": "2026-02-25T17:36:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32895",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2277,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2677577590,
      "number": 33008,
      "title": "wallet: support bip388 policy with external signer",
      "body": "External signers such as Ledger, BitBox02 and Jade, when used with multisig, use [BIP388](https://github.com/bitcoin/bips/blob/master/bip-0388.mediawiki) to display (and constrain) descriptor policies to their users.\r\n\r\nAt least in the case of Ledger (no others so far, see https://github.com/bitcoin/bitcoin/pull/33008#issuecomment-3165080503) this requires us to hold on to an hmac, which proves to the device that the user previously reviewed and approved it.\r\n\r\nThis PR adds a new RPC call `registerpolicy` which converts our descriptor(s) into a BIP388 policy (_partially implemented_), calls a new HWI method `register` (_implemented_) and stores the resulting HMAC (_implemented_).\r\n\r\nWhen signing a transaction using HWI's `signtx` it passes the HMAC along with the PSBT (_TODO_).\r\n\r\nFor convenience the HMAC can be retrieved via `getwalletinfo` (_implemented_). This is useful for scenario's where we can't (yet) complete a transaction via HWI calls.\r\n\r\nNote that the HMAC itself is not specified in BIP388 and may be different for different hardware vendors. So we'll store and echo any hex string the device gives us.\r\n\r\nAn alternative approach to directly supporting BIP388 policies would be to pass the involved descriptors to HWI and have it figure out how to derive a policy.\r\n\r\nTesting:\r\n- make a multisig wallet with a Ledger or other [supported device](https://github.com/bitcoin/bips/blob/master/bip-0388.mediawiki#reference-implementation)\r\n  - try https://github.com/Sjors/bitcoin/pull/91 if you're feeling adventurous, it includes this PR\r\n- install https://github.com/bitcoin-core/HWI/pull/791 HWI branch\r\n- call `bitcoin rpc registerpolicy`\r\n- call `bitcoin rpc getwalletinfo` to see the hmac\r\n\r\nTODO:\r\n- [ ] derive policy using `Descriptor` class instead regex madness, implement all constraints\r\n- [ ] pass hmac along when signing\r\n\r\nDepends on:\r\n- [ ] HWI `register` command: https://github.com/bitcoin-core/HWI/pull/791\r\n- [ ] HWI optional `--hmac` argument for `signtx` (if set, bypass the current auto-registration workaround)\r\n\r\nPotential followups:\r\n- pass hmac along when displaying an address. This provides some extra assurance to the user. See https://github.com/bitcoin-core/HWI/pull/647\r\n",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-07-18T15:31:45Z",
      "updated_at": "2026-02-25T17:25:01Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33008",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2277,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2683376326,
      "number": 33034,
      "title": "wallet: Store transactions in a separate sqlite table",
      "body": "The wallet uses SQLite as a key-value store even though SQLite is a powerful relational database engine. This causes us numerous headaches due to the need to serialize multiple fields together, and since record read from the database during loading can come in any order.\r\n\r\nNotably, for transactions, if we were able to load them in the transaction order assigned by the wallet, PRs like #27865 would be a bit simpler and easier to reason about.\r\n\r\nThis PR makes it possible for us to do that by storing transactions in a separate table. This table has a column for each field in `CWalletTx`, which lets us use a SQL statement like `SELECT * FROM transactions ORDER BY pos` which guarantees us the order in which the transactions are loaded into the wallet.\r\n\r\nThe eventual goal is to use SQLite as a relational database with tables that store our keys and other metadata that can reference each other so that the wallet doesn't just use the database as a storage mechanism. But that is still a work in progress.\r\n\r\nThis PR makes use of the last client opened features introduced in #32895 to determine when the old record style needs to be upgraded to the new transactions table. This should give us sufficient upgrade-downgrade-upgrade handling to not lose any funds.\r\n\r\nDepends on #32763, #32895, #32985, #33032, #33033",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-07-21T22:52:54Z",
      "updated_at": "2026-02-25T17:06:25Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33034",
      "labels": [
        "Wallet",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1377,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3138438378,
      "number": 34184,
      "title": "mining: add cooldown to createNewBlock() immediately after IBD",
      "body": "As reported in #33994, connected mining clients will receive a flood of new templates if the node is still going through IBD or catching up on the last 24 hours. This PR fixes that using an _optional_ cooldown mechanism, only applied to `createNewBlock()`.\r\n\r\nFirst, cooldown waits for IBD. Then, as the tip keeps moving forward, it waits a few seconds to see if the tip updated. If so, it restarts the timer and waits again. The trade-offs for this mechanism are explained below.\r\n\r\nBecause this PR changes `createNewBlock()` from a method that returns quickly to one that can block for minutes, we rely on #34568 to fix a bug in our `.capnp` definition, adding the missing `context` to `createNewBlock` (and `checkBlock`).\r\n\r\nThe second commit then adds an `interrupt()` method so that clients can cleanly disconnect.\r\n\r\n---\r\n\r\n## Rationale\r\n\r\nThe cooldown argument is optional, and not used by internal non-IPC code, for two reasons:\r\n\r\n1. The mechanism wreaks havoc on the functional test suite, which would require very careful mock time handling to work around. But that's pointless, because only IPC clients need it.\r\n2. It needs to be optional for IPC clients too, because in some situations, like a signet with only one miner, waiting for IBD can mean being stuck forever.\r\n\r\nThe reason it's only applied to `createNewBlock()` is that this is the first method called by clients; `waitNext()` is a method on the interface returned by `createNewBlock()`, at which point the cooldown is done.\r\n\r\nAfter IBD, we wait N seconds if the header is N blocks ahead of the tip, with a minimum of 3 and a maximum of 20 seconds. The minimum waiting time is short enough that it shouldn't be annoying or confusing for someone manually starting up a client. While the maximum should be harmless if it happens spuriously (which it shouldn't).\r\n\r\nIf the minimum wait is too short, clients get a burst of templates, as observed in the original issue. We can't entirely rule this out without a lot of additional complexity (like scanning our own log file for heuristics). This PR should make it a lot less likely, and thanks to the IBD wait also limit it to one day worth of blocks (`-maxtipage`).\r\n\r\nSome test runs on an M4 MacBook Pro, where I had a node catch up on the last few days worth of blocks:\r\n\r\n<img width=\"872\" height=\"972\" alt=\"Scherm­afbeelding 2026-02-04 om 18 21 17\" src=\"https://github.com/user-attachments/assets/7902a0f2-0e0b-4604-9688-cec2da073261\" />\r\n\r\nAs the chart shows, sometimes it takes longer than 3 seconds. But it turns out that in all those cases there were quite a few headers ahead of the tip. It also demonstrates that it's important to first wait for IBD, because it's less likely a random tip update takes longer than 20 seconds.\r\n\r\n- modified sv2-apps: https://github.com/Sjors/sv2-apps/tree/2026/02/cooldown\r\n- test script: https://gist.github.com/Sjors/feb6122c97acc2b9e6d66b168614609c#file-run_mainnet_pool_loop-zsh\r\n- chart script: https://gist.github.com/Sjors/feb6122c97acc2b9e6d66b168614609c#file-tip_interval_charts-py",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2025-12-31T05:17:32Z",
      "updated_at": "2026-02-25T16:52:47Z",
      "merged_at": "2026-02-24T11:54:31Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34184",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3116,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3164120126,
      "number": 34257,
      "title": "txgraph: deterministic optimal transaction order",
      "body": "Part of #30289.\r\n\r\nTxGraph's fundamental responsibility is deciding the order of transactions in the mempool. It relies on the `cluster_linearize.h` code to optimize it, but there can and often will be many different orderings that are essentially equivalent from a quality perspective, so we have to pick one. At a high level, the solution will involve one or more of:\r\n* Deciding based on **internal identifiers** (`Cluster::m_sequence`, `DepGraphIndex`). This is very simple, but risks leaking information about transaction receive order.\r\n* Deciding **randomly**, which is private, but may interfere with relay expectations, block propagation, and ability to monitor network behavior.\r\n* Deciding **based on txid**, which is private and deterministic, but risks incentivizing grinding to get an edge (though we haven't really seen such behavior).\r\n* Deciding **based on size** (e.g. prefer smaller transactions), which is somewhat related to quality, but not unconditionally (depending on mempool layout, the ideal ordering might call for smaller transactions first, last, or anywhere in between). It's also not a strong ordering as there can be many identically-sized transactions. However, if it were to encourage grinding behavior, incentivizing smaller transactions is probably not a bad thing.\r\n\r\nAs of #32545, the current behavior is primarily picking randomly, though inconsistently, as some code paths also use internal identifiers and size. #33335 sought to change it to use random (preferring size in a few places), with the downsides listed above.\r\n\r\nThis PR is an alternative to that, which changes the order to tie-break based on size everywhere possible, and use lowest-txid-first as final fallback. This is fully deterministic: for any given set of mempool transactions, if all linearized optimally, the transaction order exposed by TxGraph is deterministic.\r\n\r\nThe transactions within a chunk are sorted according to:\r\n1. `PostLinearize` (which improves sub-chunk order), using an initial linearization created using the rules 2-5 below.\r\n2. Topology (parents before children).\r\n3. Individual transaction feerate (high to low)\r\n4. Individual transaction weight (small to large)\r\n5. Txid (low to high txid)\r\n\r\nThe chunks within a cluster are sorted according to:\r\n1. Topology (chunks after their dependencies)\r\n2. Chunk feerate (high to low)\r\n3. Chunk weight (small to large)\r\n4. Max-txid (chunk with lowest maximum-txid first)\r\n\r\nThe chunks across clusters are sorted according to:\r\n1. Feerate (high to low)\r\n2. Equal-feerate-chunk-prefix weight (small to large)\r\n3. Max-txid (chunk with lowest maximum-txid first)\r\n\r\nThe equal-feerate-chunk-prefix weight of a chunk C is defined as the sum of the weights of all chunks in the same cluster as C, with the same feerate as C, up to and including C itself, in linearization order (but excluding such chunks that appear after C). This is a well-defined approximation of sorting chunks from small to large across clusters, while remaining consistent with intra-cluster linearization order.\r\n",
      "state": "closed",
      "user": "sipa",
      "created_at": "2026-01-11T23:56:09Z",
      "updated_at": "2026-02-25T16:40:58Z",
      "merged_at": "2026-02-11T17:40:48Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34257",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3105,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2911002547,
      "number": 33616,
      "title": "policy: don't CheckEphemeralSpends on reorg",
      "body": "Similar reasoning to https://github.com/bitcoin/bitcoin/pull/33504\r\n\r\nDuring a deeper reorg it's possible that a long sequence of dust-having transactions that are connected in a linear fashion. On reorg, this could cause each subsequent \"generation\" to be rejected. These rejected transactions may contain a large amount of competitive fees via normal means.\r\n\r\nPreCheck based `PreCheckEphemeralSpends` is left in place because we wouldn't have relayed them prior to the reorg.",
      "state": "closed",
      "user": "instagibbs",
      "created_at": "2025-10-13T17:37:23Z",
      "updated_at": "2026-02-25T16:38:24Z",
      "merged_at": "2026-02-25T16:38:23Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33616",
      "labels": [
        "TX fees and policy"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 522,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2837615883,
      "number": 33421,
      "title": "node: add  `BlockTemplateCache`",
      "body": "This PR implements the first step of #33758 by adding a cache layer for node block templates.\r\n\r\nThe cache stores newly created block templates along with their configuration options. When clients request a block template, they specify an optional template age limit in `MillisecondsDouble`:\r\n\r\n- If template age limit is `nullopt`, we create a new template and return it without adding it to the cache.\r\n- If a matching template (block template with identical block creation options) exists in the cache and hasn't exceeded the age limit, the cached version is returned.\r\n- If no matching template exists or the age limit has been exceeded, a new template is generated, cached, and returned. When evicting stale templates, we assume no duplicates exist since templates are evicted as soon as their age limit is reached or exceeded.\r\n\r\nThe cache maintains a configurable maximum size (default: 10 templates). When this limit is exceeded, the oldest template is evicted after each insertion.\r\n\r\n\r\nCache lookup requires an exact match on ALL `BlockAssembler::Options` fields. While some fields (e.g., `test_block_validity`, `print_modified_fee`, `coinbase_output_script`) could be ignored for cache reuse, they mainly differ in tests and benchmarks. We keep the logic simple and accept cache misses in those cases.\r\n\r\n\r\nThe cache enforces at most one template per set of options. When searching for a match in `getCachedTemplate()`, if a template with matching options is found but has exceeded the age limit, it's immediately evicted before returning `nullptr`. This ensures no duplicate options exist in the cache. A `SanityCheck()` method verifies this invariant in tests by checking all cached entries for duplicates.\r\n\r\n\r\nThe cache subscribes to the validation interface and clears itself when blocks are connected (to non-historical chainstate to avoid clearing during assumeutxo background validation) or disconnected from the active chain (during reorgs), preventing stale or invalid templates from being served.\r\n\r\n`GetBlockTemplate()` uses double-checked locking: it first checks the cache with only `m_mutex` held, then if there's a miss, acquires both `cs_main` and `m_mutex` to create the template. Before creating, it checks again since another thread might have added a template while locks were released. \r\n\r\nThis PR removes an unused `node/context.h` import from miner to prevent a circular dependency when exposing the block template cache to the node context.",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2025-09-17T18:47:09Z",
      "updated_at": "2026-02-25T15:54:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33421",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2508,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3325872497,
      "number": 34668,
      "title": "test: Add missing resolve() to valgrind.supp file for test shell",
      "body": "(see commit message for details)\r\n\r\nCan be tested via:\r\n\r\n```\r\n./bld-cmake/test/functional/feature_framework_testshell.py --valgrind\r\n```\r\n\r\nBefore:\r\n\r\n```\r\nbitcoind exited with status 1 during initialization. ==1735813== FATAL: can't open suppressions file \"/b-c/b-c-2/bld-cmake/contrib/valgrind.supp\"\r\n```\r\n\r\nAfter: (passes)\r\n\r\n\r\nAlso, move the suppression file to all the other suppression files.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-02-25T13:52:54Z",
      "updated_at": "2026-02-25T15:11:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34668",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 464,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3310263904,
      "number": 34643,
      "title": "[RFC] cluster_linearize: add O(N) fast path for chain-shaped clusters",
      "body": "This PR relies on PR https://github.com/bitcoin/bitcoin/pull/34625\r\n## Summary                                                                       \r\n                                                                                 \r\nThis PR adds `TryLinearizeChain()`, an O(N) specialised linearizer for chain-shaped\r\nclusters, and a benchmark targeting the feerate distribution that triggers the worst-case\r\nbehaviour of the general SFL algorithm on chains.                                \r\n                                                                                 \r\n**Commits:**                                                                     \r\n- `ad15466be1e4` cluster_linearize: add O(N) fast path for chain-shaped clusters \r\n- `72bf0faf820c` cluster_linearize: benchmark Linearize on worst-case chain feerate distribution\r\n                                                                                 \r\n---                                                                              \r\n                                                                                 \r\n## Motivation                                                                    \r\n                                                                                 \r\nInstrumentation added to a running node revealed that **virtually most cluster seen in the\r\nmempool is chain-shaped** — each transaction spends an output of the previous one. This is\r\nconsistent with widespread use of CPFP (Child-Pays-For-Parent) fee bumping, where a\r\nlow-feerate parent transaction is paired with a high-feerate child that spends one of its\r\noutputs, forming a two-transaction chain; longer chains arise from repeated CPFP stacking or\r\nbatch-payment patterns.                                                          \r\n                                                                                 \r\nBecause chain clusters dominate in practice, a topology-specific O(N) fast path has\r\ndisproportionately large impact compared with optimising for rarer topologies.   \r\n                                                                                 \r\nThe general `Linearize()` function uses the Spanning Forest Linearization (SFL) algorithm, whose\r\n`MakeTopological()` phase merges chunks iteratively. For a chain cluster with N transactions\r\nand strictly increasing individual feerates (fee_i = i+1), `MakeTopological` triggers a\r\ncascade that merges the entire chain into one chunk step-by-step. At merge step k, two\r\noperations each scan the growing top-part chunk of size k:                       \r\n                                                                                 \r\n- `UpdateChunk` iterates over all k transactions to write their `chunk_rep` (unconditionally,\r\n  regardless of any inner-loop conditions).                                      \r\n- `MergeChunks` iterates over all k transactions to locate the dependency connecting top and\r\n  bottom chunks.                                                                 \r\n                                                                                 \r\nThis accumulates O(1+2+...+(N-1)) = O(N²) loop iterations across the full cascade.\r\nAn O(N) specialised path avoids the SFL overhead entirely for chain-shaped clusters.\r\n                                                                                 \r\n---                                                                              \r\n                                                                                 \r\n## Algorithm                                                                     \r\n                                                                                 \r\n### Detection (`TryLinearizeChain`)                                              \r\n                                                                                 \r\nA cluster with N transactions is a chain if and only if its ancestor-set sizes form exactly\r\n{1, 2, ..., N}. This is checked in O(N) using a boolean presence array;          \r\n`Ancestors(i).Count()` is O(1) for the fixed-size `BitSet<64>` used here.        \r\n                                                                                 \r\n### Topological order                                                            \r\n                                                                                 \r\nThe node with k ancestors occupies position k−1 in the unique topological order. Recovered\r\nin O(N) by a single mapping pass.                                                \r\n                                                                                 \r\n### Why PostLinearize is not needed                                              \r\n                                                                                 \r\nThe topological order of a chain cluster is unique, and every adjacent pair has a dependency,\r\nso `ChunkLinearizationInfo`'s unconditional merge and `PostLinearize`'s merge/swap behave\r\nidentically (the swap branch never triggers). The topological order itself is the optimal\r\nlinearization, and `PostLinearize` can be safely skipped.                        \r\n                                                                                 \r\nThe result is returned early from `Linearize()` before the SFL machinery is initialised:\r\n                                                                                 \r\n```cpp                                                                           \r\n// In Linearize():                                                               \r\nif (auto chain_lin = TryLinearizeChain(depgraph); !chain_lin.empty()) {          \r\n    return {std::move(chain_lin), /*optimal=*/true, /*cost=*/0, /*is_chain=*/true};\r\n}                                                                                \r\n```                                                                              \r\n                                                                                 \r\nThe fourth return value (`is_chain`) allows the caller (`Relinearize()`) to skip the\r\n`PostLinearize()` pass, which is redundant for chains: `TryLinearizeChain` already\r\nproduces an optimal, connected linearization.                                    \r\n                                                                                 \r\n---                                                                              \r\n                                                                                 \r\n## Benchmark results                                                             \r\n                                                                                 \r\n### `LinearizeOptimallyMonotoneChainTotal` — increasing feerates (SFL worst case)\r\n                                                                                 \r\n`MakeMonotoneChainGraph` builds a chain with fee_i = i+1, size_i = 1. For the SFL\r\nalgorithm, every prefix of the chain has feerate (k+1)/2 (strictly increasing with length),\r\nso `MakeTopological` must merge the entire chain into a single chunk through N−1 steps.\r\nEach step scans the growing top-part chunk (via `UpdateChunk`'s unconditional `chunk_rep`\r\nwrite loop and `MergeChunks`'s dep-search loop), accumulating O(N²) iterations in total.\r\n`TryLinearizeChain` eliminates this entirely.                                    \r\n                                                                                 \r\n| Size | Before (ns/op) | After (ns/op) | Speedup |                              \r\n|------|---------------|--------------|---------|                                \r\n| 9 tx | 973 | 48 | **20×** |                                                    \r\n| 16 tx | 1,772 | 72 | **25×** |                                                 \r\n| 32 tx | 3,880 | 129 | **30×** |                                                \r\n| 48 tx | 6,205 | 185 | **34×** |                                                \r\n| 63 tx | 8,551 | 238 | **36×** |                                                \r\n                                                                                 \r\nInstructions per call after optimisation:                                        \r\n                                                                                 \r\n| N | Total instructions | Instructions/tx |                                     \r\n|---|-------------------|----------------|                                       \r\n| 9 | 954 | 106 |                                                                \r\n| 16 | 1,360 | 85 |                                                              \r\n| 32 | 2,295 | 72 |                                                              \r\n| 48 | 3,230 | 67 |                                                              \r\n| 63 | 4,100 | 65 |                                                              \r\n                                                                                 \r\nThe \"after\" timings confirm that `TryLinearizeChain` runs in O(N) regardless of feerate\r\ndistribution (~65–106 instructions per transaction at N=9..63, constant converging as N\r\ngrows). The speedup grows with N because the baseline trends towards O(N²) while the\r\noptimised path remains O(N).                                                     \r\n",
      "state": "open",
      "user": "HowHsu",
      "created_at": "2026-02-21T05:11:29Z",
      "updated_at": "2026-02-25T15:04:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34643",
      "labels": [
        "Needs rebase",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 9338,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3048643652,
      "number": 33954,
      "title": "test: add functional test for outbound connection management",
      "body": "For #29415, vasild added the possibility to have outbound connections made \"naturally\" by the node using addrman entries, by redirecting them via a SOCKS5 proxy to python p2ps or other full nodes, so that the node under test behaves as if it is connected to normal non-local peers from arbitrary networks, while we have full control over the peers.\r\n\r\nI think this feature is really cool and want to suggest to integrate it more prominently into the test framework (\"`auto_outbound_mode`\") in the first commit because it allows to test the code in which the node decides to make connections - in contrast to the existing `add_outbound_p2p_connection` where the functional test intiates the connections.\r\n\r\nThe second commit uses it to add functional test coverage for the following features of outbound connection management:\r\n- extra full outbound connections due to a stale tip (#11560)\r\n- periodic block-relay-only connections (#19858)\r\n- full outbound connection management with respect to networks (#27213)\r\n\r\nThis should work well with the test from #29415 (which would keep its own `destinations_factory` but can call `_create_auto_outbound_listener` to avoid much of code duplication). \r\n\r\nOther possible uses for `auto_outbound_mode` I could think of are more detailed testing of anchors (`feature_anchors.py`), feeler connections, or any other p2p logic that uses the network of peers.",
      "state": "open",
      "user": "mzumsande",
      "created_at": "2025-11-26T19:01:42Z",
      "updated_at": "2026-02-25T13:44:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33954",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1456,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3013940276,
      "number": 33878,
      "title": "refactor, docs: Embedded ASMap [2/3]: Refactor asmap internals and add documentation",
      "body": "This is a second slice carved out of #28792. It contains the following changes that are crucial for the embedding of asmap data which is added the following PR in the series (probably this will remain in #28792).\r\n\r\nThe changes are:\r\n- Modernizes and simplifies the asmap code by operating on `std::byte` instead of bits\r\n- Unifies asmap version calculation and naming (previously it was called version and checksum interchangeably)\r\n- Operate on a `span` rather than a vector in the asmap internal to prevent holding the asmap data in memory twice\r\n- Add more extensive documentation to the asmap implementation\r\n- Unify asmap casing in implemetation function names\r\n\r\nThe first three commits were already part of #28792, the others are new.\r\n\r\nThe documentation commit came out of feedback gathered at the latest CoreDev. The primary input for the documentation was the documentation that already existed in the Python implementation (`contrib/asmap/asmap.py`) but there are several other comments as well. Please note: I have also asked several LLMs to provide suggestions on how to explain pieces of the implementation and better demonstrate how the parts work together. I have copied bits and pieces that I liked but everything has been edited further by me and obviously all mistakes here are my own. ",
      "state": "closed",
      "user": "fjahr",
      "created_at": "2025-11-15T20:50:29Z",
      "updated_at": "2026-02-25T13:42:46Z",
      "merged_at": "2026-02-02T17:22:39Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33878",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1392,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3298196135,
      "number": 34612,
      "title": "leveldb: remove unused files",
      "body": "Remove `db/c.cc`, `dumpfile.cc` & `histogram.cc`.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-02-18T10:55:33Z",
      "updated_at": "2026-02-25T13:17:31Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34612",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 78,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3303345951,
      "number": 34623,
      "title": "Update secp256k1 subtree to latest master",
      "body": "https://github.com/bitcoin-core/secp256k1/pull/1760 was merged upstream, which improves test parallelism, and reduces overall runtime. Our longest running tests are secp256k1 tests (`secp256k1_tests`), so we might want to pull this down, to speedup all of our ctest invocations.\r\n\r\nThe new upstream code increases output verbosity, i.e the test list is now ~330, and we have output like:\r\n```bash\r\nLabel Time Summary:\r\nsecp256k1_exhaustive        =  19.52 sec*proc (1 test)\r\nsecp256k1_noverify_tests    =  45.65 sec*proc (91 tests)\r\nsecp256k1_tests             =  90.55 sec*proc (91 tests)\r\n```\r\nmaybe we can/should mute that somewhat?",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-02-19T14:28:05Z",
      "updated_at": "2026-02-25T13:12:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34623",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 677,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3241050380,
      "number": 34491,
      "title": "ci: add FreeBSD Clang cross job",
      "body": "Alternative to #33562, which was adding a native FreeBSD job; however that had issues with permissions/caching, as well as potential determinism issues. This adds a FreeBSD cross job using Linux and Clang.\r\n\r\nThis is using FreeBSD 14,3, which avoids the issue in #34093.\r\n\r\nWould close #33438. The same changes here could also be used to produce FreeBSD binaries out of Guix.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-02-03T12:28:36Z",
      "updated_at": "2026-02-25T12:55:51Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34491",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 407,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3120160595,
      "number": 34132,
      "title": "coins: drop error catcher, centralize fatal read handling",
      "body": "### Problem\r\nThe current coins database read-error handling adds unnecessary complexity to the critical path:\r\n* `CCoinsViewErrorCatcher` sits between the cache and database views, wrapping every read operation\r\n* `ExecuteBackedWrapper` adds another function call layer with lambda captures on each database read\r\n* Uses `std::vector<std::function<void()>>` for callbacks when there's only ever one callback registered\r\n* The error callback is set after database initialization rather than during construction (requiring a `cs_main` lock)\r\n\r\nThis adds unnecessary stack depth and bookkeeping overhead on every coins database read operation (`GetCoin`). Also note that `CCoinsViewDB::HaveCoin` isn't even on the hot path as far as I can tell.\r\n\r\n### Context\r\nThis is part of ongoing coins caching cleanup efforts, see https://github.com/bitcoin/bitcoin/issues/34280.\r\n\r\n### Fix\r\n**Behavior change:** Treat deserialization failures in `CDBWrapper::Read()` as fatal instead of catching and returning `false`. This makes corruption visible and avoids ambiguous missing-vs-unreadable handling at call sites: on decode failure, `CDBWrapper` logs the error, executes a provided callback, and then calls `std::abort()`.\r\n\r\nWith read-failure handling centralized in `CDBWrapper`, collapse the `CCoinsViewErrorCatcher` layer entirely by removing `ExecuteBackedWrapper` and `CCoinsViewErrorCatcher` which also enables making coins view lookups `noexcept`.\r\n\r\nA new test verifies the node aborts with a clear error message on a few database corruption paths.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-12-20T22:56:45Z",
      "updated_at": "2026-02-25T12:39:56Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34132",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1604,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3268261877,
      "number": 34550,
      "title": "guix: update time-machine to 87405bbf3bd1a567046c7f69616b8d022b023976",
      "body": "Update the Guix time-machine to [87405bbf3bd1a567046c7f69616b8d022b023976](https://codeberg.org/guix/guix/commit/87405bbf3bd1a567046c7f69616b8d022b023976).\r\n\r\nPackage updates:\r\nbinutils 2.41 -> 2.44\r\ncmake-minimal 3.24.2 -> 3.31.10\r\ndiffutils 3.10 -> 3.12\r\nfile 5.45 -> 5.46\r\ngit-minimal 2.46.0 -> 2.52.0\r\n(base) glibc 2.39 -> 2.41\r\ngzip 1.13 -> 1.14\r\nlinux-headers 6.1.119 -> 6.1.164\r\nLLVM/Clang 19.1.4 -> 19.1.7\r\nmingw-w64 12.0.0 -> 13.0.0\r\nnsis 3.10 -> 3.11\r\npython-minimal 3.10 -> 3.11\r\n\r\nCMake 4.x becomes available.\r\nClang/LLVM 20 & 21 become available.\r\n\r\nSwitch to upstream `osslsigncode` (2.13, `python-lief` (0.17.4) and `python-oscrypto` (1.3.0) packages.\r\n\r\nUpdate glibc to the latest commit on the `2.31` branch.\r\n\r\nCould be used for #32764.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-02-10T17:21:45Z",
      "updated_at": "2026-02-25T12:25:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34550",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 824,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3299687172,
      "number": 34616,
      "title": "Cluster mempool: SFL cost model (take 2)",
      "body": "Part of #30289, replaces earlier #34138.\r\n\r\nThis introduces a more accurate cost model for SFL, to control how much CPU time is spent inside the algorithm for clusters that cannot be linearized perfectly within a reasonable amount of time.\r\n\r\nThe goal is having a metric for the amount of work performed, so that txmempool can impose limits on that work: a lower bound that is always performed (unless optimality is reached before that point, of course), and an upper bound to limit the latency and total CPU time spent on this. There are conflicting design goals here:\r\n* On the one hand, it seems ideal if this metric is closely correlated to actual CPU time, because otherwise the limits become inaccurate.\r\n* On the other hand, it seems a nightmare to have the metric be platform/system dependent, as it makes network-wide reasoning nearly impossible. It's expected that slower systems take longer to do the same thing; this holds for everything, and we don't need to compensate for this.\r\n\r\nThere are multiple solutions to this:\r\n* One extreme is just measuring the time. This is very accurate, but extremely platform dependent, and also non-deterministic due to random scheduling/cache effects.\r\n* The other extreme is using a very abstract metric like counting how many times certain loops/function inside the algorithm run. That is what is implemented in master right now, just counting the sum of the numbers of transactions updated across all `UpdateChunks()` calls. It however necessarily fails to account for significant portions of runtime spent elsewhere, resulting in a rather wide range of \"ns per cost\" values.\r\n* This PR takes a middle ground, counting many function calls / branches / loops, with weights that were determined through benchmarking on an average on a number of systems.\r\n\r\nSpecifically, the cost model was obtained by:\r\n* For a variety of machines:\r\n  * Running a fixed collection of ~385000 clusters found through random generation and fuzzing, optimizing for difficulty of linearization.\r\n    * Linearize each 1000-5000 times, with different random seeds. Sometimes without input linearization, sometimes with a bad one.\r\n      * Gather cycle counts for each of the operations included in this cost model, broken down by their parameters.\r\n  * Correct the data by subtracting the runtime of obtaining the cycle count.\r\n  * Drop the 5% top and bottom samples from each cycle count dataset, and compute the average of the remaining samples.\r\n  * For each operation, fit a least-squares linear function approximation through the samples.\r\n* Rescale all machine expressions to make their total time match, as we only care about relative cost of each operation.\r\n* Take the per-operation average of operation expressions across all machines, to construct expressions for an average machine.\r\n* Approximate the result with integer coefficients.\r\n\r\nThe benchmarks were performed by `l0rinc <pap.lorinc@gmail.com>` and myself, on AMD Ryzen 5950X, AMD Ryzen 7995WX, AMD Ryzen 9980X, Apple M4 Max, Intel Core i5-12500H, Intel Core Ultra 7 155H, Intel N150 (Umbrel), Intel Core i7-7700, Intel Core i9-9900K, Intel Haswell (VPS, virtualized), Intel Xeon E5-2637, ARM Cortex-A76 (Raspberry Pi 5), ARM Cortex-A72 (Raspberry Pi 4).\r\n\r\nBased on final benchmarking, the \"acceptable\" iteration count (which is the minimum spent on every cluster) is to 75000 units, which corresponds to roughly 50 μs on Ryzen 5950X and similar modern desktop hardware.",
      "state": "closed",
      "user": "sipa",
      "created_at": "2026-02-18T17:26:22Z",
      "updated_at": "2026-02-25T12:11:19Z",
      "merged_at": "2026-02-25T12:11:19Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34616",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3510,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3169361001,
      "number": 34271,
      "title": "net_processing: make m_tx_for_private_broadcast optional",
      "body": "Make `PeerManagerImpl::m_tx_for_private_broadcast` optional because it is needed for in private broadcast mode (`-privatebroadcast=1`).\r\n\r\nA followup to #29415, requested in:\r\nhttps://github.com/bitcoin/bitcoin/pull/29415#discussion_r2620864832\r\nhttps://github.com/bitcoin/bitcoin/pull/29415/files#r2620864832",
      "state": "open",
      "user": "vasild",
      "created_at": "2026-01-13T11:32:27Z",
      "updated_at": "2026-02-25T11:51:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34271",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 366,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3181854676,
      "number": 34320,
      "title": "coins: remove redundant and confusing `CCoinsViewDB::HaveCoin`",
      "body": "Split out of https://github.com/bitcoin/bitcoin/pull/34132#discussion_r2692307054.\r\n\r\n### Problem\r\nWe have two ways to check if a coin exists in the DB.\r\nOne tries to deserialize; the other just returns whether any value is associated with the key.\r\nBut we usually need the full value we probed for, and `HaveCoin` cannot cache the returned value, so it can trigger an extra lookup if `HaveCoin` uses `Exists` and the caller later needs the actual value.\r\nWe're already delegating most `HaveCoin` calls to `GetCoin` anyway for the above reasons, so the `CCoinsViewDB` implementation of `HaveCoin` is redundant.\r\n\r\n### Fix\r\nRemove `CCoinsViewDB::HaveCoin` (falls back to the base `CCoinsView::HaveCoin`, which delegates to `GetCoin`).\r\n\r\n### Testing\r\nA unit test was added to confirm that `HaveInputs` calls the backing view's `::GetCoin` (not `::HaveCoin`) on cache miss and checks the cache first.\r\nAlso added a benchmark to track throughput before/after changes to ensure no regression.\r\n\r\n----\r\n\r\nNote: The latest version of the change keeps most `HaveCoin` calls for convenience; a previous version removed all of them.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-16T16:17:29Z",
      "updated_at": "2026-02-25T11:41:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34320",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1186,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3312746354,
      "number": 34650,
      "title": "depends: Update Qt to version 6.8.3",
      "body": "This PR updates the `qt` package in depends to the latest open-source [6.8.3](https://www.qt.io/blog/qt-6.8.3-released) LTS release.\r\n\r\nThe update includes numerous bugfixes, which allows us to drop `qtbase_plugins_windows11style.patch`.\r\n\r\nAdditionally, it includes [patches](https://github.com/bitcoin/bitcoin/issues/34569#issuecomment-3892793262) for compatibility with GCC 16 (along with one extra patch), and incorporates a [commit](https://github.com/bitcoin/bitcoin/pull/32709/changes/8f1b55d1d52fb6e44a6d2d34b506f7f309c89ad1) from https://github.com/bitcoin/bitcoin/pull/32709.\r\n\r\nCloses https://github.com/bitcoin/bitcoin/issues/34569.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2026-02-22T12:14:00Z",
      "updated_at": "2026-02-25T10:56:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34650",
      "labels": [
        "Build system",
        "Needs backport (30.x)"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 680,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3315223131,
      "number": 34654,
      "title": "[RFC] `BlockMap` and `CChain` Concurrency Improvement",
      "body": "## RFC: `BlockMap` and `CChain` Concurrency Improvement\r\n\r\nFollow-up to https://github.com/bitcoin/bitcoin/pull/34424.\r\n\r\nThis RFC applies a `stable` and `recent` + copy-on-write design to `BlockMap`, adds an internal Mutex to `CChain` and demonstrates how `cs_main` locks can be removed, using `getchaintips` as an example.\r\n\r\n### Motivation\r\n\r\nThe current `BlockMap` and `CChain` are protected by `cs_main`, creating bottlenecks for multi-threaded access.\r\n\r\n### BlockMap Design\r\n\r\n**TL;DR:** Split the block index into `stable` (bulk of history) + `recent` (~1,000 blocks). Use nested `stlab::copy_on_write` so updates copy only `recent`, keeping `stable` shared. \r\n\r\n### Changes\r\n\r\n1. Stores block hash directly in CBlockIndex (required due to loss of address stability)\r\n2. Implements copy-on-write `BlockMap` with `stable` + `recent` architecture\r\n3. Adds internal mutex to `CChain`\r\n4. Removes the `cs_main` lock on the `getchaintips` rpc method\r\n\r\n*Note: the lock removals in this RFC are non-exhaustive*\r\n\r\n---\r\n### Request for Comments\r\n\r\nIf you have opinions on the following design decisions, please weigh in:\r\n- Storing block hashes directly in `CBlockIndex` is required due to loss of address stability from the copy-on-write design, is the memory cost an acceptable tradeoff?\r\n- Are there simpler alternatives to copy-on-write here? A plain mutex might be sufficient, but full BlockMap iteration would hold the lock for extended periods.",
      "state": "open",
      "user": "alexanderwiederin",
      "created_at": "2026-02-23T09:58:44Z",
      "updated_at": "2026-02-25T10:54:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34654",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1506,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3264847922,
      "number": 34544,
      "title": "wallet: Disallow wallet names that are paths including `..` and `.` elements",
      "body": "Wallet names including `..` and `.` are unintuitive and can lead to various issues, see #34497\r\n\r\nThis disallows creating or loading wallets that have any path elements that are `..` or `.`, including any present in an absolute path. This does not disallow relative paths altogether but rather limits them to only being subdirectories of the wallets directory.",
      "state": "open",
      "user": "achow101",
      "created_at": "2026-02-09T23:28:03Z",
      "updated_at": "2026-02-25T10:54:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34544",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 437,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3210348402,
      "number": 34410,
      "title": "test: let connections happen in any order in p2p_private_broadcast.py",
      "body": "If the following two events happen:\r\n\r\n* (likely) the automatic 10 initial connections are not made to all \r\n  networks\r\n* (unlikely) the network-specific logic kicks in almost immediately.\r\n  It is using exponential distribution with a mean of 5 minutes\r\n  (`rng.rand_exp_duration(EXTRA_NETWORK_PEER_INTERVAL)`).\r\n\r\nSo if both happen, then the 11th connection may not be the expected\r\nprivate broadcast, but a network-specific connection.\r\n\r\nFix this by retrieving the connection type from\r\n`destinations_factory()`. This is more flexible because it allows\r\nconnections to happen in any order and does not break if e.g. the 11th\r\nconnection is not the expected first private broadcast.\r\n\r\nThis also makes the test run faster:\r\nbefore: 19-44 sec \r\nnow: 10-25 sec \r\nbecause for example there is no need to wait for the initial 10\r\nautomatic outbound connections to be made in order to proceed.\r\n\r\nFixes: https://github.com/bitcoin/bitcoin/issues/34387\r\n",
      "state": "open",
      "user": "vasild",
      "created_at": "2026-01-26T12:05:26Z",
      "updated_at": "2026-02-25T10:49:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34410",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1022,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3295924536,
      "number": 34608,
      "title": "test: Fix broken --valgrind handling after bitcoin wrapper",
      "body": "Currently, tool_bitcoin.py is failing under `--valgrind`:\r\n\r\n```sh\r\n$ ./bld-cmake/test/functional/tool_bitcoin.py --valgrind\r\nTestFramework (ERROR): Unexpected exception\r\nTraceback (most recent call last):\r\n  File \"./test/functional/test_framework/test_framework.py\", line 138, in main\r\n    self.setup()\r\n    ~~~~~~~~~~^^\r\n  File \"./test/functional/test_framework/test_framework.py\", line 269, in setup\r\n    self.setup_network()\r\n    ~~~~~~~~~~~~~~~~~~^^\r\n  File \"./test/functional/tool_bitcoin.py\", line 38, in setup_network\r\n    assert all(node.args[:len(node_argv)] == node_argv for node in self.nodes)\r\n           ~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nAssertionError\r\n```\r\n\r\nFix this issue by running `bitcoin` under valgrind.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-02-17T20:38:21Z",
      "updated_at": "2026-02-25T10:30:28Z",
      "merged_at": "2026-02-25T10:03:15Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34608",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 820,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3221659481,
      "number": 34439,
      "title": "qa: Drop recursive deletes from test code, add lint checks.",
      "body": "Both `fs::remove_all` and `shutil::rmtree()` are a bit dangerous, and most of their uses are not necessary, this PR removes most instances of both.\r\n\r\n`remove_all()` is still used in in `src/test/util/setup_common.cpp` as part of `BasicTestingSetup::BasicTestingSetup`'s constructor and destructor, and it is used in the kernel test code's [`TestDirectory`](https://github.com/bitcoin/bitcoin/blob/4ae00e9a7183cb15877c3014bf46f2e36470c304/src/test/kernel/test_kernel.cpp#L100-L112):\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/734899a4c404f24379d0597744465c147d9ad024/src/test/kernel/test_kernel.cpp#L100-L112\r\n\r\nIn both cases, `remove_all` is likely necessary, but the kernel's test code is RAII, ideally `BasicTestingSetup` could be made similar in a follow-up or in this PR if reviewers think it is important.\r\n\r\nSimilarly in the python code, most usage was unnecessary, but there are a few places where `rmtree()` was necessary, I have added sanity checks to make sure these are inside of the `tmpdir` before doing recursive delete there.",
      "state": "open",
      "user": "davidgumberg",
      "created_at": "2026-01-29T03:59:52Z",
      "updated_at": "2026-02-25T10:18:23Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34439",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1101,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3226824452,
      "number": 34457,
      "title": "wallet: add private broadcast support for wallet transactions",
      "body": "## Summary\r\n\r\nExtends the private broadcast feature (#29415) to wallet transactions. When `-privatebroadcast=1` is enabled, wallet RPCs (`sendtoaddress`, `send`, `sendall`, `sendmany`) now broadcast transactions through short-lived Tor/I2P connections instead of announcing to all connected peers.\r\n\r\nEDIT: The per-transaction private_broadcast flag in mapValue of the original proposal has been removed (rationale: https://github.com/bitcoin/bitcoin/pull/34533#pullrequestreview-3829186494). \r\n\r\n<details>\r\n  <summary>Previous approach</summary>\r\n  \r\n## Key Changes\r\n\r\n**Centralized availability check** (commit 1)\r\n- Moves the Tor/I2P reachability check from `sendrawtransaction` RPC to `BroadcastTransaction()`\r\n- All broadcast callers now get consistent error handling\r\n\r\n**Wallet integration** (commit 2)\r\n- `CommitTransaction()`: Uses private broadcast when enabled, fails loudly if Tor/I2P unavailable\r\n- `ResubmitWalletTransactions()`: Rebroadcasts using the original broadcast method\r\n- Persists a `private_broadcast` flag in the wallet transaction's `mapValue`\r\n\r\n**Functional tests** (commits 3-4)\r\n- Tests wallet send via SOCKS5 proxy\r\n- Tests flag persistence across restarts\r\n- Tests error handling when Tor/I2P unavailable\r\n\r\n## Behavior Matrix\r\n\r\n| Scenario | TX Flag | Node Setting | Expected Behavior | Tested |\r\n|----------|---------------|--------------|-------------------|--------|\r\n| New tx | Private | - | Via SOCKS5, flag set | Test 1 ✓ |\r\n| Resubmit | Private | Public | Skip | Test 2 ✓ |\r\n| Resubmit | Public | Private | Skip | Test 3 ✓ |\r\n| Resubmit | Private | Private | Rebroadcast | Test 3 ✓ |\r\n| New tx | Private | - (no Tor) | RPC error | Test 4 ✓ |\r\n| Resubmit | Private | Private (no Tor) | Log error | Test 4 ✓ |\r\n\r\n**Why skip on mode mismatch?** Rebroadcasting via a different method than originally used may allow correlation of transaction to origin, or may indicate origin has `-privatebroadcast` enabled.\r\n\r\n</details>",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2026-01-30T08:06:34Z",
      "updated_at": "2026-02-25T10:04:11Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34457",
      "labels": [
        "Wallet",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2021,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3304010125,
      "number": 34627,
      "title": "guix: use a temporary file over sponge, drop moreutils",
      "body": "Remove sponge (moreutils).",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-02-19T17:05:52Z",
      "updated_at": "2026-02-25T09:30:28Z",
      "merged_at": "2026-02-24T20:06:53Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34627",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 81,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3227175463,
      "number": 34458,
      "title": "net: Don't log own ips during discover",
      "body": "The -logips option seems to imply that ip addresses are only logged when it is set. This seems like an obvious case for not logging these by default. There might be prior discussion around this, but I was unable to find why these might be exempt. There are also a few issues (both open and closed) where printing these lines was useful.",
      "state": "open",
      "user": "sedited",
      "created_at": "2026-01-30T09:59:41Z",
      "updated_at": "2026-02-25T09:07:52Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34458",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 375,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3299949354,
      "number": 34617,
      "title": "fees: wallet: remove block policy fee estimator internals from wallet",
      "body": "\r\nPart of #34075\r\n\r\n#### Motivation\r\nThe wallet currently knows the block policy estimator's internals from the response returned by `estimateSmartFee`.\r\n`estimateSmartFee` logging, which is supposed to be inside the method, is done in the wallet.\r\nAlso, the source of a wallet transaction fee is saved in the `CBlockPolicyEstimator::FeeReason` enum. This shows that there is tight coupling between the wallet and `CBlockPolicyEstimator`, which results in code that is a bit messy to extend and even read.\r\nIn #34075 the wallet is going to use a response returned via a fee rate estimator manager which does not return all those internals, hence motivating this refactor.\r\nThis PR refactors the interface between the wallet and the fee estimator to improve encapsulation and separate two distinct concerns: the source of a fee rate (where it came from) and the estimator's reason (why the algorithm chose it).\r\n\r\n#### Key Changes\r\n* Separate `FeeSource` from `FeeReason`:\r\n   Introduced a new `FeeSource` enum in `src/util/fees.h` to represent the high-level origin of a fee rate (e.g., `PAYTXFEE`, `FALLBACK`, `FEE_RATE_ESTIMATOR`). The existing `FeeReason` is now strictly scoped to internal `CBlockPolicyEstimator` details.\r\n* Encapsulate `estimateSmartFee` Logging:\r\n   Moved the fee calculation logging logic into `CBlockPolicyEstimator`. This removes the need for the wallet to manage a `FeeCalculation` object just to facilitate logging, especially when the caller passes `nullptr`.\r\n* Refactor `GetMinimumFeeRate`:\r\n   Updated `wallet::GetMinimumFeeRate` to return a `MinimumFeeRateResult` struct. This avoids the use of output parameters and provides a cleaner interface for retrieving the fee rate, source, and target.\r\n* Move `StringForFeeReason`:\r\n   Moved `StringForFeeReason` to `src/policy/fees/block_policy_estimator.cpp` to align with the location of the `FeeReason` enum. The function was also refactored to use a switch statement without a default case to ensure compile-time coverage of all reasons.\r\n* RPC Breaking Change:\r\n   Renamed the `fee_reason` field to `fee_source` in wallet RPCs (such as `send`, `walletcreatefundedpsbt`). This correctly identifies the origin of the fee rate rather than the estimator's internal logic.\r\n* Additional Logging:\r\n   Added logging for transaction fee, size, and source in `CreateTransactionInternal` to improve debugging of fee selection.",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2026-02-18T18:45:18Z",
      "updated_at": "2026-02-25T09:04:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34617",
      "labels": [
        "TX fees and policy"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 2469,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3037988791,
      "number": 33929,
      "title": "test: Remove `system_tests/run_command` runtime dependencies",
      "body": "`system_tests` currently rely on `cat`, `echo`, `false` and `sh` being available in `PATH` at runtime.\r\n\r\nThis PR:\r\n1. Removes these dependencies.\r\n2. Reduces the number of platform-specific code paths.\r\n\r\nThe change is primarily motivated by my work on maintaining the [`bitcoin-core`](https://packages.guix.gnu.org/packages/bitcoin-core) package in Guix. It enables the removal of the existing `bash` and `coreutils` native inputs, which in turn makes it possible to drop the implicit dependency on `qtbase@5` (see https://codeberg.org/guix/guix/pulls/4386#issuecomment-8613333).",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-11-23T23:03:10Z",
      "updated_at": "2026-02-25T09:00:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33929",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 642,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3322314651,
      "number": 34665,
      "title": "net: guard RemoveLocal() log with fLogIPs",
      "body": "`RemoveLocal()` logs the local IP address unconditionally via `LogInfo()`. Other logging in net.cpp respects the fLogIPs flag to avoid leaking IP addresses when the user has not opted in with -logips.\r\n\r\nGate the log behind fLogIPs for consistency.\r\n\r\nRelates to [#34458](https://github.com/bitcoin/bitcoin/pull/34458). ",
      "state": "closed",
      "user": "chriszeng1010",
      "created_at": "2026-02-24T19:40:35Z",
      "updated_at": "2026-02-25T07:33:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34665",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 362,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3292085705,
      "number": 34603,
      "title": "wallet: Fix detection of symlinks on Windows",
      "body": "This PR implements symlink detection for Windows, since GCC [doesn't support symlinks on Windows](https://gcc.gnu.org/git/?p=gcc.git;a=blob;f=libstdc%2B%2B-v3/src/filesystem/ops-common.h;h=ba377905a2e90f7baf30c900b090f1f732397e08;hb=refs/heads/releases/gcc-13#l124). This is used by the wallet's `ListDatabases` in order to detect symlinks and avoid recursing them. It's also used in wallet path validation since that is also checking whether paths are symlinks, and we should properly detect symlinks on Windows.\r\n\r\nUnder the hood, the `IsSymlink` function uses `std::filesystem::is_symlink` for non-Windows systems. On Windows, it checks a file's attributes to determine if it is a [reparse point](https://learn.microsoft.com/en-us/windows/win32/fileio/reparse-points). Strictly speaking, this will also catch files that aren't symlinks, such as directories that are Onedrive mounts. I think it's fine to not be recursively searching such directories.\r\n\r\nThis is based on #34418 for the multiwallet test and CI changes that it enables. The last commit also removes the skipping of the symlink checks so that we are testing that the symlink handling behavior on Windows matches that on Linux and MacOS.",
      "state": "open",
      "user": "achow101",
      "created_at": "2026-02-17T00:34:28Z",
      "updated_at": "2026-02-25T07:32:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34603",
      "labels": [
        "Wallet",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1248,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3305951143,
      "number": 34628,
      "title": "p2p: Replace per-peer transaction rate-limiting with global rate limits",
      "body": "Per-peer `m_tx_inventory_to_send` queues have CPU and memory costs that scale with both queue size and peer count. Under high transaction volume, this has previously caused severe issues ([May 2023 disclosure][1]) and still can cause measurable delays ([Feb 2026 Runestone surge][2], with the msghand thread observed hitting 100% CPU and queue memory reaching ~95MB).\r\n\r\nThis PR replaces the per-peer rate limiting with a global queue using dual token buckets (limiting transaction by both count and serialized size). Transactions that arrive within the bucket capacity still relay nearly immediately, but excess transactions queue in a global backlog and drain as the token buckets refill.\r\n\r\nKey parameters:\r\n  - Count bucket: 14 tx/s, 420 capacity (30s buffer)\r\n  - Size bucket: 20 kB/s (~12 MB/600s), 50 MB capacity\r\n  - Outbound peers refill faster by a factor of 2.5\r\n  \r\nPer-peer queues are retained solely for privacy batching and are always fully emptied, removing the old `INVENTORY_BROADCAST_MAX` cap.\r\n\r\nThis reduces the memory and CPU burden during transaction spikes when the queuing logic is engaged from O(queue * peers) to O(queue), as the queued transactions no longer need to be retained per-peer or re-sorted per-peer.\r\n\r\nDesign discussion: https://gist.github.com/ajtowns/d61bea974a07190fa6c6c8eaef3638b9\r\n\r\n[1]: https://bitcoincore.org/en/2024/10/08/disclose-large-inv-to-send/\r\n[2]: https://bnoc.xyz/t/increased-b-msghand-thread-utilization-due-to-runestone-transactions-on-2026-02-17/81\r\n",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2026-02-20T03:09:59Z",
      "updated_at": "2026-02-25T06:56:33Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34628",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1584,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3257065528,
      "number": 34533,
      "title": "wallet: resubmit transactions with private broadcast if enabled",
      "body": "The wallet keeps track of transactions related to it and periodically rebroadcasts them every 12-36 hours if they are not mined.\r\n\r\nIf `-privatebroadcast=1` and a transaction is submitted locally with the `sendrawtransaction` RPC and it is related to the wallet, then the rebroadcasts would use the send-to-all method. Change that to use the private broadcast method.\r\n",
      "state": "open",
      "user": "vasild",
      "created_at": "2026-02-07T05:35:17Z",
      "updated_at": "2026-02-25T01:40:15Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34533",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 433,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3119599294,
      "number": 34124,
      "title": "refactor: make `CCoinsView` a pure virtual interface",
      "body": "### Problem\r\n`CCoinsView` serves as the interface for the coins database layer, but historically had a dual nature that caused confusion:\r\n\r\n* It provided default noop implementations (returning `std::nullopt`, `uint256()`, `false`, `nullptr`) instead of being pure virtual\r\n* Callers could instantiate a bare `CCoinsView` and get silent no-op behavior\r\n* Mixing the interface definition with a built-in dummy implementation blurred the abstraction boundary\r\n\r\n### Context\r\nThis is part of ongoing coins caching cleanup efforts, see https://github.com/bitcoin/bitcoin/issues/34280.\r\n\r\n### Fix\r\nThis PR separates interface and noop behavior, and makes `CCoinsView` pure virtual in incremental steps:\r\n* Add `CCoinsViewEmpty` as an explicit noop coins view for tests, benchmarks, and temporary backends\r\n* Replace direct bare-`CCoinsView` test/dummy instantiations with `CCoinsViewEmpty`\r\n* Make all `CCoinsView` methods pure virtual (`GetCoin`, `HaveCoin`, `GetBestBlock`, `GetHeadBlocks`, `BatchWrite`, `Cursor`, `EstimateSize`)\r\n* Remove legacy default implementations from `coins.cpp`\r\n* Update the coins view fuzzer to switch between a real db-backed view and `CCoinsViewEmpty`\r\n* In `MemPoolAccept::PreChecks`, switch backend to `CCoinsViewEmpty::Get()` explicitly instead of using a local `m_dummy` member",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-12-20T08:47:33Z",
      "updated_at": "2026-02-25T00:26:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34124",
      "labels": [
        "Refactoring",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1363,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3315399634,
      "number": 34655,
      "title": "fuzz: keep `coins_view` fuzzers within caller contracts",
      "body": "### Problem\r\nThis is an alternative approach to #34647, fixes #34645.\r\n\r\n### Fix\r\nFirst, add `CheckedSub` and use it for decrements of `m_dirty_count` and `cachedCoinsUsage`, so unsigned underflows turn into immediate failures instead of silently wrapping and only failing later.\r\n\r\n<details><summary>Assertion `j <= i' failed.</summary>\r\n\r\n```bash\r\nutil/overflow.h:44 T CheckedSub(const T, const U) [T = unsigned long, U = bool]: Assertion `j <= i' failed.\r\n==72817== ERROR: libFuzzer: deadly signal\r\n    #0 0x556e9225eab5 in __sanitizer_print_stack_trace (/mnt/my_storage/bitcoin/build_fuzz/bin/fuzz+0x191dab5) (BuildId: d77c4d5f9dfd38ea06fab463f49341735205e109)\r\n    #1 0x556e921acafc in fuzzer::PrintStackTrace() (/mnt/my_storage/bitcoin/build_fuzz/bin/fuzz+0x186bafc) (BuildId: d77c4d5f9dfd38ea06fab463f49341735205e109)\r\n    #2 0x556e92191bb7 in fuzzer::Fuzzer::CrashCallback() (/mnt/my_storage/bitcoin/build_fuzz/bin/fuzz+0x1850bb7) (BuildId: d77c4d5f9dfd38ea06fab463f49341735205e109)\r\n    #3 0x7164cfc458cf  (/lib/x86_64-linux-gnu/libc.so.6+0x458cf) (BuildId: ae7440bbdce614e0e79280c3b2e45b1df44e639c)\r\n    #4 0x7164cfca49bb in __pthread_kill_implementation nptl/pthread_kill.c:43:17\r\n    #5 0x7164cfca49bb in __pthread_kill_internal nptl/pthread_kill.c:89:10\r\n    #6 0x7164cfca49bb in pthread_kill nptl/pthread_kill.c:100:10\r\n    #7 0x7164cfc4579d in raise signal/../sysdeps/posix/raise.c:26:13\r\n    #8 0x7164cfc288cc in abort stdlib/abort.c:73:3\r\n    #9 0x556e92f9d591 in assertion_fail(std::source_location const&, std::basic_string_view<char, std::char_traits<char>>) /mnt/my_storage/bitcoin/src/util/check.cpp:41:5\r\n    #10 0x556e9250daf0 in bool&& inline_assertion_check<false, bool>(bool&&, std::source_location const&, std::basic_string_view<char, std::char_traits<char>>) /mnt/my_storage/bitcoin/src/util/check.h:90:13\r\n    #11 0x556e9250daf0 in unsigned long CheckedSub<unsigned long, bool>(unsigned long, bool) /mnt/my_storage/bitcoin/src/util/overflow.h:44:5\r\n    #12 0x556e9250daf0 in CoinsViewCacheCursor::NextAndMaybeErase(std::pair<COutPoint const, CCoinsCacheEntry>&) /mnt/my_storage/bitcoin/src/coins.h:282:25\r\n    #13 0x556e92507eb2 in (anonymous namespace)::MutationGuardCoinsViewCache::BatchWrite(CoinsViewCacheCursor&, uint256 const&) /mnt/my_storage/bitcoin/src/test/fuzz/coins_view.cpp:90:75\r\n    #14 0x556e92c17a2b in CCoinsViewCache::Flush(bool) /mnt/my_storage/bitcoin/src/coins.cpp:282:11\r\n    #15 0x556e924fb732 in TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_1::operator()() const /mnt/my_storage/bitcoin/src/test/fuzz/coins_view.cpp:135:34\r\n    #16 0x556e924fb732 in unsigned long CallOneOf<TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_0, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_1, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_2, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_3, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_4, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_5, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_6, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_7, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_8, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_9, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_10, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_11>(FuzzedDataProvider&, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_0, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_1, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_2, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_3, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_4, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_5, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_6, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_7, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_8, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_9, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_10, TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool)::$_11) /mnt/my_storage/bitcoin/src/test/fuzz/util.h:42:27\r\n    #17 0x556e924fb732 in TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool) /mnt/my_storage/bitcoin/src/test/fuzz/coins_view.cpp:114:9\r\n    #18 0x556e92503b0c in coins_view_overlay_fuzz_target(std::span<unsigned char const, 18446744073709551615ul>) /mnt/my_storage/bitcoin/src/test/fuzz/coins_view.cpp:404:5\r\n    #19 0x556e92bcb7a5 in std::function<void (std::span<unsigned char const, 18446744073709551615ul>)>::operator()(std::span<unsigned char const, 18446744073709551615ul>) const /usr/lib/gcc/x86_64-linux-gnu/15/../../../../include/c++/15/bits/std_function.h:593:9\r\n    #20 0x556e92bcb7a5 in test_one_input(std::span<unsigned char const, 18446744073709551615ul>) /mnt/my_storage/bitcoin/src/test/fuzz/fuzz.cpp:88:5\r\n    #21 0x556e92bcb7a5 in LLVMFuzzerTestOneInput /mnt/my_storage/bitcoin/src/test/fuzz/fuzz.cpp:216:5\r\n    #22 0x556e9219318f in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/mnt/my_storage/bitcoin/build_fuzz/bin/fuzz+0x185218f) (BuildId: d77c4d5f9dfd38ea06fab463f49341735205e109)\r\n    #23 0x556e92192799 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) (/mnt/my_storage/bitcoin/build_fuzz/bin/fuzz+0x1851799) (BuildId: d77c4d5f9dfd38ea06fab463f49341735205e109)\r\n    #24 0x556e92194139 in fuzzer::Fuzzer::MutateAndTestOne() (/mnt/my_storage/bitcoin/build_fuzz/bin/fuzz+0x1853139) (BuildId: d77c4d5f9dfd38ea06fab463f49341735205e109)\r\n    #25 0x556e92194c95 in fuzzer::Fuzzer::Loop(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/mnt/my_storage/bitcoin/build_fuzz/bin/fuzz+0x1853c95) (BuildId: d77c4d5f9dfd38ea06fab463f49341735205e109)\r\n    #26 0x556e92181255 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/mnt/my_storage/bitcoin/build_fuzz/bin/fuzz+0x1840255) (BuildId: d77c4d5f9dfd38ea06fab463f49341735205e109)\r\n    #27 0x556e921ad696 in main (/mnt/my_storage/bitcoin/build_fuzz/bin/fuzz+0x186c696) (BuildId: d77c4d5f9dfd38ea06fab463f49341735205e109)\r\n    #28 0x7164cfc2a577 in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16\r\n    #29 0x7164cfc2a63a in __libc_start_main csu/../csu/libc-start.c:360:3\r\n    #30 0x556e921757e4 in _start (/mnt/my_storage/bitcoin/build_fuzz/bin/fuzz+0x18347e4) (BuildId: d77c4d5f9dfd38ea06fab463f49341735205e109)\r\n\r\nNOTE: libFuzzer has rudimentary signal handlers.\r\n      Combine libFuzzer with AddressSanitizer or similar for better crash reports.\r\nSUMMARY: libFuzzer: deadly signal\r\nMS: 2 PersAutoDict-CopyPart- DE: \"\\005\\000\"-; base unit: ecb626aff8724f0fdde38a0a6965718f2096d474\r\nartifact_prefix='/tmp/fuzz_artifacts/'; Test unit written to /tmp/fuzz_artifacts/crash-1d19026c1a23f08bfe693fd684a56ce51187c6e5\r\n./build_fuzz/bin/fuzz /tmp/fuzz_corpus/coins_view_overlay -max_total_time=3600 -rss_limit_mb=2560 -artifact_prefix=/tmp/fuzz_artifacts/ >fuzz-16.log 2>&1\r\n```\r\n\r\n</details>\r\n\r\nThe coins view fuzz targets can call `AddCoin`/`AddCoins` and construct `BatchWrite` cursors in ways that violate `CCoinsViewCache` caller contracts. These invalid states can trigger `BatchWrite` `std::logic_error` and can desync dirty-entry accounting (caught by `Assume(m_dirty_count == 0)` currently).\r\n\r\nMake the fuzzer avoid generating invalid states instead of catching and resetting:\r\n* Derive `AddCoin`’s `possible_overwrite` from `PeekCoin`, so `possible_overwrite=false` is only used when the outpoint is absent - similarly to https://github.com/bitcoin/bitcoin/blob/67c0d1798e6147f48d4bafc2c9e5ff30f2a62340/src/test/fuzz/coinscache_sim.cpp#L312-L317 \r\n- Only use `AddCoins(check=false)` when we have confirmed the txid has no unspent outputs; otherwise fall back to `check=true` so `AddCoins` determines overwrites via the view.\r\n- When constructing a `CoinsViewCacheCursor`, avoid setting `FRESH` when the parent already has an unspent coin, and ensure `FRESH` implies `DIRTY`.\r\n\r\n### Fuzzing\r\nThe original error could be reproduced in ~10 minutes using `coins_view_overlay`. I ran the `coins_view`, `coins_view_db`, `coins_view_overlay`, and `coinscache_sim` fuzzers for this PR overnight and they didn't fail anymore.",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2026-02-23T10:45:56Z",
      "updated_at": "2026-02-24T22:45:00Z",
      "merged_at": "2026-02-24T22:45:00Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34655",
      "labels": [
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 8823,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3174053537,
      "number": 34286,
      "title": "test: verify node state after restart in assumeutxo",
      "body": "## Summary\n\nThis PR replaces the TODO comment in `wallet_assumeutxo.py` (line 242) with actual test assertions that verify node and wallet behavior after a restart during assumeutxo background sync.\n\n## Changes\n\nThe new tests verify:\n- Two chainstates exist (background validation not complete)\n- Background chainstate is still at `START_HEIGHT`\n- Snapshot chainstate has synced to at least `PAUSE_HEIGHT`\n- Wallets cannot be loaded after restart (expected behavior)\n- Wallet backup from before snapshot height cannot be restored\n\n## Motivation\n\nDuring implementation, I discovered that **wallets cannot be loaded after a node restart during assumeutxo background sync**. This is expected behavior because:\n- The wallet loading code checks if required blocks are available for rescanning\n- During assumeutxo background sync, blocks before the snapshot are not available\n- This applies to all wallets, including watch-only wallets created at the snapshot height\n\nThis is a valuable test addition because it documents this expected behavior and ensures it doesn't regress. Users should be aware that if they restart their node during assumeutxo background sync, they won't be able to load their wallets until the background sync completes.\n\n## Related\n\nrefs #28648\n\nAddresses the TODO comment that was originally added as part of the assumeutxo wallet test implementation.",
      "state": "closed",
      "user": "yashbhutwala",
      "created_at": "2026-01-14T15:55:59Z",
      "updated_at": "2026-02-24T22:32:38Z",
      "merged_at": "2026-02-24T22:32:38Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34286",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1422,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2598874149,
      "number": 32764,
      "title": "guix: Build for macOS using Clang only",
      "body": "This PR makes macOS builds Clang-only by switching the build compiler in depends to `clang` + `libc++`.\r\n\r\nSee: https://github.com/bitcoin/bitcoin/issues/30206.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-06-17T13:39:41Z",
      "updated_at": "2026-02-24T22:09:41Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32764",
      "labels": [
        "Build system",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 199,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2869116529,
      "number": 33489,
      "title": "build: Drop support for EOL macOS 13",
      "body": "Now that macOS 13 is EOL (https://en.wikipedia.org/wiki/MacOS_Ventura), it seems odd to still support it.\r\n\r\n(macOS Ventura 13.7.8 received its final security update on 20 Aug 2025: https://support.apple.com/en-us/100100)\r\n\r\nThis patch will only be released in version 31.x, another 6 months out from now.\r\n\r\nSo:\r\n\r\n* Update the depends build and release note template to drop EOL macOS 13.\r\n* As a result, update the earliest Xcode to version 16 in CI.\r\n* Also, bump the macOS CI runner to version 15, to avoid issues when version 14 will be at its EOL in about 1 year.\r\n\r\nThis also allows to drop a small workaround in the fuzz tests and unlocks libcpp hardening (https://github.com/bitcoin/bitcoin/pull/33462)",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-09-29T05:31:12Z",
      "updated_at": "2026-02-24T21:37:01Z",
      "merged_at": "2025-10-06T16:48:17Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33489",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 749,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3313870475,
      "number": 34653,
      "title": "test: improve txospender index tests code",
      "body": "Fixes #34637.\r\n\r\nWas reviewing #34637 and, while reading the new txospender index\r\ntest code for the first time, found it could use some cleanups. Finding\r\nstuff in there is harder than it should be due to the amount of dup code.\r\n\r\nThe first commit cleans up `rpc_gettxspendingprevout.py` by introducing\r\nhelper functions to avoid repeating the same dicts everywhere, using\r\nfor-loops instead of duplicating the same checks for each node, and\r\nrenaming variables to better reflect what they actually represent.\r\n\r\nThe second commit reorganizes `txospenderindex_initial_sync()`\r\nmoving index initialization after the test setup phase, since the index\r\ndoesn't participate in it anyway. It adds a post-sync check to catch\r\ncases where `Sync()` aborted prematurely.\r\n\r\n\r\nNote:\r\nThis is just a pre-work for deeper index changes I'm cooking.",
      "state": "closed",
      "user": "furszy",
      "created_at": "2026-02-22T23:55:06Z",
      "updated_at": "2026-02-24T20:12:49Z",
      "merged_at": "2026-02-24T19:12:43Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34653",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 879,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3059986313,
      "number": 33986,
      "title": "doc: improvements to doc/descriptors.md",
      "body": "This brings doc/descriptors.md up to date:\r\n* Stop trying to exhaustively list all RPCs that involve descriptors. They're used everywhere.\r\n* Stop trying to give the history of descriptor support, we have release notes for that.\r\n* Mention that wallets are now built around descriptors (especially with legacy wallets gone).\r\n* Mention `musig()` KEY expressions in the specification part.\r\n* Reference the relevant output descriptor BIPs in the text.",
      "state": "open",
      "user": "sipa",
      "created_at": "2025-12-01T16:25:09Z",
      "updated_at": "2026-02-24T19:10:58Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33986",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 490,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3280499535,
      "number": 34580,
      "title": "build: Add a compiler minimum version check",
      "body": "Adds a compiler minimum version check. If failed, it returns a fatal error.\r\nThis early stop at configure time will avoid contributors losing time trying to fix compilation errors because of not fitting the requirements.\r\n\r\nExample of the output for GCC:\r\nVersion requirement satisfied:\r\n```\r\nsliv3r@sliv3r-tuxedo:~/Documentos/Projectes/BitcoinCore/bitcoin$ cmake -B BUILD\r\n-- The CXX compiler identification is GNU 13.3.0\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n....\r\n```\r\nVersion requirement not satisfied:\r\n```\r\n$ cmake -B build -S .   -DCMAKE_C_COMPILER=/usr/bin/gcc-11   -DCMAKE_CXX_COMPILER=/usr/bin/g++-11\r\n-- The CXX compiler identification is GNU 11.5.0\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Check for working CXX compiler: /usr/bin/g++-11 - skipped\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\nCMake Error at CMakeLists.txt:91 (message):\r\n  GCC >= 12.1 required.\r\n\r\n\r\n-- Configuring incomplete, errors occurred!\r\n\r\n```\r\n\r\n\r\nExample of the output for Clang:\r\nVersion requirement satisfied:\r\n```\r\nsliv3r@sliv3r-tuxedo:~/Documentos/Projectes/BitcoinCore/bitcoin$ cmake -B build\r\n-- The CXX compiler identification is Clang 18.1.3\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n...\r\n```\r\n\r\nVersion requirement not satisfied:\r\n```\r\n$ cmake -B build -DCMAKE_C_COMPILER=clang-16       -DCMAKE_CXX_COMPILER=clang++-16\r\n-- The CXX compiler identification is Clang 16.0.6\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Check for working CXX compiler: /usr/bin/clang++-16 - skipped\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\nCMake Error at CMakeLists.txt:86 (message):\r\n  Clang >= 17.0 required.\r\n\r\n\r\n-- Configuring incomplete, errors occurred!\r\n```",
      "state": "open",
      "user": "polespinasa",
      "created_at": "2026-02-13T11:31:21Z",
      "updated_at": "2026-02-24T18:57:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34580",
      "labels": [
        "Build system",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1914,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2237045890,
      "number": 31507,
      "title": "build: Use clang-cl to build on Windows natively",
      "body": "Building on Windows using Clang instead of the MS compiler may be beneficial, considering the issues with the latter, as outlined in https://github.com/bitcoin/bitcoin/issues/31456:\r\n\r\n>    * non-optimized codegen: [build: remove need to test for endianness #29852 (comment)](https://github.com/bitcoin/bitcoin/pull/29852#issuecomment-2049803970)\r\n> \r\n>    * compile failure: [MSVC 17.12.0 internal compiler error  #31303](https://github.com/bitcoin/bitcoin/issues/31303)\r\n> \r\n>    * legal, but brittle stdlib: [util: Drop boost posix_time in ParseISO8601DateTime #31391 (comment)](https://github.com/bitcoin/bitcoin/pull/31391#issuecomment-2510762011)\r\n> \r\n>    * unspecified issue: [refactor: Check translatable format strings at compile-time #31061 (comment)](https://github.com/bitcoin/bitcoin/pull/31061#issuecomment-2531244463)\r\n\r\nAdditionally, MSVC does not [support](https://learn.microsoft.com/en-us/cpp/assembler/inline/inline-assembler) inline assembly on the ARM and x64 processors.\r\n\r\nSo this PR:\r\n1. Closes https://github.com/bitcoin/bitcoin/issues/31456 (and addresses https://github.com/bitcoin/bitcoin/issues/14118).\r\n2. Could be an alternative to https://github.com/bitcoin/bitcoin/pull/24773.\r\n\r\n---\r\n\r\nAdditionally, clang-cl:\r\n1. Produces binaries with [better](https://github.com/bitcoin-core/secp256k1/pull/1681) performance. For example:\r\n\r\n| MSVC, block/s | clang-cl, block/s | benchmark |\r\n|--------------:|------------------:|:----------|\r\n|          7.40 |             11.52 | `ConnectBlockAllEcdsa`\r\n|          7.32 |             11.81 | `ConnectBlockAllSchnorr`\r\n|          7.38 |             11.45 | `ConnectBlockMixedEcdsaSchnorr`\r\n|         91.86 |            143.12 | `DeserializeAndCheckBlockTest`\r\n|        121.46 |            189.04 | `DeserializeBlockTest`\r\n\r\n2. Builds faster on the CI:\r\n    - [MSVC](https://github.com/bitcoin/bitcoin/actions/runs/13792522864/job/38575846787) - 20m 35s\r\n    - [clang-cl](https://github.com/bitcoin/bitcoin/actions/runs/13792522864/job/38575849680) - 12m 43s\r\n",
      "state": "open",
      "user": "hebasto",
      "created_at": "2024-12-16T10:58:38Z",
      "updated_at": "2026-02-24T14:11:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31507",
      "labels": [
        "Windows",
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2081,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3320223543,
      "number": 34660,
      "title": "ci: use LLVM 22 in sanitizer tasks",
      "body": "Clang/LLVM 22 is out, and upstream apt issues seem to be resolved. Use it in the sanitizer related tasks in CI. Not changing tidy here (needs more changes).",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-02-24T11:23:40Z",
      "updated_at": "2026-02-24T13:13:03Z",
      "merged_at": "2026-02-24T13:12:26Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34660",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 191,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3283486399,
      "number": 34588,
      "title": "refactor: decompose Peer struct into focused sub-components",
      "body": "The `Peer` struct in `net_processing.cpp` has ~40 fields protected by 6 different mutexes, mixing address relay, headers sync, block announcements, ping/pong, transaction relay, and misbehavior state into one flat struct.\r\nThis makes it hard to see which fields belong together and which mutex protects what.\r\n\r\nThis PR groups related fields into four sub-structs, each owning its mutex where applicable:\r\n\r\n| Sub-struct               | Fields | Mutex                    |\r\n|--------------------------|--------|--------------------------|\r\n| `PeerAddrRelay`          | 12     | `m_addr_send_times_mutex` |\r\n| `PeerHeadersSyncState`   | 7      | `m_headers_sync_mutex`    |\r\n| `PeerBlockAnnouncement`  | 3      | `m_block_inv_mutex`       |\r\n| `PeerLatency`            | 3      | *(all atomic)*            |\r\n\r\nAccess changes from flat (`peer.m_addrs_to_send`) to qualified (`peer.m_addr_relay.m_addrs_to_send`). No locking semantics, runtime behavior, or public interfaces change.\r\n\r\nThe first commit defines the four structs and adds them as members of `Peer`. The remaining four commits each move one group of fields and update all call sites.",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2026-02-14T02:47:16Z",
      "updated_at": "2026-02-24T12:55:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34588",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1205,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1512762627,
      "number": 28463,
      "title": "p2p: Increase inbound capacity for block-relay only connections",
      "body": "This is joint work with amitiuttarwar.\r\n\r\nSee issue #28462 for a broader discussion on increasing the number of block-relay-only connections independent of this particular implementation proposal.\r\n\r\nWe suggest to increase the number of inbound slots allocated to block-relay-only peers by increasing the default maximum connections from 125 to 200, with 50% of inbound slots accessible for tx-relaying peers.\r\nThis is a prerequisite for being able to increase the default number of outgoing block-relay-only peers later, because the current inbound capacity of the network is not sufficient.\r\nIn order to account for incoming tx-relaying peers separately from incoming block-relay peers, changes to the inbound eviction logic are necessary.\r\n\r\nSee the next post in this thread for a more detailed explanation and motivation of the changes.",
      "state": "open",
      "user": "mzumsande",
      "created_at": "2023-09-12T20:36:39Z",
      "updated_at": "2026-02-24T12:38:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28463",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 904,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3054407979,
      "number": 33966,
      "title": "refactor: disentangle miner startup defaults from runtime options",
      "body": "The interaction between node startup options like `-blockreservedweight` and runtime options, especially those passed via IPC, is confusing.\r\n\r\nThey're combined in `BlockAssembler::Options`, which this PR gets rid of in favour of two distinct structs:\r\n\r\n1. `BlockCreateOptions`: used by interface clients. As before, IPC clients have access to a safe / sane subset, whereas RPC and test code can use all fields.\r\n2. `MiningArgs`: these are set once during node startup\r\n\r\nBoth structs have a member for the maximum block height, which is not a problem since they're different structs. The one on `MiningArgs` (`block_max_weight`) matches `-maxblockheight` and is left alone. The one on `BlockCreateOptions` (`block_max_weight`) is an optional, it's set by `ApplyMiningDefaults` only if empty. \r\n\r\nThis all happens in the last commit and requires some preparation to keep things easy to review.\r\n\r\nWe get rid of `BlockAssembler::Options` but this is used in many tests. Since large churn is inevitable, we might as well switch all tests, bench and fuzzers over to the Mining interface. The first (non-base) commit does that, dramatically reducing direct use of `BlockAssembler`. Two exceptions are documented in the commit message. Because `test_block_validity` wasn't available via the interface and the block_assemble benchmark needs it, it's moved from `BlockAssembler::Options` to `BlockCreateOptions` (still not exposed via IPC).\r\n\r\nWe need access to mining related defaults and structs from both the miner and node initialization code. To avoid having to pull in all of `BlockAssembler` for the latter, the second commit introduces `node/mining.h` and moves constants and structs there from `src/node/types.h` (`BlockCreateOptions`, `BlockWaitOptions`, `BlockCheckOptions`) and `src/node/miner.h` (`DEFAULT_PRINT_MODIFIED_FEE`).\r\n\r\nI considered also moving `DEFAULT_BLOCK_MAX_WEIGHT`, `DEFAULT_BLOCK_RESERVED_WEIGHT`, `MINIMUM_BLOCK_RESERVED_WEIGHT` and `DEFAULT_BLOCK_MIN_TX_FEE` there from `policy.h`, since they are distinct from relay policy and not needed by the kernel. But this seems more appropriate for a follow-up and requires additional discussion.\r\n\r\nThe meat and potatoes of this PR is split between the three last commits for easier review:\r\n\r\n1. Adds `node/mining_args.{h,cpp}` and move the options checking out of `init.cpp`, without adding storage\r\n2. Add `block_max_weight` to `BlockCreateOptions` as explained above\r\n3. Introduce the `MiningArgs` struct, add it to the `NodeContext`, expand `mining_args.cpp` to store it, pass it to `BlockAssembler`, etc.\r\n\r\nI kept variable renaming and other formatting changes to a minimum to ease review with `--color-moved=dimmed-zebra`.\r\n\r\nThis PR builds on the bug fix in:\r\n- [ ] #33965\r\n\r\nOnce that is merged, this PR should not change behaviour.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-28T15:42:31Z",
      "updated_at": "2026-02-24T12:38:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33966",
      "labels": [
        "Refactoring",
        "Needs rebase",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2878,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3076189471,
      "number": 34020,
      "title": "mining: add getTransactions(ByWitnessID) IPC methods",
      "body": "Based on:\r\n- https://github.com/bitcoin-core/libmultiprocess/pull/242\r\n\r\nFor Stratum v2 custom job declaration to be bandwidth efficient, the pool can request[^0] only the transactions that it doesn't know about.\r\n\r\nThe spec doesn't specify how this is achieved, but one method is to call the `getrawtransaction` RPC on each transaction id listed in [DeclareMiningJob](https://stratumprotocol.org/specification/06-Job-Declaration-Protocol?query=DeclareMiningJob#644-declareminingjob-client-server) (or a subset if the pool software maintains a cache). Using RPC is inefficient, made worse by the need to make multiple calls. It also doesn't support queuing by witness id (yet, see #34013).\r\n\r\nThis PR introduces two new IPC methods:\r\n\r\n- `getTransactionsById()`: takes a list of `Txid`'s\r\n- `getTransactionsByWitnessID()`: : takes a list of `Wtxid`'s\r\n\r\nBoth return a list of serialised transactions. An empty element is returned for transactions that were not found.\r\n\r\nThe `Txid` variant, just like its RPC counterpart, takes advantage of `-txindex` if enabled. The `Wtxid` variant can't do that unless we add a `-witnesstxindex`, but at least sv2 has no use for that.\r\n\r\nThe RPC additionally allows providing a `block_hash` hint. I haven't implemented that here because I don't have a need for it. It can always be added later.\r\n\r\nI thought about having a single (or overloaded) `getTransactions()` that works with both `Txid` and `Wtxid`, but I prefer that clients are intentional about which one they want.\r\n\r\nA unit and functional test cover the new functionality.\r\n\r\nSv2 probably only needs `getTransactionsByWitnessID()`, but it's easy enough to just add both.\r\n\r\n\r\n[^0]: there's two reasons the pool requests these transactions: to approve the template and to broadcast the block if a solution is found (the miner will also broadcast via their template provider). See also https://github.com/stratum-mining/sv2-spec/issues/170",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-12-05T19:13:47Z",
      "updated_at": "2026-02-24T12:38:11Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34020",
      "labels": [
        "Mining",
        "Needs rebase",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1988,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3284423117,
      "number": 34591,
      "title": "cmake: Improve `install_name_tool` workaround",
      "body": "We stopped using `install_name_tool` in 3bee51427a05075150721f0a05ead8f92e1ba019 (https://github.com/bitcoin/bitcoin/pull/29890), which [required](https://github.com/hebasto/bitcoin/pull/180) a CMake-specific hack:https://github.com/bitcoin/bitcoin/blob/b65ff0e5a1fd4ea2ae75e204729b8008c4ebb9ab/CMakeLists.txt#L72-L76\r\n\r\nDue to recent changes in CMake, this hack has become problematic for the following reasons:\r\n1. It is no longer needed when using CMake 4.2 or newer. See upstream [Issue #27069](https://gitlab.kitware.com/cmake/cmake/-/issues/27069) and [MR #10955](https://gitlab.kitware.com/cmake/cmake/-/merge_requests/10955).\r\n\r\n2. It causes an [issue](https://github.com/bitcoin/bitcoin/issues/34513) when using CMake 4.0.5 or newer. See upstream [Issue #26814](https://gitlab.kitware.com/cmake/cmake/-/issues/26814) and [MR #10721](https://gitlab.kitware.com/cmake/cmake/-/merge_requests/10721).\r\n\r\nThis PR addresses both of these issues. Please see the individual commits for more details.\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/34513.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2026-02-14T11:37:33Z",
      "updated_at": "2026-02-24T12:21:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34591",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1104,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3317240247,
      "number": 34657,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "ghost",
      "created_at": "2026-02-23T18:46:41Z",
      "updated_at": "2026-02-24T12:04:25Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34657",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2956421896,
      "number": 33727,
      "title": "zmq: Log bind error at Error level, abort startup on init error",
      "body": "Fixes #33715",
      "state": "open",
      "user": "isrod",
      "created_at": "2025-10-28T18:59:03Z",
      "updated_at": "2026-02-24T10:59:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33727",
      "labels": [
        "RPC/REST/ZMQ",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 76,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3313137140,
      "number": 34651,
      "title": "fuzz: Block connection and chain reorganization fuzzing harnesses",
      "body": "Hi Bitcoin Core maintainers.\r\n\r\nThis PR is a remastered version of fuzzing harnesses developed during a Bitcoin Core audit.\r\nIt includes three different fuzzing harnesses which motivation was the following:\r\n\r\n* `connect_block`: Test the ConnectBlock() function responsible of validating the block and\r\n  all its transaction with consensus rules. Thanks to ``justCheck`` parameter no side effect\r\n  is performed on the internal state enabling relatively fast fuzzing.\r\n* `activate_best_chain_step`: Test the ActivateBestChainStep() function responsible of activating\r\n  the most worked-chain (not selecting it). The harness is written in a way that enable the fuzzer\r\n  triggering a chain reorganization if it generates two valid branches.\r\n* `activate_best_chain`: Test the ActivateBestChain() function responsible of selecting and activating\r\n  the most worked-chain.\r\n\r\nIn the two later harnesses, some internal state cleaning is required to avoid non-reproducibility issues.\r\nAlso they might produce file artifacts on disk by means of writing blocks.\r\n\r\nBesides pre-mining blocks, the harness initialization intends to bring a bit more of diversity by\r\nintroducing additional transactions in blocks (otherwise only coinbases), and put some transactions\r\nin the mempool so that they can be 'picked' and put in a block by means of input mutation.\r\n\r\nThese harnesses enables improving function coverage on `ActivateBestChainStep`, `removeForBlock` and to\r\ncover function uncovered by fuzzing at the time of fuzzing harness development (mid-2025).\r\nFunctions newly covered include `DisconnectTip`, `DisconnectBlock`, `ApplyTxInUndo`, `MaybeUpdateMempoolForReorg`, `removeForReorg` etc. The [attached figure](https://github.com/user-attachments/assets/19e985db-0a05-4b2d-b62a-c0e1826c5ed5) shows in red function previously uncovered. *(This might have slightly changed since then)*.\r\n\r\nWe tried to make the implementation as lean as possible but we are eager of any improvement feedbacks.\r\n\r\nAuthored by @RobinDavid and @nsurbay",
      "state": "open",
      "user": "RobinDavid",
      "created_at": "2026-02-22T15:25:56Z",
      "updated_at": "2026-02-24T10:29:01Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34651",
      "labels": [
        "CI failed",
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2093,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3313629270,
      "number": 34652,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "RobertoFilho0100",
      "created_at": "2026-02-22T20:56:04Z",
      "updated_at": "2026-02-24T10:05:10Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34652",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1071188902,
      "number": 26201,
      "title": "Remove Taproot activation height",
      "body": "Drop `DEPLOYMENT_TAPROOT` from `consensus.vDeployments`.\r\n\r\nNow that the commit (https://github.com/bitcoin/bitcoin/commit/7c08d81e119570792648fe95bbacddbb1d5f9ae2) which changes taproot to be enforced for all blocks is included in v24.0, it seems a good time to remove no longer needed non-consensus code.\r\n\r\nClarify what is considered a `BuriedDeployment`.\r\n\r\nWe drop taproot from `getdeploymentinfo` RPC, rather than mark it as `buried`, because this is not a buried deployment in the sense of [BIP 90](https://github.com/bitcoin/bips/blob/master/bip-0090.mediawiki). This is because the activation height has been completely removed from the code, unlike the hardcoded `DEPLOYMENT_SEGWIT` height which is still relied on.[^1]\r\n\r\nSee discussion in #24737 and #26162.\r\n\r\n[^1]: `DEPLOYMENT_SEGWIT` is used in `IsBlockMutated` to determine if witness data is allowed, it's used for [BIP147](https://github.com/bitcoin/bips/blob/master/bip-0147.mediawiki), to trigger `NeedsRedownload()` for users who upgraded after a decade, and for a few other things.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2022-09-29T11:16:54Z",
      "updated_at": "2026-02-24T09:27:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/26201",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 0,
        "text_length": 1086,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3307808113,
      "number": 34635,
      "title": "rpc, index: txospenderindex follow-ups",
      "body": "This addresses my own comments in the last review of #24539: https://github.com/bitcoin/bitcoin/pull/24539#pullrequestreview-3829110465\r\n\r\nThe first commit fixes three small formatting errors.\r\n\r\nThe second commit refactors the body of the `gettxspendingprevout` RPC. The main theme is getting rid of the custom `Entry` struct and using a `prevouts` vector of `COutPoint`s in the first loop, pushing found spenders into the result directly and filling the prevouts that still should be processed by the index into a `index_prevouts` vector. This means there is now a clearer separation between what the two loops are doing. Early `return`/`continue` are used to get rid of some intermittend variables (`missing_from_mempool`, `txospenderindex_ready`) and if/else blocks. The result is in my opinion simpler and easier to reason about but it did not reduce the number of lines of code (which I had hoped for) so I would call this rather a style preference than a clear win.\r\n\r\nIf reviewers don't like the style of the second commit or think it is not worth the hassle to review this, I am happy to drop it!",
      "state": "open",
      "user": "fjahr",
      "created_at": "2026-02-20T12:58:10Z",
      "updated_at": "2026-02-24T08:48:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34635",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1144,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3319440956,
      "number": 34659,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "Kamran-Pro-Dev",
      "created_at": "2026-02-24T08:16:50Z",
      "updated_at": "2026-02-24T08:17:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34659",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1681972231,
      "number": 29256,
      "title": "log, refactor: Allow log macros to accept context arguments",
      "body": "Allow `LogDebug()`, `LogTrace()`, `LogInfo()`, `LogWarning()`, and `LogError()` macros to accept context arguments to provide more information in log messages and more control over logging to callers.\r\n\r\nThis functionality is used in followup PRs:\r\n\r\n- [#30342](https://github.com/bitcoin/bitcoin/pull/30342) - To let libbitcoinkernel send output to specfic `BCLog::Logger` instances instead of a global instance, so output can be disambiguated and applications can have more control over logging.\r\n\r\n- [#30343](https://github.com/bitcoin/bitcoin/pull/30343) - To replace custom `WalletLogPrintf` calls with standard logging calls that automatically include wallet names and don't log everything at info level.\r\n\r\nThis PR does not change behavior of current log prints or require them to be updated. It includes tests and documentation covering the new functionality.\r\n\r\n---\r\n\r\nNote: Originally this PR also removed some restrictions around passing category constants to log macros to try to make them more consistent, but these changes were too controversial and have been dropped.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-01-16T22:09:35Z",
      "updated_at": "2026-02-24T07:34:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29256",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1142,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1940584116,
      "number": 30343,
      "title": "wallet, logging: Replace WalletLogPrintf() with LogInfo()",
      "body": "Make new logging macros `LogDebug()`, `LogTrace()`, `LogInfo()`, `LogWarning()`, and `LogError()` compatible with wallet code and drop custom WalletLogPrintf() function. The new logging macros introduced in #28318 weren't previously useful in wallet code because wallet code prefixes most log messages with the wallet names to be be able to distinguish log output from multiple wallets. Fix this by introducing a new `WalletLogSource` class inheriting from `BCLog::Source` which can include the wallet name in log messages.\n\n---\n\n<!-- begin based-on -->\n**This is based on #29256.** The non-base commits are:\n\n- [`35ab88ce0e7` wallet, logging: Replace WalletLogPrintf() with LogInfo()](https://github.com/bitcoin/bitcoin/pull/30343/commits/35ab88ce0e7116c0a2bee2569ea1bc9eb5afffea)\n- [`f5039574576` wallet, logging: Switch LogInfo to LogWarning/LogError](https://github.com/bitcoin/bitcoin/pull/30343/commits/f5039574576f3128fe904147a53e3fcaab6c0d85)\n- [`aac55f94938` wallet, logging: Switch LogInfo to LogError in AddWalletDescriptor](https://github.com/bitcoin/bitcoin/pull/30343/commits/aac55f94938aa7ac727b840a9766adb848e998ab)<!-- end -->",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-06-26T17:57:15Z",
      "updated_at": "2026-02-24T07:19:59Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30343",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1201,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2250366940,
      "number": 31560,
      "title": "rpc: allow writing UTXO set to a named pipe, introduce dump_to_sqlite.sh script",
      "body": "This PR slightly modifies the `dumptxoutset` RPC to allow writing the UTXO set dump into a [named pipe](https://askubuntu.com/a/449192), so that the output data can be consumed by another process, see #31373. Taking use of this with the utxo-to-sqlite.py tool (introduced in #27432), creating an UTXO set in SQLite3 format is possible on the fly and becomes a one-liner with a newly introduced script `dump_to_sqlite.sh`. E.g. for signet:\r\n```\r\n$ ./contrib/utxo-tools/dump_to_sqlite.sh \"./build/src/bitcoin-cli -signet\" ~/utxos.sqlite3\r\nUTXO Snapshot for Signet at block hash 000000ddc3b251483cf1ebb23e2750ba..., contains 5705634 coins\r\n1048576 coins converted [18.38%], 4.474s passed since start\r\n2097152 coins converted [36.76%], 8.793s passed since start\r\n3145728 coins converted [55.13%], 13.146s passed since start\r\n4194304 coins converted [73.51%], 17.478s passed since start\r\n5242880 coins converted [91.89%], 21.832s passed since start\r\n{\r\n  \"coins_written\": 5705634,\r\n  \"base_hash\": \"000000ddc3b251483cf1ebb23e2750ba2490701d0c547241b247a9beb85498d0\",\r\n  \"base_height\": 227678,\r\n  \"path\": \"/tmp/tmp.MFHEVqetv0/utxos.fifo\",\r\n  \"txoutset_hash\": \"f29e524c999487cbd0cfca5201dce67c2c5e5c5eb115c63ad48c2239f23eea4c\",\r\n  \"nchaintx\": 8272649\r\n}\r\nTOTAL: 5705634 coins written to /home/thestack/utxos.sqlite3, snapshot height is 227678.\r\n```\r\nNote that the `dumptxoutset` RPC calculates an UTXO set hash as a first step before any data is emitted, so especially on mainnet it takes quite a while until the conversion starts and something is happening visibly.\r\n\r\nThe new script is quite minimal and PoC-y at this point, there are some potential improvement ideas:\r\n- better error handling (e.g. detect if bitcoin-cli exists, clean up tmpdir if bitcoin-cli execution fails etc.)\r\n- allow to pass through the rollback option (now we always dump at the current height, i.e. \"latest\" parameter)",
      "state": "open",
      "user": "theStack",
      "created_at": "2024-12-24T02:42:27Z",
      "updated_at": "2026-02-24T06:40:42Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31560",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1968,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2309959380,
      "number": 31774,
      "title": "crypto: Use secure_allocator for `AES256_ctx`",
      "body": "Fixes #31744 \r\n\r\nReuse `secure_allocator` for `AES256_ctx` in the aes 256 encrypters and decrypters and the `iv` of `AES256CBC` encrypters and decrypters. These classes are relevant to `CCrypter`, used for encrypting wallets, and my understanding is that if an attacker knows some or all of the contents of these data structures (`AES256_ctx` & `iv`) they might be able to decrypt a user's wallet.\r\n\r\n Presently the `secure_allocator` tries to protect sensitive data with `mlock()` on POSIX systems and `VirtualLock()` on Windows to prevent memory being paged to disk, and by zero'ing out memory contents on deallocation with `memory_cleanse()` which is similar to `OPENSSL_cleanse()` by scaring compilers away from optimizing `memset` calls on non-Windows systems, and using `SecureZeroMemory()` on Windows.",
      "state": "open",
      "user": "davidgumberg",
      "created_at": "2025-01-31T20:10:56Z",
      "updated_at": "2026-02-24T06:26:33Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31774",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 854,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3311151062,
      "number": 34646,
      "title": "Fix two issues in p2p_private_broadcast.py",
      "body": "_test: move abortprivatebroadcast test at the end_\r\n\r\nThe piece of `p2p_private_broadcast.py` which tests the correctness of\r\n`abortprivatebroadcast` issues a new `sendrawtransaction` call. That\r\ncall schedules up to 3 new connections: peer=13, peer=14 and possibly\r\npeer=15 before it gets aborted.\r\n\r\nThese up to 3 in-the-process-of-opening private broadcast connections\r\nhave `CNode::m_connected` set early - when the `CNode` object is\r\ncreated. Later in the test the mock time is advanced by 20 minutes and\r\nthose \"old\" connections pick a transaction for rebroadcast but that\r\ntriggers `PRIVATE_BROADCAST_MAX_CONNECTION_LIFETIME` immediately:\r\n\r\n```\r\n2026-02-21T13:28:14.209766Z [privbcast] [net.cpp:4006] [CNode] [net] Added connection peer=20\r\n2026-02-21T13:28:14.309792Z (mocktime: 2026-02-21T13:48:14Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending inv (37 bytes) peer=20\r\n2026-02-21T13:28:14.309801Z (mocktime: 2026-02-21T13:48:14Z) [msghand] [net_processing.cpp:5745] [SendMessages] [privatebroadcast] Disconnecting: did not complete the transaction send within 180 seconds, peer=20\r\n```\r\n\r\nThis prematurely stops the private broadcast connection and results in\r\na failure like:\r\n\r\n```\r\nAssertionError: ... not({} == {'ping': 1, 'tx': 1})\r\n```\r\n\r\n---\r\n\r\n_test: don't always assert NUM_PRIVATE_BROADCAST_PER_TX broadcasts_\r\n\r\nIn `p2p_private_broadcast.py` in the function `check_broadcasts()` we\r\nshould assert that the broadcast was done to `broadcasts_to_expect`\r\npeers, not to `NUM_PRIVATE_BROADCAST_PER_TX`. This is because in the\r\n\"Basic\" test we check the first broadcast manually because it is done to\r\n`nodes[1]` and then check the other two by\r\n`check_broadcasts(..., NUM_PRIVATE_BROADCAST_PER_TX - 1, ...)`.\r\nThe first broadcast might not have fully concluded by the time we call\r\n`check_broadcasts()` to check the remaining 2.\r\n\r\nDemanding always `NUM_PRIVATE_BROADCAST_PER_TX` can lead to:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/vd/gh/bitcoin/bitcoin/test/functional/test_framework/test_framework.py\", line 142, in main\r\n    self.run_test()\r\n    ~~~~~~~~~~~~~^^\r\n  File \"/tmp/build/clang22/test/functional/p2p_private_broadcast.py\", line 347, in run_test\r\n    self.check_broadcasts(\"Basic\", txs[0], NUM_PRIVATE_BROADCAST_PER_TX - 1, NUM_INITIAL_CONNECTIONS + 1)\r\n    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/tmp/build/clang22/test/functional/p2p_private_broadcast.py\", line 313, in check_broadcasts\r\n    assert_greater_than_or_equal(sum(1 for p in peers if \"received\" in p), NUM_PRIVATE_BROADCAST_PER_TX)\r\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/vd/gh/bitcoin/bitcoin/test/functional/test_framework/util.py\", line 94, in assert_greater_than_or_equal\r\n    raise AssertionError(\"%s < %s\" % (str(thing1), str(thing2)))\r\nAssertionError: 2 < 3\r\n```\r\n",
      "state": "closed",
      "user": "vasild",
      "created_at": "2026-02-21T18:06:43Z",
      "updated_at": "2026-02-24T05:50:54Z",
      "merged_at": "2026-02-23T21:45:49Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34646",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 2985,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2501800868,
      "number": 32427,
      "title": "(RFC) kernel: Replace leveldb-based BlockTreeDB with flat-file based store",
      "body": "Opening this PR mostly to get concept/approach feedback.\r\n\r\nThis is motivated by the kernel library, where the internal usage of leveldb is a limiting factor to its future use cases. Specifically it is not possible to share leveldb databases between two processes. A notable use-case for the kernel library is accessing and analyzing existing block data. Currently this can only be done by first shutting down the node writing this data. Moving away from leveldb opens the door towards doing this in parallel. A flat file based approach was chosen, since the requirements for persistence here are fairly simple (no deletion, constant-size entries). The change also offers better performance by making node startup faster, and has a smaller on-disk footprint, though this is negligible in the grand scheme of things.\r\n\r\nThe BlockTreeStore introduces a new data format for storing block indexes and headers on disk. The class is very similar to the existing CBlockTreeDB, which stores the same data in a leveldb database. Unlike CBlockTreeDB, the data stored through the BlockTreeStore is directly serialized and written to flat .dat files. The storage schema introduced\r\nis simple. It relies on the assumption that no entry is ever deleted and that no duplicate entries are written. These assumptions hold for the current users of CBlockTreeDB.\r\n\r\nA write ahead ahead log and boolean flags as file existence checks ensure write atomicity. Every data entry is also given a crc32c checksum to detect data corruption.\r\n\r\nThe change also opens the door towards getting rid of having to reindex the block tree due to corruption (though switching from pruned -> un-pruned still requires extra logic). This would simplify a lot of kernel/validation code, as can be seen in this [commit](https://github.com/TheCharlatan/bitcoin/commit/bfb2709e1d116d4e613601c3f0140f099530159d#diff-28f178018e05634ee3f8ddce3f4e0cec334ae69915cecf92be8299c749d8d470). The implementation here should be fairly robust against corruption (no parallel read/writes, no background compaction).\r\n\r\nAn alternative to this pull request, that could allow the same kernel feature, would be closing and opening the leveldb database only when reading and writing. This might incur a (negligible) performance penalty, but more importantly requires careful consideration of how to handle any contentions when opening, which might have complex side effects due to our current locking mode. It would also be possible to introduce an existing database with the required features for just the block tree, but that would introduce reliance on a new dependency and come with its own tradeoffs. For these reasons I chose this approach.",
      "state": "open",
      "user": "sedited",
      "created_at": "2025-05-06T14:27:59Z",
      "updated_at": "2026-02-24T05:37:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32427",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2759,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2527184806,
      "number": 32554,
      "title": "bench: replace embedded raw block with configurable block generator",
      "body": "### Problem\r\n\r\nThe [hardcoded benchmark block 413567](https://mempool.space/block/413567) has several issues:\r\n- embeds 1.1MB of binary data in the repository (we can't remove it from history, but we can, from `HEAD`)\r\n- mined in 2016, predates SegWit v0, Taproot, and modern script types\r\n- benchmarks cannot test different transaction patterns or script mixes\r\n- updating to a newer block (e.g., [#32457](https://github.com/bitcoin/bitcoin/pull/32457)) would still add binary bloat and would remain inflexible\r\n\r\n### Fix\r\n\r\nAdded configurable `bench/block_generator.{h,cpp}` that builds fully valid blocks at runtime providing blocks or raw serialized stream.\r\n\r\n### Reproducer\r\n\r\nYou can run all affected tests and benchmarks with a sanity check:\r\n```bash\r\nrm -rf build && \\\r\ncmake -B build -DCMAKE_BUILD_TYPE=Release -DBUILD_BENCH=ON && \\\r\ncmake --build build -j$(nproc) && \\\r\nbuild/bin/test_bitcoin -t block_generator_deterministic_seeded_output,block_generator_serialization_roundtrip,block_generator_seed_perturbation,block_generator_multiple_seed_sanity && \\\r\nbuild/bin/bench_bitcoin -sanity-check -filter='DeserializeBlockTest|DeserializeAndCheckBlockTest|LoadExternalBlockFile|WriteBlockBench|ReadBlockBench|ReadRawBlockBench|BlockToJsonVerbosity1|BlockToJsonVerbosity2|BlockToJsonVerbosity3|BlockToJsonVerboseWrite|HexStrBench'\r\n```\r\n---\r\n\r\nThis supersedes #32457 by eliminating the need for any hardcoded block data while enabling flexible benchmark scenarios.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-05-18T21:39:14Z",
      "updated_at": "2026-02-24T05:30:25Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32554",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1540,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2597079174,
      "number": 32763,
      "title": "wallet: Replace CWalletTx::mapValue and vOrderForm with explicit class members",
      "body": "`mapValue` and `vOrderForm` are opaque data structures that contain transaction metadata. It is hard to determine what actual data each field contains, and they can ostensibly be misused where metadata is added in the future without developers realizing that such metadata exists.\r\n\r\nIt's much clearer to have all of that metadata live in their own explicit member variables within `CWalletTx`. This PR implements that change.\r\n\r\nSince the serialization format of `CWalletTx` depends on `mapValue` and `vOrderForm`, the serialization remains unchanged, so when serializing these new members, they need to be shoved/extracted from a temporary `mapValue` or `vOrderForm`.\r\n\r\nThis does end up breaking forwards compatibility as unknown fields in `mapValue` and `vOrderForm` are stripped out if the record is rewritten. However, I don't expect that we would continue to use these fields for future metadata, so I think that risk is low.",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-06-16T22:37:34Z",
      "updated_at": "2026-02-24T05:05:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32763",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1011,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2803909911,
      "number": 33324,
      "title": "blocks: add `-reobfuscate-blocks` argument to enable (de)obfuscating existing blocks",
      "body": "### Context\r\n\r\nRecent discussions highlighted that many nodes which synced before Bitcoin Core v28 have their block and undo files stored effectively in the clear (zero XOR key). This patch adds a simple, resumable maintenance tool to obfuscate previously raw block files, rotate an existing key to a fresh random one, or de-obfuscate (set key to zero) if consciously chosen, all without requiring resync. The operation can be cancelled and restarted safely.\r\n\r\n### Implementation\r\n\r\nThe new startup option `-reobfuscate-blocks[=VALUE]` accepts either 16 hex characters as an exact 8-byte XOR key (little-endian in-memory layout) or a boolean to generate a random 64-bit key. e.g. `-reobfuscate-blocks=0000000000000000` sets the key to zero, effectively removing obfuscation.\r\n\r\nIf we detect unobfuscated blocks at start time we suggest this new option in a warning.\r\n\r\nAt startup, we iterate over all undo and block files (grouping the block and undo files for more uniform iteration), read them with the old XOR key and write them back with the new key (`<name>.reobfuscated`). The implementation actually combines the two keys and reads directly into the new obfuscated version to only do a single iteration over the data. This works if the original blocks aren't obfuscated or if the new blocks aren't or if both are.\r\nAfter successful write, we immediately delete the old file. Once all files are staged, we rename them back and atomically swap `xor.dat.reobfuscated` → `xor.dat` and continue operation.\r\n\r\nWe log the old and new keys and print progress roughly per-percent as files complete (i.e. max 100 progress logs).\r\n\r\n### Constraints\r\n\r\n* Re-obfuscation resumes automatically (detected via `xor.dat.reobfuscated`) even without the flag. In worst-case a crash should only force us to redo previous work.\r\n* Single-threaded, processing one file at a time to keep code simple and avoid complexity of interleaving renames and key swaps across threads.\r\n* Fast in practice with sequential read/modify/write per blockfile - after recent obfuscation vectorization, this path is very quick.\r\n\r\n### Reproducer\r\n\r\n```bash\r\ncmake -B build -DBUILD_GUI=ON && cmake --build build -j$(nproc)\r\n# command line\r\n./build/bin/bitcoind -reobfuscate-blocks -stopatheight=1\r\n# same with GUI\r\n./build/bin/bitcoin-qt -reobfuscate-blocks -stopatheight=1\r\n```\r\n\r\n### Single-threaded Performance\r\n\r\n cpu                 | hdd/ssd | block count | size    | files  | time (min) | blocks/min \r\n---------------------|---------|-------------|---------|--------|------------|------------\r\n Apple M4 Max laptop | SSD     | ~909k       | ~707 GB | 9,982  | 8.4        | 146,613    \r\n Intel Core i9       | SSD     | ~909k       | ~725 GB | 10,238 | 23.1       | 39,351     \r\n Raspberry Pi 5      | SSD     | ~914k       | ~728 GB | 10,276 | 72.78      | 12,558     \r\n Intel Core i7       | HDD     | ~909k       | ~720 GB | 10,156 | 208.7      | 4,356      \r\n Raspberry Pi 4B     | HDD     | ~915k       | ~730 GB | 10,304 | 1467       | 624        \r\n\r\n----\r\n\r\nSimilar work:\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/32451\r\n* https://github.com/andrewtoth/blocks-xor\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-09-05T23:51:29Z",
      "updated_at": "2026-02-24T03:23:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33324",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3232,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2829858173,
      "number": 33392,
      "title": "wallet, rpc: add UTXO set check and incremental rescan to importdescriptors",
      "body": "Fixes [#28898](https://github.com/bitcoin/bitcoin/issues/28898)\r\n\r\nWhen importing descriptors, users may accidentally provide an incorrect birthdate (timestamp). This can cause the wallet to miss relevant historical transactions, leading to incorrect or incomplete balances. Currently, the wallet only relies on rescans starting from the provided timestamp.\r\n\r\nThis PR extends the importdescriptors RPC with a new optional argument:\r\n\r\n`verify_balance` a `bool` which is `false` by defualt.\r\n\r\nIf enabled, the wallet will compare its calculated trusted balance against UTXO set balance (by generating the `scriptpukeys` of the wallet and comparing it with the chains UTXO set `scriptpubkeys` to get the accurate balance belonging to the wallet and comparing it with the wallet trusted balance).\r\n\r\nIf the balances match, import continues as normal.\r\nIf a discrepancy is detected, the wallet will attempt incremental rescans in chunks of recent blocks until the missing history is found. If the wallet is pruned, incremental rescans will not go earlier than the prune boundary.\r\n\r\nAdditional information is returned in the RPC response under an `\"info\" ` object when `verify_balance` is used, they are:\r\n\r\n`utxo_check`: whether the UTXO set matched the wallet balance\r\n`scanned_chunks:` number of incremental rescan chunks attempted\r\n`scanned_blocks`: approximate number of blocks scanned during incremental rescans\r\n\r\nThis helps detect and fix balance mismatches caused by wrong descriptor timestamps.\r\n\r\n**Implementation:**\r\n- Add `FindCoinsByScript()` for scanning UTXO set for coins belonging to output_scripts and expose it to node interface through `findCoinsByScript()`.\r\n- Add `GetWalletUTXOSetBalance()` which calculates the wallet’s total spendable balance by summing all UTXOs in the blockchain’s UTXO set that belong to the wallet’s scriptPubKeys, ignoring immature coinbase outputs.\r\n- Add `std::optional<int64_t> endTime` to `RescanFromTime()` which lets the rescan stop at a specific block height, limiting the scan to a defined time range instead of scanning from startTime all the way to the blockchain tip.\r\n- Add `IncrementalRescan()` this function scans the wallet’s transaction history in chunks of blocks from tip backwards to try and reconcile the wallet’s trusted balance with the actual UTXO-set balance, stopping early if a chunk produces a balance that matches the target. It is used only when there’s a discrepancy between the wallet’s trusted balance and the UTXO-set balance, performing an incremental rescan to identify when the balances align and recording how many chunks were scanned. \r\n\r\n**`importescriptors` with incremental example**\r\n```\r\nbitcoin-cli importdescriptors '[{\r\n    \"desc\": \"wpkh([f5b1c3d7/84h/0h/0h]xpub6CUGRUonZSQ4TWtTMmzXdrXDtypWKiKpJrZT4S9vPz4ZZ6f4a1V4f3ChFy8hRk4M6mh4J4LR6WcJbNf2oyMFGmQH6Eo1QvLKMjR18q3fTq5/0/*)#abcd1234\",\r\n    \"timestamp\": \"now\"\r\n}]' true\r\n```\r\n\r\nExample Output\r\n```\r\n[\r\n  {\r\n    \"info\": {\r\n      \"utxo_check\": true,\r\n      \"scanned_blocks\": 2000,\r\n      \"scanned_chunks\": 2\r\n    }\r\n  }\r\n]\r\n```\r\n\r\n**Benchmarks**\r\nHere's a benchmark result for normal rescan and incremental rescan as suggested by **fjahr**. \r\n\r\n| ns/op        | op/s       | err% | total | benchmark                   |\r\n|-------------:|-----------:|-----:|------:|:----------------------------|\r\n| 13,481.56    | 74,175.41  | 0.9% | 0.01  | BenchmarkIncrementalRescans |\r\n| 13,450.49    | 74,346.72  | 1.4% | 0.01  | BenchmarkIncrementalRescans |\r\n| 13,468.04    | 74,249.85  | 1.5% | 0.01  | BenchmarkIncrementalRescans |\r\n| 2,274,875.00 | 439.58     | 1.7% | 0.03  | BenchmarkRescanFull         |\r\n| 2,301,375.00 | 434.52     | 1.4% | 0.03  | BenchmarkRescanFull         |\r\n| 2,306,334.00 | 433.59     | 3.0% | 0.03  | BenchmarkRescanFull         |\r\n\r\n\r\nHere's the [code](https://github.com/bitcoin/bitcoin/commit/15982b5cdef97d89c5ac68fe4b075abad1f65228)  for the benchmark. Not 100 percent sure if I wrote it correctly. It's my first time writting benchmark, took inspiration from how [src/bench/wallet_balance.cpp](https://github.com/bitcoin/bitcoin/blob/master/src/bench/wallet_balance.cpp) was written.\r\n\r\n\r\nA big thanks to **fjahr** for suggesting this approach [comment](https://github.com/bitcoin/bitcoin/pull/33392#issuecomment-3300319224)",
      "state": "open",
      "user": "musaHaruna",
      "created_at": "2025-09-15T16:17:12Z",
      "updated_at": "2026-02-24T03:06:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33392",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 4366,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2901201712,
      "number": 33585,
      "title": "cmake: Use builtin support for .manifest files",
      "body": "Remove some redundant logic from the CMake code:\r\n\r\n* The `WIN32_EXECUTABLE` target property only has an effect when building for `WIN32`. Checking `WIN32` is redundant.\r\n* CMake has builtin support for `.rc` and `.manifest` files. Both may be added to sources unconditionally. They only have an effect when building for `WIN32`.\r\n",
      "state": "open",
      "user": "purpleKarrot",
      "created_at": "2025-10-09T15:44:53Z",
      "updated_at": "2026-02-24T02:35:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33585",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 378,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3274425083,
      "number": 34568,
      "title": "mining: Break compatibility with existing IPC mining clients",
      "body": "This PR increments the field number of the `Init.makeMining` method and makes the old `makeMining` method return an error, so IPC mining clients not using the latest schema file will get an error and not be able to access the Mining interface.\r\n\r\nNormally, there shouldn't be a need to break compatibility this way, but the mining interface has evolved a lot since it was first introduced, with old clients using the original methods less stable and performant than newer clients. So now is a good time to introduce a cutoff, drop deprecated methods, and stop supporting old clients which can't function as well.\r\n\r\nBumping the field number is also an opportunity to make other improvements that would be awkward to implement compatibly:\r\n- Making Cap'n Proto default parameter and field values match default values of corresponding C++ methods and structs. \r\n- Adding missing Context parameters to Mining.createNewBlock and checkBlock methods so these methods will be executed on separate execution threads and not block the Cap'n Proto event loop thread.\r\n\r\nMore details about these changes are in the commit messages.",
      "state": "closed",
      "user": "ryanofsky",
      "created_at": "2026-02-12T04:10:23Z",
      "updated_at": "2026-02-24T02:24:00Z",
      "merged_at": "2026-02-20T10:06:32Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34568",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1181,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3018324242,
      "number": 33889,
      "title": "guix: update per-host disk-space estimates in build gate",
      "body": "Today, the build gates are obsolete. I found this out after seeing someone flag this on a commit setting `-static-libgcc`. Note that the Linux builds came in at the expected amount of disk space utilization, so I did not touch the values for them.\r\n\r\nThis PR aims to readjust the build gate disk space per-host estimates for darwin and mingw based on some testing I did locally in my build VM.\r\n\r\nDetails:\r\n(Copied from https://github.com/kevkevinpal/bitcoin/issues/200):\r\n\r\nI ran `HOSTS=\"x86_64-w64-mingw32\" ./contrib/guix/guix-build`\r\n\r\nAfter (+10 GiB):\r\n```\r\nFilesystem     1G-blocks  Used Available Use% Mounted on\r\n/dev/sda5           512G   98G      393G  20% /gnu/store\r\n```\r\n\r\nThese numbers makes this change seem reasonable (1.5x safety factor):\r\n```\r\n-        *mingw*)  required_KiB=7600000 ;;\r\n+        *mingw*)  required_KiB=15728640 ;;\r\n```\r\n\r\n---\r\n\r\nThen I ran `HOSTS=\"aarch64-linux-gnu\" ./contrib/guix/guix-build`.\r\n\r\nAfter (+6 GiB):\r\n```\r\nFilesystem      Size  Used Avail Use% Mounted on\r\n/dev/sda5       512G  104G  387G  22% /gnu/store\r\n```\r\n\r\n---\r\n\r\nThen I setup the SDK for macOS. This established a new *before* snapshot of disk use:\r\n```\r\nFilesystem      Size  Used Avail Use% Mounted on\r\n/dev/sda5       512G  116G  375G  24% /gnu/store\r\n```\r\n\r\nThen I ran `HOSTS=\"x86_64-apple-darwin\" ./contrib/guix/guix-build`.\r\n\r\nAfter (+5 GiB):\r\n```\r\nFilesystem      Size  Used Avail Use% Mounted on\r\n/dev/sda5       512G  121G  370G  25% /gnu/store\r\n```\r\n\r\nIMO, this is grounds for updating this (5 GiB * 1.5x safety factor):\r\n```\r\n-        *darwin*) required_KiB=440000 ;;\r\n+        *darwin*) required_KiB=8388608 ;;\r\n```\r\n",
      "state": "open",
      "user": "djkazic",
      "created_at": "2025-11-17T17:21:07Z",
      "updated_at": "2026-02-24T01:11:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33889",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1692,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3091431534,
      "number": 34049,
      "title": "rpc: Disallow captures in RPCMethodImpl",
      "body": "When defining `RPCHelpMan` objects, we usually return a lambda, and mostly we define those via `[&](...) { ... }` which explicitly captures any parameters or local variables by reference. If we were to actually use any of those captures (we don't), we would invoke undefined behaviour. So instead, convert all the `[&]` to `[]` to avoid capturing, and as part of `RPCHelpMan` check that the function we provide is convertible to a bare function pointer, so that any attempts to capture anything (even if it's by-copy, which is safe) results in an error.\r\n\r\nWhile we're at it, rename `RPCHelpMan` to `RPCMethod`, reflecting it's greater responsibility since #19386.",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2025-12-11T03:25:25Z",
      "updated_at": "2026-02-23T23:59:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34049",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 704,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2534144808,
      "number": 32577,
      "title": "subprocess: Let shell parse command on non-Windows systems",
      "body": "Fixes https://github.com/bitcoin/bitcoin/issues/32574.\r\n\r\nThe `subprocess::Popen` constructor has two overloads: https://github.com/bitcoin/bitcoin/blob/7763e86afa045910a14ac9b2cd644927a447370b/src/util/subprocess.h#L938-L941\r\n\r\nDuring the migration from Boost.Process in https://github.com/bitcoin/bitcoin/pull/28981, the second was chosen for two reasons: (1) it minimized changes at the call sites, and (2) it [addressed](https://github.com/bitcoin/bitcoin/pull/28981#issuecomment-1837238921) quoting issues on Windows. This approach internally uses the `subprocess::util::split()` function, which currently fails to handle quoted tokens, such as in subshell invocations like `sh -c 'ls; echo'`.\r\n\r\nThis issue was not caught by our tests as they are broken. The last commit fixes the `system_tests/run_command` test. This commit can be applied on top of the master branch to reproduce the existing failure in `subprocess`.\r\n\r\nThe second commit is intended to be upstreamed. However, I'm seeking code review feedback first (please note that the `src/util/subprocess.h` code is C++11 compatible).",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-05-21T11:45:24Z",
      "updated_at": "2026-02-23T21:23:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32577",
      "labels": [
        "Utils/log/libs",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 1156,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3213105614,
      "number": 34416,
      "title": "Add nullptr-check to CChain::Contains(), tests",
      "body": "Add unit tests to the `CChain` class, and add a nullptr-check to `CChain::Contains()` to avoid potential memory access violation by `nullptr` dereference.\r\n\r\nThe `CChain::Contains()` method (in `src/chain.h`) dereferences its input without checking. The `Next()` method also calls into this with a `nullptr` if invoked with `nullptr`. While most call sites have indirect guarantee that the input is not `nullptr`, it's not easy to establish this to all call sites with high confidence. These methods are publicly available. There is no known high-level use case to trigger this error, but the fix is easy, and makes the code safer.\r\n\r\nAlso, unit tests were added to the `CChain` class, filling a gap.\r\n\r\nChanges:\r\n\r\n- Add basic unit tests for `CChain` class methods\r\n- Add a nullptr-check to `CChain::Contains()`\r\n\r\nAlternative. I have considered changing `Contains()` to take a reference instead of pointer, however, when applying that to various methods, it grew to a much bigger changeset -- see #34440. Having in mind the friction of larger PRs, I think the present minimal one-check solution (with the tests) makes sense on its own.\r\n\r\nThis change is remotely related to and indirectly triggered by #32875 .\r\n",
      "state": "open",
      "user": "optout21",
      "created_at": "2026-01-27T05:25:08Z",
      "updated_at": "2026-02-23T21:18:42Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34416",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1261,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3224701572,
      "number": 34451,
      "title": "rpc: fix race condition in gettxoutsetinfo",
      "body": "Fixes #34263\r\n\r\nA `CHECK_NONFATAL` assertion failure could occur in `gettxoutsetinfo` when a new block was connected between capturing `pindex` and validating it in `GetUTXOStats()`.\r\n\r\nThe fix removes the early `pindex` capture since `ComputeUTXOStats()` independently fetches the current best block under lock. The response now uses `stats.hashBlock` and `stats.nHeight` (the actual computed values) instead of the potentially stale `pindex`.",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2026-01-29T18:57:02Z",
      "updated_at": "2026-02-23T20:36:56Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34451",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 487,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3277360664,
      "number": 34576,
      "title": "threadpool: add ranged Submit overload",
      "body": "The current `ThreadPool::Submit` is not very efficient when we have a use case where we need to submit multiple tasks immediately. The `Submit` method must take the lock for each task, and notifies only a single worker thread. This will cause lock contention with the awakened worker thread trying to take the lock and the caller trying to submit the next task.\r\n\r\nIntroduce a `Submit` overload, which takes the lock once and submits a range of tasks, then notifies all worker threads after the lock is released.\r\n\r\nThis is needed for #31132 to be able to use `ThreadPool`.",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2026-02-12T17:39:40Z",
      "updated_at": "2026-02-23T18:11:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34576",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 612,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3311414037,
      "number": 34647,
      "title": "fix: properly reset coins_view_cache after catching flush exception",
      "body": "The parent cache tries to reset the child cache's state by iterating through the cursor. This doesn't work since the cursor may have already been partially iterated. When we start again at Begin() it may double decrement m_dirty_count. Fix this by throwing the error and letting the child cache catch it and reset its own state properly.\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/34645\r\n",
      "state": "closed",
      "user": "andrewtoth",
      "created_at": "2026-02-21T20:47:21Z",
      "updated_at": "2026-02-23T17:00:30Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34647",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 464,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2887599768,
      "number": 33540,
      "title": "argsman, cli: GNU-style command-line option parsing (allows options after non-option arguments)",
      "body": "This PR simplifies the argument parsing logic and resolves practical issues for `bitcoin-cli` and similar binaries (e.g. `bitcoin-wallet`) making their usage more consistent and predictable, enabling valid patterns such as mixing commands with wallet- or RPC-specific options—without relying on argument ordering quirks.\r\n\r\n<details>\r\n<summary>What's changed in ArgsManager that allows the above.</summary>\r\n\r\n- Previously, `ArgsManager` stopped interpreting options once a non-option argument was encountered (non-GNU parsing). For example:\r\n\r\n        bitcoind -a -b param -c\r\n\r\n  would ignore `-c` because it followed the non-option argument `param`. In some cases '-c' is interpreted as an argument for 'param', producing unexpected behavior (eg empty arrays for listtransactions command).\r\n\r\n- This PR changes the behavior so that options following non-option argument are recognized and processed (GNU parsing). This is needed for workflows for tools like CLI where command arguments may be followed by wallet- or RPC-specific\r\noptions, e.g.:\r\n\r\n        bitcoin-cli -rpcwallet=\"\" listtransactions -rpcwallet=mywallet\r\n    \r\n        bitcoin-cli getaddressinfo <address> -rpcwallet=mywallet\r\n\r\n- (other binaries could also benefit from this change,  e.g. `bitcoin-wallet`)\r\n\r\n        bitcoin-wallet create -wallet=newname\r\n\r\n- Invalid options passed after non-options will be treated as RPC arguments that begin with a `-` character (so no\r\nbehavioural change against `master`), e.g.:\r\n\r\n        bitcoin-cli -regtest -datadir=/tmp/btc createwallet -mywallet\r\n        {\r\n            \"name\": \"-mywallet\"\r\n        }\r\n\r\n</details>\r\n\r\n<details><summary>Before and after outputs running RPC commands from <code>CLI</code>/ <code>bitcoin-cli</code>.</summary><ul>\r\n     <li><details><summary>wallet commands using <code>CLI</code>:</summary><ul> \r\n           <li><details><summary><code>getaddressinfo</code></summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc getaddressinfo bcrt1qrnz5xlcwz5d85n3fag6v0vc4lryjc90jhqtpsh -rpcwallet=nonExistent\r\nerror message:\r\ngetaddressinfo \"address\"\r\n...\r\n```\r\n</li>\r\n           <li>after\r\n\r\n```\r\n./build/bin/bitcoin-cli -regtest -datadir=/tmp/btc getaddressinfo bcrt1qrnz5xlcwz5d85n3fag6v0vc4lryjc90jhqtpsh -rpcwallet=nonExistent\r\nerror code: -18\r\nerror message:\r\nRequested wallet does not exist or is not loaded\r\n```\r\n\r\n</li>\r\n           </ul></details></li>\r\n           <li><details><summary><code>listtransactions</code></summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=nonExistent\r\n[\r\n]\r\n```\r\n\r\n</li>\r\n           <li>after\r\n\r\n\r\n```\r\n./build/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=nonExistent\r\nerror code: -18\r\nerror message:\r\nRequested wallet does not exist or is not loaded\r\n```\r\n\r\n</li>\r\n           </ul></details></li>\r\n           <li><details><summary>any command that needs an option to be specifed, it can be added at the end directly instead of before the command</summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions\r\nerror code: -19\r\nerror message:\r\nMultiple wallets are loaded. Please select which wallet to use by requesting the RPC through the /wallet/<walletname> URI path. Or for the CLI, specify the \"-rpcwallet=<walletname>\" option before the command (run \"bitcoin-cli -h\" for help or \"bitcoin-cli listwallets\" to see which wallets are currently loaded).\r\n```\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=\"\"\r\nerror code: -19\r\nerror message:\r\nMultiple wallets are loaded. Please select which wallet to use by requesting the RPC through the /wallet/<walletname> URI path. Or for the CLI, specify the \"-rpcwallet=<walletname>\" option before the command (run \"bitcoin-cli -h\" for help or \"bitcoin-cli listwallets\" to see which wallets are currently loaded).\r\n```\r\n\r\n</li>\r\n           <li>after\r\n\r\n```\r\n/build/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=\"\"\r\n[\r\n  {\r\n    \"address\": \"bcrt1q5pqkrlfrp9rvsg43sxxagrees7r7ul6uyskhs4\",\r\n    \"parent_descs\": [\r\n      \"wpkh([76a11ab0/84h/1h/0h]tpubDCDCuyC1Rtm1weZ5kfBYtdchcmqa2t8db7M68wsPHbWhUrYnzFTrHu7ufVVRydt3FdWQy8iNmKbZYbgpWWcEKPAj896x53UbS6i2xRD1qct/0/*)#kuff3m9t\"\r\n    ],\r\n    \"category\": \"immature\",\r\n    \"amount\": 50.00000000,\r\n    \"label\": \"\",\r\n...\r\n```\r\n\r\n</li>\r\n           </ul></details></li>\r\n     </ul></details></li>\r\n     <li><details><summary>other binaries could benefit from it, e.g. <code>bitcoin-wallet:</code></summary><ul> \r\n           <li><details><summary><code>create</code> command</summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-wallet -regtest -datadir=/tmp/btc create\r\nWallet name must be provided when creating a new wallet.\r\n```\r\n_(`-wallet` option has to be passed before the `create` command in order to work)_\r\n```\r\n./build_master/bin/bitcoin-wallet -regtest -datadir=/tmp/btc create -wallet=newWalletName\r\nError: Additional arguments provided (-wallet=newWalletName). Methods do not take arguments. Please refer to `-help`.\r\n```\r\n\r\n</li>\r\n           <li>after\r\n\r\n```\r\n./build/bin/bitcoin-wallet -regtest -datadir=/tmp/btc create -wallet=newWallet\r\nTopping up keypool...\r\nWallet info\r\n===========\r\nName: newWallet\r\nFormat: sqlite\r\nDescriptors: yes\r\nEncrypted: no\r\nHD (hd seed available): yes\r\nKeypool Size: 8000\r\nTransactions: 0\r\nAddress Book: 0\r\n```\r\n</li>\r\n           </ul></details></li>\r\n     </ul></details></li>\r\n     </ul> <!-- End -->\r\n</details>\r\n\r\n-<ins>_**Notes**_</ins>:\r\n\r\n- <ins>Backwards compatibility</ins>:\r\nThis PR is backward compatible in the sense that it allows new valid invocations that were previously rejected (failed or somehow ignored).\r\nIn `master`, any valid option following a command is treated as a positional argument. This can lead to unexpected RPC errors or help messages due to mismatched argument types. With this PR, those cases are parsed as proper options when applicable.\r\n\r\n- `bitcoin-cli` continues to accept RPC arguments that begin with a `-` character as currently in `master` (check `createwallet` example in _\"What's change in ArgsManager\"_ section above).\r\n\r\n- `bitcoin-cli` could distinguish between options that begin with single and double dashes, and treat options after the RPC method name that begin with double dashes as RPC named parameters (check example in 4th [commit](https://github.com/bitcoin/bitcoin/pull/33540/commits/a101bbb61fdf5563337334d63a10432432ee3625) message body).\r\n\r\n- Refactored both `ArgsManager::ProcessOptionKey` (new function added in this PR) and `ArgsManager::ParseParameters` in separated commits making the code clearer and the PR much easier to follow and review.",
      "state": "open",
      "user": "pablomartin4btc",
      "created_at": "2025-10-04T22:43:06Z",
      "updated_at": "2026-02-23T16:53:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33540",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 2,
        "text_length": 6987,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3299290114,
      "number": 34615,
      "title": "mempool: expose optimality of mempool to log / rpc",
      "body": "Post-SFL #34023 I don't think we expect the mempool to be unordered for long periods of time. If we consider it likely to be a serious regression in production, it would be useful to expose the fact  that the mempool is not known to be optimal.\r\n\r\n1. do a MEMPOOL log after any `DoWork()` returns false, meaning non-optimal\r\n2. expose it via getmempoolinfo, by calling `DoWork(0)`, which does nothing but return known-optimality\r\n\r\nI'm not wedded to either approach, I just think something is better than nothing for the next release.",
      "state": "closed",
      "user": "instagibbs",
      "created_at": "2026-02-18T15:44:28Z",
      "updated_at": "2026-02-23T16:10:47Z",
      "merged_at": "2026-02-23T16:10:47Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34615",
      "labels": [
        "Mempool",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 585,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3291253508,
      "number": 34602,
      "title": "test: addrman: successive failures in the last week for IsTerrible",
      "body": "This PR adds test coverage for the case that an address is considered terrible if we had N successive failures in the last week.\r\n\r\nIt kills the following mutant (https://corecheck.dev/mutation/src/addrman.cpp#L88):\r\n```diff\r\ndiff --git a/src/addrman.cpp b/src/addrman.cpp\r\nindex e3981e6a40..f8045491c1 100644\r\n--- a/src/addrman.cpp\r\n+++ b/src/addrman.cpp\r\n@@ -65,7 +65,7 @@ bool AddrInfo::IsTerrible(NodeSeconds now) const\r\n     }\r\n\r\n     if (now - m_last_success > ADDRMAN_MIN_FAIL && nAttempts >= ADDRMAN_MAX_FAILURES) { // N successive failures in the last week\r\n-        return true;\r\n+        return false;\r\n     }\r\n\r\n     return false;\r\n\r\n```",
      "state": "open",
      "user": "brunoerg",
      "created_at": "2026-02-16T19:14:41Z",
      "updated_at": "2026-02-23T14:26:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34602",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 716,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3193557787,
      "number": 34359,
      "title": "test: add test for rebroadcast of transaction received via p2p",
      "body": "The wallet doesn't only rebroadcast transactions it created, but also relevant transactions received via p2p. \r\nSince this is not self-evident, add test coverage for it.",
      "state": "open",
      "user": "mzumsande",
      "created_at": "2026-01-21T02:42:05Z",
      "updated_at": "2026-02-23T12:08:03Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34359",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 232,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3207919952,
      "number": 34401,
      "title": "kernel:  add serialization method for btck_BlockHeader API",
      "body": "This adds serialization for `btck_BlockHeader` API. Also, updated the `CheckHandle` to compare the byte content instead of size.\r\n\r\nThe changes here is done in two commits. First commit adds the `SpanWriter` class and next one moves the block header serialization to `SpanWriter`. See commit message for more details.\r\n\r\nFollow-up to #33822 .",
      "state": "open",
      "user": "yuvicc",
      "created_at": "2026-01-25T06:50:13Z",
      "updated_at": "2026-02-23T10:12:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34401",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 401,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3149923145,
      "number": 34209,
      "title": "[30.x]: Final backports & 30.2rc1",
      "body": "Backports:\r\n* #34156\r\n* #34215",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-01-06T16:18:12Z",
      "updated_at": "2026-02-23T10:04:53Z",
      "merged_at": "2026-01-07T15:45:03Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34209",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 64,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3308270443,
      "number": 34638,
      "title": "guix: Update storage requirement for HOSTS and added warning for Guix overhead",
      "body": "This is an alternative to #33889\r\n\r\nThe lasttime the storage requirements were updated is 4 years ago in #22075 and do not match the current needs of a Guix build. This PR updates the storage requirements to align with recent builds.\r\n\r\nThe current code is quite off for certain hosts (the total equals out overall), but the check also ignores the output directory which takes up an additional 5 GiB of disk space:\r\n\r\n<details>\r\n\r\nComparing real usage against the script's estimates:\r\n\r\n| Host                  | Real KiB  | Estimate KiB | Delta          |\r\n| --------------------- | --------- | ------------ | -------------- |\r\n| `aarch64-linux-gnu`   | 3,875,896 | 6,400,000    | **-2,524,104** |\r\n| `arm-linux-gnueabihf` | 2,983,008 | 6,400,000    | **-3,416,992** |\r\n| `riscv64-linux-gnu`   | 5,712,668 | 6,400,000    | -687,332       |\r\n| `x86_64-linux-gnu`    | 3,978,648 | 6,400,000    | **-2,421,352** |\r\n| `powerpc64-linux-gnu` | 4,026,948 | 6,400,000    | -2,373,052     |\r\n| `x86_64-w64-mingw32`  | 8,022,644 | 7,600,000    | +422,644       |\r\n| `x86_64-apple-darwin` | 2,714,848 | 440,000      | **+2,274,848** |\r\n| `arm64-apple-darwin`  | 2,659,824 | 440,000      | **+2,219,824** |\r\n| `output dir ` | 5,500,000 | 0 | **+5,500,000**|\r\n\r\n\r\n</details>\r\n\r\nThis PR makes the following changes: \r\n- Updates the required KiB per category to current needs + 10% margin\r\n- it adds an extra category for `riscv64` (was way off * category )\r\n- adds output directory storage requirements \r\n\r\nThis all totals to 42 GiB (using all hosts) :\r\n<details>\r\n\r\nOutput for #34550 on Guix 1.5.0 \r\n\r\n| Host                  |  Real KiB | Estimate      | Margin     |\r\n| --------------------- | ---------------- | ------------- | ---------- |\r\n| `aarch64-linux-gnu`   | ~3,880,000       | 4,400,000     | +13%       |\r\n| `arm-linux-gnueabihf` | ~3,041,000       | 4,400,000     | +45%       |\r\n| `powerpc64-linux-gnu` | ~4,089,000       | 4,400,000     | +8%        |\r\n| `x86_64-linux-gnu`    | ~3,985,000       | 4,400,000     | +10%       |\r\n| `riscv64-linux-gnu`   | ~5,767,000       | 6,300,000     | +9%        |\r\n| `x86_64-w64-mingw32`  | ~8,074,000       | 9,000,000     | +11%       |\r\n| `x86_64-apple-darwin` | ~2,726,000       | 3,000,000     | +10%       |\r\n| `arm64-apple-darwin`  | ~2,726,000       | 3,000,000     | +10%       |\r\n| **output**            | ~4,929,000 | 5,500,000 | +10% |\r\n\r\nOutput for #34627 on Guix 1.4.0 \r\n\r\n| Host                  |  Real KiB | Estimate      | Margin     |\r\n| --------------------- | ---------------- | ------------- | ---------- |\r\n| `aarch64-linux-gnu`   | ~3,934,232       | 4,400,000     | +12%       |\r\n| `arm-linux-gnueabihf` | ~3,040,552       | 4,400,000     | +45%       |\r\n| `powerpc64-linux-gnu` | ~4,084,480       | 4,400,000     | +8%        |\r\n| `x86_64-linux-gnu`    | ~4,036,900       | 4,400,000     | +9%       |\r\n| `riscv64-linux-gnu`   | ~5,764,512       | 6,300,000     | +9%        |\r\n| `x86_64-w64-mingw32`  | ~8,087,164       | 9,000,000     | +11%       |\r\n| `x86_64-apple-darwin` | ~2,762,992       | 3,000,000     | +9%       |\r\n| `arm64-apple-darwin`  | ~2,707,800       | 3,000,000     | +11%       |\r\n| **output**            | ~5,048,228 | 5,500,000 | +9% |\r\n\r\n</details>\r\n\r\nAdditionally, maybe more controversial (happy to drop), I've added a second check to warm users if they do not have enough free space to store the guix overhead (`/gnu` store) which is an additional 8,7 GiB.  This check only warns and does not stop the build. \r\n\r\n<details> <summary> New warning message:</summary>\r\n\r\n```terminal\r\nFound macOS SDK at '/root/SDK/Xcode-26.1.1-17B100-extracted-SDK-with-libcxx-head\r\ners', using...\r\n\r\nWARN: Available disk space (42 GiB) may be insufficient for the\r\n      estimated total of 51 GiB (build directories, output,\r\n      and Guix environment overhead).\r\n\r\nThe build will proceed, but may fail mid-way if disk space runs out.\r\n\r\nChecking that we can connect to the guix-daemon...\r\n```\r\n</details>\r\n\r\nNB.\r\nCould not find a good reason for the change  in disk usage, even older V29 build take up roughly the same size as recent builds.",
      "state": "open",
      "user": "janb84",
      "created_at": "2026-02-20T15:00:28Z",
      "updated_at": "2026-02-23T09:42:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34638",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 4198,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3303304404,
      "number": 34622,
      "title": "test: assert_debug_log timeouts follow-up",
      "body": "Small fixups that fell through. See the commit messages for details.\r\n\r\nCan be tested via:\r\n\r\n```diff\r\ndiff --git a/src/util/thread.cpp b/src/util/thread.cpp\r\nindex 0fde73c..4fcfe4f 100644\r\n--- a/src/util/thread.cpp\r\n+++ b/src/util/thread.cpp\r\n@@ -8,2 +8,3 @@\r\n #include <util/log.h>\r\n+#include <util/time.h>\r\n #include <util/threadnames.h>\r\n@@ -18,2 +19,3 @@ void util::TraceThread(std::string_view thread_name, std::function<void()> threa\r\n     util::ThreadRename(std::string{thread_name});\r\n+    UninterruptibleSleep(999ms);\r\n     try {\r\ndiff --git a/src/validationinterface.cpp b/src/validationinterface.cpp\r\nindex c7be6ab..3237aec 100644\r\n--- a/src/validationinterface.cpp\r\n+++ b/src/validationinterface.cpp\r\n@@ -14,2 +14,3 @@\r\n #include <primitives/transaction.h>\r\n+#include <random.h>\r\n #include <util/check.h>\r\n@@ -156,2 +157,4 @@ void ValidationSignals::SyncWithValidationInterfaceQueue()\r\n \r\n+static FastRandomContext g_rnd{};\r\n+\r\n // Use a macro instead of a function for conditional logging to prevent\r\n@@ -166,2 +169,3 @@ void ValidationSignals::SyncWithValidationInterfaceQueue()\r\n             LOG_EVENT(fmt, local_name, __VA_ARGS__);           \\\r\n+            if(g_rnd.randrange(2)<1)UninterruptibleSleep(55ms);\\\r\n             event();                                           \\\r\n```\r\n\r\nWith this diff and without the changes here, the touched tests fail.\r\nWith this diff and with the changes here, the touched tests pass.\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/34621",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-02-19T14:17:26Z",
      "updated_at": "2026-02-23T08:55:24Z",
      "merged_at": "2026-02-21T00:46:16Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34622",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1537,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3259815827,
      "number": 34534,
      "title": "rpc: Manual prune lock management (Take 2)",
      "body": "This is a refreshed version of #19463, which was closed after inactivity but there was some mentions of users/external applications at the last CoreDev that would be interested in using this. Unfortunately, I can not recall who was mentioned as a potential user but I would appreciate if someone could ping them to take a look if this is still relevant to them.\r\n\r\nThis PR leverages the existing prune locks system we already have. The interface of the RPCs of the old PR has been slightly updated, it now matches the pattern used by `setban`/`listbanned` exactly. The locks are prefixed to distinguish them from the systems locks and prevent naming colissions. They are not persisted across restarts.\r\n\r\nUsage of temporary prune locking may also be helpful in other functional test scenarios but I didn't spend time to check where might apply.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2026-02-08T14:01:05Z",
      "updated_at": "2026-02-23T03:08:16Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34534",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 887,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2757848362,
      "number": 33223,
      "title": "coinselection: Tiebreak SRD eviction by weight",
      "body": "@yancyribbens [pointed out](https://github.com/p2pderivatives/rust-bitcoin-coin-selection/pull/108#issuecomment-3202107069) that SRD would fail to find a possible solution if there are multiple UTXOs of the same effective value with diverse weight.\r\n\r\nThis adds a tiebreaker that will make SRD succeed in such a scenario.",
      "state": "open",
      "user": "murchandamus",
      "created_at": "2025-08-19T22:51:00Z",
      "updated_at": "2026-02-23T01:59:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33223",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 368,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3294354112,
      "number": 34606,
      "title": "[RFC] common: warn on high swap usage",
      "body": "### Problem\r\nHigh swapping could grind execution to a halt, but today users get no direct warning from the node when this happens.\r\n\r\n### Fix\r\nWe can log to let the user know when the system is under heavy swap pressure.\r\nThis change adds a periodic Linux-only check (via `sysinfo()`) and emits a one-time warning when swap usage exceeds 512 MiB, with guidance to reduce memory-heavy settings (`-dbcache`,`-maxmempool`, `-maxconnections`) or use `-blocksonly`.\r\n\r\nThis is intentionally an RFC, and currently implemented for Linux only.\r\n\r\n### Reproducer\r\n> Enable swap\r\n\r\n```bash\r\nsudo dd if=/dev/zero of=/data/swapfile bs=1M count=4096 status=none && \\\r\nsudo chmod 600 /data/swapfile && sudo mkswap /data/swapfile && sudo swapon /data/swapfile && \\\r\nsudo sysctl -w vm.swappiness=100 && \\\r\nswapon --show && free -h\r\n```\r\n\r\n> Disable swap\r\n\r\n```bash\r\n(sudo swapoff /data/swapfile 2>/dev/null || true) && \\\r\nsudo rm -f /data/swapfile && \\\r\nsudo sysctl -w vm.swappiness=60 && \\\r\nswapon --show && free -h\r\n```\r\n\r\n> Reproducer (assuming 16 GB memory and PR already checked out)\r\n```bash\r\nsed -i -E '/MaybeWarnIfSystemSwapping/s/30min/5s/' src/init.cpp && \\\r\ncmake --build build --target bitcoind -j$(nproc) && rm -rf datadir && mkdir -p datadir && \\\r\n(timeout 100 build/bin/bitcoind -regtest -datadir=\"$PWD/datadir\" -listen=0 -dnsseed=0 -fixedseeds=0 -connect=0 -maxsigcachesize=16000 -dbcache=2048 -printtoconsole=0 || true) && \\\r\ngrep -En \"High swap usage detected|Using .*signature cache|Using .*script execution cache\" \"$PWD/datadir/regtest/debug.log\" || true; \\\r\ngit restore src/init.cpp\r\n```",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-02-17T13:24:35Z",
      "updated_at": "2026-02-22T22:23:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34606",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1630,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3308893519,
      "number": 34639,
      "title": "iwyu: Remove some `pragma: export` and other improvements",
      "body": "This PR is a prerequisite for https://github.com/bitcoin/bitcoin/pull/34448. It was split into a separate PR to limit the scope and minimize potential merge conflicts.\r\n\r\nThe first commit improves the accuracy of IWYU suggestions within our heavily templated code. Note that, for now, the `serialize.h` header itself is excluded from IWYU inspection because it lacks a corresponding source file.\r\n\r\nThe remaining commits follow the Developer Notes [guidance](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#using-iwyu):\r\n> Use `IWYU pragma: export` very sparingly, as this enforces transitive inclusion of headers and undermines the specific purpose of IWYU.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2026-02-20T17:54:01Z",
      "updated_at": "2026-02-22T19:22:39Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34639",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 738,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2755027588,
      "number": 33214,
      "title": "rpc: require integer verbosity; remove boolean 'verbose'",
      "body": "### Summary\r\n\r\nStandardize RPC verbosity to integers only and remove boolean handling for clarity, consistency, and future extensibility.\r\n\r\n### Rationale\r\n\r\n - **Legacy cleanup**: Boolean verbosity has been discouraged/deprecated in docs since 2017 and continues to create tech debt (special-case parsing, inconsistent tests, user confusion).\r\n- **Consistency**: Integers enable multi-level output without overloading a boolean.\r\n\r\n### User-visible changes\r\n- getblock, getrawtransaction, getorphantxs no longer accept booleans.\r\n- Passing true/false now errors with: Verbosity was boolean but only integer allowed.\r\n- Migration: false → 0, true → 1.\r\n\r\n### Code / Docs\r\n- ParseVerbosity(arg, default) now rejects booleans (removed allow_bool).\r\n- Call sites and functional tests updated to use integer levels. \r\n- Developer notes updated; release notes added.\r\n\r\n**Breaking change:** scripts/tools using boolean verbosity must switch to integers.",
      "state": "closed",
      "user": "fqlx",
      "created_at": "2025-08-19T02:56:36Z",
      "updated_at": "2026-02-22T19:21:55Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33214",
      "labels": [
        "RPC/REST/ZMQ",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 0,
        "text_length": 1005,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3307862328,
      "number": 34636,
      "title": "node: allocate index caches proportional to usage patterns",
      "body": "The current cache allocation for optional indexes (txindex, txospenderindex, blockfilterindex) uses a sequential total_cache / 8 approach where each index gets 1/8 of the remaining budget after the previous index has been allocated. This means the order in which indexes appear in the code silently determines how much cache each one gets.\r\n\r\n|Index|Current share of total|\r\n|---|---|\r\n|txindex\t|~12%|\r\n|txospenderindex|~11%|\r\n|blockfilterindex\t|~10%|\r\n\r\nThis is unintuitive, undocumented, and probably doesn't reflect actual usage patterns. This PR replaces the sequential 1/8 allocation with explicit percentages based on how the indexes are typically used. The current values are an educated guess, and subject to further benchmark and research of typical client usage patterns.\r\n\r\n|Index|Allocation|Rationale|\r\n|---|---|---|\r\n|txindex |10% |Serves getrawtransaction RPCs with mostly unique lookups across the entire blockchain: low cache reuse|\r\n|txospenderindex|5%|Serves gettxspendingprevout RPCs with very specific outpoint queries: likely the least repetitive access pattern|\r\n|blockfilterindex|15%|Serves BIP 157 light clients that repeatedly query the same recent blocks: highest cache benefit|\r\n\r\nThis is a continuation of  the related discussion: https://github.com/bitcoin/bitcoin/pull/24539#discussion_r2809088034 and https://github.com/bitcoin/bitcoin/pull/31483.\r\n\r\nFurther feedback and input is very much appreciated.",
      "state": "open",
      "user": "svanstaa",
      "created_at": "2026-02-20T13:14:11Z",
      "updated_at": "2026-02-22T17:30:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34636",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1493,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3235087967,
      "number": 34473,
      "title": "test: add Taproot support to script_builder",
      "body": "Make the script_builder used in unit tests compatible with Taproot by adding a PushSchnorrSig helper. Add a few tests that cover boundary values for Taproot SIGHASH flags in SignatureHashSchnorr (including values at and above 84, which were not covered by existing unit tests).\r\nThis slightly improves unit test coverage of SignatureHashSchnorr, as suggested in issue #23279.\r\nCurrent unit test coverage for src/script/interpreter.cpp can be seen here: https://maflcko.github.io/b-c-cov/test_bitcoin.coverage/src/script/interpreter.cpp.gcov.html\r\n\r\nWe also have Taproot tests in bip341_keypath_test_vectors, but extending those tests would require preparing a test data. Making script_builder Taproot-compatible is a simpler way to add edge-case tests for SignatureHashSchnorr and to add more Taproot unit tests later.",
      "state": "open",
      "user": "kannapoix",
      "created_at": "2026-02-02T06:30:56Z",
      "updated_at": "2026-02-24T10:57:11Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34473",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 862,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3209325275,
      "number": 34405,
      "title": "wallet: skip APS when no partial spend exists",
      "body": "Fixes #25150\n\nAPS (Avoid Partial Spends) runs a second coin selection pass to fully spend\nUTXOs sharing a scriptPubKey. This currently runs unconditionally, even when\nthe first selection has no partial spend. Running APS unnecessarily wastes\ncomputation and can produce a worse result when there was nothing to fix.\n\nDetect partial spends by comparing selected vs available UTXO counts per\nscriptPubKey, reusing available_coins. Skip APS if none found.\n\nTest updated to create partial spend scenarios so tracepoints fire.\n\n---\n\n*Supersedes #34362 which was corrupted by a shallow clone force-push.*",
      "state": "open",
      "user": "8144225309",
      "created_at": "2026-01-26T04:36:55Z",
      "updated_at": "2026-02-22T17:05:57Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34405",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 644,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 877751403,
      "number": 24539,
      "title": "Add a \"tx output spender\" index",
      "body": "This PR adds a new \"tx output spender\" index, which allows users to query which tx spent a given outpoint with the `gettxspendingprevout` RPC call that was added by https://github.com/bitcoin/bitcoin/pull/24408.\r\n\r\nSuch an index would be extremely useful for Lightning, and probably for most layer-2 protocols that rely on chains of unpublished transactions.\r\n\r\nUPDATE: this PR is ready for review and issues have been addressed:\r\n- using a watch-only wallet instead would not work if there is a significant number of outpoints to watch (see https://github.com/bitcoin/bitcoin/pull/24539#issuecomment-1276595646)\r\n- this PR does not require `-txindex` anymore\r\n\r\nWe use a composite key with 2 parts (suggested by romanz): hash(spent outpoint) and tx position, with an empty value. Average composite key size is 15 bytes.\r\n\r\nThe spending tx can optionally be returned by `gettxspendingprevout` (even it `-txindex is not set`).",
      "state": "closed",
      "user": "sstone",
      "created_at": "2022-03-11T19:32:41Z",
      "updated_at": "2026-02-22T12:28:16Z",
      "merged_at": "2026-02-20T08:27:26Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/24539",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 957,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3278487026,
      "number": 34578,
      "title": "depends: Update Qt to version 6.10.2",
      "body": "This PR updates the `qt` package in depends to the most recent version [6.10.2](https://www.qt.io/blog/qt-6.10.2-released).\r\n\r\nThe update includes many bugfixes that enable dropping some patches.\r\n\r\nAdditionally, [patches](https://github.com/bitcoin/bitcoin/issues/34569#issuecomment-3892793262) for compatibility with GCC 16 have been included.\r\n\r\nA [commit](https://github.com/bitcoin/bitcoin/pull/32709/changes/8f1b55d1d52fb6e44a6d2d34b506f7f309c89ad1) from https://github.com/bitcoin/bitcoin/pull/32709 is also included.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-02-12T22:40:52Z",
      "updated_at": "2026-02-22T12:14:28Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34578",
      "labels": [
        "Build system",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 561,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1780312050,
      "number": 29678,
      "title": "Bugfix: Correct first-run free space checks",
      "body": "It's not clear what `m_assumed_*_size` are actually set based on, but historically it was in GB, not GiB, and that's still used in the GUI which is more user-facing.\r\n\r\nCould just as easily change the GUI if GiB is preferred.",
      "state": "open",
      "user": "luke-jr",
      "created_at": "2024-03-19T16:36:10Z",
      "updated_at": "2026-02-22T09:05:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29678",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 269,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1799118469,
      "number": 29770,
      "title": "index: Check all necessary block data is available before starting to sync",
      "body": "Currently, we check that `BLOCK_HAVE_DATA` is available for all blocks an index needs to sync during startup. However, for `coinstatsindex` and `blockfilterindex` we also need the undo data for these blocks. If that data is missing in the blocks, we are currently still starting to sync each of these indices and then crash later when we encounter the missing data.\r\n\r\nThis PR adds explicit knowledge of which block data is needed for each index and then checks its availability during startup before initializing the sync process on them.\r\n\r\nThis also addresses a few open comments from #29668 in the last commit.",
      "state": "closed",
      "user": "fjahr",
      "created_at": "2024-03-30T22:55:19Z",
      "updated_at": "2026-02-22T08:52:44Z",
      "merged_at": "2026-02-20T23:59:07Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29770",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 689,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2203477250,
      "number": 31382,
      "title": "kernel: Flush in ChainstateManager destructor",
      "body": "This simplifies the shutdown code a bit and reduces the amount of extra logic required in kernel/bitcoinkernel.cpp to tear down the chainman.\r\n\r\nMoving the second flush out of the Shutdown function into the ChainstateManager destructor, should be safe since there should be no new events created after the first flush. Tweak the chainman tests to actually exercise this new tear down behaviour.\r\n\r\n---\r\n\r\nThis PR is part of the [libbitcoinkernel project](https://github.com/bitcoin/bitcoin/issues/27587)",
      "state": "closed",
      "user": "sedited",
      "created_at": "2024-11-27T13:18:50Z",
      "updated_at": "2026-02-22T06:43:58Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31382",
      "labels": [
        "Validation",
        "Up for grabs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 549,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2272618048,
      "number": 31644,
      "title": "leveldb: show non-default options during init",
      "body": "To help with to debugging and traceability (in alignment with displaying other non-default args such as `Command-line arg: dbcache=\"10000\"`) we can extend the LevelDB opening log with an additional debug message for the used non-default settings.\r\n\r\nTo avoid showing booleans as e.g. `create_if_missing=1`, I've added a local `ToString` lambda for `bool`.\r\nI wanted to use `util::Join` at the end, but couldn't find any way that I liked.\r\n\r\nExample output after the change:\r\n```bash\r\n2025-10-15T02:39:45Z Opened LevelDB successfully\r\n2025-10-15T02:39:45Z [leveldb] startup options: options.compression=NoCompression, options.create_if_missing=true, options.max_file_size=33554432, options.paranoid_checks=true, options.write_buffer_size=524288, readoptions.fill_cache=false, readoptions.verify_checksums=true, writeoptions.sync=true\r\n```",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2025-01-12T17:30:54Z",
      "updated_at": "2026-02-22T05:56:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31644",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 883,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2349932670,
      "number": 31929,
      "title": "http: Make server shutdown more robust",
      "body": "- Log HTTP request pointers to be able to discover which one is stuck.\r\n- Instead of hanging indefinitely, use timeouts and abort when HTTP connections take unreasonably long to close.\r\n- Ensure we always free libevent HTTP.\r\n\r\nShould help debug #31894.",
      "state": "closed",
      "user": "hodlinator",
      "created_at": "2025-02-21T15:32:53Z",
      "updated_at": "2026-02-22T04:24:11Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31929",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 292,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2466171613,
      "number": 32297,
      "title": "bitcoin-cli: Add -ipcconnect option",
      "body": "This implements an idea from sipa in https://github.com/bitcoin/bitcoin/issues/28722#issuecomment-2807026958 to allow `bitcoin-cli` to connect to the node via IPC instead of TCP, if the ENABLE_IPC cmake option is enabled and the node has been started with `-ipcbind`.\r\n\r\nThis feature can be tested with:\r\n\r\n```\r\nbuild/bin/bitcoin-node -regtest -ipcbind=unix -debug=ipc\r\nbuild/bin/bitcoin-cli -regtest -ipcconnect=unix -getinfo\r\n```\r\n\r\nThe -ipconnect parameter can also be omitted, since this change also makes `bitcoin-cli` prefer IPC over HTTP by default, and falling back to HTTP if an IPC connection can't be established.\r\n\r\n---\r\n\r\nThis PR is part of the [process separation project](https://github.com/bitcoin/bitcoin/issues/28722).",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2025-04-17T13:55:32Z",
      "updated_at": "2026-02-22T03:01:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32297",
      "labels": [
        "RPC/REST/ZMQ",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 772,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2640910930,
      "number": 32875,
      "title": "index: handle case where pindex_prev equals chain tip in NextSyncBlock()",
      "body": "# Background\r\nNextSyncBlock() is used in BaseIndex::Sync() to get the next block index to be synced, so that BaseIndex::Sync() can build the index for that block.\r\nhttps://github.com/bitcoin/bitcoin/blob/1d3243806da6db8bd13e6b20906628ed434362b6/src/index/base.cpp#L150-L151\r\n\r\nIt normally calls chain.Next(pindex_prev) to get the next block index on the active chain. If that fails, pindex_prev is on a fork. In that case, chain.FindFork(pindex_prev) is called to return the fork point, and then chain.Next(fork point) is returned for the caller to handle.\r\nThe latter logic is referred to as the fork code below.\r\n\r\n# Issue:\r\nThe current master implementation of NextSyncBlock() handles a specific case implicitly in the fork code.\r\n\r\nThe special case is pindex_prev == chain tip (simplified as the special case below). This means the input block is already the tip of the active chain, and there is no next block to be indexed anymore. Thus, NextSyncBlock() should return nullptr. This expectation is also implied in BaseIndex::Sync():\r\nhttps://github.com/bitcoin/bitcoin/blob/1d3243806da6db8bd13e6b20906628ed434362b6/src/index/base.cpp#L220-L221\r\n\r\nAlthough NextSyncBlock() does return nullptr in this case, it is handled in a confusing code flow:\r\nhttps://github.com/bitcoin/bitcoin/blob/1d3243806da6db8bd13e6b20906628ed434362b6/src/index/base.cpp#L150-L166\r\n\r\ncalls line 158: chain.Next(pindex_prev) returns nullptr because the below code flow:\r\nhttps://github.com/bitcoin/bitcoin/blob/1d3243806da6db8bd13e6b20906628ed434362b6/src/chain.h#L417-L423\r\n\r\ncalls line 419: chain.Contains():\r\nhttps://github.com/bitcoin/bitcoin/blob/1d3243806da6db8bd13e6b20906628ed434362b6/src/chain.h#L411-L414\r\n\r\ncalls line 405:\r\nhttps://github.com/bitcoin/bitcoin/blob/1d3243806da6db8bd13e6b20906628ed434362b6/src/chain.h#L403-L408\r\n\r\nThus in `NextSyncBlock` line 159, because pindex is nullptr, it finally falls into the fork code.\r\nit is handled only coincidentally by the fork code:\r\nhttps://github.com/bitcoin/bitcoin/blob/1d3243806da6db8bd13e6b20906628ed434362b6/src/index/base.cpp#L163-L165\r\n\r\nin this code, FindFork() is called,\r\nhttps://github.com/bitcoin/bitcoin/blob/1d3243806da6db8bd13e6b20906628ed434362b6/src/chain.cpp#L50-L59\r\nand because pindex is the active chain tip, the `while` loop on line 56 is not iterated. It finally returns pindex itself.\r\nSo at last `chain.Next(pindex_prev)` is called again to return nullptr.\r\n\r\nHowever, the fork code is designed to handle reorgs, not this special case. This seems to be an oversight rather than something by design.\r\n\r\n# How to test it\r\n\r\nBecause `NextSyncBlock()` returns nullptr in the special case anyway, some debug code like `assert()` or `std::cout` or log sematics has to be added into this method to see the code flow in this method. The caller can be this unit test:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/1d3243806da6db8bd13e6b20906628ed434362b6/src/test/txindex_tests.cpp#L16-L33\r\n\r\nLine 32 calls `Sync()` and it calls `NextSyncBlock()` \r\n\r\n# Solution:\r\nRather than modifying the comments on lines 163–164 to make them consistent with the fork code behavior, it would be better to handle this special case explicitly and early in NextSyncBlock().\r\n",
      "state": "open",
      "user": "HowHsu",
      "created_at": "2025-07-04T10:03:17Z",
      "updated_at": "2026-02-21T22:31:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32875",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3285,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2809021284,
      "number": 33343,
      "title": "help: enrich help text for `-loadblock`",
      "body": "`-loadblock` doesn't support XOR-ed files, mention it in its help text to avoid troubles for users.",
      "state": "open",
      "user": "HowHsu",
      "created_at": "2025-09-08T17:41:11Z",
      "updated_at": "2026-02-21T17:45:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33343",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 139,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3133212525,
      "number": 34165,
      "title": "coins: don't mutate main cache when connecting block",
      "body": "This is a slightly modified version of the first few commits of #31132, which can be merged as an independent change. It has a small benefit on its own, but will help in moving the parent PR forward.\r\n\r\nWhen accessing coins via the `CCoinsViewCache`, methods like `GetCoin` can call `FetchCoin` which actually mutate `cacheCoins` internally to cache entries when they are pulled from the backing db. This is generally a performance improvement for single threaded access patterns, but it precludes us from accessing entries in a `CCoinsViewCache` from multiple threads without a lock.\r\n\r\nAnother aspect is that when we use the resettable `CCoinsViewCache` view backed by the main cache for use in `ConnectBlock()`, we will insert entries into the main cache even if the block is determined to be invalid. This is not the biggest concern, since an invalid block requires proof-of-work. But, an attacker could craft multiple invalid blocks to fill the main cache. This would make us `Flush` the cache more often than necessary. Obviously this would be very expensive to do on mainnet.\r\n\r\nIntroduce `CoinsViewOverlay`, a `CCoinsViewCache` subclass that reads coins without mutating the underlying cache via `FetchCoin()`.\r\n\r\nAdd `PeekCoin()` to look up a Coin through a stack of `CCoinsViewCache` layers without populating parent caches. This prevents the main cache from caching inputs pulled from disk for a block that has not yet been fully validated. Once `Flush()` is called on the view, these inputs will be added as spent to `coinsCache` in the main cache via `BatchWrite()`.\r\n\r\nThis is the foundation for async input fetching, where worker threads must not mutate shared state.\r\n",
      "state": "closed",
      "user": "andrewtoth",
      "created_at": "2025-12-28T20:32:34Z",
      "updated_at": "2026-02-21T16:08:12Z",
      "merged_at": "2026-02-20T03:10:53Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34165",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1737,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2858375622,
      "number": 33477,
      "title": "Rollback for dumptxoutset without invalidating blocks",
      "body": "This is an alternative approach to implement `dumptxoutset` with rollback that was discussed a few times. It does not rely on `invalidateblock` and `reconsiderblock` and instead creates a temporary copy of the coins DB, modifies this copy by rolling back as many blocks as necessary and then creating the dump from this temp copy DB. See also https://github.com/bitcoin/bitcoin/pull/29553#issuecomment-1978480989, https://github.com/bitcoin/bitcoin/issues/32817#issuecomment-3012406102 and #29565 discussions.\r\n\r\nThe nice side-effects of this are that forks can not interfere with the rollback and network activity does not have to be suspended. But there are also some downsides when comparing to the current approach: this does require some additional disk space for the copied coins DB and performance is slower (master took 3m 17s vs 9m 16s in my last test with the code here, rolling back ~1500 blocks). However, there is also not much code being added here, network can stay active throughout and performance would stay constant with this approach while it would impact master if there were forks that needed to be invalidated as well (see #33444 for the alternative approach), so this could still be considered a good trade-off.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2025-09-24T21:15:11Z",
      "updated_at": "2026-02-21T15:50:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33477",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1289,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2925411752,
      "number": 33646,
      "title": "log: check fclose() results and report safely in logging.cpp",
      "body": "`fclose()` can report write errors (for example if the disk is full or the filesystem has a problem). Right now, some `fclose()` calls in `src/logging.cpp` ignore the return value. This means errors might go unnoticed and log lines could be lost without warning.\r\n\r\n## What this PR does:\r\n- Add a small helper that prints `fclose()` errors to `stderr` (with path and errno).\r\n- In shutdown: close `m_fileout` safely and report errors.\r\n- In reopen: open the new file, swap it in, close the old one, and report errors if closing fails.\r\n- In shrink/rotate: check all `fclose(file)` calls and report failures.\r\n\r\nNo other behavior changes. Normal logging, rotation, and console output remain unchanged.",
      "state": "open",
      "user": "cedwies",
      "created_at": "2025-10-17T19:06:08Z",
      "updated_at": "2026-02-21T13:49:51Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33646",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 761,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2965956843,
      "number": 33752,
      "title": "rest: Query predecessor headers using negative count param",
      "body": "There is currently no mechanism by which to batch-query headers from tip, backwards towards genesis.\r\nThis PR extends the REST Blockheaders API to support batch-querying predecessor headers, by providing a negative count parameter.",
      "state": "open",
      "user": "A-Manning",
      "created_at": "2025-10-31T09:11:11Z",
      "updated_at": "2026-02-21T12:29:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33752",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 290,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2982459951,
      "number": 33796,
      "title": "kernel: Expose `CheckTransaction` consensus validation function",
      "body": "This PR exposes the consensus-level `CheckTransaction` function through the libbitcoinkernel C API and adds a corresponding C++ wrapper.\r\n\r\nCurrently, libkernel only provided script-level validation via `btck_script_pubkey_verify` and `ScriptPubkeyApi<>::Verify`. \r\n\r\nAFAIK there was no way to perform context-free consensus checks on a transaction’s structure (e.g., coinbase rules, money-range, duplicate inputs).\r\n\r\nThis change introduces a new API:\r\n\r\n```c\r\nint btck_check_transaction(const btck_Transaction* tx, btck_TxValidationState** out_state);\r\n```\r\n\r\nand a C++ convenience wrapper:\r\n\r\n```cpp\r\nstd::pair<bool, TxValidationState> btck::CheckTransaction(const Transaction& tx);\r\n```\r\n\r\nBoth follow the ownership and error-handling conventions established in `bitcoinkernel.h`.\r\n\r\nThe test suite is extended with cases covering:\r\n* coinbase scriptSig length bounds\r\n* empty vin / vout detection\r\n* negative or out-of-range output values\r\n* duplicate inputs\r\n* null prevouts in non-coinbase transactions\r\n\r\n",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2025-11-05T23:59:50Z",
      "updated_at": "2026-02-21T11:28:23Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33796",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1077,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3124280596,
      "number": 34141,
      "title": "miniscript: Use Func and Expr when parsing keys, hashes, and locktimes",
      "body": "The miniscript parser currently only looks for the next `)` when parsing key, hash, and locktime expressions. This fails to parse when the expressions contain a nested expression. Currently, this is only possible with `musig()` inside of key expressions. However, this pattern can be generalized to handling hashes and locktimes, so I implemented those too.\r\n\r\nFixes #34076",
      "state": "closed",
      "user": "achow101",
      "created_at": "2025-12-22T21:36:58Z",
      "updated_at": "2026-02-21T11:19:05Z",
      "merged_at": "2026-02-21T11:19:04Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34141",
      "labels": [
        "Descriptors"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 444,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2999254279,
      "number": 33854,
      "title": "fix assumevalid is ignored during reindex",
      "body": "During a reindex, the assumevalid setting may be ignored if the chainwork of the best header is below `minimumchainwork`. This happens when the previous IBD was stopped before connecting enough blocks to reach the required `minimumchainwork`. The assumevalid block will also be missing from the block index because the assumevalid block is set to match the `minimumchainwork`. See [Issue #31494](https://github.com/bitcoin/bitcoin/issues/31494).\r\n\r\nAs a result, `reindex` can take significantly longer to complete than necessary.\r\n\r\nThis PR addresses the issue by modifying reindex behaviour: if the chainwork of the `best_header` is below `minimumchainwork`, the node skips the `ActivateBestChain()` step and proceeds directly to synchronisation.\r\n\r\nThis PR takes a different approach from [PR #31615](https://github.com/bitcoin/bitcoin/pull/31615) to keep the validation path for `reindex` the same as the regular IBD validation path.\r\n\r\nDevelopers benchmarking IBD with `-reindex` may find this behaviour undesirable. In such cases, it’s recommended to use `-reindex-chainstate` instead or ensure that the available blocks have sufficient chainwork.\r\n\r\n`libbitcoinkernel` exposes the `ImportBlocks` function and expects `reindex` to connect blocks, so an attempt was made to preserve the existing behaviour for `libbitcoinkernel`.",
      "state": "open",
      "user": "Eunovo",
      "created_at": "2025-11-11T14:21:14Z",
      "updated_at": "2026-02-21T10:43:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33854",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1375,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3031948596,
      "number": 33920,
      "title": "Export embedded ASMap RPC",
      "body": "This depends on the embedded data PR itself (#28792), until merge this will remain in draft status. All commit but the last one are from there.\r\n\r\nThere has been interest in exporting the embedded data back into a file. This is implemented here with a simple `exportasmap` RPC which provides this functionality. The exported file can be used to verify the data integrity or statistical analysis using e.g. `contrib/asmap-tool.py`.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2025-11-20T23:53:36Z",
      "updated_at": "2026-02-21T09:28:30Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33920",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 456,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3184839812,
      "number": 34329,
      "title": "rpc,net: Add private broadcast RPCs",
      "body": "Follow up from #29415 \r\n\r\nSending a transaction via private broadcast does not have any way for a user to track the status of the transaction before it gets returned by another peer. The default logs have been removed as well in #34267. Nor is there any way to abort a transaction once it has been added to the private broadcast queue.\r\n\r\nThis adds two new RPCs:\r\n- `getprivatebroadastinfo` returns information about what transactions are in the private broadcast queue, including all the peers' addresses we have chosen and timestamps.\r\n- `abortprivatebroadcast` stops broadcasting a transaction in the private broadcast queue.",
      "state": "closed",
      "user": "andrewtoth",
      "created_at": "2026-01-18T01:46:20Z",
      "updated_at": "2026-02-21T05:58:29Z",
      "merged_at": "2026-02-19T21:42:21Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34329",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 664,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3132300728,
      "number": 34158,
      "title": "torcontrol: Remove libevent usage",
      "body": "This is part of the effort to remove the libevent dependency from our code base: https://github.com/bitcoin/bitcoin/issues/31194\r\n\r\nThe current approach tries to reuse existing code and follows roughly similar design decisions. It replaces the libevent-based async I/O with blocking I/O utilizing the existing `Sock` and `CThreadInterrupt`. The controller runs in a dedicated thread.\r\n\r\nThere are some optional code modernizations thrown in made along the way (namings, constexpr etc.). These are not strictly necessary but make the end result with the new code more consistent.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2025-12-27T14:20:31Z",
      "updated_at": "2026-02-21T04:55:24Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34158",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 612,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3253567659,
      "number": 34523,
      "title": "doc: Clarify why performance-move-const-arg.CheckTriviallyCopyableMove=false",
      "body": "Without this doc, there is a risk that the setting will be turned off, see https://github.com/bitcoin/bitcoin/pull/34514.\r\n\r\nThe reason to disable it is to catch logic bugs, even on trivially copyable types:\r\n\r\n```cpp\r\n#include <utility>\r\nvoid Eat(int&& food) { food = 0; };\r\nint main() {\r\n  int food{2};\r\n  Eat(std::move(food));\r\n  Eat(std::move(food));  // This should err\r\n}\r\n```",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-02-06T07:49:13Z",
      "updated_at": "2026-02-21T04:53:50Z",
      "merged_at": "2026-02-09T13:54:02Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34523",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 459,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3300832556,
      "number": 34619,
      "title": "sqlite: Delete wallet.dat-journal on database close",
      "body": "The wallet.dat-journal file is SQLite's hot journal file. This file is either deleted, truncated, or has its header zeroed when a database transaction is committed. However, in `restorewallet`, we are assuming that sqlite decided to delete the journal file even though it may have truncated or zeroed its header instead.\r\n\r\nThis PR changes `SQLiteDatabase::Close()` to remove the journal file if it is 0 bytes, or if the header (first 28 bytes) is all 0's. Otherwise, it leaves the file untouched.\r\n\r\nThis fixes one of the issues described in #34354\r\n\r\nAn alternative is to have `RestoreWallet` specifically also delete the journal file. However, I thought that this solution would be more robust as I think there are other places where we expect the journal file to be deleted on a clean close of a wallet database.",
      "state": "closed",
      "user": "achow101",
      "created_at": "2026-02-18T23:58:50Z",
      "updated_at": "2026-02-21T04:20:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34619",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 868,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3149207404,
      "number": 34208,
      "title": "bench: add fluent API for untimed `setup` steps in nanobench",
      "body": "### Context\r\nAs described in https://github.com/martinus/nanobench/issues/130, we have a few benchmarks where we have to reset the state between runs, otherwise the repetitions will do something else than the first iteration.\r\n\r\n### Upstream\r\nI have opened a PR to `nanobench` to introduce an untimed setup phase, see: https://github.com/martinus/nanobench/pull/136\r\nUnfortunately the author has health issues and couldn't contribute to it in the past 2 years.\r\n\r\n### Tests\r\n\r\nTests were only added upstream, would be a bit awkward to wire in `nanobench.h` outside the benchmarking setup:\r\nhttps://github.com/martinus/nanobench/pull/136/changes/58350cfe5912d7e0533ccfcd759eea5d62eb55bb#diff-88160f647ce57661afe7d755fa70a5fa342a2b79d72d3511596878e69ed5cdc3\r\n\r\n### Fix\r\nI have moved the changes here as well and applied it to a few simple benchmarks as demonstration.\r\nWe can revert ones that are controversial and add other ones in follow-ups, this PR is mostly meant to add the `setup` feature.\r\n\r\n### Benchmarks\r\nMost benchmarks show a modest \"speedup\", others a \"slowdown\" - but it's only the effect of the setup that's not measured anymore - and a `run` phase which does the same operation in each epoch iteration (wallet benchmark changes were reverted since for simplicity):\r\n<img width=\"1496\" height=\"882\" alt=\"image\" src=\"https://github.com/user-attachments/assets/34c14565-f3df-41e5-9a86-95b2ca21703a\" />\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-06T11:45:35Z",
      "updated_at": "2026-02-21T03:50:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34208",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1475,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3054115118,
      "number": 33965,
      "title": "mining: fix -blockreservedweight shadows IPC option",
      "body": "Also enforce `MINIMUM_BLOCK_RESERVED_WEIGHT` for IPC clients.\r\n\r\nThe `-blockreservedweight` startup option should only affect RPC code, because IPC clients (currently) do not have a way to signal their intent to use the node default (the `BlockCreateOptions` struct defaults merely document a recommendation for client software).\r\n\r\nBefore this PR however, if the user set `-blockreservedweight` then `ApplyArgsManOptions` would cause the `block_reserved_weight` option passed by IPC clients to be ignored. _Users who don't set this value were not affected._\r\n\r\nFix this by making BlockCreateOptions::block_reserved_weight an std::optional.\r\n\r\nInternal interface users, such as the RPC call sites, don't set a value so -blockreservedweight is used. Whereas IPC clients do set a value which is no longer ignored.\r\n\r\nTest coverage is added, with a preliminary commit that refactors the `create_block_template` and `wait_next_template` helpers.\r\n\r\n`mining_basic.py` already ensured `-blockreservedweight` is enforced by mining RPC methods. The second commit adds coverage for Mining interface IPC clients. It also verifies that `-blockreservedweight` has no effect on them.\r\n\r\nThe third commit enforces `MINIMUM_BLOCK_RESERVED_WEIGHT` for IPC clients. Previously lower values were quietly clamped.\r\n\r\n---\r\n\r\nMerge order preference: #34452 should ideally go first.",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2025-11-28T13:38:33Z",
      "updated_at": "2026-02-20T22:51:54Z",
      "merged_at": "2026-02-12T02:22:38Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33965",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1412,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3220693682,
      "number": 34436,
      "title": "refactor: add overflow-safe `CeilDiv` helper and use it in unsigned callsites",
      "body": "### Problem\r\nThe codebase has many open-coded ceiling-division expressions (for example `(x+y-1)/y`) scattered across files.\r\nThese are less readable, duplicate logic, and can be overflow-prone in edge cases.\r\n\r\n### Fix\r\nIntroduce a small overflow-safe integer helper, `CeilDiv()`, and use it in existing **unsigned** callsites where the conversion is straightforward and noise-free.\r\n\r\n### What this PR does\r\n* Adds `CeilDiv()` to `src/util/overflow.h` for unsigned integral inputs.\r\n* Keeps the precondition check `assert(divisor > 0)`.\r\n* Replaces selected unsigned ceiling-division expressions with `CeilDiv(...)`.\r\n* Adds focused unit tests in `src/test/util_tests.cpp` for the migrated patterns.\r\n\r\n---\r\n\r\nThis is a pure refactor with no intended behavioral change.\r\nSigned arithmetic callsites are intentionally left unchanged in this PR.\r\nThis PR changed a few more things originally but based on feedback reverted to the simplest cases only.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-28T21:47:06Z",
      "updated_at": "2026-02-20T21:16:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34436",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1028,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2496293029,
      "number": 32409,
      "title": "test: Introduce `SUPPRESS_ABORT_MESSAGE` environment variable",
      "body": "This PR adds a way to suppress the abort message box when running `test_bitcoin.exe` and `fuzz.exe` built with the debug runtime library on Windows.\r\n\r\nOtherwise, a failing `assert()` triggers the `abort` routine, which displays a message box and causes a timeout in CI.\r\n\r\nHere are CI jobs for the \"Debug\" configuration:\r\n - on the master branch: https://github.com/maflcko/bitcoin-core-with-ci/actions/runs/14759346479/job/41435857332\r\n - with this PR: https://github.com/hebasto/bitcoin-core-nightly/actions/runs/15038743417/job/42265371841\r\n\r\nAddresses this [comment](https://github.com/bitcoin/bitcoin/issues/32341#issuecomment-2842716175).\r\n\r\nAccording to Microsoft's [docs](https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/abort), this behavior is MSCV-specific.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-05-02T19:45:20Z",
      "updated_at": "2026-02-20T20:00:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32409",
      "labels": [
        "Windows",
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 848,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3294159200,
      "number": 34605,
      "title": "build: define CMAKE_COMPILE_WARNING_AS_ERROR as a cache option",
      "body": "`CMAKE_COMPILE_WARNING_AS_ERROR` is not a cache variable by default in CMake, so it has no value in the configure summary when not set, and even when set cannot be toggled in `ccmake`. Define it as an `option()` to make it a cache BOOL with a default of OFF.\r\n\r\nFrom the original MR to cmake, this was deliberately not set as a cache variable: https://gitlab.kitware.com/cmake/cmake/-/merge_requests/7187 (see Brad King's reply to the collapsed comments from Marc Chevrier).\r\n\r\nMost `CMAKE_*` variables which are expected to be toggled by users are (as far as I can research) cache variables by default. Those that are considered likely to be set by the project (e.g. `CMAKE_CXX_STANDARD` or `CMAKE_POSITION_INDEPENDENT_CODE`) are not, along with read-only variables, script/internal variables, platform sppecific variables, template variables. `CMAKE_COMPILE_WARNING_AS_ERROR` may be a slight outlier here.\r\n\r\nI count ~ 600 documented CMAKE_* variables, of which ~ 60 are default cache variables.\r\n\r\nI could only see a few of these like:\r\n\r\n  - CMAKE_COMPILE_WARNING_AS_ERROR\r\n  - CMAKE_CXX_STANDARD,\r\n  - CMAKE_POSITION_INDEPENDENT_CODE\r\n  - CMAKE_INTERPROCEDURAL_OPTIMIZATION\r\n  \r\n ...that we (or any project) _might_ want to expose as user-togglable, and would have to add as an `option()` in CMakeLists.txt.",
      "state": "closed",
      "user": "willcl-ark",
      "created_at": "2026-02-17T12:28:37Z",
      "updated_at": "2026-02-20T19:15:41Z",
      "merged_at": "2026-02-20T19:15:41Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34605",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1375,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3239243501,
      "number": 34489,
      "title": "index: batch db writes during initial sync",
      "body": "Decouples part of #26966.\r\n\r\nRight now, index initial sync writes to disk for every block, which is not the best for HDD. This change batches those, so disk writes are less frequent during initial sync. This also cuts down `cs_main` contention by reducing the number of `NextBlockSync` calls (instead of calling it for every block, we will call it once per block window), making the node more responsive (IBD and validation) while indexes sync up. On top of that, it lays the groundwork for the bigger speedups, since part of the parallelization pre-work is already in place.\r\n\r\nJust as a small summary:\r\n\r\n* Batch DB writes instead of flushing per block, which improves sync time on HDD due to the reduced number of disk write operations.\r\n* Reduce `cs_main` lock contention, which improves the overall node responsiveness (and primarily IBD) while the indexes threads are syncing.\r\n* Lays the groundwork for the real speedups, since part of #26966 parallelization pre-work is introduced here as well.\r\n* Reduces the number of generated LDB files. See l0rinc's [comment](https://github.com/bitcoin/bitcoin/pull/34489#issuecomment-3876972773).\r\n\r\nNote:\r\nPending initial sync benchmark and further testing. I have only focused on decoupling and simplifying what was in #26966 first. Commits should be simple to digest.",
      "state": "open",
      "user": "furszy",
      "created_at": "2026-02-03T04:06:34Z",
      "updated_at": "2026-02-20T18:15:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34489",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1360,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3250214855,
      "number": 34514,
      "title": "refactor: remove unnecessary std::move for trivially copyable types",
      "body": "Inspired by https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2751764873.\r\n\r\n### Problem\r\nA few function signatures in the codebase use rvalue references for trivially copyable types, forcing callers to `std::move()` values where there is no benefit - for trivially copyable types, moving is semantically identical to copying (see https://godbolt.org/z/hdrn17v9b).\r\n\r\nAdditionally, some call sites use `std::move()` on plain enums and primitive types where it is basically just noise.\r\n\r\nNote: `CheckTriviallyCopyableMove` remains `false` - `std::move()` on trivially copyable types is still permitted where it serves as intent documentation (e.g. signaling that a value should not be reused after a call).\r\n\r\n### Fix\r\n* Document why `CheckTriviallyCopyableMove` is kept disabled (to preserve `bugprone-use-after-move` coverage on trivially copyable types where `std::move` signals intent), cherry-picked from #34523\r\n* Change `EmplaceCoinInternalDANGER` to take `const COutPoint&` instead of `COutPoint&&`\r\n* Change logging functions to take `const SourceLocation&` instead of `SourceLocation&&`\r\n* Remove `std::move()` on enum types in RPC constructors and on `bool`/`int` members in `txgraph.cpp`",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-02-05T13:27:48Z",
      "updated_at": "2026-02-20T16:59:35Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34514",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1275,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3173584131,
      "number": 34284,
      "title": "ipc, test: Add tests for unclean disconnect and thread busy behavior",
      "body": "Upcoming libmultiprocess changes are expected to alter this behavior (https://github.com/bitcoin/bitcoin/issues/34250#issuecomment-3749243782), making test coverage useful for documenting current behavior and validating the intended changes.",
      "state": "closed",
      "user": "ryanofsky",
      "created_at": "2026-01-14T13:46:24Z",
      "updated_at": "2026-02-20T16:48:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34284",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 310,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3277895355,
      "number": 34577,
      "title": "http: fix submission during shutdown race",
      "body": "Fixes #34573.\r\n\r\nAs mentioned in https://github.com/bitcoin/bitcoin/issues/34573#issuecomment-3891596958, the ThreadPool PR (#33689) revealed an existing issue.\r\n\r\nBefore that PR, we were returning an incorrect error \"Request rejected because http work queue depth exceeded\" during shutdown for unhandled requests (we were not differentiating between \"queue depth exceeded\" and \"server interrupted\" errors). Now, with the ThreadPool inclusion, we return the proper error but we don't handle it properly.\r\n\r\nThis PR improves exactly that. Handling the missing error and properly returning it to the user.\r\n\r\nThe race can be reproduced as follows:\r\n\r\n1) The server receives an http request.\r\n2) Processing of the request is delayed, and shutdown is triggered in the meantime.\r\n3) During shutdown, the libevent callback is unregistered and the threadpool interrupted.\r\n4) The delayed request (step 2) resumes and tries to submit a task to the now-interrupted server.\r\n\r\nReproduction test can be found https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3902672521.\r\n\r\nAlso, to prevent this kind of issue from happening again, this PR changes task submission\r\nto return the error as part of the function's return value using `util::Expected` instead of\r\nthrowing the exception. Unlike exceptions, which require extra try-catch blocks and can be\r\nignored, returning `Expected` forces callers to explicitly handle failures, and attributes\r\nlike `[[nodiscard]]` allow us catch unhandled ones at compile time.\r\n\r\n",
      "state": "closed",
      "user": "furszy",
      "created_at": "2026-02-12T19:52:35Z",
      "updated_at": "2026-02-20T15:25:07Z",
      "merged_at": "2026-02-19T20:41:24Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34577",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1554,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3303456310,
      "number": 34625,
      "title": "cluster_linearize: add tests and benchmarks for chain and tree-shaped clusters",
      "body": "                                                                                 \r\n## Summary                                                                       \r\n                                                                                 \r\nThis PR adds correctness tests and benchmarks specifically targeting chain and tree-shaped\r\ncluster topologies, which are both common in real-world mempools and structurally special\r\nwith respect to `PostLinearize`.                                                 \r\n                                                                                 \r\n**Commits:**                                                                     \r\n- `a11760f9` cluster_linearize: add chain cluster benchmarks for PostLinearize and Linearize\r\n- `4b7e2b28` cluster_linearize: test PostLinearize optimality on random tree-shaped clusters\r\n- `0725aa05` cluster_linearize: test PostLinearize optimality on random chain clusters\r\n                                                                                 \r\n---                                                                              \r\n                                                                                 \r\n## Motivation                                                                    \r\n                                                                                 \r\n`PostLinearize` gives an optimality guarantee for clusters with a **tree shape**: if every\r\ntransaction has at most one direct parent, or every transaction has at most one direct child,\r\nthe result is provably optimal. A chain (tx_0 → tx_1 → ... → tx_{N-1}) satisfies *both*\r\nconditions simultaneously.                                                       \r\n                                                                                 \r\nThese structural guarantees lacked dedicated test coverage and chain-specific benchmarks,\r\nmaking it hard to observe the effect of topology-aware optimizations on linearization\r\nperformance.                                                                     \r\n                                                                                 \r\n---                                                                              \r\n                                                                                 \r\n## Changes                                                                       \r\n                                                                                 \r\n### Tests (`src/test/cluster_linearize_tests.cpp`)                               \r\n                                                                                 \r\n#### `postlinearize_tree_optimal_tests`                                          \r\n                                                                                 \r\nAdds `MakeRandomTreeGraph()`, which generates random tree-shaped dependency graphs in two\r\norientations:                                                                    \r\n                                                                                 \r\n- **Upright tree**: transaction i picks a random parent from [0, i), so every node has at\r\n  most one direct parent.                                                        \r\n- **Reverse tree**: transaction i picks a random child from [0, i), so every node has at\r\n  most one direct child.                                                         \r\n                                                                                 \r\nFor random trees of sizes 5..30, the test verifies:                              \r\n1. `PostLinearize` produces a linearization of equal quality to the exhaustive `Linearize()`\r\n   result (as guaranteed by `PostLinearize`'s interface for tree-shaped inputs). \r\n2. **Idempotency**: a second `PostLinearize` pass produces no change.            \r\n                                                                                 \r\n#### `postlinearize_chain_optimal_tests`                                         \r\n                                                                                 \r\nAdds `MakeRandomChainGraph()`, which generates random linear chain dependency graphs\r\n(tx_0 → tx_1 → ... → tx_{N-1}) with randomized feerates.                         \r\n                                                                                 \r\nFor chains of sizes 5..50, the test verifies:                                    \r\n1. `PostLinearize` produces a linearization of equal quality to the exhaustive `Linearize()`\r\n   result. A chain satisfies both tree-shape conditions simultaneously, so optimality is\r\n   guaranteed.                                                                   \r\n2. **Idempotency**: a second `PostLinearize` pass produces no change.            \r\n                                                                                 \r\n### Benchmarks (`src/bench/cluster_linearize.cpp`)                               \r\n                                                                                 \r\nAdds `MakeChainGraph()` to build deterministic random chain dependency graphs    \r\n(tx_0 → tx_1 → ... → tx_{N-1}) with randomized feerates seeded deterministically from the\r\ncluster size, and two sets of chain-specific benchmarks:                         \r\n                                                                                 \r\n- **`PostLinearizeChain{16,32,48,64,75,99}Tx`**: measure `PostLinearize` throughput on\r\n  chain-shaped clusters across a range of sizes.                                 \r\n- **`LinearizeOptimallyChainTotal_{9,16,32,48,63}tx`**: measure the total time for\r\n  `Linearize` to reach an optimal result on chain-shaped clusters.               \r\n                                                                                 \r\nChain clusters are a common real-world mempool pattern (each transaction spending an output\r\nof the previous one). Dedicated benchmarks make it easy to observe the effect of \r\ntopology-specific linearization optimizations as they are developed.             \r\n",
      "state": "open",
      "user": "HowHsu",
      "created_at": "2026-02-19T14:55:09Z",
      "updated_at": "2026-02-20T14:28:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34625",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 6134,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3273035746,
      "number": 34565,
      "title": "refactor: extract BlockDownloadManager from PeerManagerImpl",
      "body": "### Motivation\r\n\r\n`net_processing.cpp` is the largest file in the codebase (~6200 lines) and `PeerManagerImpl` mixes several largely independent subsystems into a single class: transaction relay, address gossip, headers sync, compactblocks, and block download. This makes the file difficult to review, test in isolation, and reason about lock ordering.\r\n\r\n #30110 successfully extracted transaction download logic into `TxDownloadManager`. This PR applies the same approach to block download, continuing the incremental decomposition of `PeerManagerImpl`.\r\n \r\n### What this PR does\r\n\r\nExtract all block download state and scheduling logic into a new `BlockDownloadManager` module:\r\n\r\n**Global state moved** (from `PeerManagerImpl`): `mapBlocksInFlight`, `mapBlockSource`, `nSyncStarted`, `m_block_stalling_timeout`, `m_last_tip_update`, `m_num_preferred_download_peers`, `m_peers_downloading_from`.\r\n\r\n**Per-peer state moved** (from `CNodeState`): `pindexBestKnownBlock`, `hashLastUnknownBlock`, `pindexLastCommonBlock`, `pindexBestHeaderSent`, `fSyncStarted`, `vBlocksInFlight`, `m_downloading_since`, `m_stalling_since`, `fPreferredDownload`.\r\n\r\n**Methods moved** (from `PeerManagerImpl`): `FindNextBlocksToDownload`, `TryDownloadingHistoricalBlocks`, `ProcessBlockAvailability`, `UpdateBlockAvailability`, `BlockRequested`, `RemoveBlockRequest`, `IsBlockRequested`, `IsBlockRequestedFromOutbound`, `TipMayBeStale`.\r\n\r\n### The result:\r\n* `net_processing.cpp` shrinks from 6193 to 5751 lines (−442 net)\r\n* `CNodeState` loses 10 fields, retaining only compact block relay and chain sync timeout state\r\n* Block download logic becomes unit-testable in isolation (8 test cases added)\r\n\r\n### Design\r\n\r\nFollows the `TxDownloadManager` pimpl pattern:\r\n* `blockdownloadman.h` — public interface\r\n* `blockdownloadman_impl.h` — implementation class with per-peer state\r\n* `blockdownloadman_impl.cpp` — implementation\r\n\r\n Unlike `TxDownloadManager`, no new mutex is introduced. Block download is inherently tied to chain state through `CBlockIndex*` pointers, so `cs_main` remains the synchronizing lock. The extraction is for code organization and testability, not lock granularity.\r\n \r\n ### Commits\r\n\r\n1. **Add BlockDownloadManager class with pimpl skeleton**: all new module files, no call sites changed\r\n2. **Add unit tests**: exercises the module in isolation\r\n3. **Migrate call sites**: ~150 call sites in `net_processing.cpp` rewired through `m_blockdownloadman`, pure mechanical replacement",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2026-02-11T18:54:52Z",
      "updated_at": "2026-02-20T13:40:49Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34565",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2548,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1717651443,
      "number": 29409,
      "title": "multiprocess: Add capnp wrapper for Chain interface",
      "body": "Changes making it possible to call `interface::Chain` over a socket.\r\n\r\nNote: The changes in this PR allow a `bitcoin-node` process to be controlled over a socket. The socket can either be an UNIX socket created by specifying the `-ipcbind` option, or it can be a socketpair created by a controlling process and passed to `bitcoin-node` via the `-ipcfd=<n>` with a file descriptor number. This PR is a dependency of #10102 which allows the wallet code to run in a separate process and use the `Chain` interface.\r\n\r\n---\r\n\r\nThis PR is part of the [process separation project](https://github.com/bitcoin/bitcoin/issues/28722).",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-02-08T13:54:40Z",
      "updated_at": "2026-02-20T11:24:41Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29409",
      "labels": [
        "Needs rebase",
        "interfaces"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 675,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3275774710,
      "number": 34572,
      "title": "cmake: Fix NetBSD-specific workaround for Boost",
      "body": "The recently merged https://github.com/bitcoin/bitcoin/pull/34143 broke builds with depends on NetBSD due to a workaround introduced in 5a5ddbd78922236402df378c8588a7b0b3f83a13.\r\n\r\nThe upstream [bug](https://gnats.netbsd.org/59856) has been fixed, and the entire workaround can be removed once the fixed Boost package becomes generally available.\r\n\r\nHowever, it seems prudent to amend the workaround now to have it workable in the 31.0 release.\r\n\r\nHere are CI runs:\r\n- broken: https://github.com/hebasto/bitcoin-core-nightly/actions/runs/21933683654\r\n- fixed: https://github.com/hebasto/bitcoin-core-nightly/actions/runs/21933683654",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-02-12T11:27:01Z",
      "updated_at": "2026-02-20T11:13:50Z",
      "merged_at": "2026-02-20T11:13:10Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34572",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 680,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3174906348,
      "number": 34293,
      "title": "Bugfix: net_processing: Restore missing comma between peer and peeraddr in \"receive version message\" and \"New ___ peer connected\"",
      "body": "Versions prior to 29.x all included a comma here, and the general format of the message still includes commas between all other fields\r\n",
      "state": "open",
      "user": "luke-jr",
      "created_at": "2026-01-14T20:34:00Z",
      "updated_at": "2026-02-20T11:07:30Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34293",
      "labels": [
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 266,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3267434865,
      "number": 34549,
      "title": "net: reduce log level for PCP/NAT-PMP NOT_AUTHORIZED failures",
      "body": "Cherry-picks (and tweaks) a commit from #34117 which the ANAVHEOBA\r\ndid not follow up with when changes were requested.\r\n\r\nThe tweak here is to log once at `LogWarning`, so that users have a chance\r\nto spot misconfiguration.\r\n\r\n----\r\n\r\nUsers running on home networks with routers that don't support PCP (Port\r\nControl Protocol) or NAT-PMP port mapping receive frequent warning-level\r\nlog messages every few minutes:\r\n\r\n  \"pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\"\r\n\r\nThis is expected behavior for many consumer routers that have PCP\r\ndisabled by default, not an actionable error.\r\n\r\nAdd explicit constants for the NOT_AUTHORIZED result code (value 2)\r\nfor both NAT-PMP and PCP protocols. Log the first NOT_AUTHORIZED\r\nfailure at warning level for visibility, then downgrade subsequent\r\noccurrences to LogDebug to avoid log noise. Other failure types\r\ncontinue to warn unconditionally.\r\n\r\nFixes #34114\r\n",
      "state": "closed",
      "user": "willcl-ark",
      "created_at": "2026-02-10T14:12:45Z",
      "updated_at": "2026-02-20T09:45:42Z",
      "merged_at": "2026-02-20T00:58:08Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34549",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 979,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3195778555,
      "number": 34370,
      "title": "[29.x] Fix #34222 backport bugs",
      "body": "",
      "state": "closed",
      "user": "luke-jr",
      "created_at": "2026-01-21T15:47:10Z",
      "updated_at": "2026-02-20T09:35:13Z",
      "merged_at": "2026-01-29T16:48:51Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34370",
      "labels": [
        "Wallet",
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 32,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3306847677,
      "number": 34633,
      "title": "Revert \"ci: Treat SHA1 LLVM signing key as warning\"",
      "body": "`git revert 3c8f5e48f710313de78bcbfafd09fed71890d754`\r\n\r\nThis is now fixed [upstream](https://github.com/llvm/llvm-project/issues/153385).",
      "state": "closed",
      "user": "willcl-ark",
      "created_at": "2026-02-20T08:47:53Z",
      "updated_at": "2026-02-20T09:32:54Z",
      "merged_at": "2026-02-20T09:32:54Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34633",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 190,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2173924864,
      "number": 31275,
      "title": "doc: corrected lockunspent rpc quoting",
      "body": "bitcoin-cli help lockunspent RPC example shows:\r\n\r\n```\r\nAs a JSON-RPC call\r\n> curl --user myusername --data-binary '{\"jsonrpc\": \"1.0\", \"id\": \"curltest\", \"method\": \"lockunspent\", \"params\": [false, \"[{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\",\\\"vout\\\":1}]\"]}' -H 'content-type: text/plain;' http://127.0.0.1:8332/\r\n```\r\nIncluding quotes around the transactions argument. Using the RPC in this way fails:\r\n\r\n```\r\ncurl --data-binary '{\"jsonrpc\": \"1.0\", \"id\": \"curltest\", \"method\": \"lockunspent\", \"params\": [false, \"[{\\\"txid\\\":\\\"6f244af8e2162138369fc736a673f85ead59ad88fb5a1edd6e03f81b33c537b0\\\",\\\"vout\\\":1}]\"]}' -H 'content-type: text/plain;' http://127.0.0.1:18443/wallet/locktest\r\n\r\n{\"result\":null,\"error\":{\"code\":-3,\"message\":\"Expected type array, got string\"},\"id\":\"curltest\"}\r\n```\r\n\r\nThis change corrects the documentation to remove the additional quotes so the example works as intended:\r\n\r\n```\r\ncurl --data-binary '{\"jsonrpc\": \"1.0\", \"id\": \"curltest\", \"method\": \"lockunspent\", \"params\": [false, [{\"txid\":\"6f244af8e2162138369fc736a673f85ead59ad88fb5a1edd6e03f81b33c537b0\",\"vout\":0}]]}' -H 'content-type: text/plain;' http://127.0.0.1:18443/wallet/locktest\r\n\r\n{\"result\":true,\"error\":null,\"id\":\"curltest\"}\r\n```",
      "state": "open",
      "user": "Talej",
      "created_at": "2024-11-12T02:44:48Z",
      "updated_at": "2026-02-20T08:55:39Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31275",
      "labels": [
        "Docs",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1285,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3275524332,
      "number": 34571,
      "title": "test: Fix intermittent issues in feature_assumevalid.py",
      "body": "The test has many issues:\r\n\r\n* The `send_blocks_until_disconnected` seems to imply to wait until a disconnect happens. However, in reality it will blindly send all blocks and then return early, when done or when a disconnect happens. This will cause test failures when python is running faster than Bitcoin Core, for example when using sanitizers.\r\n* The `assert_debug_log` scopes are bloated, which makes finding the above issue harder. This is, because a test failure will basically print the 1000+ line debug log excerpt twice, with the second instance stripped of useful python test logs. Also, the checks are less precise, if they happen over a larger scope/snippet.\r\n\r\nFix all issues, by:\r\n\r\n* Removing `send_blocks_until_disconnected` and just sending the blocks that are needed to get the disconnect and then explicitly waiting for the disconnect.\r\n* Reduce the scopes of the debug log checks. This can be reviewed with the git options `--color-moved=dimmed-zebra --color-moved-ws=ignore-all-space`.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-02-12T10:29:24Z",
      "updated_at": "2026-02-20T08:00:47Z",
      "merged_at": "2026-02-20T00:52:39Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34571",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1063,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2934151848,
      "number": 33671,
      "title": "wallet: Add separate balance info for non-mempool wallet txs",
      "body": "Changes `getbalances` to report the sum of txos spent by transactions that aren't confirmed nor in the mempool (eg due to being part of too long a mempool chain, or spending non-standard outputs, or having a datacarrier output that exceeds `-datacarriersize`, etc). Those values are added to the trusted/untrusted_pending/immature/used fields as appropriate (where previously they were skipped), and subtracted from the new nonmempool field, so that the sum of all fields remains the same.\r\n\r\nFor example:\r\n\r\n```\r\n$ bitcoin-cli -regtest getbalances\r\n{\r\n  \"mine\": {\r\n    \"trusted\": 6049.99999220,\r\n    \"untrusted_pending\": 0.00000000,\r\n    \"immature\": 3200.00000780,\r\n    \"nonmempool\": -100.00000000\r\n  },\r\n  \"lastprocessedblock\": {\r\n    \"hash\": \"3ab4582226d5e8ad76438db48d76e822c31bce2cdbc7ba82a5d974a277515d0d\",\r\n    \"height\": 221\r\n  }\r\n}\r\n```\r\n\r\nCloses #11887",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2025-10-21T16:59:13Z",
      "updated_at": "2026-02-20T07:58:56Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33671",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 922,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3306634028,
      "number": 34630,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "Kushmanmb",
      "created_at": "2026-02-20T07:45:34Z",
      "updated_at": "2026-02-20T07:51:55Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34630",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1487286408,
      "number": 28333,
      "title": "wallet: Construct ScriptPubKeyMans with all data rather than loaded progressively",
      "body": "Instead of constructing ScriptPubKeyMans with no data, and then loading data as we find it, we should gather everything first and then load it all on construction. If there actually is no data and we want to setup generation, then that should also occur in a constructor rather than afterwards.\r\n\r\nThis change is only applied to DescriptorScriptPubKeyMan and ExternalSignerScriptPubKeyMan, and should be done for any ScriptPubKeyMans added in the future. I don't think it's really worth it to do this for LegacyScriptPubKeyMan since it would make loading performance worse (or cause layer violations) and it's (supposed to be) going away soon.",
      "state": "open",
      "user": "achow101",
      "created_at": "2023-08-24T02:55:39Z",
      "updated_at": "2026-02-20T00:06:55Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28333",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 725,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1587218477,
      "number": 28792,
      "title": "build: Embedded ASMap [3/3]: Build binary dump header file",
      "body": "This is the final in a series of PRs that implement the necessary changes for embedding of asmap data into the binary. This last part add the initial asmap data, implements the build changes and adds further documentation.\r\n\r\nCurrently an asmap file needs to be acquired by there user from some location or the user needs to generate one themselves. Then they need to move the file to the right place in datadir or pass the path to the file as `-asmap=PATH` in order to use the asmap feature. The change here allows for builds to embed asmap data into the bitcoind binary which makes it possible to use the feature without handling of the asmap file by the user. If the user starts bitcoind with `-asmap` the embedded data will be used for bucketing of nodes.\r\n\r\nThe data lives in the repository at `src/node/data/ip_asn.dat` and can be replaced with a new version at any time. The idea is that the data should be updated with every release. By default the data at that location is embedded into the binary but there is also a build option to prevent this (`-DWITH_EMBEDDED_ASMAP=OFF`). In this case the original behavior of the `-asmap` option is maintained.",
      "state": "closed",
      "user": "fjahr",
      "created_at": "2023-11-04T22:13:31Z",
      "updated_at": "2026-02-20T00:01:17Z",
      "merged_at": "2026-02-19T00:43:44Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28792",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1218,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1785565107,
      "number": 29700,
      "title": "kernel, refactor: return error status on all fatal errors",
      "body": "Return util::Result objects from all functions that can trigger fatal errors.\n\nThere are many validation functions that handle failures by calling `AbortNode` and triggering shutdowns, without returning error information to their callers. This makes error handling in libbitcoinkernel application code difficult, because the only way to handle these errors is to register for [notification callbacks](https://github.com/bitcoin/bitcoin/blob/master/src/kernel/notifications_interface.h). Improve this by making all functions that trigger fatal errors return util::Result objects with the error information.\n\nThis PR is a pure refactoring that returns extra result information from functions without changing their behavior. It's a possible alternative to and subset of #29642, which adds similar return information but also makes behavior changes and exposes a FatalError type.\n\n---\n\n<!-- begin based-on -->\n**This is based on #25665.** The non-base commits are:\n\n- [`513065d8e05` refactor, kernel: Add FlushStatus / FlushResult types](https://github.com/bitcoin/bitcoin/pull/29700/commits/513065d8e0536737806e7b64bd22caf35e9c9562)\n- [`1aca9a06118` refactor: Add InfoType field to util::Result](https://github.com/bitcoin/bitcoin/pull/29700/commits/1aca9a06118e98977639cc202fe85fb55688b8bd)\n- [`eab17e5853d` refactor, blockstorage: Return FlushResult from flush methods](https://github.com/bitcoin/bitcoin/pull/29700/commits/eab17e5853d5c1ba7559b9d8f04ddce17b54bc48)\n- [`0597c54a4bf` refactor, blockstorage: Return fatal errors from block writes](https://github.com/bitcoin/bitcoin/pull/29700/commits/0597c54a4bfd2b3de177847295eef5fe1ff487a4)\n- [`924c14e8f0b` refactor, validation: Switch to result.Update](https://github.com/bitcoin/bitcoin/pull/29700/commits/924c14e8f0b8e134e43da55a28d0d563c0ce0098)\n- [`e5b6d454453` refactor, blockstorage: Return fatal error from LoadBlockIndex](https://github.com/bitcoin/bitcoin/pull/29700/commits/e5b6d45445359ee275bdf7d402d2a86567a43329)\n- [`9f89c918697` refactor, validation: Return fatal errors from FlushStateToDisk](https://github.com/bitcoin/bitcoin/pull/29700/commits/9f89c91869779f98dcfa1ee0baf8cb01985a8fe7)\n- [`3ccd6282fb4` refactor, validation: Return fatal errors from mempool accept functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/3ccd6282fb48d734a7d4b09d5088e27e573a53e3)\n- [`5a10b1aaa47` refactor, validation: Return fatal errors from assumeutxo snapshot functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/5a10b1aaa47ff7c1adc640f6ae413a8856a1c0bd)\n- [`dcd3c7058ca` refactor, validation: Return fatal errors from block connect functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/dcd3c7058caa71ee1cd42aec26fccbc1422f6eb8)\n- [`64bcb99af8e` refactor, validation: Return fatal errors from activate best chain functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/64bcb99af8e77cae057c129513e466082d0db5fd)\n- [`d8ea4c652a2` refactor, validation: Return fatal errors from new block functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/d8ea4c652a278a30fb417a1d572660850a0d743d)\n- [`07267be89ca` refactor, blockstorage: Return fatal error from ImportBlocks](https://github.com/bitcoin/bitcoin/pull/29700/commits/07267be89cae97d86c0bff65d23e3f30092eec97)\n- [`54b8f6e808f` refactor, validation: Return more errors from VerifyDB](https://github.com/bitcoin/bitcoin/pull/29700/commits/54b8f6e808f95a75b38c34727495b5e9dcfb40a8)\n- [`09cbe90fa5c` ci: Avoid -Wno-error=maybe-uninitialized false positives](https://github.com/bitcoin/bitcoin/pull/29700/commits/09cbe90fa5c05e56d43895948d0d4f2b771cff9f)<!-- end -->",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-03-21T23:11:56Z",
      "updated_at": "2026-02-19T23:22:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29700",
      "labels": [
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3675,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2679273445,
      "number": 33018,
      "title": "coins: remove SetFresh method from CCoinsCacheEntry",
      "body": "There is plenty of test code that exercises the code path for FRESH-but-not-DIRTY coins in CCoinsViewCache. However, we can see there is only one place in production code where we call `SetFresh` that is not preceded by `SetDirty`. This is in `CCoinsViewCache::FetchCoin` and we can see that this is called if the coin retrieved from `base->GetCoin` is spent. The `base` in this case can be another `CCoinsViewCache` or a `CCoinsViewDB`. In `CCoinsViewCache::GetCoin` we can see that we do not return spent coins, and in `CCoinsViewDB` we don't ever store spent coins so there are none to return.\r\n\r\nThus, we can safely remove this dead code, and now we can see that there are never any calls to `SetFresh` not preceded by `SetDirty`. This PR removes this dead code and replaces `SetFresh` by passing a `fresh` boolean flag to `SetDirty`. This simplifies the logic of `CCoinsViewCache` and lets us remove test cases checking for FRESH-but-not-DIRTY coins. It removes the possibility of FRESH-but-not-DIRTY coins being called from any code path, so we can eliminate this state entirely and reduce the cognitive load of having to consider it.\r\n\r\nThis is pulled out from https://github.com/bitcoin/bitcoin/pull/30673 to make the change simpler.",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2025-07-19T19:21:35Z",
      "updated_at": "2026-02-19T23:16:55Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33018",
      "labels": [
        "UTXO Db and Indexes",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1293,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3182466003,
      "number": 34322,
      "title": "node: Persist private broadcast transactions over node restarts",
      "body": "Follow-up from #29415 \r\n\r\nCurrently private broadcast transactions are stored in peer manager and do not persist over restarts. A submitted transaction can be lost if the node restarts before it is privately broadcast.\r\n\r\nThis change dumps the set of private broadcast transactions to a `privatebroadcast.dat` file on shutdown, and adds the transactions back to the private broadcast data structure on restart.",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2026-01-16T19:37:05Z",
      "updated_at": "2026-02-19T23:08:15Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34322",
      "labels": [
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 474,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2417478258,
      "number": 32138,
      "title": "wallet, rpc: remove settxfee and paytxfee",
      "body": "**Summary**\r\n\r\nThis PR removes the settxfee RPC and paytxfee setting (Bitcoin Core 31.0).\r\nThese two features were deprecated in https://github.com/bitcoin/bitcoin/pull/31278.",
      "state": "closed",
      "user": "polespinasa",
      "created_at": "2025-03-25T18:30:56Z",
      "updated_at": "2026-02-19T21:44:38Z",
      "merged_at": "2026-02-19T00:36:29Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32138",
      "labels": [
        "Wallet",
        "RPC/REST/ZMQ",
        "Needs release note"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 217,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1841534940,
      "number": 29963,
      "title": "depends: Do not consider `CC` environment variable for detecting system",
      "body": "On the master branch @ 3c88eac28e8984893746caebb313dc3b2fca90db, consider the following commands in the `depends` subdirectory:\r\n```sh\r\n$ make print-build HOST=i686-pc-linux-gnu CC=\"clang -m32\"\r\nbuild=x86_64-pc-linux-gnu\r\n$ make print-host HOST=i686-pc-linux-gnu CC=\"clang -m32\"\r\nhost=i686-pc-linux-gnu\r\n```\r\nThe printed variable values are expected.\r\n\r\nHowever, switching the `CC` variable context from Makefile to the shell environment breaks expectations:\r\n```sh\r\n$ CC=\"clang -m32\" make print-build HOST=i686-pc-linux-gnu\r\nbuild=i686-pc-linux-gnu\r\n$ CC=\"clang -m32\" make print-host HOST=i686-pc-linux-gnu\r\nhost=i686-pc-linux-gnu\r\n```\r\n\r\nThis PR fixes this issue.\r\n\r\n#### UPDATE 2026-01-20\r\n\r\nOn the master branch @ 7f5ebef56a0f2bad7df30252b11da3e33cb3c144:\r\n```\r\n$ gmake print-build HOST=i686-pc-linux-gnu CC=\"clang -m32\"\r\nbuild=i686-pc-linux-gnu\r\n$ gmake print-host HOST=i686-pc-linux-gnu CC=\"clang -m32\"\r\nhost=i686-pc-linux-gnu\r\n```",
      "state": "open",
      "user": "hebasto",
      "created_at": "2024-04-25T19:01:29Z",
      "updated_at": "2026-02-19T21:32:11Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29963",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1009,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2876629729,
      "number": 33512,
      "title": "coins: use dirty entry count for flush warnings and disk space checks",
      "body": "### Problem\r\nNow that non-wiping flushes are possible (#28280, #28233), the cache may be mostly clean at flush time.\r\nBut the flush warning, disk-space check, and benchmark logging still used total cache size, so a node with a 10 GiB cache that only needs to write a small fraction of dirty entries could still trigger a scary warning via the disk-space checks.\r\n\r\nThe previous `DynamicMemoryUsage` metric was also fundamentally wrong for estimating disk writes, even before non-wiping flushes. In-memory coin size differs from on-disk write size due to LevelDB overhead, log doubling, and compaction.\r\n\r\nThe warning also only fired in `FlushStateToDisk`, so `AssumeUTXO` snapshot loads never warned at all.\r\n\r\n### Fix\r\n\r\nThis PR tracks the actual number of dirty entries via `m_dirty_count` in `CCoinsViewCache`, maintained alongside the existing dirty-flag linked list, `SanityCheck` cross-validating both counts.\r\n\r\nThe warning and benchmark log move from `FlushStateToDisk` down to `CCoinsViewDB::BatchWrite`, where the actual I/O happens. This is the single place all flush paths converge (regular flushes, syncs, and snapshot loads), so the warning now fires correctly for `AssumeUTXO` too.\r\nThe threshold changes from 1 GiB of memory to 10 million dirty entries, which is roughly equivalent but avoids the in-memory vs on-disk size confusion.\r\n\r\nThe disk-space safety check now uses `GetDirtyCount()` with the existing conservative 48-byte-per-entry estimate, preventing unnecessary shutdowns when the cache is large but mostly clean.\r\n\r\n---\r\n\r\nNote: the first commit adds fuzz coverage for `EmplaceCoinInternalDANGER` in `SimulationTest` to exercise the accounting paths before modifying them.\r\nNote: this is a revival of #31703 with all outstanding review feedback addressed.",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2025-10-01T02:24:51Z",
      "updated_at": "2026-02-19T21:19:06Z",
      "merged_at": "2026-02-19T21:19:06Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33512",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1854,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2748998057,
      "number": 33199,
      "title": "fees: enable `CBlockPolicyEstimator` return sub 1 sat/vb fee rate estimates",
      "body": "This is a simple PR that updates the block policy estimator’s `MIN_BUCKET_FEERATE` constant to be 100, which is identical to the policy `DEFAULT_MIN_RELAY_TX_FEE`. \r\n\r\nThis change enables the block policy fee rate estimator to return sub-1 sat/vB fee rate estimates.\r\n\r\nThe change is correct because the estimator creates buckets of fee rates from\r\n`MIN_BUCKET_FEERATE`,\r\n`MIN_BUCKET_FEERATE` + `FEE_SPACING`,\r\n`MIN_BUCKET_FEERATE` + `2 * FEE_SPACING`,\r\n… up to `MAX_BUCKET_FEERATE`.\r\n\r\nThis means it will record sub-1 sat/vB fee rates in the buckets and may return them as a fee rate estimate when that bucket is the lowest one with sufficient transactions for a given target.\r\n\r\n---\r\n\r\nWhile touching this part of the fee estimator code, this PR got rid of the dummy value persisted in the file",
      "state": "closed",
      "user": "ismaelsadeeq",
      "created_at": "2025-08-15T15:15:26Z",
      "updated_at": "2026-02-19T21:09:38Z",
      "merged_at": "2026-02-19T19:41:51Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33199",
      "labels": [
        "TX fees and policy"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 872,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3250989124,
      "number": 34517,
      "title": "drop my key from trusted-keys",
      "body": "As planned!\r\n\r\nAlso bump trusted-git-root to 88a7294356e75bbaa136c9427c64e239f7c6fd40, which is the last merge signed with this key.\r\n\r\nEDIT: I didn’t plan to write a \"statement\" but I keep getting asked to comment:\r\n\r\nI was added as a maintainer ~3.5 years ago in recognition that mempool needed extra attention and work. It is a sensitive area of the codebase with painful tradeoffs and attracted stop energy from many angles. With package relay, TRUC + other policy features, cluster mempool, and a number of other projects shipping, I’m happy with what we’ve achieved for L2 security and mining decentralization. Here is a natural stopping point for a mempool maintainer.\r\n\r\nOver the last decade, Bitcoin Core has seen dozens of brigaded mempool policy PRs (covered to varying degrees by media). I've had the privilege of authoring, reviewing, moderating and/or merging the vast majority of them in the last 4 years and each one has strengthened the project's resistance to harassment. I cannot say the same for myself and my family, but it is an **honor** to receive so much personal recognition for my impact on Bitcoin Core's decision-making process and p2p code.\r\n\r\nI have deep respect for the skill of capturing people’s attentions/emotions. But the choice between integrity and engagement has always been an obvious one to me, and a privilege to be able to make as a maintainer of this project.",
      "state": "closed",
      "user": "glozow",
      "created_at": "2026-02-05T16:29:34Z",
      "updated_at": "2026-02-19T20:46:16Z",
      "merged_at": "2026-02-05T18:06:59Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34517",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1434,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2486358825,
      "number": 32367,
      "title": "cmake: Check user-defined `APPEND_*FLAGS` variables early",
      "body": "For the purpose of checks performed by the build system, we strive to handle user-defined `APPEND_*FLAGS` in the same way as flags provided by other standard means. In particular, they are considered when the `try_compile()` command is used.\r\n\r\nHowever, these flags are not considered during `enable_language()` command invocation due to design limitations, which might cause issues, such as https://github.com/bitcoin/bitcoin/issues/32323.\r\n\r\nThis PR addresses the issue by introducing an additional compiler check that does consider the user-defined `APPEND_*FLAGS`.\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/32323:\r\n```\r\n$ cmake -B build -DAPPEND_CXXFLAGS=\"-ftrivial-auto-var-init\"\r\n-- The CXX compiler identification is GNU 14.2.0\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Check for working CXX compiler: /usr/bin/c++ - skipped\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\n-- Performing Test CXX_COMPILER_WORKS\r\n-- Performing Test CXX_COMPILER_WORKS - Failed\r\nCMake Error at cmake/module/EnableLanguage.cmake:42 (message):\r\n  The CXX compiler is not able to compile a simple test program.\r\n\r\n  Check that the \"APPEND_*FLAGS\" variables are set correctly.\r\n\r\n\r\n\r\nCall Stack (most recent call first):\r\n  CMakeLists.txt:71 (bitcoincore_enable_language)\r\n\r\n\r\n-- Configuring incomplete, errors occurred!\r\nhebasto@TS-P340:~/dev/bitcoin$ cmake -B build -DAPPEND_CXXFLAGS=\"-ftrivial-auto-var-init=zero\"\r\n-- Performing Test CXX_COMPILER_WORKS\r\n-- Performing Test CXX_COMPILER_WORKS - Success\r\n...\r\n```",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-04-28T16:35:27Z",
      "updated_at": "2026-02-19T20:34:35Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32367",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1636,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3249875645,
      "number": 34512,
      "title": "rpc: add coinbase_tx field to getblock",
      "body": "This adds a `coinbase_tx` field to the `getblock` RPC result, starting at verbosity level 1. It contains only fields guaranteed to be small, i.e. not the outputs.\r\n\r\nInitial motivation for this was to more efficiently scan for BIP54 compliance. Without this change, it requires verbosity level 2 to get the coinbase, which makes such scan very slow. See https://github.com/bitcoin-inquisition/bitcoin/pull/99#issuecomment-3852370506.\r\n\r\nAdding these fields should be useful in general though and hardly makes the verbosity 1 result longer.\r\n\r\n```\r\nbitcoin rpc help getblock\r\n\r\ngetblock \"blockhash\" ( verbosity )\r\n\r\nIf verbosity is 0, returns a string that is serialized, hex-encoded data for block 'hash'.\r\nIf verbosity is 1, returns an Object with information about block <hash>.\r\nIf verbosity is 2, returns an Object with information about block <hash> and information about each transaction.\r\n...\r\nResult (for verbosity = 1):\r\n{                                 (json object)\r\n  \"hash\" : \"hex\",                 (string) the block hash (same as provided)\r\n  \"confirmations\" : n,            (numeric) The number of confirmations, or -1 if the block is not on the main chain\r\n  \"size\" : n,                     (numeric) The block size\r\n  \"strippedsize\" : n,             (numeric) The block size excluding witness data\r\n  \"weight\" : n,                   (numeric) The block weight as defined in BIP 141\r\n  \"coinbase_tx\" : {               (json object) Coinbase transaction metadata\r\n    \"version\" : n,                (numeric) The coinbase transaction version\r\n    \"locktime\" : n,               (numeric) The coinbase transaction's locktime (nLockTime)\r\n    \"sequence\" : n,               (numeric) The coinbase input's sequence number (nSequence)\r\n    \"coinbase\" : \"hex\",         (string) The coinbase input's script\r\n    \"witness\" : \"hex\"             (string, optional) The coinbase input's first (and only) witness stack element, if present\r\n  },\r\n  \"height\" : n,                   (numeric) The block height or index\r\n  \"version\" : n,                  (numeric) The block version\r\n...\r\n```\r\n\r\n```\r\nbitcoin rpc getblock 000000000000000000013c986f9aebe800a78454c835ccd07ecae2650bfad3f6 1\r\n```\r\n\r\n```json\r\n{\r\n  \"hash\": \"000000000000000000013c986f9aebe800a78454c835ccd07ecae2650bfad3f6\",\r\n  \"confirmations\": 2,\r\n  \"height\": 935113,\r\n  \"version\": 561807360,\r\n  \"...\": \"...\",\r\n  \"weight\": 3993624,\r\n  \"coinbase_tx\": {\r\n    \"version\": 2,\r\n    \"locktime\": 0,\r\n    \"sequence\": 4294967295,\r\n    \"coinbase\": \"03c9440e04307c84692f466f756e6472792055534120506f6f6c202364726f70676f6c642ffabe6d6d9a8624235259d3680c972b0dd42fa3fe1c45c5e5ae5a96fe10c182bda17080e70100000000000000184b17d3f138020000000000\",\r\n    \"witness\": \"0000000000000000000000000000000000000000000000000000000000000000\"\r\n  },\r\n  \"tx\": [\r\n    \"70eb053340c7978c5aa1b34d75e1ba9f9d1879c09896317f306f30c243536b62\",\r\n    \"5bcf8ed2900cb70721e808b8977898e47f2c9001fcee83c3ccd29e51c7775dcd\",\r\n    \"3f1991771aef846d7bb379d2931cccc04e8421a630ec9f52d22449d028d2e7f4\",\r\n    \"...\"\r\n  ]\r\n}\r\n```\r\n",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2026-02-05T11:54:15Z",
      "updated_at": "2026-02-19T19:31:54Z",
      "merged_at": "2026-02-19T19:31:54Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34512",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 3071,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 304070624,
      "number": 16545,
      "title": "refactor: Implement missing error checking for ArgsManager flags",
      "body": "Trigger startup errors if bitcoin is configured with bad setting values according to flags. Also raise internal errors if settings are registered and retrieved with inconsistent flags.\n\nThis change has no effect on behavior because the new ArgsManager flags added here are not used outside of tests yet.\n\nIt'll probably be easier to start applying type checking flags to _new_ options than _existing_ options. But for examples of how type checking flags can make sense applied to existing options, see the new [example_options unit test](https://github.com/ryanofsky/bitcoin/blob/pr/argcheck/src/test/argsman_tests.cpp#L27) added in this PR.\n\n---\n\nFollowups:\n\n- Support for flag combinations is possible and is added in commit c919f51c044f0e80ecd301f9c9d396ddff2331ba ([branch](https://github.com/ryanofsky/bitcoin/commits/pr/argcomb))\n- ALLOW_LIST flags are added and enforced in [#17580](https://github.com/bitcoin/bitcoin/pull/17580)\n- Bad IsArgSet usages with ALLOW_LIST are removed in [#30529](https://github.com/bitcoin/bitcoin/pull/30529) and prevented in [#17783](https://github.com/bitcoin/bitcoin/pull/17783)\n- Confusing and ignored multiple assignments in config files are disallowed in [#17493](https://github.com/bitcoin/bitcoin/pull/17493)\n- Confusing reverse-precedence settings merging code is removed in [#17581](https://github.com/bitcoin/bitcoin/pull/17581)\n- Type flags added in this PR implement runtime part of a change to add more compile-time checking in [#22978](https://github.com/bitcoin/bitcoin/pull/22978)\n",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2019-08-04T14:13:12Z",
      "updated_at": "2026-02-19T18:31:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/16545",
      "labels": [
        "Utils/log/libs",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1600,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3298830305,
      "number": 34614,
      "title": "ci: Put space and non-ASCII char in scratch dir",
      "body": "It seems unlikely that many users have a space in their paths, but it seems a use-case worth enough to be tested by CI, so that it does not have to be done manually. Ref https://github.com/bitcoin/bitcoin/pull/33929#discussion_r2590523065\r\n\r\n\r\nSo do that here, and also add a non-ASCII char while touching.\r\n\r\nAlso, fix all tests that are broken and assume no space exists in paths.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-02-18T13:48:28Z",
      "updated_at": "2026-02-19T18:06:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34614",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 430,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3201168043,
      "number": 34385,
      "title": "subprocess: Fix `-Wunused-private-field` when building with clang-cl on Windows",
      "body": "This PR is a prerequisite for https://github.com/bitcoin/bitcoin/pull/31507.\r\n\r\nIt resolves `-Wunused-private-field` warnings triggered in `src/util/subprocess.h` when compiling with clang-cl on Windows:\r\n```\r\nD:\\a\\bitcoin\\bitcoin\\src\\util/subprocess.h(759,10): warning : private field 'parent_' is not used [-Wunused-private-field] [D:\\a\\bitcoin\\bitcoin\\build\\src\\util\\bitcoin_util.vcxproj]\r\nD:\\a\\bitcoin\\bitcoin\\src\\util/subprocess.h(760,7): warning : private field 'err_wr_pipe_' is not used [-Wunused-private-field] [D:\\a\\bitcoin\\bitcoin\\build\\src\\util\\bitcoin_util.vcxproj]\r\nD:\\a\\bitcoin\\bitcoin\\src\\util/subprocess.h(1038,7): warning : private field 'child_pid_' is not used [-Wunused-private-field] [D:\\a\\bitcoin\\bitcoin\\build\\src\\util\\bitcoin_util.vcxproj]\r\n```\r\n\r\nOnly the second commit has been [submitted](https://github.com/arun11299/cpp-subprocess/pull/127) upstream. The first commit is specific to this repository and not applicable upstream.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-01-22T22:26:40Z",
      "updated_at": "2026-02-19T17:08:31Z",
      "merged_at": "2026-02-19T17:05:57Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34385",
      "labels": [
        "Refactoring",
        "Windows"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1037,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3281186451,
      "number": 34582,
      "title": "rpc: Properly parse -rpcworkqueue/-rpcthreads",
      "body": "The integral arg parsing has many issues:\r\n\r\n* There is no way to parse an unsigned integral type at all\r\n* There is no way to parse an integral type of less width than int64_t\r\n* As a result, calling code splatters confusing c-style casts just to let the code compile. However, usually there are no range checks and proper range handling.\r\n\r\nFor example, when someone (maybe for testing) wants to set the rpc work queue to the maximum possible number, there is no easy way to do so without reading the source code and manually crafting the exact integer value. Using the \"9999 hack\" will silently set it to `-1` (!)\r\n\r\nTo test:\r\n\r\n`/bld-cmake/bin/bitcoin-qt -datadir=/tmp -regtest -rpcworkqueue=99999999999999999999999999 -printtoconsole=1 -server=1 -debug=http | grep 'set work queue of depth'`\r\n\r\nBefore:\r\n\r\n```\r\n[http] set work queue of depth -1\r\n```\r\n\r\nAfter:\r\n\r\n```\r\n[http] set work queue of depth 2147483647\r\n",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-02-13T14:40:20Z",
      "updated_at": "2026-02-19T17:08:12Z",
      "merged_at": "2026-02-19T16:45:17Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34582",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 962,
        "has_nack": false,
        "has_ack": true
      }
    }
  ],
  "issues": [
    {
      "id": 3990538250,
      "number": 34670,
      "title": "script_assets_tests is a no-op on Windows CI",
      "body": "Since Windows has been switched to using Python scripts /.github/ci-windows-cross.py and /.github/ci-windows.py, `DIR_UNIT_TEST_DATA` is not set and the script_assets_tests unit test is a no-op. (Not 100% sure if the right conditions where met for it to be set before the switch to Python).\n\nOther platforms set up the environment, provided qa-assets exist:\n\nhttps://github.com/bitcoin/bitcoin/blob/7c8030143925b3ed8ca74b9e616dca20d36c4440/ci/test/03_test_script.sh#L57-L63\n\nLog displaying issue: https://github.com/bitcoin/bitcoin/actions/runs/22304756945/job/64521461506?pr=31507#step:8:1042 - excerpt:\n```\n./test/script_p2sh_tests.cpp(58): Leaving test suite \"script_p2sh_tests\"; testing time: 24751us\n./test/script_assets_tests.cpp(30): Entering test suite \"script_assets_tests\"\n./test/script_assets_tests.cpp(149): Entering test case \"script_assets_test\"\n./test/script_assets_tests.cpp(156): warning: in \"script_assets_tests/script_assets_test\": Variable DIR_UNIT_TEST_DATA unset, skipping script_assets_test\nTest case script_assets_tests/script_assets_test did not check any assertions\n./test/script_assets_tests.cpp(149): Leaving test case \"script_assets_test\"; testing time: 2635us\n./test/script_assets_tests.cpp(30): Leaving test suite \"script_assets_tests\"; testing time: 2666us\n./test/scheduler_tests.cpp(16): Entering test suite \"scheduler_tests\"\n```\n---\n\nMaybe part of the bash script could be extracted to a shared Python module, not sure what the best solution is.\n\nDiscovered here: https://github.com/bitcoin/bitcoin/issues/34666#issuecomment-3959568125 cc @sedited @maflcko ",
      "state": "open",
      "user": "hodlinator",
      "created_at": "2026-02-25T16:46:08Z",
      "updated_at": "2026-02-26T09:57:03Z",
      "closed_at": null,
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/34670",
      "labels": [
        "Windows",
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1636,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3680657459,
      "number": 33982,
      "title": "build: `guix` package was removed from debian",
      "body": "Apparently the `guix` debian package was no longer maintained, and was removed from debian recently (see https://lwn.net/Articles/1035491/). Ubuntu and other debian derivatives will likely follow.\n\nThis means we need new setup instructions for guix on debian in `contrib/guix/INSTALL.md`.",
      "state": "closed",
      "user": "laanwj",
      "created_at": "2025-12-01T11:58:44Z",
      "updated_at": "2026-02-25T21:28:00Z",
      "closed_at": "2026-02-25T21:28:00Z",
      "comments": 10,
      "url": "https://github.com/bitcoin/bitcoin/issues/33982",
      "labels": [
        "Docs",
        "Build system"
      ],
      "comment_data": [
        {
          "id": 3961116775,
          "user": "achow101",
          "body": "Is there anything for us to do here for 31.0?",
          "created_at": "2026-02-25T18:16:45Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 45,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 334,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3896240331,
      "number": 34503,
      "title": "validation: CheckBlockIndex() const: Assertion `!c->setBlockIndexCandidates.contains(const_cast<CBlockIndex*>(pindex))` failed",
      "body": "[This](https://github.com/bitcoin/bitcoin/blob/eb3dbbaf30fc072fef78f57064abc744aa9c0516/src/validation.cpp#L5391) assertion in `CheckBlockIndex` may fail under certain block race and shutdown/restart conditions (see attached example log).\n\nThe root cause appears to be the modification of the `nSequenceId` field of `CBlockIndex` pointers, after they have been added to `setBlockIndexCandidates`. This is undefined behavior as the `CBlockIndexWorkComparator` compares `nSequenceId`s.\n\nSpecifically, [here](https://github.com/bitcoin/bitcoin/blob/eb3dbbaf30fc072fef78f57064abc744aa9c0516/src/validation.cpp#L4617-L4627) the tip's (and ancestor) sequence ids are changed while all the indices are in the candidates set already.\n\n[setBlockIndexCandidates_contains.log](https://github.com/user-attachments/files/25071337/setBlockIndexCandidates_contains.log)\n\n*This was found with a test running on [Antithesis](https://antithesis.com/).*",
      "state": "open",
      "user": "dergoegge",
      "created_at": "2026-02-04T12:11:16Z",
      "updated_at": "2026-02-25T20:40:33Z",
      "closed_at": null,
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/issues/34503",
      "labels": [
        "Bug",
        "Validation"
      ],
      "comment_data": [
        {
          "id": 3961930561,
          "user": "l0rinc",
          "body": "Just happened in https://github.com/bitcoin/bitcoin/actions/runs/22412561434/job/64889761007?pr=34641",
          "created_at": "2026-02-25T20:40:33Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 101,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1061,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3949157462,
      "number": 34601,
      "title": "bitcoind sync gets very, very slow on Augst 2023 in btc chain (maybe 2/3 progressed or something like that)",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nbitcoind sync gets very, very slow on Augst 2023 in BTC chain (maybe 2/3 progressed or something like that)\n\nEarlier (e.g. first sync in 2024), it was faster, but i also used another version there. the version i use now, is v30.99.0-0ffb20dee178 (self-compiled from master branch)\n\nAND: i also changed my HW: From SSD SATA on LSI SATA-3 controller to a Seagate video SATA-33 HDD on UBS 2.0 controller (because it can bypass the to VM on VirtualBox 7.2.x on MS Window$ (maybe on Linux, i would be able to bypass PCI SATA devices or VHD files in a raw mode - but on Windows, PCIE SATA bypass is not supported and VHD file raw mode is not cleanly implemented. So i need to use USB drives to bypass it completely/in a raw mode)\n\n(But i don't think that is the problem TBH)\n\n**Currently, it needs ~1 day for 1 day in block chain:** On 2026-02-06, on blockchain it was on 2023-08-05 and now we have 2026-02-16 and blockchain sync is on 2023-08-19. **Which means, it will result in an infinite process** \n\n### Expected behaviour\n\nShould be synced in maybe 2-3 weeks maximum so i think, similar to the last sync (2024 when i remember right? But it was another version, don't know that's the reason or not?).\n\n### Steps to reproduce\n\nbitcoind sync gets very, very slow on Augst 2023 in BTC chain (maybe 2/3 progressed or something like that)\n\nEarlier (e.g. first sync in 2024), it was faster, but i also used another version there. the version i use now, is v30.99.0-0ffb20dee178 \n\nAND: i also changed my HW: From SSD SATA on LSI SATA-3 controller to a Seagate video SATA-33 HDD on UBS 2.0 controller (because it can bypass the to VM on VirtualBox 7.2.x on MS Window$ (maybe on Linux, i would be able to baypass PCI SATA devices or VHD files in a raw mode - but on Windows, PCIE SATA bypass is not supported and bypass file raw mode is not cleanly implemented. So i need to use USB drives to bypass it completely/in a raw mode)\n\n(But i don't think that is the problem TBH)\n\n**Currently, it needs ~1 day for 1 day in block chain:** On 2026-02-06, on blockchain it was on 2023-08-05 and now we have 2026-02-16 and blockchain sync is on 2023-08-19. **Which means, it will result in an infinite process** \n\n### Relevant log output\n\n<!-- Failed to upload \"debug.zip\" -->\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nv30.99.0-0ffb20dee178\n\n### Operating system and version\n\nDebian 12.x x64, most current version, with most current updates\n\n### Machine specifications\n\n**PRIMERGY TX120 S3 Server with 4-core (8 virt. Cores) Xeon, 32GB of RAM**",
      "state": "open",
      "user": "kosuodhmwa",
      "created_at": "2026-02-16T19:00:43Z",
      "updated_at": "2026-02-25T18:41:16Z",
      "closed_at": null,
      "comments": 16,
      "url": "https://github.com/bitcoin/bitcoin/issues/34601",
      "labels": [
        "Resource usage",
        "Questions and Help"
      ],
      "comment_data": [
        {
          "id": 3929165600,
          "user": "kosuodhmwa",
          "body": "OK, thx, firstly, my ideas was to use it for another device, but when formated it with \"low level format tool\" (on a usb 3 adapter on laptop), i saw that it only reaches ~40mb/s (adapter and/or laptop should not be the problem here). Usually, SSDs reach 300mb/s or something like that on that usb 3.0 adapter... so the SSD seems to be \"used\". \n\n**So i will buy a new one ASAP.** BTW: What is future-proof , maybe for the next ~5y? What do you think? 3TB is OK or better 4? (maybe difficult to say haha). And a \"small card size\" USB 3.0 adapter too.* \n\n\n\n*Maybe another detail, but it's not relevant i.m.o.: The adapter on the server where VirtualBox BTC node VM is has ONLY usb 2.0 ports, but the adapter i used is USB 3.0. (USB 2.0 speed in both cases..)",
          "created_at": "2026-02-19T18:40:59Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 755,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3961247005,
          "user": "kosuodhmwa",
          "body": "Now i bought a USB 3.0 PCIE controller (so no bottleneck anymore with USB 3.0/SATA-III adapter), will see it increases the speed of the current Seagate Video HDD... if not, i will look for a new SSD, maybe bigger than 2TB (so future-proof for BTC chain size, ;-)) ",
          "created_at": "2026-02-25T18:41:16Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 264,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2807,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3988114660,
      "number": 34666,
      "title": "[rfc] Replacing Boost Unit Test Framework?",
      "body": "As this has comes up sometimes, I wanted to create a thread for this.\n\nHowever, when replacing the current unit test framework, it is unclear what alternative could be suitable. It doesn't really make sense to drop one dependency and add a random other one.\n\nWhen it comes to features that are currently missing, I recall only those so far:\n\n* Boost Unit Test isn't thread-safe, so `BOOST_CHECK` (et al) can only be used from the main thread, not any spawned threads (ref https://github.com/bitcoin/bitcoin/issues/8670#issuecomment-539171149)\n* There is no --fail-fast option, possibly even attaching gdb automatically (https://github.com/bitcoin/bitcoin/issues/8670#issuecomment-247083981)\n\nAre there any other missing features?\n\nIf not, it may be easier to just implement our own thread-safe check macros, which abort to provide the fail-fast behavior? (I guess that `catch_system_errors` will have to be disabled for that somehow, not sure how to do that)",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-02-25T09:00:07Z",
      "updated_at": "2026-02-25T15:47:48Z",
      "closed_at": null,
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/34666",
      "labels": [
        "Brainstorming",
        "Tests"
      ],
      "comment_data": [
        {
          "id": 3959480633,
          "user": "hodlinator",
          "body": "Note that in the case of https://github.com/bitcoin/bitcoin/pull/33878#issuecomment-3944979609 the tests are being run directly through:\n```\n./bin/test_bitcoin.exe -l test_suite\nRunning 725 test cases...\nEntering test module \"Bitcoin Core Test Suite\"\n```\nIf we were instead to run test_bitcoin indirectly through CTest there is `--stop-on-failure` which will prevent that worker thread from picking up additional tests after one fails, and make the other CTest worker threads stop after completing their current test.",
          "created_at": "2026-02-25T14:06:17Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 517,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3959524114,
          "user": "maflcko",
          "body": "> CTest\n\nSure, but ctest is not available after the guix (or any other) cross-build, so I don't think this is a solution here. Also, ctest isn't going to offer a way to fail fast inside a test case, so that gdb can be attached on the first failure.",
          "created_at": "2026-02-25T14:12:18Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 248,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3959568125,
          "user": "hodlinator",
          "body": "> Sure, but ctest is not available after the guix (or any other) cross-build\n\nThe relevant parts of the build-tree would need to be copied across for CTest to work.\n\nTangent: I also just noticed DIR_UNIT_TEST_DATA isn't set by ci-windows-cross.py like it is by 03_test_script.sh, so `script_assets_tests` becomes a no-op.",
          "created_at": "2026-02-25T14:17:16Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 321,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3960226036,
          "user": "maflcko",
          "body": "> The relevant parts of the build-tree would need to be copied across for CTest to work.\n\nI don't think it is so easy. Usually, cross-compilation happens on a different storage device, or even OS (Linux->Windows), so all paths would have to re-written, at a minimum.",
          "created_at": "2026-02-25T15:47:48Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 266,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1001,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3918326723,
      "number": 34542,
      "title": "RFC: Erlay Conceptual Discussion",
      "body": "As suggested during the IRC meeting last week ([logs](https://www.erisian.com.au/bitcoin-core-dev/log-2026-02-05.html#l-251)), this issue is for discussing recent progress on [Erlay](https://github.com/bitcoin/bips/blob/master/bip-0330.mediawiki), evaluating its trade-offs and goals, and ultimately deciding whether it's worth continuing to pursue.\n\nThe current project tracking issue is https://github.com/bitcoin/bitcoin/issues/30249, though some of the performance research results shown there may be outdated. We can gather updated data here and discuss.\n\nCouple questions on my mind:\n\n- What does the bandwidth/latency trade-off look like as we scale the number of connections?\n- Do the benefits outweigh the added code complexity?\n\nOf course, discussion isn't limited to the above. Feel free to bring up any other points that come to mind.",
      "state": "open",
      "user": "marcofleon",
      "created_at": "2026-02-09T21:53:28Z",
      "updated_at": "2026-02-25T14:49:58Z",
      "closed_at": null,
      "comments": 15,
      "url": "https://github.com/bitcoin/bitcoin/issues/34542",
      "labels": [
        "Brainstorming"
      ],
      "comment_data": [
        {
          "id": 3932025430,
          "user": "ajtowns",
          "body": "FWIW, I like the idea of reconciliation-only connections -- in thinking about inv2send stuff which is now PRed as #34628 I've been worried about the distinction we make for the inbound vs outbound side of connections (ie, the side that made the connection will send txs at potentially 2.5x the rate the other side will), which will mess up reconciliation while that zone is being hit. Having a dedicated class of connection (or even just a mode switch like the high-bw vs low-bw compact block stuff) would avoid that -- once you decide to make it a reconciliation connection, just have both sides use the lower rate.\n\nFWIW, I think bumping the number of blocks-only connections should be a high priority (and higher pri than erlay), but it keeps slipping off my radar.\n\nFWIW, if you look at erlay as an anti-censorship addition to the network (ie, we're just using it to add connectivity, not replacing the existing INV connectivity with it), then I don't think latency matters very much. If you're getting your tx relayed in five minutes, when without erlay it would not have been relayed at all due to censorship, that's a win, even if uncensored txs take a fraction of that time.\n\nAs far as the stats go, I don't think 6-8 significant figures of precision is very realistic...\n\n> Are the expected values for the poisson processes set to stone? Is it OK to reduce them? How can we reason about the implications?\n\nThe random delays between INVs is to give a little privacy -- if you wait 8s between INVs and txs are coming in at 7tx/s, then you have an anonymity set of 56 txs where your peers can't discern the order in which they arrived. Because it's an exponential/poisson process, the 5s average will mean that 10% of the time it will be less than 0.52s between INVs, so the anonymity set may be 3.7 transactions or less. I think \"90% of the time, the anonymity set will be at least ~4 transactions\" is the right sort of implication to think about here.\n\nOne thing I've been thinking about with template sharing is if the ephemeral connections we make can be used for tx relay -- ie, we do an extra block relay connection every few minutes already, if we share a template on that, that gives us much broader top-of-mempool tx relay capacity than a set of static connections, at least if a there's a high-feerate tx that's getting censored by a majority of the network for an extended period. Maybe doing a one-off \"txs from the last few minutes\" reconciliation immediately on making a new \"blocks-only\" connection to a compatible peer would also be feasible and useful. (Or maybe not 🤷‍♂️)\n\nAnyway, just some thoughts.",
          "created_at": "2026-02-20T06:50:27Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 0,
            "text_length": 2624,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3936022035,
          "user": "gmaxwell",
          "body": "> the threshold is quite low\n\nI disagree.\n\nIt's quite inexpensive to spin up more \"nodes\". There are already existing known attackers running multiple multiple /24s with every IP pretending to be a distinct node.  The already mentioned censorship attackers have written attack software to gum up the connections of non-censoring nodes and fake their identity which at best leaves preferential peering an expensive cat and mouse game.\n\nWhen it only costs someone a nanosecond to test a password, the space of possible passwords must be enormous to have meaningful security. Similar applies here.\n\nBeyond just spinning up 'nodes' attackers can approach the 10% threshold by trying to knock honest nodes offline through DOS attacks, false abuse reporting, etc.  This is a risk to all operators that they'll be disrupted by an attacker with a realistic prospect of making progress by attacking others.\n\nSo I think the 10% sort of threshold only holds against attackers that are hardly competent or hardly trying, maybe ones that care if their efforts go unnoticed or not-- not the sort of thing that should be relied on.\n\nIt's also a target on average, rather than worst case. If the consequence of being censored is a mere delay then knowing the attacker is unlikely to be successful on average if at least 10% of the 'nodes' you select from are honest is helpful.  But if the consequence is that your funds will be lost, for example, then you likely care about how many nodes must be honest for the attacker success to be less than, say, one in a million.  And by that metric the existing behavior performs poorly.\n\nThe number of effective connections is an important *exponent* in many kinds of attack resistance, in that it makes most other defenses more effective.   E.g. say you want to use behavioral analysis to peer preferentially, having more connections makes that work better and work safer (by applying the preference only to a subset of connections you're at least no worse off than if you didn't make that subset of connections at all).\n\nSimilarly, people have suggested things like POW or ZK-proof-of-utxo-ownership or trading captcha solving for blinded access tokens to create attack resistant connection slots... but all those schemes have their own weaknesses and if they were a primary mechanism could make some attackers more powerful because they're better at meeting them than ordinary honest participants.  If, instead, these mechanisms only run in addition to connections you'd otherwise have then that risk doesn't matter.  But that only works if you can expand the connection pool for these new attack resistant connections.\n\nAnd the only reason to not have every node constantly connect to *every* other node is resource consumption.\n\nWith respect to latency the latency of transaction relay over a connection that doesn't exist is infinite.  I think that's the right metric to judge this.  One could hold connection count constant and try to improve bandwidth sure-- but the only reason to do that is if you care more about bandwidth than latency.  I suspect for most people who do, blocksonly would probably be a better tool.\n\nIn terms of latency requirements: For the operation of the network there is particular reason to get a transaction widely relayed before it would be rationally mined and the network frequently has backlog.   Even for the secondary purpose of transaction notification, delays of many seconds should be fine-- consider that even knowing there has been a delay at that time scale means that you have another communication channel to know that the transaction exists, which could just as well be used to give you the transaction. :)  For transactions that are being censored even fairly delayed propagation is probably fine (it just has to be fast enough to not make the delay into an exploitable attack against exchange protocols).\n\nIt might be somewhat unsatisfying to have tools that are only valuable against attacks and then have the attacks not happen specifically because the tool moots the attack.  But that's the nature of defense: you often only need it if you don't have it.\n\n\n\n",
          "created_at": "2026-02-20T16:56:34Z",
          "drama_signals": {
            "drama_keywords": 3,
            "positive_keywords": 2,
            "text_length": 4139,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3959788408,
          "user": "sr-gi",
          "body": "Thanks for chiming in @ajtowns @gmaxwell \n\n> FWIW, if you look at erlay as an anti-censorship addition to the network (ie, we're just using it to add connectivity, not replacing the existing INV connectivity with it), then I don't think latency matters very much. If you're getting your tx relayed in five minutes, when without erlay it would not have been relayed at all due to censorship, that's a win, even if uncensored txs take a fraction of that time.\n\n> In terms of latency requirements: For the operation of the network there is particular reason to get a transaction widely relayed before it would be rationally mined and the network frequently has backlog. Even for the secondary purpose of transaction notification, delays of many seconds should be fine-- consider that even knowing there has been a delay at that time scale means that you have another communication channel to know that the transaction exists, which could just as well be used to give you the transaction. :) For transactions that are being censored even fairly delayed propagation is probably fine (it just has to be fast enough to not make the delay into an exploitable attack against exchange protocols).\n\nThese sound like good reasons to move forward with a recon-only version of Erlay to me.\n\n> The random delays between INVs is to give a little privacy -- if you wait 8s between INVs and txs are coming in at 7tx/s, then you have an anonymity set of 56 txs where your peers can't discern the order in which they arrived. Because it's an exponential/poisson process, the 5s average will mean that 10% of the time it will be less than 0.52s between INVs, so the anonymity set may be 3.7 transactions or less. I think \"90% of the time, the anonymity set will be at least ~4 transactions\" is the right sort of implication to think about here.\n\nOh, this is really interesting. I never thought about this in terms of the anonymity set that it provides based on the expected transaction throughput. So if I got this right, reducing the expected values to `{2s, 1s}` would yield an \"anonymity set of 4 transactions ~78% and ~61% of the times, respectively\" which is much more undesirable. ",
          "created_at": "2026-02-25T14:49:58Z",
          "drama_signals": {
            "drama_keywords": 2,
            "positive_keywords": 1,
            "text_length": 2166,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 879,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2353376259,
      "number": 30289,
      "title": "Cluster mempool tracking issue",
      "body": "\n\nPlan:\n* Lowest level: generic utilities:\n  * [x] [#29242 FeeFrac type](https://github.com/bitcoin/bitcoin/pull/29242)\n    * [x] [#30535 Add FeeFrac::EvaluateFee](https://github.com/bitcoin/bitcoin/pull/30535)\n      * [x] [#32240 Fix integer overflow in FeeFrac fuzz test](https://github.com/bitcoin/bitcoin/pull/32240)\n      * [x] [#32300 Fix different overflow in FeeFrac fuzz test](https://github.com/bitcoin/bitcoin/pull/32300)\n  * [x] [#30160 BitSet type](https://github.com/bitcoin/bitcoin/pull/30160)\n  * [x] [#30161 VecDeque type](https://github.com/bitcoin/bitcoin/pull/30161)\n* Low level: operations on `DepGraph` type (dependencies/linearizations for a single cluster)\n  * [x] [#30126 Base linearization algorithm](https://github.com/bitcoin/bitcoin/pull/30126)\n    * [x] [#30605 Split tests from tests-of-tests](https://github.com/bitcoin/bitcoin/pull/30605)\n    * [x] [#30857 Extend `DepGraph` functionality](https://github.com/bitcoin/bitcoin/pull/30857)\n  * [x] [#30285 Merging and postprocessing of linearizations](https://github.com/bitcoin/bitcoin/pull/30285)\n  * [x] [#30286 Optimized candidate search](https://github.com/bitcoin/bitcoin/pull/30286)\n  * [x] [#32545 Replace linearization with SFL](https://github.com/bitcoin/bitcoin/pull/32545)\n    * [x] [#34259 SFL chunk minimization](https://github.com/bitcoin/bitcoin/pull/34259)\n  * [x] [#34023 SFL optimizations](https://github.com/bitcoin/bitcoin/pull/34023)\n  * [x] [#34616 SFL cost model](https://github.com/bitcoin/bitcoin/pull/34616)\n    * ~~[#34138 Old version](https://github.com/bitcoin/bitcoin/pull/34138)~~\n* Intermediate level: operations on `TxGraph` type (dependencies/linearizations for the entire mempool)\n  * [x] [#31363 TxGraph basics](https://github.com/bitcoin/bitcoin/pull/31363)\n    * [x] [#32151 TxGraph basics follow-up](https://github.com/bitcoin/bitcoin/pull/32151)\n    * [x] [#32177 TxGraph increase fuzz coverage](https://github.com/bitcoin/bitcoin/pull/32177)\n    * [x] [#32191 Make TxGraph fuzzing more deterministic](https://github.com/bitcoin/bitcoin/pull/32191)\n    * [x] [#33354 Use enum Level instead of bool main_only](https://github.com/bitcoin/bitcoin/pull/33354)\n    * [x] [#33862 Drop support for `TxGraph::Ref` move assignment](https://github.com/bitcoin/bitcoin/pull/33862)\n    * ~~[#33335 Randomize order of transactions](https://github.com/bitcoin/bitcoin/pull/33335)~~\n    * [x] [#34257 Deterministic order of transactions](https://github.com/bitcoin/bitcoin/pull/34257)\n  * [x] [#31444 TxGraph mining/eviction](https://github.com/bitcoin/bitcoin/pull/31444)\n    * [x] [#33469 Use `std::unordered_set` for skipped clusters](https://github.com/bitcoin/bitcoin/pull/33469)\n  * [x] [#31553 TxGraph reorgs](https://github.com/bitcoin/bitcoin/pull/31553)\n  * [x] [#32263 TxGraph work controls](https://github.com/bitcoin/bitcoin/pull/32263)\n  * [x] [#33157 TxGraph memory usage](https://github.com/bitcoin/bitcoin/pull/33157)\n  * [x] [#34085 TxGraph exploiting SFL better](https://github.com/bitcoin/bitcoin/pull/34085)\n* High level: changes to mempool/validation/RPC\n  * [x] [#31122 Changesets for mempool](https://github.com/bitcoin/bitcoin/pull/31122)\n  * [x] [#33629 Cluster mempool implementation](https://github.com/bitcoin/bitcoin/pull/33629)\n    * ~~[#28676 Old version](https://github.com/bitcoin/bitcoin/pull/28676)~~\n  * [x] [#33591 Cluster mempool optimizations and cleanups](https://github.com/bitcoin/bitcoin/pull/33591)\n  * [x] [#34384 Remove epoch-based graph traversal](https://github.com/bitcoin/bitcoin/pull/34384)\n  * [x] [#34615 Report mempool optimality](https://github.com/bitcoin/bitcoin/pull/34615)\n---\n\nIdeas for future follow-ups:\n* Clean up the comparison operators of `FeeFrac`, especially the `operator<<` and `operator>>`: https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2780475893\n* Support registering a weight limit, and have txgraph track lower/upper bound for how much fees can be gathered within that size. With callbacks when it changes, waiting block template clients can be notified perhaps.",
      "state": "closed",
      "user": "sipa",
      "created_at": "2024-06-14T13:21:36Z",
      "updated_at": "2026-02-25T13:39:14Z",
      "closed_at": "2026-02-25T13:18:32Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/30289",
      "labels": [
        "Mempool",
        "Tracking Issue"
      ],
      "comment_data": [
        {
          "id": 3959203186,
          "user": "sipa",
          "body": "I declare victory!\n\nClosing, though there are some follow-ups still interesting here.",
          "created_at": "2026-02-25T13:18:24Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 85,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 4087,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3510034192,
      "number": 33607,
      "title": "Release Schedule for 31.0",
      "body": "Here is a proposed release schedule for `v31.0`, the next major release of Bitcoin Core.\nThe dates are set to target a release in early April.\n\n## 2026-02-06 :heavy_check_mark:\n- Open Transifex translations for `v31.0`\n- Soft translation string freeze (no large or non-critical string changes until release)\n- Finalize and close translations for `v29.0`\n\n## 2026-02-20 ✔️ :\n- Feature freeze (bug fixes only until release)\n- Translation string freeze (no more source language changes until release)\n\n## 2026-03-10 :construction:\n- Anything needed before branch-off, see https://github.com/bitcoin/bitcoin/blob/master/doc/release-process.md\n- Split off `31.x` branch from `master`\n- Start RC cycle, tag and release `v31.0rc1`\n- Start merging for `32.x` on `master` branch\n\n## 2026-04-10 :construction:\n- Tag `v31.0` (aim).\n\nIf any specific dates are a problem for you, please leave a comment.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2025-10-13T13:14:55Z",
      "updated_at": "2026-02-25T10:13:37Z",
      "closed_at": null,
      "comments": 12,
      "url": "https://github.com/bitcoin/bitcoin/issues/33607",
      "labels": [
        "Tracking Issue"
      ],
      "comment_data": [
        {
          "id": 3910437479,
          "user": "AO-LocLab",
          "body": "The [LLM translation review](https://github.com/maflcko/b-c-gui-translations-review) is a valuable tool. Errors that made sense were fixed in the French translation.",
          "created_at": "2026-02-16T20:42:54Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 165,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3932987788,
          "user": "hebasto",
          "body": "> ## 2026-02-20 🚧\n> \n>    * Translation string freeze (no more source language changes until release)\n\nPlease review https://github.com/bitcoin-core/gui/pull/931.",
          "created_at": "2026-02-20T10:39:19Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 162,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3938917153,
          "user": "ostruvek",
          "body": "Sorry for my late reaction. Czech translation should be completed except two strings which I am not able to save after edit.",
          "created_at": "2026-02-21T14:57:48Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 124,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3939010103,
          "user": "Emzy",
          "body": "> Sorry for my late reaction. Czech translation should be completed except two strings which I am not able to save after edit.\n\nHave a look at the [1] [other] buttons at the top right side of Transiflex. You need to provide both translations to press the save button.",
          "created_at": "2026-02-21T15:59:48Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 267,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3940855012,
          "user": "ostruvek",
          "body": "> Have a look at the [1] [other] buttons at the top right side of Transiflex. You need to provide both translations to press the save button.\n\nThank you very much for your advice, I have managed to translate the remaining strings.",
          "created_at": "2026-02-22T12:28:31Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 230,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3958195341,
          "user": "maflcko",
          "body": "I've pushed an update to https://github.com/maflcko/b-c-gui-translations-review",
          "created_at": "2026-02-25T10:13:37Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 79,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 916,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1959828375,
      "number": 28722,
      "title": "Multiprocess tracking issue",
      "body": "This issue will be updated to reflect the current state of bitcoin core [multiprocess support](https://github.com/ryanofsky/bitcoin/tree/pr/ipc/doc/design/multiprocess.md).\n\n---\n\nPRs for review related to building & releasing:\n\n- [ ] #34284\n- [ ] #33795\n- [ ] #32387\n- [ ] Upstream [libmultiprocess pulls](https://github.com/chaincodelabs/libmultiprocess/pulls)\n\nPRs for review related to mining:\n\n- [ ] #32420\n- [ ] #33922 \n- [ ] #33936\n- [ ] #30437\n- [ ] #33421\n- [ ] #33965\n- [ ] #33966\n- [ ] #34020\n- [ ] Tracking issue #33777\n\nPRs for review related wallet & gui & cli:\n\n- [ ] #29409\n- [ ] #10102\n- [ ] #19460\n- [ ] #19461\n- [ ] #32297\n- [ ] #32898\n\nIssues:\n\n- [ ] #32669\n- [ ] #32802\n- [ ] #33341\n- [ ] #33387\n- [ ] #33756\n- [ ] #33897\n- [ ] #33899 \n- [ ] #33923 \n- [ ] #33940\n- [x] #33994\n- [ ] #34014\n- [ ] #34250\n\nPRs / issues closed:\n\n- [X] ~#10242~\n- [X] ~#10295~\n- [X] ~#10600~\n- [X] ~#10244~\n- [X] ~#10605~\n- [X] ~#14636~\n- [X] ~#14437~\n- [X] ~#14711~\n- [X] ~#15342~\n- [X] ~#15373~\n- [X] ~#15288~\n- [X] ~#15531~\n- [X] ~#10973~\n- [X] ~#16839~\n- [X] ~#17906~\n- [X] ~#18278~\n- [X] ~#16367~\n- [X] ~#17999~\n- [X] ~#18743~\n- [X] ~#18587~\n- [X] ~#18677~\n- [X] ~#20494~\n- [X] ~#20046~\n- [X] ~#21035~\n- [X] ~#21732~\n- [X] ~#19160~\n- [X] ~#22216~\n- [X] ~#22214~\n- [X] ~#22218~\n- [X] ~bitcoin-core/gui#360~\n- [X] ~#22215~\n- [X] ~#22217~\n- [X] ~#19101~\n- [X] ~#22848~\n- [X] ~#22219~\n- [X] ~#23003~\n- [X] ~#23006~\n- [X] ~#23004~\n- [X] ~#23005~\n- [X] ~#23499~\n- [X] ~#28721~\n- [X] ~#28907~\n- [X] ~#28978~\n- [X] ~#28921~\n- [X] ~#28929~\n- [X] ~#30509~\n- [X] ~#30510~\n- [X] ~#31196~\n- [X] ~#31197~\n- [X] ~#30940~\n- [X] ~#30955~\n- [X] ~#31105~\n- [X] ~#31003~\n- [X] ~#31288~\n- [X] ~#31480~\n- [X] ~#31318~\n- [X] ~#31196~\n- [X] ~#31740~\n- [X] ~#31151~\n- [X] ~#31455~\n- [X] ~#31763~\n- [X] ~#31815~\n- [X] ~#31945~\n- [X] ~#31283~\n- [X] ~#31827~\n- [X] ~#31564~\n- [X] ~#31866~\n- [X] ~#31992~\n- [X] ~#31741~\n- [X] ~#30975~\n- [X] ~#31785~\n- [X] ~#32271~\n- [X] ~#32378~\n- [X] ~#31375~\n- [X] ~#32634~\n- [X] ~#32641~\n- [X] ~#32690~ \n- [X] ~#31981~\n- [X] ~#32760~\n- [X] ~#32781~\n- [X] ~#31679~\n- [X] ~#31802~\n- [X] ~#32345~\n- [X] ~#33190~\n- [X] ~#33322~\n- [X] ~#33222~\n- [X] ~#33233~\n- [X] ~#33241~\n- [X] ~#33219~\n- [X] ~#33235~\n- [X] ~#33290~\n- [X] ~#33315~\n- [X] ~#33201~\n- [X] ~#33176~\n- [X] ~#33308~\n- [X] ~#33279~\n- [X] ~#33281~\n- [X] ~#33312~\n- [X] ~#33256~\n- [X] ~#33342~\n- [X] ~#33348~\n- [X] ~#33412~\n- [X] ~#33244~\n- [X] ~#33277~\n- [X] ~#33380~\n- [X] ~#33372~\n- [X] ~#33374~\n- [X] ~#33459~\n- [X] ~#33229~\n- [X] ~#31618~\n- [X] ~#33417~\n- [X] ~#33420~\n- [X] ~#33518~\n- [X] ~#33519~\n- [X] ~#33517~\n- [X] ~#33647~\n- [X] ~#32275~\n- [X] ~#30983~\n- [X] ~#31109~\n  - caused by #31003\n  - resolved by #31283\n- [X] ~#31756~\n- [X] ~#33439~\n- [X] ~#31098~\n- [X] ~#33749~\n- [X] ~#33445~\n- [X] ~#33676~\n- [X] ~#33575~\n- [X] ~#33745~\n- [X] ~#33511~\n- [X] ~#33554~\n- [X] ~#33884~\n- [X] ~#33880~\n- [X] ~#33890~\n- [X] ~#33463~\n- [X] ~#33774~\n- [X] ~#33623~\n- [X] ~#34030~\n- [X] ~#34003~ \n- [X] ~#34102~\n- [X] ~#33819~\n- [X] ~#34363~\n- [X] ~#34187~\n- [X] ~#33576~\n\nLinks:\n\n* [Documentation](https://github.com/ryanofsky/bitcoin/tree/pr/ipc/doc/design/multiprocess.md)\n* [Project board](https://github.com/bitcoin/bitcoin/projects/10)\n* [Wiki](https://github.com/bitcoin-core/bitcoin-devwiki/wiki/Process-Separation)\n* [Presentation](https://docs.google.com/presentation/d/1AeJ-7gD-dItUgs5yH-HoEzLvXaEWe_2ZiGUUxYIXcws/edit) ([code shown](https://github.com/ryanofsky/bitcoin/compare/master...pr/ipc.21))\n* [Working group](https://signal.group/#CjQKIJBeCC9-Jbnd_3sPDFPy7TB6ZPkW3k1J5tjwQ-IN_Gu1EhDV_4urKfbKiNIAhdblAulp)\n* [List of working groups](https://github.com/bitcoin-core/bitcoin-devwiki/wiki/Working-Groups)",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2023-10-24T18:22:37Z",
      "updated_at": "2026-02-25T09:48:28Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/28722",
      "labels": [
        "Tracking Issue"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3711,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3685537028,
      "number": 33994,
      "title": "Mining IPC `createNewBlock` should not return before IBD is over",
      "body": "### Please describe the feature you'd like to see added.\n\nMining IPC `createNewBlock` should not return before IBD is over\n\n### Is your feature related to a problem, if so please describe it.\n\non SRI [`bitcoin_core_sv2`](https://github.com/stratum-mining/sv2-apps/tree/main/bitcoin-core-sv2) crate, we want to wait for IBD is over as part of the bootstrapping processes\n\ndiscussing with @ismaelsadeeq and @Shourya742 during BTrust dev day, we came to the conclusion that `createNewBlock` shouldn't even return before IBD is over\n\n### Describe the solution you'd like\n\nMining IPC `createNewBlock` should not return before IBD is over\n\n### Describe any alternatives you've considered\n\n`isInitialBlockDownload` is already available, but it would require us to poll it, which feels a bit backwards with capnproto\n\n### Please leave any additional context\n\nwe're getting reports of crashes when [`sv2-tp`](https://github.com/stratum-mining/sv2-tp) is connected to v30 during IBD\n\nhttps://discord.com/channels/950687892169195530/1179824984592490496/1445351230258937867",
      "state": "closed",
      "user": "plebhash",
      "created_at": "2025-12-02T12:10:24Z",
      "updated_at": "2026-02-25T09:48:27Z",
      "closed_at": "2026-02-25T09:48:26Z",
      "comments": 26,
      "url": "https://github.com/bitcoin/bitcoin/issues/33994",
      "labels": [
        "Feature"
      ],
      "comment_data": [
        {
          "id": 3945908279,
          "user": "plebhash",
          "body": "we are seeing Bitcoin Core crash when connected to SRI JDC\n\nhere's how we reproduced it on a macos with arm64 apple silicon:\n- enter https://stratumprotocol.org/\n- click \"Start Mining\"\n- follow the wizard to run JDC with docker\n- make sure you're connecting to SRI community mainnet deployment\n- make sure you launch JDC while Bitcoin Core v30.2 is still doing IBD\n\nthen bitcoin Core crashes with similar logs:\n```\np@MacBook-Pro Downloads % ./bitcoin-30.2/bin/bitcoin -m node -ipcbind=unix\n2026-02-23T16:23:17Z Bitcoin Core version v30.2.0 (release build)\n2026-02-23T16:23:17Z Using the 'sse4(1way);sse41(4way)' SHA256 implementation\n2026-02-23T16:23:17Z Default data directory /Users/p/Library/Application Support/Bitcoin\n2026-02-23T16:23:17Z Using data directory /Users/p/Library/Application Support/Bitcoin\n2026-02-23T16:23:17Z Config file: /Users/p/Library/Application Support/Bitcoin/bitcoin.conf\n2026-02-23T16:23:17Z Config file arg: prune=\"200\"\n2026-02-23T16:23:17Z Config file arg: rpcallowip=\"0.0.0.0/0\"\n2026-02-23T16:23:17Z Config file arg: rpcbind=\"0.0.0.0\"\n2026-02-23T16:23:17Z Config file arg: rpcpassword=****\n2026-02-23T16:23:17Z Config file arg: rpcuser=****\n2026-02-23T16:23:17Z Config file arg: server=\"1\"\n2026-02-23T16:23:17Z Setting file arg: prune = \"57220\"\n2026-02-23T16:23:17Z Setting file arg: wallet = [\"novcanik\"]\n2026-02-23T16:23:17Z Command-line arg: ipcbind=\"unix\"\n2026-02-23T16:23:17Z Using at most 125 automatic connections (285 file descriptors available)\n2026-02-23T16:23:17Z scheduler thread start\n2026-02-23T16:23:17Z Listening for IPC requests on address unix:/Users/p/Library/Application Support/Bitcoin/node.sock\n2026-02-23T16:23:17Z Binding RPC on address 0.0.0.0 port 8332\n2026-02-23T16:23:17Z WARNING: the RPC server is not safe to expose to untrusted networks such as the public internet\n2026-02-23T16:23:17Z Using rpcuser/rpcpassword authentication.\n2026-02-23T16:23:17Z [warning] The use of rpcuser/rpcpassword is less secure, because credentials are configured in plain text. It is recommended that locally-run instances switch to cookie-based auth, or otherwise to use hashed rpcauth credentials. See share/rpcauth in the source directory for more information.\n2026-02-23T16:23:17Z Starting HTTP server with 16 worker threads\n2026-02-23T16:23:17Z Using wallet directory /Users/p/Library/Application Support/Bitcoin/wallets\n2026-02-23T16:23:17Z init message: Verifying wallet(s)…\n2026-02-23T16:23:17Z Using SQLite Version 3.46.1\n2026-02-23T16:23:17Z Using wallet /Users/p/Library/Application Support/Bitcoin/wallets/novcanik\n2026-02-23T16:23:17Z Using /16 prefix for IP bucketing\n2026-02-23T16:23:17Z init message: Loading P2P addresses…\n2026-02-23T16:23:17Z Loaded 66288 addresses from peers.dat  166ms\n2026-02-23T16:23:17Z init message: Loading banlist…\n2026-02-23T16:23:17Z SetNetworkActive: true\n2026-02-23T16:23:17Z Cache configuration:\n2026-02-23T16:23:17Z * Using 2.0 MiB for block index database\n2026-02-23T16:23:17Z * Using 8.0 MiB for chain state database\n2026-02-23T16:23:17Z * Using 440.0 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\n2026-02-23T16:23:17Z Script verification uses 11 additional threads\n2026-02-23T16:23:17Z Using obfuscation key for blocksdir *.dat files (/Users/p/Library/Application Support/Bitcoin/blocks): '0000000000000000'\n2026-02-23T16:23:17Z Opening LevelDB in /Users/p/Library/Application Support/Bitcoin/blocks/index\n2026-02-23T16:23:17Z Opened LevelDB successfully\n2026-02-23T16:23:17Z Using obfuscation key for /Users/p/Library/Application Support/Bitcoin/blocks/index: 0000000000000000\n2026-02-23T16:23:17Z Using 16 MiB out of 16 MiB requested for signature cache, able to store 524288 elements\n2026-02-23T16:23:17Z Using 16 MiB out of 16 MiB requested for script execution cache, able to store 524288 elements\n2026-02-23T16:23:17Z init message: Loading block index…\n2026-02-23T16:23:17Z Assuming ancestors of block 00000000000000000000611fd22f2df7c8fbd0688745c3a6c3bb5109cc2a12cb have valid signatures.\n2026-02-23T16:23:17Z Setting nMinimumChainWork=0000000000000000000000000000000000000000dee8e2a309ad8a9820433c68\n2026-02-23T16:23:17Z Prune configured to target 57220 MiB on disk for block and undo files.\n2026-02-23T16:23:19Z Loading block index db: last block file = 5409\n2026-02-23T16:23:19Z Loading block index db: last block file info: CBlockFileInfo(blocks=47, size=65771086, heights=937945...937991, time=2026-02-23...2026-02-23)\n2026-02-23T16:23:19Z Checking all blk files are present...\n2026-02-23T16:23:19Z Loading block index db: Block files have previously been pruned\n2026-02-23T16:23:20Z Initializing chainstate Chainstate [ibd] @ height -1 (null)\n2026-02-23T16:23:20Z Opening LevelDB in /Users/p/Library/Application Support/Bitcoin/chainstate\n2026-02-23T16:23:20Z Opened LevelDB successfully\n2026-02-23T16:23:20Z Using obfuscation key for /Users/p/Library/Application Support/Bitcoin/chainstate: ce0efc211ec92aaf\n2026-02-23T16:23:20Z Loaded best chain: hashBestChain=00000000000000000001bd96c5201616a5c58aa6460f0d926cae714223666c93 height=937991 date=2026-02-23T16:17:08Z progress=0.999998\n2026-02-23T16:23:20Z init message: Verifying blocks…\n2026-02-23T16:23:20Z CreateNewBlock(): block weight: 812 txs: 0 fees: 0 sigops 0\n2026-02-23T16:23:20Z Verifying last 6 blocks at level 3\n2026-02-23T16:23:20Z Verification progress: 0%\n2026-02-23T16:23:20Z Verification progress: 16%\n2026-02-23T16:23:20Z Verification progress: 33%\n2026-02-23T16:23:21Z Verification progress: 50%\n2026-02-23T16:23:21Z Verification progress: 66%\n2026-02-23T16:23:21Z [ipc:info] {bitcoin-node-32628/b-capnp-loop-621785} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages6MiningEEE\n2026-02-23T16:23:21Z [ipc:info] {bitcoin-node-32628/b-capnp-loop-621785} IPC server: socket disconnected.\n2026-02-23T16:23:21Z [ipc:info] {bitcoin-node-32628/b-capnp-loop-621785} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages4InitEEE\n2026-02-23T16:23:21Z Verification progress: 83%\n2026-02-23T16:23:21Z Verification progress: 99%\n2026-02-23T16:23:21Z Verification: No coin database inconsistencies in last 6 blocks (8097 transactions)\n2026-02-23T16:23:21Z Block index and chainstate loaded\n2026-02-23T16:23:21Z CreateNewBlock(): block weight: 812 txs: 0 fees: 0 sigops 0\n2026-02-23T16:23:21Z Using SQLite Version 3.46.1\n2026-02-23T16:23:21Z Using wallet /Users/p/Library/Application Support/Bitcoin/wallets/novcanik\n2026-02-23T16:23:21Z init message: Loading wallet…\n2026-02-23T16:23:21Z [novcanik] Last client version = 300200\n2026-02-23T16:23:21Z [novcanik] Descriptors: 8, Descriptor Keys: 0 plaintext, 1 encrypted, 1 total.\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = edb28fd27a4b47ae0e316603d3991cafad2f7e6fdcb096a89fdafcd34627702c, type = legacy, internal = false\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = f7aada836e876af423ca3e80339506f90d3bbf4a8c024b353967dd3161ff8be5, type = p2sh-segwit, internal = false\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = 1fcb15c6c2ee3a63f4a890bfdc69bc97a17d1f32a46337603511fcc8a37e95b3, type = bech32, internal = false\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = 995dd7b253d565466fba909ffe67ca8ab2cb1794f7fc604fcce7e36ff8b0f8c8, type = bech32m, internal = false\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = ad8668ef94ea7747a80402b8f466852bfca8780e321dcb67418cb4584f6b9978, type = legacy, internal = true\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = 4375208e97ac934895c2cce4e70a04193ab53cd445dfc00ba92d96136eba7fa1, type = p2sh-segwit, internal = true\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = 951c97ac022ad382ea68f3ec073fd41c5170513d0e8c430ad51320bb313abff7, type = bech32, internal = true\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = dfba5b81e3aa1473f58553f63eea5ba12b7ef5fe2f209ec665701b0d8292ab42, type = bech32m, internal = true\n2026-02-23T16:23:21Z [novcanik] Wallet completed loading in             235ms\n2026-02-23T16:23:21Z [novcanik] setKeyPool.size() = 8000\n2026-02-23T16:23:21Z [novcanik] mapWallet.size() = 0\n2026-02-23T16:23:21Z [novcanik] m_address_book.size() = 2\n2026-02-23T16:23:21Z init message: Pruning blockstore…\n2026-02-23T16:23:21Z initload thread start\n2026-02-23T16:23:21Z block tree size = 937993\n2026-02-23T16:23:21Z nBestHeight = 937991\n2026-02-23T16:23:21Z mapport thread start\n2026-02-23T16:23:21Z Loading 1814 mempool transactions from file...\n2026-02-23T16:23:21Z torcontrol thread start\n2026-02-23T16:23:21Z Bound to 127.0.0.1:8334\n2026-02-23T16:23:21Z Bound to [::]:8333\n2026-02-23T16:23:21Z Leaving InitialBlockDownload (latching to false)\n2026-02-23T16:23:21Z Bound to 0.0.0.0:8333\n2026-02-23T16:23:21Z Loaded 2 addresses from \"anchors.dat\"\n2026-02-23T16:23:21Z 2 block-relay-only anchors will be tried for connections.\n2026-02-23T16:23:21Z init message: Starting network threads…\n2026-02-23T16:23:21Z net thread start\n2026-02-23T16:23:21Z dnsseed thread start\n2026-02-23T16:23:21Z addcon thread start\n2026-02-23T16:23:21Z Waiting 300 seconds before querying DNS seeds.\n2026-02-23T16:23:21Z init message: Done loading\n2026-02-23T16:23:21Z msghand thread start\n2026-02-23T16:23:21Z opencon thread start\n2026-02-23T16:23:21Z tor: The only supported authentication mechanism left is password, but no password provided with -torpassword\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 10% (tried 182, 1632 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 20% (tried 363, 1451 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 30% (tried 545, 1269 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 40% (tried 726, 1088 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 50% (tried 907, 907 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 60% (tried 1089, 725 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 70% (tried 1270, 544 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 80% (tried 1452, 362 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 90% (tried 1633, 181 remaining)\n2026-02-23T16:23:22Z Imported mempool transactions from file: 1814 succeeded, 0 failed, 0 expired, 0 already there, 0 waiting for initial broadcast\n2026-02-23T16:23:22Z initload thread exit\n2026-02-23T16:23:22Z CreateNewBlock(): block weight: 2269527 txs: 1814 fees: 1045954 sigops 3946\nAssertion failed: (m_loop), function operator*, file proxy.h, line 59.\nzsh: abort      ./bitcoin-30.2/bin/bitcoin -m node -ipcbind=unix\n```",
          "created_at": "2026-02-23T16:40:11Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 0,
            "text_length": 10706,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3945908618,
          "user": "plebhash",
          "body": "another way to crash it is to run JDC first, and immediately start Bitcoin Core v30.2 with these logs on tail:\n```\n2026-02-23T16:30:08Z Config file arg: rpcpassword=****\n2026-02-23T16:30:08Z Config file arg: rpcuser=****\n2026-02-23T16:30:08Z Config file arg: server=\"1\"\n2026-02-23T16:30:08Z Setting file arg: prune = \"57220\"\n2026-02-23T16:30:08Z Setting file arg: wallet = [\"novcanik\"]\n2026-02-23T16:30:08Z Command-line arg: ipcbind=\"unix\"\n2026-02-23T16:30:08Z Using at most 125 automatic connections (285 file descriptors available)\n2026-02-23T16:30:08Z scheduler thread start\n2026-02-23T16:30:08Z Listening for IPC requests on address unix:/Users/p/Library/Application Support/Bitcoin/node.sock\nnode/interfaces.cpp:980 chainman: Assertion `m_node.chainman' failed.\nzsh: abort      ./bitcoin-30.2/bin/bitcoin -m node -ipcbind=unix\n```",
          "created_at": "2026-02-23T16:40:14Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 835,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3945927473,
          "user": "Sjors",
          "body": "@plebhash do these go away with https://github.com/bitcoin/bitcoin/pull/34422?",
          "created_at": "2026-02-23T16:43:43Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 78,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3946069232,
          "user": "jbesraa",
          "body": "> another way to crash it is to run JDC first, and immediately start Bitcoin Core v30.2 with these logs on tail:\n> ```\n> 2026-02-23T16:30:08Z Config file arg: rpcpassword=****\n> 2026-02-23T16:30:08Z Config file arg: rpcuser=****\n> 2026-02-23T16:30:08Z Config file arg: server=\"1\"\n> 2026-02-23T16:30:08Z Setting file arg: prune = \"57220\"\n> 2026-02-23T16:30:08Z Setting file arg: wallet = [\"novcanik\"]\n> 2026-02-23T16:30:08Z Command-line arg: ipcbind=\"unix\"\n> 2026-02-23T16:30:08Z Using at most 125 automatic connections (285 file descriptors available)\n> 2026-02-23T16:30:08Z scheduler thread start\n> 2026-02-23T16:30:08Z Listening for IPC requests on address unix:/Users/p/Library/Application Support/Bitcoin/node.sock\n> node/interfaces.cpp:980 chainman: Assertion `m_node.chainman' failed.\n> zsh: abort      ./bitcoin-30.2/bin/bitcoin -m node -ipcbind=unix\n> ```\n\nI also encountered this with core 30.2 and template provider(by sjors) 1.0.5. It happens when starting core with wrong config and it fails correctly, but then restarting it with correct config takes a try or two to correctly start, in between it throws the above error",
          "created_at": "2026-02-23T17:08:57Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 0,
            "text_length": 1133,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3946600714,
          "user": "ryanofsky",
          "body": "From what I can can tell from above it looks `node/interfaces.cpp:980 chainman: Assertion `m_node.chainman' failed` happens because the IPC server starts listening for connections before chainman is ready. Listening starts here:\n\nhttps://github.com/bitcoin/bitcoin/blob/9581a0a5b18a4d7b22e293b069c731421d6135b1/src/init.cpp#L1497\n\nbefore InitAndLoadChainstate constructs `ChainstateManager` and assigns `node.chainman` here:\n\nhttps://github.com/bitcoin/bitcoin/blob/9581a0a5b18a4d7b22e293b069c731421d6135b1/src/init.cpp#L1868\n\nWe might need to add new signal that mining interface interface can use to know when it is safe to access chainstatemanager, if there is a not an existing one. A nice solution might to initialize the KernelNotifications earlier and use the existing condition variable & mutex there. Probably also we should add a functional test trying to access mining IPC interface before node fully starts up and make sure mining methods wait or return errors and not crash.\n\nThe other reported error `Assertion failed: (m_loop), function operator*, file proxy.h, line 59` is more ambiguous and might indicate the same problem or be caused by something different. It would be most useful to have a stack trace from that crash if possible.\n\nWould also recommend opening new bugs for any newly observed crashes. It should be easier to close bugs as duplicates if necessary than try to track debug multiple problems in a single github thread.\n\n\n\n\n",
          "created_at": "2026-02-23T18:40:52Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 1457,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3947144421,
          "user": "plebhash",
          "body": "@ryanofsky to make sure I understand correctly: neither #34184 nor #34422 fix the root cause of the logs shared above, and we need to open a new issue for that?",
          "created_at": "2026-02-23T20:29:50Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 160,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3947208078,
          "user": "jbesraa",
          "body": "> > another way to crash it is to run JDC first, and immediately start Bitcoin Core v30.2 with these logs on tail:\n> > ```\n> > 2026-02-23T16:30:08Z Config file arg: rpcpassword=****\n> > 2026-02-23T16:30:08Z Config file arg: rpcuser=****\n> > 2026-02-23T16:30:08Z Config file arg: server=\"1\"\n> > 2026-02-23T16:30:08Z Setting file arg: prune = \"57220\"\n> > 2026-02-23T16:30:08Z Setting file arg: wallet = [\"novcanik\"]\n> > 2026-02-23T16:30:08Z Command-line arg: ipcbind=\"unix\"\n> > 2026-02-23T16:30:08Z Using at most 125 automatic connections (285 file descriptors available)\n> > 2026-02-23T16:30:08Z scheduler thread start\n> > 2026-02-23T16:30:08Z Listening for IPC requests on address unix:/Users/p/Library/Application Support/Bitcoin/node.sock\n> > node/interfaces.cpp:980 chainman: Assertion `m_node.chainman' failed.\n> > zsh: abort      ./bitcoin-30.2/bin/bitcoin -m node -ipcbind=unix\n> > ```\n> \n> I also encountered this with core 30.2 and template provider(by sjors) 1.0.5. It happens when starting core with wrong config and it fails correctly, but then restarting it with correct config takes a try or two to correctly start, in between it throws the above error\n\nLogs\n\nCore\n```\n2026-02-23T16:08:23Z Bitcoin Core version v30.2 (release build)\n2026-02-23T16:08:23Z parameter interaction: -bind set -> setting -listen=1\n2026-02-23T16:08:23Z Using the 'sse4(1way);sse41(4way);avx2(8way)' SHA256 implementation\n2026-02-23T16:08:23Z Using RdSeed as an additional entropy source\n2026-02-23T16:08:23Z Using RdRand as an additional entropy source\n2026-02-23T16:08:23Z Default data directory /root/.bitcoin\n2026-02-23T16:08:23Z Using data directory /home/user/.bitcoin\n2026-02-23T16:08:23Z Config file: /home/user/.bitcoin/bitcoin.conf (not found, skipping)\n2026-02-23T16:08:23Z Command-line arg: bind=\"0.0.0.0\"\n2026-02-23T16:08:23Z Command-line arg: datadir=\"/home/user/.bitcoin\"\n2026-02-23T16:08:23Z Command-line arg: dbbatchsize=\"16MB\"\n2026-02-23T16:08:23Z Command-line arg: ipcbind=\"unix:/run/bitcoin/node.sock\"\n2026-02-23T16:08:23Z Command-line arg: server=\"1\"\n2026-02-23T16:08:23Z No wallet support compiled in!\n2026-02-23T16:08:23Z Listening for IPC requests on address unix:/run/bitcoin/node.sock\n2026-02-23T16:08:23Z scheduler thread start\n2026-02-23T16:08:23Z Binding RPC on address 0.0.0.0 port 8332\n2026-02-23T16:08:23Z Starting HTTP server with 16 worker threads\n2026-02-23T16:08:23Z Using /16 prefix for IP bucketing\n2026-02-23T16:08:23Z init message: Loading P2P addresses…\n./node/interfaces.cpp:980 chainman: Assertion `m_node.chainman' failed.\n```\n\nTemplate provider\n```\n26-02-23T16:08:23Z Default data directory /root/.bitcoin\n2026-02-23T16:08:23Z Using data directory /home/user/.bitcoin\n2026-02-23T16:08:23Z Config file: /home/user/.bitcoin/sv2-tp.conf (not found, skipping)\n2026-02-23T16:08:23Z Command-line arg: datadir=/home/user/.bitcoin\n2026-02-23T16:08:23Z Command-line arg: debug=sv2\n2026-02-23T16:08:23Z Command-line arg: ipcconnect=unix:/run/bitcoin/node.sock\n2026-02-23T16:08:23Z Command-line arg: loglevel=sv2:trace\n2026-02-23T16:08:23Z Command-line arg: sv2bind=0.0.0.0\n2026-02-23T16:08:23Z Command-line arg: sv2feedelta=5000\n2026-02-23T16:08:23Z Command-line arg: sv2interval=5\n2026-02-23T16:08:23Z Command-line arg: sv2port=8336\n2026-02-23T16:08:23Z Created PID file /home/user/.bitcoin/sv2-tp.pid\n2026-02-23T16:08:23Z Starting sv2-tp on main network\n2026-02-23T16:08:23Z Using the 'sse4(1way),sse41(4way),avx2(8way)' SHA256 implementation\n2026-02-23T16:08:23Z Using RdSeed as an additional entropy source\n2026-02-23T16:08:23Z Using RdRand as an additional entropy source\n2026-02-23T16:08:23Z Attempting IPC connection to bitcoin-node at unix:/run/bitcoin/node.sock\n2026-02-23T16:08:23Z Ensure Bitcoin Core is running with '-ipcbind=unix' and the correct network (main)\n2026-02-23T16:08:23Z [ipc:info] {sv2-tp-1/sv2-tp-1} IPC client first request from current thread, constructing waiter\n2026-02-23T16:08:23Z Connected to bitcoin-node via IPC at: unix:/run/bitcoin/node.sock\n2026-02-23T16:08:23Z [sv2:info] Template Provider listening on 0.0.0.0:8336\n2026-02-23T16:08:23Z sv2-tp listening for Stratum v2 connections on 0.0.0.0:8336\n2026-02-23T16:08:23Z sv2 thread start\n2026-02-23T16:08:23Z [ipc:info] {sv2-tp-1/b-sv2-9} IPC client first request from current thread, constructing waiter\n2026-02-23T16:08:23Z  thread start\n2026-02-23T16:08:24Z [ipc:error] IPC client method call interrupted by disconnect.\n2026-02-23T16:08:24Z \n************************\nEXCEPTION: N3ipc9ExceptionE       \nIPC client method call interrupted by disconnect.       \nbitcoin in sv2       \n2026-02-23T16:08:24Z [ipc:warning] {sv2-tp-1/b-capnp-loop-7} IPC client: unexpected network disconnect.\n************************\nEXCEPTION: N3ipc9ExceptionE       \nIPC client method call interrupted by disconnect.       \nbitcoin in sv2       \nterminate called after throwing an instance of 'ipc::Exception'\n  what():  IPC client method call interrupted by disconnect.\n```",
          "created_at": "2026-02-23T20:38:10Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 0,
            "text_length": 4965,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3947432271,
          "user": "ryanofsky",
          "body": "> [@ryanofsky](https://github.com/ryanofsky) to make sure I understand correctly: neither [#34184](https://github.com/bitcoin/bitcoin/pull/34184) nor [#34422](https://github.com/bitcoin/bitcoin/pull/34422) fix the root cause of the logs shared above, and we need to open a new issue for that?\n\nYou should feel free to open a new issue, but now I understand why you posted it here. In my last post I thought the ``Assertion `m_node.chainman' failed`` message was an entirely new error, but now I see it was previously mentioned in comments back in December, just not in the original issue description.\n\nIt does look to me like #34184 and #34422 will not fix that error, so there is more work to do here, and that is a reason it could be nice to have a new issue. I'd also say in general any time you see a bug, it's good to open a new issue clearly describing observed and expected behavior and steps to reproduce if it doesn't directly duplicate an existing issue, so we can track it and it doesn't get lost in discussion history.",
          "created_at": "2026-02-23T21:29:32Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 1030,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3952145155,
          "user": "ryanofsky",
          "body": "Update: #34184 is merged now which should fix the originally reported issue of createNewBlock returning before IBD is over and I just opened #34661 to fix the ``Assertion `m_node.chainman' failed`` crash that can also happen and was originally reported in https://github.com/bitcoin/bitcoin/issues/33994#issuecomment-3602551596.\n\nThere seems to be a third issue: `Assertion failed: (m_loop), function operator*, file proxy.h, line 59.` crashes reported Feb 18 https://github.com/bitcoin/bitcoin/issues/33994#issuecomment-3921181871 and again Feb 23 https://github.com/bitcoin/bitcoin/issues/33994#issuecomment-3945908279. It is unclear if the Feb 18 and Feb 23 reports are caused by the same bug. In both cases, the error messages are the same and both errors are immediately preceded by `CreateNewBlock()` log messages. But before the `CreateNewBlock()` log message, the Feb 18 error is immediately preceded by a client disconnect, while the Feb 23 error is immediately preceded by \"initload thread exit\" indicating blocks and mempool transactions were just loaded on startup.\n\nAs sjors pointed out, the crash after disconnect could likely fixed by #34422, and I think the crash after initload could be fixed by #34661, so it would be good to have testing with those PRs to see if that's the case. GDB stack traces & -debug=ipc logs could be helpful too.",
          "created_at": "2026-02-24T14:05:41Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 1355,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3954229481,
          "user": "plebhash",
          "body": "> You should feel free to open a new issue\n\n@ryanofsky there you go #34664",
          "created_at": "2026-02-24T19:19:28Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 74,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3958055380,
          "user": "ryanofsky",
          "body": "Will close this issue since the requested behavior of making createNewBlock block during IBD was implemented in https://github.com/bitcoin/bitcoin/pull/34184.\n\nIn the thread there were also reports of createNewBlock calls causing crashes during IBD:\n\n- ``Assertion `m_node.chainman' failed`` crashes that should be fixed by [#34661](https://github.com/bitcoin/bitcoin/pull/34661)\n- `Assertion failed: (m_loop)` crash after disconnect which is likely fixed by [#34422](https://github.com/bitcoin/bitcoin/pull/34422)\n- `Assertion failed: (m_loop)` crash on early startup that might be fixed by [#34184](https://github.com/bitcoin/bitcoin/pull/34184)\n\nWe can track these in https://github.com/bitcoin/bitcoin/issues/34664 and any new problems in new issues\n\n\n\n\n\n",
          "created_at": "2026-02-25T09:48:26Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 759,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1126,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3972277056,
      "number": 34645,
      "title": "oss-fuzz: coins_view_overlay: ASSERT: m_dirty_count == 0",
      "body": "https://issues.oss-fuzz.com/issues/486389268\n```bash\nCommand: /mnt/scratch0/clusterfuzz/resources/platform/linux/unshare -c -n /mnt/scratch0/clusterfuzz/bot/builds/clusterfuzz-builds_bitcoin-core_83aef6625aaeafa301867de74608b320f3c923fe/revisions/coins_view_overlay -rss_limit_mb=2560 -timeout=60 -runs=100 /mnt/scratch0/clusterfuzz/bot/inputs/fuzzer-testcases/crash-e84f31ab73616c1a282fb40ce4e33abd394fb911\n\tTime ran: 0.49608683586120605\n\t\n\tINFO: Running with entropic power schedule (0xFF, 100).\n\tINFO: Seed: 360939801\n\tINFO: Loaded 1 modules   (603691 inline 8-bit counters): 603691 [0x55a793000eb0, 0x55a7930944db),\n\tINFO: Loaded 1 PC tables (603691 PCs): 603691 [0x55a7930944e0,0x55a7939ca790),\n\t/mnt/scratch0/clusterfuzz/bot/builds/clusterfuzz-builds_bitcoin-core_83aef6625aaeafa301867de74608b320f3c923fe/revisions/coins_view_overlay: Running 1 inputs 100 time(s) each.\n\tRunning: /mnt/scratch0/clusterfuzz/bot/inputs/fuzzer-testcases/crash-e84f31ab73616c1a282fb40ce4e33abd394fb911\n\tcoins.cpp:283 void CCoinsViewCache::Flush(bool): Assertion `m_dirty_count == 0` failed.\n\t==241== ERROR: libFuzzer: deadly signal\n\t    #0 0x55a7909aa551 in __sanitizer_print_stack_trace /src/llvm-project/compiler-rt/lib/asan/asan_stack.cpp:87:3\n\t    #1 0x55a79089bff8 in fuzzer::PrintStackTrace() /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerUtil.cpp:210:5\n\t    #2 0x55a79087eb45 in fuzzer::Fuzzer::CrashCallback() /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:231:3\n\t    #3 0x7f08d19c041f in libpthread.so.0\n\t    #4 0x7f08d17b400a in __libc_signal_restore_set /build/glibc-B3wQXB/glibc-2.31/sysdeps/unix/sysv/linux/internal-signals.h:86:3\n\t    #5 0x7f08d17b400a in raise /build/glibc-B3wQXB/glibc-2.31/sysdeps/unix/sysv/linux/raise.c:48:3\n\t    #6 0x7f08d1793858 in abort /build/glibc-B3wQXB/glibc-2.31/stdlib/abort.c:79:7\n\t    #7 0x55a7915cc5e2 in assertion_fail(std::__1::source_location const&, std::__1::basic_string_view<char, std::__1::char_traits<char>>) [bitcoin-core/src/util/check.cpp:41](https://github.com/bitcoin/bitcoin/blob/ee2065fdeaca91caaad9eb7daeeffe939441d804/src/util/check.cpp#L41):5\n\t    #8 0x55a79128c7ea in inline_assertion_check<false, bool> [bitcoin-core/src/util/check.h:90](https://github.com/bitcoin/bitcoin/blob/ee2065fdeaca91caaad9eb7daeeffe939441d804/src/util/check.h#L90):13\n\t    #9 0x55a79128c7ea in CCoinsViewCache::Flush(bool) [bitcoin-core/src/coins.cpp:283](https://github.com/bitcoin/bitcoin/blob/ee2065fdeaca91caaad9eb7daeeffe939441d804/src/coins.cpp#L283):5\n\t    #10 0x55a790c4dea7 in operator() [bitcoin-core/src/test/fuzz/coins_view.cpp:135](https://github.com/bitcoin/bitcoin/blob/ee2065fdeaca91caaad9eb7daeeffe939441d804/src/test/fuzz/coins_view.cpp#L135):34\n\t    #11 0x55a790c4dea7 in CallOneOf<(lambda at /src/bitcoin-core/src/test/fuzz/coins_view.cpp:116:13), (lambda at /src/bitcoin-core/src/test/fuzz/coins_view.cpp:134:13), (lambda at /src/bitcoin-core/src/test/fuzz/coins_view.cpp:137:13), (lambda at /src/bitcoin-core/src/test/fuzz/coins_view.cpp:140:13), (lambda at /src/bitcoin-core/src/test/fuzz/coins_view.cpp:146:13), (lambda at /src/bitcoin-core/src/test/fuzz/coins_view.cpp:160:13), (lambda at /src/bitcoin-core/src/test/fuzz/coins_view.cpp:164:13), (lambda at /src/bitcoin-core/src/test/fuzz/coins_view.cpp:167:13), (lambda at /src/bitcoin-core/src/test/fuzz/coins_view.cpp:173:13), (lambda at /src/bitcoin-core/src/test/fuzz/coins_view.cpp:181:13), (lambda at /src/bitcoin-core/src/test/fuzz/coins_view.cpp:189:13), (lambda at /src/bitcoin-core/src/test/fuzz/coins_view.cpp:197:13)> [bitcoin-core/src/test/fuzz/util.h:42](https://github.com/bitcoin/bitcoin/blob/ee2065fdeaca91caaad9eb7daeeffe939441d804/src/test/fuzz/util.h#L42):27\n\t    #12 0x55a790c4dea7 in TestCoinsView(FuzzedDataProvider&, CCoinsViewCache&, CCoinsView&, bool) [bitcoin-core/src/test/fuzz/coins_view.cpp:114](https://github.com/bitcoin/bitcoin/blob/ee2065fdeaca91caaad9eb7daeeffe939441d804/src/test/fuzz/coins_view.cpp#L114):9\n\t    #13 0x55a790c4c486 in coins_view_overlay_fuzz_target(std::__1::span<unsigned char const, 18446744073709551615ul>) [bitcoin-core/src/test/fuzz/coins_view.cpp:404](https://github.com/bitcoin/bitcoin/blob/ee2065fdeaca91caaad9eb7daeeffe939441d804/src/test/fuzz/coins_view.cpp#L404):5\n\t    #14 0x55a7912282f4 in operator() /usr/local/include/c++/v1/__functional/function.h:274:12\n\t    #15 0x55a7912282f4 in operator() /usr/local/include/c++/v1/__functional/function.h:772:10\n\t    #16 0x55a7912282f4 in test_one_input [bitcoin-core/src/test/fuzz/fuzz.cpp:88](https://github.com/bitcoin/bitcoin/blob/ee2065fdeaca91caaad9eb7daeeffe939441d804/src/test/fuzz/fuzz.cpp#L88):5\n\t    #17 0x55a7912282f4 in LLVMFuzzerTestOneInput [bitcoin-core/src/test/fuzz/fuzz.cpp:216](https://github.com/bitcoin/bitcoin/blob/ee2065fdeaca91caaad9eb7daeeffe939441d804/src/test/fuzz/fuzz.cpp#L216):5\n\t    #18 0x55a79088022d in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:619:13\n\t    #19 0x55a790869f42 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:329:6\n\t    #20 0x55a79086fe10 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:865:9\n\t    #21 0x55a79089c9a2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n\t    #22 0x7f08d1795082 in __libc_start_main /build/glibc-B3wQXB/glibc-2.31/csu/libc-start.c:308:16\n\t    #23 0x55a79086302d in _start\n\t\n\tNOTE: libFuzzer has rudimentary signal handlers.\n\t      Combine libFuzzer with AddressSanitizer or similar for better crash reports.\n\tSUMMARY: libFuzzer: deadly signal\n```",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-02-21T16:07:31Z",
      "updated_at": "2026-02-24T22:45:00Z",
      "closed_at": "2026-02-24T22:44:59Z",
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/issues/34645",
      "labels": [],
      "comment_data": [
        {
          "id": 3939024362,
          "user": "fanquake",
          "body": "cc @andrewtoth ",
          "created_at": "2026-02-21T16:08:38Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 15,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3939058325,
          "user": "l0rinc",
          "body": "This is more likely related to https://github.com/bitcoin/bitcoin/pull/33512/changes#diff-f0ed73d62dae6ca28ebd3045e5fc0d5d02eaaacadb4c2a292985a3fbd7e1c77cR268 (cc: @sipa), or the combination of the two.\n\nEdit: I wonder if https://github.com/bitcoin/bitcoin/pull/33018/changes#diff-1ef3b6a1936b50f3d5ec4a1786d9e2d63d1a3e1815b103e67f20601995f355b4R134 would fix this?",
          "created_at": "2026-02-21T16:32:52Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 365,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3939319088,
          "user": "sipa",
          "body": "FWIW:\n\n```\n$ base64 <clusterfuzz-testcase-minimized-coins_view_overlay-6749085850992640 \nICAJICAgXCDpeunp6enp6enp6enp6enp6enp6enp6enp6enp6eDp6enp6elcICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIFwg6Xrp6enp6enp6enp6enp6enp6enp6enp6enp6eng\n6enp6enpXCDl/yD/MP8g/yD/MP8g5f8g/yD/MP8g/13/\n```\n\nAnd indeed, looks like it is fixed by #33018.\n\nEDIT: this seems coincidental; 33018 doesn't address the root cause.",
          "created_at": "2026-02-21T19:48:01Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 408,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3939331203,
          "user": "sipa",
          "body": "However, after merging 33018, the following seed fails `FUZZ=coins_view_overlay` (which does not fail on master). This is with a very hastily-created merge as there were some conflicts, it is possible I introduced a bug when merging.\n\n```\nTc8pCSCAAeUKAAAAAAAAAFxTAAAAAA4AAAD/U1MBAAAAAAAAaFNT8VNT8VOs//v///9B/7S0tIv/\ntLRdtKN////f/////uDg/6kAdR/gAAD///////8hAAAAAAAAAAAFBQ3l2AmLXFNTU1NTPprxQfFT\nU1OnrFP/mQEnXF1dXV1dXV1dXV1dXV1TAAAAAA4AAAD/U1MBAAAAAAAAaFNTrFNT//////8FBQUA\nBQUNAQAAAAAAgAHlCv////////8BBf///////6xTU///////BQAFBQUFDQEAAAAAAIAB5QoAAAAA\nAAAAXFMAAAAADgAAAP9TUwEAAAAAAABoU1PxU1PxU6z/+////0H/tLS0i/+0tF20o3///9/////+\n4OD/qQB1H+AAAP///////yEAAAAAAAAAAAUFDeXYCVxTU1NTUz6a8UHxU1MBAAAAAAAAaFNT////\n///74AAA////////IQAAAAAAAAUAAOUF2A0JXFNTU1NTPprxQfFTU1OnrFP///8h////////BQAF\nBQUFDQEAAAAAAIAB5QoAAAAAAAAADSdcUwBTU1NTU1OsUxkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZ\nGRkZGRkZGRkZGRkZGRkZGRk6GRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRgZGRkZGRkZGRkZGRlT\nU/HxQfHs8SsjDPGZr/Hs+SsjDPGZrw0nXFMAU1NTU1NTrFNTU/HxQarx7PE/KyMM8Zmv8ew/KyMM\n8Zmv\n```\n\n",
          "created_at": "2026-02-21T19:55:24Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 1019,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3939452816,
          "user": "andrewtoth",
          "body": "https://github.com/bitcoin/bitcoin/pull/34647",
          "created_at": "2026-02-21T20:47:28Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 45,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3939473347,
          "user": "sipa",
          "body": "Looks like it's the result of the combination of #33512 and #34165, and ultimately a bug in the fuzz test, not the code being tested.",
          "created_at": "2026-02-21T20:56:20Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 133,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3941123942,
          "user": "andrewtoth",
          "body": "Previously double iterating cursor entries was safe, but after #33512 we are decrementing m_dirty_count which can't be done twice.",
          "created_at": "2026-02-22T14:56:05Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 130,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 5778,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3985413432,
      "number": 34664,
      "title": "IPC server crashes on early client connection (assertion failure in `proxy.h` and `interfaces.cpp`)",
      "body": "this was originally reported on #33994 (see https://github.com/bitcoin/bitcoin/issues/33994#issuecomment-3947432271 for a summarized context)\n\n---\n\nwe are seeing Bitcoin Core crash when connected to SRI JDC\n\nhere's how we reproduced it on a macos with arm64 apple silicon:\n- enter https://stratumprotocol.org/\n- click \"Start Mining\"\n- follow the wizard to run JDC with docker\n- make sure you're connecting to SRI community mainnet deployment\n- make sure you launch JDC while Bitcoin Core v30.2 is still doing IBD\n\nthen bitcoin Core crashes with similar logs:\n```\np@MacBook-Pro Downloads % ./bitcoin-30.2/bin/bitcoin -m node -ipcbind=unix\n2026-02-23T16:23:17Z Bitcoin Core version v30.2.0 (release build)\n2026-02-23T16:23:17Z Using the 'sse4(1way);sse41(4way)' SHA256 implementation\n2026-02-23T16:23:17Z Default data directory /Users/p/Library/Application Support/Bitcoin\n2026-02-23T16:23:17Z Using data directory /Users/p/Library/Application Support/Bitcoin\n2026-02-23T16:23:17Z Config file: /Users/p/Library/Application Support/Bitcoin/bitcoin.conf\n2026-02-23T16:23:17Z Config file arg: prune=\"200\"\n2026-02-23T16:23:17Z Config file arg: rpcallowip=\"0.0.0.0/0\"\n2026-02-23T16:23:17Z Config file arg: rpcbind=\"0.0.0.0\"\n2026-02-23T16:23:17Z Config file arg: rpcpassword=****\n2026-02-23T16:23:17Z Config file arg: rpcuser=****\n2026-02-23T16:23:17Z Config file arg: server=\"1\"\n2026-02-23T16:23:17Z Setting file arg: prune = \"57220\"\n2026-02-23T16:23:17Z Setting file arg: wallet = [\"novcanik\"]\n2026-02-23T16:23:17Z Command-line arg: ipcbind=\"unix\"\n2026-02-23T16:23:17Z Using at most 125 automatic connections (285 file descriptors available)\n2026-02-23T16:23:17Z scheduler thread start\n2026-02-23T16:23:17Z Listening for IPC requests on address unix:/Users/p/Library/Application Support/Bitcoin/node.sock\n2026-02-23T16:23:17Z Binding RPC on address 0.0.0.0 port 8332\n2026-02-23T16:23:17Z WARNING: the RPC server is not safe to expose to untrusted networks such as the public internet\n2026-02-23T16:23:17Z Using rpcuser/rpcpassword authentication.\n2026-02-23T16:23:17Z [warning] The use of rpcuser/rpcpassword is less secure, because credentials are configured in plain text. It is recommended that locally-run instances switch to cookie-based auth, or otherwise to use hashed rpcauth credentials. See share/rpcauth in the source directory for more information.\n2026-02-23T16:23:17Z Starting HTTP server with 16 worker threads\n2026-02-23T16:23:17Z Using wallet directory /Users/p/Library/Application Support/Bitcoin/wallets\n2026-02-23T16:23:17Z init message: Verifying wallet(s)…\n2026-02-23T16:23:17Z Using SQLite Version 3.46.1\n2026-02-23T16:23:17Z Using wallet /Users/p/Library/Application Support/Bitcoin/wallets/novcanik\n2026-02-23T16:23:17Z Using /16 prefix for IP bucketing\n2026-02-23T16:23:17Z init message: Loading P2P addresses…\n2026-02-23T16:23:17Z Loaded 66288 addresses from peers.dat  166ms\n2026-02-23T16:23:17Z init message: Loading banlist…\n2026-02-23T16:23:17Z SetNetworkActive: true\n2026-02-23T16:23:17Z Cache configuration:\n2026-02-23T16:23:17Z * Using 2.0 MiB for block index database\n2026-02-23T16:23:17Z * Using 8.0 MiB for chain state database\n2026-02-23T16:23:17Z * Using 440.0 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\n2026-02-23T16:23:17Z Script verification uses 11 additional threads\n2026-02-23T16:23:17Z Using obfuscation key for blocksdir *.dat files (/Users/p/Library/Application Support/Bitcoin/blocks): '0000000000000000'\n2026-02-23T16:23:17Z Opening LevelDB in /Users/p/Library/Application Support/Bitcoin/blocks/index\n2026-02-23T16:23:17Z Opened LevelDB successfully\n2026-02-23T16:23:17Z Using obfuscation key for /Users/p/Library/Application Support/Bitcoin/blocks/index: 0000000000000000\n2026-02-23T16:23:17Z Using 16 MiB out of 16 MiB requested for signature cache, able to store 524288 elements\n2026-02-23T16:23:17Z Using 16 MiB out of 16 MiB requested for script execution cache, able to store 524288 elements\n2026-02-23T16:23:17Z init message: Loading block index…\n2026-02-23T16:23:17Z Assuming ancestors of block 00000000000000000000611fd22f2df7c8fbd0688745c3a6c3bb5109cc2a12cb have valid signatures.\n2026-02-23T16:23:17Z Setting nMinimumChainWork=0000000000000000000000000000000000000000dee8e2a309ad8a9820433c68\n2026-02-23T16:23:17Z Prune configured to target 57220 MiB on disk for block and undo files.\n2026-02-23T16:23:19Z Loading block index db: last block file = 5409\n2026-02-23T16:23:19Z Loading block index db: last block file info: CBlockFileInfo(blocks=47, size=65771086, heights=937945...937991, time=2026-02-23...2026-02-23)\n2026-02-23T16:23:19Z Checking all blk files are present...\n2026-02-23T16:23:19Z Loading block index db: Block files have previously been pruned\n2026-02-23T16:23:20Z Initializing chainstate Chainstate [ibd] @ height -1 (null)\n2026-02-23T16:23:20Z Opening LevelDB in /Users/p/Library/Application Support/Bitcoin/chainstate\n2026-02-23T16:23:20Z Opened LevelDB successfully\n2026-02-23T16:23:20Z Using obfuscation key for /Users/p/Library/Application Support/Bitcoin/chainstate: ce0efc211ec92aaf\n2026-02-23T16:23:20Z Loaded best chain: hashBestChain=00000000000000000001bd96c5201616a5c58aa6460f0d926cae714223666c93 height=937991 date=2026-02-23T16:17:08Z progress=0.999998\n2026-02-23T16:23:20Z init message: Verifying blocks…\n2026-02-23T16:23:20Z CreateNewBlock(): block weight: 812 txs: 0 fees: 0 sigops 0\n2026-02-23T16:23:20Z Verifying last 6 blocks at level 3\n2026-02-23T16:23:20Z Verification progress: 0%\n2026-02-23T16:23:20Z Verification progress: 16%\n2026-02-23T16:23:20Z Verification progress: 33%\n2026-02-23T16:23:21Z Verification progress: 50%\n2026-02-23T16:23:21Z Verification progress: 66%\n2026-02-23T16:23:21Z [ipc:info] {bitcoin-node-32628/b-capnp-loop-621785} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages6MiningEEE\n2026-02-23T16:23:21Z [ipc:info] {bitcoin-node-32628/b-capnp-loop-621785} IPC server: socket disconnected.\n2026-02-23T16:23:21Z [ipc:info] {bitcoin-node-32628/b-capnp-loop-621785} IPC server destroy N2mp11ProxyServerIN3ipc5capnp8messages4InitEEE\n2026-02-23T16:23:21Z Verification progress: 83%\n2026-02-23T16:23:21Z Verification progress: 99%\n2026-02-23T16:23:21Z Verification: No coin database inconsistencies in last 6 blocks (8097 transactions)\n2026-02-23T16:23:21Z Block index and chainstate loaded\n2026-02-23T16:23:21Z CreateNewBlock(): block weight: 812 txs: 0 fees: 0 sigops 0\n2026-02-23T16:23:21Z Using SQLite Version 3.46.1\n2026-02-23T16:23:21Z Using wallet /Users/p/Library/Application Support/Bitcoin/wallets/novcanik\n2026-02-23T16:23:21Z init message: Loading wallet…\n2026-02-23T16:23:21Z [novcanik] Last client version = 300200\n2026-02-23T16:23:21Z [novcanik] Descriptors: 8, Descriptor Keys: 0 plaintext, 1 encrypted, 1 total.\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = edb28fd27a4b47ae0e316603d3991cafad2f7e6fdcb096a89fdafcd34627702c, type = legacy, internal = false\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = f7aada836e876af423ca3e80339506f90d3bbf4a8c024b353967dd3161ff8be5, type = p2sh-segwit, internal = false\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = 1fcb15c6c2ee3a63f4a890bfdc69bc97a17d1f32a46337603511fcc8a37e95b3, type = bech32, internal = false\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = 995dd7b253d565466fba909ffe67ca8ab2cb1794f7fc604fcce7e36ff8b0f8c8, type = bech32m, internal = false\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = ad8668ef94ea7747a80402b8f466852bfca8780e321dcb67418cb4584f6b9978, type = legacy, internal = true\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = 4375208e97ac934895c2cce4e70a04193ab53cd445dfc00ba92d96136eba7fa1, type = p2sh-segwit, internal = true\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = 951c97ac022ad382ea68f3ec073fd41c5170513d0e8c430ad51320bb313abff7, type = bech32, internal = true\n2026-02-23T16:23:21Z [novcanik] Setting spkMan to active: id = dfba5b81e3aa1473f58553f63eea5ba12b7ef5fe2f209ec665701b0d8292ab42, type = bech32m, internal = true\n2026-02-23T16:23:21Z [novcanik] Wallet completed loading in             235ms\n2026-02-23T16:23:21Z [novcanik] setKeyPool.size() = 8000\n2026-02-23T16:23:21Z [novcanik] mapWallet.size() = 0\n2026-02-23T16:23:21Z [novcanik] m_address_book.size() = 2\n2026-02-23T16:23:21Z init message: Pruning blockstore…\n2026-02-23T16:23:21Z initload thread start\n2026-02-23T16:23:21Z block tree size = 937993\n2026-02-23T16:23:21Z nBestHeight = 937991\n2026-02-23T16:23:21Z mapport thread start\n2026-02-23T16:23:21Z Loading 1814 mempool transactions from file...\n2026-02-23T16:23:21Z torcontrol thread start\n2026-02-23T16:23:21Z Bound to 127.0.0.1:8334\n2026-02-23T16:23:21Z Bound to [::]:8333\n2026-02-23T16:23:21Z Leaving InitialBlockDownload (latching to false)\n2026-02-23T16:23:21Z Bound to 0.0.0.0:8333\n2026-02-23T16:23:21Z Loaded 2 addresses from \"anchors.dat\"\n2026-02-23T16:23:21Z 2 block-relay-only anchors will be tried for connections.\n2026-02-23T16:23:21Z init message: Starting network threads…\n2026-02-23T16:23:21Z net thread start\n2026-02-23T16:23:21Z dnsseed thread start\n2026-02-23T16:23:21Z addcon thread start\n2026-02-23T16:23:21Z Waiting 300 seconds before querying DNS seeds.\n2026-02-23T16:23:21Z init message: Done loading\n2026-02-23T16:23:21Z msghand thread start\n2026-02-23T16:23:21Z opencon thread start\n2026-02-23T16:23:21Z tor: The only supported authentication mechanism left is password, but no password provided with -torpassword\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 10% (tried 182, 1632 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 20% (tried 363, 1451 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 30% (tried 545, 1269 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 40% (tried 726, 1088 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 50% (tried 907, 907 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 60% (tried 1089, 725 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 70% (tried 1270, 544 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 80% (tried 1452, 362 remaining)\n2026-02-23T16:23:22Z Progress loading mempool transactions from file: 90% (tried 1633, 181 remaining)\n2026-02-23T16:23:22Z Imported mempool transactions from file: 1814 succeeded, 0 failed, 0 expired, 0 already there, 0 waiting for initial broadcast\n2026-02-23T16:23:22Z initload thread exit\n2026-02-23T16:23:22Z CreateNewBlock(): block weight: 2269527 txs: 1814 fees: 1045954 sigops 3946\nAssertion failed: (m_loop), function operator*, file proxy.h, line 59.\nzsh: abort      ./bitcoin-30.2/bin/bitcoin -m node -ipcbind=unix\n```\n\n---\n\nanother way to crash it is to run JDC first, and immediately start Bitcoin Core v30.2 with these logs on tail:\n```\n2026-02-23T16:30:08Z Config file arg: rpcpassword=****\n2026-02-23T16:30:08Z Config file arg: rpcuser=****\n2026-02-23T16:30:08Z Config file arg: server=\"1\"\n2026-02-23T16:30:08Z Setting file arg: prune = \"57220\"\n2026-02-23T16:30:08Z Setting file arg: wallet = [\"novcanik\"]\n2026-02-23T16:30:08Z Command-line arg: ipcbind=\"unix\"\n2026-02-23T16:30:08Z Using at most 125 automatic connections (285 file descriptors available)\n2026-02-23T16:30:08Z scheduler thread start\n2026-02-23T16:30:08Z Listening for IPC requests on address unix:/Users/p/Library/Application Support/Bitcoin/node.sock\nnode/interfaces.cpp:980 chainman: Assertion `m_node.chainman' failed.\nzsh: abort      ./bitcoin-30.2/bin/bitcoin -m node -ipcbind=unix\n```\n\n---\n\nas inquired by @Sjors and clarified by @ryanofsky :\n\nneither https://github.com/bitcoin/bitcoin/pull/34184 nor https://github.com/bitcoin/bitcoin/pull/34422 fix the root cause\n\n---\n\n@jbesraa also faces it \n- https://github.com/bitcoin/bitcoin/issues/33994#issuecomment-3946069232\n- https://github.com/bitcoin/bitcoin/issues/33994#issuecomment-3947208078\n",
      "state": "open",
      "user": "plebhash",
      "created_at": "2026-02-24T19:19:00Z",
      "updated_at": "2026-02-24T20:28:09Z",
      "closed_at": null,
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34664",
      "labels": [],
      "comment_data": [
        {
          "id": 3954539037,
          "user": "ryanofsky",
          "body": "Thanks for the report. An earlier comment https://github.com/bitcoin/bitcoin/issues/33994#issuecomment-3952145155 breaks down some of the differences between the two crashes in the issue description `Assertion failed: (m_loop), function operator*, file proxy.h, line 59` vs ``chainman: Assertion `m_node.chainman' failed.`` but hopefully #34661 should fix both of these (testing welcome!).\n\nThere was also a slightly different  `Assertion failed: (m_loop)` crash-after-disconnect case reported in a screenshot https://github.com/bitcoin/bitcoin/issues/33994#issuecomment-3921181871 which hopefully should be fixed by #34422\n\n\n\n",
          "created_at": "2026-02-24T20:28:09Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 627,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 12157,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3968865126,
      "number": 34637,
      "title": "\"txospenderindex_tests/txospenderindex_initial_sync\": critical check tx_spender->has_value() has failed",
      "body": "https://github.com/bitcoin/bitcoin/actions/runs/22227876457/job/64299801435?pr=34615#step:8:652\n```bash\n\n./test/txospenderindex_tests.cpp(15): Entering test case \"txospenderindex_initial_sync\"\n./test/txospenderindex_tests.cpp(60): fatal error: in \"txospenderindex_tests/txospenderindex_initial_sync\": critical check tx_spender->has_value() has failed\nCommand '['./bin/test_bitcoin.exe', '-l', 'test_suite']' returned non-zero exit status 3221225477.\n\n```",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-02-20T14:38:17Z",
      "updated_at": "2026-02-24T19:12:42Z",
      "closed_at": "2026-02-24T19:12:42Z",
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/issues/34637",
      "labels": [],
      "comment_data": [
        {
          "id": 3935644369,
          "user": "hodlinator",
          "body": "Notable that it only happens on Windows UCRT in the linked run, indicating probable insufficient synchronization between txospenderindex and the new block in chainstate. Maybe we should move `SyncWithValidationInterfaceQueue()` before the failing check?",
          "created_at": "2026-02-20T15:38:36Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 253,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3935792416,
          "user": "sedited",
          "body": "> Maybe we should move SyncWithValidationInterfaceQueue() before the failing check?\n\n`BlockUntilSyncedToCurrentChain()` should already be doing that. It's a bit puzzling, I also couldn't reproduce a failure after 10'000 test runs. ",
          "created_at": "2026-02-20T16:10:19Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 231,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3940013120,
          "user": "w0xlt",
          "body": "`BlockUntilSyncedToCurrentChain()` wouldn't catch this. After `Sync()`, both `best_block_index` and `chain_tip` are at block 151, so it takes the early return without draining the queue:\n\n```cpp\n  if (best_block_index->GetAncestor(chain_tip->nHeight) == chain_tip) {\n      return true;  // skips SyncWithValidationInterfaceQueue()\n  }\n```\n\nThe issue looks to be that 51 `BlockConnected` callbacks (for blocks mined between `Init()` and `Sync()`) are still pending in the validation interface queue. When the scheduler delivers the stale callbacks and `BlockConnected` sees `best_block_index=151` but receives a notification for `pindex=101`, it interprets this as: \"_I'm at 151, but I need to  process block 101 — I must have missed something, let me rewind to block 100 and re-index from there._\" That rewind erases the spending entries for blocks 101-151.\n\n```cpp\nif (best_block_index != pindex->pprev && !Rewind(best_block_index, pindex->pprev)) {\n```\n\nOn Linux the scheduler seems to drain those callbacks before `Sync()` sets `m_synced = true`. But the error can be deterministically triggered by firing a stale `BlockConnected` directly after `Sync()`:\n\n<details>\n  <summary>diff</summary>\n\n```diff\ndiff --git a/src/test/txospenderindex_tests.cpp b/src/test/txospenderindex_tests.cpp\nindex 889ef7ff8a..fef331afe4 100644\n--- a/src/test/txospenderindex_tests.cpp\n+++ b/src/test/txospenderindex_tests.cpp\n@@ -4,7 +4,10 @@\n \n #include <chainparams.h>\n #include <index/txospenderindex.h>\n+#include <kernel/types.h>\n+#include <node/blockstorage.h>\n #include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n #include <util/time.h>\n #include <validation.h>\n \n@@ -54,6 +57,24 @@ BOOST_FIXTURE_TEST_CASE(txospenderindex_initial_sync, TestChain100Setup)\n     BOOST_CHECK(!txospenderindex.BlockUntilSyncedToCurrentChain());\n \n     txospenderindex.Sync();\n+\n+    // Simulate a stale BlockConnected callback: fire BlockConnected for block\n+    // 101, which Sync() already indexed. Since m_synced is now true, this\n+    // triggers Rewind(tip, 100), erasing spending entries for blocks 101-tip.\n+    // This reproduces the race in issue #34637 deterministically.\n+    {\n+        const CBlockIndex* stale_pindex;\n+        {\n+            LOCK(cs_main);\n+            stale_pindex = m_node.chainman->ActiveChain()[101];\n+        }\n+        CBlock stale_block;\n+        m_node.chainman->ActiveChainstate().m_blockman.ReadBlock(stale_block, *stale_pindex);\n+        auto shared_block = std::make_shared<CBlock>(stale_block);\n+        ValidationInterfaceTest::BlockConnected(\n+            kernel::ChainstateRole{}, txospenderindex, shared_block, stale_pindex);\n+    }\n+\n     for (size_t i = 0; i < spent.size(); i++) {\n         const auto tx_spender{txospenderindex.FindSpender(spent[i])};\n         BOOST_REQUIRE(tx_spender.has_value());\n```\n</details>\n\nAdding `SyncWithValidationInterfaceQueue()` after `Sync()` to unconditionally drain the stale callbacks before querying the index should work, as observed by @hodlinator .\n\n<details>\n  <summary>diff</summary>\n\n```diff\ndiff --git a/src/test/txospenderindex_tests.cpp b/src/test/txospenderindex_tests.cpp\nindex 889ef7ff8a..4aaa5513de 100644\n--- a/src/test/txospenderindex_tests.cpp\n+++ b/src/test/txospenderindex_tests.cpp\n@@ -54,6 +54,12 @@ BOOST_FIXTURE_TEST_CASE(txospenderindex_initial_sync, TestChain100Setup)\n     BOOST_CHECK(!txospenderindex.BlockUntilSyncedToCurrentChain());\n \n     txospenderindex.Sync();\n+\n+    // Drain stale BlockConnected callbacks that were enqueued for blocks created\n+    // between Init() and Sync(). After Sync() sets m_synced = true, these\n+    // callbacks can trigger unnecessary rewinds until fully processed.\n+    m_node.validation_signals->SyncWithValidationInterfaceQueue();\n+\n     for (size_t i = 0; i < spent.size(); i++) {\n         const auto tx_spender{txospenderindex.FindSpender(spent[i])};\n         BOOST_REQUIRE(tx_spender.has_value());\n```\n</details>",
          "created_at": "2026-02-22T03:08:41Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 3952,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3941987689,
          "user": "furszy",
          "body": "Oh, just realized your comment w0xlt. I have been cooking some deep index changes to completely eradicate the underlying problem with `BlockUntilSyncedToCurrentChain()`, not only to fix the test. Still in draft and not ready [branch](https://github.com/furszy/bitcoin-core/tree/2026_index_fix_inconsistent_state_and_extra_disk_reads).\n\nBut.. I got sidetracked today by the new txospender tests code and ended up cleaning them up. They weren't easy to read or work with. So I pushed #34653 to make our future selves' and future devs' lives easier (hopefully).\n\nThis isn’t blocking the direct test fix you are suggesting. I will happily ACK that too. Just sharing an update that there is more here, and will be pushing a new PR \"soon\".\n",
          "created_at": "2026-02-23T00:21:01Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 1,
            "text_length": 734,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3945263562,
          "user": "hebasto",
          "body": "> Notable that it only happens on Windows UCRT...\n\nHere is the log for MSVCRT: https://github.com/bitcoin/bitcoin/actions/runs/22237824844/job/64344924186?pr=33974.",
          "created_at": "2026-02-23T14:59:02Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 164,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3947676363,
          "user": "achow101",
          "body": "To clarify, does #34653 fix this issue?",
          "created_at": "2026-02-23T22:23:57Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 39,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3947774161,
          "user": "furszy",
          "body": "> To clarify, does [#34653](https://github.com/bitcoin/bitcoin/pull/34653) fix this issue?\n\nYes. #34653 drains the validation queue before constructing the index, so no lagging notification will arrive during the post-`Sync()` checks. It also introduces a post-`Sync()` assertion that ensures the index is fully synced and did not abort prematurely before the checks are run.\n\nExtra fun fact: I did this without thinking about the issue. I was just focused on cleaning up the test first. So.. would say that we should clean up code more often.\n\nUpdated #34653 description saying this is fixed there.",
          "created_at": "2026-02-23T22:48:40Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 0,
            "text_length": 599,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3947841804,
          "user": "achow101",
          "body": "Was able to actually reproduce the issue with\n\n```diff\ndiff --git a/src/index/base.cpp b/src/index/base.cpp\nindex fba2f4f6c10..571347d42f1 100644\n--- a/src/index/base.cpp\n+++ b/src/index/base.cpp\n@@ -49,6 +49,12 @@ constexpr uint8_t DB_BEST_BLOCK{'B'};\n constexpr auto SYNC_LOG_INTERVAL{30s};\n constexpr auto SYNC_LOCATOR_WRITE_INTERVAL{30s};\n \n+std::atomic<bool> g_debug_waiting{false};\n+std::atomic<bool> g_debug_continue{false};\n+std::mutex g_debug_mutex;\n+std::condition_variable g_debug_cv;\n+Mutex g_index_mutex;\n+\n template <typename... Args>\n void BaseIndex::FatalErrorf(util::ConstevalFormatString<sizeof...(Args)> fmt, const Args&... args)\n {\n@@ -200,6 +206,16 @@ bool BaseIndex::ProcessBlock(const CBlockIndex* pindex, const CBlock* block_data\n \n void BaseIndex::Sync()\n {\n+    LOCK(g_index_mutex);\n+\n+    {\n+        g_debug_continue = false;\n+        g_debug_waiting = true;\n+        std::unique_lock<std::mutex> lock(g_debug_mutex);\n+        g_debug_cv.wait_for(lock, std::chrono::seconds(2), [] { return g_debug_continue.load(); });\n+        g_debug_waiting = false;\n+    }\n+\n     const CBlockIndex* pindex = m_best_block_index.load();\n     if (!m_synced) {\n         auto last_log_time{NodeClock::now()};\n@@ -327,6 +343,14 @@ bool BaseIndex::Rewind(const CBlockIndex* current_tip, const CBlockIndex* new_ti\n \n void BaseIndex::BlockConnected(const ChainstateRole& role, const std::shared_ptr<const CBlock>& block, const CBlockIndex* pindex)\n {\n+    UninterruptibleSleep(100ms);\n+    if (g_debug_waiting) {\n+        g_debug_continue = true;\n+        g_debug_cv.notify_all();\n+    }\n+\n+    LOCK(g_index_mutex);\n+\n     // Ignore events from not fully validated chains to avoid out-of-order indexing.\n     //\n     // TODO at some point we could parameterize whether a particular index can be\n```",
          "created_at": "2026-02-23T23:06:57Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 1803,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3950607405,
          "user": "hebasto",
          "body": "On NetBSD 10.1: https://github.com/hebasto/bitcoin-core-nightly/actions/runs/22336622975/job/64630655628.",
          "created_at": "2026-02-24T10:18:40Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 105,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 558,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3967338664,
      "number": 34632,
      "title": "`listtransactions` does not list tx that spends only change outputs to a change address",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nI described this issue in a PR comment [here](https://github.com/bitcoin/bitcoin/pull/33671#issuecomment-3931638422), but @achow101 requested that I open a separate issue, stating that my problem is distinct from the one addressed by that PR.\n\nThe problem is that Bitcoin Core v30.2 has apparently forgotten about a transaction that I created, signed, and broadcast to consolidate some outputs. The outputs that I spent in the transaction are no longer listed by `listunspent`, but neither is the spending transaction listed by `listtransactions`. My transaction drew three inputs from a single wallet and sent one output back into that same wallet, but that unconfirmed incoming amount is not accounted for anywhere. `getbalance` and `getbalances` do not include the amount. Effectively, it looks as though I have simply lost money. I can retrieve the transaction by specifying its TxID to `gettransaction`, but the transaction does not appear in `listtransactions`.\n\n### Expected behaviour\n\n`listtransactions` should show all transactions involving addresses in the wallet, even if those transactions are unconfirmed, and even if they have been evicted from the local node's mempool.\n\n### Steps to reproduce\n\n1. Have three outputs, all sent to the same P2WPKH address. Mine were all sent in different transactions.\n2. Construct a transaction to consolidate the three outputs into a single output to that same address. (Yes, I know that broadcasting this transaction makes the address less quantum-resistant because its EC pubkey is now published.)\n    ```\n    $ bitcoin-tx -create in=a1b2…c3d4:0 in=b1c2…d3e4:2 in=c1d2…e3f4:1 outaddr=12.345:bc1q…etc\n    ```\n    **Note:** The amount specified in the `outaddr` argument is exactly the sum of the amounts of the three inputs.\n3. Calculate and deduct a minimal fee from the output.\n    ```\n    $ bitcoin-cli -rpcwallet=\"${wallet}\" fundrawtransaction \"${hex}\" '{\"add_inputs\":false,\"subtractFeeFromOutputs\":[0],\"fee_rate\":0.1}'\n    ```\n4. Sign the transaction using the wallet.\n    ```\n    $ bitcoin-cli -rpcwallet=\"${wallet}\" signrawtransactionwithwallet \"${hex}\"\n    ```\n5. Broadcast the signed transaction.\n    ```\n    $ bitcoin-cli sendrawtransaction \"${hex}\"\n    ```\n    **Note:** No `-rpcwallet=` argument was specified in this command.\n6. Somehow cause the transaction to be evicted from the local node's mempool.\n    ```\n    $ bitcoin-cli getrawtransaction \"${txid}\"\n    error code: -5\n    error message:\n    No such mempool transaction. Use -txindex or provide a block hash to enable blockchain transaction queries. Use gettransaction for wallet transactions.\n    ```\n7. Attempt to find the transaction in the output of `listtransactions`.\n    ```\n    $ bitcoin-cli -rpcwallet=\"${wallet}\" listtransactions '*' 10000 | jq --arg txid \"${txid}\" '.[] | select(.txid == $txid)'\n    ```\n    It's not there.\n8. Query the wallet's balance.\n    ```\n    $ bitcoin-cli -rpcwallet=\"${wallet}\" -named getbalance minconf=0 avoid_reuse=false\n    ```\n    The money is apparently missing!\n9. Query the wallet for the missing transaction.\n    ```\n    $ bitcoin-cli -rpcwallet=\"${wallet}\" -named gettransaction txid=\"${txid}\" verbose=true\n    ```\n    The wallet indeed knows about the transaction and reports `\"confirmations\": 0`, yet the transaction is not accounted for anywhere.\n\n### Relevant log output\n\nThe node's `debug.log` does include a line `AddToWallet ${txid}  new InMempool` dated when the transaction was originally broadcast. It also includes another line, dated about 18½ hours later: `Submitting wtx ${txid} to mempool for relay`. There are no other mentions of the TxID in the log.\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nv30.2\n\n### Operating system and version\n\nGentoo Linux\n\n### Machine specifications\n\nLinux 6.12.58-gentoo x86_64",
      "state": "open",
      "user": "whitslack",
      "created_at": "2026-02-20T08:44:36Z",
      "updated_at": "2026-02-24T18:16:22Z",
      "closed_at": null,
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/34632",
      "labels": [
        "Wallet"
      ],
      "comment_data": [
        {
          "id": 3937930665,
          "user": "achow101",
          "body": "Following the instruction as written, I'm unable to reproduce this. The transaction shows up as expected in `listtransactions`.\n\nHowever, `listtransactions` does do interpretation of transactions in order to make \"logical transactions\" to avoid confusing users with various Bitcoin internals (e.g. change, multiple inputs, etc.). This includes excluding outputs that the wallet things are change. If I send to a change address, then the transaction does not show up, and I think that's the only way to make that happen.\n\nHow did you get the address you sent to? What is the output of `getaddressinfo` for the output address?\n\n***\n\nWe should probably have a `listrawtransactions` RPC that just outputs all of the transactions known to the wallet without trying to interpret things.",
          "created_at": "2026-02-21T02:06:51Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 780,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3937966138,
          "user": "whitslack",
          "body": "@achow101: Thank you for your efforts. The output address is in fact a change address. `getaddressinfo` reports `\"ischange\": true`, and the descriptor from which the address was derived is marked as `\"internal\": true`. The use case is merging multiple \"dusting attack\" outputs into the same address that they had dusted so as to reveal no information to the attacker (other than that the address is still being watched and the private key for it is still known). When the dusting attack is made against an address that had originally been used to receive change, then merging the dust outputs into the change output and reusing that change address means that the merged output will be going to a change address.",
          "created_at": "2026-02-21T02:32:46Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 1,
            "text_length": 711,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3953367745,
          "user": "darosior",
          "body": "@whitslack As an alternative, you may want to use `listsinceblock` which allows you to set an `include_change` parameter to `true`.",
          "created_at": "2026-02-24T16:42:02Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 131,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3953874136,
          "user": "whitslack",
          "body": "> As an alternative, you may want to use `listsinceblock` which allows you to set an `include_change` parameter to `true`.\n\n@darosior: Thank you! I was previously unaware of that RPC. Yes, indeed, when I call `listsinceblock` with `include_change=true`, then I can see my consolidation transaction, which appears twice: once with `\"category\": \"send\"` and again with `\"category\": \"receive\"`, which makes sense. The only slight annoyance is the need to choose a suitable `blockhash`. I just used the block hash from the transaction reported by `listtransactions '*' 1` to list all my \"filtered\" transactions that have occurred since the last unfiltered one. Works well enough, although I do still wish that `listtransactions` could be told to include transactions to change addresses too.\n\nIncidentally, although my consolidation transaction has now confirmed, it's still not showing in `listtransactions`, although now it _is_ included in `getbalance`.",
          "created_at": "2026-02-24T18:16:12Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 951,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 4052,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3984160728,
      "number": 34663,
      "title": "ci: failure in `interface_zmq.py`",
      "body": "https://github.com/bitcoin/bitcoin/actions/runs/22352345876/job/64682517438#step:11:12556\n```bash\ntest  2026-02-24T13:34:27.369223Z TestFramework (DEBUG): Destroying ZMQ context \n test  2026-02-24T13:34:27.369538Z TestFramework (ERROR): Unexpected exception: \n                                   Traceback (most recent call last):\n                                     File \"/home/admin/actions-runner/_work/_temp/test/functional/test_framework/test_framework.py\", line 142, in main\n                                       self.run_test()\n                                     File \"/home/admin/actions-runner/_work/_temp/build/test/functional/interface_zmq.py\", line 131, in run_test\n                                       self.test_multiple_interfaces()\n                                     File \"/home/admin/actions-runner/_work/_temp/build/test/functional/interface_zmq.py\", line 563, in test_multiple_interfaces\n                                       subscribers = self.setup_zmq_test([\n                                                     ^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/home/admin/actions-runner/_work/_temp/build/test/functional/interface_zmq.py\", line 162, in setup_zmq_test\n                                       test_block = ZMQTestSetupBlock(self, self.nodes[0])\n                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/home/admin/actions-runner/_work/_temp/build/test/functional/interface_zmq.py\", line 93, in __init__\n                                       self.block_hash = test_framework.generate(node, 1, sync_fun=test_framework.no_op)[0]\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/home/admin/actions-runner/_work/_temp/test/functional/test_framework/test_framework.py\", line 663, in generate\n                                       blocks = generator.generate(*args, called_by_framework=True, **kwargs)\n                                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/home/admin/actions-runner/_work/_temp/test/functional/test_framework/test_node.py\", line 411, in generate\n                                       return self.generatetoaddress(nblocks=nblocks, address=self.get_deterministic_priv_key().address, maxtries=maxtries, **kwargs)\n                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/home/admin/actions-runner/_work/_temp/test/functional/test_framework/test_node.py\", line 419, in generatetoaddress\n                                       return self.__getattr__('generatetoaddress')(*args, **kwargs)\n                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/home/admin/actions-runner/_work/_temp/test/functional/test_framework/coverage.py\", line 50, in __call__\n                                       return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\n                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/home/admin/actions-runner/_work/_temp/test/functional/test_framework/authproxy.py\", line 133, in __call__\n                                       response, status = self._request('POST', self.__url.path, postdata.encode('utf-8'))\n                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/home/admin/actions-runner/_work/_temp/test/functional/test_framework/authproxy.py\", line 107, in _request\n                                       return self._get_response()\n                                              ^^^^^^^^^^^^^^^^^^^^\n                                     File \"/home/admin/actions-runner/_work/_temp/test/functional/test_framework/authproxy.py\", line 170, in _get_response\n                                       http_response = self.__conn.getresponse()\n                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/usr/lib/python3.12/http/client.py\", line 1448, in getresponse\n                                       response.begin()\n                                     File \"/usr/lib/python3.12/http/client.py\", line 336, in begin\n                                       version, status, reason = self._read_status()\n                                                                 ^^^^^^^^^^^^^^^^^^^\n                                     File \"/usr/lib/python3.12/http/client.py\", line 305, in _read_status\n                                       raise RemoteDisconnected(\"Remote end closed connection without\"\n                                   http.client.RemoteDisconnected: Remote end closed connection without response\n\n```",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-02-24T14:52:12Z",
      "updated_at": "2026-02-24T16:33:26Z",
      "closed_at": "2026-02-24T16:33:26Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34663",
      "labels": [
        "CI failed"
      ],
      "comment_data": [
        {
          "id": 3953217183,
          "user": "maflcko",
          "body": "Duplicate of https://github.com/bitcoin/bitcoin/issues/34503 and https://github.com/bitcoin/bitcoin/issues/33948",
          "created_at": "2026-02-24T16:15:11Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 112,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 5161,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3967266428,
      "number": 34631,
      "title": "Intermittent failure of p2p_private_broadcast.py",
      "body": "Not sure if this is from the original PR or #34329\n\n<details>\n<summary>Logs:</summary>\n\n\n```\n455/455 - p2p_private_broadcast.py failed, Duration: 84 s                              \n\nstdout:\n2026-02-20T08:16:52.932185Z TestFramework (INFO): PRNG seed is: 5474091116900090230\n2026-02-20T08:16:52.932503Z TestFramework (INFO): Initializing test directory /tmp/merging_clang_build_Debug/test_runner_₿_🏃_20260220_091548/p2p_private_broadcast_74\n2026-02-20T08:16:58.196783Z TestFramework (INFO): Created txid=2db3a22f9370eb32f110597882acebef1c76cf319837bac69b829917730d2349: for basic test\n2026-02-20T08:16:58.196839Z TestFramework (INFO): Created txid=1586df3125397f95009109f8978a656d966eba39b36bb7552d0cfa703e58d84a: for broadcast with dependency in mempool + rebroadcast\n2026-02-20T08:16:58.196858Z TestFramework (INFO): Created txid=f4580414da8808a9772291d522281ba7d3c5d4ad480cde6580b5363590ec79d2: for broadcast with dependency not in mempool\n2026-02-20T08:17:13.762676Z TestFramework (INFO): Outbound connection i=10: the private broadcast target received and further relayed the transaction\n2026-02-20T08:17:13.762865Z TestFramework (INFO): Basic: ok: outbound connection i=11 is private broadcast of txid=2db3a22f9370eb32f110597882acebef1c76cf319837bac69b829917730d2349\n2026-02-20T08:17:13.762948Z TestFramework (INFO): Basic: ok: outbound connection i=12 is private broadcast of txid=2db3a22f9370eb32f110597882acebef1c76cf319837bac69b829917730d2349\n2026-02-20T08:17:13.764109Z TestFramework (INFO): Resending the same transaction via RPC again (it is not in the mempool yet)\n2026-02-20T08:17:13.765058Z TestFramework (INFO): Sending a malleated transaction with an invalid witness via RPC\n2026-02-20T08:17:13.766052Z TestFramework (INFO): Checking that the transaction is not in the originator node's mempool\n2026-02-20T08:17:13.766348Z TestFramework (INFO): Sending INV and waiting for GETDATA from node\n2026-02-20T08:17:13.817260Z TestFramework (INFO): Waiting for normal broadcast to another peer\n2026-02-20T08:17:16.720760Z TestFramework (INFO): Checking getprivatebroadcastinfo no longer reports the transaction after it is received back\n2026-02-20T08:17:16.721406Z TestFramework (INFO): Checking abortprivatebroadcast removes a pending private-broadcast transaction\n2026-02-20T08:17:16.723782Z TestFramework (INFO): Checking abortprivatebroadcast fails for non-existent transaction\n2026-02-20T08:17:16.724255Z TestFramework (INFO): Sending a transaction that is already in the mempool\n2026-02-20T08:17:16.925456Z TestFramework (INFO): Broadcast of mempool transaction: ok: outbound connection i=13 is private broadcast of txid=2db3a22f9370eb32f110597882acebef1c76cf319837bac69b829917730d2349\n2026-02-20T08:17:16.975699Z TestFramework (INFO): Broadcast of mempool transaction: ok: outbound connection i=14 is private broadcast of txid=2db3a22f9370eb32f110597882acebef1c76cf319837bac69b829917730d2349\n2026-02-20T08:17:17.075987Z TestFramework (INFO): Broadcast of mempool transaction: ok: outbound connection i=15 is private broadcast of txid=2db3a22f9370eb32f110597882acebef1c76cf319837bac69b829917730d2349\n2026-02-20T08:17:17.076719Z TestFramework (INFO): Sending a transaction with a dependency in the mempool\n2026-02-20T08:17:17.228560Z TestFramework (INFO): Dependency in mempool: ok: outbound connection i=16 is private broadcast of txid=1586df3125397f95009109f8978a656d966eba39b36bb7552d0cfa703e58d84a\n2026-02-20T08:17:17.278785Z TestFramework (INFO): Dependency in mempool: ok: outbound connection i=17 is private broadcast of txid=1586df3125397f95009109f8978a656d966eba39b36bb7552d0cfa703e58d84a\n2026-02-20T08:17:17.328990Z TestFramework (INFO): Dependency in mempool: ok: outbound connection i=18 is private broadcast of txid=1586df3125397f95009109f8978a656d966eba39b36bb7552d0cfa703e58d84a\n2026-02-20T08:17:17.329712Z TestFramework (INFO): Sending a transaction with a dependency not in the mempool (should be rejected)\n2026-02-20T08:17:17.331228Z TestFramework (INFO): Checking that rebroadcast works\n2026-02-20T08:18:17.331354Z TestFramework (ERROR): Unexpected exception:\nTraceback (most recent call last):\n  File \"/home/user/bitcoin/test/functional/test_framework/test_framework.py\", line 142, in main\n    self.run_test()\n  File \"/home/user/bitcoin/clang_build/Debug/test/functional/p2p_private_broadcast.py\", line 429, in run_test\n    with tx_originator.busy_wait_for_debug_log(expected_msgs=[rebroadcast_msg.encode()]):\n  File \"/usr/lib/python3.12/contextlib.py\", line 144, in __exit__\n    next(self.gen)\n  File \"/home/user/bitcoin/test/functional/test_framework/test_node.py\", line 616, in busy_wait_for_debug_log\n    self._raise_assertion_error(f'Expected message(s) {remaining_expected!s} '\n  File \"/home/user/bitcoin/test/functional/test_framework/test_node.py\", line 229, in _raise_assertion_error\n    raise AssertionError(self._node_msg(msg))\nAssertionError: [node 0] Expected message(s) [b'Reattempting broadcast of stale txid=1586df3125397f95009109f8978a656d966eba39b36bb7552d0cfa703e58d84a'] not found in log:\n\n - 2026-02-20T08:17:17.331379Z [http] [httpserver.cpp:233] [http_request_cb] [http] Received a POST request for / from 127.0.0.1:36796\n - 2026-02-20T08:17:17.331431Z [http_pool_1] [rpc/request.cpp:243] [parse] [rpc] ThreadRPCServer method=setmocktime user=__cookie__\n - 2026-02-20T08:17:17.331568Z (mocktime: 2026-02-20T08:37:17Z) [http] [httpserver.cpp:233] [http_request_cb] [http] Received a POST request for / from 127.0.0.1:36796\n - 2026-02-20T08:17:17.331669Z (mocktime: 2026-02-20T08:37:17Z) [http_pool_0] [rpc/request.cpp:243] [parse] [rpc] ThreadRPCServer method=mockscheduler user=__cookie__\n - 2026-02-20T08:17:17.331823Z (mocktime: 2026-02-20T08:37:17Z) [scheduler] [net.cpp:2438] [StartExtraBlockRelayPeers] [net] enabling extra block-relay-only peers\n - 2026-02-20T08:17:17.333250Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending ping (8 bytes) peer=2\n - 2026-02-20T08:17:17.333389Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending getheaders (645 bytes) peer=2\n - 2026-02-20T08:17:17.333462Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:5339] [ConsiderEviction] [net] sending getheaders to outbound peer=2 to verify chain work (current best known block:<none>, benchmark blockhash: 76b181cf5782e03af6adb8f990404168f05f9abd940e7a4e92a33e6044d1f6a5)\n - 2026-02-20T08:17:17.333508Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: pong (8 bytes) peer=19\n - 2026-02-20T08:17:17.333530Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:5012] [ProcessMessage] [privatebroadcast] Got a PONG (the transaction will probably reach the network), marking for disconnect, peer=19\n - 2026-02-20T08:17:17.333574Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending ping (8 bytes) peer=7\n - 2026-02-20T08:17:17.333613Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention pnode->m_sock_mutex, net.cpp:2138 started\n - 2026-02-20T08:17:17.333631Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention pnode->m_sock_mutex, net.cpp:2138 completed (0μs)\n - 2026-02-20T08:17:17.333648Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending inv (37 bytes) peer=7\n - 2026-02-20T08:17:17.333662Z (mocktime: 2026-02-20T08:37:17Z) [net] [net.cpp:558] [CloseSocketDisconnect] [net] Resetting socket for peer=19\n - 2026-02-20T08:17:17.333687Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending getheaders (645 bytes) peer=7\n - 2026-02-20T08:17:17.333749Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:5339] [ConsiderEviction] [net] sending getheaders to outbound peer=7 to verify chain work (current best known block:<none>, benchmark blockhash: 76b181cf5782e03af6adb8f990404168f05f9abd940e7a4e92a33e6044d1f6a5)\n - 2026-02-20T08:17:17.333802Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending ping (8 bytes) peer=1\n - 2026-02-20T08:17:17.333900Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending getheaders (645 bytes) peer=1\n - 2026-02-20T08:17:17.333936Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention pnode->cs_vSend, net.cpp:2072 started\n - 2026-02-20T08:17:17.333953Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention pnode->cs_vSend, net.cpp:2072 completed (0μs)\n - 2026-02-20T08:17:17.333964Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:5339] [ConsiderEviction] [net] sending getheaders to outbound peer=1 to verify chain work (current best known block:<none>, benchmark blockhash: 76b181cf5782e03af6adb8f990404168f05f9abd940e7a4e92a33e6044d1f6a5)\n - 2026-02-20T08:17:17.334016Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending ping (8 bytes) peer=6\n - 2026-02-20T08:17:17.334055Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention pnode->m_sock_mutex, net.cpp:2138 started\n - 2026-02-20T08:17:17.334067Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention pnode->m_sock_mutex, net.cpp:2138 completed (0μs)\n - 2026-02-20T08:17:17.334078Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending getheaders (645 bytes) peer=6\n - 2026-02-20T08:17:17.334150Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:5339] [ConsiderEviction] [net] sending getheaders to outbound peer=6 to verify chain work (current best known block:<none>, benchmark blockhash: 76b181cf5782e03af6adb8f990404168f05f9abd940e7a4e92a33e6044d1f6a5)\n - 2026-02-20T08:17:17.334192Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending ping (8 bytes) peer=9\n - 2026-02-20T08:17:17.334265Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending getheaders (645 bytes) peer=9\n - 2026-02-20T08:17:17.334340Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:5339] [ConsiderEviction] [net] sending getheaders to outbound peer=9 to verify chain work (current best known block:<none>, benchmark blockhash: 76b181cf5782e03af6adb8f990404168f05f9abd940e7a4e92a33e6044d1f6a5)\n - 2026-02-20T08:17:17.334378Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending ping (8 bytes) peer=3\n - 2026-02-20T08:17:17.334470Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending getheaders (645 bytes) peer=3\n - 2026-02-20T08:17:17.334526Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention pnode->m_sock_mutex, net.cpp:2138 started\n - 2026-02-20T08:17:17.334542Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:5339] [ConsiderEviction] [net] sending getheaders to outbound peer=3 to verify chain work (current best known block:<none>, benchmark blockhash: 76b181cf5782e03af6adb8f990404168f05f9abd940e7a4e92a33e6044d1f6a5)\n - 2026-02-20T08:17:17.334551Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention pnode->m_sock_mutex, net.cpp:2138 completed (0μs)\n - 2026-02-20T08:17:17.334568Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending ping (8 bytes) peer=0\n - 2026-02-20T08:17:17.334609Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention pnode->cs_vSend, net.cpp:2072 started\n - 2026-02-20T08:17:17.334622Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention pnode->cs_vSend, net.cpp:2072 completed (4μs)\n - 2026-02-20T08:17:17.334656Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending getheaders (645 bytes) peer=0\n - 2026-02-20T08:17:17.334719Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:5339] [ConsiderEviction] [net] sending getheaders to outbound peer=0 to verify chain work (current best known block:<none>, benchmark blockhash: 76b181cf5782e03af6adb8f990404168f05f9abd940e7a4e92a33e6044d1f6a5)\n - 2026-02-20T08:17:17.334749Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending ping (8 bytes) peer=5\n - 2026-02-20T08:17:17.334830Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending getheaders (645 bytes) peer=5\n - 2026-02-20T08:17:17.334893Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:5339] [ConsiderEviction] [net] sending getheaders to outbound peer=5 to verify chain work (current best known block:<none>, benchmark blockhash: 76b181cf5782e03af6adb8f990404168f05f9abd940e7a4e92a33e6044d1f6a5)\n - 2026-02-20T08:17:17.334941Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending ping (8 bytes) peer=8\n - 2026-02-20T08:17:17.334972Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention pnode->m_sock_mutex, net.cpp:2138 started\n - 2026-02-20T08:17:17.334983Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention pnode->m_sock_mutex, net.cpp:2138 completed (0μs)\n - 2026-02-20T08:17:17.335000Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending getheaders (645 bytes) peer=8\n - 2026-02-20T08:17:17.335068Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:5339] [ConsiderEviction] [net] sending getheaders to outbound peer=8 to verify chain work (current best known block:<none>, benchmark blockhash: 76b181cf5782e03af6adb8f990404168f05f9abd940e7a4e92a33e6044d1f6a5)\n - 2026-02-20T08:17:17.335110Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending ping (8 bytes) peer=4\n - 2026-02-20T08:17:17.335163Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention pnode->cs_vSend, net.cpp:2072 started\n - 2026-02-20T08:17:17.335177Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention pnode->cs_vSend, net.cpp:2072 completed (0μs)\n - 2026-02-20T08:17:17.335190Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending getheaders (645 bytes) peer=4\n - 2026-02-20T08:17:17.335247Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:5339] [ConsiderEviction] [net] sending getheaders to outbound peer=4 to verify chain work (current best known block:<none>, benchmark blockhash: 76b181cf5782e03af6adb8f990404168f05f9abd940e7a4e92a33e6044d1f6a5)\n - 2026-02-20T08:17:17.335294Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention cs_main, net_processing.cpp:1680 started\n - 2026-02-20T08:17:17.335304Z (mocktime: 2026-02-20T08:37:17Z) [net] [logging/timer.h:58] [Log] [lock] Enter: lock contention cs_main, net_processing.cpp:1680 completed (0μs)\n - 2026-02-20T08:17:17.335311Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: pong (8 bytes) peer=0\n - 2026-02-20T08:17:17.335335Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [logging/timer.h:58] [Log] [lock] Enter: lock contention cs_main, net_processing.cpp:5614 started\n - 2026-02-20T08:17:17.335343Z (mocktime: 2026-02-20T08:37:17Z) [net] [net_processing.cpp:1750] [FinalizeNode] [net] Cleared nodestate for peer=19\n - 2026-02-20T08:17:17.335351Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [logging/timer.h:58] [Log] [lock] Enter: lock contention cs_main, net_processing.cpp:5614 completed (0μs)\n - 2026-02-20T08:17:17.335403Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: pong (8 bytes) peer=3\n - 2026-02-20T08:17:17.335455Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: pong (8 bytes) peer=7\n - 2026-02-20T08:17:17.335481Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: pong (8 bytes) peer=5\n - 2026-02-20T08:17:17.335506Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: pong (8 bytes) peer=4\n - 2026-02-20T08:17:17.335532Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: pong (8 bytes) peer=2\n - 2026-02-20T08:17:17.335557Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: pong (8 bytes) peer=1\n - 2026-02-20T08:17:17.335583Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: pong (8 bytes) peer=8\n - 2026-02-20T08:17:17.335606Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: pong (8 bytes) peer=6\n - 2026-02-20T08:17:17.335632Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: pong (8 bytes) peer=9\n - 2026-02-20T08:17:17.335727Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: getdata (37 bytes) peer=7\n - 2026-02-20T08:17:17.335735Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:4225] [ProcessMessage] [net] received getdata (1 invsz) peer=7\n - 2026-02-20T08:17:17.335744Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:4228] [ProcessMessage] [net] received getdata for: wtx 300386bebae3d16bdf431a264212a900e15716f784d3888fd800b583d235a389 peer=7\n - 2026-02-20T08:17:17.335777Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending tx (133 bytes) peer=7\n - 2026-02-20T08:17:17.342789Z (mocktime: 2026-02-20T08:37:17Z) [scheduler] [txmempool.cpp:435] [check] [mempool] Checking mempool with 1 transactions and 1 inputs\n - 2026-02-20T08:17:17.342847Z (mocktime: 2026-02-20T08:37:17Z) [scheduler] [net_processing.cpp:1663] [ReattemptPrivateBroadcast] [privatebroadcast] Giving up broadcast attempts for txid=2db3a22f9370eb32f110597882acebef1c76cf319837bac69b829917730d2349 wtxid=300386bebae3d16bdf431a264212a900e15716f784d3888fd800b583d235a389: txn-already-in-mempool\n - 2026-02-20T08:17:17.343326Z (mocktime: 2026-02-20T08:37:17Z) [scheduler] [net.cpp:2401] [DumpAddresses] [net] Flushed 100 addresses to peers.dat  0ms\n - 2026-02-20T08:17:17.603367Z (mocktime: 2026-02-20T08:37:17Z) [opencon] [addrman.cpp:786] [Select_] [addrman] Selected [80::1]:8333 from new\n - 2026-02-20T08:17:17.603457Z (mocktime: 2026-02-20T08:37:17Z) [opencon] [net.cpp:396] [ConnectNode] [net] trying v1 connection [80::1]:8333 lastseen=0.3hrs\n - 2026-02-20T08:17:17.603487Z (mocktime: 2026-02-20T08:37:17Z) [opencon] [net.cpp:486] [ConnectNode] [proxy] Using proxy: 127.0.0.1:11890 to connect to [80::1]:8333\n - 2026-02-20T08:17:17.603607Z (mocktime: 2026-02-20T08:37:17Z) [opencon] [netbase.cpp:396] [Socks5] [net] SOCKS5 connecting 80::1\n - 2026-02-20T08:17:17.603898Z (mocktime: 2026-02-20T08:37:17Z) [opencon] [netbase.cpp:435] [Socks5] [proxy] SOCKS5 sending proxy authentication b498d4efaac06cd7-20:b498d4efaac06cd7-20\n - 2026-02-20T08:17:17.603975Z (mocktime: 2026-02-20T08:37:17Z) [opencon] [netbase.cpp:514] [Socks5] [net] SOCKS5 connected 80::1\n - 2026-02-20T08:17:17.604089Z (mocktime: 2026-02-20T08:37:17Z) [opencon] [net.cpp:4006] [CNode] [net] Added connection peer=20\n - 2026-02-20T08:17:17.636870Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending version (114 bytes) peer=20\n - 2026-02-20T08:17:17.636987Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:1595] [PushNodeVersion] [net] send version message: version=70016, blocks=200, txrelay=0, peer=20\n - 2026-02-20T08:17:17.655393Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: version (111 bytes) peer=20\n - 2026-02-20T08:17:17.655440Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3702] [ProcessMessage] [net] receive version message: /python-p2p-tester:0.0.3/: version 70016, blocks=-1, us=0.0.0.0:0, txrelay=1, peer=20\n - 2026-02-20T08:17:17.655453Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending wtxidrelay (0 bytes) peer=20\n - 2026-02-20T08:17:17.655510Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending sendaddrv2 (0 bytes) peer=20\n - 2026-02-20T08:17:17.655559Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending verack (0 bytes) peer=20\n - 2026-02-20T08:17:17.655679Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [addrman.cpp:676] [Good_] [addrman] Moved [80::1]:8333 to tried[35][47]\n - 2026-02-20T08:17:17.655695Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [node/timeoffsets.cpp:31] [Add] [net] Added time offset -1200s, total samples 11\n - 2026-02-20T08:17:17.655879Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: wtxidrelay (0 bytes) peer=20\n - 2026-02-20T08:17:17.656325Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: verack (0 bytes) peer=20\n - 2026-02-20T08:17:17.656342Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3842] [ProcessMessage] New block-relay-only peer connected: transport: v1, version: 70016, blocks=-1 peer=20\n - 2026-02-20T08:17:17.656359Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending sendcmpct (9 bytes) peer=20\n - 2026-02-20T08:17:17.656428Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending ping (8 bytes) peer=20\n - 2026-02-20T08:17:17.656487Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net.cpp:4074] [PushMessage] [net] sending getheaders (645 bytes) peer=20\n - 2026-02-20T08:17:17.656544Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:5811] [SendMessages] [net] initial getheaders (199) to peer=20 (startheight:-1)\n - 2026-02-20T08:17:17.697564Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:3582] [ProcessMessage] [net] received: pong (8 bytes) peer=20\n - 2026-02-20T08:17:17.898187Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [logging/timer.h:58] [Log] [lock] Enter: lock contention connman.m_nodes_mutex, net.h:1812 started\n - 2026-02-20T08:17:17.898212Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [logging/timer.h:58] [Log] [lock] Enter: lock contention connman.m_nodes_mutex, net.h:1812 completed (1μs)\n - 2026-02-20T08:17:21.077693Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [i2p.cpp:418] [CreateIfNotCreatedAlready] [i2p] Creating persistent I2P SAM session 76611381d8 with 127.0.0.1:1\n - 2026-02-20T08:17:21.077810Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [netbase.cpp:584] [LogConnectFailure] connect() to 127.0.0.1:1 failed after wait: Connection refused (111)\n - 2026-02-20T08:17:21.077857Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [i2p.cpp:152] [Listen] [error] Couldn't listen: Cannot connect to 127.0.0.1:1\n - 2026-02-20T08:17:29.077977Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [i2p.cpp:418] [CreateIfNotCreatedAlready] [i2p] Creating persistent I2P SAM session ad468d1474 with 127.0.0.1:1\n - 2026-02-20T08:17:29.078063Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [netbase.cpp:584] [LogConnectFailure] connect() to 127.0.0.1:1 failed after wait: Connection refused (111)\n - 2026-02-20T08:17:29.078100Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [i2p.cpp:152] [Listen] [error] Couldn't listen: Cannot connect to 127.0.0.1:1\n - 2026-02-20T08:17:38.078194Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [i2p.cpp:418] [CreateIfNotCreatedAlready] [i2p] Creating persistent I2P SAM session 857489dee6 with 127.0.0.1:1\n - 2026-02-20T08:17:38.078258Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [netbase.cpp:584] [LogConnectFailure] connect() to 127.0.0.1:1 failed after wait: Connection refused (111)\n - 2026-02-20T08:17:38.078285Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [i2p.cpp:152] [Listen] [error] Couldn't listen: Cannot connect to 127.0.0.1:1\n - 2026-02-20T08:17:48.078396Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [i2p.cpp:418] [CreateIfNotCreatedAlready] [i2p] Creating persistent I2P SAM session 583b195c09 with 127.0.0.1:1\n - 2026-02-20T08:17:48.078489Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [netbase.cpp:584] [LogConnectFailure] connect() to 127.0.0.1:1 failed after wait: Connection refused (111)\n - 2026-02-20T08:17:48.078525Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [i2p.cpp:152] [Listen] [error] Couldn't listen: Cannot connect to 127.0.0.1:1\n - 2026-02-20T08:17:59.078597Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [i2p.cpp:418] [CreateIfNotCreatedAlready] [i2p] Creating persistent I2P SAM session d5af5b3c3c with 127.0.0.1:1\n - 2026-02-20T08:17:59.078672Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [netbase.cpp:584] [LogConnectFailure] connect() to 127.0.0.1:1 failed after wait: Connection refused (111)\n - 2026-02-20T08:17:59.078701Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [i2p.cpp:152] [Listen] [error] Couldn't listen: Cannot connect to 127.0.0.1:1\n - 2026-02-20T08:18:02.331914Z (mocktime: 2026-02-20T08:37:17Z) [scheduler] [net_processing.cpp:5393] [operator()] [net] keeping block-relay-only peer=20 chosen for eviction (connect time: 1771576637, blocks_in_flight: 0)\n - 2026-02-20T08:18:11.078881Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [i2p.cpp:418] [CreateIfNotCreatedAlready] [i2p] Creating persistent I2P SAM session 3d08732ffb with 127.0.0.1:1\n - 2026-02-20T08:18:11.079007Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [netbase.cpp:584] [LogConnectFailure] connect() to 127.0.0.1:1 failed after wait: Connection refused (111)\n - 2026-02-20T08:18:11.079052Z (mocktime: 2026-02-20T08:37:17Z) [i2paccept] [i2p.cpp:152] [Listen] [error] Couldn't listen: Cannot connect to 127.0.0.1:1\n\n\n2026-02-20T08:18:17.391487Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n```\n\n</details>",
      "state": "open",
      "user": "sedited",
      "created_at": "2026-02-20T08:26:24Z",
      "updated_at": "2026-02-24T13:18:51Z",
      "closed_at": null,
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/issues/34631",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "comment_data": [
        {
          "id": 3932437627,
          "user": "fanquake",
          "body": "cc @vasild @andrewtoth ",
          "created_at": "2026-02-20T08:39:39Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 23,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3932574631,
          "user": "maflcko",
          "body": "I guess that one is different from https://github.com/bitcoin/bitcoin/issues/34387\n\n",
          "created_at": "2026-02-20T09:13:20Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 84,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3932850114,
          "user": "maflcko",
          "body": "I was thinking this is just a `assert_debug_log` timeout issue, but the traceback shows `tx_originator.busy_wait_for_debug_log(expected_msgs=[rebroadcast_msg.encode()])`, so this must be somethign else.",
          "created_at": "2026-02-20T10:13:40Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 202,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3935224755,
          "user": "maflcko",
          "body": "There is also a third failure: https://github.com/bitcoin/bitcoin/actions/runs/22211364381/job/64246250770?pr=34628#step:9:8320:\n\n```\np2p_private_broadcast.py\", line 432, in run_test\n                                       self.check_broadcasts(\"Rebroadcast\", txs[1], 1, skip_destinations)\n                                     File \"/home/admin/actions-runner/_work/bitcoin/bitcoin/ci_build/test/functional/p2p_private_broadcast.py\", line 284, in check_broadcasts\n                                       assert_equal(peer.message_count, {\n                                     File \"/home/admin/actions-runner/_work/bitcoin/bitcoin/test/functional/test_framework/util.py\", line 78, in assert_equal\n                                       raise AssertionError(\"not(%s == %s)\\n  in particular not(%s == %s)\" % (thing1, thing2, d1, d2))\n                                   AssertionError: not(defaultdict(<class 'int'>, {'version': 1, 'verack': 1, 'inv': 1}) == {'version': 1, 'verack': 1, 'inv': 1, 'tx': 1, 'ping': 1})\n                                     in particular not({} == {'ping': 1, 'tx': 1})",
          "created_at": "2026-02-20T14:31:33Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 1095,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3939193993,
          "user": "vasild",
          "body": "> There is also a third failure ... not({} == {'ping': 1, 'tx': 1})\n\nThis one is fixed in https://github.com/bitcoin/bitcoin/pull/34646.\n\nI am not sure about the issue from the OP. There is some blocks-only connection involved which means it might be fixed by https://github.com/bitcoin/bitcoin/pull/34410. Do you have the full log?",
          "created_at": "2026-02-21T18:14:49Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 332,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3947462617,
          "user": "achow101",
          "body": "It looks like that failure in the OP is because `txs[1]` makes it into the mempool during the `wait_for_debug_log`:\n\n```\n - 2026-02-20T08:17:17.335744Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:4228] [ProcessMessage] [net] received getdata for: wtx 300386bebae3d16bdf431a264212a900e15716f784d3888fd800b583d235a389 peer=7\n - 2026-02-20T08:17:17.342847Z (mocktime: 2026-02-20T08:37:17Z) [scheduler] [net_processing.cpp:1663] [ReattemptPrivateBroadcast] [privatebroadcast] Giving up broadcast attempts for txid=2db3a22f9370eb32f110597882acebef1c76cf319837bac69b829917730d2349 wtxid=300386bebae3d16bdf431a264212a900e15716f784d3888fd800b583d235a389: txn-already-in-mempool\n```\n\nAFAICT, node0 and node1 are connected to each other, so this test is racing against normal tx relay.",
          "created_at": "2026-02-23T21:36:34Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 794,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3951763066,
          "user": "vasild",
          "body": "@achow101, thanks for looking into this. `txid=2db3... wtxid=3003...` is `tx[0]`. `node0` and `node1` are indeed connected but `node0` has sent `tx[0]` to `node1` and thus `node1` will not send it to `node0` because it knows that `node0` is aware of it. The test waits until `tx[0]` comes back to `node0`'s mempool before it proceeds to the rebroadcast section (which failed in the logs in the OP).\n\nI guess that what is happening is that one of the 3 connections fired by the newly added abort rpc tests picks up `tx[1] txid=1586...` and broadcasts it after the mocktime +20 min advance:\n\n```\n - 2026-02-20T08:17:17.333530Z (mocktime: 2026-02-20T08:37:17Z) [msghand] [net_processing.cpp:5012] [ProcessMessage] [privatebroadcast] Got a PONG (the transaction will probably reach the network), marking for disconnect, peer=19\n ```\nSo `tx[1]` is not picked for broadcast because it is not considered stale because we just sent it to somebody (peer=19) and thus the failure in the OP.\n\nTo confirm this I would like to look at the full log of the failure, not just the snippet in the OP to answer those two questions:\n1. is that connection to peer=19 broadcasting `tx[1] txid=1586...`? (presumably yes)\n2. is that connection peer=19 fired by the abort rpc tests? (presumably yes)\n\nIf \"yes\" to both, then this is fixed by https://github.com/bitcoin/bitcoin/pull/34646.\n\n@sedited Do you have the full log of the failure from the OP?",
          "created_at": "2026-02-24T13:18:50Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 1425,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 26238,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3980625672,
      "number": 34658,
      "title": "Lower minimum feerate",
      "body": "### Please describe the feature you'd like to see added.\n\nIt would be nice to have lower feerate than 0.1s/vb. I don't understand the technical details why 0.1 was arbitrary chosen. Would it not be possible to set minimum fee to 1satoshi instead of 0.1s/vb that in the end is about 25 sats depending on the size of the transaction? Also another maybe ignorant question, could it simply be measure in sats or s/vb is necessary?\n\n",
      "state": "closed",
      "user": "utente9382",
      "created_at": "2026-02-23T23:22:19Z",
      "updated_at": "2026-02-24T10:16:21Z",
      "closed_at": "2026-02-24T10:16:21Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34658",
      "labels": [
        "TX fees and policy",
        "Questions and Help"
      ],
      "comment_data": [
        {
          "id": 3950590678,
          "user": "maflcko",
          "body": "See #33106 for the rationale",
          "created_at": "2026-02-24T10:16:21Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 28,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 450,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3938408116,
      "number": 34584,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "vishalharkal15",
      "created_at": "2026-02-13T18:10:56Z",
      "updated_at": "2026-02-24T09:38:23Z",
      "closed_at": "2026-02-16T10:57:39Z",
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/34584",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3885262280,
      "number": 34476,
      "title": "Private broadcast tracking",
      "body": "_A meta issue to track the pull requests related to private broadcast_\n\n# Initial\n* 🪓 🔥 ⛔ First attempt that tried to put the transaction in the mempool ([#27509](https://github.com/bitcoin/bitcoin/pull/27509))\n* 🟢 ✔️ 🥳 Implement the ability to broadcast a transaction via a short lived privacy connection and use that for the `sendrawtransaction` RPC ([#29415](https://github.com/bitcoin/bitcoin/pull/29415))\n\n# Followups and extensions\n\n## Wallet\n\n* [ ] https://github.com/bitcoin/bitcoin/pull/33671\n* [ ] https://github.com/bitcoin/bitcoin/pull/34359\n* [ ] https://github.com/bitcoin/bitcoin/pull/34457\n* [ ] https://github.com/bitcoin/bitcoin/pull/34533\n\n## Other\n\n* [x] https://github.com/bitcoin/bitcoin/pull/34329\n* [ ] https://github.com/bitcoin/bitcoin/pull/34322\n\n# Fixes and improvements\n\n* [x] https://github.com/bitcoin/bitcoin/pull/34300\n* [x] https://github.com/bitcoin/bitcoin/pull/34267\n* [ ] https://github.com/bitcoin/bitcoin/pull/34410\n* [ ] https://github.com/bitcoin/bitcoin/pull/34271\n* [x] https://github.com/bitcoin/bitcoin/pull/34511\n* [x] https://github.com/bitcoin/bitcoin/pull/34646\n",
      "state": "open",
      "user": "vasild",
      "created_at": "2026-02-02T10:49:23Z",
      "updated_at": "2026-02-24T07:39:17Z",
      "closed_at": null,
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/34476",
      "labels": [
        "Tracking Issue"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1139,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3968351917,
      "number": 34634,
      "title": "rpc shutdown race: [error] libevent: http.c:2842: Assertion TAILQ_FIRST(&evcon->requests) == req failed in evhttp_send",
      "body": "Diff to reproduce:\n\n```diff\ndiff --git a/src/httpserver.cpp b/src/httpserver.cpp\nindex b84f0da08f..98dc24eb36 100644\n--- a/src/httpserver.cpp\n+++ b/src/httpserver.cpp\n@@ -190,2 +190,3 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+        UninterruptibleSleep(std::chrono::milliseconds{100});\n     evhttp_connection* conn{evhttp_request_get_connection(req)};\ndiff --git a/src/init.cpp b/src/init.cpp\nindex e2cdb9c647..f1a820147b 100644\n--- a/src/init.cpp\n+++ b/src/init.cpp\n@@ -1552,2 +1552,4 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n+    UninterruptibleSleep(std::chrono::milliseconds{60});\n+\n     // ********************************************************* Step 5: verify wallet database integrity\n```\n\nSteps to reproduce (takes about 3-4 tries):\n\n```\nvalgrind --tool=none ./bld-cmake/bin/bitcoind -datadir=/tmp/ -walletdir=wallets_missing -server=1 -printtoconsole=1 -debug=http -regtest -rpcuser=u -rpcpassword=pw & while sleep 0.05 ; do ./bld-cmake/bin/bitcoin-cli -datadir=/tmp/ -regtest -rpcuser=u -rpcpassword=pw getblockcount &> /dev/null ; done\n```\n\nOutput:\n\n```\n...\n2026-02-20T12:30:16Z [http] Waiting for HTTP event thread to exit\n2026-02-20T12:30:16Z [http] Received a POST request for / from 127.0.0.1:51160\n2026-02-20T12:30:16Z [error] libevent: http.c:2842: Assertion TAILQ_FIRST(&evcon->requests) == req failed in evhttp_send\n==2885428== \n==2885428== Process terminating with default action of signal 6 (SIGABRT): dumping core\n==2885428==    at 0x5D3AE5C: __pthread_kill_implementation (in /usr/lib64/libc.so.6)\n==2885428==    by 0x5CE0F0D: raise (in /usr/lib64/libc.so.6)\n==2885428==    by 0x5CC86CF: abort (in /usr/lib64/libc.so.6)\n==2885428==    by 0x57016FC: ??? (in /usr/lib64/libevent_core-2.1.so.7.0.1)\n==2885428==    by 0x571D8B2: event_errx (in /usr/lib64/libevent_core-2.1.so.7.0.1)\n==2885428==    by 0x574AD2C: evhttp_send_reply (in /usr/lib64/libevent_extra-2.1.so.7.0.1)\n==2885428==    by 0x44EDDE8: std::_Function_handler<void (), HTTPRequest::WriteReply(int, std::span<std::byte const, 18446744073709551615ul>)::$_0>::_M_invoke(std::_Any_data const&) (src/httpserver.cpp:596)\n==2885428==    by 0x44EBB87: httpevent_callback_fn(int, short, void*) (std_function.h:593)\n==2885428==    by 0x57183C7: ??? (in /usr/lib64/libevent_core-2.1.so.7.0.1)\n==2885428==    by 0x571A22E: event_base_loop (in /usr/lib64/libevent_core-2.1.so.7.0.1)\n==2885428==    by 0x44EB4CC: ThreadHTTP(event_base*) (src/httpserver.cpp:304)\n==2885428==    by 0x59833E3: ??? (in /usr/lib64/libstdc++.so.6.0.34)\n==2885428== \n[1]+  Aborted                 (core dumped) valgrind --tool=none ./bld-cmake/bin/bitcoind -datadir=/tmp/ -walletdir=wallets_missing -server=1 -printtoconsole=1 -debug=http -regtest -rpcuser=u -rpcpassword=pw\n^C\n",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-02-20T12:34:02Z",
      "updated_at": "2026-02-23T16:43:18Z",
      "closed_at": null,
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/issues/34634",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "comment_data": [
        {
          "id": 3934058587,
          "user": "maflcko",
          "body": "I initially tried to reproduce https://github.com/bitcoin/bitcoin/issues/34624, but I guess I ran into a separate issue instead?",
          "created_at": "2026-02-20T12:38:01Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 128,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3937025472,
          "user": "hodlinator",
          "body": "This seems to fix the issue - waiting for the `eventBase` dispatch thread to finish processing events *before* we free `eventHTTP`:\n\n```diff\n--- a/src/httpserver.cpp\n+++ b/src/httpserver.cpp\n@@ -473,18 +473,15 @@ void StopHTTPServer()\n         }\n         g_requests.WaitUntilEmpty();\n     }\n-    if (eventHTTP) {\n-        // Schedule a callback to call evhttp_free in the event base thread, so\n-        // that evhttp_free does not need to be called again after the handling\n-        // of unfinished request connections that follows.\n-        event_base_once(eventBase, -1, EV_TIMEOUT, [](evutil_socket_t, short, void*) {\n-            evhttp_free(eventHTTP);\n-            eventHTTP = nullptr;\n-        }, nullptr, nullptr);\n-    }\n     if (eventBase) {\n         LogDebug(BCLog::HTTP, \"Waiting for HTTP event thread to exit\\n\");\n         if (g_thread_http.joinable()) g_thread_http.join();\n+    }\n+    if (eventHTTP) {\n+        evhttp_free(eventHTTP);\n+        eventHTTP = nullptr;\n+    }\n+    if (eventBase) {\n         event_base_free(eventBase);\n         eventBase = nullptr;\n     }\n```",
          "created_at": "2026-02-20T20:32:24Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 1088,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3937038162,
          "user": "hodlinator",
          "body": "(I was curious whether it had anything to do with `ThreadPool` in 4a05825a3f3993b8e402a7c18e2bc04f6d287e96 but it reproduces for the merge-commit before that one).",
          "created_at": "2026-02-20T20:34:44Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 163,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3943124942,
          "user": "maflcko",
          "body": "thx for the check and fix. Not sure if anything needs to be done here at this point, given that libevent will be removed anyway?",
          "created_at": "2026-02-23T07:31:06Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 128,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3943368774,
          "user": "hodlinator",
          "body": "Yeah, I guess it's not a new issue for v31, so no rush.\n\nI'm also not sure whether the fix above is 100% complete, maybe `eventHTTP` in some cases will prevent event dispatch from completing and the thread from joining.",
          "created_at": "2026-02-23T08:37:33Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 219,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3943442508,
          "user": "maflcko",
          "body": "Your diff looks like a revert of 660bdbf785a32024f0694915fa043968a0afb573, so it may fix one bug, but add another one 😅 ",
          "created_at": "2026-02-23T08:53:13Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 120,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3943461388,
          "user": "hodlinator",
          "body": "Indeed, I think an additional `event_base_loopexit()` on top of my diff/revert might counteract eventHTTP keeping the dispatch loop/thread alive.",
          "created_at": "2026-02-23T08:57:11Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 145,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2926,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3963276355,
      "number": 34624,
      "title": "Intermittent shutdown deadlock (in wallet_multiwallet.py; AssertionError: [node 0] bitcoind should have exited within 4800s with expected error Error: Specified -walletdir \"wallets\" is a relative path)",
      "body": "Not sure how this could happen https://github.com/bitcoin/bitcoin/actions/runs/22177363139/job/64129376799?pr=34533#step:9:6127\n\nIt looks like the error is properly printed, and the node starts to shut down, but it deadlocks after `[http] [httpserver.cpp:299] [ThreadHTTP] [http] Exited http event loop`:\n\n```\nnode0 2026-02-19T10:43:28.250836Z [init] [httpserver.cpp:435] [StartHTTPServer] Starting HTTP server with 2 worker threads \nError:  node0 2026-02-19T10:43:28.250951Z [init] [noui.cpp:31] [noui_ThreadSafeMessageBox] [error] Specified -walletdir \"wallets\" is a relative path \n node0 2026-02-19T10:43:28.250982Z [init] [httpserver.cpp:442] [InterruptHTTPServer] [http] Interrupting HTTP server \n node0 2026-02-19T10:43:28.250988Z [init] [httprpc.cpp:349] [InterruptHTTPRPC] [rpc] Interrupting HTTP RPC server \n node0 2026-02-19T10:43:28.250993Z [init] [rpc/server.cpp:284] [operator()] [rpc] Interrupting RPC \n node0 2026-02-19T10:43:28.251002Z [init] [init.cpp:292] [Shutdown] Shutdown in progress... \n node0 2026-02-19T10:43:28.251009Z [shutoff] [httprpc.cpp:354] [StopHTTPRPC] [rpc] Stopping HTTP RPC server \n node0 2026-02-19T10:43:28.251016Z [shutoff] [httpserver.cpp:699] [UnregisterHTTPHandler] [http] Unregistering HTTP handler for / (exactmatch 1) \n node0 2026-02-19T10:43:28.251021Z [shutoff] [httpserver.cpp:699] [UnregisterHTTPHandler] [http] Unregistering HTTP handler for /wallet/ (exactmatch 0) \n node0 2026-02-19T10:43:28.251027Z [shutoff] [rpc/server.cpp:296] [operator()] [rpc] Stopping RPC \n node0 2026-02-19T10:43:28.251076Z [http_pool_0] [util/thread.cpp:20] [TraceThread] http_pool_0 thread start \n node0 2026-02-19T10:43:28.251083Z [http_pool_0] [util/thread.cpp:22] [TraceThread] http_pool_0 thread exit \n node0 2026-02-19T10:43:28.251106Z [http] [httpserver.cpp:296] [ThreadHTTP] [http] Entering http event loop \n node0 2026-02-19T10:43:28.251158Z [http_pool_1] [util/thread.cpp:20] [TraceThread] http_pool_1 thread start \n node0 2026-02-19T10:43:28.251167Z [http_pool_1] [util/thread.cpp:22] [TraceThread] http_pool_1 thread exit \n node0 2026-02-19T10:43:28.251344Z [shutoff] [rpc/server.cpp:298] [operator()] [rpc] RPC stopped. \n node0 2026-02-19T10:43:28.251350Z [shutoff] [httpserver.cpp:453] [StopHTTPServer] [http] Stopping HTTP server \n node0 2026-02-19T10:43:28.251355Z [shutoff] [httpserver.cpp:455] [StopHTTPServer] [http] Waiting for HTTP worker threads to exit \n node0 2026-02-19T10:43:28.251502Z [http] [httpserver.cpp:299] [ThreadHTTP] [http] Exited http event loop \n test  2026-02-19T12:03:28.189795Z TestFramework (ERROR): Unexpected exception: \n                                   Traceback (most recent call last):\n                                     File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/test/functional/test_framework/test_framework.py\", line 142, in main\n                                       self.run_test()\n                                       ~~~~~~~~~~~~~^^\n                                     File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/ci/scratch/build-aarch64-apple-darwin24.6.0/test/functional/wallet_multiwallet.py\", line 168, in run_test\n                                       self.nodes[0].assert_start_raises_init_error(['-walletdir=wallets'], 'Error: Specified -walletdir \"wallets\" is a relative path', cwd=data_dir())\n                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/test/functional/test_framework/test_node.py\", line 762, in assert_start_raises_init_error\n                                       self._raise_assertion_error(assert_msg)\n                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^\n                                     File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/test/functional/test_framework/test_node.py\", line 229, in _raise_assertion_error\n                                       raise AssertionError(self._node_msg(msg))\n                                   AssertionError: [node 0] bitcoind should have exited within 4800s with expected error Error: Specified -walletdir \"wallets\" is a relative path (cmd: ['bitcoin', '-m', 'node', '-datadir=/Users/runner/work/bitcoin/bitcoin/repo_archive/ci/scratch/test_runner/test_runner_₿_🏃_20260219_103433/wallet_multiwallet_253/node0', '-logtimemicros', '-debug', '-debugexclude=libevent', '-debugexclude=leveldb', '-debugexclude=rand', '-uacomment=testnode0', '-logthreadnames', '-logsourcelocations', '-loglevel=trace', '-nologratelimit', '-v2transport=0', '-walletdir=wallets'])",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-02-19T14:29:23Z",
      "updated_at": "2026-02-23T16:42:27Z",
      "closed_at": null,
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34624",
      "labels": [
        "Wallet",
        "macOS",
        "RPC/REST/ZMQ",
        "CI failed"
      ],
      "comment_data": [
        {
          "id": 3945920682,
          "user": "maflcko",
          "body": "I guess it may be fine to ignore this for now. Similar to https://github.com/bitcoin/bitcoin/issues/34634\n\n<!--\n\n\nSo I want to locally reproduce this intermittent issue. It happens 1/1000 runs.\n\nIt looks like the error is properly printed, and the node starts to shut down, but it deadlocks after [http] [httpserver.cpp:299] [ThreadHTTP] [http] Exited http event loop:\n\n```\nnode0 2026-02-19T10:43:28.250836Z [init] [httpserver.cpp:435] [StartHTTPServer] Starting HTTP server with 2 worker threads \nError:  node0 2026-02-19T10:43:28.250951Z [init] [noui.cpp:31] [noui_ThreadSafeMessageBox] [error] Specified -walletdir \"wallets\" is a relative path \n node0 2026-02-19T10:43:28.250982Z [init] [httpserver.cpp:442] [InterruptHTTPServer] [http] Interrupting HTTP server \n node0 2026-02-19T10:43:28.250988Z [init] [httprpc.cpp:349] [InterruptHTTPRPC] [rpc] Interrupting HTTP RPC server \n node0 2026-02-19T10:43:28.250993Z [init] [rpc/server.cpp:284] [operator()] [rpc] Interrupting RPC \n node0 2026-02-19T10:43:28.251002Z [init] [init.cpp:292] [Shutdown] Shutdown in progress... \n node0 2026-02-19T10:43:28.251009Z [shutoff] [httprpc.cpp:354] [StopHTTPRPC] [rpc] Stopping HTTP RPC server \n node0 2026-02-19T10:43:28.251016Z [shutoff] [httpserver.cpp:699] [UnregisterHTTPHandler] [http] Unregistering HTTP handler for / (exactmatch 1) \n node0 2026-02-19T10:43:28.251021Z [shutoff] [httpserver.cpp:699] [UnregisterHTTPHandler] [http] Unregistering HTTP handler for /wallet/ (exactmatch 0) \n node0 2026-02-19T10:43:28.251027Z [shutoff] [rpc/server.cpp:296] [operator()] [rpc] Stopping RPC \n node0 2026-02-19T10:43:28.251076Z [http_pool_0] [util/thread.cpp:20] [TraceThread] http_pool_0 thread start \n node0 2026-02-19T10:43:28.251083Z [http_pool_0] [util/thread.cpp:22] [TraceThread] http_pool_0 thread exit \n node0 2026-02-19T10:43:28.251106Z [http] [httpserver.cpp:296] [ThreadHTTP] [http] Entering http event loop \n node0 2026-02-19T10:43:28.251158Z [http_pool_1] [util/thread.cpp:20] [TraceThread] http_pool_1 thread start \n node0 2026-02-19T10:43:28.251167Z [http_pool_1] [util/thread.cpp:22] [TraceThread] http_pool_1 thread exit \n node0 2026-02-19T10:43:28.251344Z [shutoff] [rpc/server.cpp:298] [operator()] [rpc] RPC stopped. \n node0 2026-02-19T10:43:28.251350Z [shutoff] [httpserver.cpp:453] [StopHTTPServer] [http] Stopping HTTP server \n node0 2026-02-19T10:43:28.251355Z [shutoff] [httpserver.cpp:455] [StopHTTPServer] [http] Waiting for HTTP worker threads to exit \n node0 2026-02-19T10:43:28.251502Z [http] [httpserver.cpp:299] [ThreadHTTP] [http] Exited http event loop \n test  2026-02-19T12:03:28.189795Z TestFramework (ERROR): Unexpected exception: \n                                   Traceback (most recent call last):\n                                     File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/test/functional/test_framework/test_framework.py\", line 142, in main\n                                       self.run_test()\n                                       ~~~~~~~~~~~~~^^\n                                     File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/ci/scratch/build-aarch64-apple-darwin24.6.0/test/functional/wallet_multiwallet.py\", line 168, in run_test\n                                       self.nodes[0].assert_start_raises_init_error(['-walletdir=wallets'], 'Error: Specified -walletdir \"wallets\" is a relative path', cwd=data_dir())\n                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/test/functional/test_framework/test_node.py\", line 762, in assert_start_raises_init_error\n                                       self._raise_assertion_error(assert_msg)\n                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^\n                                     File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/test/functional/test_framework/test_node.py\", line 229, in _raise_assertion_error\n                                       raise AssertionError(self._node_msg(msg))\n                                   AssertionError: [node 0] bitcoind should have exited within 4800s with expected error Error: Specified -walletdir \"wallets\" is a relative path (cmd: ['bitcoin', '-m', 'node', '-datadir=/Users/runner/work/bitcoin/bitcoin/repo_archive/ci/scratch/test_runner/test_runner_₿_🏃_20260219_103433/wallet_multiwallet_253/node0', '-logtimemicros', '-debug', '-debugexclude=libevent', '-debugexclude=leveldb', '-debugexclude=rand', '-uacomment=testnode0', '-logthreadnames', '-logsourcelocations', '-loglevel=trace', '-nologratelimit', '-v2transport=0', '-walletdir=wallets'])\n```\n\nSo I guess it could be reproduced outside the test via:\n\n./bld-cmake/bin/bitcoind -datadir=/tmp/ -walletdir=wallets_missing -server=1 -printtoconsole=1 -debug=http -regtest -rpcuser=u -rpcpassword=pw\n\nHowever, this does not reproduce.\n\nMaybe it needs an rpc call in the background?\n\n```sh\n./bld-cmake/bin/bitcoind -datadir=/tmp/ -walletdir=wallets_missing -server=1 -printtoconsole=1 -debug=http -regtest -rpcuser=u -rpcpassword=pw & while true; do ./bld-cmake/bin/bitcoin-cli -datadir=/tmp/ -regtest -rpcuser=u -rpcpassword=pw getblockcount &> /dev/null ; done\n# Exit via CTRL+C after done, or limit the while loop\n```\n\nHowever, this still does not reproduce.\n\nSo I wonder if the source code can be modified to reproduce this reliably.\n\nCan you see any possible cause, and a way to reproduce?\n\nDO NOT FIX THE CAUSE, just make the bug reproducible.\n\nYou can compile via `cmake --build ./bld-cmake --parallel  8`\n\nI am thinking about some internal automated fake sync (using sleeps, atomics or condition variables) between two threads, assuming that more than one thread is involved in the race/timeout bug.\n\nYou may add sleeps, or waits, or whatever, or logging. However, adding different logic will only reproduce a different (synthetic issue, not the original issue). So Do not fix any bugs. only reproduce.\n\n   ok? wdyt?\n\n",
          "created_at": "2026-02-23T16:42:27Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 6086,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 4893,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3941584748,
      "number": 34592,
      "title": "Fatal Error: Filename too long.",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\n<img width=\"828\" height=\"637\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/0a607957-b068-4b58-83ca-27e8a8296eef\" />\n\nDir path cannot get any shorter but I think its misleading, there are no files even close to 256 char, might be an issue because its on E:\\ ? Nothing useful in debug.log. Fix the data for core as well, it's still showing 2009-2024. \n\n### Expected behaviour\n\nExpected behavior is that it should continue to write the blocks. \n\n### Steps to reproduce\n\nInstall Bitcoin core 28.1.0. \n\n### Relevant log output\n\n[debug.zip](https://github.com/user-attachments/files/25315742/debug.zip)\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\n28.1.0\n\n### Operating system and version\n\nWindows 10\n\n### Machine specifications\n\n8core i7 16gb ram, 14TB ssd",
      "state": "open",
      "user": "JPPinto-SS",
      "created_at": "2026-02-14T15:00:32Z",
      "updated_at": "2026-02-23T12:57:09Z",
      "closed_at": null,
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/issues/34592",
      "labels": [
        "Windows",
        "Block storage"
      ],
      "comment_data": [
        {
          "id": 3943243268,
          "user": "maflcko",
          "body": "> I have installed 30.2 and its still synchronizing with network, it usually throws the error when there is ~1 year left to sync. I will report back if it completes or not.\n> <img alt=\"Image\" width=\"561\" height=\"50\" src=\"https://private-user-images.githubusercontent.com/77682310/551048839-9f2adfe8-27ac-481b-a65e-e30036efcb8d.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NzE4MzQwNjUsIm5iZiI6MTc3MTgzMzc2NSwicGF0aCI6Ii83NzY4MjMxMC81NTEwNDg4MzktOWYyYWRmZTgtMjdhYy00ODFiLWE2NWUtZTMwMDM2ZWZjYjhkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAyMjMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMjIzVDA4MDI0NVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWZjMzQ1ZTE5YTY4MmVmNDg3ZmJiYzkzNzVhYmUzYzFhYTZmODFlNmE4OTU3ZGRmZDMwNDZmOGY4ZGFhNWQ4YzAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.8Olc0cU4piBWHul9aM9azjoF3tDEEfzdVwe4VcX-FgY\">\n\nAny update on this? Also, once the issue happens again, it should not be needed to re-sync from scratch and it should be possible to test if the same error message happens on every re-start.",
          "created_at": "2026-02-23T08:06:38Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 1193,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3944639876,
          "user": "JPPinto-SS",
          "body": "Its still going... no issues yet.  \n\n<img width=\"830\" height=\"274\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/a770e98f-5bd7-4db5-a687-5dea9a654c10\" />",
          "created_at": "2026-02-23T12:57:08Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 167,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 970,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3930968827,
      "number": 34569,
      "title": "build: Qt depends build broken with GCC 16",
      "body": "GCC 16 is in it's \"stabilization\" phase, and `16.1` should be released [~soon](https://gcc.gnu.org/pipermail/gcc/2026-January/247347.html). Doing a depends build / compile currently works, other than building Qt in depends:\n```bash\ngcc (GCC) 16.0.1 20260209 (Red Hat 16.0.1-0)\nmake -C depends/ -j15\n<snip>\nBuilding qt...\n[3/1319] Building CXX object qtbase/src/corelib/CMakeFiles/Core.dir/global/qcompare.cpp.o\nFAILED: [code=1] qtbase/src/corelib/CMakeFiles/Core.dir/global/qcompare.cpp.o \n/usr/lib64/ccache/g++ -DPCRE2_CODE_UNIT_WIDTH=16 -DQT_ASCII_CAST_WARNINGS -DQT_BUILDING_QT -DQT_BUILD_CORE_LIB -DQT_DEPRECATED_WARNINGS -DQT_DISABLE_DEPRECATED_UP_TO=0x050000 -DQT_EXPLICIT_QFILE_CONSTRUCTION_FROM_PATH -DQT_LEAN_HEADERS=1 -DQT_MOC_COMPAT -DQT_NO_AS_CONST -DQT_NO_CAST_TO_ASCII -DQT_NO_CONTEXTLESS_CONNECT -DQT_NO_DEBUG -DQT_NO_FOREACH -DQT_NO_JAVA_STYLE_ITERATORS -DQT_NO_NARROWING_CONVERSIONS_IN_CONNECT -DQT_NO_QEXCHANGE -DQT_NO_QPAIR -DQT_NO_USING_NAMESPACE -DQT_TYPESAFE_FLAGS -DQT_USE_QSTRINGBUILDER -DQT_WARN_DEPRECATED_UP_TO=0x070000 -DQT_ZLIB_LIB -D_LARGEFILE64_SOURCE -D_LARGEFILE_SOURCE -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/corelib/Core_autogen/include -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/include -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/include/QtCore -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/corelib -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/corelib/global -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/corelib/kernel -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/corelib/../3rdparty/tinycbor/src -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/include/QtCore/6.7.3 -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/include/QtCore/6.7.3/QtCore -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/corelib/../3rdparty/double-conversion/double-conversion -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/corelib/../3rdparty/double-conversion -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/corelib/.rcc -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/mkspecs/linux-g++ -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/include/QtZlib -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/3rdparty/zlib -I/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/3rdparty/pcre2/src -I/root/bitcoin/depends/aarch64-unknown-linux-gnu/include  -ffile-prefix-map=/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257=/usr -O2 -std=c++20 -fPIC -fvisibility=hidden -fvisibility-inlines-hidden -Wall -Wextra -fexceptions -ffunction-sections -fdata-sections -Wsuggest-override -Winvalid-pch -include /root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/corelib/CMakeFiles/Core.dir/cmake_pch.hxx -MD -MT qtbase/src/corelib/CMakeFiles/Core.dir/global/qcompare.cpp.o -MF qtbase/src/corelib/CMakeFiles/Core.dir/global/qcompare.cpp.o.d -o qtbase/src/corelib/CMakeFiles/Core.dir/global/qcompare.cpp.o -c /root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/corelib/global/qcompare.cpp\n/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/corelib/global/qcompare.cpp:17:19: error: static assertion failed\n   17 |                   == Qt:: type ## _ordering :: flag); \\\n      |                   ^\n/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/corelib/global/qcompare.cpp:21:1: note: in expansion of macro ‘CHECK’\n   21 | CHECK(partial, unordered);\n      | ^~~~~\n/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/corelib/global/qcompare.cpp:19:19: error: static assertion failed\n   19 |                   == std:: type ## _ordering :: flag) \\\n      |                   ^\n/root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/qtbase/src/corelib/global/qcompare.cpp:21:1: note: in expansion of macro ‘CHECK’\n   21 | CHECK(partial, unordered);\n      | ^~~~~\n[17/1319] Building CXX object qtbase/src/corelib/CMakeFiles/Core.dir/global/qlogging.cpp.o\nninja: build stopped: subcommand failed.\nmake: *** [funcs.mk:343: /root/bitcoin/depends/work/build/aarch64-unknown-linux-gnu/qt/6.7.3-933b44e1257/./.stamp_built] Error 1\n```",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-02-12T10:12:51Z",
      "updated_at": "2026-02-22T12:21:24Z",
      "closed_at": null,
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/34569",
      "labels": [
        "GUI",
        "Build system"
      ],
      "comment_data": [
        {
          "id": 3893791227,
          "user": "hebasto",
          "body": "> Qt has the gcc16 fixes in their main `dev` branch. Backporting all necessary fixes to 6.8 is non-trivial though.\n> \n> [@hebasto](https://github.com/hebasto) has a WIP branch for a bump to 6.10. I managed to cleanly port all necessary patches to 6.10, so I think it's reasonable to consider bumping in order to fix builds with bleeding-edge gcc/clang.\n> \n> Here's my branch build on top of [@hebasto](https://github.com/hebasto)'s WIP: https://github.com/theuni/bitcoin/commits/qt6.10/\n> \n> As a quick summary, to fix build (errors as well as annoying warnings), we need:\n> \n> QCompare fix: [qt/qtbase@7fccc79](https://github.com/qt/qtbase/commit/7fccc79dd5744ea837ffe200bbfc9f2756870220)\n> \n> SFINAE fixes: [qt/qtbase@679e8bd](https://github.com/qt/qtbase/commit/679e8bda1eb0cc98acb981e9a10204bed1c179f2) [qt/qtbase@3312e89](https://github.com/qt/qtbase/commit/3312e89b47f8c2ea0b4263b39841c25b83a37332) [qt/qtbase@05f201a](https://github.com/qt/qtbase/commit/05f201a3d559452287b20becb960de3a50249540) [qt/qtbase@d68fc6e](https://github.com/qt/qtbase/commit/d68fc6ecc88a0e4532754b1a9f209881a248f4ee)\n\nPicked to ~https://github.com/bitcoin/bitcoin/pull/34578~ https://github.com/bitcoin/bitcoin/pull/34650.",
          "created_at": "2026-02-12T22:42:15Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 1206,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 4928,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3974115519,
      "number": 34649,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "arifarafat",
      "created_at": "2026-02-22T10:15:06Z",
      "updated_at": "2026-02-22T10:15:19Z",
      "closed_at": "2026-02-22T10:15:16Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34649",
      "labels": [],
      "comment_data": [
        {
          "id": 3940642998,
          "user": "DrahtBot",
          "body": "\nLLM spam detection (✨ experimental): SPAM\n\nThis is an unsolicited commercial/contact request about domain ownership and asking for off-site email contact. It is not a repository-related bug, feature request, or meaningful contribution and appears promotional/irrelevant.\n\n♻️ Automatically wiping, closing, and locking for now based on heuristics.\nGenerally, please focus on creating high-quality, original content that demonstrates a clear\nunderstanding of the project's requirements and goals.\n",
          "created_at": "2026-02-22T10:15:15Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 496,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3973731534,
      "number": 34648,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "godmakesthebeautifulworld12345-oss",
      "created_at": "2026-02-22T06:35:41Z",
      "updated_at": "2026-02-22T06:35:50Z",
      "closed_at": "2026-02-22T06:35:48Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34648",
      "labels": [],
      "comment_data": [
        {
          "id": 3940288638,
          "user": "DrahtBot",
          "body": "\nLLM spam detection (✨ experimental): SPAM. The report contains only a single-word title with no body or actionable details, providing no context, purpose, or reproducible information and therefore appears to be a placeholder or irrelevant submission rather than a legitimate issue.\n\n♻️ Automatically wiping, closing, and locking for now based on heuristics.\nGenerally, please focus on creating high-quality, original content that demonstrates a clear\nunderstanding of the project's requirements and goals.\n",
          "created_at": "2026-02-22T06:35:48Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 507,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3730153407,
      "number": 34076,
      "title": "tapscript with time-locked musig2",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nTrying to import descriptor with time-locked musig fragment in tapscript returns:\n```\nerror code: -5\nerror message:\nInvalid musig() expression\n```\n\n### Expected behaviour\n\nImport should work.\n\n### Steps to reproduce\n\ntry `getdescriptorinfo` with following BIP-388 policy:\n\n`tr(musig(@0,@1,@2)/**,{and_v(v:pk(musig(@0,@1)/**),older(12960)),{and_v(v:pk(musig(@0,@2)/**),older(12960)),and_v(v:pk(musig(@1,@2)/**),older(12960))}})`\n\nwhich translates (for example) to following descriptor:\n\n```\ntr(musig([a471be2d/88h/1h/0h]tpubDCyTVDMyRxsEeAf7KLPRfUZkSCCjsZPqZoM2Ay3FqtH55CxvTchpK2DSbTgVRziFGesGGibdsfC4BktGNUMwb4VjGwu2KuzDCp9A97rVH8q,[0f056943/88h/1h/0h]tpubDD8WTkCBJwj5WHR8S1gr2y64LcFSwEic38zGRKEuHXUUPRacZyTREJp9vZ5fayGVqEzzBacffrkK1g4CJRA5PgXE7MkrsLcUWbeixkLaNM6,[6b69e5e9/88h/1h/0h]tpubDCMSPy71rEscssSimZNZ3S1Z2aguLeeLbguzDUXJVfwiCxuAE88omLcd95895x9au5Tw81bCuPhNcmSCzp2Yz13EReNHduoFKc4f1VNs7VG)/<0;1>/*,{and_v(v:pk(musig([6b69e5e9/88h/1h/0h]tpubDCMSPy71rEscssSimZNZ3S1Z2aguLeeLbguzDUXJVfwiCxuAE88omLcd95895x9au5Tw81bCuPhNcmSCzp2Yz13EReNHduoFKc4f1VNs7VG,[a471be2d/88h/1h/0h]tpubDCyTVDMyRxsEeAf7KLPRfUZkSCCjsZPqZoM2Ay3FqtH55CxvTchpK2DSbTgVRziFGesGGibdsfC4BktGNUMwb4VjGwu2KuzDCp9A97rVH8q)/<0;1>/*),older(12960)),{and_v(v:pk(musig([6b69e5e9/88h/1h/0h]tpubDCMSPy71rEscssSimZNZ3S1Z2aguLeeLbguzDUXJVfwiCxuAE88omLcd95895x9au5Tw81bCuPhNcmSCzp2Yz13EReNHduoFKc4f1VNs7VG,[0f056943/88h/1h/0h]tpubDD8WTkCBJwj5WHR8S1gr2y64LcFSwEic38zGRKEuHXUUPRacZyTREJp9vZ5fayGVqEzzBacffrkK1g4CJRA5PgXE7MkrsLcUWbeixkLaNM6)/<0;1>/*),older(12960)),and_v(v:pk(musig([a471be2d/88h/1h/0h]tpubDCyTVDMyRxsEeAf7KLPRfUZkSCCjsZPqZoM2Ay3FqtH55CxvTchpK2DSbTgVRziFGesGGibdsfC4BktGNUMwb4VjGwu2KuzDCp9A97rVH8q,[0f056943/88h/1h/0h]tpubDD8WTkCBJwj5WHR8S1gr2y64LcFSwEic38zGRKEuHXUUPRacZyTREJp9vZ5fayGVqEzzBacffrkK1g4CJRA5PgXE7MkrsLcUWbeixkLaNM6)/<0;1>/*),older(12960))}})\n```\n\n(imo) error is caused by the first leaf where `expr` after split is missing terminating parentheses of musig expression https://github.com/bitcoin/bitcoin/blob/2210feb4466eff1455468f0a25045fce4b89c55d/src/script/descriptor.cpp#L1844-L1847\n\nOR use below patch to add test case to musig functional tests:\n\n```\nSubject: [PATCH] test\n---\nIndex: test/functional/wallet_musig.py\nIDEA additional info:\nSubsystem: com.intellij.openapi.diff.impl.patch.CharsetEP\n<+>UTF-8\n===================================================================\ndiff --git a/test/functional/wallet_musig.py b/test/functional/wallet_musig.py\n--- a/test/functional/wallet_musig.py\t(revision 2210feb4466eff1455468f0a25045fce4b89c55d)\n+++ b/test/functional/wallet_musig.py\t(date 1765796643152)\n@@ -236,6 +236,7 @@\n         self.do_test(\"tr(H,{pk(musig/*), pk(same keys different musig/*)})\", \"tr($H,{pk(musig($0,$1,$2)/<0;1>/*),pk(musig($1,$2)/0/*)})\", scriptpath=True)\n         self.do_test(\"tr(musig/*,{pk(partial keys diff musig-1/*),pk(partial keys diff musig-2/*)})}\", \"tr(musig($0,$1,$2)/<3;4>/*,{pk(musig($0,$1)/<5;6>/*),pk(musig($1,$2)/7/*)})\")\n         self.do_test(\"tr(musig/*,{pk(partial keys diff musig-1/*),pk(partial keys diff musig-2/*)})} script-path\", \"tr(musig($0,$1,$2)/<3;4>/*,{pk(musig($0,$1)/<5;6>/*),pk(musig($1,$2)/7/*)})\", scriptpath=True, nosign_wallets=[0])\n+        self.do_test(\"time-locked musig\", \"tr(musig($0,$1,$2)/<0;1>/*,{and_v(v:pk(musig($0,$1)/<0;1>/*),older(12960)),{and_v(v:pk(musig($0,$2)/<0;1>/*),older(12960)),and_v(v:pk(musig($1,$2)/<0;1>/*),older(12960))}})\", scriptpath=True)\n \n \n if __name__ == '__main__':\n```\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nmaster@2210feb4466eff1455468f0a25045fce4b89c55d\n\n### Operating system and version\n\nLinux ... 6.14.0-37-generic #37~24.04.1-Ubuntu ... x86_64 x86_64 x86_64 GNU/Linux\n\n### Machine specifications\n\n_No response_",
      "state": "closed",
      "user": "scgbckbone",
      "created_at": "2025-12-15T12:14:26Z",
      "updated_at": "2026-02-21T11:19:04Z",
      "closed_at": "2026-02-21T11:19:04Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34076",
      "labels": [
        "Wallet",
        "Descriptors"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3948,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3963457530,
      "number": 34626,
      "title": "Sv2 needs a `submitBlock` IPC method",
      "body": "currently, IPC mining interface only allows broadcasting blocks via `BlockTemplate.submitSolution`\n\na Sv2 Job Declarator Server can receive solutions via [`PushSolution`](https://stratumprotocol.org/specification/06-job-declaration-protocol/#649-pushsolution-client---server) message, for which it has no corresponding `BlockTemplate` on the Bitcoin Core side\n\nin summary, we need the equivalent of a [`submitblock`](https://developer.bitcoin.org/reference/rpc/submitblock.html#submitblock) RPC\n\ncc @ryanofsky @ismaelsadeeq @Sjors ",
      "state": "open",
      "user": "plebhash",
      "created_at": "2026-02-19T15:08:04Z",
      "updated_at": "2026-02-21T09:38:30Z",
      "closed_at": null,
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/34626",
      "labels": [
        "Mining",
        "interfaces"
      ],
      "comment_data": [
        {
          "id": 3928826054,
          "user": "plebhash",
          "body": "> This should be trivial, but I would file this under nice to have, not \"need\".\n\nwell, not having this available forces SRI to take a hybrid IPC/RPC route for full Sv2 JDS functionality, which is pretty ugly\n\nso from our standpoint, I'd lean more towards the \"need\"\n\nbut I understand there could be other priorities compared to this",
          "created_at": "2026-02-19T17:43:43Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 332,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3938518311,
          "user": "w0xlt",
          "body": "I’ve opened PR https://github.com/bitcoin/bitcoin/pull/34644 for this.\nI’m not very familiar with the IPC interface, but it looked straightforward. Happy to adjust if needed.",
          "created_at": "2026-02-21T09:38:30Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 174,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 568,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3963109090,
      "number": 34621,
      "title": "qa: Intermittent failure in `p2p_invalid_tx.py`",
      "body": "https://github.com/bitcoin/bitcoin/actions/runs/22181787708/job/64145682186:\n```\n316/455 - p2p_invalid_tx.py --v2transport failed, Duration: 3 s\n\nstdout:\n2026-02-19T12:56:47.242316Z TestFramework (INFO): PRNG seed is: 6348560005473754043\n\n2026-02-19T12:56:47.276714Z TestFramework (INFO): Initializing test directory D:\\a\\bitcoin\\bitcoin\\test_runner_₿_🏃_20260219_124134\\p2p_invalid_tx_138\n\n2026-02-19T12:56:47.695785Z TestFramework (INFO): Create a new block with an anyone-can-spend coinbase.\n\n2026-02-19T12:56:47.799348Z TestFramework (INFO): Mature the block.\n\n2026-02-19T12:56:47.976687Z TestFramework (INFO): Testing invalid transaction: OutputMissing\n\n2026-02-19T12:56:48.033913Z TestFramework (INFO): Testing invalid transaction: InputMissing\n\n2026-02-19T12:56:48.086804Z TestFramework (INFO): Testing invalid transaction: SizeTooSmall\n\n2026-02-19T12:56:48.144583Z TestFramework (INFO): Testing invalid transaction: ExtraWitness\n\n2026-02-19T12:56:48.197926Z TestFramework (INFO): Testing invalid transaction: BadInputOutpointIndex\n\n2026-02-19T12:56:48.251347Z TestFramework (INFO): Testing invalid transaction: DuplicateInput\n\n2026-02-19T12:56:48.304591Z TestFramework (INFO): Testing invalid transaction: PrevoutNullInput\n\n2026-02-19T12:56:48.357833Z TestFramework (INFO): Testing invalid transaction: NonexistentInput\n\n2026-02-19T12:56:48.410814Z TestFramework (INFO): Testing invalid transaction: SpendTooMuch\n\n2026-02-19T12:56:48.463890Z TestFramework (INFO): Testing invalid transaction: CreateNegative\n\n2026-02-19T12:56:48.516884Z TestFramework (INFO): Testing invalid transaction: CreateTooLarge\n\n2026-02-19T12:56:48.570317Z TestFramework (INFO): Testing invalid transaction: CreateSumTooLarge\n\n2026-02-19T12:56:48.623911Z TestFramework (INFO): Testing invalid transaction: InvalidOPIFConstruction\n\n2026-02-19T12:56:48.677788Z TestFramework (INFO): Testing invalid transaction: TooManySigopsPerBlock\n\n2026-02-19T12:56:48.787518Z TestFramework (INFO): Testing invalid transaction: TooManySigopsPerTransaction\n\n2026-02-19T12:56:48.851114Z TestFramework (INFO): Testing invalid transaction: NonStandardAndInvalid\n\n2026-02-19T12:56:48.904906Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_CAT\n\n2026-02-19T12:56:48.958373Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_SUBSTR\n\n2026-02-19T12:56:49.011903Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_LEFT\n\n2026-02-19T12:56:49.064977Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_RIGHT\n\n2026-02-19T12:56:49.118325Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_INVERT\n\n2026-02-19T12:56:49.171756Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_AND\n\n2026-02-19T12:56:49.224993Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_OR\n\n2026-02-19T12:56:49.277882Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_XOR\n\n2026-02-19T12:56:49.331221Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_2MUL\n\n2026-02-19T12:56:49.384629Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_2DIV\n\n2026-02-19T12:56:49.437805Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_MUL\n\n2026-02-19T12:56:49.491221Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_DIV\n\n2026-02-19T12:56:49.544034Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_MOD\n\n2026-02-19T12:56:49.596877Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_LSHIFT\n\n2026-02-19T12:56:49.649868Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_RSHIFT\n\n2026-02-19T12:56:49.960918Z TestFramework (INFO): Test orphan transaction handling ... \n\n2026-02-19T12:56:49.961101Z TestFramework (INFO): Send the orphans ... \n\n2026-02-19T12:56:50.070383Z TestFramework (INFO): Send the withhold tx ... \n\n2026-02-19T12:56:50.124751Z TestFramework (INFO): Test orphanage can store more than 100 transactions\n\n2026-02-19T12:56:50.268148Z TestFramework (INFO): Test orphan with rejected parents\n\n2026-02-19T12:56:50.322356Z TestFramework (INFO): Test that a peer disconnection causes erase its transactions from the orphan pool\n\n2026-02-19T12:56:50.479576Z TestFramework (INFO): Test that a transaction in the orphan pool is included in a new tip block causes erase this transaction from the orphan pool\n\n2026-02-19T12:56:50.479848Z TestFramework (INFO): Send the orphan ... \n\n2026-02-19T12:56:50.486753Z TestFramework (INFO): Send the block that includes the previous orphan ... \n\n2026-02-19T12:56:50.498315Z TestFramework (ERROR): Unexpected exception:\n\nTraceback (most recent call last):\n\n  File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\test_framework.py\", line 142, in main\n\n    self.run_test()\n\n    ~~~~~~~~~~~~~^^\n\n  File \"D:\\a\\bitcoin\\bitcoin/test/functional/p2p_invalid_tx.py\", line 180, in run_test\n\n    with node.assert_debug_log([\"Erased 1 orphan transaction(s) included or conflicted by block\"]):\n\n         ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n  File \"C:\\hostedtoolcache\\windows\\Python\\3.14.3\\x64\\Lib\\contextlib.py\", line 148, in __exit__\n\n    next(self.gen)\n\n    ~~~~^^^^^^^^^^\n\n  File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\test_node.py\", line 584, in assert_debug_log\n\n    self._raise_assertion_error(f'Expected message(s) {remaining_expected!s} '\n\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n                                f'not found in log:\\n\\n{join_log(log)}\\n\\n')\n\n                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n  File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\test_node.py\", line 229, in _raise_assertion_error\n\n    raise AssertionError(self._node_msg(msg))\n\nAssertionError: [node 0] Expected message(s) ['Erased 1 orphan transaction(s) included or conflicted by block'] not found in log:\n\n\n\n - 2026-02-19T12:56:50.488541Z [msghand] [net_processing.cpp:3555] [ProcessMessage] [net] received: headers (82 bytes) peer=3\n\n - 2026-02-19T12:56:50.488619Z [msghand] [net_processing.cpp:3526] [LogBlockHeader] Saw new header hash=4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d height=102 peer=3\n\n - 2026-02-19T12:56:50.488674Z [msghand] [net_processing.cpp:2854] [HeadersDirectFetchBlocks] [net] Requesting block 4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d from  peer=3\n\n - 2026-02-19T12:56:50.488691Z [msghand] [net.cpp:4074] [PushMessage] [net] sending getdata (37 bytes) peer=3\n\n - 2026-02-19T12:56:50.489460Z [msghand] [net.cpp:4074] [PushMessage] [net] sending sendheaders (0 bytes) peer=3\n\n - 2026-02-19T12:56:50.492975Z [msghand] [net_processing.cpp:3555] [ProcessMessage] [net] received: block (497 bytes) peer=3\n\n - 2026-02-19T12:56:50.492999Z [msghand] [net_processing.cpp:4841] [ProcessMessage] [net] received block 4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d peer=3\n\n - 2026-02-19T12:56:50.493050Z [msghand] [validationinterface.cpp:261] [NewPoWValidBlock] [validation] NewPoWValidBlock: block hash=4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d\n\n - 2026-02-19T12:56:50.493284Z [msghand] [validation.cpp:3062] [ConnectTip] [bench]   - Using cached block\n\n - 2026-02-19T12:56:50.493305Z [msghand] [validation.cpp:3069] [ConnectTip] [bench]   - Load block from disk: 0.02ms\n\n - 2026-02-19T12:56:50.493405Z [msghand] [validation.cpp:2386] [ConnectBlock] [bench]     - Sanity checks: 0.00ms [0.00s (0.00ms/blk)]\n\n - 2026-02-19T12:56:50.493432Z [msghand] [validation.cpp:2488] [ConnectBlock] [bench]     - Fork checks: 0.03ms [0.00s (0.02ms/blk)]\n\n - 2026-02-19T12:56:50.493468Z [msghand] [validation.cpp:2603] [ConnectBlock] [bench]       - Connect 4 transactions: 0.03ms (0.008ms/tx, 0.011ms/txin) [0.00s (0.01ms/blk)]\n\n - 2026-02-19T12:56:50.493493Z [msghand] [validation.cpp:2626] [ConnectBlock] [bench]     - Verify 3 txins: 0.06ms (0.020ms/txin) [0.01s (0.03ms/blk)]\n\n - 2026-02-19T12:56:50.493639Z [msghand] [validation.cpp:2642] [ConnectBlock] [bench]     - Write undo data: 0.14ms [0.01s (0.05ms/blk)]\n\n - 2026-02-19T12:56:50.493657Z [msghand] [validation.cpp:2657] [ConnectBlock] [bench]     - Index writing: 0.02ms [0.00s (0.01ms/blk)]\n\n - 2026-02-19T12:56:50.493671Z [msghand] [validationinterface.cpp:255] [BlockChecked] [validation] BlockChecked: block hash=4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d state=Valid\n\n - 2026-02-19T12:56:50.493688Z [msghand] [validation.cpp:3087] [ConnectTip] [bench]   - Connect total: 0.38ms [0.02s (0.11ms/blk)]\n\n - 2026-02-19T12:56:50.493704Z [msghand] [validation.cpp:3095] [ConnectTip] [bench]   - Flush: 0.02ms [0.00s (0.01ms/blk)]\n\n - 2026-02-19T12:56:50.493720Z [msghand] [validation.cpp:3105] [ConnectTip] [bench]   - Writing chainstate: 0.02ms [0.00s (0.01ms/blk)]\n\n - 2026-02-19T12:56:50.493740Z [msghand] [validationinterface.cpp:229] [MempoolTransactionsRemovedForBlock] [validation] Enqueuing MempoolTransactionsRemovedForBlock: block height=102 txs removed=1\n\n - 2026-02-19T12:56:50.493790Z [msghand] [validation.cpp:2873] [UpdateTipLog] UpdateTip: new best=4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d height=102 version=0x00000004 log2_work=7.686501 tx=106 date='2026-02-19T13:06:50Z' progress=1.000000 cache=0.3MiB(105txo)\n\n - 2026-02-19T12:56:50.493810Z [msghand] [validation.cpp:3122] [ConnectTip] [bench]   - Connect postprocess: 0.09ms [0.01s (0.05ms/blk)]\n\n - 2026-02-19T12:56:50.493825Z [msghand] [validation.cpp:3126] [ConnectTip] [bench] - Connect block: 0.52ms [0.04s (0.17ms/blk)]\n\n - 2026-02-19T12:56:50.493836Z [msghand] [txmempool.cpp:435] [check] [mempool] Checking mempool with 2 transactions and 2 inputs\n\n - 2026-02-19T12:56:50.493867Z [msghand] [validationinterface.cpp:219] [BlockConnected] [validation] Enqueuing BlockConnected: block hash=4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d block height=102\n\n - 2026-02-19T12:56:50.493888Z [msghand] [validationinterface.cpp:182] [UpdatedBlockTip] [validation] Enqueuing UpdatedBlockTip: new block hash=4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d fork block hash=1a5c3bc8b1c4b797b167f2cf9fbfd872094daedbd96c5f8d2b5094618970c2b5 (in IBD=false)\n\n - 2026-02-19T12:56:50.493904Z [msghand] [validationinterface.cpp:190] [ActiveTipChange] [validation] ActiveTipChange: new block hash=4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d block height=102\n\n - 2026-02-19T12:56:50.494957Z [msghand] [net_processing.cpp:3555] [ProcessMessage] [net] received: ping (8 bytes) peer=3\n\n - 2026-02-19T12:56:50.494981Z [msghand] [net.cpp:4074] [PushMessage] [net] sending pong (8 bytes) peer=3\n\n - 2026-02-19T12:56:50.496498Z [msghand] [net_processing.cpp:3555] [ProcessMessage] [net] received: ping (8 bytes) peer=3\n\n - 2026-02-19T12:56:50.496522Z [msghand] [net.cpp:4074] [PushMessage] [net] sending pong (8 bytes) peer=3\n\n - 2026-02-19T12:56:50.497570Z [http] [httpserver.cpp:232] [http_request_cb] [http] Received a POST request for / from 127.0.0.1:59760\n\n - 2026-02-19T12:56:50.497615Z [http_pool_0] [rpc/request.cpp:243] [parse] [rpc] ThreadRPCServer method=getbestblockhash user=__cookie__\n\n\n\n\n\n2026-02-19T12:56:50.558119Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n\n2026-02-19T12:56:50.558309Z TestFramework (WARNING): Not cleaning up dir D:\\a\\bitcoin\\bitcoin\\test_runner_₿_🏃_20260219_124134\\p2p_invalid_tx_138\n\n2026-02-19T12:56:50.558437Z TestFramework (ERROR): Test failed. Test logging available at D:\\a\\bitcoin\\bitcoin\\test_runner_₿_🏃_20260219_124134\\p2p_invalid_tx_138/test_framework.log\n\n2026-02-19T12:56:50.558563Z TestFramework (ERROR): \n\n2026-02-19T12:56:50.558923Z TestFramework (ERROR): Hint: Call D:\\a\\bitcoin\\bitcoin\\test\\functional\\combine_logs.py 'D:\\a\\bitcoin\\bitcoin\\test_runner_₿_🏃_20260219_124134\\p2p_invalid_tx_138' to consolidate all logs\n\n2026-02-19T12:56:50.559050Z TestFramework (ERROR): \n\n2026-02-19T12:56:50.559148Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\n\n2026-02-19T12:56:50.559269Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\n\n2026-02-19T12:56:50.559367Z TestFramework (ERROR): \n\n\n\nstderr:\n[node 0] Cleaning up leftover process\n\n\n\n```",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-02-19T13:52:12Z",
      "updated_at": "2026-02-21T00:46:15Z",
      "closed_at": "2026-02-21T00:46:15Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34621",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 12478,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3834142125,
      "number": 34354,
      "title": "test `wallet_assumeutxo.py` / wallet_backup.py is failing intermittently: wallet.cpp:543  RestoreWallet  Assertion `fs::is_empty(wallet_path)' failed. ",
      "body": "ISTM that the [Windows, ucrt, test cross-built CI failure](https://github.com/bitcoin/bitcoin/actions/runs/21172425203/job/60894641918?pr=33014) is unrelated, a restore wallet test case related to pruned blockchain in `wallet_assumeutxo.py` is failing.\r\n\r\n<details open>\r\n<summary>From the logs:</summary>\r\n\r\n```zsh\r\n2026-01-20T13:41:07.2385503Z 2026-01-20T13:41:04.152353Z TestFramework (INFO): Ensuring wallet can't be restored from a backup that was created before the pruneheight (pruned node)\r\n2026-01-20T13:41:07.2386535Z \r\n2026-01-20T13:41:07.2386839Z 2026-01-20T13:41:06.479889Z TestFramework (ERROR): Unexpected exception\r\n2026-01-20T13:41:07.2387306Z \r\n2026-01-20T13:41:07.2387503Z Traceback (most recent call last):\r\n2026-01-20T13:41:07.2387815Z \r\n2026-01-20T13:41:07.2388269Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\util.py\", line 166, in try_rpc\r\n2026-01-20T13:41:07.2388901Z \r\n2026-01-20T13:41:07.2389049Z     fun(*args, **kwds)\r\n2026-01-20T13:41:07.2389318Z \r\n2026-01-20T13:41:07.2389432Z     ~~~^^^^^^^^^^^^^^^\r\n2026-01-20T13:41:07.2389660Z \r\n2026-01-20T13:41:07.2390180Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\coverage.py\", line 50, in __call__\r\n2026-01-20T13:41:07.2390808Z \r\n2026-01-20T13:41:07.2391156Z     return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n2026-01-20T13:41:07.2391651Z \r\n2026-01-20T13:41:07.2392093Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\authproxy.py\", line 156, in __call__\r\n2026-01-20T13:41:07.2392771Z \r\n2026-01-20T13:41:07.2392996Z     raise JSONRPCException(response['error'], status)\r\n2026-01-20T13:41:07.2393424Z \r\n2026-01-20T13:41:07.2395532Z test_framework.authproxy.JSONRPCException: filesystem error: cannot remove: The process cannot access the file because it is being used by another process [D:\\a\\_temp\\test_runner_₿_🏃_20260120_132914\\wallet_assumeutxo_56\\node3\\regtest\\w2\\wallet.dat] (-1)\r\n2026-01-20T13:41:07.2397271Z \r\n2026-01-20T13:41:07.2397277Z \r\n2026-01-20T13:41:07.2397281Z \r\n2026-01-20T13:41:07.2397613Z During handling of the above exception, another exception occurred:\r\n2026-01-20T13:41:07.2398102Z \r\n2026-01-20T13:41:07.2398107Z \r\n2026-01-20T13:41:07.2398112Z \r\n2026-01-20T13:41:07.2398334Z Traceback (most recent call last):\r\n2026-01-20T13:41:07.2398622Z \r\n2026-01-20T13:41:07.2399135Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\test_framework.py\", line 142, in main\r\n2026-01-20T13:41:07.2399796Z \r\n2026-01-20T13:41:07.2399922Z     self.run_test()\r\n2026-01-20T13:41:07.2400161Z \r\n2026-01-20T13:41:07.2400286Z     ~~~~~~~~~~~~~^^\r\n2026-01-20T13:41:07.2400474Z \r\n2026-01-20T13:41:07.2400948Z   File \"D:\\a\\bitcoin\\bitcoin/test/functional/wallet_assumeutxo.py\", line 267, in run_test\r\n2026-01-20T13:41:07.2401587Z \r\n2026-01-20T13:41:07.2401827Z     self.test_restore_wallet_pruneheight(n3)\r\n2026-01-20T13:41:07.2402338Z \r\n2026-01-20T13:41:07.2402476Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^\r\n2026-01-20T13:41:07.2402806Z \r\n2026-01-20T13:41:07.2403384Z   File \"D:\\a\\bitcoin\\bitcoin/test/functional/wallet_assumeutxo.py\", line 99, in test_restore_wallet_pruneheight\r\n2026-01-20T13:41:07.2404151Z \r\n2026-01-20T13:41:07.2404691Z     assert_raises_rpc_error(-4, error_message, n3.restorewallet, \"w2\", \"backup_w2.dat\")\r\n2026-01-20T13:41:07.2405294Z \r\n2026-01-20T13:41:07.2405553Z     ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n2026-01-20T13:41:07.2405970Z \r\n2026-01-20T13:41:07.2406496Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\util.py\", line 157, in assert_raises_rpc_error\r\n2026-01-20T13:41:07.2407238Z \r\n2026-01-20T13:41:07.2407544Z     assert try_rpc(code, message, fun, *args, **kwds), \"No exception raised\"\r\n2026-01-20T13:41:07.2408097Z \r\n2026-01-20T13:41:07.2408261Z            ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n2026-01-20T13:41:07.2408598Z \r\n2026-01-20T13:41:07.2409048Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\util.py\", line 170, in try_rpc\r\n2026-01-20T13:41:07.2409645Z \r\n2026-01-20T13:41:07.2410041Z     raise AssertionError(\"Unexpected JSONRPC error code %i\" % e.error[\"code\"])\r\n2026-01-20T13:41:07.2410583Z \r\n2026-01-20T13:41:07.2410797Z AssertionError: Unexpected JSONRPC error code -1\r\n2026-01-20T13:41:07.2411215Z \r\n2026-01-20T13:41:07.2411925Z 2026-01-20T13:41:06.484138Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\r\n2026-01-20T13:41:07.2412795Z \r\n2026-01-20T13:41:07.2413676Z 2026-01-20T13:41:06.484270Z TestFramework (WARNING): Not cleaning up dir D:\\a\\_temp\\test_runner_₿_🏃_20260120_132914\\wallet_assumeutxo_56\r\n2026-01-20T13:41:07.2414525Z \r\n2026-01-20T13:41:07.2415646Z 2026-01-20T13:41:06.484375Z TestFramework (ERROR): Test failed. Test logging available at D:\\a\\_temp\\test_runner_₿_🏃_20260120_132914\\wallet_assumeutxo_56/test_framework.log\r\n2026-01-20T13:41:07.2416737Z \r\n\r\n2026-01-20T13:42:33.3464929Z wallet_assumeutxo.py                                                             | ✖ Failed  | 8 s\r\n2026-01-20T13:42:33.3465209Z \r\n2026-01-20T13:42:33.3465460Z ALL                                                                              | ✖ Failed  | 2893 s (accumulated) \r\n2026-01-20T13:42:33.3465784Z Runtime: 796 s\r\n\r\n```\r\n</details>\r\n\r\n_Originally posted by @rkrux in https://github.com/bitcoin/bitcoin/issues/33014#issuecomment-3773073528_\r\n            ",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-20T15:07:00Z",
      "updated_at": "2026-02-20T23:02:01Z",
      "closed_at": null,
      "comments": 20,
      "url": "https://github.com/bitcoin/bitcoin/issues/34354",
      "labels": [
        "Bug",
        "Wallet",
        "CI failed"
      ],
      "comment_data": [
        {
          "id": 3929236184,
          "user": "maflcko",
          "body": "Not sure if https://github.com/bitcoin/bitcoin/pull/34619 is going to fix this issue. If the journal was zero'd, the size should be small, but  I don't see such small files after the test failure:\n\n```\n# find '/tmp/test_runner_\\342\\202\\277_\\360\\237\\217\\203_20260219_175359/wallet_assumeutxo_8651' \\\n  -type f -name 'wallet.dat-journal' -exec wc -c {} +\n 25136 /tmp/test_runner_₿_🏃_20260219_175359/wallet_assumeutxo_8651/node0/regtest/w/wallet.dat-journal\n 25136 /tmp/test_runner_₿_🏃_20260219_175359/wallet_assumeutxo_8651/node0/regtest/w2/wallet.dat-journal\n 25136 /tmp/test_runner_₿_🏃_20260219_175359/wallet_assumeutxo_8651/node1/regtest/w/wallet.dat-journal\n 12824 /tmp/test_runner_₿_🏃_20260219_175359/wallet_assumeutxo_8651/node1/regtest/w1/wallet.dat-journal\n 25136 /tmp/test_runner_₿_🏃_20260219_175359/wallet_assumeutxo_8651/node1/regtest/w2/wallet.dat-journal\n 25136 /tmp/test_runner_₿_🏃_20260219_175359/wallet_assumeutxo_8651/node2/regtest/w/wallet.dat-journal\n 25136 /tmp/test_runner_₿_🏃_20260219_175359/wallet_assumeutxo_8651/node3/regtest/w/wallet.dat-journal\n 12824 /tmp/test_runner_₿_🏃_20260219_175359/wallet_assumeutxo_8651/node3/regtest/w2_pruneheight/wallet.dat-journal\n ```\n\nSee https://drahtbot.space/temp_scratch/wallet_assumeutxo_8651.tar.zstd\n\n\nAnd:\n\n```\n# find $'/tmp/test_runner_\\342\\202\\277_\\360\\237\\217\\203_20260217_203305' \\\n  -type f -name 'wallet.dat-journal' -exec wc -c {} +\n 25136 /tmp/test_runner_₿_🏃_20260217_203305/wallet_backup_262/node0/regtest/wallets/default_wallet/wallet.dat-journal\n 25136 /tmp/test_runner_₿_🏃_20260217_203305/wallet_backup_262/node1/regtest/wallets/default_wallet/wallet.dat-journal\n 25136 /tmp/test_runner_₿_🏃_20260217_203305/wallet_backup_262/node2/regtest/wallets/default_wallet/wallet.dat-journal\n 29240 /tmp/test_runner_₿_🏃_20260217_203305/wallet_backup_262/node3/regtest/wallets/default_wallet/wallet.dat-journal\n 29240 /tmp/test_runner_₿_🏃_20260217_203305/wallet_backup_262/node3/regtest/wallets/pruned/wallet.dat-journal\n 21032 /tmp/test_runner_₿_🏃_20260217_203305/wallet_backup_262/node3/regtest/wallets/restore_pruned/wallet.dat-journal\n\n```\n\nhttps://drahtbot.space/temp_scratch/wallet_backup_262.tar.zstd\n\n\n\n\n",
          "created_at": "2026-02-19T18:51:34Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 2177,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3929441550,
          "user": "achow101",
          "body": "> If the journal was zero'd, the size should be small, but I don't see such small files after the test failure:\n\nSQLite doesn't always truncate or delete the journal file. It may only overwrite the header with 0's to invalidate the file. I believe it does this when the file is larger than the disk sector size. #34619 does handle that case though.\n\nEdit: Looking at the files provided, the journal files all have 0'd headers",
          "created_at": "2026-02-19T19:25:49Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 425,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3930451868,
          "user": "maflcko",
          "body": "It is a bit odd, that it is only me that can reproduce this. Does this diff work to reproduce?\n\n\n```diff\ndiff --git a/src/validationinterface.cpp b/src/validationinterface.cpp\nindex c7be6abc3a..aacb7b6563 100644\n--- a/src/validationinterface.cpp\n+++ b/src/validationinterface.cpp\n@@ -14,2 +14,3 @@\n #include <primitives/transaction.h>\n+#include <random.h>\n #include <util/check.h>\n@@ -156,2 +157,4 @@ void ValidationSignals::SyncWithValidationInterfaceQueue()\n \n+static FastRandomContext g_rnd{};\n+\n // Use a macro instead of a function for conditional logging to prevent\n@@ -166,2 +169,3 @@ void ValidationSignals::SyncWithValidationInterfaceQueue()\n             LOG_EVENT(fmt, local_name, __VA_ARGS__);           \\\n+            if(g_rnd.randrange(2)<1)UninterruptibleSleep(15ms);\\\n             event();                                           \\\ndiff --git a/src/wallet/wallet.cpp b/src/wallet/wallet.cpp\nindex 63dab29972..21629dd546 100644\n--- a/src/wallet/wallet.cpp\n+++ b/src/wallet/wallet.cpp\n@@ -74,2 +74,3 @@\n #include <algorithm>\n+#include <atomic>\n #include <cassert>\n@@ -77,2 +78,3 @@\n #include <exception>\n+#include <mutex>\n #include <optional>\n@@ -83,2 +85,7 @@\n \n+std::atomic<bool> g_debug_waiting{false};\n+std::atomic<bool> g_debug_continue{false};\n+std::mutex g_debug_mutex;\n+std::condition_variable g_debug_cv;\n+\n struct KeyOriginInfo;\n@@ -542,2 +549,3 @@ std::shared_ptr<CWallet> RestoreWallet(WalletContext& context, const fs::path& b\n         if (created_parent_dir) {\n+        UninterruptibleSleep(1ms);\n             Assume(fs::is_empty(wallet_path));\n@@ -1530,2 +1538,7 @@ void CWallet::blockConnected(const ChainstateRole& role, const interfaces::Block\n     }\n+    UninterruptibleSleep(20ms);\n+    if (g_debug_waiting) {\n+        g_debug_continue = true;\n+        g_debug_cv.notify_all();\n+    }\n     assert(block.data);\n@@ -3199,2 +3212,10 @@ bool CWallet::AttachChain(const std::shared_ptr<CWallet>& walletInstance, interf\n \n+    {\n+        g_debug_continue = false;\n+        g_debug_waiting = true;\n+        std::unique_lock<std::mutex> lock(g_debug_mutex);\n+        g_debug_cv.wait_for(lock, std::chrono::seconds(2), [] { return g_debug_continue.load(); });\n+        g_debug_waiting = false;\n+    }\n+\n     // If rescan_required = true, rescan_height remains equal to 0\n```\n\nWith that patch, I can reproduce the crash, even with https://github.com/bitcoin/bitcoin/pull/34619\n",
          "created_at": "2026-02-19T22:16:08Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 2402,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3930922504,
          "user": "achow101",
          "body": "> Does this diff work to reproduce?\n\nOnly for `wallet_assumeutxo.py`.\n\nI see what the problem is now. There is a race condition where the blocks that were generated and subsequently pruned are still in the validation interface queue, so when the wallet is being loaded for the restore, there are `blockConnected` signals that the wallet starts processing after `AttachChain` exits with the error about being pruned. Since `AttachChain` errors, we are expecting the wallet to be immediately destroyed once `LoadExisting` exits as the wallet shared_ptr goes out of scope. However, if it is still processing `blockConnected`s slowly, the shared_ptr still exists so the database is still open, so we get both the windows issue (the database file is still open) and the assertion (the journal file hasn't been deleted as the database has not been closed).\n\nAdding a `n3.syncwithvalidationinterfacequeue` after `self.generate` fixes the issue in the test, but the race is still actually there and that needs to be fixed.\n\nAlso I guess linux just lets us delete a file that is still open?\n\nThe `wallet_backup.py` failure may be related to this, but the diff does not cause that to fail for me. However, it is a similar failure scenario in restoring a backup to a pruned node, right after a bunch of blocks were generated. Edit: It fails if I increase the number of generated blocks. Likewise it is fixed with a `syncwithvalidationinterfacequeue()', so I believe it's the same problem.",
          "created_at": "2026-02-20T00:34:44Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 1477,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3935712712,
          "user": "maflcko",
          "body": "For reference, the diff for wallet_backup would be:\n\n```diff\ndiff --git a/src/wallet/wallet.cpp b/src/wallet/wallet.cpp\nindex 63dab29..1bcf597 100644\n--- a/src/wallet/wallet.cpp\n+++ b/src/wallet/wallet.cpp\n@@ -74,2 +74,3 @@\n #include <algorithm>\n+#include <atomic>\n #include <cassert>\n@@ -77,2 +78,3 @@\n #include <exception>\n+#include <mutex>\n #include <optional>\n@@ -83,2 +85,7 @@\n \n+std::atomic<bool> g_debug_waiting{false};\n+std::atomic<bool> g_debug_continue{false};\n+std::mutex g_debug_mutex;\n+std::condition_variable g_debug_cv;\n+\n struct KeyOriginInfo;\n@@ -542,2 +549,3 @@ std::shared_ptr<CWallet> RestoreWallet(WalletContext& context, const fs::path& b\n         if (created_parent_dir) {\n+        UninterruptibleSleep(1ms);\n             Assume(fs::is_empty(wallet_path));\n@@ -1530,2 +1538,7 @@ void CWallet::blockConnected(const ChainstateRole& role, const interfaces::Block\n     }\n+    if (g_debug_waiting) {\n+        g_debug_continue = true;\n+        g_debug_cv.notify_all();\n+    }\n+    UninterruptibleSleep(260ms);\n     assert(block.data);\n@@ -3199,2 +3212,10 @@ bool CWallet::AttachChain(const std::shared_ptr<CWallet>& walletInstance, interf\n \n+    {\n+        g_debug_continue = false;\n+        g_debug_waiting = true;\n+        std::unique_lock<std::mutex> lock(g_debug_mutex);\n+        g_debug_cv.wait_for(lock, std::chrono::seconds(2), [] { return g_debug_continue.load(); });\n+        g_debug_waiting = false;\n+    }\n+\n     // If rescan_required = true, rescan_height remains equal to 0\n```\n\nThen,\n\n```\nwhile ( ./bld-cmake/test/functional/test_runner.py -j 12 --timeout-factor=4 $( printf \"wallet_backup %.0s\" {1..12} ) ) ; do echo >> /tmp/counter_ ; done\n```\n\nGives:\n\n```\nTEST             | STATUS    | DURATION\n\nwallet_backup.py | ✓ Passed  | 186 s\nwallet_backup.py | ✓ Passed  | 189 s\nwallet_backup.py | ✓ Passed  | 190 s\nwallet_backup.py | ✖ Failed  | 189 s\nwallet_backup.py | ✖ Failed  | 190 s\nwallet_backup.py | ✖ Failed  | 191 s\nwallet_backup.py | ✖ Failed  | 191 s\nwallet_backup.py | ✖ Failed  | 191 s\nwallet_backup.py | ✖ Failed  | 192 s\nwallet_backup.py | ✖ Failed  | 192 s\nwallet_backup.py | ✖ Failed  | 192 s\nwallet_backup.py | ✖ Failed  | 192 s\n\nALL              | ✖ Failed  | 2285 s (accumulated) \nRuntime: 192 s\n",
          "created_at": "2026-02-20T15:53:17Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 2244,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3937554619,
          "user": "achow101",
          "body": "#34642 resolves the issue for me with the previous reproducer.",
          "created_at": "2026-02-20T23:02:01Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 62,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 5559,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3959509636,
      "number": 34618,
      "title": "test: cmpctblock: No coverage for fRevertToHeaderProcessing in compact block message handling.",
      "body": "### At a glance\n\nThe following diff causes no tests to fail:\n\n```diff\ndiff --git a/src/net_processing.cpp b/src/net_processing.cpp\nindex e5b4bc7772..d9b0b46733 100644\n--- a/src/net_processing.cpp\n+++ b/src/net_processing.cpp\n@@ -4576,10 +4576,6 @@ void PeerManagerImpl::ProcessMessage(Peer& peer, CNode& pfrom, const std::string\n\n         bool fProcessBLOCKTXN = false;\n\n-        // If we end up treating this as a plain headers message, call that as well\n-        // without cs_main.\n-        bool fRevertToHeaderProcessing = false;\n-\n         // Keep a CBlock for \"optimistic\" compactblock reconstructions (see\n         // below)\n         std::shared_ptr<CBlock> pblock = std::make_shared<CBlock>();\n@@ -4713,18 +4709,6 @@ void PeerManagerImpl::ProcessMessage(Peer& peer, CNode& pfrom, const std::string\n                     fBlockReconstructed = true;\n                 }\n             }\n-        } else {\n-            if (requested_block_from_this_peer) {\n-                // We requested this block, but its far into the future, so our\n-                // mempool will probably be useless - request the block normally\n-                std::vector<CInv> vInv(1);\n-                vInv[0] = CInv(MSG_BLOCK | GetFetchFlags(peer), blockhash);\n-                MakeAndPushMessage(pfrom, NetMsgType::GETDATA, vInv);\n-                return;\n-            } else {\n-                // If this was an announce-cmpctblock, we want the same treatment as a header message\n-                fRevertToHeaderProcessing = true;\n-            }\n         }\n         } // cs_main\n\n@@ -4734,15 +4718,6 @@ void PeerManagerImpl::ProcessMessage(Peer& peer, CNode& pfrom, const std::string\n             return ProcessCompactBlockTxns(pfrom, peer, txn);\n         }\n\n-        if (fRevertToHeaderProcessing) {\n-            // Headers received from HB compact block peers are permitted to be\n-            // relayed before full validation (see BIP 152), so we don't want to disconnect\n-            // the peer if the header turns out to be for an invalid block.\n-            // Note that if a peer tries to build on an invalid chain, that\n-            // will be detected and the peer will be disconnected/discouraged.\n-            return ProcessHeadersMessage(pfrom, peer, {cmpctblock.header}, /*via_compact_block=*/true);\n-        }\n-\n         if (fBlockReconstructed) {\n             // If we got here, we were able to optimistically reconstruct a\n             // block that is in flight from some other peer.\n```\n\n---\n\nIn some circumstances, a node might receive a [`CMPCTBLOCK`](https://github.com/bitcoin/bips/blob/master/bip-0152.mediawiki) [message](https://github.com/bitcoin/bips/blob/master/bip-0152.mediawiki#headerandshortids) which for one reason or another that there is no hope of being able to successfully reconstruct the block from the CMPCTBLOCK. \n\nOne case that is covered in existing code, is if a `CMPCTBLOCK` is received that has a height `>= ActiveChain().Height() + 2`:\nhttps://github.com/bitcoin/bitcoin/blob/9e4567b17a285a266fa540b4141e0db5781cc228/src/net_processing.cpp#L4637 `                // [Process the block bla bla bla...]`\nhttps://github.com/bitcoin/bitcoin/blob/9e4567b17a285a266fa540b4141e0db5781cc228/src/net_processing.cpp#L4716-L4728\n\nIn this case, our mempool is not very likely to be helpful but a header exists with valid PoW, so it's worth it for us to work hard to try to get the block from our peer, so we revert to treating it as a headers message. My assumption is that the reason for checking if we already have requested the block is to be able to break out of a loop where we request a block and get a CMPCTBLOCK response, but can't process the CMPCTBLOCK message.\n\nThat all seems reasonable, and we should probably have functional test cases for it, but I want to also ask if it makes sense to do this at all since above in the CMPCTBLOCK messages, we have already processed the header as part of our anti-dos checks:\n\nhttps://github.com/bitcoin/bitcoin/blob/9e4567b17a285a266fa540b4141e0db5781cc228/src/net_processing.cpp#L4564\n\nand we've updated our state for the peer to indicate that they have this block:\n\nhttps://github.com/bitcoin/bitcoin/blob/9e4567b17a285a266fa540b4141e0db5781cc228/src/net_processing.cpp#L4590\n\nSo what is the difference between doing those two things and calling ProcessHeadersMessage? As far as I can tell the only difference is that ProcessHeadersMessage will send a request for the block immediately. But I'm pretty sure that by learning the header, and marking the peer as knowing about the header, we'll send a `GETDATA` for the block on the next tick of `SendMessages` for this peer:\n\nhttps://github.com/bitcoin/bitcoin/blob/9e4567b17a285a266fa540b4141e0db5781cc228/src/net_processing.cpp#L6113-L6148\n\nSo maybe this code can be safely deleted, since it's mostly a no-op.",
      "state": "open",
      "user": "davidgumberg",
      "created_at": "2026-02-18T19:49:14Z",
      "updated_at": "2026-02-20T19:45:03Z",
      "closed_at": null,
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34618",
      "labels": [],
      "comment_data": [
        {
          "id": 3934786810,
          "user": "Crypt-iQ",
          "body": "This makes sense to me. I also noticed that there are no tests for this branch. I could not figure out via the git history why this check was introduced. I think some tests here would also be nice to add.",
          "created_at": "2026-02-20T13:44:52Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 204,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 4927,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3901573586,
      "number": 34513,
      "title": "CMake 4.1.0+ fails to configure cross-build for macOS with Ninja generator",
      "body": "When cross-compiling for macOS on Linux, the configuration step fails when using the Ninja generator:\n```\n$ gmake -j $(nproc) -C depends HOST=x86_64-apple-darwin NO_QT=1\n$ cmake -B build -G Ninja --toolchain depends/x86_64-apple-darwin/toolchain.cmake\n<snip>\nCMake Error at src/CMakeLists.txt:301 (add_executable):\n  The install of the bitcoind target requires changing an RPATH from the\n  build tree, but this is not supported with the Ninja generator unless on an\n  ELF-based or XCOFF-based platform.  The CMAKE_BUILD_WITH_INSTALL_RPATH\n  variable may be set to avoid this relinking step.\n\n\n<snip>\n```\n\nThis behavior is observed with CMake starting from version 4.1.0.\n\nThis issue does not occur when building with depends on macOS.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2026-02-05T13:25:18Z",
      "updated_at": "2026-02-20T12:40:38Z",
      "closed_at": null,
      "comments": 18,
      "url": "https://github.com/bitcoin/bitcoin/issues/34513",
      "labels": [
        "macOS",
        "Build system",
        "Upstream"
      ],
      "comment_data": [
        {
          "id": 3933780423,
          "user": "fanquake",
          "body": "From what I can tell, this doesn't effect `30.x`?",
          "created_at": "2026-02-20T12:12:17Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 49,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3934086513,
          "user": "hebasto",
          "body": "> From what I can tell, this doesn't effect `30.x`?\n\nTrue.",
          "created_at": "2026-02-20T12:40:37Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 58,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 809,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3586989882,
      "number": 33777,
      "title": "Mining interface tracking issue",
      "body": "The mining interface is defined in:\n- https://github.com/bitcoin/bitcoin/blob/master/src/interfaces/mining.h\n- https://github.com/bitcoin/bitcoin/blob/master/src/ipc/capnp/mining.capnp\n\nClients that are known to depend on it:\n- https://github.com/stratum-mining/sv2-tp\n- https://github.com/stratum-mining/sv2-apps/tree/main/bitcoin-core-sv2\n\n**Priority changes for v31.x:**\n\nThese are bug fixes, not new features. Except for #34568 (already merged) they are not breaking changes, so they if they don't make it into v31.0, they can safely be back-ported for v31.1. But it's better if they do make it.  \n\n- [ ] #34284\n- [ ] https://github.com/bitcoin-core/libmultiprocess/pull/240\n  - [ ] #34422\n- [x] #34568\n  - [ ] #34184\n\n---\n\n**Non-breaking changes for later releases**\n\nThe changes below are not breaking, unless mentioned otherwise. Adding new methods or new arguments to existing methods is not a breaking change.\n\n- [x] #33965 \n  - [ ] #33966\n- [ ] #34020\n- [ ] #33899\n  - [ ] #33922\n- [ ] #33756 \n\nAt this state it's OK to make breaking changes, such as deleting a method or changing its signature. But ideally we should do so once in a major release, collecting a bunch of fixes.\n\nMisc related:\n\n- [ ] #30437",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-04T15:05:33Z",
      "updated_at": "2026-02-20T12:07:25Z",
      "closed_at": null,
      "comments": 16,
      "url": "https://github.com/bitcoin/bitcoin/issues/33777",
      "labels": [
        "Mining",
        "interfaces",
        "Tracking Issue"
      ],
      "comment_data": [
        {
          "id": 3933434789,
          "user": "Sjors",
          "body": "And the merging continues!\n\nI added a \"Priority changes for v31\" section at the top.\n\nI dropped https://github.com/Sjors/bitcoin/commit/2ece972a3f78cb7faaf75b6271016316ead572f4 and https://github.com/Sjors/bitcoin/pull/106/changes/40d1886584d3d7c89fa5656e325222edd51c2f89 from the overview because I don't think they're very useful:\n- clients should not use `getBlock()` to get the (dummy) coinbase transaction, but we can make that clear in documentation.\n- we could omit the witness op_return for empty blocks, but we almost never produce those anyway and there's no need to save space in an empty block",
          "created_at": "2026-02-20T11:39:13Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 605,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1248,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3966579468,
      "number": 34629,
      "title": "interfaces/wallet: replace raw receive-request string APIs with typed methods",
      "body": "### Please describe the feature you'd like to see added.\n\nAdd typed receive-request APIs to interfaces::Wallet so GUI code passes normal fields (address, label, message, amount, date) instead of serialized blobs.\n\n### Is your feature related to a problem, if so please describe it.\n\nThe current interface uses raw strings for receive requests, and GUI code serializes/de-serializes RecentRequestEntry itself. That couples GUI code to wallet storage format and makes format changes risky. Gui actually crashes if it can't de-serialize the string.\n\n### Describe the solution you'd like\n\nAdd typed wallet methods for receive requests (list/save/delete). UI interfacing with the wallet should have clean types/objects so it knows exactly what to expect.\n\nThe wallet should likely also be responsible for assigning ids, handle legacy entries, and deal with compatibility.\n\n### Describe any alternatives you've considered\n\nKeep the current string API and just harden GUI parsing. GUI still owns the storage format, though, and you just have to hope all of the user interfaces interacting with the wallet data are serializing the data in the same way.\n\n### Please leave any additional context\n\n_No response_",
      "state": "open",
      "user": "johnny9",
      "created_at": "2026-02-20T04:52:56Z",
      "updated_at": "2026-02-20T07:18:11Z",
      "closed_at": null,
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/34629",
      "labels": [
        "Feature",
        "Wallet",
        "interfaces"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1278,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3747139562,
      "number": 34114,
      "title": "log: frequent `pcp: Mapping failed with result NOT_AUTHORIZED (code 2)` logs as `net:warning`",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nOn my node at home (not a monitoring node), I'm seeing three `pcp: Mapping failed with result NOT_AUTHORIZED (code 2)` logs every five minutes logged as `net:warnings`. I think that's too frequent.\n\n```\n...\n2025-12-19T10:32:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:32:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:32:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:37:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:37:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:37:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:42:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:42:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:42:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:47:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:47:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:47:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:52:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:52:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:52:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:57:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:57:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T10:57:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T11:00:54Z Flushed fee estimates to fee_estimates.dat.\n2025-12-19T11:02:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T11:02:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n2025-12-19T11:02:26Z [net:warning] pcp: Mapping failed with result NOT_AUTHORIZED (code 2)\n...\n```\n\n### Expected behaviour\n\nFewer of the pcp warnings.\n\n### Steps to reproduce\n\nRun a node behind a router that returns NOT_AUTHORIZED for PCP (?)\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nPackage manager\n\n### What version of Bitcoin Core are you using?\n\nv30.0 (via nixpkgs)\n\n### Operating system and version\n\nNixOS\n\n### Machine specifications\n\nMachine is behind a home internet router with PCP disabled by default.  I'm running the node with `txindex=1`, `addnode`, and otherwise default configuration.",
      "state": "closed",
      "user": "0xB10C",
      "created_at": "2025-12-19T11:16:06Z",
      "updated_at": "2026-02-20T00:58:08Z",
      "closed_at": "2026-02-20T00:58:08Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34114",
      "labels": [
        "Utils/log/libs"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2929,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3931343578,
      "number": 34573,
      "title": "bug: uncaught exception from RPC invocation during shutdown",
      "body": "The new thread pool introduced in https://github.com/bitcoin/bitcoin/pull/33689 [will throw an exception](https://github.com/bitcoin/bitcoin/blob/07b924775e4ff5dbfb9f2e7549fd13db8ec5c61b/src/util/threadpool.h#L162) (which will not be caught and lead to an unclean exit) if an RPC is called during shutdown.\n\n```\n2026-02-11T18:56:34Z [http:debug] Received a POST request for / from 10.89.0.6:58998\n2026-02-11T18:56:34Z [http:debug] Interrupting HTTP server\n2026-02-11T18:56:34Z [rpc:debug] Interrupting HTTP RPC server\n2026-02-11T18:56:34Z [all:info] http_pool_1 thread exit\n2026-02-11T18:56:34Z [all:info] http_pool_0 thread exit\n2026-02-11T18:56:34Z [rpc:debug] Interrupting RPC\nterminate called after throwing an instance of 'std::runtime_error'\n  what():  No active workers; cannot accept new tasks\n```\n\n*This was found with a test running on [Antithesis](https://antithesis.com/).*\n",
      "state": "closed",
      "user": "dergoegge",
      "created_at": "2026-02-12T11:31:49Z",
      "updated_at": "2026-02-19T20:41:23Z",
      "closed_at": "2026-02-19T20:41:23Z",
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/issues/34573",
      "labels": [
        "Bug",
        "RPC/REST/ZMQ"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 946,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3542617139,
      "number": 33684,
      "title": "Async Payjoin",
      "body": "This issue is for the tracking and brainstorming of the implementation of [BIP 77 Async Payjoin](https://github.com/bitcoin/bips) into the wallet.\n\n***\n\n- [ ] HPKE #32617 \n- [ ] The rest :)\n\n***\n\nAsync Payjoin utilizes an external Directory server to allow the Sender and Receiver to communicate with each other without needing to operate any infrastructure. The servers are reached using [RFC 9458 Oblivious HTTP (OHTTP)](https://www.ietf.org/rfc/rfc9458.html) relays to avoid revealing the IPs of the Sender and Receiver to the Directory. All communication between the Sender or Recevier to the OHTTP Relay is encrypted, as described in the OHTTP RFC. Additionally, the payload data itself is encrypted with methodology similar to OHTTP to prevent the Directory from being able to read the transaction data.\n\nThe cryptography uses things that we already have in the project. Specifically, all keys used are EC keys on secp256k1, keys are exchanged using DH, and encryption is done with ChaCha20Poly1305. Pubkeys included directly in the payload (ephemeral keys used to do additional key exchanges for responses) are encoded with ElligatorSwift. All of these algorithms are already included in the project to support BIP 324, so it should not be difficult to reuse them for Async Payjoin.\n\nOHTTP itself is encrypted using the aforementioned cryptography. It uses plain HTTP, not HTTPS, so there is no need to include anything related to TLS.\n\n***\n\nThe general operation of Async Payjoin is:\n1. The Receiver produces a Bitcoin URI containing a parameter which includes the URL of a mailbox endpoint on a Directory server (i.e. some URL for the Sender to POST to). The URL additionally contains the public key of the Directory itself, and an ephemeral(ish)public key of the Receiver.\n2. The Receiver provides the URI to the Sender out of band.\n3. The Sender generates an ephemeral public key, performs a key exchange with the Receiver's ephemeral key to compute a shared secret. This shared secret is used with ChaCha20-Poly1305 to encrypt:\n   * A new ephemeral pubkey for the key exchange for the reply (Reply Key)\n   * The Original PSBT which pays the receiver\n4. The Sender connects to the specified Directory server via a OHTTP Relay, performing a DH key exchange with the Directory public key, and encrypting the ElligatorSwift encoding of their Reply Key and the encrypted payload produced in the previous step. The payload is POSTed to the specified mailbox endpoint.\n5. The Receiver polls the Directory server at the mailbox endpoint until it receives the Sender's payload.\n6. The Receiver performs DHKE with the Sender's ephemeral key, then decrypts the encrypted payload.\n7. The Receiver produces a Proposal PSBT which is the Sender's Original PSBT modified with the Receiver's inputs and outputs, as well as any necessary signatures and witnesses.\n8. The Receiver generates a new ephemeral key to perform DHKE with the Sender's Reply Key, and uses the shared secret to encrypt their Proposal PSBT\n9. The Receiver connects to the previously specified Directory via a OHTTP Relay, and provides an encapsulated payload of the ElligatorSwift encoding of their ephemeral key. The payload is POSTed to a new mailbox endpoint derived from the Sender's Reply Key.\n10. The Sender polls the Directory server at the mailbox endpoint derived from their Reply Key until it receives the Receiver's payload.\n11. The Sender performs DHKE with the Receiver's new ephemeral key, decrypts the Proposal PSBT, validates and signs it. The Sender broadcasts the final transaction.\n\nAdditionally, the original Bitcoin URI contains an expiration time. This is used by both the Sender and Receiver to have a timeout on polling the Directory. The Receiver can also broadcast the Original PSBT and the Sender should stop polling if it sees that be broadcast.\n\n***\n\nThere are a few questions that need to be answered for implementing Async Payjoin\n\n* If we are the Receiver, how do we get the pubkey of the Directory. Some suggestions are:\n  * The user gets it out of band somehow\n  * OHTTP specifies a way to do key discovery by querying the server directly without OHTTP. But this both requires TLS, and reveals our IP unless some other IP hiding method is used.\n  * A set of keys are hard coded into the software. (ew)\n* How do we choose which OHTTP relay to use?\n* What is the polling interval?\n* What shows in the GUI when we are waiting for and polling the Directory, for both Receivers and Senders?\n* We should not be automatically signing transactions for our users:\n  * How will Senders using the GUI be notified and prompted when a reply is received so that the PSBT can be signed?\n  * How will Senders using the CLI know when a reply was received and that a PSBT needs to be signed?",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-10-22T23:06:58Z",
      "updated_at": "2026-02-19T18:11:57Z",
      "closed_at": null,
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/issues/33684",
      "labels": [
        "Feature",
        "Wallet",
        "Tracking Issue"
      ],
      "comment_data": [
        {
          "id": 3928920481,
          "user": "achow101",
          "body": "Implementing this is not contingent on any of the GUIs. It needs to be in the wallet first, before the GUI can use it. The questions regarding the GUI are there to prompt some thought on that, but are not blockers.",
          "created_at": "2026-02-19T18:00:12Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 214,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3928937583,
          "user": "fanquake",
          "body": "> Implementing this is not contingent \n\nImplementing this is contingent on a plan for how it's going to ship, and what dependencies it needs. That includes a GUI discussion, which seems important, if the plan is for this feature to be exposed to non technical users.",
          "created_at": "2026-02-19T18:02:56Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 266,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3928990512,
          "user": "achow101",
          "body": "> Implementing this is contingent on a plan for how it's going to ship,[...] That includes a GUI discussion, which seems important, if the plan is for this feature to be exposed to non technical users.\n\nSure, but they are not so intrinsically linked that that discussion is a blocker. The plan is to make the feature available on both RPC and GUI. Which GUI it gets implemented on doesn't matter, and really only depends on what GUI we're supporting by the time we get to implementing that. Implementing in the GUI is basically the last step of this.\n\n> and what dependencies it needs\n\nIt doesn't need any new dependencies.",
          "created_at": "2026-02-19T18:11:57Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 623,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 4788,
        "has_nack": false,
        "has_ack": true
      }
    }
  ],
  "summary": {
    "total_prs": 235,
    "total_issues": 36,
    "total_comments": 87,
    "unique_participants": 87
  }
}