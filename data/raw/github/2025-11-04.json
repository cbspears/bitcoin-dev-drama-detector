{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T20:28:28.404553+00:00",
  "date": "2025-11-04",
  "pull_requests": [
    {
      "number": 33786,
      "title": "script: remove dead code in `CountWitnessSigOps`",
      "body": "Found while reviewing #32840\r\n\r\nThe `nullptr` witness path was dead in normal code paths: replacing it with reference enables us deleting unreachable logic.\r\n\r\nCode coverage proof:\r\nhttps://maflcko.github.io/b-c-cov/total.coverage/src/script/interpreter.cpp.gcov.html#L2135",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2025-11-04T21:53:12Z",
      "updated_at": "2025-11-07T12:47:30Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/33786",
      "labels": [
        "Consensus"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33786.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [darosior](https://github.com/bitcoin/bitcoin/pull/33786#pullrequestreview-3418942549), [stickies-v](https://github.com/bitcoin/bitcoin/pull/33786#pullrequestreview-3421542558), [kevkevinpal](https://github.com/bitcoin/bitcoin/pull/33786#issuecomment-3493137616), [maflcko](https://github.com/bitcoin/bitcoin/pull/33786#issuecomment-3498072962) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32317](https://github.com/bitcoin/bitcoin/pull/32317) (kernel: Separate UTXO set access from validation functions by TheCharlatan)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-11-04T21:53:18Z"
        },
        {
          "user": "kevkevinpal",
          "body": "ACK [24bcad3](https://github.com/bitcoin/bitcoin/pull/33786/commits/24bcad3d4df59690f30c9df8ebb62f0bddd0f1c7)",
          "created_at": "2025-11-05T20:10:25Z"
        },
        {
          "user": "maflcko",
          "body": "review ACK 24bcad3d4df59690f30c9df8ebb62f0bddd0f1c7 üêè\r\n\r\n<details><summary>Show signature</summary>\r\n\r\nSignature:\r\n\r\n```\r\nuntrusted comment: signature from minisign secret key on empty file; verify via: minisign -Vm \"${path_to_any_empty_file}\" -P RWTRmVTMeKV5noAMqVlsMugDDCyyTSbA3Re5AkUrhvLVln0tSaFWglOw -x \"${path_to_this_whole_four_line_signature_blob}\"\r\nRUTRmVTMeKV5npGrKx1nqXCw5zeVHdtdYURB/KlyA/LMFgpNCs+SkW9a8N95d+U4AP1RJMi+krxU1A3Yux4bpwZNLvVBKy0wLgM=\r\ntrusted comment: review ACK 24bcad3d4df59690f30c9df8ebb62f0bddd0f1c7 üêè\r\nhj6nIxI+40vPxamIgbX5LlbpRouEUxYZY48TXPn9b4qzVEGLo6G5sBwEiRQKpq2+LSPlEhKOLRkvjKpFnlFqBA==\r\n```\r\n\r\n</details>\r\n",
          "created_at": "2025-11-06T16:06:02Z"
        }
      ]
    },
    {
      "number": 33785,
      "title": "util: Allow `Assert` (et al.) in contexts without __func__",
      "body": "Without this, compile warnings could be hit about `__func__` being only valid inside functions.\r\n\r\n```\r\nwarning: predefined identifier is only valid inside function [-Wpredefined-identifier-outside-function] note: expanded from macro Assert\r\n  115 | #define Assert(val) inline_assertion_check<true>(val, __FILE__, __LINE__, __func__, #val)\r\n      |                                                                           ^\r\n```\r\n\r\nRef https://github.com/bitcoin/bitcoin/pull/32740#discussion_r2486258473\r\n\r\n\r\nThis also introduces a slight behaviour change, because `std::source_location::function_name` usually includes the entire function signature instead of just the name.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-11-04T21:04:28Z",
      "updated_at": "2025-11-14T04:00:32Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/pull/33785",
      "labels": [
        "Utils/log/libs"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33785.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [l0rinc](https://github.com/bitcoin/bitcoin/pull/33785#pullrequestreview-3428691572), [stickies-v](https://github.com/bitcoin/bitcoin/pull/33785#pullrequestreview-3429500574), [hodlinator](https://github.com/bitcoin/bitcoin/pull/33785#pullrequestreview-3430025702) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32543](https://github.com/bitcoin/bitcoin/pull/32543) (kernel: Remove dependency on clientversion by TheCharlatan)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-11-04T21:04:34Z"
        },
        {
          "user": "maflcko",
          "body": "Can be tested via the following diff:\r\n\r\n\r\n```diff\r\ndiff --git a/src/logging.cpp b/src/logging.cpp\r\nindex 2ed6835197..890e461cb9 100644\r\n--- a/src/logging.cpp\r\n+++ b/src/logging.cpp\r\n@@ -20,6 +20,7 @@\r\n using util::Join;\r\n using util::RemovePrefixView;\r\n \r\n+const int g_FOO{Assert(false)};\r\n const char * const DEFAULT_DEBUGLOGFILE = \"debug.log\";\r\n constexpr auto MAX_USER_SETABLE_SEVERITY_LEVEL{BCLog::Level::Info};\r\n \r\n```\r\n\r\nOr with a function name (slight change in behavior):\r\n\r\n```diff\r\ndiff --git a/src/logging.cpp b/src/logging.cpp\r\nindex 2ed6835197..761dbcbf58 100644\r\n--- a/src/logging.cpp\r\n+++ b/src/logging.cpp\r\n@@ -20,6 +20,7 @@\r\n using util::Join;\r\n using util::RemovePrefixView;\r\n \r\n+const int g_FOO{[]() { return Assert(false); }()};\r\n const char * const DEFAULT_DEBUGLOGFILE = \"debug.log\";\r\n constexpr auto MAX_USER_SETABLE_SEVERITY_LEVEL{BCLog::Level::Info};\r\n \r\n",
          "created_at": "2025-11-04T21:16:10Z"
        },
        {
          "user": "maflcko",
          "body": "Is this rfm with 3 acks?",
          "created_at": "2025-11-10T08:45:04Z"
        },
        {
          "user": "danielabrozzoni",
          "body": "post-merge concept ACK, thanks for working on this! :) ",
          "created_at": "2025-11-14T04:00:32Z"
        }
      ]
    },
    {
      "number": 33784,
      "title": ".",
      "body": "Refactor and clean up the SHA256 x86 SHANI implementation to improve code safety, readability, and consistency without any functional or behavioral changes.\r\n\r\nMotivation\r\n\r\nThis patch improves long-term maintainability and compiler compatibility of the SHANI-optimized SHA256 implementation used in Bitcoin Core.\r\nIt replaces C-style casts with reinterpret_cast to enforce type safety, ensures consistent use of static ALWAYS_INLINE linkage for internal helper functions, and converts static constants to constexpr for guaranteed compile-time initialization.\r\n\r\nBenefits\r\n\r\nImproves type safety and avoids undefined behavior across compilers.\r\n\r\nMakes the code consistent with modern C++ conventions used elsewhere in the crypto module.\r\n\r\nEnsures that constants are resolved at compile time, reducing startup cost.\r\n\r\nNo changes to hashing logic or results ‚Äî verified against existing SHA256 test vectors.\r\n\r\nTesting\r\n\r\nAll SHA256 and SHA256D64 test vectors in src/test/crypto_tests.cpp were re-run.\r\nResults are bit-for-bit identical with the pre-refactor implementation.\r\n\r\nScope\r\n\r\nThis PR is limited to code cleanup and refactor only.\r\nNo logic, algorithm, or performance behavior has been altered.",
      "state": "closed",
      "user": "Mystique85",
      "created_at": "2025-11-04T20:45:29Z",
      "updated_at": "2025-11-05T11:39:39Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/pull/33784",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "‚ôªÔ∏è Automatically closing for now based on heuristics. Please leave a comment, if this was erroneous. Generally, please focus on creating high-quality, original content that demonstrates a clear understanding of the project's requirements and goals.",
          "created_at": "2025-11-04T20:45:34Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33784.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (‚ú® experimental)\n\nPossible typos and grammar issues:\n\n- \"Further details on running\" -> \"Further details on running and extending unit tests can be found in [/src/test/README.md](/src/test/README.md).\" [The added line is a sentence fragment because the continuation (\"and extending unit tests...\") was placed on the next line; combine them so the sentence is complete.]\n\n<sup>drahtbot_id_5_m</sup>\n",
          "created_at": "2025-11-04T20:45:36Z"
        },
        {
          "user": "Mystique85",
          "body": "This PR refactors the SHA256 x86 SHANI implementation to improve code safety, readability, and maintainability **without changing the cryptographic logic or performance**.\r\n\r\nThe main goals are:\r\n- Use `constexpr` for compile-time constant initialization.\r\n- Use `reinterpret_cast` instead of C-style casts for type safety.\r\n- Apply `static ALWAYS_INLINE` consistently across helper functions.\r\n\r\nThe implementation has been verified against all SHA256 test vectors (bit-for-bit identical outputs).\r\n\r\nThis change improves compiler compatibility and aligns with the C++ style conventions in `src/crypto/`.\r\n\r\nPlease consider reopening for review.\r\n",
          "created_at": "2025-11-04T20:46:24Z"
        },
        {
          "user": "l0rinc",
          "body": "@Mystique85 the PR is lacking a purpose and it's obviously vibecoded, while it's not clear what problem it's solving and why this alternative would be any better.\r\nPlease only open PRs that are solving a real problem and make sure the solution is not this subjective.",
          "created_at": "2025-11-04T21:15:51Z"
        }
      ]
    },
    {
      "number": 33783,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "Mystique85",
      "created_at": "2025-11-04T20:41:12Z",
      "updated_at": "2025-11-06T01:43:38Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/pull/33783",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "‚ôªÔ∏è Automatically closing for now based on heuristics. Please leave a comment, if this was erroneous. Generally, please focus on creating high-quality, original content that demonstrates a clear understanding of the project's requirements and goals.",
          "created_at": "2025-11-04T20:41:16Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33783.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-11-04T20:41:18Z"
        }
      ]
    },
    {
      "number": 33782,
      "title": "test: remove obsolete `get_{key,multisig}` helpers from wallet_util.py",
      "body": "This small cleanup PR is a late follow-up to #31250 (commit c847dee1488a294c9a9632a00ba1134b21e41947). These helpers are unused and wouldn't work anymore, as they call a legacy wallet RPC (`dumpprivkey`). They were only ever used for testing the `importmulti` RPC, which also doesn't exist anymore. Functional tests that need to create key pairs and derive various output script types from them can use `get_generate_key` (introduced in #16528, commit f193ea889ddb53d9a5c47647966681d525e38368) instead, without involving the node.",
      "state": "closed",
      "user": "theStack",
      "created_at": "2025-11-04T18:06:23Z",
      "updated_at": "2025-11-07T11:53:12Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/pull/33782",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33782.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [rkrux](https://github.com/bitcoin/bitcoin/pull/33782#pullrequestreview-3420985296), [brunoerg](https://github.com/bitcoin/bitcoin/pull/33782#pullrequestreview-3422561866) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-11-04T18:06:29Z"
        }
      ]
    },
    {
      "number": 33781,
      "title": "clang-tidy: Remove no longer needed NOLINT",
      "body": "From https://github.com/bitcoin/bitcoin/pull/33714/files#r2491476516:\r\n> Actually, the `NOLINT` was fixed and can be removed? You've confirmed that it is undeclared on the listed platforms, so it can't be hit by `readability-redundant-declaration`",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-11-04T17:47:43Z",
      "updated_at": "2025-11-05T10:13:50Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/33781",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33781.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [maflcko](https://github.com/bitcoin/bitcoin/pull/33781#issuecomment-3487353719), [l0rinc](https://github.com/bitcoin/bitcoin/pull/33781#issuecomment-3488018942) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-11-04T17:47:48Z"
        },
        {
          "user": "maflcko",
          "body": "lgtm ACK 038849e2e09bb9f4ce1fb5a1f291745506c6a52d",
          "created_at": "2025-11-04T17:53:31Z"
        },
        {
          "user": "l0rinc",
          "body": "I wanted to ask the same on the original PR but forgot - ACK 038849e2e09bb9f4ce1fb5a1f291745506c6a52d",
          "created_at": "2025-11-04T21:08:02Z"
        }
      ]
    },
    {
      "number": 33780,
      "title": "guix: disable libsanitizer in Linux GCC build",
      "body": "This causes issues when building against newer glibcs (i.e 2.42), and isn't needed in any case.\r\n\r\n```bash\r\n../../../../gcc-14.3.0/libsanitizer/sanitizer_common/sanitizer_platform_limits_posix.cpp:483:31: error: invalid application of ‚Äòsizeof‚Äô to incomplete type ‚Äò__sanitizer::termio‚Äô\r\n  483 |   unsigned struct_termio_sz = sizeof(struct termio);\r\n      |                               ^~~~~~~~~~~~~~~~~~~~~\r\n```\r\n\r\nExtracted from #25573.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-11-04T17:33:04Z",
      "updated_at": "2025-11-05T09:56:40Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/pull/33780",
      "labels": [
        "Build system"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33780.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [maflcko](https://github.com/bitcoin/bitcoin/pull/33780#issuecomment-3487281858), [hebasto](https://github.com/bitcoin/bitcoin/pull/33780#pullrequestreview-3419058547), [willcl-ark](https://github.com/bitcoin/bitcoin/pull/33780#pullrequestreview-3420936380) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-11-04T17:33:10Z"
        },
        {
          "user": "maflcko",
          "body": "lgtm ACK 5c41fa2918c8fee36d0e0375e753249f1efa7c07",
          "created_at": "2025-11-04T17:38:38Z"
        }
      ]
    },
    {
      "number": 33779,
      "title": "ci, iwyu: Fix warnings in `src/kernel` and treat them as errors",
      "body": "Now seems like a good time to update the includes in `src/kernel`.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-11-04T17:03:05Z",
      "updated_at": "2026-01-15T16:47:03Z",
      "comments": 24,
      "url": "https://github.com/bitcoin/bitcoin/pull/33779",
      "labels": [
        "Refactoring"
      ]
    },
    {
      "number": 33778,
      "title": "depends: add zeromq patch to fix mingw CMake file install location",
      "body": "Currently the zeromq CMake files for mingw are installed to `x86_64-w64-mingw32/CMake`, when they should be in `x86_64-w64-mingw32/lib/cmake`, so take the patch from upstream that puts them in the right place. Noticed this while looking at other depends changes, that might cleanup / remove dirs.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-11-04T16:37:18Z",
      "updated_at": "2025-11-07T12:49:30Z",
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/pull/33778",
      "labels": [
        "Build system"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33778.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [hebasto](https://github.com/bitcoin/bitcoin/pull/33778#issuecomment-3486967777) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-11-04T16:37:24Z"
        },
        {
          "user": "hebasto",
          "body": "The current path is valid per the CMake [docs](https://cmake.org/cmake/help/latest/command/find_package.html#config-mode-search-procedure).\r\n\r\nUPD. ... on Windows, but not when cross-compiling.",
          "created_at": "2025-11-04T16:41:52Z"
        },
        {
          "user": "hebasto",
          "body": "Concept ACK.",
          "created_at": "2025-11-04T16:44:05Z"
        },
        {
          "user": "fanquake",
          "body": "> The current path is valid per the CMake [docs](https://cmake.org/cmake/help/latest/command/find_package.html#config-mode-search-procedure).\r\n\r\nCould you clarify. Reading those docs, `<prefix>/(cmake|CMake)/` is only valid on Windows installation trees. Not Unix, which is what is being changed here?",
          "created_at": "2025-11-04T16:44:20Z"
        },
        {
          "user": "hebasto",
          "body": "> > The current path is valid per the CMake [docs](https://cmake.org/cmake/help/latest/command/find_package.html#config-mode-search-procedure).\r\n> \r\n> Could you clarify. Reading those docs, `<prefix>/(cmake|CMake)/` is only valid on Windows installation trees. Not Unix, which is what is being changed here?\r\n\r\nYou're right. Already updated my comment.",
          "created_at": "2025-11-04T16:45:05Z"
        },
        {
          "user": "hebasto",
          "body": "> The current path is valid per the CMake [docs](https://cmake.org/cmake/help/latest/command/find_package.html#config-mode-search-procedure).\r\n> \r\n> UPD. ... on Windows, but not when cross-compiling.\r\n\r\nOn the master branch, `find_package(ZeroMQ)` succeeds when cross-compiling for Windows. Here is an excerpt from the build log in debug mode:\r\n```\r\n  Prepending the following roots to each prefix:\r\n\r\n  CMAKE_FIND_ROOT_PATH\r\n\r\n    /home/hebasto/dev/bitcoin/depends/x86_64-w64-mingw32\r\n\r\n  CMAKE_SYSROOT_COMPILE\r\n\r\n    none\r\n\r\n  CMAKE_SYSROOT_LINK\r\n\r\n    none\r\n\r\n  CMAKE_SYSROOT\r\n\r\n    none\r\n\r\n  find_package considered the following locations for ZeroMQ's Config module:\r\n\r\n    /home/hebasto/dev/bitcoin/depends/x86_64-w64-mingw32/ZeroMQConfig.cmake\r\n    /home/hebasto/dev/bitcoin/depends/x86_64-w64-mingw32/zeromq-config.cmake\r\n    /home/hebasto/dev/bitcoin/depends/x86_64-w64-mingw32/CMake/ZeroMQConfig.cmake\r\n\r\n  The file was found at\r\n\r\n    /home/hebasto/dev/bitcoin/depends/x86_64-w64-mingw32/CMake/ZeroMQConfig.cmake\r\n```\r\n\r\n@purpleKarrot \r\n\r\nCould you please clarify (1) whether this CMake behaviour is expected and (2) whether the current path is valid? ",
          "created_at": "2025-11-04T17:28:03Z"
        },
        {
          "user": "purpleKarrot",
          "body": "> The current path is valid per the CMake [docs](https://cmake.org/cmake/help/latest/command/find_package.html#config-mode-search-procedure).\r\n> \r\n> UPD. ... on Windows, but not when cross-compiling.\r\n\r\nWhen taking cross-compiling into account, there are not two, but three scenarios how mingw can be used:\r\n\r\n1. Building on Windows\r\n2. Building on Linux, but packaging for Windows\r\n3. Building on and packaging for Linux\r\n\r\nCMake searches for packages in different paths depending on the **build host platform**. The variable `WIN32` describes the **build target platform**. It is not possible to deduce the **packaging target platform** from either the **build host platform** nor the **build target platform**.\r\n\r\nWithout the patch, scenarios 1+2 are supported by default. With the patch, that was also applied upstream (https://github.com/zeromq/libzmq/commit/7a7bfa10e6b0e99210ed9397369b59f9e69cef8e), scenarios 1+3 are supported by default. Whether 1+3 are actually more appropriate as a default than 1+2 is debatable. I would have rejected that change upstream.\r\n\r\nBut whatever the default, the packager can override it by setting `ZEROMQ_CMAKECONFIG_INSTALL_DIR` explicitly, so all three scenarios are actually supported both with and without the patch.\r\n\r\nThis is also the simplest approach for us. Instead of adding a patch, set `ZEROMQ_CMAKECONFIG_INSTALL_DIR`:\r\n\r\n```diff\r\n define $(package)_config_cmds\r\n-   $($(package)_cmake) -S .. -B .\r\n+   $($(package)_cmake) -S .. -B . -DZEROMQ_CMAKECONFIG_INSTALL_DIR:STRING=share/ZeroMQ\r\n endef\r\n```",
          "created_at": "2025-11-05T07:53:41Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--9cd9c72976c961c55c7acef8f6ba82cd-->\n### Guix builds (on x86_64) [untrusted test-only build, possibly unsafe, not for production use]\n\n| File | commit 4da01123df0f4cb7e05c09dbb1c6b00c064beabe<br>(master) | commit c6f096fcf20ca89c3b7852a7c6be921981baf952<br>(pull/33778/merge) |\n|--|--|--|\n| *-aarch64-linux-gnu-debug.tar.gz | [`ee972fe244c38c98...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-aarch64-linux-gnu-debug.tar.gz) | [`7461246157a05636...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-aarch64-linux-gnu-debug.tar.gz) |\n| *-aarch64-linux-gnu.tar.gz | [`d28c77533d1ccef4...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-aarch64-linux-gnu.tar.gz) | [`d4348f1c0cb9cdbc...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-aarch64-linux-gnu.tar.gz) |\n| *-arm-linux-gnueabihf-debug.tar.gz | [`9e55fb6210b1381f...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-arm-linux-gnueabihf-debug.tar.gz) | [`a53ca3c6e41e9c3d...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-arm-linux-gnueabihf-debug.tar.gz) |\n| *-arm-linux-gnueabihf.tar.gz | [`567697c14fb23926...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-arm-linux-gnueabihf.tar.gz) | [`5ea59cee62af97ca...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-arm-linux-gnueabihf.tar.gz) |\n| *-arm64-apple-darwin-codesigning.tar.gz | [`98378959d7917f66...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-arm64-apple-darwin-codesigning.tar.gz) | [`d6564539ca02e1a4...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-arm64-apple-darwin-codesigning.tar.gz) |\n| *-arm64-apple-darwin-unsigned.tar.gz | [`1189aac2d7dc5fae...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-arm64-apple-darwin-unsigned.tar.gz) | [`c0e3681648171075...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-arm64-apple-darwin-unsigned.tar.gz) |\n| *-arm64-apple-darwin-unsigned.zip | [`e4b97135b032ff19...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-arm64-apple-darwin-unsigned.zip) | [`f257b5b1794737c3...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-arm64-apple-darwin-unsigned.zip) |\n| *-powerpc64-linux-gnu-debug.tar.gz | [`03f31561c86cf173...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-powerpc64-linux-gnu-debug.tar.gz) | [`36e2326288cd8ada...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-powerpc64-linux-gnu-debug.tar.gz) |\n| *-powerpc64-linux-gnu.tar.gz | [`1bbb06d66658b5d6...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-powerpc64-linux-gnu.tar.gz) | [`b6c0acb2c983a455...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-powerpc64-linux-gnu.tar.gz) |\n| *-riscv64-linux-gnu-debug.tar.gz | [`8767a68da6c38872...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-riscv64-linux-gnu-debug.tar.gz) | [`f3e91684fa7f0e0f...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-riscv64-linux-gnu-debug.tar.gz) |\n| *-riscv64-linux-gnu.tar.gz | [`28ca5999fd903809...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-riscv64-linux-gnu.tar.gz) | [`5ae5c0137995377a...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-riscv64-linux-gnu.tar.gz) |\n| *-x86_64-apple-darwin-codesigning.tar.gz | [`18cd53f4bcb9534f...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-x86_64-apple-darwin-codesigning.tar.gz) | [`3af85d8ba53af109...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-x86_64-apple-darwin-codesigning.tar.gz) |\n| *-x86_64-apple-darwin-unsigned.tar.gz | [`bf8739c16edba9ad...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-x86_64-apple-darwin-unsigned.tar.gz) | [`b573417245c32352...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-x86_64-apple-darwin-unsigned.tar.gz) |\n| *-x86_64-apple-darwin-unsigned.zip | [`4420310fe732a6d1...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-x86_64-apple-darwin-unsigned.zip) | [`22aa5b8365ea2ed8...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-x86_64-apple-darwin-unsigned.zip) |\n| *-x86_64-linux-gnu-debug.tar.gz | [`2928d6c0642cf414...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-x86_64-linux-gnu-debug.tar.gz) | [`5e0584cb87627277...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-x86_64-linux-gnu-debug.tar.gz) |\n| *-x86_64-linux-gnu.tar.gz | [`6e2d4edc0f83d4f3...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f-x86_64-linux-gnu.tar.gz) | [`2bac62f9cc385a9f...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c-x86_64-linux-gnu.tar.gz) |\n| *.tar.gz | [`118f9572221e79e7...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/bitcoin-4da01123df0f.tar.gz) | [`033007a21b6d326d...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/bitcoin-c6f096fcf20c.tar.gz) |\n| SHA256SUMS.part | [`4463c90fb921c935...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/SHA256SUMS.part) | [`be93b458ccfa6b22...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/SHA256SUMS.part) |\n| guix_build.log | [`84c6b7bbc6c58279...`](https://drahtbot.space/guix/monotree/4da01123df0f4cb7e05c09dbb1c6b00c064beabe/guix_build.log) | [`d2f1e86b788dd5ec...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/guix_build.log) |\n| guix_build.log.diff |  | [`a85021af68853b01...`](https://drahtbot.space/guix/monotree/c6f096fcf20ca89c3b7852a7c6be921981baf952/guix_build.log.diff) |\n\n",
          "created_at": "2025-11-05T11:31:57Z"
        },
        {
          "user": "fanquake",
          "body": "I wont bother changing this for now (also don't want to add to /share given that bundles content we are currently pruning). Maybe we can also convince upstream to rechange their approach.",
          "created_at": "2025-11-07T12:49:27Z"
        }
      ]
    },
    {
      "number": 33776,
      "title": "ci: Lint follow-ups",
      "body": "This contains a few follow-ups to https://github.com/bitcoin/bitcoin/pull/33744:\r\n\r\n* Rewrite the actions Bash snippet to Python. I've confirmed it still works in https://github.com/maflcko/bitcoin-core-with-ci/actions/runs/19067932430 (scroll down).\r\n* Add a lint-build retry to avoid issues such as https://github.com/bitcoin/bitcoin/issues/33640 for the lint task as well.\r\n* Finally, run the `debug_pull_request_number_str` annotation on all checks, to ensure they are present even when GitHub deletes annotations on a re-run. For example, the initial attempt https://github.com/bitcoin/bitcoin/actions/runs/19041534107/attempts/1?pr=33772 has the annotations, and the lint re-run has them removed: https://github.com/bitcoin/bitcoin/actions/runs/19041534107?pr=33772",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-11-04T13:30:36Z",
      "updated_at": "2025-11-17T13:05:20Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/33776",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33776.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [m3dwards](https://github.com/bitcoin/bitcoin/pull/33776#issuecomment-3528462663), [willcl-ark](https://github.com/bitcoin/bitcoin/pull/33776#pullrequestreview-3472377000) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-11-04T13:30:42Z"
        },
        {
          "user": "fanquake",
          "body": "cc @willcl-ark @m3dwards ",
          "created_at": "2025-11-04T13:57:04Z"
        },
        {
          "user": "m3dwards",
          "body": "The GHA behaviour of removing annotations from previous runs is very annoying! I experimented with having an upstream job that printed the annotation and having all the other jobs depend on it but again when you rerun a failed downstream job you lose the annotation from the run upstream job.\r\n\r\nIt's a shame that in this PR we have to have the annotation printed many times, one per job, as I think it might drown out other notices. Without knowing exactly how this machine readable annotation is being consumed or experimenting more, I'm not aware of an alternative? I considered storing it as an artefact and having each job check the artefact but I don't think that works and is also ugly.  Third thing I briefly considered is if the PR number could be output as it's own check run somehow? Probably best to just leave it as it is here!",
          "created_at": "2025-11-13T09:54:07Z"
        },
        {
          "user": "maflcko",
          "body": "> It's a shame that in this PR we have to have the annotation printed many times, one per job, as I think it might drown out other notices.\r\n\r\nAgree, but I think we can use warning notices to bubble up more important ones.\r\n\r\n\r\n\r\n> Without knowing exactly how this machine readable annotation is being consumed or experimenting more, I'm not aware of an alternative?\r\n\r\nIt can be used via the API, e.g. https://github.com/maflcko/DrahtBot/blob/6c91378116516ca5974d78a4e0c5c495b38acf95/webhook_features/src/features/ci_status.rs#L84-L106\r\n\r\nI've tried other things, such as task summaries (https://github.com/maflcko/DrahtBot/actions/runs/19115117072?pr=61#summary-54622116294) However, they are not really documented and can't be retrieved via the API, IIRC.\r\n\r\n\r\n> Third thing I briefly considered is if the PR number could be output as it's own check run somehow? Probably best to just leave it as it is here!\r\n\r\nIn theory we could hook up Cirrus again (or our own CI \"dummy\" provider), just to have a single task run via it, to annotate it with the pull number, but this seems more fragile.\r\n\r\n> Missing import time? ...\r\n\r\nThx, fixed both. I guess this is the common reminder that a yaml string is the wrong place to put code. All ci code, even snippets, should be in a native file.",
          "created_at": "2025-11-13T10:52:25Z"
        },
        {
          "user": "m3dwards",
          "body": "Looks good!\r\n\r\nACK fae3618fd6c82dfcea2f296caa16a79182b32059",
          "created_at": "2025-11-13T15:52:50Z"
        }
      ]
    },
    {
      "number": 33775,
      "title": "guix: use GCC 14.3.0 over 13.3.0",
      "body": "Switching to using GCC 14.x for release builds has come up multiple times recently. It will eventually be needed for #25573, and could also be useful for #30210.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-11-04T13:12:58Z",
      "updated_at": "2026-01-14T08:51:18Z",
      "comments": 38,
      "url": "https://github.com/bitcoin/bitcoin/pull/33775",
      "labels": [
        "Build system"
      ]
    },
    {
      "number": 33774,
      "title": "cmake: Move IPC tests to `ipc/test`",
      "body": "This PR follows up on https://github.com/bitcoin/bitcoin/pull/33445 and:\r\n1. Organizes the IPC tests in the same way as the wallet tests.\r\n2. Removes no longer needed `src/test/.clang-tidy.in`.\r\n\r\nSee the previous discussion:\r\n- https://github.com/bitcoin/bitcoin/pull/33445#discussion_r2379651340\r\n- https://github.com/bitcoin/bitcoin/pull/33445#pullrequestreview-3411868329\r\n\r\nAdditionally, the locality of the `bitcoin_ipc_test` build target description has been improved.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-11-04T13:10:04Z",
      "updated_at": "2025-12-22T17:45:30Z",
      "comments": 20,
      "url": "https://github.com/bitcoin/bitcoin/pull/33774",
      "labels": [
        "Build system",
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33774.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [Sjors](https://github.com/bitcoin/bitcoin/pull/33774#issuecomment-3520877571), [janb84](https://github.com/bitcoin/bitcoin/pull/33774#pullrequestreview-3454452001), [ryanofsky](https://github.com/bitcoin/bitcoin/pull/33774#pullrequestreview-3461148887) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29409](https://github.com/bitcoin/bitcoin/pull/29409) (multiprocess: Add capnp wrapper for Chain interface by ryanofsky)\n* [#19461](https://github.com/bitcoin/bitcoin/pull/19461) (multiprocess: Add bitcoin-gui -ipcconnect option by ryanofsky)\n* [#19460](https://github.com/bitcoin/bitcoin/pull/19460) (multiprocess: Add bitcoin-wallet -ipcconnect option by ryanofsky)\n* [#10102](https://github.com/bitcoin/bitcoin/pull/10102) (Multiprocess bitcoin by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-11-04T13:10:09Z"
        },
        {
          "user": "hebasto",
          "body": "cc @ryanofsky ",
          "created_at": "2025-11-04T13:10:18Z"
        },
        {
          "user": "hebasto",
          "body": "I added a commit with further improvements.",
          "created_at": "2025-11-04T13:56:28Z"
        },
        {
          "user": "janb84",
          "body": "should `src/test/kernel` also be moved to `src/kernel/test` to keep the project structure Consistent. ?  ",
          "created_at": "2025-11-05T09:38:25Z"
        },
        {
          "user": "hebasto",
          "body": "> should `src/test/kernel` also be moved to `src/kernel/test` to keep the project structure Consistent. ?\r\n\r\nMaybe.\r\n\r\nMoving IPC tests provides additional benefits. I'm not sure the same justification applies to the kernel tests, so let's leave them for a follow-up.",
          "created_at": "2025-11-05T10:13:08Z"
        },
        {
          "user": "hebasto",
          "body": "The [feedback](https://github.com/bitcoin/bitcoin/pull/33774#discussion_r2494445665) from @ryanofsky has been addressed.\r\n\r\nAdditionally, `PROJECT_SOURCE_DIR` were replaced with `CMAKE_CURRENT_SOURCE_DIR`.",
          "created_at": "2025-11-05T21:44:03Z"
        },
        {
          "user": "Sjors",
          "body": "ACK 866bbb98fd365962840ee99df0d9f7ad557cc025\r\n\r\nOn macOS 26.0.1 I ran the full test suite with `-DENABLE_IPC` set to `OFF` and `ON`.",
          "created_at": "2025-11-12T09:13:17Z"
        },
        {
          "user": "hebasto",
          "body": "@ryanofsky\r\n\r\nWould you like to take another look at this PR?",
          "created_at": "2025-11-12T17:51:05Z"
        },
        {
          "user": "hebasto",
          "body": "Going to merge this. Leaving the following for follow-ups:\r\n\r\n> The last path in that list pointing at the build root should not be there I think, and the bad `target_capnp_sources` calls fixed here were relying on it to work. It would be nice to remove if we can find the source.",
          "created_at": "2025-12-04T13:50:49Z"
        },
        {
          "user": "ajtowns",
          "body": "This broke compilation for me:\r\n\r\n```\r\n$ git checkout 866bbb98fd365962840ee99df0d9f7ad557cc025\r\n$ cmake --build ../build-rel -j 40 -t bitcoin_ipc_test\r\n[  0%] Built target mputil\r\n[ 50%] Built target mpgen\r\n[ 50%] Built target multiprocess\r\n[ 50%] Built target bitcoin_ipc_headers\r\n[ 50%] Building CXX object src/ipc/CMakeFiles/bitcoin_ipc_test.dir/test/ipc_test.cpp.o\r\n[ 50%] Building CXX object src/ipc/CMakeFiles/bitcoin_ipc_test.dir/test/ipc_test.capnp.proxy-client.c++.o\r\n[ 50%] Building CXX object src/ipc/CMakeFiles/bitcoin_ipc_test.dir/test/ipc_test.capnp.proxy-types.c++.o\r\n[100%] Building CXX object src/ipc/CMakeFiles/bitcoin_ipc_test.dir/test/ipc_test.capnp.proxy-server.c++.o\r\nIn file included from build-rel/src/ipc/test/ipc_test.capnp.proxy-types.c++:5:\r\nbuild-rel/src/test/ipc_test.capnp.proxy.h:6:10: fatal error: src/test/ipc_test.capnp.h: No such file or directory\r\n    6 | #include <src/test/ipc_test.capnp.h> // IWYU pragma: keep\r\n      |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~\r\ncompilation terminated.\r\ngmake[3]: *** [src/ipc/CMakeFiles/bitcoin_ipc_test.dir/build.make:157: src/ipc/CMakeFiles/bitcoin_ipc_test.dir/test/ipc_test.capnp.proxy-types.c++.o] Error 1\r\ngmake[3]: *** Waiting for unfinished jobs....\r\nIn file included from build-rel/src/ipc/test/ipc_test.capnp.proxy-server.c++:6:\r\nbuild-rel/src/test/ipc_test.capnp.proxy.h:6:10: fatal error: src/test/ipc_test.capnp.h: No such file or directory\r\n    6 | #include <src/test/ipc_test.capnp.h> // IWYU pragma: keep\r\n      |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~\r\ncompilation terminated.\r\n```\r\n\r\nThe parent commit still compiles. Turning ENABLE_IPC off also compiles. Turning ENABLE_IPC back on fails again. Manually removing all the generated `*ipc_test.capnp*` seems to make it work at least.",
          "created_at": "2025-12-20T02:48:30Z"
        },
        {
          "user": "hebasto",
          "body": "> This broke compilation for me:\r\n> \r\n> ```\r\n> $ git checkout 866bbb98fd365962840ee99df0d9f7ad557cc025\r\n> $ cmake --build ../build-rel -j 40 -t bitcoin_ipc_test\r\n> ...\r\n> ```\r\n\r\nBuilding in a clean build directory should help.",
          "created_at": "2025-12-20T09:47:10Z"
        },
        {
          "user": "ajtowns",
          "body": "> Building in a clean build directory should help.\r\n\r\nHuh? The point of dependency based build systems is that you shouldn't need to do that; and when it breaks, it's an indication that some dependency is missing...",
          "created_at": "2025-12-21T03:05:45Z"
        },
        {
          "user": "hebasto",
          "body": "> > Building in a clean build directory should help.\r\n> \r\n> Huh? The point of dependency based build systems is that you shouldn't need to do that; and when it breaks, it's an indication that some dependency is missing...\r\n\r\n~The build system creates all artifacts within the build subdirectory (aka the build tree), including files generated by the libmultiprocess `mpgen` tool from `*.capnp` files.~\r\n\r\n~This change modifies both the content and the relative paths of those generated files. The compilation error you encountered clearly shows that it is caused by stale versions of `ipc_test.capnp.proxy-types.c++` and `ipc_test.capnp.proxy-server.c++` remaining in the build tree. Removing these files is therefore required for a successful build of this PR. I don't see how this constitutes \"an indication that some dependency is missing\".~",
          "created_at": "2025-12-21T11:23:08Z"
        },
        {
          "user": "hebasto",
          "body": "@ajtowns \r\n\r\nPlease disregard my previous comment.\r\n\r\nAre you using the \"Ninja\" CMake generator?",
          "created_at": "2025-12-21T12:21:40Z"
        },
        {
          "user": "ajtowns",
          "body": "Nope, just using defaults, and cmake is just running `gmake -f Makefile`.\r\n\r\nTrying it with ninja gives the same result -- fresh build dir, build ae2e438b257f2b5322080087ed7dc8843d4f9cca works fine; checkout 866bbb98fd365962840ee99df0d9f7ad557cc025 (without cleaning the build dir), build fails, run `rm $(find ../build-rel/ | grep ipc_test.capn)`, build succeeds.",
          "created_at": "2025-12-21T13:44:05Z"
        },
        {
          "user": "hebasto",
          "body": "@ajtowns \r\n\r\n> This broke compilation for me...\r\n\r\nThe change responsible for this behaviour is the switch from `PROJECT_SOURCE_DIR` to `CMAKE_CURRENT_SOURCE_DIR` in the `include_prefix` argument discussed by @ryanofsky in https://github.com/bitcoin/bitcoin/pull/33774#discussion_r2524524789.\r\n\r\nI'm not sure how to handle such a change as a \"dependency\" that triggers re-build.",
          "created_at": "2025-12-21T14:20:09Z"
        },
        {
          "user": "hebasto",
          "body": "> @ajtowns\r\n> \r\n> > This broke compilation for me...\r\n> \r\n> The change responsible for this behaviour is the switch from `PROJECT_SOURCE_DIR` to `CMAKE_CURRENT_SOURCE_DIR` in the `include_prefix` argument discussed by @ryanofsky in [#33774 (comment)](https://github.com/bitcoin/bitcoin/pull/33774#discussion_r2524524789).\r\n> \r\n> I'm not sure how to handle such a change as a \"dependency\" that triggers re-build.\r\n\r\nThe following diff should handle such behaviour:\r\n```diff\r\n--- a/src/ipc/libmultiprocess/cmake/TargetCapnpSources.cmake\r\n+++ b/src/ipc/libmultiprocess/cmake/TargetCapnpSources.cmake\r\n@@ -78,7 +78,7 @@ function(target_capnp_sources target include_prefix)\r\n     add_custom_command(\r\n       OUTPUT ${capnp_file}.c++ ${capnp_file}.h ${capnp_file}.proxy-client.c++ ${capnp_file}.proxy-types.h ${capnp_file}.proxy-server.c++ ${capnp_file}.proxy-types.c++ ${capnp_file}.proxy.h\r\n       COMMAND ${MPGEN_BINARY} ${CMAKE_CURRENT_SOURCE_DIR} ${include_prefix} ${CMAKE_CURRENT_SOURCE_DIR}/${capnp_file} ${TCS_IMPORT_PATHS} ${mp_include_dir}\r\n-      DEPENDS ${capnp_file}\r\n+      DEPENDS ${capnp_file} ${CMAKE_CURRENT_FUNCTION_LIST_FILE}\r\n       VERBATIM\r\n     )\r\n     # Skip linting for capnp-generated files but keep it for mpgen-generated ones\r\n```\r\n\r\nObviously, it's not an optimal solution.",
          "created_at": "2025-12-21T14:47:24Z"
        },
        {
          "user": "hebasto",
          "body": "> @ajtowns\r\n> \r\n> > This broke compilation for me...\r\n> \r\n> The change responsible for this behaviour is the switch from `PROJECT_SOURCE_DIR` to `CMAKE_CURRENT_SOURCE_DIR` in the `include_prefix` argument discussed by @ryanofsky in [#33774 (comment)](https://github.com/bitcoin/bitcoin/pull/33774#discussion_r2524524789).\r\n\r\nDoes [this](https://github.com/hebasto/bitcoin/commits/251221-pr33774/) branch work for you?",
          "created_at": "2025-12-21T17:19:46Z"
        },
        {
          "user": "ajtowns",
          "body": "Yeah, I think so; took it as this diff on top of this PR's tip commit. CURRENT_SOURCE_DIR would be src/ipc in this context, wouldn't it?\r\n\r\n```diff\r\n--- a/src/ipc/CMakeLists.txt\r\n+++ b/src/ipc/CMakeLists.txt\r\n@@ -9,7 +9,7 @@ add_library(bitcoin_ipc STATIC EXCLUDE_FROM_ALL\r\n   process.cpp\r\n )\r\n\r\n-target_capnp_sources(bitcoin_ipc ${CMAKE_CURRENT_SOURCE_DIR}\r\n+target_capnp_sources(bitcoin_ipc ${PROJECT_SOURCE_DIR}/src\r\n   capnp/common.capnp\r\n   capnp/echo.capnp\r\n   capnp/init.capnp\r\n@@ -32,7 +32,7 @@ if(BUILD_TESTS)\r\n   add_library(bitcoin_ipc_test STATIC EXCLUDE_FROM_ALL\r\n     test/ipc_test.cpp\r\n   )\r\n-  target_capnp_sources(bitcoin_ipc_test ${CMAKE_CURRENT_SOURCE_DIR}\r\n+  target_capnp_sources(bitcoin_ipc_test ${PROJECT_SOURCE_DIR}/src\r\n     test/ipc_test.capnp\r\n   )\r\n   add_dependencies(bitcoin_ipc_test bitcoin_ipc_headers)\r\n```",
          "created_at": "2025-12-22T03:49:25Z"
        },
        {
          "user": "hebasto",
          "body": "> CURRENT_SOURCE_DIR would be src/ipc in this context, wouldn't it?\r\n\r\nYes, being presented as an absolute path. ",
          "created_at": "2025-12-22T17:45:30Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 33777,
      "title": "Mining interface tracking issue",
      "body": "The mining interface is defined in:\n- https://github.com/bitcoin/bitcoin/blob/master/src/interfaces/mining.h\n- https://github.com/bitcoin/bitcoin/blob/master/src/ipc/capnp/mining.capnp\n\nClients that are known to depend on it:\n- https://github.com/stratum-mining/sv2-tp\n- https://github.com/stratum-mining/sv2-apps/tree/main/bitcoin-core-sv2\n\nThe changes below are not breaking, unless mentioned otherwise. Adding new methods or new arguments to existing methods is not a breaking change.\n\n- [ ] #33965 \n  - [ ] #33966\n- [ ] #34184\n- [x] #33819\n- [ ] #32420 \n- [ ] #34020\n- [ ] #33899\n  - [ ] #33922\n- [ ] #33756 \n\nAt this state it's OK to make breaking changes, such as deleting a method or changing its signature. But ideally we should do so once in a major release, collecting a bunch of fixes.\n\n- [ ] low priority breaking change(s): https://github.com/Sjors/bitcoin/pull/106\n  - [ ] #33936\n  - [ ] make non-mandatory coinbase commitment opt-in \n  - [ ] drop `getCoinbaseCommitment()`, `getCoinbaseTx()` and `getWitnessCommitmentIndex()`\n  - [ ] wipe dummy coinbase\n\nMisc related:\n\n- [ ] #30437",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-04T15:05:33Z",
      "updated_at": "2026-01-14T16:55:09Z",
      "comments": 13,
      "url": "https://github.com/bitcoin/bitcoin/issues/33777",
      "labels": [
        "Mining",
        "interfaces",
        "Tracking Issue"
      ],
      "comment_list": [
        {
          "user": "Sjors",
          "body": "@ismaelsadeeq I'm thinking about deprecating `getBlock()` in favour of a new `getTransactions()` on `BlockTemplate`. That would allow us to avoid shoehorning block templates into a `CBlock`, which e.g. means we no longer need a dummy coinbase transaction.",
          "created_at": "2025-11-07T14:40:04Z"
        },
        {
          "user": "ismaelsadeeq",
          "body": "Why is this important?\nJust because of shorhorning is not convincing imo, copying the txs is the most work which has to be done and then copy the header again.\nPreviously, they could access it with a single call, but after what you propose it will requires two calls.\nAnother downside is that they now have to calculate the block subsidy themselves, whereas previously it was included in the vout value of the first output of the coinbase tx.\n",
          "created_at": "2025-11-07T15:22:03Z"
        },
        {
          "user": "Sjors",
          "body": "> Previously, they could access it with a single call, but after what you propose it will requires two calls.\n\nClients are already expected to call `getHeader()` to get the header. Combined with `getCoinbaseMerklePath()` and `getCoinbase()` they can construct a template without having to download the full block.\n\nIn Stratum v2 clients only call `getBlock()` if the pool wants to inspect their proposed template (see `RequestTransactionData.Success` in sv2-tp). This happens later and currently involves dropping the coinbase from `vtx`.\n\n> Another downside is that they now have to calculate the block subsidy themselves\n\nThe `CoinbaseTemplate` struct proposed in #33819 provides the amount.\n\n> Why is this important?\n\nCurrently it's not, but it does seem better in the long run to only serve clients data they need and not expose implementation details like our dummy coinbase.\n\nI was wondering if it makes #33421 easier, because templates for different sizes could just be spans over the transaction list.\n\nI can also think of a downside: `submitBlock()` currently relies on a ready-to-go `CBlock`.\n\n---\n\nUpdate: `getBlock()` is also used by clients to download a backup / copy of the submitted block, so I decided to just keep it.",
          "created_at": "2025-11-07T15:43:51Z"
        },
        {
          "user": "Sjors",
          "body": "See inline discussion in https://github.com/bitcoin/bitcoin/pull/33819#discussion_r2504009667 about whether we should just go ahead and make breaking changes now, or pile them up until there's a bigger / more important breaking change.\n\nA similar discussion occurred on IRC a few days ago: https://www.erisian.com.au/bitcoin-core-dev/log-2025-11-04.html#l-186",
          "created_at": "2025-11-07T15:54:50Z"
        },
        {
          "user": "ryanofsky",
          "body": "Was looking at the IRC discussion and I think a nuance it doesn't address is that there is a difference between breaking compatibility explicitly so clients see an error if they try to call a method that's been changed or removed, and breaking compatibility silently so if a client tries to call a method that's changed or removed, a different method may be called instead or arguments may be interpreted incorrectly.\n\n#### How to break compatibility explicitly\n\nYou can break compatibility explicitly when you follow the rules at https://capnproto.org/language.html#evolving-your-protocol and avoid doing this things like changing field numbers, or break compatibility silently by ignoring these rules. A way to break compatibility explicitly is to bump the field number of a changed method like:\n\n<details><summary>diff</summary>\n<p>\n\n```diff\n--- a/src/ipc/capnp/init.capnp\n+++ b/src/ipc/capnp/init.capnp\n@@ -19,5 +19,8 @@ using Mining = import \"mining.capnp\";\n interface Init $Proxy.wrap(\"interfaces::Init\") {\n     construct @0 (threadMap: Proxy.ThreadMap) -> (threadMap :Proxy.ThreadMap);\n     makeEcho @1 (context :Proxy.Context) -> (result :Echo.Echo);\n-    makeMining @2 (context :Proxy.Context) -> (result :Mining.Mining);\n+    makeMining @3 (context :Proxy.Context) -> (result :Mining.Mining);\n+\n+    # DEPRECATED: no longer supported; server returns an error.\n+    makeMiningV2 @2 () -> ();\n }\n--- a/src/interfaces/init.h\n+++ b/src/interfaces/init.h\n@@ -39,6 +39,7 @@ public:\n     virtual Ipc* ipc() { return nullptr; }\n     virtual bool canListenIpc() { return false; }\n     virtual const char* exeName() { return nullptr; }\n+    virtual void makeMiningV2() { throw std::runtime_error(\"Old mining interface (@2) not supported. Please update your client!\"); }\n };\n \n //! Return implementation of Init interface for the node process. If the argv\n```\n\n</p>\n</details>\n\nThis is actually more complicated than I expected because I forgot capnproto forbids gaps between ordinal numbers, and thought that it would automatically generate errors if a method with a missing ordinal was called. This could be simplified a little with a helper annotation like:\n\n```capnp\nmakeMiningV2 @2 () -> () $Proxy.Error(\"Old mining interface (@2) not supported. Please update your client!\");\n```\n\nso no c++ changes would be required.\n\n#### Breaking compatibility in master\n\nIMO, for interfaces like `Chain` (#29409) which are not intended to be called externally it should be ok to break compatibility silently not explicitly in master, and ignore schema evolution rules. But for the mining interface I think it'd be better only break compatibility explicitly even in master to avoid debugging headaches and make errors obvious when older clients are used.\n\nAlso in many cases, like when adding new methods or new parameters with default values, it could be easy to avoid breaking compatibility at all.\n\n#### Source vs binary compatibility\n\nEverything above refers to binary compatibility not source compatibility. It's possible to break source compatibility without breaking binary compatibility by doing things like renaming fields or methods without changing their ordinal numbers and types. Source compatibility should generally be less of a concern since it should result in compile-time errors not runtime errors.",
          "created_at": "2025-11-13T17:48:54Z"
        },
        {
          "user": "ryanofsky",
          "body": "re: https://github.com/bitcoin/bitcoin/issues/33777#issuecomment-3502947184\n\n> That would allow us to avoid shoehorning block templates into a `CBlock`, which e.g. means we no longer need a dummy coinbase transaction.\n\nIt does seem error-prone to expose the dummy coinbase transaction, because if any clients are relying on it and we make internal changes, they could easily break.\n\nAt some point after getCoinbase() is introduced in #33819, it could make sense to swap `m_block_template->block.vtx[0]` with an empty transaction in the `BlockTemplateImpl` constructor so clients will not rely on it and will switch to using `getCoinbase()` instead",
          "created_at": "2025-11-13T18:08:29Z"
        },
        {
          "user": "ryanofsky",
          "body": "@Sjors I'm wondering which mining PRs & issues to focus on since there seem to be a lot open now. Feel free to tag me on any or mention any priorities here. I noticed there seemed to be a lot of these while updating the multiprocess tracking issue #28722 yesterday.\n\nI was also wondering if there are bitcoin or libmultiprocess features I should start working on. Ones I was thinking of were:\n\n- Adding exception types that could be thrown from IPC methods to return capnp [failed / overloaded / unimplemented](https://github.com/capnproto/capnproto/blob/9805af1c367c40d864695a2073e1f9cd8ee3907b/c%2B%2B/src/capnp/rpc.capnp#L1198-L1246) errors to clients.\n- Adding `$Unimplemented` or `$Error` method annotations that could be used in `.capnp` files to make it easier to remove old methods without needing c++ code (mentioned https://github.com/bitcoin/bitcoin/issues/33777#issuecomment-3528997008).\n- Adding an `interfaces::Cancel` c++ parameter that IPC methods could check and register callbacks with to know if the IPC client cancelled the call or disconnected (mentioned #33575).\n\nOther things I was thinking of doing: \n\n- Backporting #33676 \n- Adding a `doc/IPC-interface.md` file similar to `JSON-RPC-interface.md` and `REST-interface.md` files to document things that plebhash has asked about like how to use server threads and `Context` objects and `destroy` methods.",
          "created_at": "2025-11-25T12:31:58Z"
        },
        {
          "user": "Sjors",
          "body": "In terms of interface changes I'd like to focus on #33819 `getCoinbase()`  and #33922 `getMemoryLoad()` which add new functionality. The smaller breaking interface changes can wait until either we have a bigger breaking change or nothing else on our plate.\n\nOn the IPC side I don't really have priorities in mind, so maybe pick what's useful for @plebhash (as a stand-in for others who are both unfamiliar with the Bitcoin Core codebase and using other programming languages to connect).\n\nDocumentation sounds like a very good idea. Another thing that would be useful is if we can automatically bubble up code comments from header files to the capnp definitions. Maybe a little Python script? It shouldn't be (or at least doesn't need to) adding methods and changing signatures, but it could find and update matching documentation. ",
          "created_at": "2025-11-25T14:05:33Z"
        },
        {
          "user": "plebhash",
          "body": "we're doing a SRI release this week that is planned to include https://github.com/stratum-mining/sv2-apps/pull/59, and it's meant to support v30\n\nbut it will come with two major limitations, namely:\n- the initial iteration of `bitcoin_core_sv2` crate is marked with a bunch of `todo`s that are workarounds for the lack of `interruptWait`, and are being tracked at https://github.com/stratum-mining/sv2-apps/issues/81\n- running it on systems with low RAM for extended periods of time can lead to crashes\n\nwe're going to proceed with the release anyways, while making these points clear on the release notes\n\n---\n\nso on our side, I'd say biggest priorities would be:\n- backporting #33676 so it lands on `v30.1`, which I'm happy to see @ryanofsky already mentioned above, and I also requested here https://github.com/bitcoin/bitcoin/pull/33609#issuecomment-3573215231\n- having a fix for #33940 that ideally also lands on `v30.1`\n\nthat way, we can direct Sv2 adopters to run `v30.1` as soon as it's out, while dropping support to `v30` entirely",
          "created_at": "2025-11-25T14:21:08Z"
        },
        {
          "user": "Sjors",
          "body": "I updated the PR description. Review suggestions:\n- #33965\n- #32420 \n\nBoth would be nice to backport to 30.x though they'll probably miss the v30.1 boat.",
          "created_at": "2025-12-09T10:08:34Z"
        },
        {
          "user": "ryanofsky",
          "body": "re: https://github.com/bitcoin/bitcoin/issues/33777#issuecomment-3631392182\n\nSince there are a number of PRs open, do you have suggestions about what to review (or work on) next? I'd like to see #33965 merged because of the test improvements, but so far I'm the only reviewer on that.",
          "created_at": "2026-01-14T15:47:04Z"
        },
        {
          "user": "ismaelsadeeq",
          "body": "Can you add me to the review list? I will take a look. thanks",
          "created_at": "2026-01-14T15:56:12Z"
        },
        {
          "user": "Sjors",
          "body": "@ryanofsky I'd like #33965 as well. Also #32420 has a direct impact on what stratum v2 blocks will look like.",
          "created_at": "2026-01-14T16:55:09Z"
        }
      ]
    },
    {
      "number": 33773,
      "title": "ci: spurious linter failure?",
      "body": "Run is marked as cancelled but looks fine:\n\n- https://github.com/bitcoin/bitcoin/actions/runs/19062940342/job/54446647440?pr=32876 in #32876",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2025-11-04T10:00:03Z",
      "updated_at": "2025-11-04T11:26:09Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/33773",
      "labels": [
        "CI failed"
      ],
      "comment_list": [
        {
          "user": "maflcko",
          "body": "This simply times out, because the Ubuntu PPAs are so slow/rate-limited/ddos'd:\n\nThe task starts at 8:50, but download only concludes after 9:06:\n\n* https://github.com/bitcoin/bitcoin/actions/runs/19062940342/job/54446647440?pr=32876#step:4:1110\n\n`#11 951.6 Fetched 173 MB in 6min 31s (443 kB/s)`\n\n* https://github.com/bitcoin/bitcoin/actions/runs/19062940342/job/54446647440?pr=32876#step:4:298:\n\n`#11 549.5 Fetched 181 MB in 7min 56s (380 kB/s)`\n\n\nSee https://github.com/bitcoin/bitcoin/pull/33744 for the fix to use proper caching here.",
          "created_at": "2025-11-04T10:48:11Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 12,
    "issues": 2
  }
}