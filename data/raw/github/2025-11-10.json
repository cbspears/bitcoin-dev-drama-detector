{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T20:30:28.467808+00:00",
  "date": "2025-11-10",
  "pull_requests": [
    {
      "number": 33847,
      "title": "kernel: Improve logging API",
      "body": "Simplify kernel logging API and try to connect it to the rest of the kernel API by letting log options be set on `Logger` objects directly and `Logger` objects to be associated with `Context` objects directly. Also drop `logging_disable()` function and avoid having library accumulate log messages in a 1MB buffer by default.\r\n\r\nChanges are intended to make the API a little less surprising and more future proof. Rationale is described in some more detail the commit message.\r\n\r\nThis change is not backwards compatible but I'd expect it to port over pretty smoothly to the language bindings, and offer the same benefits for them as for C/C++ callers.\r\n\r\n",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2025-11-10T23:30:46Z",
      "updated_at": "2026-01-14T23:12:19Z",
      "comments": 11,
      "url": "https://github.com/bitcoin/bitcoin/pull/33847",
      "labels": [
        "Validation",
        "Needs rebase"
      ],
      "comment_list": [
        {
          "user": "sedited",
          "body": "Concept ACK\r\n\r\nThank you for contributing this @ryanofsky! We've discussed doing something similar a few months ago. This is close to how I hoped to implement the logging capabilities, but reviewers highlighted some inconsistencies with this approach: A secondary logger object cannot receive its own non-global options. The docstrings do at least still explain this even with this change, I am not sure if it is really less surprising for users. Maybe it would be preferable to push forward #30342 before this is done? Tagging @stringintech and @stickies-v here, since they both left comments on the logging capabilities during review of #30595.",
          "created_at": "2025-11-11T14:05:55Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33847.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [sedited](https://github.com/bitcoin/bitcoin/pull/33847#issuecomment-3517090033), [stickies-v](https://github.com/bitcoin/bitcoin/pull/33847#issuecomment-3532938522) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#33728](https://github.com/bitcoin/bitcoin/pull/33728) (test: Add bitcoin-chainstate test for assumeutxo functionality by stringintech)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (‚ú® experimental)\n\n\n\nPossible typos and grammar issues:\n\n- \"Register logging callback that can receive log messages and return new\" -> \"Register a logging callback that can receive log messages and return a new\" [Missing articles \"a\" before \"logging callback\" and \"a\" before \"new\" make the sentence grammatically incomplete.]\n- \"may effect this stream.\" -> \"may affect this stream.\" [\"effect\" is the wrong verb here; \"affect\" is correct for meaning \"influence\".]\n- \"Sets log instance for the kernel context to use.\" -> \"Sets the log instance for the kernel context to use.\" [Missing definite article \"the\".]\n- \"@param[in] logger           Is set to the context options.\" -> \"@param[in] logger           Logger to set in the context options.\" [Original phrasing is awkward/unidiomatic and could be confusing; the replacement clearly describes the parameter's purpose.]\n\nIf you want, I can produce a patch with these corrections.\n\n\n\n<sup>2025-12-12</sup>\n",
          "created_at": "2025-11-11T14:05:58Z"
        },
        {
          "user": "ryanofsky",
          "body": "<!-- begin push-2 -->\nUpdated d0bd114e974500ad11c8ecac26d6606166ab7438 -> 0926479924f453c38b5e0ad069435fb3241b2389 ([`pr/klog.1`](https://github.com/ryanofsky/bitcoin/commits/pr/klog.1) -> [`pr/klog.2`](https://github.com/ryanofsky/bitcoin/commits/pr/klog.2), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/klog.1..pr/klog.2))<!-- end --> updating btck_logging_connection_create documentation\n<!-- begin push-3 -->\nRebased 0926479924f453c38b5e0ad069435fb3241b2389 -> 168128bb5e69b10a29732d5af0719adabbb776e1 ([`pr/klog.2`](https://github.com/ryanofsky/bitcoin/commits/pr/klog.2) -> [`pr/klog.3`](https://github.com/ryanofsky/bitcoin/commits/pr/klog.3), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/klog.2-rebase..pr/klog.3))<!-- end -->",
          "created_at": "2025-11-11T14:28:09Z"
        },
        {
          "user": "ryanofsky",
          "body": "re: https://github.com/bitcoin/bitcoin/pull/33847#issuecomment-3517090033\r\n\r\nThanks @TheCharlatan. I think the approach you took in #30595 of making the kernel API mirror the current `logging.h` API was the best one to take as a starting point. #30595 covers a large surface area, and it would have been asking too much of reviewers to evaluate all the different ways the kernel API and existing APIs could or should diverge in one PR. It should be more manageable to make kernel API improvements in targeted followups like this PR, and hopefully the improvements here are welcome.\r\n\r\nOn the question of whether to push forward with this PR or #30342 first: I think this PR should have much higher priority than #30342. The reason is that this PR is not backwards compatible and will require downstream changes to language bindings and probably to most external programs using those bindings. By contrast, #30342 is backwards compatible. If #30342 were merged later, it would just improve how requested log options are applied and how log messages are forwarded, without requiring external changes. #30342 is also a bigger PR that will take more effort to review.\r\n\r\nIt is true that a potential drawback of merging this PR without #30342 is that the design of the API exposed here could make it seem like it provides more functionality than it currently does. Users would not know about the limitations without reading the documentation, and could be surprised or confused. I just would not expect this to be a problem in practice, because the surprising behavior should only occur if users create multiple log streams or multiple kernel context objects at the same time, and that should be uncommon. And even if it did happen, the consequences would not seem very bad: log options might be applied in a different way than expected, or some log messages might be received unexpectedly. It seems like it would place a bigger burden on users to first roll out a logging API that does not support multiple options and streams and then later change it incompatibly, than to roll out an API that could support them and then implement that support internally later.",
          "created_at": "2025-11-11T15:29:27Z"
        },
        {
          "user": "stringintech",
          "body": "Thanks @ryanofsky for explaining the trade-offs!\r\n\r\nI think I also prefer we push this change after we support separate logger instances per connection though, and at this point keep the API consistent with what it's currently capable of. I'm not sure how big of an impact delaying this would have on bindings/users, especially if we're assuming their use cases are mostly limited to a single logging connection.",
          "created_at": "2025-11-13T22:07:01Z"
        },
        {
          "user": "ryanofsky",
          "body": "Thanks for the feedback @stringintech. Can you explain what specifically you may be looking for which this PR does not provide? The API defined here is consistent and logical. It just happens to be compatible with new features like per-connection options and separate log streams (already implemented in #30342) instead of being pointlessly incompatible with them. It also eliminates the btck_logging_disable() function which is unsafe and confusing. And it gets rid of the kernel's inefficient default behavior of storing up log messages in a 1MB buffer in case a logger is attached at later time, instead taking a simpler and more rational approach: logging when a logger is attached and not logging otherwise. I think if you look at the API and documentation defined here you will see that it makes more sense than the current API and should be less confusing. If there are any specific problems I'd be happy to address them.\r\n\r\nIf the logging API is not going to be rationalized soon (it's only been around a week since the API was introduced in #30595), I am concerned it will be more difficult to rationalize later. Logging is a fundamental part of the kernel API so if backwards incompatible changes are made, they are likely to break most language bindings and potentially many applications written in different languages. It should make sense to provide a logging API that's forward compatible and exposes fewer quirks and implementation details sooner instead of later, if we can do that.",
          "created_at": "2025-11-14T01:29:35Z"
        },
        {
          "user": "stringintech",
          "body": "By inconsistency, I mean that refactoring `set_options`/`set_level_category`/`enable_category`/etc. to receive a `btck_LoggingConnection*` parameter suggests that settings are supported per connection, while calling them on a newly instantiated logging connection would actually override settings for all previously instantiated connections. While the actual behavior is well-documented, the function signatures themselves may still create expectations of per-connection isolation.\r\n\r\nI understand you already acknowledged this concern in your [last paragraph here](https://github.com/bitcoin/bitcoin/pull/33847#issuecomment-3517459399), and believe the benefits of pushing this change forward outweigh this downside. My preference was to wait for #30342, since the API refactoring and implementation naturally seem to be parts of a single patch, though I may be too optimistic about how much time/effort it takes to push that PR forward, or the effort it takes to adapt the bindings/other projects to the breaking changes.\r\n\r\nRegarding the `StartLogging()` call being moved from the logging connection constructor to context creation: This delay could mean logs won't be produced by context-free operations (like `btck_script_pubkey_verify()`). If i am not wrong, it appears we don't currently have such operations producing logs, but if we add them in the future while still using a global logger, would we need to move `StartLogging()` back to the logging connection constructor?",
          "created_at": "2025-11-14T12:58:20Z"
        },
        {
          "user": "stickies-v",
          "body": "Concept ACK for making the logging interface local instead of global, but approach ~0 leaning towards nack. I think the approach that merging the backwards-incompatible interface early is not unreasonable but not my preferred one, because:\r\n- I don't think we should at all care about breaking the kernel interface at the moment, the kernel API is experimental and upstream development flexibility and pace should absolutely be prioritized until kernel is in a more stable state\r\n- having the interface behave in unexpected ways is just not desirable, even if this gap is not catastrophic as I think you correctly described\r\n- internal logging refactorings / changes (e.g. #30342, but also others) may surface roadblocks or ideas that inform us about a better interface design, so waiting a bit more seems helpful to me\r\n\r\nI would prefer to convert this to draft, and have this PR serve as the WIP discussion grounds for polishing up the kernel logging API while we make changes such as #30342. I don't have a proposal ready, but I would also like to make breaking changes to the category/level/enable/disable logic (at least for kernel API) which I think currently is extremely unergonomic and unintuitive, as well as support richer callbacks that do not require users (language bindings, especially) to parse already formatted log strings.",
          "created_at": "2025-11-14T13:59:36Z"
        },
        {
          "user": "ryanofsky",
          "body": "> This delay could mean logs won't be produced by context-free operations\r\n\r\nThanks, I'll look into this. I am a little surprised there would be any context-free operations except very basic ones that shouldn't log. It'd expect there to be some context object, even a minimal one, associated with all non-trivial operations to control things like logging, random number generation, caching, etc.\r\n\r\nOf course I do understand your abstract concern that adding a connection parameter \"suggests that settings are supported per connection.\" This is similar to how in many filesystem API's, flushing one file can cause other files to be flushed to disk. Or how in the python database API, cursor objects have commit() and rollback() methods even though in some implementations calling these can affect other cursors. It's not unusual for APIs to provide a little more generality than is guaranteed in every case, if this provides other benefits and avoids other types of pain.\r\n\r\nSo I would like to understand any ways your abstract concern could translate to confusion or problems in practice. When I consider all use-cases I can think of, the new logging API here is less confusing and more coherent than the current one. I already mentioned the current nonsensical default behavior of storing all log messages into a 1MB buffer even when no logging is requested. But lets say you do want to enable logging. You might see the current `btck_logging_set_*` functions and think they actually do something. Well, they don't, because in order to have logging, you need to create a connection object. Adding a connection parameter to these functions makes it obvious that a connection object is actually necessary. Or, in the current API you might see the `btck_logging_connection_create` function and notice that takes a callback and returns a `btck_LoggingConnection` handle. But where is that handle used? Only by the `btck_logging_connection_destroy` function and nowhere else. In the current API, kernel functions which actually log and set logging options are less discoverable because the API is not coherent and the functions using the connection do not reference it.\r\n\r\nMore generally, I'd expect the majority of scripts and applications using the kernel library to only set one logging callback, and in that use-case, the new API should be a strict improvement over the old one. It is true that in the alternate case where an application does create multiple log callbacks, if the application calls `btck_logging_set_*` functions, and the author did not read the documentation for those functions, they might mistakenly think those options apply to a single callback instead of multiple. But those applications will still benefit from this PR because of the follow-up in #30342 which can apply log options singly. So I am trying to think of any application or use-case which would not benefit from this PR and I don't see one. Would be interested to know if I am looking at this from the wrong perspective or am missing something.",
          "created_at": "2025-11-14T14:15:54Z"
        },
        {
          "user": "ryanofsky",
          "body": "> prefer to convert this to draft\r\n\r\nSure happy to do that while there is conceptual discussion.\r\n\r\n> having the interface behave in unexpected ways is just not desirable\r\n\r\nI think I've pointed out practical ways the current interface behaves in unexpected ways and is counterintuitive, and practical ways this PR is an improvement. The concerns you and stringintech raised do seem plausible, but also vague so if there are any concrete scenarios you can think of where this PR might create a problem, they would be helpful to know about.\r\n\r\nThanks for the thoughtful reviews!",
          "created_at": "2025-11-14T14:33:29Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\nüêô This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
          "created_at": "2026-01-14T23:12:18Z"
        }
      ]
    },
    {
      "number": 33845,
      "title": "ci: Enable experimental kernel stuff in ASan task",
      "body": "Base the task on --preset=dev-mode to ensure maximal coverage and add the following:\r\n\r\n```\r\n   bitcoin-chainstate (experimental) ... ON\r\n   libbitcoinkernel (experimental) ..... ON\r\n   kernel-test (experimental) .......... ON\r\n```\r\n\r\nCurrently a draft to figure out https://github.com/bitcoin/bitcoin/pull/33824#issuecomment-3511082065",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-11-10T16:27:19Z",
      "updated_at": "2025-11-11T14:37:28Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/33845",
      "labels": [],
      "comment_list": [
        {
          "user": "maflcko",
          "body": "Continue from https://github.com/bitcoin/bitcoin/pull/33824#issuecomment-3511082065:\r\n\r\n> > I was thinking about permitting nullptr when size=0, or even just permitting nullptr for any size, when the data pointer is followed by a size?\r\n> \r\n> Afaict our de-serialization can handle this case (nullptr when size=0) correctly, but fails when passed a nullptr with non-zero size. Maybe a null check in `btck_block_create(...)` would be better? What do you think?\r\n\r\nYes, either should be fine. To clarify I had two alternative suggestions:\r\n\r\n* Remove all non-null attributes for spans (data+size) and replace them with null checks when the size is one or larger.\r\n* Remove all non-null attributes for spans without replacement.",
          "created_at": "2025-11-10T16:30:42Z"
        },
        {
          "user": "maflcko",
          "body": "I was wondering if the std::span nullptr check was part of the C++26 library hardening, but it seems not (https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2025/p3471r4.html#span-constructors), so I guess if we want it, we'd still have to write it ourselves.\r\n\r\n\r\n<!-- https://godbolt.org/z/T46seK5Po",
          "created_at": "2025-11-11T09:04:46Z"
        },
        {
          "user": "maflcko",
          "body": "Thanks for picking this up! Looks like a simple and small change in your pull request.",
          "created_at": "2025-11-11T14:37:27Z"
        }
      ]
    },
    {
      "number": 33843,
      "title": "test: add tests for private broadcast",
      "body": "This PR contains https://github.com/bitcoin/bitcoin/pull/29415 + two more commits that add functional and fuzz tests.\r\n\r\nPutting those in a separate PR not to burden the main one, since the tests are extensive:\r\ncode: `1036 insertions(+), 91 deletions(-)`\r\ntests: `548 insertions(+), 5 deletions(-)`\r\n",
      "state": "closed",
      "user": "vasild",
      "created_at": "2025-11-10T15:15:19Z",
      "updated_at": "2025-11-10T15:46:59Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/33843",
      "labels": [],
      "comment_list": [
        {
          "user": "dergoegge",
          "body": "Can you elaborate on the rational here? Why would the tests burden the main change? In my opinion, the purpose of tests should be to make it easier to review a code change and gain confidence in it's correctness etc. Splitting them from the code change seems counter productive.",
          "created_at": "2025-11-10T15:20:37Z"
        },
        {
          "user": "fanquake",
          "body": "Concept NACK to deferring adding tests until after adding a new feature.",
          "created_at": "2025-11-10T15:23:22Z"
        },
        {
          "user": "vasild",
          "body": "Closing after discussion at https://www.erisian.com.au/bitcoin-core-dev/log-2025-11-10.html#l-236",
          "created_at": "2025-11-10T15:46:58Z"
        }
      ]
    },
    {
      "number": 33842,
      "title": "build: Bump g++ minimum supported version to 12",
      "body": "All supported operating systems that previously came with at least g++-11, also come with at least g++-12, so bumping the minimum should be fine.\r\n\r\nFor reference:\r\n\r\n* https://packages.ubuntu.com/jammy/g++-12\r\n* https://packages.ubuntu.com/noble/g++ (g++-13)\r\n* https://packages.debian.org/bookworm/g++ (g++-12)\r\n* FreeBSD Ports ship a recent GCC\r\n* RHEL-based 8, and 9 ship with g++-14 via appstream (`dnf install gcc-toolset-14` -> `/opt/rh/gcc-toolset-14/`)\r\n* RHEL-based 10 ships with g++ (14 by default)\r\n* OpenSuse Leap and Tumbleweed ship with g++ 15 https://software.opensuse.org/package/gcc15-c++\r\n\r\nObviously, downloading pre-compiled releases or compiling previous release branches is unaffected by this change.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-11-10T15:03:18Z",
      "updated_at": "2025-11-12T13:17:44Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/pull/33842",
      "labels": [
        "Build system"
      ],
      "comment_list": [
        {
          "user": "maflcko",
          "body": "> Such a change might also require updating the build guides. For instance, the following commands on Ubuntu 22.04 would use GCC 11:\r\n\r\nI am happy to add a general note that the latest stable or LTS is recommended and that earlier releases may need the user to install the required minimum dependencies.",
          "created_at": "2025-11-10T15:59:26Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33842.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/33842#pullrequestreview-3452188347), [janb84](https://github.com/bitcoin/bitcoin/pull/33842#issuecomment-3520878892), [hebasto](https://github.com/bitcoin/bitcoin/pull/33842#pullrequestreview-3452644296) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32748](https://github.com/bitcoin/bitcoin/pull/32748) (fees: prevent redundant estimates flushes by ismaelsadeeq)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-11-11T11:39:40Z"
        },
        {
          "user": "fanquake",
          "body": "Are we keeping `gccbug_90348` (for `-fstack-reuse` bugs), even though it will no-longer reproduce with our supported versions of GCC?",
          "created_at": "2025-11-11T12:02:02Z"
        },
        {
          "user": "janb84",
          "body": "re-ACK fa9f29a4a79944f6ffbb58eab0ac41e243fbeb97",
          "created_at": "2025-11-12T09:13:37Z"
        }
      ]
    },
    {
      "number": 33841,
      "title": "cmake: Switch to `minisketch` upstream build system",
      "body": "This PR:\r\n1. Switches to `minisketch`'s own build system script.\r\n\r\n2. Does not change behaviour, except for printing \"minisketch configure summary\" in the build configuration output.\r\n\r\nFellow reviewers might also be interested in the discussion that took place in https://github.com/bitcoin/bitcoin/pull/32856.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-11-10T14:38:12Z",
      "updated_at": "2026-01-05T21:38:45Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/pull/33841",
      "labels": [
        "Build system"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33841.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [bensig](https://github.com/bitcoin/bitcoin/pull/33841#issuecomment-3712176452) |\n| Concept ACK | [BrandonOdiwuor](https://github.com/bitcoin/bitcoin/pull/33841#pullrequestreview-3602019481) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n",
          "created_at": "2025-12-21T21:52:19Z"
        },
        {
          "user": "bensig",
          "body": "ACK 7fde815b38145702c5ba47623b6770001e212246\r\n\r\nBuilt and tested. Reduces cmake maintenance burden by using minisketch's upstream build system.",
          "created_at": "2026-01-05T21:38:41Z"
        }
      ]
    },
    {
      "number": 33840,
      "title": " test: [refactor] Use reference over ptr to chainman ",
      "body": "Just some minor test-only refactor commits to fix GCC false positive warnings, along with making the test code easier to read and understand:\r\n\r\n* First change requested in https://github.com/bitcoin/bitcoin/pull/33785#discussion_r2510727269\r\n* Second change requested in commit 3b135a8fc4451c93b3ea50b3f4621e0d19f35daf\r\n\r\nThose changes are required in a bunch of pulls touching the CI system, so merging them allows to drop them in all pulls.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-11-10T14:16:22Z",
      "updated_at": "2025-11-27T18:33:13Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/pull/33840",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33840.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [l0rinc](https://github.com/bitcoin/bitcoin/pull/33840#pullrequestreview-3447477940), [hebasto](https://github.com/bitcoin/bitcoin/pull/33840#pullrequestreview-3448108401) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#33764](https://github.com/bitcoin/bitcoin/pull/33764) (ci: Add Windows + UCRT jobs for cross-compiling and native testing by hebasto)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
          "created_at": "2025-11-11T11:52:38Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 33846,
      "title": "`test_kernel` fails to build on Ubuntu 22.04",
      "body": "```\n$ sudo apt update\n$ sudo apt install git build-essential cmake pkgconf python3 libevent-dev libboost-dev libsqlite3-dev\n$ git clone https://github.com/bitcoin/bitcoin.git && cd bitcoin\n$ cmake -B build -DENABLE_IPC=OFF -DBUILD_KERNEL_LIB=ON\n$ cmake --build build -j $(nproc)\n<snip>\n[ 76%] Building CXX object src/test/kernel/CMakeFiles/test_kernel.dir/test_kernel.cpp.o\n/bitcoin/src/test/kernel/test_kernel.cpp:17:10: fatal error: format: No such file or directory\n   17 | #include <format>\n      |          ^~~~~~~~\ncompilation terminated.\ngmake[2]: *** [src/test/kernel/CMakeFiles/test_kernel.dir/build.make:76: src/test/kernel/CMakeFiles/test_kernel.dir/test_kernel.cpp.o] Error 1\ngmake[1]: *** [CMakeFiles/Makefile2:1251: src/test/kernel/CMakeFiles/test_kernel.dir/all] Error 2\ngmake[1]: *** Waiting for unfinished jobs....\n[ 76%] Linking CXX static library ../lib/libbitcoin_node.a\n[ 76%] Built target bitcoin_node\ngmake: *** [Makefile:146: all] Error 2\n```",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-11-10T17:01:45Z",
      "updated_at": "2025-11-12T16:58:20Z",
      "comments": 11,
      "url": "https://github.com/bitcoin/bitcoin/issues/33846",
      "labels": [
        "Refactoring",
        "Tests"
      ],
      "comment_list": [
        {
          "user": "hebasto",
          "body": "cc @TheCharlatan ",
          "created_at": "2025-11-10T17:01:57Z"
        },
        {
          "user": "kevkevinpal",
          "body": "If you want to reproduce using docker here is the docker file\n\n```\nFROM ubuntu:22.04\n\nRUN apt update && \\\n    apt install -y git build-essential cmake pkgconf python3 libevent-dev libboost-dev libsqlite3-dev\n\nWORKDIR /bitcoin\nRUN git clone https://github.com/bitcoin/bitcoin.git .\n\nRUN cmake -B build -DENABLE_IPC=OFF -DBUILD_KERNEL_LIB=ON && \\\n    cmake --build build -j $(nproc)\n```",
          "created_at": "2025-11-11T04:06:49Z"
        },
        {
          "user": "maflcko",
          "body": "Please remove the include. See https://github.com/bitcoin/bitcoin/actions/runs/19176694315/job/54823183155?pr=33810#step:9:18532 :  \n\n```\n /home/admin/actions-runner/_work/_temp/src/test/kernel/test_kernel.cpp should remove these lines:\n- #include <boost/test/included/unit_test.hpp>  // lines 9-9\n- #include <cstdlib>  // lines 15-15\n- #include <format>  // lines 17-17",
          "created_at": "2025-11-11T07:48:31Z"
        },
        {
          "user": "fanquake",
          "body": "Note that this will still fail:\n```bash\n[ 74%] Building CXX object src/test/kernel/CMakeFiles/test_kernel.dir/test_kernel.cpp.o\n/bitcoin/src/test/kernel/test_kernel.cpp: In member function 'void btck_transaction_tests::test_method()':\n/bitcoin/src/test/kernel/test_kernel.cpp:448:34: error: no match for 'operator|' (operand types are 'btck::Range<btck::Transaction, &btck::TransactionApi<btck::Transaction>::CountOutputs, &btck::TransactionApi<btck::Transaction>::GetOutput>' and 'std::ranges::views::__adaptor::_Partial<std::ranges::views::_Filter, btck_transaction_tests::test_method()::<lambda(const auto:22&)> >')\n  448 |     auto amount = *(tx.Outputs() | std::ranges::views::filter([](const auto& output) {\n      |                     ~~~~~~~~~~~~ ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n      |                               |                              |\n      |                               |                              std::ranges::views::__adaptor::_Partial<std::ranges::views::_Filter, btck_transaction_tests::test_method()::<lambda(const auto:22&)> >\n      |                               btck::Range<btck::Transaction, &btck::TransactionApi<btck::Transaction>::CountOutputs, &btck::TransactionApi<btck::Transaction>::GetOutput>\n  449 |                         return output.Amount() == 42130042;\n      |                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n  450 |                     }) |\n      |                     ~~       \n```",
          "created_at": "2025-11-11T15:30:21Z"
        },
        {
          "user": "maflcko",
          "body": "The unused format include is removed in https://github.com/bitcoin/bitcoin/pull/33853/files and the rvalue ranges thing (ref https://gcc.gnu.org/bugzilla/show_bug.cgi?id=113154) is \"fixed\" in https://github.com/bitcoin/bitcoin/pull/33842.\n\nAn alternative could be to use an lvalue. However, I am not sure if this is worth it:\n\n```diff\ndiff --git a/src/test/kernel/test_kernel.cpp b/src/test/kernel/test_kernel.cpp\nindex d9875ee..6ef494b 100644\n--- a/src/test/kernel/test_kernel.cpp\n+++ b/src/test/kernel/test_kernel.cpp\n@@ -14,7 +14,7 @@\n #include <cstdint>\n #include <cstdlib>\n #include <filesystem>\n-#include <format>\n+//#include <format>\n #include <iostream>\n #include <memory>\n #include <optional>\n@@ -446,12 +446,14 @@ BOOST_AUTO_TEST_CASE(btck_transaction_tests)\n     }\n     BOOST_CHECK_EQUAL(total_amount, 62867453);\n \n-    auto amount = *(tx.Outputs() | std::ranges::views::filter([](const auto& output) {\n+    auto amount = [&](){\n+           auto tx_outputs{tx.Outputs()};\n+           return *(tx_outputs | std::ranges::views::filter([](const auto& output) {\n                         return output.Amount() == 42130042;\n                     }) |\n                     std::views::transform([](const auto& output) {\n                         return output.Amount();\n-                    })).begin();\n+                    })).begin();}();\n     BOOST_REQUIRE(amount);\n     BOOST_CHECK_EQUAL(amount, 42130042);\n \n@@ -735,9 +737,9 @@ void chainman_mainnet_validation_test(TestDirectory& test_directory)\n     for (auto transaction : block.Transactions()) {\n         BOOST_CHECK_EQUAL(transaction.CountInputs(), 1);\n     }\n-    auto output_counts = *(block.Transactions() | std::views::transform([](const auto& tx) {\n+    auto output_counts = [&](){auto txs{block.Transactions()};return *(txs | std::views::transform([](const auto& tx) {\n                                return tx.CountOutputs();\n-                           })).begin();\n+                           })).begin();}();\n     BOOST_CHECK_EQUAL(output_counts, 1);\n \n     validation_interface->m_expected_valid_block.emplace(raw_block);\n",
          "created_at": "2025-11-11T16:00:55Z"
        },
        {
          "user": "kevkevinpal",
          "body": "> An alternative could be to use an lvalue. However, I am not sure if this is worth it:\n\nI think it might make most sense to continue with https://github.com/bitcoin/bitcoin/pull/33842 and to bump the min version of g++ to 12 and above as you mentioned",
          "created_at": "2025-11-11T23:18:04Z"
        },
        {
          "user": "kevkevinpal",
          "body": "Just tested on master commit d4e2a458330512c227b475531e1617d25366be54 and the build still failed with this docker file\n\n```\nFROM ubuntu:22.04\n\nRUN apt update\nRUN apt install -y git build-essential cmake pkgconf python3 libevent-dev libboost-dev libsqlite3-dev\n\nCOPY . /bitcoin\nWORKDIR /bitcoin\n\nRUN cmake -B build -DENABLE_IPC=OFF -DBUILD_KERNEL_LIB=ON\nRUN cmake --build build -j1\n```\n\nare we sure https://github.com/bitcoin/bitcoin/pull/33853 closes this issue? @fanquake ",
          "created_at": "2025-11-12T15:33:01Z"
        },
        {
          "user": "hebasto",
          "body": "> ```\n> RUN cmake -B build -DENABLE_IPC=OFF -DBUILD_KERNEL_LIB=ON\n> ```\n\nIt should be [now](https://github.com/bitcoin/bitcoin/pull/33842):\n```\ncmake -B build -DENABLE_IPC=OFF -DBUILD_KERNEL_LIB=ON -DCMAKE_C_COMPILER=gcc-12 -DCMAKE_CXX_COMPILER=g++-12\n```",
          "created_at": "2025-11-12T15:49:53Z"
        },
        {
          "user": "fanquake",
          "body": "> Just tested on master commit https://github.com/bitcoin/bitcoin/commit/d4e2a458330512c227b475531e1617d25366be54 and the build still failed with this docker file\n\nThe minimum required GCC is now 12; however that Dockerfile will install 11. If you install and use 12, it will work.",
          "created_at": "2025-11-12T15:50:09Z"
        },
        {
          "user": "kevkevinpal",
          "body": "> > Just tested on master commit [d4e2a45](https://github.com/bitcoin/bitcoin/commit/d4e2a458330512c227b475531e1617d25366be54) and the build still failed with this docker file\n> \n> The minimum required GCC is now 12; however that Dockerfile will install 11. If you install and use 12, it will work.\n\nok gotcha I assumed https://github.com/bitcoin/bitcoin/pull/33853 alone closed the issue, will attempt to build again using GCC 12 ",
          "created_at": "2025-11-12T16:35:50Z"
        },
        {
          "user": "kevkevinpal",
          "body": "thanks! I was able to get it to build with GCC 12 with this Docker build script\n\n```\nFROM ubuntu:22.04\n\nRUN apt update\nRUN apt install -y git build-essential cmake pkgconf python3 libevent-dev libboost-dev libsqlite3-dev gcc-12 g++-12\n\nCOPY . /bitcoin\nWORKDIR /bitcoin\n\nRUN cmake -B build -DENABLE_IPC=OFF -DBUILD_KERNEL_LIB=ON -DCMAKE_C_COMPILER=gcc-12 -DCMAKE_CXX_COMPILER=g++-12\nRUN cmake --build build -j1\n```",
          "created_at": "2025-11-12T16:58:20Z"
        }
      ]
    },
    {
      "number": 33838,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "jaygta1989",
      "created_at": "2025-11-10T01:01:08Z",
      "updated_at": "2025-11-10T09:35:54Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/33838",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "\nLLM spam detection (‚ú® experimental): SPAM\nExplanation: The message makes unverifiable, grandiose claims about being \"Satoshi\" and references unrelated individuals and organizations. It contains no actionable issue or feature request relevant to the project and appears to be promotional/trolling content.\n\n‚ôªÔ∏è Automatically wiping, closing, and locking for now based on heuristics.\nGenerally, please focus on creating high-quality, original content that demonstrates a clear\nunderstanding of the project's requirements and goals.\n",
          "created_at": "2025-11-10T01:01:14Z"
        }
      ]
    },
    {
      "number": 33837,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "jaygta1989",
      "created_at": "2025-11-10T00:53:56Z",
      "updated_at": "2025-11-10T09:35:49Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/33837",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "\nLLM spam detection (‚ú® experimental): SPAM\nThis issue contains vague, unverifiable identity claims and unrelated speculative content about quantum computers, with no concrete problem, feature request, or technical context related to the project.\n\n‚ôªÔ∏è Automatically wiping, closing, and locking for now based on heuristics.\nGenerally, please focus on creating high-quality, original content that demonstrates a clear\nunderstanding of the project's requirements and goals.\n",
          "created_at": "2025-11-10T00:54:02Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 6,
    "issues": 3
  }
}