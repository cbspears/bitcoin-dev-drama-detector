{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T20:42:46.587742+00:00",
  "date": "2025-12-25",
  "pull_requests": [
    {
      "number": 34149,
      "title": "test: add comprehensive bech32 unit tests based on BIP-173 :christmas_tree:",
      "body": "## Description\r\n\r\nThis PR improves unit test coverage for the bech32 encoding implementation by adding 9 new test cases based on the BIP-173 specification.\r\n\r\n### Motivation\r\n\r\nThe existing bech32 tests cover the standard test vectors from BIP-173/350 but don't extensively test edge cases and error detection properties. Since bech32 is used for SegWit and Taproot addresses, comprehensive testing is important to catch potential regressions.\r\n\r\n### Changes\r\n\r\nNew test cases added to `src/test/bech32_tests.cpp`:\r\n\r\n| Test | Description |\r\n|------|-------------|\r\n| `bech32_charset_encoding` | Verifies all 32 valid characters encode and decode correctly |\r\n| `bech32_roundtrip_encoding` | Tests encode/decode round-trip for data sizes 0-40 bytes |\r\n| `bech32_length_limits` | Tests the 90-character maximum length boundary |\r\n| `bech32_hrp_limits` | Tests HRP edge cases: minimum length, boundary ASCII chars (33, 126), separator in HRP |\r\n| `bech32_single_error_detection` | Verifies single-character errors are detected at every position |\r\n| `bech32_transposition_detection` | Verifies adjacent character transpositions are detected |\r\n| `bech32_multiple_error_detection` | Tests guaranteed detection of 2, 3, and 4 errors |\r\n| `bech32_case_sensitivity` | Tests uppercase, lowercase, and mixed case handling per BIP-173 |\r\n| `bech32_checksum_properties` | Verifies checksum is exactly 6 characters and deterministic |\r\n\r\nThese tests cover the following BIP-173 specification requirements:\r\n- Character set validation (32-character alphabet)\r\n- Maximum length enforcement (90 characters)\r\n- Error detection guarantees (up to 4 errors)\r\n- Case sensitivity rules (reject mixed case)\r\n- Checksum properties (6-character BCH code)\r\n\r\n### References\r\n\r\n- [BIP-173: Base32 address format for native v0-16 witness outputs](https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki)\r\n- [BIP-350: Bech32m format for v1+ witness addresses](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki)\r\n\r\n---\r\n\r\n## PR Checklist\r\n\r\n- [x] Tests pass locally: `ctest --test-dir build -R bech32`\r\n- [x] Code follows existing style in `bech32_tests.cpp`\r\n- [x] Comments reference BIP-173 sections where applicable\r\n- [x] No new dependencies introduced",
      "state": "closed",
      "user": "bitcoinbrisbane",
      "created_at": "2025-12-25T00:48:47Z",
      "updated_at": "2026-01-02T14:37:38Z",
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/pull/34149",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34149.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| User requested bot ignore | [billymcbip](https://github.com/bitcoin/bitcoin/pull/34149#issuecomment-3694263536) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (‚ú® experimental)\n\n\n\nPossible places where comparison-specific test macros should replace generic comparisons:\n\n- src/test/bech32_tests.cpp: BOOST_CHECK(decoded.encoding == bech32::Encoding::BECH32) -> use BOOST_CHECK_EQUAL(decoded.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK(decoded.encoding == encoding) -> use BOOST_CHECK_EQUAL(decoded.encoding, encoding)\n- src/test/bech32_tests.cpp: BOOST_CHECK(decoded.data == data) -> use BOOST_CHECK_EQUAL(decoded.data, data)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_at_limit.encoding == bech32::Encoding::BECH32) -> use BOOST_CHECK_EQUAL(dec_at_limit.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_at_limit.data == max_data) -> use BOOST_CHECK_EQUAL(dec_at_limit.data, max_data)\n- src/test/bech32_tests.cpp: BOOST_CHECK(too_long.size() > 90U) -> use BOOST_CHECK_GT(too_long.size(), 90U)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_too_long.encoding == bech32::Encoding::INVALID) -> use BOOST_CHECK_EQUAL(dec_too_long.encoding, bech32::Encoding::INVALID)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_min.encoding == bech32::Encoding::BECH32) -> use BOOST_CHECK_EQUAL(dec_min.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_boundary.encoding == bech32::Encoding::BECH32) -> use BOOST_CHECK_EQUAL(dec_boundary.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_with_one.encoding == bech32::Encoding::BECH32) -> use BOOST_CHECK_EQUAL(dec_with_one.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_empty.encoding == bech32::Encoding::INVALID) -> use BOOST_CHECK_EQUAL(dec_empty.encoding, bech32::Encoding::INVALID)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_valid.encoding == bech32::Encoding::BECH32) -> use BOOST_CHECK_EQUAL(dec_valid.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK_MESSAGE(dec_corrupted.encoding == bech32::Encoding::INVALID, \"Single error at position \" + std::to_string(pos) + \" was not detected\") -> use BOOST_CHECK_MESSAGE(dec_corrupted.encoding == bech32::Encoding::INVALID, ...) replaced by BOOST_CHECK_MESSAGE(dec_corrupted.encoding == bech32::Encoding::INVALID, ...) or better: BOOST_CHECK_MESSAGE(dec_corrupted.encoding == bech32::Encoding::INVALID, ...) ‚Üí preferably BOOST_CHECK_EQUAL(dec_corrupted.encoding, bech32::Encoding::INVALID) with an explanatory message via BOOST_CHECK_MESSAGE if desired (e.g. BOOST_CHECK_MESSAGE( dec_corrupted.encoding == bech32::Encoding::INVALID, ... ) ‚Üí BOOST_CHECK_EQUAL(dec_corrupted.encoding, bech32::Encoding::INVALID) for clearer diagnostics\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_transposed.encoding == bech32::Encoding::INVALID) (inside BOOST_CHECK_MESSAGE) -> prefer BOOST_CHECK_EQUAL(dec_transposed.encoding, bech32::Encoding::INVALID) (or BOOST_CHECK_MESSAGE around that if a custom message is needed)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec.encoding == bech32::Encoding::INVALID) (multiple-error blocks) -> use BOOST_CHECK_EQUAL(dec.encoding, bech32::Encoding::INVALID)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_upper.encoding == bech32::Encoding::BECH32) -> use BOOST_CHECK_EQUAL(dec_upper.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_lower.encoding == bech32::Encoding::BECH32) -> use BOOST_CHECK_EQUAL(dec_lower.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_mixed.encoding == bech32::Encoding::INVALID) -> use BOOST_CHECK_EQUAL(dec_mixed.encoding, bech32::Encoding::INVALID)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_mixed_hrp.encoding == bech32::Encoding::INVALID) -> use BOOST_CHECK_EQUAL(dec_mixed_hrp.encoding, bech32::Encoding::INVALID)\n- src/test/bech32_tests.cpp: BOOST_CHECK(checksum1 != checksum2) -> use BOOST_CHECK_NE(checksum1, checksum2)\n- src/test/bech32_tests.cpp: BOOST_CHECK(enc1 != enc_diff_hrp) -> use BOOST_CHECK_NE(enc1, enc_diff_hrp)\n\nNotes:\n- Where a custom message is already used with BOOST_CHECK_MESSAGE(...), prefer replacing the comparison with the matching BOOST_CHECK_EQUAL/BOOST_CHECK_NE and, if you need the message, wrap it similarly with BOOST_CHECK_MESSAGE(<comparison>, <message>) or use BOOST_CHECK_MESSAGE with the comparison expression left as-is but consider switching to the comparison-specific macro for clearer failure diffs.\n- Some checks use logical combinations (e.g., BOOST_CHECK(c < 'A' || c > 'Z')) or negations (BOOST_CHECK(!encoded.empty())); these are fine as-is.\n- If any suggested replacement compares containers where BOOST_CHECK_EQUAL may not produce the most readable output, consider BOOST_CHECK_EQUAL_COLLECTIONS for sequences (but BOOST_CHECK_EQUAL is an acceptable first improvement).\n\n\n\n<sup>2025-12-25</sup>\n",
          "created_at": "2025-12-25T00:48:54Z"
        },
        {
          "user": "billymcbip",
          "body": "<!--meta-tag:bot-skip-->\r\nLeaning concept ACK, approach NACK. I suggest reducing the size of the diff by adding your test cases to the four existing functions (valid/invalid bech32/bech32m).",
          "created_at": "2025-12-27T22:23:32Z"
        },
        {
          "user": "maflcko",
          "body": "Are you still working on this?\r\n\r\nPersonally, I fail to see what coverage you are adding. Everything should already be covered, but if something is missing, you'll have to  show that it isn't, and then show that your added tests are hitting that.",
          "created_at": "2026-01-01T17:21:55Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `lint`: https://github.com/bitcoin/bitcoin/actions/runs/20496389555/job/59311707292</sub>\n<sub>LLM reason (‚ú® experimental): Lint check failed due to locale-dependence warning being treated as an error (lint-locale-dependence.py).</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2026-01-02T12:55:50Z"
        },
        {
          "user": "dergoegge",
          "body": "> Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\r\n\r\nMaybe it would make sense to add this to drahtbot's llm detection heuristics?",
          "created_at": "2026-01-02T14:08:48Z"
        },
        {
          "user": "fanquake",
          "body": "Duplicate of #34148?",
          "created_at": "2026-01-02T14:12:17Z"
        },
        {
          "user": "maflcko",
          "body": "> > Co-Authored-By: Claude Opus 4.5 [noreply@anthropic.com](mailto:noreply@anthropic.com)\r\n> \r\n> Maybe it would make sense to add this to drahtbot's llm detection heuristics?\r\n\r\nSure, done in https://github.com/maflcko/DrahtBot/commit/a75df77d6055c8614845f10df4dd37ab03162b1d",
          "created_at": "2026-01-02T14:37:38Z"
        }
      ]
    },
    {
      "number": 34148,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "bitcoinbrisbane",
      "created_at": "2025-12-25T00:46:34Z",
      "updated_at": "2025-12-25T00:47:33Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/pull/34148",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "\nLLM spam detection (‚ú® experimental): SPAM. The body contains only boilerplate contributor guidance and no substantive description, rationale, tests, or implementation details for the proposed change, indicating a placeholder or incomplete submission rather than a real contribution.\n\n‚ôªÔ∏è Automatically wiping, closing, and locking for now based on heuristics.\nGenerally, please focus on creating high-quality, original content that demonstrates a clear\nunderstanding of the project's requirements and goals.\n",
          "created_at": "2025-12-25T00:46:45Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34148.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (‚ú® experimental)\n\n\n\nPossible places where comparison-specific test macros should replace generic comparisons:\n\n- src/test/bech32_tests.cpp: BOOST_CHECK(decoded.encoding == bech32::Encoding::BECH32); -> use BOOST_CHECK_EQUAL(decoded.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK(decoded.encoding == encoding); -> use BOOST_CHECK_EQUAL(decoded.encoding, encoding)\n- src/test/bech32_tests.cpp: BOOST_CHECK(decoded.data == data); -> use BOOST_CHECK_EQUAL(decoded.data, data) (or a collection-aware comparison helper if available)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_at_limit.encoding == bech32::Encoding::BECH32); -> use BOOST_CHECK_EQUAL(dec_at_limit.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_too_long.encoding == bech32::Encoding::INVALID); -> use BOOST_CHECK_EQUAL(dec_too_long.encoding, bech32::Encoding::INVALID)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_min.encoding == bech32::Encoding::BECH32); -> use BOOST_CHECK_EQUAL(dec_min.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_boundary.encoding == bech32::Encoding::BECH32); -> use BOOST_CHECK_EQUAL(dec_boundary.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_with_one.encoding == bech32::Encoding::BECH32); -> use BOOST_CHECK_EQUAL(dec_with_one.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_empty.encoding == bech32::Encoding::INVALID); -> use BOOST_CHECK_EQUAL(dec_empty.encoding, bech32::Encoding::INVALID)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_valid.encoding == bech32::Encoding::BECH32); -> use BOOST_CHECK_EQUAL(dec_valid.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK_MESSAGE(dec_corrupted.encoding == bech32::Encoding::INVALID, \"Single error at position \" + std::to_string(pos) + \" was not detected\"); -> prefer BOOST_CHECK_EQUAL(dec_corrupted.encoding, bech32::Encoding::INVALID) (and if a custom message is needed, use the equality macro plus a separate BOOST_TEST_MESSAGE or adapt to BOOST_TEST equality helpers that support messages)\n- src/test/bech32_tests.cpp: BOOST_CHECK_MESSAGE(dec_transposed.encoding == bech32::Encoding::INVALID, \"Transposition at position \" + std::to_string(pos) + \" was not detected\"); -> prefer BOOST_CHECK_EQUAL(dec_transposed.encoding, bech32::Encoding::INVALID) (see note about messages above)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec.encoding == bech32::Encoding::INVALID); (multiple blocks in multiple_error_detection) -> use BOOST_CHECK_EQUAL(dec.encoding, bech32::Encoding::INVALID)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_upper.encoding == bech32::Encoding::BECH32); -> use BOOST_CHECK_EQUAL(dec_upper.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK_EQUAL(dec_upper.hrp, \"bc\"); (already uses BOOST_CHECK_EQUAL ‚Äî no change)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_lower.encoding == bech32::Encoding::BECH32); -> use BOOST_CHECK_EQUAL(dec_lower.encoding, bech32::Encoding::BECH32)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_mixed.encoding == bech32::Encoding::INVALID); -> use BOOST_CHECK_EQUAL(dec_mixed.encoding, bech32::Encoding::INVALID)\n- src/test/bech32_tests.cpp: BOOST_CHECK(dec_mixed_hrp.encoding == bech32::Encoding::INVALID); -> use BOOST_CHECK_EQUAL(dec_mixed_hrp.encoding, bech32::Encoding::INVALID)\n- src/test/bech32_tests.cpp: for (char c : encoded) { BOOST_CHECK(c < 'A' || c > 'Z'); } -> consider using BOOST_CHECK_GE/BOOST_CHECK_LE or BOOST_CHECK_MESSAGE with explicit checks, e.g. BOOST_CHECK_MESSAGE(std::none_of(encoded.begin(), encoded.end(), [](char c){ return c >= 'A' && c <= 'Z'; }), \"Encoded string contains uppercase letters\") or use BOOST_CHECK_EQUAL on a computed boolean\n\nNote: Many comparisons currently wrapped in BOOST_CHECK/BOOST_CHECK_MESSAGE use ==/!= etc. Replacing these with the comparison-specific macros (BOOST_CHECK_EQUAL, BOOST_CHECK_NE, BOOST_CHECK_LT, BOOST_CHECK_LE, BOOST_CHECK_GT, BOOST_CHECK_GE) yields clearer diagnostics on failure. For container equality, ensure the chosen macro supports the container type (or use collection-aware helpers if available).\n\n\n\n<sup>2025-12-25</sup>\n",
          "created_at": "2025-12-25T00:46:48Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 34150,
      "title": "Windows cross-build: unit test `system_tests/run_command` fails and functional tests cannot start `bitcoind`",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nFollowing `doc/build-windows.md` using WSL + MinGW on Windows, build + install succeed and the GUI runs, but tests fail:\n\n1. The unit test `system_tests/run_command` in `test_bitcoin.exe` fails with an assertion on the expected error message.\n2. Functional tests (`wallet_basic.py` and `--coverage`) fail to start `bitcoind` with `Assertion failed: base.is_absolute(), file ./util/fs.cpp, line 36`.\n\nSo, building and running the GUI works, but the documented unit and functional tests do not pass on this configuration.\n\n\n### Expected behaviour\n\nAfter a successful cross-build using `doc/build-windows.md`, the enabled unit tests (`test_bitcoin`) and basic functional tests (like `wallet_basic.py` and `--coverage`) should run and pass on this supported WSL + MinGW configuration, in line with `src/test/README.md` and `test/functional/README.md`.\n\n\n### Steps to reproduce\n\nAll commands are run inside WSL (Ubuntu). The source tree is **not** under `/mnt/c`, but under the WSL filesystem.\n\n1. Clone and enter the repo:\n```\ngit clone https://github.com/bitcoin/bitcoin.git\ncd bitcoin\n```\n\n2. Build depends (per `doc/build-windows.md`):\n```\ngmake -C depends HOST=x86_64-w64-mingw32\n```\n\n3. Configure and build (per `doc/build-windows.md`):\n```\ncmake -B build --toolchain depends/x86_64-w64-mingw32/toolchain.cmake\ncmake --build build\n```\n\n4. Install to Windows (bitcoind/bitcoin-qt work fine from here):\n```\ncmake --install build --prefix /mnt/c/workspace/bitcoin\n```\n\n5. Build unit tests:\n```\ncmake --build build --target test_bitcoin\n```\n\n6. Run the specific unit test:\n```\ncd ~/bitcoin/build/bin\n./test_bitcoin.exe --run_test=system_tests/run_command --log_level=test_suite\n```\n\n7. Run a functional test and coverage (from repo root):\n```\ncd ~/bitcoin\nbuild/test/functional/test_runner.py wallet_basic.py\nbuild/test/functional/test_runner.py --coverage\n```\n\n### Relevant log output\n\nUnit test failure:\n```\ncd ~/bitcoin/build/bin\n./test_bitcoin.exe --run_test=system_tests/run_command --log_level=test_suite\n```\n\nOutput (trimmed):\n```\nEntering test module \"Bitcoin Core Test Suite\"\n./wallet/test/walletload_tests.cpp(14): Test suite \"walletload_tests\" is skipped because disabled\n... (many test suites skipped because disabled) ...\n./test/testnet4_miner_tests.cpp(30): Test suite \"testnet4_miner_tests\" is skipped because disabled\n./test/system_tests.cpp(17): Entering test suite \"system_tests\"\n./test/system_tests.cpp(21): Entering test case \"run_command\"\n./test/system_tests.cpp(56): error: in \"system_tests/run_command\": check what.find(tfm::format(\"RunCommandParseJSON error: process(%s) returned 1: \\n\", command)) != std::string::npos has failed\n./test/system_tests.cpp(21): Leaving test case \"run_command\"; testing time: 196716us\n./test/system_tests.cpp(17): Leaving test suite \"system_tests\"; testing time: 199262us\n./test/system_ram_tests.cpp(13): Test suite \"system_ram_tests\" is skipped because disabled\n... (more suites skipped) ...\nLeaving test module \"Bitcoin Core Test Suite\"; testing time: 433839us\n\n*** 1 failure is detected in the test module \"Bitcoin Core Test Suite\"\n```\n\nFunctional test failure (wallet_basic.py):\n```\ncd ~/bitcoin\nbuild/test/functional/test_runner.py wallet_basic.py\n```\n\nOutput:\n```\nTemporary test directory at /tmp/test_runner_‚Çø_üèÉ_20251225_162435\nRemaining jobs: [wallet_basic.py]\n1/1 - wallet_basic.py failed, Duration: 57 s\n\nstdout:\n2025-12-25T16:24:35.518658Z TestFramework (INFO): PRNG seed is: 6050933089769083783\n2025-12-25T16:24:35.520147Z TestFramework (INFO): Initializing test directory /tmp/test_runner_‚Çø_üèÉ_20251225_162435/wallet_basic_0\n2025-12-25T16:25:32.647545Z TestFramework (ERROR): Unexpected exception\nTraceback (most recent call last):\n  File \"/home/kelos/bitcoin/test/functional/test_framework/test_framework.py\", line 138, in main\n    self.setup()\n  File \"/home/kelos/bitcoin/test/functional/test_framework/test_framework.py\", line 269, in setup\n    self.setup_network()\n  File \"/home/kelos/bitcoin/build/test/functional/wallet_basic.py\", line 44, in setup_network\n    self.setup_nodes()\n  File \"/home/kelos/bitcoin/test/functional/test_framework/test_framework.py\", line 382, in setup_nodes\n    self.start_nodes()\n  File \"/home/kelos/bitcoin/test/functional/test_framework/test_framework.py\", line 528, in start_nodes\n    node.wait_for_rpc_connection()\n  File \"/home/kelos/bitcoin/test/functional/test_framework/test_node.py\", line 316, in wait_for_rpc_connection\n    raise FailedToStartError(self._node_msg(\ntest_framework.test_node.FailedToStartError: [node 0] bitcoind exited with status 3 during initialization. Assertion failed: base.is_absolute(), file ./util/fs.cpp, line 36\n************************\n\n2025-12-25T16:25:32.699370Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n2025-12-25T16:25:32.699638Z TestFramework (WARNING): Not cleaning up dir /tmp/test_runner_‚Çø_üèÉ_20251225_162435/wallet_basic_0\n2025-12-25T16:25:32.699739Z TestFramework (ERROR): Test failed. Test logging available at /tmp/test_runner_‚Çø_üèÉ_20251225_162435/wallet_basic_0/test_framework.log\n2025-12-25T16:25:32.699905Z TestFramework (ERROR):\n2025-12-25T16:25:32.700105Z TestFramework (ERROR): Hint: Call /home/kelos/bitcoin/test/functional/combine_logs.py '/tmp/test_runner_‚Çø_üèÉ_20251225_162435/wallet_basic_0' to consolidate all logs\n2025-12-25T16:25:32.700184Z TestFramework (ERROR):\n2025-12-25T16:25:32.700424Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\n2025-12-25T16:25:32.700571Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\n2025-12-25T16:25:32.700677Z TestFramework (ERROR):\n\nstderr:\n[node 3] Cleaning up leftover process\n[node 2] Cleaning up leftover process\n[node 1] Cleaning up leftover process\n[node 0] Cleaning up leftover process\n\nTEST            | STATUS    | DURATION\nwallet_basic.py | ‚úñ Failed  | 57 s\n\nALL             | ‚úñ Failed  | 57 s (accumulated)\nRuntime: 57 s\n```\n\nFunctional test failure with --coverage:\n```\ncd ~/bitcoin\nbuild/test/functional/test_runner.py --coverage\n```\n\nOutput:\n```\nTemporary test directory at /tmp/test_runner_‚Çø_üèÉ_20251225_162532\nInitializing coverage directory at /tmp/coveragemf6gv9tr\n[node 0] Cleaning up leftover process\n2025-12-25T16:25:32.916746Z TestFramework (INFO): PRNG seed is: 332623413216244638\n2025-12-25T16:25:32.917531Z TestFramework (INFO): Initializing test directory /tmp/test_runner_‚Çø_üèÉ_20251225_162532/cache\n2025-12-25T16:25:35.676350Z TestFramework (ERROR): Unexpected exception\nTraceback (most recent call last):\n  File \"/home/kelos/bitcoin/test/functional/test_framework/test_framework.py\", line 138, in main\n    self.setup()\n  File \"/home/kelos/bitcoin/test/functional/test_framework/test_framework.py\", line 268, in setup\n    self.setup_chain()\n  File \"/home/kelos/bitcoin/test/functional/test_framework/test_framework.py\", line 356, in setup_chain\n    self._initialize_chain()\n  File \"/home/kelos/bitcoin/test/functional/test_framework/test_framework.py\", line 814, in _initialize_chain\n    self.start_node(CACHE_NODE_ID)\n  File \"/home/kelos/bitcoin/test/functional/test_framework/test_framework.py\", line 514, in start_node\n    node.wait_for_rpc_connection()\n  File \"/home/kelos/bitcoin/test/functional/test_node.py\", line 316, in wait_for_rpc_connection\n    raise FailedToStartError(self._node_msg(\ntest_framework.test_node.FailedToStartError: [node 0] bitcoind exited with status 3 during initialization. Assertion failed: base.is_absolute(), file ./util/fs.cpp, line 36\n************************\n\n2025-12-25T16:25:35.729866Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n2025-12-25T16:25:35.730219Z TestFramework (WARNING): Not cleaning up dir /tmp/test_runner_‚Çø_üèÉ_20251225_162532/cache\n2025-12-25T16:25:35.730333Z TestFramework (ERROR): Test failed. Test logging available at /tmp/test_runner_‚Çø_üèÉ_20251225_162532/cache/test_framework.log\n2025-12-25T16:25:35.730631Z TestFramework (ERROR):\n2025-12-25T16:25:35.730888Z TestFramework (ERROR): Hint: Call /home/kelos/bitcoin/test/functional/combine_logs.py '/tmp/test_runner_‚Çø_üèÉ_20251225_162532/cache' to consolidate all logs\n2025-12-25T16:25:35.731025Z TestFramework (ERROR):\n2025-12-25T16:25:35.731110Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\n2025-12-25T16:25:35.731245Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\n2025-12-25T16:25:35.731393Z TestFramework (ERROR):\n\nTraceback (most recent call last):\n  File \"/home/kelos/bitcoin/build/test/functional/test_runner.py\", line 931, in <module>\n    main()\n  File \"/home/kelos/bitcoin/build/test/functional/test_runner.py\", line 542, in main\n    run_tests(\n  File \"/home/kelos/bitcoin/build/test/functional/test_runner.py\", line 595, in run_tests\n    subprocess.check_output([sys.executable, tests_dir + 'create_cache.py'] + flags + [\"--tmpdir=%s/cache\" % tmpdir])\n  File \"/usr/lib/python3.12/subprocess.py\", line 466, in check_output\n    return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,\n  File \"/usr/lib/python3.12/subprocess.py\", line 571, in run\n    raise CalledProcessError(retcode, process.args,\nsubprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/kelos/bitcoin/build/test/functional/create_cache.py', '--cachedir=/home/kelos/bitcoin/build/test/cache', '--configfile=/home/kelos/bitcoin/build/test/functional/../config.ini', '--coveragedir=/tmp/coveragemf6gv9tr', '--tmpdir=/tmp/test_runner_‚Çø_üèÉ_20251225_162532/cache']' returned non-zero exit status 1.\n```\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nmaster@d861c3820528fad2e17a455949bec70b6ba434dcc\n\n### Operating system and version\n\nWindows 10.0.26200.7462 (host), WSL2 with Ubuntu; `wsl.exe --version`: - WSL version: 2.6.2.0 - Kernel version: 6.6.87.2-1 - WSLg version: 1.0.71 - MSRDC version: 1.2.6353 - Direct3D version: 1.611.1-81528511 - DXCore version: 10.0.26100.1-240331-1435.ge-release\n\n### Machine specifications\n\nCPU:\n- 12th Gen Intel Core i5-12500H (x86_64)\n- 8 cores / 16 threads (lscpu)\n- L3 cache: 18 MiB\n\nMemory:\n- 16 GiB RAM total\n- ~11 GiB free, 4 GiB swap (free -h)\n\nDisk:\n- Host C: drive 454 GiB total, 219 GiB free (df -h, /mnt/c)\n- WSL root filesystem on /dev/sdd: 1.0 TiB total, 946 GiB free\n\nDistro inside WSL:\n- Ubuntu 24.04.3 LTS (noble) (lsb_release -a)",
      "state": "closed",
      "user": "DevPatel-11",
      "created_at": "2025-12-25T17:10:55Z",
      "updated_at": "2025-12-27T22:29:38Z",
      "comments": 8,
      "url": "https://github.com/bitcoin/bitcoin/issues/34150",
      "labels": [
        "Windows"
      ],
      "comment_list": [
        {
          "user": "maflcko",
          "body": "Not sure what your goal is, but I think you are trying to run a Windows executable inside the WSL env (possibly through Wine?). Is this really what you are doing and what you want to be doing? I think it makes more sense to either:\n\n* Natively compile for Linux inside WSL, and run natively for Linux inside WSL\n* Cross-compile for Windows inside WSL, and run natively outside of WSL in Windows\n* Compile natively on and for Windows, and run natively on Windows",
          "created_at": "2025-12-26T07:08:23Z"
        },
        {
          "user": "DevPatel-11",
          "body": "Thanks for the quick reply!\n\nJust to clarify what I tested:\n- Cross-compile for Windows in WSL using `doc/build-windows.md` (depends + CMake).\n- Installed to `C:\\workspace\\bitcoin` and successfully ran `bitcoin-qt.exe` on Windows.\n- For tests, I stayed in WSL and ran `build/bin/test_bitcoin.exe` and `build/test/functional/test_runner.py`, which then start the cross-built `bitcoind.exe`.\n\nIf running the Windows test binaries from WSL is considered unsupported, I‚Äôm happy to switch to:\n- building natively for Linux in WSL and running tests there, or\n- running tests only with Linux binaries for this environment.\n\nIn that case, this issue can be closed as ‚Äúunsupported configuration‚Äù; I mainly wanted to check whether this cross-build + WSL test combination is expected to work or not.\n",
          "created_at": "2025-12-26T07:28:28Z"
        },
        {
          "user": "maflcko",
          "body": "> For tests, I stayed in WSL and ran `build/bin/test_bitcoin.exe` and `build/test/functional/test_runner.py`, which then start the cross-built `bitcoind.exe`.\n\nSo you did that via Wine? For reference, Wine was dropped from the CI config, due to issues: https://github.com/bitcoin/bitcoin/pull/31284#issuecomment-2515273927. \n\n\n\n> If running the Windows test binaries from WSL is considered unsupported, I‚Äôm happy to switch to:\n> \n>     * building natively for Linux in WSL and running tests there, or\n> \n>     * running tests only with Linux binaries for this environment.\n> \n> \n> In that case, this issue can be closed as ‚Äúunsupported configuration‚Äù; I mainly wanted to check whether this cross-build + WSL test combination is expected to work or not.\n\nWell, if there is an obvious bug and an obvious fix for an issue, I am happy to review it. However, I don't think the config will ever be added back to the CI matrix, because I don't see a real use-case behind it.",
          "created_at": "2025-12-26T07:43:20Z"
        },
        {
          "user": "DevPatel-11",
          "body": "Thanks for the clarification!\n\nTo answer your question: I did **not** use Wine anywhere. All commands were run directly in WSL:\n\n- Cross-compile for Windows in WSL using `doc/build-windows.md`.\n- Run the resulting `.exe` binaries from WSL by invoking `./build/bin/test_bitcoin.exe` and the functional tests, which then start the cross-built `bitcoind.exe`.\n\nGiven your comment that this configuration (running Windows binaries under WSL, similar to what CI used to do with Wine) is not really supported and won‚Äôt be in the CI matrix, I‚Äôm fine treating this as an unsupported setup.\n\nMy goal with this issue was mainly to confirm whether this combination is expected to work or not, and share the exact failures I saw in case they point to an obvious bug / simple fix.\n\nIf you think this should be closed, I‚Äôm happy for you to close it !",
          "created_at": "2025-12-26T07:52:04Z"
        },
        {
          "user": "maflcko",
          "body": "For reference, i pushed commit https://github.com/maflcko/bitcoin-core-with-ci/commit/c1387e48e12db0ee3efbdf80b91d5267d81c3301 : and it passed: https://github.com/maflcko/bitcoin-core-with-ci/actions/runs/20518628300/job/58950286007#step:7:4867\n\n```diff\ndiff --git a/ci/test/00_setup_env_win64_msvcrt.sh b/ci/test/00_setup_env_win64_msvcrt.sh\nindex 86e0ea9c80..9c72b6fddd 100755\n--- a/ci/test/00_setup_env_win64_msvcrt.sh\n+++ b/ci/test/00_setup_env_win64_msvcrt.sh\n@@ -9,8 +9,9 @@ export LC_ALL=C.UTF-8\n export CONTAINER_NAME=ci_win64_msvcrt\n export CI_IMAGE_NAME_TAG=\"mirror.gcr.io/ubuntu:24.04\"  # Check that https://packages.ubuntu.com/noble/g++-mingw-w64-x86-64-posix (version 13.x, similar to guix) can cross-compile\n export HOST=x86_64-w64-mingw32\n-export PACKAGES=\"g++-mingw-w64-x86-64-posix nsis\"\n-export RUN_UNIT_TESTS=false\n+export DPKG_ADD_ARCH=\"i386\"\n+export PACKAGES=\"nsis g++-mingw-w64-x86-64-posix wine-binfmt wine64 wine32 file\"\n+export RUN_UNIT_TESTS=true\n export RUN_FUNCTIONAL_TESTS=false\n export GOAL=\"deploy\"\n export BITCOIN_CONFIG=\"\\\ndiff --git a/ci/test/03_test_script.sh b/ci/test/03_test_script.sh\nindex d29de80c3e..0b39f205c9 100755\n--- a/ci/test/03_test_script.sh\n+++ b/ci/test/03_test_script.sh\n@@ -157,6 +157,10 @@ if [ -n \"${CI_LIMIT_STACK_SIZE}\" ]; then\n   ulimit -s 512\n fi\n \n+if [[ $HOST = *-mingw32 ]]; then\n+  \"${BASE_ROOT_DIR}/ci/test/wrap-wine.sh\"\n+fi\n+\n if [ -n \"$USE_VALGRIND\" ]; then\n   \"${BASE_ROOT_DIR}/ci/test/wrap-valgrind.sh\"\n fi\ndiff --git a/ci/test/wrap-wine.sh b/ci/test/wrap-wine.sh\nnew file mode 100755\nindex 0000000000..a0d32a93a3\n--- /dev/null\n+++ b/ci/test/wrap-wine.sh\n@@ -0,0 +1,20 @@\n+#!/usr/bin/env bash\n+#\n+# Copyright (c) 2020-2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+export LC_ALL=C.UTF-8\n+\n+for b_name in {\"${BASE_OUTDIR}/bin\"/*,src/univalue/{test_json,unitester,object}}.exe; do\n+    # shellcheck disable=SC2044\n+    for b in $(find \"${BASE_ROOT_DIR}\" -executable -type f -name \"$(basename \"$b_name\")\"); do\n+      if (file \"$b\" | grep \"Windows\"); then\n+        echo \"Wrap $b ...\"\n+        mv \"$b\" \"${b}_orig\"\n+        echo '#!/usr/bin/env bash' > \"$b\"\n+        echo \"( wine \\\"${b}_orig\\\" \\\"\\$@\\\" ) || ( sleep 1 && wine \\\"${b}_orig\\\" \\\"\\$@\\\" )\" >> \"$b\"\n+        chmod +x \"$b\"\n+      fi\n+    done\n+done\n",
          "created_at": "2025-12-26T09:16:12Z"
        },
        {
          "user": "maflcko",
          "body": "> My goal with this issue was mainly to confirm whether this combination is expected to work or not, and share the exact failures I saw in case they point to an obvious bug / simple fix.\n> \n> If you think this should be closed, I‚Äôm happy for you to close it !\n\nThis is up to you. I can't reproduce the bug and I don't think anyone will work on this issue, so you'll have to create and submit a fix yourself. If not, then maybe this can indeed be closed.\n\nYou may also try https://github.com/bitcoin/bitcoin/pull/33929, if it improves your situation.",
          "created_at": "2025-12-26T09:17:43Z"
        },
        {
          "user": "DevPatel-11",
          "body": "Thanks for the feedback. \nI will try #33929 and see if it helps. I'll close this issue now. Thanks for understanding!\n",
          "created_at": "2025-12-26T09:36:38Z"
        },
        {
          "user": "hebasto",
          "body": ">    * Cross-compile for Windows in WSL using `doc/build-windows.md`.\n> \n>    * Run the resulting `.exe` binaries from WSL by invoking `./build/bin/test_bitcoin.exe` and the functional tests, which then start the cross-built `bitcoind.exe`.\n\nFWIW, when working on Windows, it is worth considering building natively [using clang-cl](https://github.com/bitcoin/bitcoin/pull/31507).",
          "created_at": "2025-12-27T22:29:38Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 2,
    "issues": 1
  }
}