{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T20:38:08.562732+00:00",
  "date": "2025-12-08",
  "pull_requests": [
    {
      "number": 34031,
      "title": "net: Remove \"tor\" as a network specification",
      "body": "\"tor\" as a network specification was deprecated in 60dc8e4208 in favor of \"onion\" \r\nand this commit removes it and updates the relevant test.\r\n\r\nPreviously #16029. This has been warning as being deprecated since `v0.17.0`.\r\n\r\nThis PR only removes the already deprecated usage of tor as a network specification, the use of tor throughout the codebase, is not deprecated.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-12-08T13:41:27Z",
      "updated_at": "2025-12-10T17:27:20Z",
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/pull/34031",
      "labels": [
        "P2P"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34031.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [laanwj](https://github.com/bitcoin/bitcoin/pull/34031#pullrequestreview-3556762716), [davidgumberg](https://github.com/bitcoin/bitcoin/pull/34031#issuecomment-3634833133), [janb84](https://github.com/bitcoin/bitcoin/pull/34031#pullrequestreview-3561654896), [stickies-v](https://github.com/bitcoin/bitcoin/pull/34031#pullrequestreview-3562122384) |\n| Stale ACK | [pablomartin4btc](https://github.com/bitcoin/bitcoin/pull/34031#pullrequestreview-3552560740), [sipa](https://github.com/bitcoin/bitcoin/pull/34031#pullrequestreview-3553002765) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-12-08T13:41:34Z"
        },
        {
          "user": "fanquake",
          "body": "cc @laanwj ",
          "created_at": "2025-12-08T16:55:02Z"
        },
        {
          "user": "laanwj",
          "body": "There's one left in init.cpp:\r\n```patch\r\ndiff --git a/src/init.cpp b/src/init.cpp\r\nindex bfb9483ad8730541848fc4789bafe343165d28f2..9849be22f9e45387cf1303b05100cdee58496f90 100644\r\n--- a/src/init.cpp\r\n+++ b/src/init.cpp\r\n@@ -1683,7 +1683,7 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\r\n             ipv4_proxy = name_proxy = proxy;\r\n         } else if (net_str == \"ipv6\") {\r\n             ipv6_proxy = name_proxy = proxy;\r\n-        } else if (net_str == \"tor\" || net_str == \"onion\") {\r\n+        } else if (net_str == \"onion\") {\r\n             onion_proxy = proxy;\r\n         } else if (net_str == \"cjdns\") {\r\n             cjdns_proxy = proxy;\r\n```",
          "created_at": "2025-12-09T09:47:35Z"
        },
        {
          "user": "laanwj",
          "body": "Test needs a change too:\r\n```patch\r\ndiff --git a/test/functional/feature_proxy.py b/test/functional/feature_proxy.py\r\nindex ba8a0212a6a0dd9cf166ab87d3b60486cb844aba..aec81fa79888af42dec3387e4a2ccddee0d5204c 100755\r\n--- a/test/functional/feature_proxy.py\r\n+++ b/test/functional/feature_proxy.py\r\n@@ -468,8 +468,8 @@ class ProxyTest(BitcoinTestFramework):\r\n         assert_equal(nets[\"ipv6\"][\"proxy\"], \"127.6.6.6:6666\")\r\n         self.stop_node(1)\r\n\r\n-        self.log.info(\"Test overriding the Tor proxy\")\r\n-        self.start_node(1, extra_args=[\"-proxy=127.1.1.1:1111\", \"-proxy=127.2.2.2:2222=tor\"])\r\n+        self.log.info(\"Test overriding the Onion proxy\")\r\n+        self.start_node(1, extra_args=[\"-proxy=127.1.1.1:1111\", \"-proxy=127.2.2.2:2222=onion\"])\r\n         nets = networks_dict(self.nodes[1].getnetworkinfo())\r\n         assert_equal(nets[\"ipv4\"][\"proxy\"], \"127.1.1.1:1111\")\r\n         assert_equal(nets[\"ipv6\"][\"proxy\"], \"127.1.1.1:1111\")\r\n```",
          "created_at": "2025-12-09T10:09:38Z"
        },
        {
          "user": "davidgumberg",
          "body": "crACK https://github.com/bitcoin/bitcoin/commit/e7ac5a133cc354b1e60cb9c3660da03e79c50173",
          "created_at": "2025-12-10T00:23:10Z"
        },
        {
          "user": "laanwj",
          "body": "> suggestion NIT: add some clarity in the PR description that only the tor network specification is deprecated and not the usage of the name tor or code referring to tor (or something similar) to limit followup PR's that see this as an invitation to remove the name Tor everywhere.\r\n\r\nRight. Usage of \"Tor\" is fine, and doesn't need to be removed. It's just that Tor is a general overlay network with exis nodes, but this specific proxy is the one used for `.onion` addresses, so calling it onion is way less confusing. ",
          "created_at": "2025-12-10T12:28:35Z"
        }
      ]
    },
    {
      "number": 34029,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "Osptium-Invincible",
      "created_at": "2025-12-08T05:41:01Z",
      "updated_at": "2025-12-08T05:41:22Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/34029",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "\n‚ôªÔ∏è Automatically closing for now based on heuristics. Please leave a comment, if this was erroneous.\nGenerally, please focus on creating high-quality, original content that demonstrates a clear\nunderstanding of the project's requirements and goals.\n\nüìù Moderators: If this is spam, please replace the title with `.`, so that the thread does not appear in\nsearch results.\n",
          "created_at": "2025-12-08T05:41:05Z"
        },
        {
          "user": "DrahtBot",
          "body": "\nLLM spam detection (‚ú® experimental): SPAM. The submission contains only template/boilerplate guidance and no substantive description, rationale, or implementation details; it appears to be a placeholder or irrelevant contribution rather than a legitimate change.\n\n‚ôªÔ∏è Automatically wiping, closing, and locking for now based on heuristics.\nGenerally, please focus on creating high-quality, original content that demonstrates a clear\nunderstanding of the project's requirements and goals.\n",
          "created_at": "2025-12-08T05:41:09Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34029.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (‚ú® experimental)\n\n\n\nPossible typos and grammar issues:\n\n- I m -> I'm [missing apostrophe in contraction makes the phrase nonstandard]\n- offical -> official [spelling error]\n\n\n\n<sup>2025-12-08</sup>\n",
          "created_at": "2025-12-08T05:41:12Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 34030,
      "title": "consider adding a new `interface RawTxFeed` on Mining IPC",
      "body": "Sv2 Job Declarator Server (a.k.a. JDS) needs to keep an in-memory representation of the mempool so it can validate the custom jobs it receives via `DeclareMiningJob` message\n\ncurrently, SRI JDS polls some RPCs against Bitcoin Core, but polling is rather suboptimal\n\non https://github.com/stratum-mining/sv2-apps/issues/26 we considered switching to an approach where we subscribe for the `rawtx` ZMQ feed... JDS would have some task that's solely dedicated to consuming this feed\n\nhowever, [I hear ZMQ is not super reliable](https://github.com/stratum-mining/sv2-apps/issues/26#issuecomment-3621881167) and this might be a good opportunity to leverage IPC, so I'm creating this issue to brainstorm with @ryanofsky @Sjors @ismaelsadeeq whether this would make sense\n\nin order to provide something similar to a `rawtx` ZMQ feed, I can imagine the following:\n- new `createRawTxFeed` method under `interface Mining`, returning a `RawTxFeed` as a result\n- new `interface RawTxFeed` with a `waitNext` method\n\n(although I probably have blindspots and core devs might be able to imagine better approaches)\n\n`getTransactionsByWitnessId` (to be potentially introduced via https://github.com/bitcoin/bitcoin/pull/34020) would be  useful as a secondary mechanism to be leveraged if JDS receives a `DeclareMiningJob` contains some `wtxid` that hasn't arrived on the feed yet, which could happen for two different potential reasons:\n- this specific `wtxid` is on the back of the queue while the chained calls to `RawTxFeed.waitNext` didn't fully catch up yet, in which case `getTransactionsByWitnessId` will accelerate the process\n- Bitcoin Core simply hasn't seen this tx yet, in which case `getTransactionsByWitnessId` will return an error and JDS has no option but to send `ProvideMissingTransactions` to JDC",
      "state": "closed",
      "user": "plebhash",
      "created_at": "2025-12-08T09:31:59Z",
      "updated_at": "2025-12-11T18:57:12Z",
      "comments": 11,
      "url": "https://github.com/bitcoin/bitcoin/issues/34030",
      "labels": [
        "interfaces"
      ],
      "comment_list": [
        {
          "user": "Sjors",
          "body": "> JDS polls some RPCs against Bitcoin Core\n\nCan you enumerate which RPC calls you're polling? And briefly explain why.\n\nFor streaming changes to the mempool, we'd probably want to introduce a whole new `Mempool` interface, since there are other use cases (wallets, lightning nodes, block explorers). And such an interface might as well have methods to submit new transaction (packages).\n\nWe haven't used IPC for ZMQ-style streaming yet. In the Mining interface you call a method and get a result, immediately or after a delay. So this might be quite involved.\n\nCalling a `waitNext` method and getting a response for every single new mempool transaction is simpler. But it would be very inefficient when there's dozens of new transactions per second. They could be collected in batches though.\n\nYou could also use a (package) fee rate filter so the JDS only collects transactions that are likely to be mined, fetching specific missing txs just in time via `getTransactionsByWitnessId()`.",
          "created_at": "2025-12-08T09:57:25Z"
        },
        {
          "user": "plebhash",
          "body": "> Can you enumerate which RPC calls you're polling? \n\n`getrawmempool` is the only polled RPC, under a user-defined period, to periodically check whether there's new txs it needs to be aware of\n\n- `health` is called once at startup\n- `getrawtransaction` is called (multiple times, one for each new tx) after `getrawmempool` on each polling cycle\n- `submitblock` is called ad-hoc after JDC sends `PushSolution`",
          "created_at": "2025-12-08T10:18:48Z"
        },
        {
          "user": "plebhash",
          "body": "> They could be collected in batches though.\n\nyeah `waitNext` probably shouldn't return one single tx at a time, batching makes more sense\n\noverall the main point is to be able to have something that allows Bitcoin Core to push mempool updates ASAP, instead of forcing the client to have to poll for it ",
          "created_at": "2025-12-08T14:14:59Z"
        },
        {
          "user": "plebhash",
          "body": "> fetching specific missing txs just in time via `getTransactionsByWitnessId()`\n\nI feel this should be left as a last-resort kind of thing\n\nwhatever feed JDS gets from Bitcoin Core (be it updates with single or batched txs), it should contain full `txdata` instead of only `wtxids`\n\nthen it's up to JDS implementation to aim to optimize which txs it could selectively drop to avoid unbounded memory consumption\n\nmain point being:\n\n `txdata` should be made available sooner, rather than selectively fetched (with extra round-trips on hot Job Declaration paths) later ",
          "created_at": "2025-12-08T14:29:38Z"
        },
        {
          "user": "ryanofsky",
          "body": "> We haven't used IPC for ZMQ-style streaming yet. In the Mining interface you call a method and get a result, immediately or after a delay. So this might be quite involved.\n\nThis is true for the mining interface, but the other interfaces in #29409 and #10102 do used streamed notifications. The wallet uses `Chain.handleNotifications` to start receiving notifications and transactions and blocks:\n\nhttps://github.com/bitcoin/bitcoin/blob/d9efd1e49d1df154970b6a60229eedde3ba7cffe/src/ipc/capnp/chain.capnp#L58\n\nproviding a `ChainNotifications` instance to see transactions added / removed from the mempool:\n\nhttps://github.com/bitcoin/bitcoin/blob/d9efd1e49d1df154970b6a60229eedde3ba7cffe/src/ipc/capnp/chain.capnp#L74-L75\n\nI will to say I don't understand enough of the context behind this to know if this design is ideal, and am curious how the JDS mempool will be managed. Is it supposed to be a superset of bitcoin core mempool + any transactions that pool participants sent? Does that also mean it will keep transactions that get dropped from the bitcoin core mempool and maybe doesn't need transactionRemovedFromMempool information?",
          "created_at": "2025-12-08T14:57:20Z"
        },
        {
          "user": "Sjors",
          "body": "A pool's JDS processes proposed templates from multiple miners, which will have divergent mempools. So until a block is mined, some templates may still have transaction that the pool itself threw out of its mempool.\n\nIn order for the JDS to prune its pseudo-mempool it could track which inputs are spent in the new block and (recursively) delete entries that spend from it.",
          "created_at": "2025-12-08T15:25:35Z"
        },
        {
          "user": "plebhash",
          "body": "moving discussion from #34013 here, where @Fi3 [said](https://github.com/bitcoin/bitcoin/issues/34013#issuecomment-3635671638)\n\n> ... @plebhash about the stream style design I don't think that is good idea, I do not want to have every tx in mempool around but just the ones that are actually added to templates.",
          "created_at": "2025-12-10T07:30:32Z"
        },
        {
          "user": "plebhash",
          "body": "reply to @Fi3:\n\n---\n\nfirst, let me explain the rationale behind this feature request\n\nonce `DeclareMiningJob` arrives, I wanted JDS to be able to validate it as fast as possible\n\nassuming the best case scenario (where all `wtxid`s have already been seen and no extra `ProvideMissingTransactions` round-trip is needed), having all txs readily available on JDS memory would allow the validation of `DeclareMiningJob` to happen ASAP\n\nif we're worried about unbounded memory growth, low-fee txs (which are unlikely to be in a template anyways) could always be evicted after they arrive from the stream\n\n---\n\nnow entertaining your perspective:\n\nalternatively, we could call `getTransactionsByWitnessId` (to be potentially introduced via #34020) every time `DeclareMiningJob` arrives\n\nwhile we could be comfortable with this extra round-trip over a local UNIX socket (because it's fast), we should keep in mind that IPC could potentially be extended to TCP as well, which could introduce room for undesirable latency\n\nand that's where the stream-based approach could come in handy, because JDS would be able to have all txs readily available in memory when `DeclareMiningJob` arrives",
          "created_at": "2025-12-10T07:37:17Z"
        },
        {
          "user": "Sjors",
          "body": "> low-fee txs [...] could always be evicted after they arrive from the stream\n\nThat's not so easy, because you can't judge transactions by their individual fee rate. We introduced the [cluster mempool](https://delvingbitcoin.org/t/an-overview-of-the-cluster-mempool-proposal/393) approach to handle this.\n\nIf you want to filter the stream, it's better to do so on the node side. But we'd need a different interface method for that, one that emits (chunks of) clusters above a certain fee rate threshold.",
          "created_at": "2025-12-10T09:11:04Z"
        },
        {
          "user": "Fi3",
          "body": "> reply to [@Fi3](https://github.com/Fi3):\n> \n> first, let me explain the rationale behind this feature request\n> \n> once `DeclareMiningJob` arrives, I wanted JDS to be able to validate it as fast as possible\n> \n> assuming the best case scenario (where all `wtxid`s have already been seen and no extra `ProvideMissingTransactions` round-trip is needed), having all txs readily available on JDS memory would allow the validation of `DeclareMiningJob` to happen ASAP\n> \n> if we're worried about unbounded memory growth, low-fee txs (which are unlikely to be in a template anyways) could always be evicted after they arrive from the stream\n> \n> now entertaining your perspective:\n> \n> alternatively, we could call `getTransactionsByWitnessId` (to be potentially introduced via [#34020](https://github.com/bitcoin/bitcoin/pull/34020)) every time `DeclareMiningJob` arrives\n> \n> while we could be comfortable with this extra round-trip over a local UNIX socket (because it's fast), we should keep in mind that IPC could potentially be extended to TCP as well, which could introduce room for undesirable latency\n> \n> and that's where the stream-based approach could come in handy, because JDS would be able to have all txs readily available in memory when `DeclareMiningJob` arrives\n\nkeep in mind that you will see unknown txs in a very small percentage of the declared job so the overall impact is very very low",
          "created_at": "2025-12-11T08:57:19Z"
        },
        {
          "user": "plebhash",
          "body": "ok, I guess we can stick with `getTransactionsByWitnessId` (to be potentially introduced via https://github.com/bitcoin/bitcoin/pull/34020) for https://github.com/stratum-mining/sv2-apps/issues/24\n\nif these IPC round-trips ever prove to be an undesirable bottleneck, we can revisit the ideas proposed here.",
          "created_at": "2025-12-11T15:54:18Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 2,
    "issues": 1
  }
}