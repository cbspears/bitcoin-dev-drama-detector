{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T19:38:47.972642+00:00",
  "date": "2025-05-06",
  "pull_requests": [
    {
      "number": 32430,
      "title": "test: Add and use ElapseTime helper",
      "body": "Currently mocktime is written to a global, which may leak between sub-tests (albeit some tests try to reset the mocktime on a best-effort basis). Also, when advancing it, one has to keep a counter variable around.\r\n\r\nFix both issues by a new `ElapseTime` helper, which resets the mocktime once it goes out of scope. Also, it has a method to advance the mocktime by a delta.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2025-05-06T22:39:14Z",
      "updated_at": "2025-11-01T01:36:21Z",
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/pull/32430",
      "labels": [
        "Tests",
        "Needs rebase"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32430.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [l0rinc](https://github.com/bitcoin/bitcoin/pull/32430#pullrequestreview-3076264451) |\n| Stale ACK | [w0xlt](https://github.com/bitcoin/bitcoin/pull/32430#pullrequestreview-2822849432) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#33106](https://github.com/bitcoin/bitcoin/pull/33106) (policy: lower the default blockmintxfee, incrementalrelayfee, minrelaytxfee by glozow)\n* [#32941](https://github.com/bitcoin/bitcoin/pull/32941) (p2p: TxOrphanage revamp cleanups by glozow)\n* [#32414](https://github.com/bitcoin/bitcoin/pull/32414) (validation: periodically flush dbcache during reindex-chainstate by andrewtoth)\n* [#29700](https://github.com/bitcoin/bitcoin/pull/29700) (kernel, refactor: return error status on all fatal errors by ryanofsky)\n* [#28676](https://github.com/bitcoin/bitcoin/pull/28676) (Cluster mempool implementation by sdaftuar)\n* [#17783](https://github.com/bitcoin/bitcoin/pull/17783) (common: Disallow calling IsArgSet() on ALLOW_LIST options by ryanofsky)\n* [#17580](https://github.com/bitcoin/bitcoin/pull/17580) (refactor: Add ALLOW_LIST flags and enforce usage in CheckArgFlags by ryanofsky)\n* [#16545](https://github.com/bitcoin/bitcoin/pull/16545) (refactor: Implement missing error checking for ArgsManager flags by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-06T22:39:17Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `lint`: https://github.com/bitcoin/bitcoin/runs/41759458930</sub>\n<sub>LLM reason (‚ú® experimental): (empty)</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-05-06T22:54:38Z"
        },
        {
          "user": "maflcko",
          "body": "Sorry for the force-pushes, but this uncovered pre-existing issues in the fuzz tests that were not using mocktime during init. So I went ahead and fixed those as well in a separate commit. Should be good now, hopefully :sweat_smile: ",
          "created_at": "2025-05-07T09:47:14Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `previous releases, depends DEBUG`: https://github.com/bitcoin/bitcoin/runs/45588216821</sub>\n<sub>LLM reason (‚ú® experimental): The CI failure is caused by a compilation error in src/util/time.cpp due to incorrect usage of std::chrono::duration, which prevents building.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-07-08T20:27:38Z"
        },
        {
          "user": "maflcko",
          "body": "> Sorry for the force-pushes, but this uncovered pre-existing issues in the fuzz tests that were not using mocktime during init. So I went ahead and fixed those as well in a separate commit. Should be good now, hopefully üòÖ\r\n\r\nWent ahead and cherry-picked out the fuzz-fixes into https://github.com/bitcoin/bitcoin/pull/32927. Should be easy to (re-)review that one.",
          "created_at": "2025-07-09T15:04:10Z"
        },
        {
          "user": "maflcko",
          "body": "rebased to drop merged commits and included some minimal fixups",
          "created_at": "2025-07-11T13:44:21Z"
        },
        {
          "user": "maflcko",
          "body": "Force pushed with some minor doc-changes and small refactoring in `src/test/util/time.h`",
          "created_at": "2025-07-31T10:41:23Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\nüêô This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
          "created_at": "2025-08-04T17:58:15Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--13523179cfe9479db18ec6c5d236f789-->\n‚åõ There hasn't been much activity lately and the patch still needs rebase. What is the status here?\n\n* Is it still relevant? ‚û°Ô∏è Please solve the conflicts to make it ready for review and to ensure the CI passes.\n* Is it no longer relevant? ‚û°Ô∏è Please close.\n* Did the author lose interest or time to work on this? ‚û°Ô∏è Please close it and mark it with one of the labels 'Up for grabs' or 'Insufficient Review', so that it can be picked up in the future.\n",
          "created_at": "2025-11-01T01:36:21Z"
        }
      ]
    },
    {
      "number": 32429,
      "title": "docs: Improve `keypoolrefill` RPC docs",
      "body": "Update `keypoolrefill` RPC docs to make it clear that descriptor wallets have 4 ScriptPubKeyManagers by default and each of them is updated in this command, as suggested https://github.com/bitcoin/bitcoin/issues/29924#issuecomment-2849321859\r\n\r\nCloses https://github.com/bitcoin/bitcoin/issues/29924",
      "state": "closed",
      "user": "w0xlt",
      "created_at": "2025-05-06T19:15:28Z",
      "updated_at": "2025-05-07T21:55:42Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/pull/32429",
      "labels": [
        "Docs"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32429.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [brunoerg](https://github.com/bitcoin/bitcoin/pull/32429#pullrequestreview-2822682329), [achow101](https://github.com/bitcoin/bitcoin/pull/32429#issuecomment-2860463811) |\n| Stale ACK | [rkrux](https://github.com/bitcoin/bitcoin/pull/32429#pullrequestreview-2821296596) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-06T19:15:30Z"
        },
        {
          "user": "achow101",
          "body": "ACK ff35a4b021e12ae33e28c01ffeeb2c1916f7a487",
          "created_at": "2025-05-07T21:44:20Z"
        }
      ]
    },
    {
      "number": 32427,
      "title": "(RFC) kernel: Replace leveldb-based BlockTreeDB with flat-file based store",
      "body": "Opening this PR mostly to get concept/approach feedback.\r\n\r\nThis is motivated by the kernel library, where the internal usage of leveldb is a limiting factor to its future use cases. Specifically it is not possible to share leveldb databases between two processes. A notable use-case for the kernel library is accessing and analyzing existing block data. Currently this can only be done by first shutting down the node writing this data. Moving away from leveldb opens the door towards doing this in parallel. A flat file based approach was chosen, since the requirements for persistence here are fairly simple (no deletion, constant-size entries). The change also offers better performance by making node startup faster, and has a smaller on-disk footprint, though this is negligible in the grand scheme of things.\r\n\r\nThe BlockTreeStore introduces a new data format for storing block indexes and headers on disk. The class is very similar to the existing CBlockTreeDB, which stores the same data in a leveldb database. Unlike CBlockTreeDB, the data stored through the BlockTreeStore is directly serialized and written to flat .dat files. The storage schema introduced\r\nis simple. It relies on the assumption that no entry is ever deleted and that no duplicate entries are written. These assumptions hold for the current users of CBlockTreeDB.\r\n\r\nA write ahead ahead log and boolean flags as file existence checks ensure write atomicity. Every data entry is also given a crc32c checksum to detect data corruption.\r\n\r\nThe change also opens the door towards getting rid of having to reindex the block tree due to corruption (though switching from pruned -> un-pruned still requires extra logic). This would simplify a lot of kernel/validation code, as can be seen in this [commit](https://github.com/TheCharlatan/bitcoin/commit/bfb2709e1d116d4e613601c3f0140f099530159d#diff-28f178018e05634ee3f8ddce3f4e0cec334ae69915cecf92be8299c749d8d470). The implementation here should be fairly robust against corruption (no parallel read/writes, no background compaction).\r\n\r\nAn alternative to this pull request, that could allow the same kernel feature, would be closing and opening the leveldb database only when reading and writing. This might incur a (negligible) performance penalty, but more importantly requires careful consideration of how to handle any contentions when opening, which might have complex side effects due to our current locking mode. It would also be possible to introduce an existing database with the required features for just the block tree, but that would introduce reliance on a new dependency and come with its own tradeoffs. For these reasons I chose this approach.",
      "state": "open",
      "user": "sedited",
      "created_at": "2025-05-06T14:27:59Z",
      "updated_at": "2026-01-14T17:31:08Z",
      "comments": 34,
      "url": "https://github.com/bitcoin/bitcoin/pull/32427",
      "labels": [
        "UTXO Db and Indexes"
      ]
    },
    {
      "number": 32425,
      "title": "config: allow setting -proxy per network",
      "body": "`-proxy=addr:port` specifies the proxy for all networks (except I2P). Previously only the Tor proxy could have been specified separately via `-onion=addr:port`.\r\n\r\nMake it possible to specify separately the proxy for IPv4, IPv6, Tor and CJDNS by e.g. `-proxy=addr:port=ipv6`. Or remove the proxy for a given network, e.g. `-proxy=0=cjdns`.\r\n\r\nResolves: https://github.com/bitcoin/bitcoin/issues/24450\r\n\r\n",
      "state": "closed",
      "user": "vasild",
      "created_at": "2025-05-06T13:09:42Z",
      "updated_at": "2025-07-31T19:15:35Z",
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/pull/32425",
      "labels": [
        "P2P"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32425.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [pinheadmz](https://github.com/bitcoin/bitcoin/pull/32425#pullrequestreview-2836872116), [caesrcd](https://github.com/bitcoin/bitcoin/pull/32425#pullrequestreview-2837204950), [danielabrozzoni](https://github.com/bitcoin/bitcoin/pull/32425#pullrequestreview-2840193686), [1440000bytes](https://github.com/bitcoin/bitcoin/pull/32425#pullrequestreview-2852127113) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32699](https://github.com/bitcoin/bitcoin/pull/32699) (docs: adds correct updated documentation links by Zeegaths)\n* [#31974](https://github.com/bitcoin/bitcoin/pull/31974) (Drop testnet3 by Sjors)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-06T13:09:44Z"
        },
        {
          "user": "vasild",
          "body": "`6a9f04688f...2059eaa692`: address suggestions\r\n\r\n> If the user sets `-proxy=addr:port=tor` then `-onion=` shouldn't be allowed, no? Otherwise one could set 2 diff proxies for Tor(?).\r\n\r\nI think that is ok, assuming the expectation is that later options override earlier ones. For example, without this PR, `-proxy=x -onion=y` is supposed to set the Tor proxy to `y`, overriding the earlier `x`. Updated `tor.md` to mention that.\r\n\r\n> So, shouldn't `-proxy=0=cjdns` be the default if `-cjdnsreachable` when `-proxy=addr:port`?\r\n\r\nCould be, but I do not like these \"automatically set `x` only if `y` and `z` are true, otherwise something else\". That would also change the default behavior in a breaking way - for people that use `-proxy` which does support CJDNS it will stop working. Maybe there are no such users, but we can't know for sure.",
          "created_at": "2025-05-07T12:25:23Z"
        },
        {
          "user": "pablomartin4btc",
          "body": ">> Otherwise one could set 2 diff proxies for Tor(?).\r\n\r\n> I think that is ok, assuming the expectation is that later options override earlier ones. For example, without this PR, `-proxy=x -onion=y` is supposed to set the Tor proxy to `y`, overriding the earlier `x`. Updated `tor.md` to mention that.\r\n\r\nOk.\r\n \r\n> > So, shouldn't `-proxy=0=cjdns` be the default if `-cjdnsreachable` when `-proxy=addr:port`?\r\n> \r\n> Could be, but I do not like these \"automatically set `x` only if `y` and `z` are true, otherwise something else\". That would also change the default behavior in a breaking way - for people that use `-proxy` which does support CJDNS it will stop working. Maybe there are no such users, but we can't know for sure.\r\n\r\nOk, but since the [previous statement](https://github.com/bitcoin/bitcoin/pull/32425#pullrequestreview-2818995555) (`-proxy=`...) from [Tor's doc](https://github.com/bitcoin/bitcoin/tree/master/doc/tor.md) combined with:\r\n\r\n`-onlynet=onion  Make automatic outbound connections only to .onion addresses.`\r\n\r\nMaybe we should give a warning at least (and perhaps suggesting: `-proxy=0=cjdns`) because that (`-proxy=ip[:<port>] -onlynet=onion -cjdnsreachable`) would make CJDNS not to work (?).\r\n\r\nI think a more long term solution could be to add the possibility of having a separate proxy for CJDNS, as suggested on the [issue](https://github.com/bitcoin/bitcoin/issues/24450) by other commenters there.\r\n",
          "created_at": "2025-05-07T13:25:32Z"
        },
        {
          "user": "vasild",
          "body": "> Maybe we should give a warning at least (and perhaps suggesting: `-proxy=0=cjdns`) because that (`-proxy=ip[:<port>] -onlynet=onion -cjdnsreachable`) would make CJDNS not to work (?).\r\n\r\nThat would make automatic outbound connections to Tor peers only. Still manual outbound and inbound connections would work and be possible to/from CJDNS peers. Maybe a warning in the lines of \"Automatic outbound connections will only be made to Tor peers, if you want to include CJDNS, then use -onlynet=cjdns in addition\". Or maybe not? In either case adding such a warning seems to be out of the scope of this PR whose purpose is to be able to specify proxy per network.\r\n\r\n> I think a more long term solution could be to add the possibility of having a separate proxy for CJDNS, as suggested on the [issue](https://github.com/bitcoin/bitcoin/issues/24450) by other commenters there.\r\n\r\nThat is made possible by this PR: `-proxy=addr:port=cjdns`.",
          "created_at": "2025-05-08T09:57:51Z"
        },
        {
          "user": "1440000bytes",
          "body": "Concept ACK \r\n\r\nMultiple proxies for different networks would be useful. Might need release notes if this eventually gets merged.",
          "created_at": "2025-05-11T21:54:20Z"
        },
        {
          "user": "vasild",
          "body": "`2059eaa692...e98c51fcce`: address suggestions",
          "created_at": "2025-05-13T10:15:53Z"
        },
        {
          "user": "1440000bytes",
          "body": "Configured 2 tor proxies with different circuits for ipv4 and ipv6 and they are working as expected:\r\n\r\n```\r\n$ curl --socks5-hostname 127.0.0.1:9050 http://ipv4.icanhazip.com\r\n45.90.185.109\r\n\r\n$ curl --socks5-hostname [::1]:9053 http://ipv6.icanhazip.com\r\n2605:6400:30:f174:1:1:1:1\r\n```\r\n\r\nUsed these proxies to run `bitcoind`:\r\n\r\n```\r\nbitcoind -signet -proxy=127.0.0.1:9050=ipv4 -proxy=[::1]:9053=ipv6 \r\n```\r\n\r\nI see the proxies in `getnetworkinfo` and some outbound peers in `getpeerinfo`:\r\n\r\n```\r\n  {\r\n      \"name\": \"ipv4\",\r\n      \"limited\": false,\r\n      \"reachable\": true,\r\n      \"proxy\": \"127.0.0.1:9050\",\r\n      \"proxy_randomize_credentials\": true\r\n    },\r\n    {\r\n      \"name\": \"ipv6\",\r\n      \"limited\": false,\r\n      \"reachable\": true,\r\n      \"proxy\": \"[::1]:9053\",\r\n      \"proxy_randomize_credentials\": true\r\n    },\r\n```\r\n\r\nHowever, I am getting an error when I stop bitcoind in the logs:\r\n\r\n```\r\n2025-05-19T22:28:07Z Shutdown: In progress...\r\n2025-05-19T22:28:07Z addcon thread exit\r\n2025-05-19T22:28:07Z dnsseed thread exit\r\n2025-05-19T22:28:07Z msghand thread exit\r\n2025-05-19T22:28:07Z net thread exit\r\n2025-05-19T22:28:08Z [error] Error while reading proxy response\r\n```\r\n\r\nIt could be because of unreliable Tor connectivity. I tried increasing the timeout in https://github.com/bitcoin/bitcoin/blob/33f8f8ae4cedda2515c9d6123213c528bb82b7ee/src/netbase.cpp#L40 but it made no difference.",
          "created_at": "2025-05-19T22:40:58Z"
        },
        {
          "user": "glozow",
          "body": "Needs release note?",
          "created_at": "2025-06-10T19:54:00Z"
        },
        {
          "user": "vasild",
          "body": "> Needs release note?\r\n\r\nRight. Done in https://github.com/bitcoin/bitcoin/pull/32727",
          "created_at": "2025-06-11T11:01:30Z"
        }
      ]
    },
    {
      "number": 32424,
      "title": "docs: clarify RPC credentials security boundary",
      "body": "\r\n\r\nExplicitly states that RPC credentials grant full administrative access to the node and filesystem resources accessible by bitcoind. Adds a new section in JSON-RPC-interface.md to address issue #32274 by documenting that providing RPC credentials to untrusted clients",
      "state": "closed",
      "user": "crStiv",
      "created_at": "2025-05-06T09:40:11Z",
      "updated_at": "2025-08-15T19:21:21Z",
      "comments": 13,
      "url": "https://github.com/bitcoin/bitcoin/pull/32424",
      "labels": [
        "Docs"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32424.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Stale ACK | [davidgumberg](https://github.com/bitcoin/bitcoin/pull/32424#issuecomment-2855566965), [janb84](https://github.com/bitcoin/bitcoin/pull/32424#pullrequestreview-2850500482) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-06T09:40:13Z"
        },
        {
          "user": "davidgumberg",
          "body": "lgtm ACK https://github.com/bitcoin/bitcoin/pull/32424/commits/ed862012f747d4e5248f08ff25183dc666c3de6e\r\n\r\n I opened #32274 because I wasn't sure if this status quo is desirable or not, but I believe this documentation note reflects the present expectations for `bitcoind` RPC servers.",
          "created_at": "2025-05-06T18:41:35Z"
        },
        {
          "user": "janb84",
          "body": "Please [squash](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#squashing-commits) your commits ",
          "created_at": "2025-05-06T20:27:36Z"
        },
        {
          "user": "crStiv",
          "body": "> Please [squash](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#squashing-commits) your commits\r\n\r\n@janb84 yeah sure, np ",
          "created_at": "2025-05-06T21:14:00Z"
        },
        {
          "user": "luke-jr",
          "body": "Seems to contradict the existence of `-rpcwhitelist`",
          "created_at": "2025-05-14T01:34:40Z"
        },
        {
          "user": "crStiv",
          "body": "> Seems to contradict the existence of `-rpcwhitelist`\r\n\r\n@luke-jr now seems to be better, what are your thoughts?",
          "created_at": "2025-05-19T10:51:46Z"
        },
        {
          "user": "janb84",
          "body": "Would move the remark of the -rpcwhitelist to the end of the section and add something about the -rpcwhitelistdefault function that is needed to set the default on no whitelist for all users.  The added documentation is still strong imo üëç",
          "created_at": "2025-05-19T11:29:23Z"
        },
        {
          "user": "crStiv",
          "body": "@davidgumberg @janb84 @luke-jr i'm not sure if I should mention all of you guys, please tell if not\r\n\r\nbut just wanted to make sure if everything is alright with this pr as it's inactive for almost three months ",
          "created_at": "2025-08-14T08:13:23Z"
        },
        {
          "user": "janb84",
          "body": "Still looks like a good addition to me. ",
          "created_at": "2025-08-14T09:34:12Z"
        },
        {
          "user": "davidgumberg",
          "body": "Please squash your commits: https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#squashing-commits",
          "created_at": "2025-08-14T17:26:19Z"
        },
        {
          "user": "crStiv",
          "body": "i tried to squash commits via GitHub Desktop and it seems to be I f\"ckd all the things up",
          "created_at": "2025-08-14T20:07:17Z"
        },
        {
          "user": "janb84",
          "body": "> i tried to squash commits via GitHub Desktop and it seems to be I f\"ckd all the things up\r\n\r\nyeah try to use the CLI, should be relatively straightforward (and changes are made local so if you mess up you can revert) ",
          "created_at": "2025-08-15T08:39:40Z"
        },
        {
          "user": "crStiv",
          "body": "@janb84 i used CLI and and I dunno what I did wrong but I closed the PR, sorry for my dumbness, I hope it won't give you any trouble",
          "created_at": "2025-08-15T13:58:18Z"
        }
      ]
    },
    {
      "number": 32423,
      "title": "rpc: Undeprecate rpcuser/rpcpassword, store all credentials hashed in memory",
      "body": "This PR does two things:\r\n\r\n### Undeprecate rpcuser/rpcpassword, change message to security warning\r\n\r\nBack in 2015, in https://github.com/bitcoin/bitcoin/pull/7044, we added configuration option `rpcauth` for multiple RPC users. At the same time the old settings for single-user configuration `rpcuser` and `rpcpassword` were \"soon\" to be deprecated.\r\n\r\nThe main reason for this deprecation is that while `rpcpassword` stores the password in plain text, `rpcauth` stores a hash, so it doesn't appear in the configuration in plain text.\r\n\r\nAs the options are still in active use, actually removing them is expected to be a hassle to many, and it's not clear that is worth it. As for the security risk, in many kinds of setups (no wallet, containerized, single-user-single-application, local-only, etc) it is an unlikely point of escalation.\r\n\r\nIn the end, it is good to encourage secure practices, but it is the responsibility of the user. Log a clear warning but remove the deprecation notice (this is also the only place where the options appear as deprecated, they were never marked as such in the -help output).\r\n\r\n<hr>\r\n\r\n### Store all credentials hashed in memory\r\n\r\nThis gets rid of the special-casing of `strRPCUserColonPass` by hashing cookies as well as manually provided `-rpcuser`/`-rpcpassword` with a random salt before storing them.\r\n\r\nAlso take the opportunity to modernize the surrounding code a bit. There should be no end-user visible differences in behavior.\r\n\r\n<hr>\r\n\r\nCloses #29240.",
      "state": "closed",
      "user": "laanwj",
      "created_at": "2025-05-06T09:31:45Z",
      "updated_at": "2025-05-19T16:42:09Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/32423",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32423.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [1440000bytes](https://github.com/bitcoin/bitcoin/pull/32423#pullrequestreview-2831519829), [janb84](https://github.com/bitcoin/bitcoin/pull/32423#pullrequestreview-2832467514), [vasild](https://github.com/bitcoin/bitcoin/pull/32423#pullrequestreview-2833098998) |\n| Concept ACK | [Sjors](https://github.com/bitcoin/bitcoin/pull/32423#issuecomment-2854351055) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29641](https://github.com/bitcoin/bitcoin/pull/29641) (scripted-diff: Use LogInfo over LogPrintf [WIP, NOMERGE, DRAFT] by maflcko)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-06T09:31:49Z"
        },
        {
          "user": "laanwj",
          "body": "[2392b4324777e002dc5363bac7f85cc6f8586818 ‚Üí 3b0366d1775d6c00844ff0c90542814bf641bb18](https://github.com/bitcoin/bitcoin/compare/2392b4324777e002dc5363bac7f85cc6f8586818..3b0366d1775d6c00844ff0c90542814bf641bb18)\r\nUse `UCharCast`, no newline on log message, pass in `std::string_view`, some `&` code formatting",
          "created_at": "2025-05-06T10:28:51Z"
        },
        {
          "user": "Sjors",
          "body": "Hah, I was planning on doing this undeprecating this morning, but couldn't find the deprecation message, so I figured someone already did it.\r\n\r\nConcept ACK",
          "created_at": "2025-05-06T12:14:06Z"
        },
        {
          "user": "yancyribbens",
          "body": "> As for the security risk, in many kinds of setups (no wallet, containerized, single-user-single-application, local-only, etc) it is an unlikely point of escalation\r\n\r\nThis probably applies to testnet and regtest too.",
          "created_at": "2025-05-06T16:59:11Z"
        },
        {
          "user": "laanwj",
          "body": "> This probably applies to testnet and regtest too.\r\n\r\nYes, for quick testing, not having to use an external script to create credentials is more convenient too. Usually cookie-based auth will suffice, but not always when dealing with external applications that need a username/password.",
          "created_at": "2025-05-08T10:15:31Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 32428,
      "title": "Depends toolchain doesn't contain enough info to build from depends on a fresh NixOS install",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nOn a fresh NixOS install when building using depends, the generated toolchain does not pass along enough info for the depends packages to be found by `cmake`:\n\n- Following the reproduction steps below will cause `cmake -B build --toolchain <toolchain>` to error with:\n\n```log\n-- The CXX compiler identification is Clang 19.1.3\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\n-- Check for working CXX compiler: /nix/store/l4bagvaywzkq3cbjd98rjkqwc0vkpxxw-clang-wrapper-19.1.3/bin/clang++ - skipped\n-- Detecting CXX compile features\n-- Detecting CXX compile features - done\n-- Setting build type to \"RelWithDebInfo\" as none was specified\n-- Performing Test CXX_SUPPORTS__WERROR\n-- Performing Test CXX_SUPPORTS__WERROR - Success\n-- Performing Test CXX_SUPPORTS__G3\n-- Performing Test CXX_SUPPORTS__G3 - Success\n-- Performing Test LINKER_SUPPORTS__G3\n-- Performing Test LINKER_SUPPORTS__G3 - Success\n-- Performing Test CXX_SUPPORTS__FTRAPV\n-- Performing Test CXX_SUPPORTS__FTRAPV - Success\n-- Performing Test LINKER_SUPPORTS__FTRAPV\n-- Performing Test LINKER_SUPPORTS__FTRAPV - Success\nCMake Error at /nix/store/4kb60dy0dg80ww8gh2av4by4vwn8l48k-cmake-3.30.5/share/cmake-3.30/Modules/FindPackageHandleStandardArgs.cmake:233 (message):\n  Could NOT find SQLite3 (missing: SQLite3_INCLUDE_DIR SQLite3_LIBRARY)\n  (Required is at least version \"3.7.17\")\nCall Stack (most recent call first):\n  /nix/store/4kb60dy0dg80ww8gh2av4by4vwn8l48k-cmake-3.30.5/share/cmake-3.30/Modules/FindPackageHandleStandardArgs.cmake:603 (_FPHSA_FAILURE_MESSAGE)\n  /nix/store/4kb60dy0dg80ww8gh2av4by4vwn8l48k-cmake-3.30.5/share/cmake-3.30/Modules/FindSQLite3.cmake:66 (find_package_handle_standard_args)\n  CMakeLists.txt:110 (find_package)\n\n\n-- Configuring incomplete, errors occurred!\n```\n\nI have started some basic investigation of this and found that with [this patch](https://github.com/bitcoin/bitcoin/commit/437a4da93f437f9588ff32d19ac59fea3802c676) we can detect the depends libraries correctly and build successfully, but I am unsure if this is the correct approach for a fix.\n\n### Expected behaviour\n\nThe toolchain should pass along enough information so that packages can be located on a fresh system install.\n\n### Steps to reproduce\n\n```\ndocker run --pull=always -it nixos/nix\ngit clone --depth=1 https://github.com/bitcoin/bitcoin && cd bitcoin\nnix-shell -p binutils cmake curl gcc gitMinimal gnumake patch pkg-config python3\nmake -C depends -j10 NO_QT=1\ncmake -B build --toolchain /bitcoin/depends/<host-platform-triplet>/toolchain.cmake\n```\n\n### Relevant log output\n\n<details><summary>Example of a generated toolchain</summary>\n<p>\n\n```cmake\n# Copyright (c) 2023-present The Bitcoin Core developers\n# Distributed under the MIT software license, see the accompanying\n# file COPYING or https://opensource.org/license/mit/.\n\n# This file is expected to be highly volatile and may still change substantially.\n\n# If CMAKE_SYSTEM_NAME is set within a toolchain file, CMake will also\n# set CMAKE_CROSSCOMPILING to TRUE, even if CMAKE_SYSTEM_NAME matches\n# CMAKE_HOST_SYSTEM_NAME. To avoid potential misconfiguration of CMake,\n# it is best not to touch CMAKE_SYSTEM_NAME unless cross-compiling is\n# intended.\nif(FALSE)\n  set(CMAKE_SYSTEM_NAME Linux)\n  set(CMAKE_SYSTEM_VERSION 3.17.0)\n  set(CMAKE_SYSTEM_PROCESSOR x86_64)\n\n  set(CMAKE_C_COMPILER_TARGET x86_64-pc-linux-gnu)\n  set(CMAKE_CXX_COMPILER_TARGET x86_64-pc-linux-gnu)\n  set(CMAKE_OBJCXX_COMPILER_TARGET x86_64-pc-linux-gnu)\nendif()\n\nif(NOT DEFINED CMAKE_C_FLAGS_INIT)\n  set(CMAKE_C_FLAGS_INIT \"-pipe -std=c11\")\nendif()\nif(NOT DEFINED CMAKE_C_FLAGS_RELWITHDEBINFO_INIT)\n  set(CMAKE_C_FLAGS_RELWITHDEBINFO_INIT \"-O2\")\nendif()\nif(NOT DEFINED CMAKE_C_FLAGS_DEBUG_INIT)\n  set(CMAKE_C_FLAGS_DEBUG_INIT \"\")\nendif()\n\nif(NOT DEFINED CMAKE_C_COMPILER)\n  set(CMAKE_C_COMPILER clang)\nendif()\n\nif(NOT DEFINED CMAKE_CXX_FLAGS_INIT)\n  set(CMAKE_CXX_FLAGS_INIT \"-pipe -std=c++20\")\n  set(CMAKE_OBJCXX_FLAGS_INIT \"-pipe -std=c++20\")\nendif()\nif(NOT DEFINED CMAKE_CXX_FLAGS_RELWITHDEBINFO_INIT)\n  set(CMAKE_CXX_FLAGS_RELWITHDEBINFO_INIT \"-O2\")\n  set(CMAKE_OBJCXX_FLAGS_RELWITHDEBINFO_INIT \"-O2\")\nendif()\nif(NOT DEFINED CMAKE_CXX_FLAGS_DEBUG_INIT)\n  set(CMAKE_CXX_FLAGS_DEBUG_INIT \"\")\n  set(CMAKE_OBJCXX_FLAGS_DEBUG_INIT \"\")\nendif()\n\nif(NOT DEFINED CMAKE_CXX_COMPILER)\n  set(CMAKE_CXX_COMPILER clang++)\n  set(CMAKE_OBJCXX_COMPILER ${CMAKE_CXX_COMPILER})\nendif()\n\n# The DEPENDS_COMPILE_DEFINITIONS* variables are to be treated as lists.\nset(DEPENDS_COMPILE_DEFINITIONS )\nset(DEPENDS_COMPILE_DEFINITIONS_RELWITHDEBINFO )\nset(DEPENDS_COMPILE_DEFINITIONS_DEBUG )\n\nif(NOT DEFINED CMAKE_EXE_LINKER_FLAGS_INIT)\n  set(CMAKE_EXE_LINKER_FLAGS_INIT \"-fuse-ld=mold\")\nendif()\nif(NOT DEFINED CMAKE_SHARED_LINKER_FLAGS_INIT)\n  set(CMAKE_SHARED_LINKER_FLAGS_INIT \"-fuse-ld=mold\")\nendif()\nif(NOT DEFINED CMAKE_EXE_LINKER_FLAGS_RELWITHDEBINFO_INIT)\n  set(CMAKE_EXE_LINKER_FLAGS_RELWITHDEBINFO_INIT \"\")\nendif()\nif(NOT DEFINED CMAKE_SHARED_LINKER_FLAGS_RELWITHDEBINFO_INIT)\n  set(CMAKE_SHARED_LINKER_FLAGS_RELWITHDEBINFO_INIT \"\")\nendif()\nif(NOT DEFINED CMAKE_EXE_LINKER_FLAGS_DEBUG_INIT)\n  set(CMAKE_EXE_LINKER_FLAGS_DEBUG_INIT \"\")\nendif()\nif(NOT DEFINED CMAKE_SHARED_LINKER_FLAGS_DEBUG_INIT)\n  set(CMAKE_SHARED_LINKER_FLAGS_DEBUG_INIT \"\")\nendif()\n\nset(CMAKE_AR \"ar\")\nset(CMAKE_RANLIB \"ranlib\")\nset(CMAKE_STRIP \"strip\")\nset(CMAKE_OBJCOPY \"objcopy\")\nset(CMAKE_OBJDUMP \"objdump\")\n\n# Using our own built dependencies should not be\n# affected by a potentially random environment.\nset(CMAKE_FIND_USE_CMAKE_ENVIRONMENT_PATH OFF)\n\nset(CMAKE_FIND_ROOT_PATH \"${CMAKE_CURRENT_LIST_DIR}\")\nset(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)\nset(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)\nset(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)\nset(CMAKE_FIND_ROOT_PATH_MODE_PACKAGE ONLY)\nset(QT_TRANSLATIONS_DIR \"${CMAKE_CURRENT_LIST_DIR}/translations\")\n\nif(CMAKE_SYSTEM_NAME STREQUAL \"Darwin\" AND NOT CMAKE_HOST_APPLE)\n  # The find_package(Qt ...) function internally uses find_library()\n  # calls for all dependencies to ensure their availability.\n  # In turn, the find_library() inspects the well-known locations\n  # on the file system; therefore, a hint is required.\n  set(CMAKE_FRAMEWORK_PATH \"/System/Library/Frameworks\")\nendif()\n\n\nif(CMAKE_SYSTEM_NAME STREQUAL \"Linux\")\n  # Customize pkg-config behavior for finding dependencies\n  # of the xcb QPA platform plugin:\n  # 1. Restrict search paths to the depends.\n  # 2. Make output suitable for static linking.\n  cmake_path(APPEND CMAKE_CURRENT_LIST_DIR \"lib\" \"pkgconfig\" OUTPUT_VARIABLE pkg_config_path)\n  set(ENV{PKG_CONFIG_PATH} ${pkg_config_path})\n  set(ENV{PKG_CONFIG_LIBDIR} ${pkg_config_path})\n  unset(pkg_config_path)\n  set(PKG_CONFIG_ARGN --static)\nendif()\n\n\n# Set configuration options for the main build system.\nset(qt_packages  qt expat libxcb xcb_proto libXau xproto freetype fontconfig libxkbcommon libxcb_util libxcb_util_cursor libxcb_util_render libxcb_util_keysyms libxcb_util_image libxcb_util_wm  qrencode)\nif(\"${qt_packages}\" STREQUAL \"\")\n  set(BUILD_GUI OFF CACHE BOOL \"\")\nelse()\n  set(BUILD_GUI ON CACHE BOOL \"\")\n  set(Qt6_ROOT \"${CMAKE_CURRENT_LIST_DIR}\" CACHE PATH \"\")\nendif()\n\nset(qrencode_packages qrencode)\nif(\"${qrencode_packages}\" STREQUAL \"\")\n  set(WITH_QRENCODE OFF CACHE BOOL \"\")\nelse()\n  set(WITH_QRENCODE ON CACHE BOOL \"\")\nendif()\n\nset(zmq_packages zeromq)\nif(\"${zmq_packages}\" STREQUAL \"\")\n  set(WITH_ZMQ OFF CACHE BOOL \"\")\nelse()\n  set(WITH_ZMQ ON CACHE BOOL \"\")\nendif()\n\nset(wallet_packages bdb sqlite)\nif(\"${wallet_packages}\" STREQUAL \"\")\n  set(ENABLE_WALLET OFF CACHE BOOL \"\")\nelse()\n  set(ENABLE_WALLET ON CACHE BOOL \"\")\nendif()\n\nset(bdb_packages bdb)\nif(\"${wallet_packages}\" STREQUAL \"\" OR \"${bdb_packages}\" STREQUAL \"\")\n  set(WITH_BDB OFF CACHE BOOL \"\")\nelse()\n  set(WITH_BDB ON CACHE BOOL \"\")\nendif()\n\nset(usdt_packages systemtap)\nif(\"${usdt_packages}\" STREQUAL \"\")\n  set(WITH_USDT OFF CACHE BOOL \"\")\nelse()\n  set(WITH_USDT ON CACHE BOOL \"\")\nendif()\n\nif(\"\" STREQUAL \"1\")\n  set(ENABLE_IPC ON CACHE BOOL \"\")\n  set(MPGEN_EXECUTABLE \"${CMAKE_CURRENT_LIST_DIR}/native/bin/mpgen\" CACHE FILEPATH \"\")\n  set(CAPNP_EXECUTABLE \"${CMAKE_CURRENT_LIST_DIR}/native/bin/capnp\" CACHE FILEPATH \"\")\n  set(CAPNPC_CXX_EXECUTABLE \"${CMAKE_CURRENT_LIST_DIR}/native/bin/capnpc-c++\" CACHE FILEPATH \"\")\nelse()\n  set(ENABLE_IPC OFF CACHE BOOL \"\")\nendif()\n```\n\n</p>\n</details> \n\n\n<details><summary>Example cmake cache</summary>\n<p>\n\n```log\n# This is the CMakeCache file.\n# For build in directory: /home/will/src/core/bitcoin/build\n# It was generated by CMake: /nix/store/4kb60dy0dg80ww8gh2av4by4vwn8l48k-cmake-3.30.5/bin/cmake\n# You can edit this file to change values found and used by cmake.\n# If you do not want to change any of the values, simply exit the editor.\n# If you do want to change a value, simply edit, save, and exit the editor.\n# The syntax for the file is as follows:\n# KEY:TYPE=VALUE\n# KEY is the name of a variable in the cache.\n# TYPE is a hint to GUIs for the type of VALUE, DO NOT EDIT TYPE!.\n# VALUE is the current value for the KEY.\n\n########################\n# EXTERNAL cache entries\n########################\n\n//Build bitcoin-cli executable.\nBUILD_CLI:BOOL=ON\n\n//Build bitcoind executable.\nBUILD_DAEMON:BOOL=ON\n\n//Build bitcoin-qt executable.\nBUILD_GUI:BOOL=ON\n\n//Build experimental bitcoinkernel library.\nBUILD_KERNEL_LIB:BOOL=OFF\n\n//Build test_bitcoin and other unit test executables.\nBUILD_TESTS:BOOL=ON\n\n//Build bitcoin-tx executable.\nBUILD_TX:BOOL=ON\n\n//Build bitcoin-util executable.\nBUILD_UTIL:BOOL=ON\n\n//Build experimental bitcoin-chainstate executable.\nBUILD_UTIL_CHAINSTATE:BOOL=OFF\n\n//Value Computed by CMake\nBitcoinCore_BINARY_DIR:STATIC=/home/will/src/core/bitcoin/build\n\n//Value Computed by CMake\nBitcoinCore_IS_TOP_LEVEL:STATIC=ON\n\n//Value Computed by CMake\nBitcoinCore_SOURCE_DIR:STATIC=/home/will/src/core/bitcoin\n\n//Path to a program.\nCMAKE_ADDR2LINE:FILEPATH=/nix/store/l4bagvaywzkq3cbjd98rjkqwc0vkpxxw-clang-wrapper-19.1.3/bin/addr2line\n\n//Choose the type of build, options are: None Debug Release RelWithDebInfo\n// MinSizeRel ...\nCMAKE_BUILD_TYPE:STRING=RelWithDebInfo\n\n//LLVM archiver\nCMAKE_CXX_COMPILER_AR:FILEPATH=CMAKE_CXX_COMPILER_AR-NOTFOUND\n\n//`clang-scan-deps` dependency scanner\nCMAKE_CXX_COMPILER_CLANG_SCAN_DEPS:FILEPATH=/nix/store/zld513b4myr3yhs4yyjrcaxag5fcgd57-clang-tools-19.1.3/bin/clang-scan-deps\n\n//Generate index for LLVM archive\nCMAKE_CXX_COMPILER_RANLIB:FILEPATH=CMAKE_CXX_COMPILER_RANLIB-NOTFOUND\n\n//Flags used by the CXX compiler during all build types.\nCMAKE_CXX_FLAGS:STRING=-pipe -std=c++20\n\n//Flags used by the CXX compiler during DEBUG builds.\nCMAKE_CXX_FLAGS_DEBUG:STRING=-O0 -ftrapv -g3\n\n//Flags used by the CXX compiler during MINSIZEREL builds.\nCMAKE_CXX_FLAGS_MINSIZEREL:STRING=-Os\n\n//Flags used by the CXX compiler during RELEASE builds.\nCMAKE_CXX_FLAGS_RELEASE:STRING=-O2\n\n//Flags used by the CXX compiler during RELWITHDEBINFO builds.\nCMAKE_CXX_FLAGS_RELWITHDEBINFO:STRING=-O2 -O2 -g\n\n//Path to a program.\nCMAKE_DLLTOOL:FILEPATH=CMAKE_DLLTOOL-NOTFOUND\n\n//Flags used by the linker during all build types.\nCMAKE_EXE_LINKER_FLAGS:STRING=-fuse-ld=mold -fuse-ld=mold\n\n//Flags used by the linker during DEBUG builds.\nCMAKE_EXE_LINKER_FLAGS_DEBUG:STRING=\n\n//Flags used by the linker during MINSIZEREL builds.\nCMAKE_EXE_LINKER_FLAGS_MINSIZEREL:STRING=\n\n//Flags used by the linker during RELEASE builds.\nCMAKE_EXE_LINKER_FLAGS_RELEASE:STRING=\n\n//Flags used by the linker during RELWITHDEBINFO builds.\nCMAKE_EXE_LINKER_FLAGS_RELWITHDEBINFO:STRING=\n\n//Enable/Disable output of compile commands during generation.\nCMAKE_EXPORT_COMPILE_COMMANDS:BOOL=1\n\n//Value Computed by CMake.\nCMAKE_FIND_PACKAGE_REDIRECTS_DIR:STATIC=/home/will/src/core/bitcoin/build/CMakeFiles/pkgRedirects\n\n//Install path prefix, prepended onto install directories.\nCMAKE_INSTALL_PREFIX:PATH=/var/empty/local\n\n//Path to a program.\nCMAKE_LINKER:FILEPATH=/nix/store/l4bagvaywzkq3cbjd98rjkqwc0vkpxxw-clang-wrapper-19.1.3/bin/ld\n\n//Program used to build from build.ninja files.\nCMAKE_MAKE_PROGRAM:FILEPATH=/nix/store/nwsn9hg84pf9rpy3bgdpssa2b6qc7w3p-ninja-1.12.1/bin/ninja\n\n//Flags used by the linker during the creation of modules during\n// all build types.\nCMAKE_MODULE_LINKER_FLAGS:STRING=-fuse-ld=mold\n\n//Flags used by the linker during the creation of modules during\n// DEBUG builds.\nCMAKE_MODULE_LINKER_FLAGS_DEBUG:STRING=\n\n//Flags used by the linker during the creation of modules during\n// MINSIZEREL builds.\nCMAKE_MODULE_LINKER_FLAGS_MINSIZEREL:STRING=\n\n//Flags used by the linker during the creation of modules during\n// RELEASE builds.\nCMAKE_MODULE_LINKER_FLAGS_RELEASE:STRING=\n\n//Flags used by the linker during the creation of modules during\n// RELWITHDEBINFO builds.\nCMAKE_MODULE_LINKER_FLAGS_RELWITHDEBINFO:STRING=\n\n//Path to a program.\nCMAKE_NM:FILEPATH=/nix/store/l4bagvaywzkq3cbjd98rjkqwc0vkpxxw-clang-wrapper-19.1.3/bin/nm\n\n//Value Computed by CMake\nCMAKE_PROJECT_DESCRIPTION:STATIC=Bitcoin client software\n\n//Value Computed by CMake\nCMAKE_PROJECT_HOMEPAGE_URL:STATIC=https://bitcoincore.org/\n\n//Value Computed by CMake\nCMAKE_PROJECT_NAME:STATIC=BitcoinCore\n\n//Value Computed by CMake\nCMAKE_PROJECT_VERSION:STATIC=29.99.0\n\n//Value Computed by CMake\nCMAKE_PROJECT_VERSION_MAJOR:STATIC=29\n\n//Value Computed by CMake\nCMAKE_PROJECT_VERSION_MINOR:STATIC=99\n\n//Value Computed by CMake\nCMAKE_PROJECT_VERSION_PATCH:STATIC=0\n\n//Value Computed by CMake\nCMAKE_PROJECT_VERSION_TWEAK:STATIC=\n\n//Path to a program.\nCMAKE_READELF:FILEPATH=/nix/store/l4bagvaywzkq3cbjd98rjkqwc0vkpxxw-clang-wrapper-19.1.3/bin/readelf\n\n//Flags used by the linker during the creation of shared libraries\n// during all build types.\nCMAKE_SHARED_LINKER_FLAGS:STRING=-fuse-ld=mold -fuse-ld=mold\n\n//Flags used by the linker during the creation of shared libraries\n// during DEBUG builds.\nCMAKE_SHARED_LINKER_FLAGS_DEBUG:STRING=\n\n//Flags used by the linker during the creation of shared libraries\n// during MINSIZEREL builds.\nCMAKE_SHARED_LINKER_FLAGS_MINSIZEREL:STRING=\n\n//Flags used by the linker during the creation of shared libraries\n// during RELEASE builds.\nCMAKE_SHARED_LINKER_FLAGS_RELEASE:STRING=\n\n//Flags used by the linker during the creation of shared libraries\n// during RELWITHDEBINFO builds.\nCMAKE_SHARED_LINKER_FLAGS_RELWITHDEBINFO:STRING=\n\n//If set, runtime paths are not added when installing shared libraries,\n// but are added when building.\nCMAKE_SKIP_INSTALL_RPATH:BOOL=NO\n\n//If set, runtime paths are not added when using shared libraries.\nCMAKE_SKIP_RPATH:BOOL=NO\n\n//Flags used by the linker during the creation of static libraries\n// during all build types.\nCMAKE_STATIC_LINKER_FLAGS:STRING=\n\n//Flags used by the linker during the creation of static libraries\n// during DEBUG builds.\nCMAKE_STATIC_LINKER_FLAGS_DEBUG:STRING=\n\n//Flags used by the linker during the creation of static libraries\n// during MINSIZEREL builds.\nCMAKE_STATIC_LINKER_FLAGS_MINSIZEREL:STRING=\n\n//Flags used by the linker during the creation of static libraries\n// during RELEASE builds.\nCMAKE_STATIC_LINKER_FLAGS_RELEASE:STRING=\n\n//Flags used by the linker during the creation of static libraries\n// during RELWITHDEBINFO builds.\nCMAKE_STATIC_LINKER_FLAGS_RELWITHDEBINFO:STRING=\n\n//Path to a program.\nCMAKE_TAPI:FILEPATH=CMAKE_TAPI-NOTFOUND\n\n//The CMake toolchain file\nCMAKE_TOOLCHAIN_FILE:FILEPATH=/home/will/src/core/bitcoin/depends/x86_64-pc-linux-gnu/toolchain.cmake\n\n//If this value is on, makefiles will be generated without the\n// .SILENT directive, and all commands will be echoed to the console\n// during the make.  This is useful for debugging only. With Visual\n// Studio IDE projects all commands are done without /nologo.\nCMAKE_VERBOSE_MAKEFILE:BOOL=FALSE\n\nENABLE_IPC:BOOL=OFF\n\n//Enable wallet.\nENABLE_WALLET:BOOL=ON\n\n//Arguments to supply to pkg-config\nPKG_CONFIG_ARGN:STRING=--static\n\n//pkg-config executable\nPKG_CONFIG_EXECUTABLE:FILEPATH=/nix/store/f1gamyykr0f8n4afy910ass2jx2g9zkv-pkg-config-wrapper-0.29.2/bin/pkg-config\n\nQt6_ROOT:PATH=/home/will/src/core/bitcoin/depends/x86_64-pc-linux-gnu\n\n//Path to a file.\nSQLite3_INCLUDE_DIR:PATH=SQLite3_INCLUDE_DIR-NOTFOUND\n\n//Path to a library.\nSQLite3_LIBRARY:FILEPATH=SQLite3_LIBRARY-NOTFOUND\n\nWITH_BDB:BOOL=ON\n\nWITH_QRENCODE:BOOL=ON\n\nWITH_USDT:BOOL=ON\n\nWITH_ZMQ:BOOL=ON\n\n\n########################\n# INTERNAL cache entries\n########################\n\n//ADVANCED property for variable: CMAKE_ADDR2LINE\nCMAKE_ADDR2LINE-ADVANCED:INTERNAL=1\n//STRINGS property for variable: CMAKE_BUILD_TYPE\nCMAKE_BUILD_TYPE-STRINGS:INTERNAL=RelWithDebInfo;Debug;Release;MinSizeRel\n//This is the directory where this CMakeCache.txt was created\nCMAKE_CACHEFILE_DIR:INTERNAL=/home/will/src/core/bitcoin/build\n//Major version of cmake used to create the current loaded cache\nCMAKE_CACHE_MAJOR_VERSION:INTERNAL=3\n//Minor version of cmake used to create the current loaded cache\nCMAKE_CACHE_MINOR_VERSION:INTERNAL=30\n//Patch version of cmake used to create the current loaded cache\nCMAKE_CACHE_PATCH_VERSION:INTERNAL=5\n//Path to CMake executable.\nCMAKE_COMMAND:INTERNAL=/nix/store/4kb60dy0dg80ww8gh2av4by4vwn8l48k-cmake-3.30.5/bin/cmake\n//Path to cpack program executable.\nCMAKE_CPACK_COMMAND:INTERNAL=/nix/store/4kb60dy0dg80ww8gh2av4by4vwn8l48k-cmake-3.30.5/bin/cpack\n//Path to ctest program executable.\nCMAKE_CTEST_COMMAND:INTERNAL=/nix/store/4kb60dy0dg80ww8gh2av4by4vwn8l48k-cmake-3.30.5/bin/ctest\n//ADVANCED property for variable: CMAKE_CXX_COMPILER_AR\nCMAKE_CXX_COMPILER_AR-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_CXX_COMPILER_CLANG_SCAN_DEPS\nCMAKE_CXX_COMPILER_CLANG_SCAN_DEPS-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_CXX_COMPILER_RANLIB\nCMAKE_CXX_COMPILER_RANLIB-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_CXX_FLAGS\nCMAKE_CXX_FLAGS-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_CXX_FLAGS_DEBUG\nCMAKE_CXX_FLAGS_DEBUG-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_CXX_FLAGS_MINSIZEREL\nCMAKE_CXX_FLAGS_MINSIZEREL-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_CXX_FLAGS_RELEASE\nCMAKE_CXX_FLAGS_RELEASE-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_CXX_FLAGS_RELWITHDEBINFO\nCMAKE_CXX_FLAGS_RELWITHDEBINFO-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_DLLTOOL\nCMAKE_DLLTOOL-ADVANCED:INTERNAL=1\n//Executable file format\nCMAKE_EXECUTABLE_FORMAT:INTERNAL=ELF\n//ADVANCED property for variable: CMAKE_EXE_LINKER_FLAGS\nCMAKE_EXE_LINKER_FLAGS-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_EXE_LINKER_FLAGS_DEBUG\nCMAKE_EXE_LINKER_FLAGS_DEBUG-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_EXE_LINKER_FLAGS_MINSIZEREL\nCMAKE_EXE_LINKER_FLAGS_MINSIZEREL-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_EXE_LINKER_FLAGS_RELEASE\nCMAKE_EXE_LINKER_FLAGS_RELEASE-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_EXE_LINKER_FLAGS_RELWITHDEBINFO\nCMAKE_EXE_LINKER_FLAGS_RELWITHDEBINFO-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_EXPORT_COMPILE_COMMANDS\nCMAKE_EXPORT_COMPILE_COMMANDS-ADVANCED:INTERNAL=1\n//Name of external makefile project generator.\nCMAKE_EXTRA_GENERATOR:INTERNAL=\n//Name of generator.\nCMAKE_GENERATOR:INTERNAL=Ninja\n//Generator instance identifier.\nCMAKE_GENERATOR_INSTANCE:INTERNAL=\n//Name of generator platform.\nCMAKE_GENERATOR_PLATFORM:INTERNAL=\n//Name of generator toolset.\nCMAKE_GENERATOR_TOOLSET:INTERNAL=\n//Source directory with the top level CMakeLists.txt file for this\n// project\nCMAKE_HOME_DIRECTORY:INTERNAL=/home/will/src/core/bitcoin\n//Install .so files without execute permission.\nCMAKE_INSTALL_SO_NO_EXE:INTERNAL=0\n//ADVANCED property for variable: CMAKE_LINKER\nCMAKE_LINKER-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_MAKE_PROGRAM\nCMAKE_MAKE_PROGRAM-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_MODULE_LINKER_FLAGS\nCMAKE_MODULE_LINKER_FLAGS-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_MODULE_LINKER_FLAGS_DEBUG\nCMAKE_MODULE_LINKER_FLAGS_DEBUG-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_MODULE_LINKER_FLAGS_MINSIZEREL\nCMAKE_MODULE_LINKER_FLAGS_MINSIZEREL-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_MODULE_LINKER_FLAGS_RELEASE\nCMAKE_MODULE_LINKER_FLAGS_RELEASE-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_MODULE_LINKER_FLAGS_RELWITHDEBINFO\nCMAKE_MODULE_LINKER_FLAGS_RELWITHDEBINFO-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_NM\nCMAKE_NM-ADVANCED:INTERNAL=1\n//number of local generators\nCMAKE_NUMBER_OF_MAKEFILES:INTERNAL=1\n//Platform information initialized\nCMAKE_PLATFORM_INFO_INITIALIZED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_READELF\nCMAKE_READELF-ADVANCED:INTERNAL=1\n//Path to CMake installation.\nCMAKE_ROOT:INTERNAL=/nix/store/4kb60dy0dg80ww8gh2av4by4vwn8l48k-cmake-3.30.5/share/cmake-3.30\n//ADVANCED property for variable: CMAKE_SHARED_LINKER_FLAGS\nCMAKE_SHARED_LINKER_FLAGS-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_SHARED_LINKER_FLAGS_DEBUG\nCMAKE_SHARED_LINKER_FLAGS_DEBUG-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_SHARED_LINKER_FLAGS_MINSIZEREL\nCMAKE_SHARED_LINKER_FLAGS_MINSIZEREL-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_SHARED_LINKER_FLAGS_RELEASE\nCMAKE_SHARED_LINKER_FLAGS_RELEASE-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_SHARED_LINKER_FLAGS_RELWITHDEBINFO\nCMAKE_SHARED_LINKER_FLAGS_RELWITHDEBINFO-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_SKIP_INSTALL_RPATH\nCMAKE_SKIP_INSTALL_RPATH-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_SKIP_RPATH\nCMAKE_SKIP_RPATH-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_STATIC_LINKER_FLAGS\nCMAKE_STATIC_LINKER_FLAGS-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_STATIC_LINKER_FLAGS_DEBUG\nCMAKE_STATIC_LINKER_FLAGS_DEBUG-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_STATIC_LINKER_FLAGS_MINSIZEREL\nCMAKE_STATIC_LINKER_FLAGS_MINSIZEREL-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_STATIC_LINKER_FLAGS_RELEASE\nCMAKE_STATIC_LINKER_FLAGS_RELEASE-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_STATIC_LINKER_FLAGS_RELWITHDEBINFO\nCMAKE_STATIC_LINKER_FLAGS_RELWITHDEBINFO-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: CMAKE_TAPI\nCMAKE_TAPI-ADVANCED:INTERNAL=1\n//uname command\nCMAKE_UNAME:INTERNAL=/nix/store/k48bha2fjqzarg52picsdfwlqx75aqbb-coreutils-9.5/bin/uname\n//ADVANCED property for variable: CMAKE_VERBOSE_MAKEFILE\nCMAKE_VERBOSE_MAKEFILE-ADVANCED:INTERNAL=1\n//Test CXX_SUPPORTS__FTRAPV\nCXX_SUPPORTS__FTRAPV:INTERNAL=1\n//Test CXX_SUPPORTS__G3\nCXX_SUPPORTS__G3:INTERNAL=1\n//Test CXX_SUPPORTS__WERROR\nCXX_SUPPORTS__WERROR:INTERNAL=1\n//Test LINKER_SUPPORTS__FTRAPV\nLINKER_SUPPORTS__FTRAPV:INTERNAL=1\n//Test LINKER_SUPPORTS__G3\nLINKER_SUPPORTS__G3:INTERNAL=1\nPC_SQLite3_CFLAGS:INTERNAL=\nPC_SQLite3_CFLAGS_I:INTERNAL=\nPC_SQLite3_CFLAGS_OTHER:INTERNAL=\nPC_SQLite3_FOUND:INTERNAL=\nPC_SQLite3_INCLUDEDIR:INTERNAL=\nPC_SQLite3_LIBDIR:INTERNAL=\nPC_SQLite3_LIBS:INTERNAL=\nPC_SQLite3_LIBS_L:INTERNAL=\nPC_SQLite3_LIBS_OTHER:INTERNAL=\nPC_SQLite3_LIBS_PATHS:INTERNAL=\nPC_SQLite3_MODULE_NAME:INTERNAL=\nPC_SQLite3_PREFIX:INTERNAL=\nPC_SQLite3_STATIC_CFLAGS:INTERNAL=\nPC_SQLite3_STATIC_CFLAGS_I:INTERNAL=\nPC_SQLite3_STATIC_CFLAGS_OTHER:INTERNAL=\nPC_SQLite3_STATIC_LIBDIR:INTERNAL=\nPC_SQLite3_STATIC_LIBS:INTERNAL=\nPC_SQLite3_STATIC_LIBS_L:INTERNAL=\nPC_SQLite3_STATIC_LIBS_OTHER:INTERNAL=\nPC_SQLite3_STATIC_LIBS_PATHS:INTERNAL=\nPC_SQLite3_VERSION:INTERNAL=\nPC_SQLite3_sqlite3_INCLUDEDIR:INTERNAL=\nPC_SQLite3_sqlite3_LIBDIR:INTERNAL=\nPC_SQLite3_sqlite3_PREFIX:INTERNAL=\nPC_SQLite3_sqlite3_VERSION:INTERNAL=\n//ADVANCED property for variable: PKG_CONFIG_ARGN\nPKG_CONFIG_ARGN-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: PKG_CONFIG_EXECUTABLE\nPKG_CONFIG_EXECUTABLE-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: SQLite3_INCLUDE_DIR\nSQLite3_INCLUDE_DIR-ADVANCED:INTERNAL=1\n//ADVANCED property for variable: SQLite3_LIBRARY\nSQLite3_LIBRARY-ADVANCED:INTERNAL=1\n//linker supports push/pop state\n_CMAKE_LINKER_PUSHPOP_STATE_SUPPORTED:INTERNAL=FALSE\n__pkg_config_checked_PC_SQLite3:INTERNAL=1\n```\n\n\n</p>\n</details> \n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nmaster@885b4bc8b59d1cbbaea519207f715eab447cc0ff\n\n### Operating system and version\n\nNixOS 25.05 (Warbler) x86_64\n\n### Machine specifications\n\n_No response_",
      "state": "closed",
      "user": "willcl-ark",
      "created_at": "2025-05-06T15:31:32Z",
      "updated_at": "2025-06-25T10:37:43Z",
      "comments": 21,
      "url": "https://github.com/bitcoin/bitcoin/issues/32428",
      "labels": [
        "Build system"
      ]
    },
    {
      "number": 32426,
      "title": "external signer: PSBT error code `EXTERNAL_SIGNER_NOT_FOUND` is never returned",
      "body": "The error code [`PSBTError::EXTERNAL_SIGNER_NOT_FOUND`](https://github.com/bitcoin/bitcoin/blob/baa848b8d38187ce6b24a57cfadf1ea180209711/src/common/types.h#L20) is never returned anywhere in our codebase, hence code that handles it (currently done [only in the GUI](https://github.com/bitcoin/bitcoin/blob/baa848b8d38187ce6b24a57cfadf1ea180209711/src/qt/sendcoinsdialog.cpp#L458)) is effectively dead. I have never looked deeper into external signing, but at a first glance the two obvious logical choices would be to either:\n* simply get rid of this error code and its handling (if e.g. a more generic error thrown in this case already provides enough information to the user)\n* implement the returning of the error condition; the areas that need to be touched are likely [`ExternalSignerScriptPubKeyMan::GetExternalSigner`](https://github.com/bitcoin/bitcoin/blob/baa848b8d38187ce6b24a57cfadf1ea180209711/src/wallet/external_signer_scriptpubkeyman.cpp#L48) and its call-site in `::FillPSBT` below\n\n(Noticed while reviewing #31622, where new PSBTError codes are added in the third commit)",
      "state": "closed",
      "user": "theStack",
      "created_at": "2025-05-06T13:25:25Z",
      "updated_at": "2025-06-17T00:33:20Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/32426",
      "labels": [],
      "comment_list": [
        {
          "user": "naiyoma",
          "body": "\n> * simply get rid of this error code and its handling (if e.g. a more generic error thrown in this case already provides enough information to the user)\n> * implement the returning of the error condition; the areas that need to be touched are likely [`ExternalSignerScriptPubKeyMan::GetExternalSigner`](https://github.com/bitcoin/bitcoin/blob/baa848b8d38187ce6b24a57cfadf1ea180209711/src/wallet/external_signer_scriptpubkeyman.cpp#L48) and its call-site in `::FillPSBT` below\n\nI'm in favour of   deleting [PSBTError::EXTERNAL_SIGNER_NOT_FOUND](https://github.com/bitcoin/bitcoin/blob/baa848b8d38187ce6b24a57cfadf1ea180209711/src/common/types.h#L20)\n\nI've tested the error on [GetExternalSigner](https://github.com/bitcoin/bitcoin/blob/baa848b8d38187ce6b24a57cfadf1ea180209711/src/wallet/external_signer_scriptpubkeyman.cpp#L53) in both `walletdisplayaddress` and `walletprocesspsbt` it seems sufficient to me.\n```\nbitcoin-cli -regtest -rpcwallet=hww_working walletprocesspsbt \"$PSBT\"\nerror code: -1\nerror message:\nGetExternalSigner: No external signers found\n```\n```\nbitcoin-cli -regtest -rpcwallet=hww_working walletdisplayaddress $ADDRESS\nerror code: -1\nerror message:\nGetExternalSigner: No external signers found\n```\n\nEven if we return `PSBTError::EXTERNAL_SIGNER_NOT_FOUND;`  in `ExternalSignerScriptPubKeyMan::FillPSBT` we'll still need to keep the error in GetExternalSigner, since it's also useful in other call sites.\n\n maybe the intention of having `PSBTError::EXTERNAL_SIGNER_NOT_FOUND`   error was to have a more PSBT-specific error,  But honestly, that doesn't seem very necessary.\n\n\nI tried returning from FillPSBT directly, and it's possible to do that without touching GetExternalSigner. But I still think deleting is the better approach\n\n\n``` diff\n-    if (finalize) FinalizePSBT(psbt); // This won't work in a multisig setup\n+\n+    try {\n+        ExternalSigner signer = GetExternalSigner();\n+        if(!signer.SignTransaction(psbt, strFailReason)) {\n+            tfm::format(std::cerr, \"Failed to sign: %s\\n\", strFailReason);\n+            return PSBTError::EXTERNAL_SIGNER_FAILED;\n+        }\n+    } catch (const std::runtime_error& e) {\n+        return PSBTError::EXTERNAL_SIGNER_NOT_FOUND;\n+    }\n+    if (finalize) {\n+        FinalizePSBT(psbt); // This won't work in a multisig setup\n+\n+    }\n\n```\n",
          "created_at": "2025-06-03T10:52:30Z"
        },
        {
          "user": "fanquake",
          "body": "@hebasto @Sjors ",
          "created_at": "2025-06-03T11:05:21Z"
        },
        {
          "user": "Sjors",
          "body": "I made a note to refactor `GetExternalSigner()` and `ExternalSignerScriptPubKeyMan::FillPSBT` so the latter can return `PSBTError::EXTERNAL_SIGNER_NOT_FOUND`.\n\nWe call GetExternalSigner in three scenarios:\n\n1. During initial wallet setup to fetch keys from the device\n2. When attempting to display an address on the device\n3. When signing a PSBT\n\nFor scenario (1) and (2) the current `std::runtime_error` approach seems fine.\n\nIn particular scenario (1) is unlikely, and definitely an error, if a user unplugs their device right after we fetched its name (via `ExternalSigner::Enumerate`).\n\nScenario (2) is more likely to occur if e.g. they plug in their device, forget to unlock it, or somehow HWI can't find it.\n\nThat leaves (3) which is more nuanced. The external signer interface \"officially\" only supports single signature setup, but my longer term ambition still is to make this work well in multisig. And that's where we should use `PSBTError::EXTERNAL_SIGNER_NOT_FOUND`.\n\nCoincidentally I ran into the `No external signers found` std::error during recent MuSig2 testing. Let's say you have a 2-of-2 setup with one key from Bitcoin Core and one from an external signer, and a delayed fallback where either can sign. Normally it's an error when the device isn't present, but for the fallback it's not.\n\nI'm not entirely sure yet how such a case should be handled. The signing code doesn't know that the user lost their hardware wallet, and we don't want to accidentally publish a `scriptPath` spend since that hurts privacy and is more expensive.\n\nOne approach could be that if `PSBTError::EXTERNAL_SIGNER_NOT_FOUND` is returned, we ask the user whether they want to try again or if we should only sign the fallback condition.\n\n---\n\nIt looks like I introduced `TransactionError::EXTERNAL_SIGNER_NOT_FOUND` in d4b0107d68a91ed4d1a5c78c8ca76251329d3f3c as part of #16546, followed by https://github.com/bitcoin-core/gui/pull/4 that renders them. But no code actually triggered the error. I'm not sure why. Perhaps an earlier iteration did use them, but browsing through some of those versions I don't see it. Neither did the immediate followup https://github.com/bitcoin/bitcoin/pull/16378.",
          "created_at": "2025-06-04T08:58:38Z"
        },
        {
          "user": "Sjors",
          "body": "Fixed in #32682. It has the nice benefit of actually using the existing translations for \"External signer not found\".",
          "created_at": "2025-06-05T10:08:57Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 6,
    "issues": 2
  }
}