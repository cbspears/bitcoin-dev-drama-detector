{
  "source": "github",
  "repo": "bitcoin/bitcoin",
  "fetched_at": "2026-02-05T08:36:27.211871+00:00",
  "date_range": {
    "since": "2026-01-29T08:36:27.211802+00:00",
    "until": "2026-02-05T08:36:27.211802+00:00"
  },
  "pull_requests": [
    {
      "id": 3096470479,
      "number": 34057,
      "title": "test: add tests for cluster chunks",
      "body": "Add tests for cluster chunks, including:\r\n    - GetWorstMainChunk() tests, which picks the worst chunk from txgraph.\r\n    - GetCurrentChunk(), which returns chunks in linearization order after calling it iteratively.\r\n",
      "state": "open",
      "user": "HowHsu",
      "created_at": "2025-12-12T13:04:16Z",
      "updated_at": "2026-02-05T08:33:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34057",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 253,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2940741002,
      "number": 33689,
      "title": "http: replace WorkQueue and single threads handling for ThreadPool",
      "body": "This has been a recent discovery; the general thread pool class created for #26966, cleanly \r\nintegrates into the HTTP server. It simplifies init, shutdown and requests execution logic.\r\nReplacing code that was never unit tested for code that is properly unit and fuzz tested.\r\nAlthough our functional test framework extensively uses this RPC interface (that’s how\r\nwe’ve been ensuring its correct behavior so far - which is not the best).\r\n\r\nThis clearly separates the responsibilities:\r\nThe HTTP server now focuses solely on receiving and dispatching requests, while ThreadPool handles\r\nconcurrency, queuing, and execution.\r\n\r\nThis will also allows us to experiment with further performance improvements at the task queuing and\r\nexecution level, such as a lock-free structure or task prioritization or any other implementation detail\r\nlike coroutines in the future, without having to deal with HTTP code that lives on a different layer.\r\n\r\nNote:\r\nThe rationale behind introducing the ThreadPool first is to be able to easily cherry-pick it across different\r\nworking paths. Some of the ones that are benefited from it are #26966 for the parallelization of the indexes\r\ninitial sync, #31132 for the parallelization of the inputs fetching procedure, #32061 for the libevent replacement,\r\nthe kernel API #30595 (https://github.com/bitcoin/bitcoin/pull/30595#discussion_r2413702370) to avoid blocking validation among others use cases not publicly available.\r\n\r\nNote 2:\r\nI could have created a wrapper around the existing code and replaced the `WorkQueue` in a subsequent\r\ncommit, but it didn’t seem worth the extra commits and review effort. The `ThreadPool` implements\r\nessentially the same functionality in a more modern and cleaner way.",
      "state": "open",
      "user": "furszy",
      "created_at": "2025-10-23T14:36:44Z",
      "updated_at": "2026-02-05T08:26:01Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33689",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1804,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3243034362,
      "number": 34495,
      "title": "Replace boost signals with minimal compatible implementation",
      "body": "This drops our dependency on `boost::signals2`, leaving `boost::multi_index` as the only remaining boost dependency for bitcoind.\r\n\r\n`boost::signals2` is a complex beast, but we only use a small portion of it. Namely: it's a way for multiple subscribers to connect to the same event, and the ability to later disconnect individual subscribers from that event.\r\n\r\n`btcsignals` adheres to the subset of the `boost::signals2` API that we currently use, and thus is a drop-in replacement. Rather than implementing a complex `slot` tracking class that we never used anyway (and which was much more useful in the days before std::function existed), callbacks are simply wrapped directly in `std::function`s.\r\n\r\nThe new tests work with either `boost::signals2` or the new `btcsignals` implementation. Reviewers can verify\r\nfunctional equivalency by running the tests in the commit that introduces them against `boost::signals2`, then again with `btcsignals`.\r\n\r\nThe majority of the commits in this PR are preparation and cleanup. Once `boost::signals2` is no longer needed, it is removed from depends. Additionally, a few CMake targets no longer need boost includes as they were previously only required for signals.\r\n\r\nI think this is actually pretty straightforward to review. I kept things simple, including keeping types unmovable/uncopyable where possible rather than trying to define those semantics. In doing so, the new implementation has even fewer type requirements than boost, which I believe is due to a boost bug. I've opened a PR upstream for that to attempt to maintain parity between the implementations.\r\n\r\nSee individual commits for more details.\r\n\r\nCloses #26442.",
      "state": "open",
      "user": "theuni",
      "created_at": "2026-02-03T21:27:43Z",
      "updated_at": "2026-02-05T08:14:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34495",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1736,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3248824084,
      "number": 34508,
      "title": "test: fix intermittent failure in interface_zmq.py",
      "body": "Add retry mechanism to handle race conditions where ZMQ notifications aren't immediately available after blockchain operations, preventing zmq.error.Again exceptions that cause test failures on slower systems.\r\n\r\nFixes #34189\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "open",
      "user": "Hijanhv",
      "created_at": "2026-02-05T06:52:05Z",
      "updated_at": "2026-02-05T08:04:24Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34508",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 2342,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3241907915,
      "number": 34492,
      "title": "ci: Drop valgrind fuzz from GHA matrix",
      "body": "The valgrind fuzz task is problematic, because:\r\n\r\n* It is redundant with the msan fuzz task, which has std lib hardening enabled, so often UB is diagnosed before it even happens in the valgrind task.\r\n* All issues so far found by the valgrind fuzz task were also found by the hardened msan fuzz task.\r\n* All other issues were false-positives, which are hard to debug, and confusing and tedious to work around.\r\n\r\nI don't think there is any value in asking pull request authors to debug valgrind false-positives that they triggered by accident. So remove the task for now.\r\n\r\nI know that there are some devs, who like to keep the task, but if the task is kept, it should come with clear instructions on how to deal with false-postives in pull requests.\r\n\r\nI am not proposing to remove the config itself, and I am happy to continue maintaining it, like it was done before. However, as of now, running it in the GHA matrix is of negative or questionable benefit.\r\n",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-02-03T16:12:11Z",
      "updated_at": "2026-02-05T07:55:33Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34492",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1001,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3245237633,
      "number": 34502,
      "title": "wallet: remove most asserts of `WALLET_FLAG_DESCRIPTORS` flag",
      "body": "Reasons:\r\n1. Few of the wallet methods are descriptors specific as suggested\r\nby their names, these assertions seems redundant within them.\r\n2. Since the legacy wallet can't be loaded anymore, few of these\r\nassertions are outdated now.\r\n3. Seeing too many of these assertions in the `CWallet` class while\r\nreading the code is cognitively loaded, and after a while becomes\r\nannoying for the reader.\r\n\r\nNote: Such assertions in the migration specific functions have been\r\nleft untouched because they seem necessary there.\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "open",
      "user": "rkrux",
      "created_at": "2026-02-04T10:42:07Z",
      "updated_at": "2026-02-05T07:40:58Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34502",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 2647,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3176535463,
      "number": 34299,
      "title": "wallet: remove PreSelectedInputs and re-activate \"AmountWithFeeExceedsBalance\" error",
      "body": "picks up https://github.com/bitcoin/bitcoin/pull/25269.\r\n\r\nThis PR re-implements the code path so that an error message is thrown when a transaction's total amount (including fees) exceeds the available balance. It also refactors the wallet's coin selection code.\r\n\r\n1. the first 3 commits are unrelated to the code but few small bug fixes which are nice to fix. but also kind of impacts the remaining logic. (could PR separately if reviewers wish)\r\n\t1. c467325aaf187d7f056bb1ea1cec6b7c4250af2e: make `total_effective_amount` optional actually optional\r\n\t2. 2202ab597596c84fc49f8784e823372b7a9efcbe: ensure `set<shared_ptr<COutput>>` has unique COutput\r\n\t3. a5ffbbf122d66fc4ad9b2e7c6d7d1dfa1816388e: Correctly reserve size when flattening `CoinsResult.coins` map to vector\r\n\r\n3. the next 3 commits from 4745d5480ca5c3809edd51140e4d2c0433582844 replace the `PreSelectedInputs` struct with `CoinsResult` and removes `PreSelectedInputs`.\r\n\r\n4. the last commit (e664484a6d34c1795ebb0925ab31faea5d64ab00) deals with the error message - `AmountWithFeeExceedsBalance` error inside `WalletModel::prepareTransaction` is never thrown and remains an unused code path. This is because `createTransaction` does not retrieve the fee when the process fails. The fee return arg is set only at the end of the process, when the transaction is successfully created. Therefore, if the transaction creation fails, the fee is not available inside `WalletModel::prepareTransaction` to trigger the `AmountWithFeeExceedsBalance` error.\r\n\r\nThis PR re-implements the feature inside `CreateTransactionInternal` and adds test coverage for it.\r\n\r\n| on master | on PR |\r\n|-----------|-------|\r\n| <img src=\"https://github.com/user-attachments/assets/a903e687-2466-42c7-b898-5dec24bfe515\" width=\"750\" alt=\"Insufficient funds\" /> | <img src=\"https://github.com/user-attachments/assets/74bb3c83-6132-4c09-91f0-0a446618b3c8\" width=\"750\" alt=\"AmountWithFeeExceedsBalance\" /> |\r\n\r\nthe unreachable code path is removed in https://github.com/bitcoin-core/gui/pull/807 which requires this PR.\r\n",
      "state": "open",
      "user": "stratospher",
      "created_at": "2026-01-15T09:06:21Z",
      "updated_at": "2026-02-05T07:37:24Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34299",
      "labels": [
        "Wallet",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2138,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2972930823,
      "number": 33772,
      "title": "prevector: simplify implementation of comparison operators and match behavior of `std::vector`",
      "body": "The reduced amount of code reduces maintenance. Providing `prevector::operator<=>` allows classes that are implemented in terms of `prevector` to use the compiler provided `operator<=>`.\r\n\r\nHowever, **there is a breaking change**!\r\n\r\nThe old implementation claims to be a drop-in replacement for `std::vector`. However, the implementation for `operator<` is different when comparing two vectors of different length, as can be presented with the following code:\r\n\r\n```cpp\r\nint main()\r\n{\r\n    auto const v12 = std::vector{1, 2};\r\n    auto const v3 = std::vector{3};\r\n\r\n    auto const pv12 = prevector<4, int>(v12.begin(), v12.end());\r\n    auto const pv3 = prevector<4, int>(v3.begin(), v3.end());\r\n\r\n    assert((v12 < v3) == (pv12 < pv3));\r\n}\r\n```\r\n\r\nWith the old implementation of `prevector`, the assertion fails. With my change, it passes.\r\nI ask the reviewers to confirm whether this change in behavior is acceptable or not.",
      "state": "open",
      "user": "purpleKarrot",
      "created_at": "2025-11-03T14:23:43Z",
      "updated_at": "2026-02-05T07:06:35Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33772",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1021,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2997112498,
      "number": 33847,
      "title": "kernel: Improve logging API",
      "body": "Simplify kernel logging API and try to connect it to the rest of the kernel API by letting log options be set on `Logger` objects directly and `Logger` objects to be associated with `Context` objects directly. Also drop `logging_disable()` function and avoid having library accumulate log messages in a 1MB buffer by default.\r\n\r\nChanges are intended to make the API a little less surprising and more future proof. Rationale is described in some more detail the commit message.\r\n\r\nThis change is not backwards compatible but I'd expect it to port over pretty smoothly to the language bindings, and offer the same benefits for them as for C/C++ callers.\r\n\r\n",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2025-11-10T23:30:46Z",
      "updated_at": "2026-02-05T06:31:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33847",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 683,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2999254279,
      "number": 33854,
      "title": "fix assumevalid is ignored during reindex",
      "body": "During a reindex, the assumevalid setting may be ignored if the chainwork of the best header is below `minimumchainwork`. This happens when the previous IBD was stopped before connecting enough blocks to reach the required `minimumchainwork`. The assumevalid block will also be missing from the block index because the assumevalid block is set to match the `minimumchainwork`. See [Issue #31494](https://github.com/bitcoin/bitcoin/issues/31494).\r\n\r\nAs a result, `reindex` can take significantly longer to complete than necessary.\r\n\r\nThis PR addresses the issue by modifying reindex behaviour: if the chainwork of the `best_header` is below `minimumchainwork`, the node skips the `ActivateBestChain()` step and proceeds directly to synchronisation.\r\n\r\nThis PR takes a different approach from [PR #31615](https://github.com/bitcoin/bitcoin/pull/31615) to keep the validation path for `reindex` the same as the regular IBD validation path.\r\n\r\nDevelopers benchmarking IBD with `-reindex` may find this behaviour undesirable. In such cases, it’s recommended to use `-reindex-chainstate` instead or ensure that the available blocks have sufficient chainwork.\r\n\r\n`libbitcoinkernel` exposes the `ImportBlocks` function and expects `reindex` to connect blocks, so an attempt was made to preserve the existing behaviour for `libbitcoinkernel`.",
      "state": "open",
      "user": "Eunovo",
      "created_at": "2025-11-11T14:21:14Z",
      "updated_at": "2026-02-05T06:18:01Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33854",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1375,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3248565295,
      "number": 34507,
      "title": "doc: improve clarity in setup description",
      "body": "This PR improves documentation clarity in the setup section by simplifying sentence structure.\r\nNo functional changes.\r\n\r\n",
      "state": "closed",
      "user": "rehna-jp",
      "created_at": "2026-02-05T05:10:35Z",
      "updated_at": "2026-02-05T05:58:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34507",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 164,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3034182041,
      "number": 33922,
      "title": "mining: add getMemoryLoad() and track template non-mempool memory footprint",
      "body": "Implements a way to track the memory footprint of all non-mempool transactions that are still being referenced by block templates, see discussion in  #33899. It does not impose a limit.\r\n\r\nIPC clients can query this footprint (total, across all clients) using the `getMemoryLoad()` IPC method. Its client-side usage is demonstrated here:\r\n- https://github.com/stratum-mining/sv2-tp/pull/63\r\n\r\nAdditionally, the functional test in `interface_ipc.py` is expanded to demonstrate how template memory management works: templates are not released until the client drops references to them, or calls the template destroy method, or disconnects. The destroy method is called automatically by clients using [libmultiprocess](https://github.com/bitcoin-core/libmultiprocess), as [sv2-tp](https://github.com/stratum-mining/sv2-tp) does. In the Python tests it also happens when references are destroyed or go out of scope.\r\n\r\nThe PR starts with preparation refactor commits:\r\n\r\n1. Tweaks `interface_ipc.py` so `destroy()` calls happen in an order that's useful to later demonstrate memory management\r\n2. Change `std::unique_ptr<BlockTemplate> block_template` from a `static` defined in `rpc/mining.cpp` to `NodeContext`. This prevents a crash when we switch to a non-trivial destructor later (which uses `m_node`).\r\n\r\nThen the main commits:\r\n\r\n3. Add `template_tx_refs` to `NodeContext` to track how many templates contain any given transaction. This map is updated by the `BlockTemplate` constructor and destructor.\r\n4. Add `GetTemplateMemoryUsage()` which loops over this map and sums up the memory footprint for transactions outside the mempool\r\n5. Expose this information to IPC clients via `getMemoryLoad()` and add test coverage\r\n",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-21T15:34:14Z",
      "updated_at": "2026-02-05T05:11:47Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33922",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1801,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3039837291,
      "number": 33936,
      "title": "mining: pass missing context to createNewBlock() and checkBlock()",
      "body": "Adding a `context` parameter ensures that these methods are run in their own thread and don't block other calls.\r\n\r\nFor `createNewBlock()` this is not expected to have much impact, because block template creation is fast.\r\n\r\nFor `checkBlock()` this ensures that if we receive a slow to validate block from an untrusted origin (the IPC connection itself is assumed to trusted), it will not block the IPC server. But since validation itself blocks `cs_main` this is also not a huge performance win.\r\n\r\nThis is a breaking change both ways:\r\n- clients must use the updated capnp file\r\n- updated clients can't call these methods on an unupgraded node\r\n\r\n---\r\n\r\nBecause it's a breaking change, but not really important, this PR is marked pending some other more important breaking change. See #33777.",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2025-11-24T12:36:43Z",
      "updated_at": "2026-02-05T04:46:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33936",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 860,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3054115118,
      "number": 33965,
      "title": "mining: fix -blockreservedweight shadows IPC option",
      "body": "Also enforce `MINIMUM_BLOCK_RESERVED_WEIGHT` for IPC clients.\r\n\r\nThe `-blockreservedweight` startup option should only affect RPC code, because IPC clients (currently) do not have a way to signal their intent to use the node default (the `BlockCreateOptions` struct defaults merely document a recommendation for client software).\r\n\r\nBefore this PR however, if the user set `-blockreservedweight` then `ApplyArgsManOptions` would cause the `block_reserved_weight` option passed by IPC clients to be ignored. _Users who don't set this value were not affected._\r\n\r\nFix this by making BlockCreateOptions::block_reserved_weight an std::optional.\r\n\r\nInternal interface users, such as the RPC call sites, don't set a value so -blockreservedweight is used. Whereas IPC clients do set a value which is no longer ignored.\r\n\r\nTest coverage is added, with a preliminary commit that refactors the `create_block_template` and `wait_next_template` helpers.\r\n\r\n`mining_basic.py` already ensured `-blockreservedweight` is enforced by mining RPC methods. The second commit adds coverage for Mining interface IPC clients. It also verifies that `-blockreservedweight` has no effect on them.\r\n\r\nThe third commit enforces `MINIMUM_BLOCK_RESERVED_WEIGHT` for IPC clients. Previously lower values were quietly clamped.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-28T13:38:33Z",
      "updated_at": "2026-02-05T04:31:57Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33965",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1346,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3070554287,
      "number": 34004,
      "title": "Implementation of SwiftSync",
      "body": "Link to the original protocol writeup found [here](https://gist.github.com/RubenSomsen/a61a37d14182ccd78760e477c78133cd). See the [Delving Bitcoin post](https://delvingbitcoin.org/t/swiftsync-speeding-up-ibd-with-pre-generated-hints-poc/1562) for initial works and discussion.\r\n\r\n# Motivation\r\n\r\nWhile many coins are available in cache when spent, every cache miss requires a trip to the disk. Memory can be scarce for single board machines, so cache misses are expected to be far more frequent. A trip to disk is all-the-more severe on low end hardware, so any minimization of disk interactions can speed up initial block download for limited resource devices. One such example may be a block template provider serving a home miner.\r\n\r\n# Intuition\r\n\r\nThe vast majority of coins created are later spent. The cost of this observation is many coins will be written to disk, only to be removed later. The SwiftSync protocol alleviates the problem by recording what coins have been added and removed with a small, in-memory aggregate. This allows for the removal of intermediate coin states until SwiftSync has completed. The state of the aggregate is verified at a predetermined chain height, and IBD continues as usual thereafter.\r\n\r\nFor any chain height, we know `all outputs - all inputs = UTXO set`, which is equivalently `all outputs - UTXO set = all inputs`. The goal is to verify the set `all outputs - UTXO set` is equal to `all inputs`. Addition and subtraction modulo a field offers a way to do so. For any set, if we add all elements of the set and subtract them, regardless of ordering, we will arrive at zero. In the current implementation, the set elements being compared are hashed outpoints.\r\n\r\nThe SwiftSync protocol is comprised of two structures. First, the aggregate that will record the state of what outpoints have been added (created) or subtracted (spent). Next, notice that the UTXO set must be reported in order to verify `all outputs - UTXO set = all inputs`. SwiftSync introduces a hints file, which may be provided to the client at startup. This hints file is nothing more than a pointer to each unspent output by recording the block height and the indexes that will remain unspent. By using this file, a client may omit outpoints that will be in the UTXO set when updating the aggregate. Note this file is not trusted. If a malicious actor provides a faulty UTXO set, the set comparison above will fail, and the client may begin a reindex.\r\n# Implementation\r\n\r\n## Aggregate\r\n\r\nThe hash aggregate takes outpoints, hashes them with a salted hasher, and updates 4, 64-bit limbs with wrapping modulo arithmetic. The choice of 4, 64-bit limbs with no carries between limbs was made to: 1. minimize code complexity within the aggregate 2. conform to existing APIs, namely `uint256`. After adding and subtracting some arbitrary list of outpoints, we may poll if the sets were equivalent with `IsZero`.\r\n## Hintsfile\r\n\r\nThe hints file is a map of block height to the indexes of the outputs in that block that _will_ be in the UTXO set. To construct this file for a particular UTXO set state, each block must be read and queried to find the outputs in that block that remain unspent. Because this is a read-only operation, this may be done on parallel threads in the future. To allow for parallelization, the hints file contains a \"contents\" section, which denotes the height and corresponding file position to find the hints for that block.\r\n\r\nTo save space when representing the indexes that remain unspent in a block, an easy choice is to take the difference between the last coin that was unspent and the next one in the block. AFICT this is a version of run-length-encoding. These indexes are encoded using `compactSize` to further save space, the run-lengths should normally fit into at least 16 bits, often 8 bits.\r\n## Parameter Interaction\r\n\r\nA side effect of omitting intermediate UTXO states while performing IBD is the \"undo data\" cannot be derived. There are already configurations that do not have full undo data history, namely pruned nodes. To avoid additional complexity in this PR, this version of accelerated IBD is only made available to pruned nodes, as the undo data would have been removed regardless of the this setting.\r\n\r\nOther parameter interactions, not yet implemented:\r\n- `assumeutxo`: Startup should fail if both are configured. A hints file will have no effect, as the UTXO set is already present.\r\n- `assumevalid`: A natural choice is to only allow SwiftSync when using `assumevalid`, and to only allow a hints file that commits to the `assumevalid` block. Similar to `assumeutxo`, a hash of the hints file may be committed to in the binary, which would be resistant to griefing attacks.\r\n# Testing [Linux example]\r\n\r\nIn your `bitcoin` directory, download the hints from the test server:\r\n\r\n```bash\r\ncurl -o signet.hints https://utxohints.store/hints/signet\r\n```\r\n\r\nVerify the hash of the file:\r\n\r\n```bash\r\necho \"2b625392ecb2adba2b5f9d7b00c8f3a8adca0d3c  signet.hints\" | sha1sum --check -\r\n```\r\n\r\nBuild the branch:\r\n\r\n```bash\r\ncmake -B build && cmake --build build -j $(nproc)\r\n```\r\n\r\nRemove existing chain state:\r\n\r\n```bash\r\nrm -rf ~/.bitcoin/signet/\r\n```\r\n\r\nProvide the file at startup:\r\n\r\n```bash\r\n./build/bin/bitcoind --chain=signet --utxohints=./signet.hints --prune=550\r\n```\r\n\r\n# Open Questions\r\n\r\n- Given the outcome of SwiftSync is pass/fail, and there is no use of intermediate states, should blocks be persisted to disk at all during the protocol?\r\n- To what degree should a hints file be committed to in the binary. No commitment allows for a server to provide hints for an arbitrary height, providing a convenience for the client, but opens up the possibility of a grief attack. Of course the server risks losing reputation for serving faulty files.\r\n\r\n# Future Iteration\r\n\r\nThis is the first iteration of the SwiftSync proposal, however more optimizations may be made. Namely, because set elements may be added or subtracted from the aggregate in any order, blocks may be downloaded in parallel from multiple peers. If you are interested in benchmarking the performance of a fully-parallel version, see the [Rust implementation](https://github.com/2140-dev/swiftsync).\r\n",
      "state": "open",
      "user": "rustaceanrob",
      "created_at": "2025-12-04T09:50:39Z",
      "updated_at": "2026-02-05T03:23:16Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34004",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 1,
        "text_length": 6261,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2420947155,
      "number": 32150,
      "title": "coinselection: Optimize BnB exploration",
      "body": "This PR rewrites the implementation of the BnB coinselection algorithm\r\nto skip the duplicate evaluation of previously visited input selections.\r\n\r\nIn the original implementation of BnB, the state of the search is\r\nbacktracked by explicitly walking back to the omission branch and then\r\ntesting again. This retests an equivalent candidate set as before, e.g.,\r\nafter backtracking from {ABC}, it would evaluate {AB_}, before trying\r\n{AB_D}, but {AB_} is equivalent to {AB} which was tested before.\r\n\r\nCoinGrinder tracks the state of the search instead by remembering which\r\nUTXO was last added and explicitly shifting from that UTXO directly to\r\nthe next, so after {ABC}, it will immediately move on to {AB_D}. We\r\nreplicate this approach here.\r\n\r\nAs fewer nodes are visited, this approach will enumerate more possible\r\ncombinations than the original implementation given the same limit for \r\niterations.",
      "state": "open",
      "user": "murchandamus",
      "created_at": "2025-03-27T02:33:51Z",
      "updated_at": "2026-02-05T03:09:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32150",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 943,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3088060609,
      "number": 34038,
      "title": "logging: API improvements",
      "body": "A few changes:\r\n\r\n * Provide `STDLOCK(m_cs)` instead of `StdLockGuard g(m_cs)` for the logging mutexes, so that we can get better warnings from clang if annotations have been missed\r\n * Allow writing `LogInfo(BCLog::NO_RATE_LIMIT, \"log message\")` to avoid rate limiting, rather than having to supply a false argument to `LogPrintLevel_(...)`\r\n * Replace the `-loglevel` parameter with a new `-trace` parameter that works the same as `-debug`\r\n * Change the `logging` RPC to allow enabling trace debugging, and to differentiate trace vs debug levels\r\n ",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2025-12-10T05:56:20Z",
      "updated_at": "2026-02-05T02:27:50Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34038",
      "labels": [
        "Needs release note"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 577,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3247139518,
      "number": 34506,
      "title": "doc: fix a -> an grammar in comments",
      "body": "Fix \"a\" → \"an\" grammar before words starting with vowels in code comments:\r\n\r\n- `src/txgraph.cpp`: \"a an_clusters\" → \"an an_clusters\"\r\n- `src/node/txdownloadman_impl.cpp`: \"a orphan\" → \"an orphan\"\r\n- `src/node/txorphanage.cpp`: \"a OrphanInfo\" → \"an OrphanInfo\"",
      "state": "closed",
      "user": "jayvaliya",
      "created_at": "2026-02-04T19:21:01Z",
      "updated_at": "2026-02-05T01:58:11Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34506",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 297,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3221659481,
      "number": 34439,
      "title": "qa: Drop recursive deletes from test code, add lint checks.",
      "body": "Both `fs::remove_all` and `shutil::rmtree()` are a bit dangerous, and most of their uses are not necessary, this PR removes most instances of both.\r\n\r\n`remove_all()` is still used in in `src/test/util/setup_common.cpp` as part of `BasicTestingSetup::BasicTestingSetup`'s constructor and destructor, and it is used in the kernel test code's [`TestDirectory`](https://github.com/bitcoin/bitcoin/blob/4ae00e9a7183cb15877c3014bf46f2e36470c304/src/test/kernel/test_kernel.cpp#L100-L112):\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/734899a4c404f24379d0597744465c147d9ad024/src/test/kernel/test_kernel.cpp#L100-L112\r\n\r\nIn both cases, `remove_all` is likely necessary, but the kernel's test code is RAII, ideally `BasicTestingSetup` could be made similar in a follow-up or in this PR if reviewers think it is important.\r\n\r\nSimilarly in the python code, most usage was unnecessary, but there are a few places where `rmtree()` was necessary, I have added sanity checks to make sure these are inside of the `tmpdir` before doing recursive delete there.",
      "state": "open",
      "user": "davidgumberg",
      "created_at": "2026-01-29T03:59:52Z",
      "updated_at": "2026-02-05T01:55:43Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34439",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1101,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2797425845,
      "number": 33300,
      "title": "fuzz: compact block harness",
      "body": "Posting up to get feedback, there are some design flaws with the approach in this PR. Coverage is [here](https://crypt-iq.github.io/fuzz_coverage_reports/cmpctblock-aflpp-inputs-09182025/) (look in `src/blockencodings.cpp`, relevant compact block bits in `src/net_processing.cpp`).\r\n\r\nThis harness can make (in)valid blocks, reconstruct blocks with in-mempool txns, mark peers as HB, and has high stability in AFL++ (~98-99%).\r\n\r\nThe main downside is that there are filesystem operations. In the `.init` function `initialize_cmpctblock`, a chain of 200 blocks is created. Each fuzzing iteration then copies this statically-named, \"cached\" data directory to a temporary directory that gets deleted at the end of the iteration. If each fuzzing iteration instead mines its own chain, the execs/s slows down to a crawl (~0.5/s or less, which would also make CI runs really slow).",
      "state": "open",
      "user": "Crypt-iQ",
      "created_at": "2025-09-03T22:33:44Z",
      "updated_at": "2026-02-05T00:55:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33300",
      "labels": [
        "Tests",
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 903,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3119599294,
      "number": 34124,
      "title": "refactor: make `CCoinsView` a purely virtual abstract base class",
      "body": "### Problem\r\n`CCoinsView` serves as the interface for the coins database layer, but historically had a dual nature that caused confusion:\r\n\r\n* It provided default noop implementations (returning `std::nullopt`, `uint256()`, `false`, `nullptr`) instead of being pure virtual\r\n* Callers could instantiate a bare `CCoinsView` and get silent no-op behavior\r\n* Mixing the interface definition with a built-in dummy implementation blurred the abstraction boundary\r\n\r\n### Context\r\n\r\nThis is part of ongoing coins caching cleanup efforts such as #34132, #33866, #33018, and #33512.\r\n\r\n### Fix\r\n\r\nThis PR makes `CCoinsView` a pure abstract interface and introduces an explicit noop implementation, in tiny incremental steps to ease review:\r\n\r\n* Add `CCoinsViewEmpty` as an explicit noop coins view for tests, benchmarks, and dummy backends\r\n* Replace all direct `CCoinsView` instantiations with `CCoinsViewEmpty`\r\n* Incrementally make all `CCoinsView` methods pure virtual (`GetCoin`, `GetBestBlock`, `BatchWrite`, `EstimateSize`, `Cursor`, `GetHeadBlocks`, `HaveCoin`)\r\n* Remove the legacy default implementations from `coins.cpp`\r\n* Update the coins view fuzzer to switch between a real database-backed view and `CCoinsViewEmpty`\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-12-20T08:47:33Z",
      "updated_at": "2026-02-05T00:19:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34124",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1289,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3120160595,
      "number": 34132,
      "title": "coins: fail fast on database read deserialization errors",
      "body": "### Problem\r\n\r\nThe current coins database read-error handling adds unnecessary complexity to the critical path:\r\n* `CCoinsViewErrorCatcher` sits between the cache and database views, wrapping every read operation with a generic error handler\r\n* `ExecuteBackedWrapper` adds another function call layer with lambda captures on each database read\r\n*  Uses `std::vector<std::function<void()>>` for callbacks when there's only ever one callback registered\r\n*  The error callback is set after database initialization rather than during construction (requiring a `cs_main` lock)\r\n\r\nThis adds unnecessary stack depth and bookkeeping overhead on every coins database read operation (`GetCoin`). Also note that `CCoinsViewDB::HaveCoin` isn't even called from production code as far as I can tell.\r\n\r\n### Context\r\n\r\nThis is part of ongoing coins caching cleanup efforts like #34124, #33866, #33018, and #33512.\r\n\r\n### Fix\r\n\r\n**Behavior change:** Let deserialization exceptions propagate from `CDBWrapper::Read()` instead of catching and returning `false`. This makes corruption visible - exceptions propagate to `CCoinsViewDB::GetCoin()` which calls `std::abort()` with a clear error message. \r\n                                                                                                                        \r\n**Simplification:** With exceptions now propagating correctly, collapse the `CCoinsViewErrorCatcher` layer entirely and move error handling directly into `CCoinsViewDB`:\r\n* Remove `ExecuteBackedWrapper` and `CCoinsViewErrorCatcher`, placing try-catch blocks directly in `CCoinsViewDB::GetCoin` and `CCoinsViewDB::HaveCoin`\r\n  * this enabled making all coins view lookups as `noexcept`\r\n* Replace `std::vector<std::function<void()>>` with a single `std::function<void()>` member, initialized in the constructor\r\n* The read error callback is now passed to `Chainstate::InitCoinsDB` and forwarded to `CCoinsViewDB` constructor\r\n\r\nA new test verifies the node aborts with a clear error message on database corruption.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-12-20T22:56:45Z",
      "updated_at": "2026-02-05T00:05:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34132",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2076,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3239542097,
      "number": 34490,
      "title": "wallet: Follow-ups to create/load split (#32636)",
      "body": "This adds documentation for `PopulateWalletFromDB()` and improves documentation for `LoadExisting()` and `CreateNew()`, and makes `WalletBatch::WriteVersion(int client_version)` respect the argument that it's passed, addressing issues reviewers pointed in #32636.",
      "state": "open",
      "user": "davidgumberg",
      "created_at": "2026-02-03T06:02:55Z",
      "updated_at": "2026-02-04T23:40:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34490",
      "labels": [
        "Wallet",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 312,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3132300728,
      "number": 34158,
      "title": "torcontrol: Remove libevent usage",
      "body": "This is part of the effort to remove the libevent dependency from our code base: https://github.com/bitcoin/bitcoin/issues/31194\r\n\r\nThe current approach tries to reuse existing code and follows roughly similar design decisions. It replaces the libevent-based async I/O with blocking I/O utilizing the existing `Sock` and `CThreadInterrupt`. The controller runs in a dedicated thread.\r\n\r\nThere are some optional code modernizations thrown in made along the way (namings, constexpr etc.). These are not strictly necessary but make the end result with the new code more consistent.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2025-12-27T14:20:31Z",
      "updated_at": "2026-02-04T23:14:35Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34158",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 612,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3133212525,
      "number": 34165,
      "title": "coins: don't mutate main cache when connecting block",
      "body": "This is a slightly modified version of the first few commits of #31132, which can be merged as an independent change. It has a small benefit on its own, but will help in moving the parent PR forward.\r\n\r\nWhen accessing coins via the `CCoinsViewCache`, methods like `GetCoin` can call `FetchCoin` which actually mutate `cacheCoins` internally to cache entries when they are pulled from the backing db. This is generally a performance improvement for single threaded access patterns, but it precludes us from accessing entries in a `CCoinsViewCache` from multiple threads without a lock.\r\n\r\nAnother aspect is that when we use the resettable `CCoinsViewCache` view backed by the main cache for use in `ConnectBlock()`, we will insert entries into the main cache even if the block is determined to be invalid. This is not the biggest concern, since an invalid block requires proof-of-work. But, an attacker could craft multiple invalid blocks to fill the main cache. This would make us `Flush` the cache more often than necessary. Obviously this would be very expensive to do on mainnet.\r\n\r\nIntroduce `CoinsViewOverlay`, a `CCoinsViewCache` subclass that reads coins without mutating the underlying cache via `FetchCoin()`.\r\n\r\nAdd `PeekCoin()` to look up a Coin through a stack of `CCoinsViewCache` layers without populating parent caches. This prevents the main cache from caching inputs pulled from disk for a block that has not yet been fully validated. Once `Flush()` is called on the view, these inputs will be added as spent to `coinsCache` in the main cache via `BatchWrite()`.\r\n\r\nThis is the foundation for async input fetching, where worker threads must not mutate shared state.\r\n",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2025-12-28T20:32:34Z",
      "updated_at": "2026-02-04T23:02:15Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34165",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1737,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2683376326,
      "number": 33034,
      "title": "wallet: Store transactions in a separate sqlite table",
      "body": "The wallet uses SQLite as a key-value store even though SQLite is a powerful relational database engine. This causes us numerous headaches due to the need to serialize multiple fields together, and since record read from the database during loading can come in any order.\r\n\r\nNotably, for transactions, if we were able to load them in the transaction order assigned by the wallet, PRs like #27865 would be a bit simpler and easier to reason about.\r\n\r\nThis PR makes it possible for us to do that by storing transactions in a separate table. This table has a column for each field in `CWalletTx`, which lets us use a SQL statement like `SELECT * FROM transactions ORDER BY pos` which guarantees us the order in which the transactions are loaded into the wallet.\r\n\r\nThe eventual goal is to use SQLite as a relational database with tables that store our keys and other metadata that can reference each other so that the wallet doesn't just use the database as a storage mechanism. But that is still a work in progress.\r\n\r\nThis PR makes use of the last client opened features introduced in #32895 to determine when the old record style needs to be upgraded to the new transactions table. This should give us sufficient upgrade-downgrade-upgrade handling to not lose any funds.\r\n\r\nDepends on #32763, #32895, #32985, #33032, #33033",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-07-21T22:52:54Z",
      "updated_at": "2026-02-04T22:48:15Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33034",
      "labels": [
        "Wallet",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1377,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3142897675,
      "number": 34193,
      "title": "wallet: make migration more robust against failures",
      "body": "This is just me finding a few more edge cases after #34156 and #34176\r\n\r\nThe goal of the PR is to handle failures in a controlled way. Just so the process can automatically restore the original wallet without requiring user manual intervention.\r\n\r\nThe covered cases are:\r\n\r\n1. During `DoMigration()`: There are methods that can throw exceptions and abruptly abort the process. \r\nInstead of crashing (GUI) or returning a generic exception, we now will catch and return the error gracefully. This lets the process restore the original wallet automatically.\r\n\r\n2. Trying to migrate a wallet in a read-only directory throws a filesystem exception and skips cleanup.\r\n Now the process will fail gracefully with a clear error msg, and automatically restore the original wallet.\r\n\r\n3. Any failure during `MigrateToSQLite` requires user manual intervention. \r\nNow the original wallet db will remain untouched, and only be updated once the sqlite db creation fully succeeds.",
      "state": "open",
      "user": "furszy",
      "created_at": "2026-01-02T20:59:40Z",
      "updated_at": "2026-02-04T22:46:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34193",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1017,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3135104327,
      "number": 34176,
      "title": "wallet: crash fix, handle non-writable db directories",
      "body": "Make wallet creation and load fail with a clear error when the db directory isn’t writable.\r\n\r\n#### 1) For Wallet Creation\r\n\r\nBefore: creating a wallet would return a generic error:\r\n\"SQLiteDatabase: Failed to open database: unable to open database file\"\r\n\r\nAfter: creating a wallet returns:\r\n\"SQLiteDatabase: Failed to open database in directory <dir_path>: directory is not writable\"\r\n\r\n#### 2) For Wallet Loading\r\n\r\nWe currently allow loading wallets located on non-writable directories. This is problematic\r\nbecause the node crashes on any subsequent write; generating a block is enough to trigger it.\r\nCan be verified just by running the following test on master: https://github.com/furszy/bitcoin-core/commit/85fa4e2910f0a8f43d4ee5a1322cbb69656d85e9 \r\n\r\nAlso, to check directory writability, this creates a tmp file rather than relying on the\r\n`permissions()` functions, since perms bits alone may not reliably reflect actual writability\r\nin some systems.\r\n\r\nTesting Note:\r\nPushed the tests in separate commits so they can be cherry-picked on master for comparison.",
      "state": "open",
      "user": "furszy",
      "created_at": "2025-12-29T19:44:56Z",
      "updated_at": "2026-02-04T22:40:28Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34176",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1125,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1587218477,
      "number": 28792,
      "title": "build: Embedded ASMap [3/3]: Build binary dump header file",
      "body": "This is the final in a series of PRs that implement the necessary changes for embedding of asmap data into the binary. This last part add the initial asmap data, implements the build changes and adds further documentation.\r\n\r\nCurrently an asmap file needs to be acquired by there user from some location or the user needs to generate one themselves. Then they need to move the file to the right place in datadir or pass the path to the file as `-asmap=PATH` in order to use the asmap feature. The change here allows for builds to embed asmap data into the bitcoind binary which makes it possible to use the feature without handling of the asmap file by the user. If the user starts bitcoind with `-asmap` the embedded data will be used for bucketing of nodes.\r\n\r\nThe data lives in the repository at `src/node/data/ip_asn.dat` and can be replaced with a new version at any time. The idea is that the data should be updated with every release. By default the data at that location is embedded into the binary but there is also a build option to prevent this (`-DWITH_EMBEDDED_ASMAP=OFF`). In this case the original behavior of the `-asmap` option is maintained.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2023-11-04T22:13:31Z",
      "updated_at": "2026-02-04T22:30:05Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28792",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1218,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3136708013,
      "number": 34181,
      "title": "refactor: [p2p] Make ProcessMessage private again, Use references when non-null",
      "body": "There is a single unit test, which calls the internal `ProcessMessage` function. This is problematic, because it makes future changes harder, since they will need to carry over this public internal interface each time.\r\n\r\nAlso, there is a mixed use of pointers and references in p2p code, where just based on context, a pointer may sometimes assumed to be null, or non-null. This is confusing when reading the code, or making or reading future changes.\r\n\r\nFix both issues in a series of commits, to:\r\n\r\n* refactor the single unit test to call higher-level functions\r\n* Make `ProcessMessage` private again\r\n* Use references instead of implicit non-null pointers, mostly in a scripted-diff",
      "state": "open",
      "user": "maflcko",
      "created_at": "2025-12-30T12:31:30Z",
      "updated_at": "2026-02-04T22:27:25Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34181",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 767,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3138438378,
      "number": 34184,
      "title": "mining: add cooldown to createNewBlock() immediately after IBD",
      "body": "_This PR makes a breaking change to the Mining interface._\r\n\r\nAs reported in #33994, connected mining clients will receive a flood of new templates if the node is still going through IBD or catching up on the last 24 hours. This PR fixes that using an _optional_ cooldown mechanism, only applied to `createNewBlock()`.\r\n\r\nFirst, cooldown waits for IBD. Then, as the tip keeps moving forward, it waits a few seconds to see if the tip updated. If so, it restarts the timer and waits again. The trade-offs for this mechanism are explained below.\r\n\r\nBecause this PR changes `createNewBlock()` from a method that returns quickly to one that can block for minutes, the first commit fixes a bug in our `.capnp` definition, adding the missing `context` to `createNewBlock` (and `checkBlock`). It's an improved version of #33936.\r\n\r\nThis is a breaking API change, so it bumps the `makeMining` version and throws a nice error for older clients. That's tested in the functional test, and I also saw it with the sv2 Rust client. It may be possible to instead work around the existing bug and avoid the breaking change, but I don't think that's worth the efort and potential confusion at this point.\r\n\r\nThe second commit introduces the actual cooldown mechanism.\r\n\r\nThe third then adds an `interrupt()` method so that clients can cleanly disconnect.\r\n\r\n---\r\n\r\n## Rationale\r\n\r\nThe cooldown argument is optional, and not used by internal non-IPC code, for two reasons:\r\n\r\n1. The mechanism wreaks havoc on the functional test suite, which would require very careful mock time handling to work around. But that's pointless, because only IPC clients need it.\r\n2. It needs to be optional for IPC clients too, because in some situations, like a signet with only one miner, waiting for IBD can mean being stuck forever.\r\n\r\nThe reason it's only applied to `createNewBlock()` is that this is the first method called by clients; `waitNext()` is a method on the interface returned by `createNewBlock()`, at which point the cooldown is done.\r\n\r\nAfter IBD, we wait N seconds if the header is N blocks ahead of the tip, with a minimum of 3 and a maximum of 20 seconds. The minimum waiting time is short enough that it shouldn't be annoying or confusing for someone manually starting up a client. While the maximum should be harmless if it happens spuriously (which it shouldn't).\r\n\r\nIf the minimum wait is too short, clients get a burst of templates, as observed in the original issue. We can't entirely rule this out without a lot of additional complexity (like scanning our own log file for heuristics). This PR should make it a lot less likely, and thanks to the IBD wait also limit it to one day worth of blocks (`-maxtipage`).\r\n\r\nSome test runs on an M4 MacBook Pro, where I had a node catch up on the last few days worth of blocks:\r\n\r\n<img width=\"872\" height=\"972\" alt=\"Scherm­afbeelding 2026-02-04 om 18 21 17\" src=\"https://github.com/user-attachments/assets/7902a0f2-0e0b-4604-9688-cec2da073261\" />\r\n\r\nAs the chart shows, sometimes it takes longer than 3 seconds. But it turns out that in all those cases there were quite a few headers ahead of the tip. It also demonstrates that it's important to first wait for IBD, because it's less likely a random tip update takes longer than 20 seconds.\r\n\r\n- modified sv2-apps: https://github.com/Sjors/sv2-apps/tree/2026/02/cooldown\r\n- test script: https://gist.github.com/Sjors/feb6122c97acc2b9e6d66b168614609c#file-run_mainnet_pool_loop-zsh\r\n- chart script: https://gist.github.com/Sjors/feb6122c97acc2b9e6d66b168614609c#file-tip_interval_charts-py",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-12-31T05:17:32Z",
      "updated_at": "2026-02-04T22:14:25Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34184",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 3633,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2647467829,
      "number": 32894,
      "title": "FUZZ: Test that BnB finds best solution",
      "body": "BnB’s solution is the input set with the lowest waste score, excluding any supersets of other solution candidates.\r\nThis fuzz test compares a brute force search with the BnB result to ensure that BnB succeeds.",
      "state": "open",
      "user": "murchandamus",
      "created_at": "2025-07-07T17:34:08Z",
      "updated_at": "2026-02-04T22:01:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32894",
      "labels": [
        "Tests",
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 249,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2550873429,
      "number": 32636,
      "title": "Split `CWallet::Create()` into `CreateNew` and `LoadExisting`",
      "body": "This PR is mostly a refactor which splits out logic used for creating wallets and for loading wallets, both of which are presently contained in `CWallet::Create()` into `CWallet::CreateNew()` and `CWallet::LoadExisting()`\r\n\r\nThe real win of this PR is that `CWallet::Create()` uses a very bad heuristic for trying to guess whether or not it is supposed to be creating a new wallet or loading an existing wallet:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/370c59261269fd9043674e0f4fd782a89e724473/src/wallet/wallet.cpp#L2882-L2885\r\n\r\nThis heuristic assumes that wallets with no `ScriptPubKeyMans` are being created, which sounds reasonable, but as demonstrated in #32112 and #32111, this can happen when the user tries to load a wallet file that is corrupted, both issues are fixed by this PR and any other misbehavior for wallet files which succeeded the broken heuristic's sniff test for new wallets.\r\n\r\nIt was already the case that every caller of `CWallet::Create()` knows whether it is creating a wallet or loading one, so we can avoid replacing this bad heuristic with another one, and just shift the burden to the caller.",
      "state": "closed",
      "user": "davidgumberg",
      "created_at": "2025-05-29T00:37:09Z",
      "updated_at": "2026-02-04T21:49:45Z",
      "merged_at": "2026-02-04T19:07:02Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32636",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1189,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3149207404,
      "number": 34208,
      "title": "bench: add fluent API for untimed `setup` steps in nanobench",
      "body": "### Context\r\nAs described in https://github.com/martinus/nanobench/issues/130, we have a few benchmarks where we have to reset the state between runs, otherwise the repetitions will do something else than the first iteration.\r\n\r\n### Upstream\r\nI have opened a PR to `nanobench` to introduce an untimed setup phase, see: https://github.com/martinus/nanobench/pull/136\r\nUnfortunately the author has health issues and couldn't contribute to it in the past 2 years.\r\n\r\n### Tests\r\n\r\nTests were only added upstream, would be a bit awkward to wire in `nanobench.h` outside the benchmarking setup:\r\nhttps://github.com/martinus/nanobench/pull/136/changes/58350cfe5912d7e0533ccfcd759eea5d62eb55bb#diff-88160f647ce57661afe7d755fa70a5fa342a2b79d72d3511596878e69ed5cdc3\r\n\r\n### Fix\r\nI have moved the changes here as well and applied it to a few simple benchmarks as demonstration.\r\nWe can revert ones that are controversial and add other ones in follow-ups, this PR is mostly meant to add the `setup` feature.\r\n\r\n### Benchmarks\r\nMost benchmarks show a modest \"speedup\", others a \"slowdown\" - but it's only the effect of the setup that's not measured anymore - and a `run` phase which does the same operation in each epoch iteration (wallet benchmark changes were reverted since for simplicity):\r\n<img width=\"1496\" height=\"882\" alt=\"image\" src=\"https://github.com/user-attachments/assets/34c14565-f3df-41e5-9a86-95b2ca21703a\" />\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-06T11:45:35Z",
      "updated_at": "2026-02-04T21:33:47Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34208",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1475,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 236926309,
      "number": 14893,
      "title": "0.17 [Backport 14890] rpc: Avoid creating non-standard raw transactions",
      "body": "",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2018-12-07T16:38:42Z",
      "updated_at": "2026-02-04T21:26:41Z",
      "merged_at": "2018-12-24T12:06:46Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/14893",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 72,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2647773300,
      "number": 32895,
      "title": "wallet: Prepare for future upgrades by recording versions of last client to open and decrypt",
      "body": "When a wallet is automatically upgraded, we always do so in a way that allows the user to load their wallet in an older version. When the user loads their wallet into an upgraded version again, the wallet may not perform the automatic upgrade and end up with upgraded and non-upgraded material in the wallet.\r\n\r\nIf we write some information about the last client to open the wallet, we would be able to detect these upgrade-downgrade-upgrade situations and perform another upgrade if so. However, in order for this to work, we need to have implemented writing such information into versions prior to the ones which introduce new automatic upgrades.\r\n\r\nWe are already writing the CLIENT_VERSION into all wallets in a \"version\" record, although this record is not updated in the same way across all previous versions. Since v24.0, we are always updating the record when the client version differs, but prior to that, the record would only be updated when the client version is newer. Even so, we can use this record to store the last client version.\r\n\r\nThe first commit decouples the written client version from the node version. This aids in development of new features. The version is entirely decoupled from previous versions by requiring all versions to have bit 30 set, and the initial version being `0 | (1 << 30)`. The versions just need to be at least 299900, and forcing bit 30 to be set was an easy way to achieve this.\r\n\r\nHowever, using version numbers is not as flexible as feature flags, so the second commit introduces the concept of Wallet Client Features. These flags are distinct from the existing Wallet Feature Flags since they are conceptually different. These are written in a separate record, and the wallet client version is incremented to `(1 << 0) | (1 << 30)`.\r\n\r\nLastly, since some upgrades may need private keys and can only occur after the wallet is decrypted, the third commit also adds a last decrypted features flags record to record the features of the last client to decrypt the wallet.\r\n\r\nThe result is that we will now be able to detect a downgrade down to v24.0 and be able to implement in parallel multiple features that require automatic upgrades.",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-07-07T20:13:08Z",
      "updated_at": "2026-02-04T21:03:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32895",
      "labels": [
        "Wallet",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2277,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3210348402,
      "number": 34410,
      "title": "test: let connections happen in any order in p2p_private_broadcast.py",
      "body": "If the following two events happen:\r\n\r\n* (likely) the automatic 10 initial connections are not made to all \r\n  networks\r\n* (unlikely) the network-specific logic kicks in almost immediately.\r\n  It is using exponential distribution with a mean of 5 minutes\r\n  (`rng.rand_exp_duration(EXTRA_NETWORK_PEER_INTERVAL)`).\r\n\r\nSo if both happen, then the 11th connection may not be the expected\r\nprivate broadcast, but a network-specific connection.\r\n\r\nFix this by retrieving the connection type from\r\n`destinations_factory()`. This is more flexible because it allows\r\nconnections to happen in any order and does not break if e.g. the 11th\r\nconnection is not the expected first private broadcast.\r\n\r\nThis also makes the test run faster:\r\nbefore: 19-44 sec \r\nnow: 10-25 sec \r\nbecause for example there is no need to wait for the initial 10\r\nautomatic outbound connections to be made in order to proceed.\r\n\r\nFixes: https://github.com/bitcoin/bitcoin/issues/34387\r\n",
      "state": "open",
      "user": "vasild",
      "created_at": "2026-01-26T12:05:26Z",
      "updated_at": "2026-02-04T20:51:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34410",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1022,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 112846431,
      "number": 10102,
      "title": "Multiprocess bitcoin",
      "body": "<!-- begin based-on -->\n**This is based on #29409.** The non-base commits are:\n\n- [`93f471464dd` test: Increase feature_block.py and feature_taproot.py timeouts](https://github.com/bitcoin/bitcoin/pull/10102/commits/93f471464dda67bf59ec474979e5e04989616ff2)\n- [`9c2f8ce25b2` test: Fix multiprocess test for unclean shutdown on kill](https://github.com/bitcoin/bitcoin/pull/10102/commits/9c2f8ce25b263eddcd5e33986626e98d5f391430)\n- [`3582e4a12a3` util: Add util::Result workaround to be compatible with libmultiprocess](https://github.com/bitcoin/bitcoin/pull/10102/commits/3582e4a12a341376e0fcb1d67cda5cc510bb1ae9)\n- [`f1d2d87c6d8` multiprocess: Add capnp serialization code for bitcoin types](https://github.com/bitcoin/bitcoin/pull/10102/commits/f1d2d87c6d87c58749f0f2fb100e184a3ab11303)\n- [`65e4390dcaa` interfaces, refactor: Change WalletLoader::restoreWallet parameter order](https://github.com/bitcoin/bitcoin/pull/10102/commits/65e4390dcaa23ab347a832e3f1ff130650efd2be)\n- [`0e436699c59` multiprocess: Add capnp wrapper for Wallet interface](https://github.com/bitcoin/bitcoin/pull/10102/commits/0e436699c59b537a5948389613dacb5c68fc2872)\n- [`0381cc5dc99` multiprocess: Add capnp wrapper for Node interface](https://github.com/bitcoin/bitcoin/pull/10102/commits/0381cc5dc999795aa1f5bcb77e8d429a9f5221e6)\n- [`88f3246ae7f` multiprocess: Make bitcoin-gui spawn a bitcoin-node process](https://github.com/bitcoin/bitcoin/pull/10102/commits/88f3246ae7f2c0cf79c3f22ba002967dda7a0b16)\n- [`aebc163451b` multiprocess: Make bitcoin-node spawn a bitcoin-wallet process](https://github.com/bitcoin/bitcoin/pull/10102/commits/aebc163451bc8c5fa8cbbcc66b553e17e06e1d82)\n- [`c5b9fe54c9c` multiprocess: Add debug.log .wallet/.gui suffixes](https://github.com/bitcoin/bitcoin/pull/10102/commits/c5b9fe54c9cc367b81487f5c9a4574243e33e7f8)\n- [`a73f70fac8d` doc: Multiprocess misc doc and comment updates](https://github.com/bitcoin/bitcoin/pull/10102/commits/a73f70fac8d396a8d719cafe10853390c53f687b)\n- [`2503f57e93c` combine_logs: Handle multiprocess wallet log files](https://github.com/bitcoin/bitcoin/pull/10102/commits/2503f57e93c32158f837e1c9f0dc9f1061b84346)<!-- end -->\n\n---\n\nThis PR adds an `--enable-multiprocess` configure option which builds new `bitcoin-node`, `bitcoin-wallet`, and `bitcoin-gui` executables with relevant functionality isolated into different processes. See [doc/design/multiprocess.md](https://github.com/ryanofsky/bitcoin/tree/pr/ipc/doc/design/multiprocess.md) for usage details and future plans.\n\nThe change is implemented by adding a new [`Init`](https://github.com/ryanofsky/bitcoin/blob/pr/ipc/src/interfaces/init.h) interface that spawns new wallet and node subprocesses that can be controlled over a [socketpair](http://man7.org/linux/man-pages/man2/socketpair.2.html) by calling [`Node`](https://github.com/ryanofsky/bitcoin/blob/pr/ipc/src/interfaces/node.h), [`Wallet`](https://github.com/ryanofsky/bitcoin/blob/pr/ipc/src/interfaces/wallet.h), and [`ChainClient`](https://github.com/ryanofsky/bitcoin/blob/pr/ipc/src/interfaces/chain.h) methods. When running with split processes, you can see the IPC messages going back and forth in `-debug=1` output. Followup PR's #19460 and #19461 add `-ipcbind` and `-ipcconnect` options that allow more flexibility in how processes are connected.\n\nThe IPC protocol used is Cap'n Proto, but this could be swapped out for another protocol. Cap'n Proto types and libraries are only accessed in the [src/ipc/capnp/](https://github.com/ryanofsky/bitcoin/tree/pr/ipc/src/ipc/capnp) directory, and not in any public headers or other parts of bitcoin code.\n\nSlides from a presentation describing this change are available on [google drive](https://docs.google.com/presentation/d/1AeJ-7gD-dItUgs5yH-HoEzLvXaEWe_2ZiGUUxYIXcws/edit). Demo code used in the presentation was from an older version this PR (tag [ipc.21](https://github.com/ryanofsky/bitcoin/releases/tag/pr%2Fipc.21), [commits](https://github.com/ryanofsky/bitcoin/compare/master...pr/ipc.21)).\n\n---\n\nThis PR is part of the [process separation project](https://github.com/bitcoin/bitcoin/issues/28722).",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2017-03-27T21:48:26Z",
      "updated_at": "2026-02-04T20:43:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/10102",
      "labels": [
        "GUI",
        "RPC/REST/ZMQ",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 4142,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 445592053,
      "number": 19460,
      "title": "multiprocess: Add bitcoin-wallet -ipcconnect option",
      "body": "<!-- begin based-on -->\n**This is based on #29409 + #10102.** The non-base commits are:\n\n- [`5124e765ad6` multiprocess: Add bitcoin-wallet -ipcconnect option](https://github.com/bitcoin/bitcoin/pull/19460/commits/5124e765ad63cfa8e6ae2dec27d427e4f9012018)<!-- end -->\n\n---\n\nBuilding on #10102, this adds an `-ipcconnect` option to `bitcoin-wallet` and an `-ipcbind` option to `bitcoin-node` (both enabled by default in multiprocess builds) so bitcoin node will listen on a `<datadir>/sockets/node.sock` unix socket, and `bitcoin-wallet` will connect to it.\n\nThe idea is that `bitcoin-wallet` can be extended in the future to have some online functionality. For example, there could be a `bitcoin-wallet sync` command that will update balances and sync latest transactions to an unloaded wallet, or a `bitcoin-wallet serve` subcommand that loads a wallet and serves RPC requests, or a `bitcoin-wallet shell` subcommand that allows running RPC methods interactively like the GUI console, or just general support for `bitcoin-wallet <rpc method> <rpc params>` invocations suggested https://github.com/bitcoin/bitcoin/pull/13926#issuecomment-455187379.\n\nThis PR is small and doesn't do much. The only visible change is that `bitcoin-wallet` now checks whether a node socket exists on startup and prints \"Connected to IPC address\" if it can connect it it.\n\nThe default `bitcoin-wallet` connect option is `-ipcconnect=auto`, which connects if possible as described above, and proceeds offline if not possible. Other supported options are `-noipcconnect` to disable ipc, `-ipcconnect` to require a connection and fail if it can't be established, and `-ipcconnect=unix:<socket>` to require a connection and use a custom socket path.\n\nThese changes require multiprocess support and this PR has no effect unless bitcoin is configured with `--enable-multiprocess` as described in [doc/multiprocess.md](https://github.com/bitcoin/bitcoin/blob/master/doc/multiprocess.md)\n\n---\n\nThis PR is part of the [process separation project](https://github.com/bitcoin/bitcoin/issues/28722).",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2020-07-07T18:53:19Z",
      "updated_at": "2026-02-04T20:42:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/19460",
      "labels": [
        "Wallet",
        "Build system",
        "Utils/log/libs",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2117,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 445595297,
      "number": 19461,
      "title": "multiprocess: Add bitcoin-gui -ipcconnect option",
      "body": "<!-- begin based-on -->\n**This is based on #29409 + #10102 + #19460.** The non-base commits are:\n\n- [`86eb8268426` multiprocess: Add bitcoin-gui -ipcconnect option](https://github.com/bitcoin/bitcoin/pull/19461/commits/86eb826842691ed52057a1aada702a5c1eb7c262)<!-- end -->\n\n---\n\nBuilding on #10102, this adds an `-ipcconnect` option to `bitcoin-gui` that connects the GUI to an existing `bitcoin-node` process already running in the background instead of spawning a new `bitcoin-node` process. This allows the GUI to be started and stopped independently of the node. By default with this change, `bitcoin-gui` will check if a `<datadir>/sockets/node.sock` socket exists and try to connect to that. If that doesn't work, it will spawn a new node process and start up the same way it did before this PR.\n\nThe default `bitcoin-gui` connect option is `-ipcconnect=auto`, which tries to connect if possible as described above, and spawns a new `bitcoin-node` process if not possible. Other supported options are `-noipcconnect` to never connect to an existing node and always spawn a new one, `-ipcconnect` to require a connection and fail if it can't be established, and `-ipcconnect=unix:<socket>` to require a connection and use a custom socket path.\n\nWith this PR, basic functionality works and gui instances can connect and disconnect from a running node. But there are rough edges: If a gui process doesn't shut down cleanly, the node can see unhandled IpcExceptions, and if node command line options are passed to `bitcoin-gui` and `bitcoin-gui` connects to an exiting bitcoin-node process instead of spawning a new one, the node options will be silently ignored. \n\nThese changes require multiprocess support and this PR has no effect unless bitcoin is configured with `--enable-multiprocess` as described in [doc/multiprocess.md](https://github.com/bitcoin/bitcoin/blob/master/doc/multiprocess.md)\n\n---\n\nThis PR is part of the [process separation project](https://github.com/bitcoin/bitcoin/issues/28722).",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2020-07-07T19:00:11Z",
      "updated_at": "2026-02-04T20:42:39Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/19461",
      "labels": [
        "GUI",
        "Utils/log/libs",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2057,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1010047865,
      "number": 25722,
      "title": "refactor: Use util::Result class for wallet loading",
      "body": "<!-- begin based-on -->\n**This is based on #25665 + #26022.** The non-base commits are:\n\n- [`9c8facf50f2` Add temporary ResultExtract helper for porting to util::Result](https://github.com/bitcoin/bitcoin/pull/25722/commits/9c8facf50f210e8327ac1e96fbec265916a74f2f)\n- [`1d46b7bd1fc` refactor: Use util::Result class in wallet/sqlite](https://github.com/bitcoin/bitcoin/pull/25722/commits/1d46b7bd1fcac1166869c40cd1eb5771ac701116)\n- [`c577b636d33` refactor: Use util::Result class in wallet/migrate](https://github.com/bitcoin/bitcoin/pull/25722/commits/c577b636d33b9fbdc9cb8b03e8ee05d90caf8ecd)\n- [`8f1f60f9343` refactor: Use util::Result class in wallet::MakeDatabase](https://github.com/bitcoin/bitcoin/pull/25722/commits/8f1f60f93438d7a0f557128c52cee8d05b8c9f82)\n- [`e9d0495b0a8` refactor: Use util::Result class in wallet/dump](https://github.com/bitcoin/bitcoin/pull/25722/commits/e9d0495b0a8a76aa3a8231d6595cff3f15960821)\n- [`a85d65598e3` refactor: Use util::Result class in wallet/wallettool](https://github.com/bitcoin/bitcoin/pull/25722/commits/a85d65598e30e3a0d7be08b426b7c3b7a8cbf807)\n- [`1efcdbe42c4` refactor: Use util::Result class in wallet/wallet](https://github.com/bitcoin/bitcoin/pull/25722/commits/1efcdbe42c445885ce42fa51fd209e9e0779ef11)\n- [`1db7b970d89` refactor: Use util::Result class in wallet/load](https://github.com/bitcoin/bitcoin/pull/25722/commits/1db7b970d89117c9c539d4b40f814e7c542d51c2)\n- [`e5db02940d7` refactor: Use util::Result class in wallet/rpc](https://github.com/bitcoin/bitcoin/pull/25722/commits/e5db02940d7d8d1874fbe63ec5067ae127e088a7)\n- [`c3c1e9c9ed1` refactor: Use util::Result class in wallet/interfaces](https://github.com/bitcoin/bitcoin/pull/25722/commits/c3c1e9c9ed19210f05c41cccea91b544663ec11a)\n- [`ee403e83522` refactor: Use util::Result class in wallet/test](https://github.com/bitcoin/bitcoin/pull/25722/commits/ee403e8352271b8b220a711f3e51b2abf96a4c88)\n- [`89d92070b11` Drop temporary ResultExtract helper for porting to util::Result](https://github.com/bitcoin/bitcoin/pull/25722/commits/89d92070b11f6de516105ffa9e561b4c34c0e2fa)\n- [`23df7666d1c` scripted-diff: replace wallet DatabaseStatus with DatabaseError](https://github.com/bitcoin/bitcoin/pull/25722/commits/23df7666d1cfae87609b0054e7184bfad71467dd)\n- [`93828179010` iwyu fix https://github.com/bitcoin/bitcoin/actions/runs/21266012856/job/61207857203?pr=25722](https://github.com/bitcoin/bitcoin/pull/25722/commits/9382817901067c57b5ff4044d4c7aa09aee25376)<!-- end -->\n\n---\n\nWallet loading functions up and down the stack have lots of error and warning parameters, and return error information in different ways. This PR makes them uniformly return `util::Result`, without changing behavior.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2022-07-27T19:26:58Z",
      "updated_at": "2026-02-04T20:42:16Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/25722",
      "labels": [
        "Refactoring",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2763,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1685623460,
      "number": 29278,
      "title": "Wallet:  Add `maxfeerate` wallet startup option",
      "body": "This PR fixes #29220\r\n\r\n- The PR adds a wallet `-maxfeerate` startup option, as the upper limit of wallet transactions fee rate.\r\n\r\n- This fixes the ambiguity of using `maxtxfee` value to check the upper limit of transactions fee rate.\r\n\r\n-  Wallet will not create a transaction with fee rate above `maxfeerate` value. And you can not set wallet fee rate with `settxfee` RPC above `maxfeerate` value.\r\n\r\n- This PR adds a functional test that ensure the behavior is enforced.\r\n \r\n\r\n\r\n",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2024-01-18T22:23:49Z",
      "updated_at": "2026-02-04T20:40:49Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29278",
      "labels": [
        "RPC/REST/ZMQ",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 531,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1940584116,
      "number": 30343,
      "title": "wallet, logging: Replace WalletLogPrintf() with LogInfo()",
      "body": "Make new logging macros `LogDebug()`, `LogTrace()`, `LogInfo()`, `LogWarning()`, and `LogError()` compatible with wallet code and drop custom WalletLogPrintf() function. The new logging macros introduced in #28318 weren't previously useful in wallet code because wallet code prefixes most log messages with the wallet names to be be able to distinguish log output from multiple wallets. Fix this by introducing a new `WalletLogSource` class inheriting from `BCLog::Source` which can include the wallet name in log messages.\n\n---\n\n<!-- begin based-on -->\n**This is based on #29256.** The non-base commits are:\n\n- [`2d5c5f0e905` wallet, logging: Replace WalletLogPrintf() with LogInfo()](https://github.com/bitcoin/bitcoin/pull/30343/commits/2d5c5f0e90514e4ef4b6343124c827aea1d0eeab)\n- [`4fb99c22c1c` wallet, logging: Switch LogInfo to LogWarning/LogError](https://github.com/bitcoin/bitcoin/pull/30343/commits/4fb99c22c1c0f242dfdda38832a4814b421273d4)\n- [`a08c9bc808e` wallet, logging: Switch LogInfo to LogError in AddWalletDescriptor](https://github.com/bitcoin/bitcoin/pull/30343/commits/a08c9bc808ef19accc90335fb115f791a66e0158)<!-- end -->",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-06-26T17:57:15Z",
      "updated_at": "2026-02-04T20:39:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30343",
      "labels": [
        "Wallet",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1201,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2170572223,
      "number": 31260,
      "title": "scripted-diff: Type-safe settings retrieval",
      "body": "This PR changes the way settings are registered and retrieved to provide more compile-time safety. Currently settings are [registered](https://github.com/ryanofsky/bitcoin/blob/03cff2c1421e5db59963eba1a845ef5dd318c275/src/init.cpp#L504) and [retrieved](https://github.com/ryanofsky/bitcoin/blob/03cff2c1421e5db59963eba1a845ef5dd318c275/src/init.cpp#L173) like:\n\n```c++\n// Register setting\nargsman.AddArg(\"-pid=<file>\", strprintf(\"Specify pid file. Relative paths will be prefixed by a net-specific datadir location. (default: %s)\", BITCOIN_PID_FILENAME), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n\n// Retrieve setting\nargs.GetPathArg(\"-pid\", BITCOIN_PID_FILENAME)\n```\n\nBut this is not ideal because nothing checks that setting names are spelled correctly, or that default values (`BITCOIN_PID_FILENAME`) are used consistently in the help string and retrieval sites, or that settings are retrieved with consistent types (bool, int, string, path, or list). This PR addresses these issues by adding setting [declarations](https://github.com/ryanofsky/bitcoin/blob/416860fc360b3d5aa1a0782ab8f8454b46e6d657/src/init_settings.h#L267-L270) which allow settings to be [registered](https://github.com/ryanofsky/bitcoin/blob/416860fc360b3d5aa1a0782ab8f8454b46e6d657/src/init.cpp#L484) and [retrieved](https://github.com/ryanofsky/bitcoin/blob/416860fc360b3d5aa1a0782ab8f8454b46e6d657/src/init.cpp#L164C38-L164C59) like:\n\n```c++\n// Declare setting\nusing PidSetting = common::Setting<\n    \"-pid=<file>\", fs::path, {.legacy = true},\n    \"Specify pid file. Relative paths will be prefixed by a net-specific datadir location. (default: %s)\">\n    ::DefaultFn<[] { return BITCOIN_PID_FILENAME; }>;\n\n// Register setting\nPidSetting::Register(argsman);\n\n// Retrieve setting\nPidSetting::Get(args)\n```\n\n---\n\n#### Suggestions for review\n\nAll the real changes in this PR are in the last scripted-diff commit:\n\n- [scripted-diff: Replace AddArgs / GetArgs calls with Setting Register / Get calls](https://github.com/bitcoin/bitcoin/pull/31260/commits/fc2591a35b0640adc0df686b0f8bed5f50ada9ce)\n\nIf you take a few minutes to look at the changes applied in this scripted-diff commit, you'll understand everything this PR is doing. A good place to start looking around in this commit is the generated [`src/init_settings.h`](https://github.com/ryanofsky/bitcoin/blob/pr/scripty/src/init_settings.h) file which declares the settings that get registered in [src/init.cpp](https://github.com/ryanofsky/bitcoin/blob/pr/scripty/src/init.cpp). Then you can look at the surrounding diffs and see they are just replacing `AddArg` and `GetArg` calls.\n\nThe other notable commit is second commit, which implements the `Setting` class:\n\n- [common: Add Setting class to support typed Settings](https://github.com/bitcoin/bitcoin/pull/31260/commits/e1f016180746db0eebc2c2e1e0786f0cc5da8a43)\n\nThe other commits do minor things like moving code or updating linters. The python script that implements the scripted diff is a temporary artifact that gets deleted. The python script is complicated because it does things like parsing c++ code to extract help strings, and figuring out the right types to declare settings with so code compiles. But the entire scope of the script is to (1) generate Setting type definitions, (2) add #includes, and (3) replace `AddArg()` calls with `Register()` calls and `GetArg()` calls with `Get()` calls. So there is not much the script can actually do wrong without triggering build and test failures.\n\n---\n\n#### Extensions\n\nThis PR only adds the ability to declare individual settings with built-in types. It doesn't provide any new runtime behavior, but a branch in issue #22978 extends the `Setting` class implemented here to support runtime setting validation, additional types like `std::variant`, additional conversion options, custom types, custom validation, and groups of settings declared as options structs.\n\nThis change is mostly orthogonal to #16545. #16545 only provides runtime type checking while this PR only provides compile-time checking with no new runtime behavior. But this change does allow a nicer way of declaring types in #16545, using c++ types like `int` instead of flags like `ALLOW_INT`, or`std::vector<std::string>` instead of `ALLOW_STRING | ALLOW_LIST`.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-11-08T22:34:46Z",
      "updated_at": "2026-02-04T20:38:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31260",
      "labels": [
        "Refactoring",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 4326,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2417478258,
      "number": 32138,
      "title": "wallet, rpc: remove settxfee and paytxfee",
      "body": "**Summary**\r\n\r\nThis PR removes the settxfee RPC and paytxfee setting (Bitcoin Core 31.0).\r\nThese two features were deprecated in https://github.com/bitcoin/bitcoin/pull/31278.",
      "state": "open",
      "user": "polespinasa",
      "created_at": "2025-03-25T18:30:56Z",
      "updated_at": "2026-02-04T20:36:37Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32138",
      "labels": [
        "Wallet",
        "RPC/REST/ZMQ",
        "Needs release note",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 217,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3220882661,
      "number": 34437,
      "title": "rpc: `uptime` should begin on application start",
      "body": "### Problem\r\n#34328 switched uptime to use monotonic time, but `g_startup_time` was a function-local static in `GetUptime()`, meaning it was initialized on first call rather than at program start.\r\nThis caused the first uptime RPC to always return 0.\r\n\r\n### Fix\r\nMove `g_startup_time` to namespace scope so it initializes at program start, ensuring the first `uptime()` call returns actual elapsed time.\r\n\r\n### Reproducer\r\n\r\nRevert the fix and run the test or alternatively:\r\n\r\n```bash\r\ncmake -B build && cmake --build build --target bitcoind bitcoin-cli -j$(nproc)\r\n./build/bin/bitcoind -regtest -daemon\r\nsleep 10\r\n./build/bin/bitcoin-cli -regtest uptime\r\n./build/bin/bitcoin-cli -regtest stop\r\n```\r\n\r\n<details>\r\n<summary>Before (uptime is initialized on first call)</summary>\r\n\r\n```bash\r\nBitcoin Core starting\r\n0\r\nBitcoin Core stopping\r\n```\r\n\r\n</details>\r\n\r\n<details>\r\n<summary>After (first uptime call is in-line with sleep)</summary>\r\n\r\n```bash\r\nBitcoin Core starting\r\n10\r\nBitcoin Core stopping\r\n```\r\n</details>\r\n\r\n----\r\n\r\nFixes #34423, added reporter as coauthor.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-28T22:54:44Z",
      "updated_at": "2026-02-04T20:32:16Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34437",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1116,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3201053750,
      "number": 34383,
      "title": "ci: remove commit count limit from `test-each-commit` and fail fast",
      "body": "### Problem\r\n\r\n`test-each-commit` currently tests only a limited number of ancestor commits in a PR, so failures introduced deeper in the commit stack might be missed.\r\n\r\n### Fix\r\n\r\nRemove the max-count limit so `test-each-commit` runs the full build + unit + functional test flow on every non-head PR commit, while keeping the PR tip excluded because it is already covered by the normal CI jobs.\r\nIt will also stop after the first failure to surface the root cause sooner and keep logs readable when testing ancestor commits.\r\n\r\n### Examples\r\n* Example failure 10 commits deep: https://github.com/l0rinc/bitcoin/actions/runs/21390976651/job/61577575033?pr=105 in https://github.com/l0rinc/bitcoin/pull/105\r\n* Example pass with >7 dummy commits: https://github.com/l0rinc/bitcoin/actions/runs/21392557521/job/61595159841?pr=106 in https://github.com/l0rinc/bitcoin/pull/106\r\n\r\n---------\r\n\r\nNote: this PR has gone through a few iterations, the latest one just extends the existing job.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-22T21:38:21Z",
      "updated_at": "2026-02-04T20:28:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34383",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1052,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2999849822,
      "number": 33856,
      "title": "kernel, validation: Refactor ProcessNewBlockHeaders to return BlockValidationState",
      "body": "## Motivation\r\n\r\nThis PR refactors `ProcessNewBlockHeaders()` to return `BlockValidationState` by value instead of using out-parameters or boolean returns. This follows the pattern established in #31981 (commit 74690f4) which refactored `TestBlockValidity()` in a similar manner.\r\n\r\n### Current Issues\r\n **ProcessNewBlockHeaders()**: Uses an out-parameter `BlockValidationState& state`, making the API less intuitive.\r\n\r\nAs noted by @theCharlatan in #33822 [comment](https://github.com/bitcoin/bitcoin/pull/33822#discussion_r2508065115) and can be a fix for that too:\r\n> One thing that could be considered here is returning the BlockValidationState directly instead of having an in/out param. To safely do that I think we'd need to refactor ProcessNewBlockHeaders though, similarly to what was done in 74690f4.\r\n\r\nThe changes are split into two commits, see individual commit message for more info.",
      "state": "open",
      "user": "yuvicc",
      "created_at": "2025-11-11T17:23:59Z",
      "updated_at": "2026-02-04T20:26:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33856",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 981,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3176742789,
      "number": 34301,
      "title": "wallet: remove outdated `RewriteDB` calls from SPKM & `DBErrors::NEED_REWRITE` enum value",
      "body": "ISTM that there is no implementation left of the `RewriteDB` method in any of the SPKMs, and thus, its call sites can be removed safely.\r\n\r\nAlso remove `DBErrors::NEED_REWRITE` enum value as its usage is outdated now.\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "open",
      "user": "rkrux",
      "created_at": "2026-01-15T10:11:36Z",
      "updated_at": "2026-02-04T20:21:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34301",
      "labels": [
        "Wallet",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 2373,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3207254787,
      "number": 34400,
      "title": "wallet: parallel fast rescan (approx 5x speed up with 16 threads)",
      "body": "This PR uses @furszy's ThreadPool from https://github.com/bitcoin/bitcoin/pull/33689 to implement parallel fast rescan. The ThreadPool commit has been cherry-picked into this PR for use.\r\n\r\nThis PR:\r\n- Adds a `ThreadPool` to the `WalletContext` to be shared by all the wallets\r\n- Adds `-walletpar` parameter to configure the number of threads to be used for parallel scanning \r\n- Updates the `wallet_fast_rescan.py` test to ensure it catches cases where the FastRescan filter wasn't properly updated. This is crucial to ensure that changes in the PR do not cause newly added output scripts to be missed.\r\n- Refactors `ScanForWalletTransactions` to make the implementation of parallel scanning easier.\r\n- Implements parallel scanning\r\n\r\nBenchmarks:\r\n**NOTE: to reproduce, please tune your system with `pyperf system tune`**\r\n\r\n_EDIT\r\nSet up your node to use block filters by setting `blockfilterindex=1` in your bitcoin.conf file and ensure your blockfilterindex is synced to tip before attempting to reproduce_\r\n\r\nUsing the following command on mainnet with a wallet with no scripts:\r\n```\r\nhyperfine --show-output --export-markdown results.md --export-json results.json  \\\r\n--sort command \\\r\n--runs 3 \\\r\n-L commit ef847e8,37d356b \\\r\n-L num_threads 1,2,4,8,16 \\\r\n--prepare 'git checkout {commit} && cmake --build build -j 20 && build/bin/bitcoind -walletpar={num_threads} && sleep 10' \\\r\n--conclude 'build/bin/bitcoin-cli stop && sleep 10' \\\r\n'build/bin/bitcoin-cli rescanblockchain 500000 900000'\r\n```\r\nI obtained the following results:\r\n| Command | Mean [s] | Min [s] | Max [s] | Relative |\r\n|:---|---:|---:|---:|---:|\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = baseline, num_threads = ..)` | 536.996 ± 0.722 | 536.257 | 537.701 | 4.64 ± 0.01 |\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = parallel_scan, num_threads = 1)` | 540.210 ± 2.696 | 537.172 | 542.320 | 4.67 ± 0.03 |\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = parallel_scan, num_threads = 2)` | 358.190 ± 0.515 | 357.675 | 358.706 | 3.10 ± 0.01 |\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = parallel_scan, num_threads = 4)` | 230.217 ± 2.321 | 228.814 | 232.896 | 1.99 ± 0.02 |\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = parallel_scan, num_threads = 8)` | 151.144 ± 1.748 | 149.506 | 152.984 | 1.31 ± 0.02 |\r\n| `build/bin/bitcoin-cli rescanblockchain 500000 900000 (commit = parallel_scan, num_threads = 16)` | 115.642 ± 0.305 | 115.390 | 115.982 | 1.00 |\r\n\r\nSystem information:\r\n```\r\nArchitecture:             x86_64\r\n  CPU op-mode(s):         32-bit, 64-bit\r\n  Address sizes:          46 bits physical, 48 bits virtual\r\n  Byte Order:             Little Endian\r\nCPU(s):                   20\r\n  On-line CPU(s) list:    0-19\r\nVendor ID:                GenuineIntel\r\n  Model name:             Intel(R) Core(TM) Ultra 7 265\r\n    CPU family:           6\r\n    Model:                198\r\n    Thread(s) per core:   1\r\n    Core(s) per socket:   1\r\n    Socket(s):            20\r\n    Stepping:             2\r\n    CPU(s) scaling MHz:   41%\r\n    CPU max MHz:          4800.0000\r\n    CPU min MHz:          800.0000\r\n    BogoMIPS:             4761.60\r\n```\r\n\r\nFurther benchmarks were performed using a [python script](https://github.com/Eunovo/rescan-benchmark) with custom chains designed with payments at specified intervals, and the following graph was produced:\r\n\r\n<img width=\"4760\" height=\"8950\" alt=\"benchmark_comparison\" src=\"https://github.com/user-attachments/assets/1ba8c64d-cfca-4360-af06-1f034a30e307\" />\r\n\r\nThis graph was produced from a laptop with the following CPU specifications:\r\n```\r\nArchitecture:                x86_64\r\n  CPU op-mode(s):            32-bit, 64-bit\r\n  Address sizes:             48 bits physical, 48 bits virtual\r\n  Byte Order:                Little Endian\r\nCPU(s):                      16\r\n  On-line CPU(s) list:       0-15\r\nVendor ID:                   AuthenticAMD\r\n  Model name:                AMD Ryzen 9 8945HS w/ Radeon 780M Graphics\r\n    CPU family:              25\r\n    Model:                   117\r\n    Thread(s) per core:      2\r\n    Core(s) per socket:      8\r\n    Socket(s):               1\r\n    Stepping:                2\r\n    Frequency boost:         enabled\r\n    CPU(s) scaling MHz:      63%\r\n    CPU max MHz:             5263.0000\r\n    CPU min MHz:             400.0000\r\n```\r\n\r\nAll materials for the custom benchmarks can be found [here](https://github.com/Eunovo/rescan-benchmark).\r\n\r\nAlthough not explicitly checked with Valgrind, hyperfine reported that memory usage stayed the same across all runs. I'm not sure to what degree hyperfine's memory usage report can be trusted, but the PR limits the amount of block hashes that can be held in memory for processing to `1000` (not configurable by the user).\r\n\r\n\r\nAll benchmarks were performed against https://github.com/bitcoin/bitcoin/pull/34400/commits/37d356bbbe3efed3c7c9e64fae1bac3f4d0ec6eb instead of master because `-walletpar` is implemented here, and the benchmark scripts would otherwise break, or more complicated scripts would be required to accommodate master.\r\n",
      "state": "open",
      "user": "Eunovo",
      "created_at": "2026-01-24T19:46:16Z",
      "updated_at": "2026-02-04T20:20:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34400",
      "labels": [
        "Wallet",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 5206,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2194781763,
      "number": 31349,
      "title": "ci: detect outbound internet traffic generated while running tests",
      "body": "Prevent generating outbound traffic on a non-loopback interface during tests.\r\n\r\n* Fix `node_init_tests/init_test`\r\n* Change CI to catch new regressions, including DNS traffic. DNS traffic is detected because some VMs have configured a non-loopback DNS server, `[1111:1111::1]:53`. This is achieved by running `tcpdump` during tests and inspecting its output after the tests. Add `--cap-add NET_RAW` to docker to be able to run `tcpdump`.\r\n\r\nResolves https://github.com/bitcoin/bitcoin/issues/31339\r\n",
      "state": "open",
      "user": "vasild",
      "created_at": "2024-11-22T13:58:43Z",
      "updated_at": "2026-02-04T20:14:48Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31349",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 567,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3163535277,
      "number": 34254,
      "title": "validation: Prevent duplicate logging and looping in invalid block handling",
      "body": "`InvalidChainFound()` is called from 3 spots:\r\n1. from `InvalidBlockFound()`\r\n2. from `ActivateBestChain()`, with the highest connectable block of the chain\r\nas an arg (after having called `InvalidBlockFound()` already for the block that failed in `ConnectTip()`)\r\n3. from `InvalidateBlock()` (rpc-only)\r\n\r\nMost of the logic in `InvalidChainFound()` is not required for 2) and 3):\r\nIn `ActivateBestChain()`, the previous call to `InvalidChainFound()` before via `InvalidBlockFound` did the flag updates, best header calculation and logging, so only `m_best_invalid` could need additional updating.\r\nIn `InvalidateBlock()` (which doesn't call `InvalidBlockFound()`), we do most of the accounting manually.\r\n\r\nTherefore move of all logic but the `m_best_invalid` update into `InvalidBlockFound()`, avoiding duplicate logging and unnecessary work (the loops over the block index in `SetBlockFailureFlags()` and `RecalculateBestHeader()`\r\nwere done twice before).\r\n\r\nThe second commit renames `InvalidChainFound` to `UpdateBestInvalid` to adjust to its remaining role.\r\n\r\nThis addresses past discussions about repeated work in `InvalidateBlock()` (https://github.com/bitcoin/bitcoin/pull/31405#discussion_r2135717500) and `ActivateBestChain()` (https://github.com/bitcoin/bitcoin/pull/31533#discussion_r2607189790)",
      "state": "open",
      "user": "mzumsande",
      "created_at": "2026-01-11T16:59:21Z",
      "updated_at": "2026-02-04T20:13:22Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34254",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1386,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2929620815,
      "number": 33661,
      "title": "test: Add test on skip heights in CBlockIndex",
      "body": "The skip height values, used by `CBlockIndex::BuildSkip()` and `GetSkipHeight()` are not tested directly and not well documented. Indirect tests, through `GetAncestor()` exist in `skiplist_tests.cpp`. (This was noticed while reviewing #33515, recently merged.)\r\n\r\nThe motivation is to document the skip value computation through a test.\r\n\r\nThe first commit adds a test for the number of steps needed for an ancestor search, the number should be much lower than the linear distance.\r\n\r\nThe next commits add low-level tests to the `GetSkipHeight()` method. The previously internal method is exposed first.",
      "state": "open",
      "user": "optout21",
      "created_at": "2025-10-20T12:08:37Z",
      "updated_at": "2026-02-04T20:02:52Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33661",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 649,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3246218548,
      "number": 34505,
      "title": "kernel: Return validation state directly from process_block_header",
      "body": "Simplifies `btck_chainstate_manager_process_block_header` by returning `BlockValidationState*` directly instead of an int + output parameter.                                                                                                             \r\n                                                                                                                                \r\nPrevious API returned both int and validation state, creating ambiguity where non-zero meant either \"invalid header\" or \"processing failure\". Since `ProcessNewBlockHeaders` already provides complete validation info, the int return was redundant.\r\n\r\n**Changes:**                                                                                                                  \r\n- `btck_chainstate_manager_process_block_header` returns `btck_BlockValidationState*`: null = unhandled processing failure, non-null = validation result\r\n- Updated C++ wrapper and tests",
      "state": "open",
      "user": "stringintech",
      "created_at": "2026-02-04T15:03:24Z",
      "updated_at": "2026-02-04T19:57:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34505",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1011,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3231429938,
      "number": 34469,
      "title": "consensus/test/doc: cover errors in `CheckTxInputs` with unit tests",
      "body": "### Problem\r\nCoverage reports indicate that a few consensus related validations aren't exercised in unit-, and some not even in the functional-tests:\r\nInspired by the coverage reports:\r\n* [\"bad-txns-premature-spend-of-coinbase\"](https://maflcko.github.io/b-c-cov/test_bitcoin.coverage/src/consensus/tx_verify.cpp.gcov.html#L180)\r\n* [\"bad-txns-inputvalues-outofrange\"](https://maflcko.github.io/b-c-cov/test_bitcoin.coverage/src/consensus/tx_verify.cpp.gcov.html#L187)\r\n* [\"bad-txns-in-belowout\"](https://maflcko.github.io/b-c-cov/test_bitcoin.coverage/src/consensus/tx_verify.cpp.gcov.html#L193)\r\n* [\"GetValueOut: value out of range\"](https://maflcko.github.io/b-c-cov/test_bitcoin.coverage/src/primitives/transaction.cpp.gcov.html#L103)\r\n\r\nReplacing them with explicit throws still passes all unit (and sometimes even functional) tests, confirming those branches are not being exercised, see: https://github.com/l0rinc/bitcoin/pull/112\r\n\r\n### Fixes\r\n\r\nAdd minimal unit test coverage for `Consensus::CheckTxInputs` invalid outcomes for `bad-txns-premature-spend-of-coinbase`, `bad-txns-inputvalues-outofrange`, `bad-txns-in-belowout`.\r\nAdd a unit test covering `CTransaction::GetValueOut()` throwing for out of range values.\r\nAfter the prerequisits are tested, document why `bad-txns-fee-outofrange` is unreachable - while keeping the check in place because it is consensus-critical code.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-31T20:14:32Z",
      "updated_at": "2026-02-04T18:27:32Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34469",
      "labels": [
        "Consensus"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1456,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3181854676,
      "number": 34320,
      "title": "coins: remove redundant and confusing `CCoinsViewDB::HaveCoin`",
      "body": "Split out of https://github.com/bitcoin/bitcoin/pull/34132#discussion_r2692307054.\r\n\r\n### Problem\r\nWe have two ways to check if a coin exists in the db.\r\nOne tries to deserialize, the other just returns whether any value is associated with the key.\r\nBut we usually need the full value we probed for, and `HaveCoin` cannot cache the returned value, so it can trigger an extra lookup if `HaveCoin` uses `Exists` and the caller later needs the actual value.\r\nWe're already delegating most `HaveCoin` calls to `GetCoin` anyway for the above reasons, so the `CCoinsViewDB` implementation of `HaveCoin` is redundant.\r\n\r\n### Fix\r\nRemove `CCoinsViewDB::HaveCoin` (falls back to the base `CCoinsView::HaveCoin` which delegates to `GetCoin`) and simplify `CCoinsViewCache::HaveCoin` to use `AccessCoin`.\r\n\r\n### Testing\r\nA unit test was added to confirm that `HaveInputs` calls the database's `::GetCoin` (not `::HaveCoin`) on cache miss and checks cache first.\r\nAlso added a benchmark to track throughput before/after changes to ensure no regression.\r\n\r\n----\r\n\r\nNote: the latest version of the change keeps most `HaveCoin` calls for convenience, a previous version removed all of them.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-16T16:17:29Z",
      "updated_at": "2026-02-04T18:05:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34320",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1238,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3182788993,
      "number": 34324,
      "title": "Add utxo_to_csv.py tool",
      "body": "This adds a new conversion tool, heavily based on `utxo_to_sqlite.py`, to produce a CSV file for the UTXO set.\r\n\r\nI created this because I wanted something that produced a greppable UTXO set, and am upstreaming it as it may benefit others.\r\n\r\nUnlike the sqlite version, it also dumps addresses/descriptors for the outputs.",
      "state": "open",
      "user": "sipa",
      "created_at": "2026-01-16T21:37:36Z",
      "updated_at": "2026-02-04T18:03:15Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34324",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 346,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3224735849,
      "number": 34452,
      "title": "test: split interface_ipc.py",
      "body": "This test has been growing too large, making it difficult to maintain. Especially when multiple pull requests change it.\r\n\r\n- move helper functions to `ipc_util.py`\r\n- move mining test to `ipc_mining.py`, keeping only an interface sanity check in `interface_ipc.py`\r\n- split the tests in `ipc_mining.py`\r\n\r\nReview hint:\r\n\r\n```sh\r\ngit show --color-moved=dimmed-zebra --color-moved-ws=ignore-space-change\r\n```",
      "state": "open",
      "user": "Sjors",
      "created_at": "2026-01-29T19:08:43Z",
      "updated_at": "2026-02-04T17:58:04Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34452",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 436,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3182466003,
      "number": 34322,
      "title": "node: Persist private broadcast transactions over node restarts",
      "body": "Follow-up from #29415 \r\n\r\nCurrently private broadcast transactions are stored in peer manager and do not persist over restarts. A submitted transaction can be lost if the node restarts before it is privately broadcast.\r\n\r\nThis change dumps the set of private broadcast transactions to a `privatebroadcast.dat` file on shutdown, and adds the transactions back to the private broadcast data structure on restart.",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2026-01-16T19:37:05Z",
      "updated_at": "2026-02-04T17:52:43Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34322",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 474,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3187823761,
      "number": 34342,
      "title": "cli: Replace libevent usage with simple http client",
      "body": "Part of the effort to remove the libevent dependency altogether, see #31194\r\n\r\nThis takes the [`HTTPHeaders` class](https://github.com/bitcoin/bitcoin/pull/32061/commits/d549f01caab659f1c431ccabf0f5ff1800debcfe) from #32061 and puts it into [`common/http.h|cpp`](https://github.com/bitcoin/bitcoin/pull/34342/commits/634d4dcfa428f17f0a12c2e2742c2c08e2345033). While it would not be strictly required for that PR to go in first, it might be better to review it first or simultaneously.\r\n\r\nOtherwise the change itself replaces the libevent-based HTTP client with a simple synchronous implementation which uses the `Sock` class directly.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2026-01-19T13:27:54Z",
      "updated_at": "2026-02-04T17:10:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34342",
      "labels": [
        "Scripts and tools"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 686,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2522134849,
      "number": 32513,
      "title": "ci: remove 3rd party js from windows dll gha job",
      "body": "The windows job uses the external dependency `ilammy/msvc-dev-cmd` which runs javascript. We use this to put various tools on the path such as `MSBuild.exe` and `mt.exe`. We can remove this dependency and use `vswhere.exe` directly to find these tools and create a \"[Developer command prompt](https://github.com/microsoft/vswhere/wiki/Start-Developer-Command-Prompt#using-powershell)\" as someone would on their dev machine.\r\n\r\nWhile in this area of the code, this PR also runs some additional manifest checks on the windows binaries.\r\n\r\nFixes: #32508\r\n\r\n",
      "state": "closed",
      "user": "m3dwards",
      "created_at": "2025-05-15T13:36:46Z",
      "updated_at": "2026-02-04T16:49:16Z",
      "merged_at": "2025-10-07T23:44:42Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32513",
      "labels": [
        "Windows",
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 603,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3244919791,
      "number": 34500,
      "title": "ci: Print verbose Windows CI build failure",
      "body": "Just like all the other CI configs, the Windows one should print a single and readable build failure at the end.\r\n\r\nAlso, includes a bunch of Windows CI refactors.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-02-04T09:14:58Z",
      "updated_at": "2026-02-04T16:48:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34500",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 206,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3193617894,
      "number": 34360,
      "title": "bench: add WalletBalanceManySpent for high-history wallet scenario",
      "body": "This PR introduces a new benchmark that measures `GetBalance()` performance on wallets with extensive transaction history where the majority of outputs have already been spent.\r\n\r\nIt was created to test #27865, which separates spent TXOs from spendable ones.\r\nThis pattern mirrors real-world usage in high-activity wallets such as Lightning nodes, exchanges, hot wallets, and payment processors.\r\n\r\n**Setup:**\r\n- Creates 500 blocks × 100 coinbase outputs = 50,000 wallet TXOs\r\n- Matures all coinbases with COINBASE_MATURITY additional blocks\r\n- Spends 49,950 outputs in batched transactions (confirmed in blocks)\r\n- Consolidation outputs go to a burn script to avoid inflating wallet TXO count\r\n                                                                                                                                         \r\nTo keep the setup time reasonable, the benchmark uses the fast “fake block” approach, similar to `wallet_create_tx.cpp`.",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2026-01-21T03:15:17Z",
      "updated_at": "2026-02-04T16:31:16Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34360",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1021,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3190110147,
      "number": 34349,
      "title": "util: Remove brittle and confusing sp::Popen(std::string)",
      "body": "The subprocess Popen call that accepts a full `std::string` has many issues:\r\n\r\n* It promotes brittle and broken code, where spaces are not properly quoted. Example: https://github.com/bitcoin/bitcoin/pull/33929#discussion_r2590523065\r\n* The internally used `util::split` function does incorrectly split on spaces, instead of using `shlex.split`.\r\n* It is redundant and not needed, because a vector interface already exists.\r\n\r\nFix all issues by removing it and just using the vector interface.\r\n\r\nThis pull request should not change any behavior: Note that the command taken from `gArgs.GetArg(\"-signer\", \"\")` is still passed through the `sp::util::split` helper, just like before. Fixing that is left for a follow-up, so that this change here is basically just a refactor.\r\n\r\nThis also fixes a unit test bug as a side-effect: Fixes https://github.com/bitcoin/bitcoin/issues/32574.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-20T07:19:24Z",
      "updated_at": "2026-02-04T16:25:59Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34349",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 940,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3245590755,
      "number": 34504,
      "title": "build: replace `WERROR` with `CMAKE_COMPILE_WARNING_AS_ERROR`",
      "body": "`CMAKE_COMPILE_WARNING_AS_ERROR` was added to CMake in 3.24.\r\n\r\nPotential alternative to #33297. Should also close #33284.\r\n\r\nSee https://cmake.org/cmake/help/latest/prop_tgt/COMPILE_WARNING_AS_ERROR.html.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-02-04T12:18:37Z",
      "updated_at": "2026-02-04T16:25:58Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34504",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 267,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3239243501,
      "number": 34489,
      "title": "index: batch db writes during initial sync",
      "body": "Decouples part of #26966.\r\n\r\nRight now, index initial sync writes to disk for every block, which is not the best for HDD. This change batches those, so disk writes are less frequent during initial sync. This also cuts down `cs_main` contention by reducing the number of `NextBlockSync` calls (instead of calling it for every block, we will call it once per block window), making the node more responsive (IBD and validation) while indexes sync up. On top of that, it lays the groundwork for the bigger speedups, since part of the parallelization pre-work is already in place.\r\n\r\nJust as a small summary:\r\n\r\n* Batch DB writes instead of flushing per block, which improves sync time on HDD due to the reduced number of disk write operations.\r\n* Reduce `cs_main` lock contention, which improves the overall node responsiveness (and primarily IBD) while the indexes threads are syncing.\r\n* Lays the groundwork for the real speedups, since part of #26966 parallelization pre-work is introduced here as well.\r\n\r\nNote:\r\nPending initial sync benchmark and further testing. I have only focused on decoupling and simplifying what was in #26966 first. Commits should be simple to diggest.",
      "state": "open",
      "user": "furszy",
      "created_at": "2026-02-03T04:06:34Z",
      "updated_at": "2026-02-04T16:19:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34489",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1220,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3220617054,
      "number": 34435,
      "title": "refactor: use `_MiB`/`_GiB` consistently for byte conversions",
      "body": "### Problem\r\nByte-size conversions in the codebase currently show up in many equivalent formats (multiplication/division chains, shifts, hex/binary literals), which creates a maintenance burden and makes review error-prone - especially considering the architectural differences of `size_t`.\r\nInspired by https://github.com/bitcoin/bitcoin/pull/34305#discussion_r2734720002, it seemed appropriate to unify `Mebibyte` usage across the codebase and add `Gibibyte` support with 32/64 bit `size_t` validation.\r\n\r\n### Fix\r\nThis PR refactors those call sites to use `\"\"_MiB` (existing) and `\"\"_GiB` (new), and adds the encountered value/pattern replacements to unit tests to make review straightforward, and to ensure the conversions remain valid.\r\nThe literals are overflow-checked when converting to `size_t`, and unit tests cover the 32-bit boundary cases.\r\n\r\nConcretely, it replaces patterns such as:\r\n* `1024*1024`, `1<<20`, `0x100000`, `1048576`, `/ 1024 / 1024`, `* (1.0 / 1024 / 1024)` → `1_MiB` or `double(1_MiB)`\r\n* `1024*1024*1024`, `1<<30`, `0x40000000`, `1024_MiB`, `>> 30` → `1_GiB`\r\n\r\n### Note\r\nIn the few places where arithmetic involves signed values, the result is identical to the previous code assuming those quantities never become negative.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-28T21:26:10Z",
      "updated_at": "2026-02-04T16:17:24Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34435",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1317,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1917070148,
      "number": 30277,
      "title": "[DO NOT MERGE] Erlay: bandwidth-efficient transaction relay protocol (Full implementation)",
      "body": "Erlay Project Tracking: https://github.com/bitcoin/bitcoin/issues/30249\r\n\r\n---\r\n\r\nThis is a full implementation of Erlay. Its purpose is to check the integrity and correctness of the implementation against changes/additions that may originate from the review process and/or rebases on top of newer functionality.\r\n\r\nThis is not to be merged. Functionality will be spread across multiple smaller PRs to ease the review process.\r\n\r\n---\r\n\r\n## Approach \r\n\r\nThe implementation approach builds on the following assumptions:\r\n\r\n- Fanout (the current relay method) is faster than Erlay, but less bandwidth efficient\r\n- Fanout is optimal if the node we want to announce a certain transaction doesn't know about it (but of course, we don't have that information)\r\n\r\n\r\nThe general approach works as follows:\r\n\r\nReconciliation is used alongside fanout to relay transactions across the network. For Erlay nodes, the relay method will be decided per-transaction, instead of per connection, meaning that Erlay connections will do both fanout and reconciliation depending on the transaction (legacy connections will do only fanout, obviously).\r\n\r\nThe parameters selected for fanout are minimized to maximize the bandwidth saving. The current selected defaults are 4 outbound peers and 10% of inbounds. The relay logic depends on the type of connection and how the transaction has been received:\r\n\r\n- For outbound connections, if the transaction was received via fanout (or originates in us), we fanout until up to N peers know about it. We do this by checking the `m_tx_inventory_known_filter`, so their announcements also count. If the transaction was received via reconciliation, we simply reconcile with the rest of our peers.\r\n- For inbounds, we select 10% of our connections and rotate that selection periodically.\r\n\r\nThe reasoning for this is trying to guess how far the transaction has made it into the network with imperfect information. Knowing that fanout is faster than reconciliation, we want to have a higher fanout rate at the very beginning of the propagation, to get as far as we can, being fully efficient. This can be tied to how many of our peers know about the transaction already. Once the transaction is sufficiently spread, we can just reconcile it with the rest of our peers.\r\nThis does not apply to inbounds, as they are not trusted, and the metric will be easily abused, plus it may be used to leak transaction origin information. For them, we just keep a low fanout rate.\r\n\r\n## Testing and simulating\r\n\r\nThe last two commits of this PR are currently for simulation only. They allow to easily config the inbound/outbound fanout rate without having to recompile the code, and make full reconciliation more efficient.\r\n",
      "state": "open",
      "user": "sr-gi",
      "created_at": "2024-06-12T17:18:05Z",
      "updated_at": "2026-02-04T16:01:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30277",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2818,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2501800868,
      "number": 32427,
      "title": "(RFC) kernel: Replace leveldb-based BlockTreeDB with flat-file based store",
      "body": "Opening this PR mostly to get concept/approach feedback.\r\n\r\nThis is motivated by the kernel library, where the internal usage of leveldb is a limiting factor to its future use cases. Specifically it is not possible to share leveldb databases between two processes. A notable use-case for the kernel library is accessing and analyzing existing block data. Currently this can only be done by first shutting down the node writing this data. Moving away from leveldb opens the door towards doing this in parallel. A flat file based approach was chosen, since the requirements for persistence here are fairly simple (no deletion, constant-size entries). The change also offers better performance by making node startup faster, and has a smaller on-disk footprint, though this is negligible in the grand scheme of things.\r\n\r\nThe BlockTreeStore introduces a new data format for storing block indexes and headers on disk. The class is very similar to the existing CBlockTreeDB, which stores the same data in a leveldb database. Unlike CBlockTreeDB, the data stored through the BlockTreeStore is directly serialized and written to flat .dat files. The storage schema introduced\r\nis simple. It relies on the assumption that no entry is ever deleted and that no duplicate entries are written. These assumptions hold for the current users of CBlockTreeDB.\r\n\r\nA write ahead ahead log and boolean flags as file existence checks ensure write atomicity. Every data entry is also given a crc32c checksum to detect data corruption.\r\n\r\nThe change also opens the door towards getting rid of having to reindex the block tree due to corruption (though switching from pruned -> un-pruned still requires extra logic). This would simplify a lot of kernel/validation code, as can be seen in this [commit](https://github.com/TheCharlatan/bitcoin/commit/bfb2709e1d116d4e613601c3f0140f099530159d#diff-28f178018e05634ee3f8ddce3f4e0cec334ae69915cecf92be8299c749d8d470). The implementation here should be fairly robust against corruption (no parallel read/writes, no background compaction).\r\n\r\nAn alternative to this pull request, that could allow the same kernel feature, would be closing and opening the leveldb database only when reading and writing. This might incur a (negligible) performance penalty, but more importantly requires careful consideration of how to handle any contentions when opening, which might have complex side effects due to our current locking mode. It would also be possible to introduce an existing database with the required features for just the block tree, but that would introduce reliance on a new dependency and come with its own tradeoffs. For these reasons I chose this approach.",
      "state": "open",
      "user": "sedited",
      "created_at": "2025-05-06T14:27:59Z",
      "updated_at": "2026-02-04T15:57:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32427",
      "labels": [
        "UTXO Db and Indexes",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2759,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3207919952,
      "number": 34401,
      "title": "kernel:  add serialization method for btck_BlockHeader API",
      "body": "This adds serialization for `btck_BlockHeader` API. Also, updated the `CheckHandle` to compare the byte content instead of size.\r\n\r\nFollow-up to #33822 .",
      "state": "open",
      "user": "yuvicc",
      "created_at": "2026-01-25T06:50:13Z",
      "updated_at": "2026-02-04T15:41:49Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34401",
      "labels": [
        "Validation",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 212,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2748998057,
      "number": 33199,
      "title": "fees: enable `CBlockPolicyEstimator` return sub 1 sat/vb fee rate estimates",
      "body": "This is a simple PR that updates the block policy estimator’s `MIN_BUCKET_FEERATE` constant to be identical to the policy `DEFAULT_MIN_RELAY_TX_FEE`. \r\nIt also enables the fee estimator to record transactions with a fee rate up to the `DEFAULT_MIN_RELAY_TX_FEE` in its stats, which effectively allows the estimator to return sub-1 sat/vB fee rate estimates.\r\n\r\nThe change is correct because the estimator creates buckets of fee rates from\r\n`MIN_BUCKET_FEERATE`,\r\n`MIN_BUCKET_FEERATE` + `FEE_SPACING`,\r\n`MIN_BUCKET_FEERATE` + `2 * FEE_SPACING`,\r\n… up to `MAX_BUCKET_FEERATE`.\r\n\r\nThis means it will record sub-1 sat/vB fee rates in the buckets and may return them as a fee rate estimate when that bucket is the lowest one with sufficient transactions for a given target.\r\n\r\nTying `MIN_BUCKET_FEERATE` to `DEFAULT_MIN_RELAY_TX_FEE` also makes it dynamic, so we don’t need to update the fee estimator when the `minrelaytxfee` default is adjusted in the future.\r\n\r\nFor the mempool fee rate estimator in #31664, no update is needed since it uses the block assembler and because the node can see sub-1 sat/vB transactions, it can generate block templates with those and therefore return a fee rate estimate accordingly.\r\n\r\n---\r\n\r\nWhile touching this part of the fee estimator code, this PR got rid of the dummy value persisted in the file",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2025-08-15T15:15:26Z",
      "updated_at": "2026-02-04T14:49:25Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33199",
      "labels": [
        "TX fees and policy"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1407,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3203071670,
      "number": 34389,
      "title": "net/log: standardize peer+addr log formatting via `LogPeer`",
      "body": "This is an alternative to #34293, but aims to address the remaining logging inconsistencies more broadly.\r\nIt extends the example fixed there to every instance, restores the original separator behavior, applies it consistently via a single helper, and adds tests for `logips` (covering both current and new behavior).\r\n\r\n### Problem\r\nAfter #28521 centralized peer address logging into `CNode::LogIP()`, the original comma separator before `peeraddr=` was lost, resulting in inconsistent formatting across net (and recent private broadcast) logs.\r\nSome lines also had double spaces, empty fields, or mismatched format specifiers.\r\n\r\n### Fix\r\nIntroduces `CNode::LogPeer(bool)` which always emits `peer=<id>` and, when `-logips=1`, appends `, peeraddr=<addr>`. This eliminates hand-rolled separators and makes peer identification predictable.\r\nMinor issues (double spaces, empty placeholders, format specifiers) are fixed along the way in separate commits.\r\n\r\n### Reproducer\r\nRun with `-debug=net -logips=1` and observe peer log lines now show `peer=<id>, peeraddr=<addr>` (comma-separated). The new assertion in `feature_logging.py` automates this check.\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-23T12:09:26Z",
      "updated_at": "2026-02-04T14:48:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34389",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1214,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2837615883,
      "number": 33421,
      "title": "node: add  `BlockTemplateCache`",
      "body": "This PR implements the first step of #33758 by adding a cache layer for node block templates.\r\n\r\nThe cache stores newly created block templates along with their configuration options. When clients request a block template, they specify an optional template age limit in `MillisecondsDouble`:\r\n\r\n- If template age limit is `nullopt`, we create a new template and return it without adding it to the cache.\r\n- If a matching template (block template with identical block creation options) exists in the cache and hasn't exceeded the age limit, the cached version is returned.\r\n- If no matching template exists or the age limit has been exceeded, a new template is generated, cached, and returned. When evicting stale templates, we assume no duplicates exist since templates are evicted as soon as their age limit is reached or exceeded.\r\n\r\nThe cache maintains a configurable maximum size (default: 10 templates). When this limit is exceeded, the oldest template is evicted after each insertion.\r\n\r\n\r\nCache lookup requires an exact match on ALL `BlockAssembler::Options` fields. While some fields (e.g., `test_block_validity`, `print_modified_fee`, `coinbase_output_script`) could be ignored for cache reuse, they mainly differ in tests and benchmarks. We keep the logic simple and accept cache misses in those cases.\r\n\r\n\r\nThe cache enforces at most one template per set of options. When searching for a match in `getCachedTemplate()`, if a template with matching options is found but has exceeded the age limit, it's immediately evicted before returning `nullptr`. This ensures no duplicate options exist in the cache. A `SanityCheck()` method verifies this invariant in tests by checking all cached entries for duplicates.\r\n\r\n\r\nThe cache subscribes to the validation interface and clears itself when blocks are connected (to non-historical chainstate to avoid clearing during assumeutxo background validation) or disconnected from the active chain (during reorgs), preventing stale or invalid templates from being served.\r\n\r\n`GetBlockTemplate()` uses double-checked locking: it first checks the cache with only `m_mutex` held, then if there's a miss, acquires both `cs_main` and `m_mutex` to create the template. Before creating, it checks again since another thread might have added a template while locks were released. \r\n\r\nThis PR removes an unused `node/context.h` import from miner to prevent a circular dependency when exposing the block template cache to the node context.",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2025-09-17T18:47:09Z",
      "updated_at": "2026-02-04T14:22:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33421",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2508,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3224701572,
      "number": 34451,
      "title": "rpc: fix race condition in gettxoutsetinfo",
      "body": "Fixes #34263\r\n\r\nA `CHECK_NONFATAL` assertion failure could occur in `gettxoutsetinfo` when a new block was connected between capturing `pindex` and validating it in `GetUTXOStats()`.\r\n\r\nThe fix removes the early `pindex` capture since `ComputeUTXOStats()` independently fetches the current best block under lock. The response now uses `stats.hashBlock` and `stats.nHeight` (the actual computed values) instead of the potentially stale `pindex`.",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2026-01-29T18:57:02Z",
      "updated_at": "2026-02-04T14:20:15Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34451",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 487,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3193557787,
      "number": 34359,
      "title": "test: add test for rebroadcast of transaction received via p2p",
      "body": "The wallet doesn't only rebroadcast transactions it created, but also relevant transactions received via p2p. \r\nSince this is not self-evident, add test coverage for it.",
      "state": "open",
      "user": "mzumsande",
      "created_at": "2026-01-21T02:42:05Z",
      "updated_at": "2026-02-04T14:15:28Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34359",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 232,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3209325275,
      "number": 34405,
      "title": "wallet: skip APS when no partial spend exists",
      "body": "Fixes #25150\n\nAPS (Avoid Partial Spends) runs a second coin selection pass to fully spend\nUTXOs sharing a scriptPubKey. This currently runs unconditionally, even when\nthe first selection has no partial spend. Running APS unnecessarily wastes\ncomputation and can produce a worse result when there was nothing to fix.\n\nDetect partial spends by comparing selected vs available UTXO counts per\nscriptPubKey, reusing available_coins. Skip APS if none found.\n\nTest updated to create partial spend scenarios so tracepoints fire.\n\n---\n\n*Supersedes #34362 which was corrupted by a shallow clone force-push.*",
      "state": "open",
      "user": "8144225309",
      "created_at": "2026-01-26T04:36:55Z",
      "updated_at": "2026-02-04T14:00:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34405",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 644,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3238039267,
      "number": 34488,
      "title": "refactor: Small style and test fixups for bitcoinkernel",
      "body": "Just some small style and test fixups after https://github.com/bitcoin/bitcoin/pull/30595#pullrequestreview-3420542946",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-02-02T19:53:48Z",
      "updated_at": "2026-02-04T13:53:45Z",
      "merged_at": "2026-02-04T13:48:29Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34488",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 174,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3163940035,
      "number": 34256,
      "title": "test: support `get_bind_addrs` and `feature_bind_extra` on macOS",
      "body": "### Problem\r\n\r\nSome functional tests are shown as skipped when running on macOS because `test_framework/netutil.py` only implemented the Linux-specific logic for checking which TCP sockets a node is listening on.\r\n\r\n### Fix\r\n\r\nAdd macOS implementations in `test/functional/test_framework/netutil.py` so tests can query:\r\n\r\n* which TCP sockets a node is listening on (`get_bind_addrs()`, via `lsof`)\r\n* a non-loopback interface address (`all_interfaces()`, via `ifconfig`)\r\n\r\nThen enable the previously Linux-only tests by switching to a shared platform guard.\r\n\r\n### Commands\r\n<details>\r\n<summary><code>get_bind_addrs()</code> (<code>lsof</code> + regex)</summary>\r\n\r\n> Command used\r\n```bash\r\nlsof -nP -a -p <pid> -iTCP -sTCP:LISTEN -Ftn\r\n```\r\n\r\n> Flags\r\n\r\n- -n: no hostname resolution\r\n- -P: no service/port-name resolution\r\n- -a: AND all conditions\r\n- -p <pid>: filter by process ID\r\n- -iTCP: TCP sockets only\r\n- -sTCP:LISTEN: listening sockets only\r\n- -Ftn: machine-readable output (fields: type t, name n)\r\n\r\n> Regex parser\r\n\r\n```regex\r\nt(IPv[46])\\nn(\\*|\\[.+?]|[^:]+):(\\d+)\r\n```\r\n> Captured groups\r\n\r\n- group 1: IPv4 / IPv6 (used to disambiguate *)\r\n- group 2: host (*, [::1], 127.0.0.1, …)\r\n- group 3: port\r\n</details>\r\n\r\n<details>\r\n<summary><code>all_interfaces()</code> (<code>ifconfig</code> + regex)</summary>\r\n\r\n> Command used\r\n\r\n```bash\r\nifconfig -au\r\n```\r\n\r\n> Regex parsing\r\n\r\nInterface blocks:\r\n```regex\r\n(?m)^(?P<iface>\\S+):(?P<block>[^\\n]*(?:\\n[ \\t]+[^\\n]*)*)\r\n```\r\n\r\nIPv4 extraction within each block:\r\n```regex\r\ninet (\\S+)\r\n```\r\n</details>\r\n\r\n### Notes\r\n\r\nThe only remaining platform skips on macOS are the USDT/BPF tracing tests (interface_usdt_*.py).\r\n\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-11T21:42:11Z",
      "updated_at": "2026-02-04T13:53:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34256",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 1738,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3123216401,
      "number": 34138,
      "title": "Cluster mempool: more accurate cost model for SFL",
      "body": "Builds on top of #34023, part of #30289.\r\n\r\nThis introduces a more accurate cost model for SFL, to control how much CPU time is spent inside the algorithm for clusters that cannot be linearized perfectly within a reasonable amount of time.\r\n\r\nThe goal is having a metric for the amount of work performed, so that txmempool can impose limits on that work: a lower bound that is always performed (unless optimality is reached before that point, of course), and an upper bound to limit the latency and total CPU time spent on this. There are conflicting design goals here:\r\n* On the one hand, it seems ideal if this metric is closely correlated to actual CPU time, because otherwise the limits become inaccurate.\r\n* On the other hand, it seems a nightmare to have the metric be platform/system dependent, as it makes network-wide reasoning nearly impossible. It's expected that slower systems take longer to do the same thing; this holds for everything, and we don't need to compensate for this.\r\n\r\nThere are multiple solutions to this:\r\n* One extreme is just measuring the time. This is very accurate, but extremely platform dependent, and also non-deterministic due to random scheduling/cache effects.\r\n* The other extreme is using a very abstract metric like counting how many times certain loops/function inside the algorithm run. That is what is implemented as of #32545 and #34023, just counting the sum of the numbers of transactions updated across all `UpdateChunks()` calls. It however necessarily fails to account for significant portions of runtime spent elsewhere, resulting in a rather wide range of \"ns per cost\" values.\r\n* This PR takes a middle ground, counting many function calls / branches / loops, with weights that were determined through benchmarking on a reference system (Zen 4 based).\r\n\r\nThis is draft because:\r\n* The weights used are outdated, as several non-trivial improvements were made to #32545 and #34023 since.\r\n* I don't know if it is the right middle ground, and it seems good to have some conceptual discussion first:\r\n  * Using benchmarks on a reference system inherently captures some platform specifics, making it possible that the metric is not very accurate on other systems.\r\n  * A benchmark-based metric is nontrivial to maintain.",
      "state": "open",
      "user": "sipa",
      "created_at": "2025-12-22T14:57:53Z",
      "updated_at": "2026-02-04T13:29:03Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34138",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2320,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3243074063,
      "number": 34496,
      "title": "build: don't pass on boost dependency to kernel consumers",
      "body": "This is unnecessary now that the kernel now exports a (boost-less) API.\r\n\r\nNoticed while slimming down boost dependencies in #34495.",
      "state": "open",
      "user": "theuni",
      "created_at": "2026-02-03T21:40:53Z",
      "updated_at": "2026-02-04T13:23:55Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34496",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 190,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3210441228,
      "number": 34411,
      "title": "[POC] Full Libevent removal",
      "body": "This builds on all the work being done by pinheadmz and fjahr (#32061, #34342, #34158), to demo a libevent-less bitcoind.\r\n\r\nOne thing we could decide to change, or not, is the `libevent` logging catergory. Other than that, any remaining references to libevent, should be in documentation/code comments.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-26T12:35:26Z",
      "updated_at": "2026-02-04T13:20:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34411",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 331,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3242190443,
      "number": 34493,
      "title": "contrib: Remove valgrind suppression for bug 472219",
      "body": "Now that several Alpine releases are out, it seems fine to remove this suppression.\r\n\r\nThis should work since Alpine 3.19: https://pkgs.alpinelinux.org/packages?name=valgrind&branch=v3.19&repo=&arch=aarch64, which just dropped out of `main` support (https://alpinelinux.org/releases/)",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-02-03T17:23:57Z",
      "updated_at": "2026-02-04T12:49:24Z",
      "merged_at": "2026-02-04T10:50:13Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34493",
      "labels": [
        "Scripts and tools"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 336,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3215348124,
      "number": 34421,
      "title": "[RFC] ci: add Chimera Linux LTO job",
      "body": "Adds a CI job based on using [Chimera Linux](https://chimera-linux.org/). This might be interesting for any of the following:\r\n* Chimera is based on LLVM & musl libc - we test both of these in isolation, but not together.\r\n* No GNU components. I don't think we have an existing Linux CI job that doesn't have a gcc/stdlibc++ install. This exercises the depends logic for a fully LLVM/Clang/lld only build, including building the native tools (related to #33902).\r\n* We don't currently have a job with LTO enabled (here using CMakes `CMAKE_INTERPROCEDURAL_OPTIMIZATION`, which is `-flto=thin` for LLVM/Clang). I think this is worth having generally (we do use LTO in some other places, like oss-fuzz). If runtime is too much of an issue, then it could also be dropped. (Chimera itself is also compiled with LTO).\r\n\r\nQT in depends doesn't build, so is excluded for now:\r\n```bash\r\n/bitcoin/depends/work/build/aarch64-unknown-linux-musl/qt/6.7.3-fbcd806db9a/qtbase/src/corelib/thread/qyieldcpu.h:35:5: note: include the header <arm_acle.h> or explicitly provide a declaration for '__yield'\r\n/bitcoin/depends/work/build/aarch64-unknown-linux-musl/qt/6.7.3-fbcd806db9a/qtbase/src/corelib/tools/qhash.cpp:1452:45: error: 'memcpy' called with `n` bigger than the size of `d`.\r\n 1452 |         memcpy(&k, &key, sizeof(long double));\r\n      |                                             ^\r\n/usr/include/fortify/string.h:48:1: note: from 'diagnose_if' attribute on 'memcpy':\r\n   48 | __error_if((__fh_bos(__od, 0) < __n), \"'memcpy' called with `n` bigger than the size of `d`.\")\r\n      | ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n/usr/include/fortify/fortify-headers.h:120:47: note: expanded from macro '__error_if'\r\n  120 | #define __error_if(cond, msg) __attribute__ ((diagnose_if (cond, msg, \"error\")))\r\n      |                                               ^            ~~~~\r\n1 warning and 1 error generated.\r\n```\r\n\r\nIf anything, this pointed out at least a few quirks, i.e #34390 & #34408.\r\n\r\nBased on #34408.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-27T16:41:57Z",
      "updated_at": "2026-02-04T12:28:35Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34421",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2093,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3090774381,
      "number": 34047,
      "title": "cmake: Add fail pattern to `try_append_cxx_flags`",
      "body": "This PR addresses scenarios where the build environment, such as OSS-Fuzz, provides the `-Wno-error=unknown-warning-option` flag, which undermines our use of `-Werror` when checking compiler flags.\r\n\r\nTo reproduce the issue on the master branch @ c1f0a89d9caeb62a0a5f3462b454746941e626e6:\r\n```\r\n$ env CXX=clang++ CC=clang CXXFLAGS=\"-Wno-error=unknown-warning-option\" cmake -B build 2>&1 | grep WDUPLICATED_BRANCHES\r\n-- Performing Test CXX_SUPPORTS__WDUPLICATED_BRANCHES\r\n-- Performing Test CXX_SUPPORTS__WDUPLICATED_BRANCHES - Success\r\n```\r\n\r\nThis output shows that the `-Wduplicated-branches` flag is incorrectly treated as recognised by the compiler.\r\n\r\nNoticed while working on the [migration](https://github.com/google/oss-fuzz/pull/14457) to Ubuntu 24.04 in OSS-Fuzz.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-12-10T21:14:51Z",
      "updated_at": "2026-02-04T12:25:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34047",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 822,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2796848384,
      "number": 33297,
      "title": "cmake: Inherit WERROR setting for secp256k1 build",
      "body": "This change prevents unexpected CLI output when compiling with -DWERROR=ON (treat warnings as errors). This setting is now properly propagated to the secp256k1 subproject build. Previously, secp256k1 would be built without the -Werror flag even when the main project was configured to treat warnings as errors, creating inconsistent build behavior.\r\nhttps://github.com/bitcoin/bitcoin/issues/33284",
      "state": "open",
      "user": "jmoik",
      "created_at": "2025-09-03T18:34:06Z",
      "updated_at": "2026-02-04T12:19:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33297",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 447,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1768825209,
      "number": 29640,
      "title": "Fix tiebreak when loading blocks from disk (and add tests for comparing chain ties)",
      "body": "This PR grabs some interesting bits from https://github.com/bitcoin/bitcoin/pull/29284 and fixes some edge cases in how block tiebreaks are dealt with.\r\n\r\n## Regarding #29284\r\n\r\nThe main functionality from the PR was dropped given it was not an issue anymore, however, reviewers pointed out some comments were outdated https://github.com/bitcoin/bitcoin/pull/29284#discussion_r1522023578 (which to my understanding may have led to thinking that there was still an issue) it also added test coverage for the aforementioned case which was already passing on master and is useful to keep.\r\n\r\n## New functionality\r\n\r\nWhile reviewing the superseded PR, it was noticed that blocks that are loaded from disk may face a similar issue (check https://github.com/bitcoin/bitcoin/pull/29284#issuecomment-1994317785 for more context).\r\n\r\nThe issue comes from how tiebreaks for equal work blocks are handled: if two blocks have the same amount of work, the one that is activatable first wins, that is, the one for which we have all its data (and all of its ancestors'). The variable that keeps track of this, within `CBlockIndex` is `nSequenceId`, which is not persisted over restarts. This means that when a node is restarted, all blocks loaded from disk are defaulted the same `nSequenceId`: 0. \r\nNow, when trying to decide what chain is best on loading blocks from disk, the previous tiebreaker rule is not decisive anymore, so the `CBlockIndexWorkComparator` has to default to its last rule: whatever block is loaded first (has a smaller memory address). \r\n\r\nThis means that if multiple same work tip candidates were available before restarting the node, it could be the case that the selected chain tip after restarting does not match the one before.\r\n\r\nTherefore, the way `nSequenceId` is initialized is changed to:\r\n\r\n- 0 for blocks that belong to the previously known best chain\r\n- 1 to all other blocks loaded from disk",
      "state": "closed",
      "user": "sr-gi",
      "created_at": "2024-03-12T20:11:04Z",
      "updated_at": "2026-02-04T12:17:50Z",
      "merged_at": "2025-10-27T16:17:53Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29640",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1998,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3216159492,
      "number": 34424,
      "title": "[RFC] CChain Concurrency Improvement (Base + Tail Architecture)",
      "body": "## RFC: CChain Concurrency Improvement\r\n\r\nThis PR implements a copy-on-write based CChain design to enable concurrent access.\r\n\r\n### Motivation\r\n\r\nCurrent CChain uses a single vector protected by `cs_main`, creating bottlenecks for multi-threaded access. This PR lays the groundwork for removing `cs_main` locks by enabling consistent snapshots without holding locks.\r\n\r\n### Design\r\n\r\nSee full design document: [CChain Concurrency](https://github.com/alexanderwiederin/bitcoinkernel-proposals/blob/master/cchain-concurrency.md) (**Out of date after mutex removal** - will be updated soon)\r\n\r\n**TL;DR:** Split chain into base (bulk of history) + tail (recent ~1,000 blocks). Use nested `stlab::copy_on_write` so updates copy only tail, keeping base shared.\r\n\r\n*Thanks to @purplekarrot for pointing me to `stlab::copy_on_write` and making design suggestions.*\r\n\r\n### Changes\r\n\r\n- Implements copy-on-write based CChain with value semantics\r\n- Removes `cs_main` locks from RPC methods (where possible)\r\n- All validation locks remain in place (`cs_main` still held during validation)\r\n- API unchanged - backward compatible\r\n\r\n### Request for Comments\r\n\r\n1. Is the nested copy-on-write architecture sound?\r\n2. Is `MAX_TAIL_SIZE = 1000` reasonable?\r\n3. What are the concerns for future lock removal?\r\n4. Is the added complexity worth the benefit?",
      "state": "open",
      "user": "alexanderwiederin",
      "created_at": "2026-01-27T20:44:43Z",
      "updated_at": "2026-02-04T12:11:51Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34424",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1403,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3220693682,
      "number": 34436,
      "title": "refactor + log: use new `CeilDiv` helper in UTXO `Flushing` warning",
      "body": "### Problem\r\nThe `Flushing large (... GiB) UTXO set...` warning was rounding the target value down (e.g. `1643.7MiB` was printed as `1 GiB`) which downplayed the warning that is meant to set the user's expectations.\r\n\r\n### Fixes\r\nThis PR starts with introducing a small overflow-safe integer `CeilDiv()` helper and replaces existing ceiling-division expressions across the codebase as a pure refactor.\r\nIn the second commit, this method is applied to change the flushing message slightly by rounding the batch size up, amending https://github.com/bitcoin/bitcoin/pull/31534 which introduced the warning.\r\n\r\n### Reproducer:\r\n> killall bitcoind; rm -rfd build demo; mkdir demo && cmake -B build >/dev/null 2>&1 && cmake --build build -j$(nproc) --target bitcoind >/dev/null 2>&1 && build/bin/bitcoind -datadir=demo-dbcache=2000 -stopatheight=300000 | egrep 'height=300000|Flushing large'\r\n\r\nBefore:\r\n```bash\r\nUpdateTip: new best=000000000000000082ccf8f1557c5d40b21edabb18d2d691cfbf87118bac7254 height=300000 version=0x00000002 log2_work=78.499549 tx=38463789 date='2014-05-10T06:32:34Z'\r\nprogress=0.029457 cache=1643.7MiB(11822004txo)\r\n[warning] Flushing large (1 GiB) UTXO set to disk, it may take several minutes\r\n```\r\n\r\nAfter:\r\n```bash\r\nUpdateTip: new best=000000000000000082ccf8f1557c5d40b21edabb18d2d691cfbf87118bac7254 height=300000 version=0x00000002 log2_work=78.499549 tx=38463789 date='2014-05-10T06:32:34Z'\r\nprogress=0.029457 cache=1643.7MiB(11822004txo)\r\n[warning] Flushing large (2 GiB) UTXO set to disk, it may take several minutes\r\n```\r\n\r\nThe cache line shows `1643.7MiB`, which now rounds up to `2 GiB` instead of down to `1 GiB`.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-28T21:47:06Z",
      "updated_at": "2026-02-04T11:17:33Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34436",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1712,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2818039408,
      "number": 33362,
      "title": "Run feature_bind_port_(discover|externalip).py in CI",
      "body": "This PR includes https://github.com/bitcoin/bitcoin/pull/32757 (first two commits here).\r\n\r\nThen, on top of that:\r\n\r\n`feature_bind_port_discover.py` and `feature_bind_port_externalip.py` require a routable address on the machine to run. Since that was not predictably available on CI, those tests required a manual setting up of IP addresses (e.g. using `ifconfig`) and then running the tests with a command line option telling them that the addresses are set up. The tests were not run in CI and [got rot](https://github.com/bitcoin/bitcoin/issues/31293#issuecomment-2497792487).\r\n\r\nChange that to auto-detect, from the tests, whether the needed IP addresses are present and if yes, run the test, otherwise skip it. Also change the CI to configure the needed addresses when running the functional tests. This way the tests will be run regularly on CI.\r\n\r\nFixes: https://github.com/bitcoin/bitcoin/issues/31293\r\nFixes: https://github.com/bitcoin/bitcoin/issues/31336\r\n",
      "state": "open",
      "user": "vasild",
      "created_at": "2025-09-11T07:50:42Z",
      "updated_at": "2026-02-04T11:15:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33362",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1021,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3102178109,
      "number": 34075,
      "title": "fees: Introduce Mempool Based Fee Estimation to reduce overestimation",
      "body": "This PR is another attempt to fix #27995 using a better approach.\r\n\r\nFor background and motivation, see #27995 and the discussion in the Delving Bitcoin post [Mempool Based Fee Estimation on Bitcoin Core](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703)\r\nThis PR is currently limited to using the mempool only to lower what is recommended by the Block Policy Estimator.\r\nAccurate and safe fee estimation using the mempool is challenging. There are open questions about how to prevent mempool games that are theoretically possible for miners [(a variant of the Finney attack)](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/6)\r\n\r\nThis is one of the reasons I opted to use the mempool only to lower the Block Policy Estimator, which itself is not gameable, and therefore this mechanism is not susceptible to this attack.\r\n\r\nThe underlying assumption here is that, with the current tools and work done to make RBF and CPFP feasible and guarantee (TRUC transaction relay, ephemeral anchors, cluster size 2 package rbf), it is safer to underestimate rather than overestimate.\r\nWe now assume it is relatively easy to fee-bump later if a transaction does not confirm, whereas once a fee is overestimated there is no way to recover from that.\r\n\r\nAnother open question when using the mempool for fee estimation is how to account for incoming transaction inflow.\r\n[Bitcoin Augur](https://github.com/block/bitcoin-augur) does this by using past inflow plus a constant expected inflow to predict future inflow. I find this unconvincing for fee estimation and potentially prone to more overestimation, as past conditions are not always representative of the future. See my [review of the Augur fee rate estimator and open questions](https://github.com/block/bitcoin-augur/issues/3).\r\n\r\nThis PR uses a much simpler approach based on current user behavior, similar to the widely used method employed by mempool.space: looking at the top block of the mempool and selecting a percentile feerate depending on whether the user is economical or conservative.\r\n\r\nEmpirical data from both myself and Clara Shikhelman shows that the 75th percentile feerate for economical users and the 50th percentile feerate for conservative users provide positive confirmation guarantees, hence this is what is used in this PR.\r\n\r\nParallel research by René Pickhardt and his student suggests that using the [average fee per byte of the block template performs well](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/12).\r\n\r\nAll of these are constants that can be adjusted, there is parallel work exploring these constants and running benchmarks across fee estimators to find a sweet spot.\r\n\r\nSee also work in LND, the [LND Budget Sweeper](https://delvingbitcoin.org/t/lnds-deadline-aware-budget-sweeper/1512), which applies this idea successfully. Their approach is to estimate fees initially with bitcoind, then increment gradually as the confirmation deadline approaches, using a fixed fee budget.\r\n\r\nHistorical data indicates that by doing only the approach in this PR, we are able to [reduce overestimation quite significantly (~29%)](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/8).\r\n\r\nThis is particularly useful in scenarios where the Block Policy Estimator recommends a high feerate while the mempool is empty.\r\n<img width=\"1800\" height=\"1090\" alt=\"56f3ba26c0184521c42bb82ec9d8c9f2224d4f8e\" src=\"https://github.com/user-attachments/assets/c035c40c-8ece-42a7-b290-d29f1ac9bf4d\" />\r\n\r\nAs seen in the image above, there is only one remaining unfixed case: when there is a sudden inflow of transactions and the feerate rises, the Block Policy Estimator takes time to reflect this. In that case, users will continue to see a low feerate estimate until it slowly updates. From the historical data linked above, [this occurs about ~26% of the time](https://delvingbitcoin.org/t/mempool-based-fee-estimation-on-bitcoin-core/703/8)).\r\n\r\nOverall, we observe a **73% success rate with 0% overestimation, and 26% underestimation** with this approach.\r\n\r\nThis PR also includes refactors that enable this work. Rather than splitting the PR and implementing changes incrementally, I opted for an end-to-end implementation:\r\n\r\n### 1. Refactors\r\n\r\n* Separation of feerate format from the fee estimate mode enumerator (separation of concerns, as they are semantically distinct)\r\n* Move logging after fee estimation estimateSmartFee from the wallet to the Block Policy Estimator internal method (also separation of concerns and avoiding leaking fee estimator internals). This change also comes with updating `createTransactionInternal` to log only the fee and its source (fee estimator, fallback fee, etc.), which is more appropriate.\r\n* Separate the fee estimate mode enum from the fee source enumerator (separation of concerns, as they are semantically distinct). This introduces a minor breaking change: the wallet RPCs now return fee *source* instead of fee *reason*, which is more accurate. Let me know if we prefer to keep the field name unchanged while returning the fee source.\r\n* Move the `StringForReason` enum from `common` to the Block Policy Estimator (also separation of concerns)\r\n* Various test file updates and renames for improved accuracy\r\n* Update Block Policy Estimator unit tests to be independent of the mempool and the validation interface\r\n\r\n### 2. Introduce Mempool-Based Fee Estimator and Fee Estimator Manager\r\n\r\n* Introduce a new abstract fee estimator base class that all fee estimators must implement\r\n\r\n* Introduce `FeeRateEstimateResult` as the response type, containing metadata and avoiding the use of out-parameters. This is easily extensible and makes future changes less invasive, as method signatures do not need to change.\r\n\r\n* Add `FeeEstimatorType` enum to identify different fee estimators\r\n\r\n* Make `CBlockPolicyEstimator` derive from the new fee estimator base class\r\n\r\n* Add `FeeRateEstimatorManager`, responsible for managing all fee estimators\r\n\r\n* Update the node context to store a `unique_ptr` to `FeeRateEstimatorManager` instead of `CBlockPolicyEstimator`\r\n\r\n* Update `CBlockPolicyEstimator` to no longer subscribe directly to the validation interface; instead, `FeeRateEstimatorManager` subscribes and forwards relevant notifications\r\n\r\n* Add a percentile calculation function that takes the chunk feerates of a block template and returns feerate percentiles; this can also be reused by the `getblockstats` RPC\r\n\r\n* Add a mempool fee estimator that generates a block template when called, calculates a percentile feerate, and returns the 75th percentile for economical mode or the 50th percentile for conservative mode\r\n\r\n* Add caching to the mempool estimator so that new estimates are generated only every 7 seconds, assuming enough [transactions have propagated](https://bitcoin.stackexchange.com/questions/125776/how-long-does-it-take-for-a-transaction-to-propagate-through-the-network/125777#125777) to make a meaningful difference.\r\n  This heuristic will likely be replaced by requesting block templates via the general-purpose block template cache proposed here: [https://github.com/bitcoin/bitcoin/issues/33389](https://github.com/bitcoin/bitcoin/issues/33389)\r\n\r\n* Update `MempoolTransactionRemovedForBlock` to return the actual block transactions as well\r\n\r\n* Track the weight of block transactions and evicted transactions after each block connection\r\n  This data is tracked for the last 6 mined blocks. A mempool feerate estimate is returned only when the average ratio of mempool transaction weight evicted due to `BLOCK` reasons to block transaction weight is greater than 75%. This heuristic provides rough confidence that the node’s mempool matches that of the majority of the hashrate. The 75% threshold is arbitrary and can be adjusted.\r\n\r\nThere is a caveat when transactions in the local mempool are consistently not mined by the network, as described in #27995 (e.g., due to filtering).\r\nAccounting for these transactions during fee estimation is not necessary, as they should be evicted from the mempool itself (see #33510). Handling this again within fee estimation would be redundant.\r\n\r\n* Persist statistics for the 6 most recent blocks to disk during periodic flushes and shutdown, so this data is available after restarts\r\n* Expose this data to users when running `estimatesmartfee` with verbosity > 2\r\n\r\n<details>\r\n<summary>see example output</summary>\r\n\r\n```\r\nbitcoin-cli estimatesmartfee 1 \"conservative\" 2\r\n```\r\n\r\n```\r\n{\r\n  \"feerate\": 0.00002133,\r\n  \"errors\": [],\r\n  \"blocks\": 2,\r\n  \"mempool_health_statistics\": [\r\n    {\r\n      \"block_height\": 927953,\r\n      \"block_weight\": 3991729,\r\n      \"mempool_txs_weight\": 3942409,\r\n      \"ratio\": 0.987644451815241\r\n    },\r\n    ...\r\n  ]\r\n}\r\n```\r\n\r\n</details>",
      "state": "open",
      "user": "ismaelsadeeq",
      "created_at": "2025-12-15T11:53:35Z",
      "updated_at": "2026-02-04T11:09:15Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34075",
      "labels": [
        "TX fees and policy"
      ],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 1,
        "text_length": 8927,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2109581191,
      "number": 31042,
      "title": "build: Rename `PACKAGE_*` variables to `CLIENT_*`",
      "body": "The use of `PACKAGE_NAME` for the project's variable name is problematic, as this name is commonly used in CMake's [interface variables](https://cmake.org/cmake/help/latest/command/find_package.html#config-mode-version-selection). If third-party CMake code handles with scopes improperly, our `PACKAGE_NAME` variable could end up with an unexpected value.\r\n\r\nThis PR avoids such conflicts by renaming all `PACKAGE_*` variables to `CLIENT_*`.\r\n\r\nThe code in the master branch works correctly only incidentally. It is definitely broken in https://github.com/bitcoin/bitcoin/pull/30997.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2024-10-06T21:37:11Z",
      "updated_at": "2026-02-04T11:06:58Z",
      "merged_at": "2024-10-28T15:45:28Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31042",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 633,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2074412969,
      "number": 30909,
      "title": "wallet, assumeutxo: Don't Assume m_chain_tx_count, Improve wallet RPC errors",
      "body": "A test that is added as part of #30455 uncovered this issue: The `GuessVerificationProgress` function is used during during descriptor import and relies on `m_chain_tx_count`. In #29370 an [`Assume` was added](https://github.com/bitcoin/bitcoin/pull/29370/commits/0fd915ee6bef63bb360ccc5c039a3c11676c38e3) expecting the `m_chaint_tx_count` to be set. However, as the test uncovered, `GuessVerificationProgress` is called with background sync blocks that have `m_chaint_tx_count = 0` when they have not been downloaded and processed yet.\r\n\r\nThe simple fix is to remove the `Assume`. Users should not be thrown off by the `Internal bug detected` error. The behavior of `importdescriptor` is kept consistent with the behavior for blocks missing due to pruning.\r\n\r\nThe test by alfonsoromanz is cherry-picked here to show that the [CI errors](https://cirrus-ci.com/task/5110045812195328?logs=ci#L2535) should be fixed by this change.\r\n\r\nThis PR also improves error messages returned by the `importdescriptors` and `rescanblockchain` RPCs. The error message now changes depending on the situation of the node, i.e. if pruning is happening or an assumutxo backgroundsync is active.",
      "state": "closed",
      "user": "fjahr",
      "created_at": "2024-09-16T16:19:23Z",
      "updated_at": "2026-02-04T11:06:58Z",
      "merged_at": "2025-01-31T20:45:23Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30909",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1251,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3242791811,
      "number": 34494,
      "title": "test: fix intermittent feature blockfile assertion",
      "body": "intermittent `feature_assumeutxo.py` failures were a race  with `-fastprune 64 KiB blockfiles`,\r\nthe `normal chainstate` can fill `blk00000.dat` and roll to `blk00002.dat` while the `snapshot chainstate` writes blk00001.dat before `-stopatheight` trips...the test now  tolerates `blk00002.dat` and  logs when it appears\r\nthe behavior remains unchanged, so we just stop failing on a benign rollover..\r\ni believe this should fix #33635",
      "state": "open",
      "user": "b-l-u-e",
      "created_at": "2026-02-03T20:20:48Z",
      "updated_at": "2026-02-04T11:06:39Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34494",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 484,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2591975893,
      "number": 32748,
      "title": "fees: fix noisy flushing log",
      "body": "This is a simple PR that updates the flushing log to use debug-level logging under the estimatefee category. It also ensures the log consistently includes only the full file path.\r\nThe motivation behind this is that the \"Flushed fee estimates to fee_estimates.dat.\" logs can become noisy; it's done after one hour, so hiding it in the debug estimatefee category seems reasonable. \r\n\r\n---\r\nI left the logs when the file is not found as info because that should only occur when you start a fresh node, change datadir, or explicitly delete the file",
      "state": "closed",
      "user": "ismaelsadeeq",
      "created_at": "2025-06-14T05:53:49Z",
      "updated_at": "2026-02-04T10:43:40Z",
      "merged_at": "2026-02-03T20:09:07Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32748",
      "labels": [
        "TX fees and policy"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 574,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3205154700,
      "number": 34396,
      "title": "fuzz: pull the latest FuzzedDataProvider.h from upstream",
      "body": "Pulls down the latest version of https://github.com/llvm/llvm-project/blob/main/compiler-rt/include/fuzzer/FuzzedDataProvider.h, after https://github.com/llvm/llvm-project/pull/177794 was merged upstream.\r\n\r\njust a note that in C++20 unsigned‑to‑signed conversion is no longer implementation defined so this is effectively a no‑op in Core and this is mainly an upstream cleanup update",
      "state": "closed",
      "user": "b-l-u-e",
      "created_at": "2026-01-23T22:41:30Z",
      "updated_at": "2026-02-04T10:31:00Z",
      "merged_at": "2026-02-02T09:55:52Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34396",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 441,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3244962702,
      "number": 34501,
      "title": "ci: [NOMERGE] exclude addrman_serdeser from instrumented fuzz",
      "body": "This PR is only being used to measure ci runtime differences.\r\n\r\n----\r\n\r\nThe addrman_serdeser target is slow under valgrind and msan instrumentation. It takes the majority of the ~1 hour runtime on its own. Exclude it from these jobs to reduce runtime.\r\n\r\nIt is still run in native_fuzz (\"fuzzer,address,undefined,integer\"), only without instrumentation.\r\n\r\n\r\n",
      "state": "closed",
      "user": "willcl-ark",
      "created_at": "2026-02-04T09:26:43Z",
      "updated_at": "2026-02-04T10:30:52Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34501",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 422,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2563709776,
      "number": 32672,
      "title": "ci: update pwsh to use custom shell that fails-fast",
      "body": "Github by default sets [fail fast](https://docs.github.com/en/actions/writing-workflows/workflow-syntax-for-github-actions#exit-codes-and-error-action-preference) behaviour on pswh shell which means that if any powershell cmdlet fails the script will stop and exit. The problem is that this behaviour doesn't apply when calling native executables, it only applies to powershell cmdlets.\r\n\r\nI think the safest thing is to whenever we use pwsh to enable `$PSNativeCommandUseErrorActionPreference = $true` which will also fail calling any exe that returns a non-zero exit code.\r\n\r\nTechnically the step `Adjust paths in test/config.ini` only uses cmdlets so this step will not benefit from this change but I feel like it's good practice to still enable this feature in case this script gets modified in the future to call an exe.\r\n\r\nHere is a CI run that has a script that fails silently (look at Windows Native, VS 2022 -> Get tool information): https://github.com/m3dwards/bitcoin/actions/runs/15415032095/job/43375709475\r\nAnd with this change applied, the script correctly fails: https://github.com/m3dwards/bitcoin/actions/runs/15416585565/job/43380685364",
      "state": "open",
      "user": "m3dwards",
      "created_at": "2025-06-03T12:03:44Z",
      "updated_at": "2026-02-04T10:24:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32672",
      "labels": [
        "Windows",
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1207,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3222520742,
      "number": 34440,
      "title": "Refactor CChain methods to use references, tests",
      "body": "Refactor `CChain` methods (`Contains()`, `Next()`, etc.) to use references instead of pointers, to minimize the risk of accidental `nullptr` dereference (memory access violation). Also add missing unit tests to the `CChain` class.\r\n\r\nThe `CChain::Contains()` method (in `src/chain.h`) dereferences its input without checking. The `Next()` method also calls into this with a `nullptr` if invoked with `nullptr`. While most call sites have indirect guarantee that the input is not `nullptr`, it's not easy to establish this to all call sites with high confidence. These methods are publicly available. There is no known high-level use case to trigger this error, but the fix is easy, and makes the code safer.\r\n\r\nChanges:\r\n\r\n- Add basic unit tests for `CChain` class methods\r\n- Refactor `CChain::Contains()` to take reference\r\n- Refactor `CChain::Next()` to take reference\r\n- Add unit tests for `CChain::FindFork()`\r\n- Change `PeerManagerImpl::BlockRequestAllowed()` to take reference\r\n\r\nTODO:\r\n\r\n- ? /Change `CChain` internals to store references instead of pointers/\r\n- ? /Explore the change to always have at least one element (genesis), that way there is always genesis and tip./\r\n- Check related methods to change to reference -- `FindFork`, `FindEarliestAtLeast`, `FindForkInGlobalIndex`, `blockman.AddToBlockIndex`, etc.\r\n\r\nAlternative. A simpler change is to stick with pointers, with extra checks where needed, see #34416 .\r\n\r\nThis change is remotely related to and indirectly triggered by #32875 .\r\n",
      "state": "open",
      "user": "optout21",
      "created_at": "2026-01-29T09:21:03Z",
      "updated_at": "2026-02-04T10:24:24Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34440",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1556,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3222524030,
      "number": 34441,
      "title": "ci: Allow running iwyu CI in worktree",
      "body": "Currently, the iwyu CI fails to run in a git-worktree, or git-archive. This is due to the use of `git diff`.\r\n\r\nFix this by force-initializing a dummy git repo with a single dummy commit.\r\n\r\nIt may be possible to detect when `git diff` is not available in the directory, and only apply the fallback when needed, but the git history is not needed and it is easier to unconditionally apply the git init.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-29T09:21:57Z",
      "updated_at": "2026-02-04T10:11:04Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34441",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 439,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3223998841,
      "number": 34448,
      "title": "ci, iwyu: Fix warnings in `src/util` and treat them as errors",
      "body": "This PR [continues](https://github.com/bitcoin/bitcoin/pull/33725#issuecomment-3466897433) the ongoing effort to enforce IWYU warnings.\r\n\r\nSee [Developer Notes](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#using-iwyu).",
      "state": "open",
      "user": "hebasto",
      "created_at": "2026-01-29T15:38:39Z",
      "updated_at": "2026-02-04T09:46:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34448",
      "labels": [
        "Refactoring",
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 305,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3244900897,
      "number": 34499,
      "title": "miniscript: Use valid script in test, etc (#31713 follow-ups)",
      "body": "* Add missing move https://github.com/bitcoin/bitcoin/pull/31713#discussion_r2722771821\r\n* Document reason behind moving entire `vector`s https://github.com/bitcoin/bitcoin/pull/31713#discussion_r2722932391\r\n* Make miniscript valid and improve test name https://github.com/bitcoin/bitcoin/pull/31713#discussion_r2722121348\r\n* Check for miniscript node depth rather than script size https://github.com/bitcoin/bitcoin/pull/31713#discussion_r2722062298\r\n* Use POSIX threads to reliably provoke stack overflow https://github.com/bitcoin/bitcoin/pull/31713#discussion_r2736355030",
      "state": "open",
      "user": "hodlinator",
      "created_at": "2026-02-04T09:09:54Z",
      "updated_at": "2026-02-04T09:41:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34499",
      "labels": [
        "Descriptors"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 637,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3175286711,
      "number": 34295,
      "title": "test: Improve STRICTENC/DERSIG unit tests",
      "body": "1. Remove a comment referencing a file that no longer exists in the codebase: `script_invalid.json`.\r\n\r\n2. Fix a test that isn't implemented as intended. The idea is to test execution order by providing a signature that would cause script failure when parsed. An empty signature does not cause script failure in `CHECKMULTISIG`. Use `OP_1` for the second signature instead of `OP_0`. \r\n\r\n3. Copy existing `STRICTENC` tests and change the flag to `DERSIG`. `DERSIG` is a consensus flag (unlike `STRICTENC`), so it'd be good to have dedicated test cases.\r\n\r\n`script_tests` pass on my end.",
      "state": "closed",
      "user": "billymcbip",
      "created_at": "2026-01-14T22:46:49Z",
      "updated_at": "2026-02-04T09:38:07Z",
      "merged_at": "2026-02-04T09:38:06Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34295",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 628,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3244762665,
      "number": 34498,
      "title": "iwyu: Fix patch to prefer `<cstdint>`",
      "body": "The goal of the [patch](https://github.com/bitcoin/bitcoin/blob/master/ci/test/01_iwyu.patch) is to suggest C++ headers rather than their C counterparts. However, for fixed width integer types, the patched IWYU currently suggests `<cinttypes>` where `<cstdint>` is sufficient.\r\n\r\nThis PR fixes this behavior.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2026-02-04T08:31:42Z",
      "updated_at": "2026-02-04T09:28:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34498",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 346,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2293116283,
      "number": 31713,
      "title": "miniscript refactor: Remove unique_ptr-indirection",
      "body": "Removes one level of unnecessary indirection, which was a change that originally [aided in finding one issue](https://github.com/bitcoin/bitcoin/pull/30866#pullrequestreview-2434704657) in #30866. Simplifies the code one step further than 09a1875ad8cddeb17c19af34b8282d37fed0937e belonging to aforementioned PR.\r\n\r\nAlso adds test which verifies resistance to stack overflow when it comes to `~Node()` and `Node::Clone()`.\r\n\r\nNo observed difference when running benchmarks: ExpandDescriptor/WalletIsMineDescriptors/WalletIsMineMigratedDescriptors/WalletLoadingDescriptors.\r\n\r\nFollowup to #30866.",
      "state": "closed",
      "user": "hodlinator",
      "created_at": "2025-01-22T21:16:33Z",
      "updated_at": "2026-02-04T09:12:12Z",
      "merged_at": "2026-01-30T23:18:20Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31713",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 645,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3226824452,
      "number": 34457,
      "title": "wallet: add private broadcast support for wallet transactions",
      "body": "## Summary\r\n\r\nExtends the private broadcast feature (#29415) to wallet transactions. When `-privatebroadcast=1` is enabled, wallet RPCs (`sendtoaddress`, `send`, `sendall`, `sendmany`) now broadcast transactions through short-lived Tor/I2P connections instead of announcing to all connected peers.\r\n\r\n## Key Changes\r\n\r\n**Centralized availability check** (commit 1)\r\n- Moves the Tor/I2P reachability check from `sendrawtransaction` RPC to `BroadcastTransaction()`\r\n- All broadcast callers now get consistent error handling\r\n\r\n**Wallet integration** (commit 2)\r\n- `CommitTransaction()`: Uses private broadcast when enabled, fails loudly if Tor/I2P unavailable\r\n- `ResubmitWalletTransactions()`: Rebroadcasts using the original broadcast method\r\n- Persists a `private_broadcast` flag in the wallet transaction's `mapValue`\r\n\r\n**Functional tests** (commits 3-4)\r\n- Tests wallet send via SOCKS5 proxy\r\n- Tests flag persistence across restarts\r\n- Tests error handling when Tor/I2P unavailable\r\n\r\n## Behavior Matrix\r\n\r\n| Scenario | TX Flag | Node Setting | Expected Behavior | Tested |\r\n|----------|---------------|--------------|-------------------|--------|\r\n| New tx | Private | - | Via SOCKS5, flag set | Test 1 ✓ |\r\n| Resubmit | Private | Public | Skip | Test 2 ✓ |\r\n| Resubmit | Public | Private | Skip | Test 3 ✓ |\r\n| Resubmit | Private | Private | Rebroadcast | Test 3 ✓ |\r\n| New tx | Private | - (no Tor) | RPC error | Test 4 ✓ |\r\n| Resubmit | Private | Private (no Tor) | Log error | Test 4 ✓ |\r\n\r\n**Why skip on mode mismatch?** Rebroadcasting via a different method than originally used may allow correlation of transaction to origin, or may indicate origin has `-privatebroadcast` enabled.\r\n",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2026-01-30T08:06:34Z",
      "updated_at": "2026-02-04T09:01:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34457",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1758,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2594396603,
      "number": 32757,
      "title": "net: Fix Discover() not running when using -bind=0.0.0.0:port",
      "body": "  This PR fixes two related issues with address discovery when using explicit bind addresses in Bitcoin Core:\r\n\r\n  -  #31293\r\n  -  #31336\r\n\r\nWhen using `-bind=0.0.0.0:port` (or `-bind=::`), the `Discover()` function was not being executed because the code only checked the `bind_on_any` flag. This led to two problems:\r\n- The node would not discover its own local addresses if an explicit \"any\" bind was used.\r\n- The functional test `feature_bind_port_discover.py` would fail, as it expects local addresses to be discovered in these cases.\r\n\r\nThis PR:\r\n1. Checks both `bind_on_any` and any bind addresses using `IsBindAny()`\r\n   Ensures `Discover()` runs when binding to 0.0.0.0 or ::, even if specified explicitly.\r\n2. Ensures correct address discovery\r\n   The node will now discover its own addresses when using explicit \"any\" binds, matching user expectations and fixing the test.\r\n3. Maintains backward compatibility\r\n   The semantic meaning of `bind_on_any` is preserved as defined in `net.h`:  \r\n   > \"True if the user did not specify -bind= or -whitebind= and thus we should bind on 0.0.0.0 (IPv4) and :: (IPv6)\"\r\n4. Updates the test to use dynamic ports\r\n   The functional test `feature_bind_port_discover.py` is updated to use dynamic ports instead of hardcoded ones, improving reliability.\r\n\r\nHow this PR Differs from #31492\r\n\r\n- Preserves the semantic meaning of `bind_on_any` (see `net.h`).\r\n- Uses a simpler approach: checks `IsBindAny()` on bind addresses, without modifying `GetListenPort()`.\r\n- Avoids code duplication with `DefaultOnionServiceTarget()`.\r\n\r\nReferences\r\n\r\n- Implementation follows the approach proposed in my [review comment on #31492](https://github.com/bitcoin/bitcoin/pull/31492#issuecomment-2941773645).\r\n\r\nCloses #31293\r\n\r\nThe #31336 has the overall test failure and requires both this PR and #33362 to be fully resolved.\r\n",
      "state": "open",
      "user": "b-l-u-e",
      "created_at": "2025-06-16T04:28:44Z",
      "updated_at": "2026-02-04T08:45:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32757",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1922,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3228775708,
      "number": 34465,
      "title": "refactor: separate log generation from log handling",
      "body": "This is a mostly move-only change. It's a small refactoring that allows logging macros to be used by including a simple `util/log.h` header instead of the full `logging.h` logging implementation.\r\n\r\nOriginal motivation for this change was to reduce the size and complexity of #34374 (kernel structured logging PR) and reduce the number of conflicts it causes with other PRs. But this should also make sense as a standalone change to have a clearer separation of concerns between log generation and log handling, and avoid needing to depend on the whole logging framework in call sites that only emit log messages.\r\n\r\nRecommended to review with `--color-moved=dimmed-zebra --color-moved-ws=ignore-all-space`",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2026-01-30T17:59:41Z",
      "updated_at": "2026-02-04T08:23:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34465",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 758,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3229673183,
      "number": 34467,
      "title": "net: don't perform network activity when networkactive=0",
      "body": "## Problem\r\nWhen starting bitcoind with `-networkactive=0`, the node still performs various network activities despite the user explicitly requesting that the P2P network be inactive. This results in unnecessary log messages and network overhead:\r\n\r\n- `[addrman] Selected IP:PORT from tried` - Address manager selections\r\n- `[net:error] Could not get best interface for default route` - Gateway detection attempts\r\n- `[tor] Error connecting to Tor control socket` - Tor control connection attempts\r\n- `[tor] Not connected to Tor control port` - Tor reconnection attempts\r\n- `[net] portmap: Could not determine IPv4/IPv6 default gateway` - UPnP/NAT-PMP attempts\r\n\r\nThis defeats the purpose of the `-networkactive` flag, which is documented as \"Enable all P2P network activity (default: 1)\".\r\n\r\n### Steps to Reproduce\r\n1. Start bitcoind with `bitcoind.exe -networkactive=0`\r\n2. Observe logs - despite the flag being set to disable network activity, addrman selections and network-related errors are logged\r\n\r\n### Expected Behavior\r\nNo network activity should occur when `-networkactive=0` is set at startup. The node should remain idle until network is activated via RPC command `setnetworkactive true`.\r\n\r\n## Solution\r\nThis PR ensures that when `networkactive=0`, no network initialization or activity occurs by:\r\n\r\n### 1. **ThreadOpenConnections (src/net.cpp)**\r\nAdded a check at the beginning of the main while loop to pause all outbound connection logic when `fNetworkActive` is false. This prevents:\r\n- Address selection from addrman\r\n- Connection attempts to peers\r\n- Feeler connections\r\n- Block relay connection attempts\r\n\r\nThis check follows the existing pattern used for DNS seed querying (lines 2345-2349) and uses the same synchronization mechanism (`fNetworkActive` atomic flag and `sleep_for` with interruption support).\r\n\r\n### 2. **StartMapPort (src/init.cpp)**\r\nMade NAT-PMP port mapping startup conditional on `-networkactive` being true. This prevents:\r\n- Port mapping initialization\r\n- Gateway detection attempts\r\n- Related network errors and log spam\r\n\r\n### 3. **StartTorControl (src/init.cpp)**\r\nMade Tor control thread startup conditional on `-networkactive` being true. This prevents:\r\n- Tor control socket connection attempts\r\n- Tor-related error logs\r\n- Unnecessary event loop setup\r\n\r\n## Testing\r\nThe fix has been verified to:\r\n- Compile without errors or warnings\r\n- Follow existing code patterns and conventions used in the same functions\r\n- Use the same argument parsing method as existing code (`args.GetBoolArg(\"-networkactive\", true)`)\r\n- Respect the interruption mechanism used throughout the codebase\r\n\r\n### Manual Testing\r\n```bash\r\n# Start with networkactive=0 - should see no network activity logs\r\nbitcoind -networkactive=0\r\n\r\n# Start with networkactive=1 (default) - normal behavior\r\nbitcoind\r\n```\r\n\r\nAffected Code Paths\r\n`src/net.cpp: CConnman::ThreadOpenConnections()` - Main connection management loop\r\n`src/init.cpp` Bitcoin Core initialization - MapPort and TorControl startup\r\n\r\nNotes\r\nThis change is backward compatible - default behavior (networkactive=1) is unchanged\r\nDynamic network activation via setnetworkactive true RPC will resume ThreadOpenConnections activity\r\nMapPort and TorControl remain stopped if started with networkactive=0 (can be addressed in follow-up if needed for dynamic activation)\r\n\r\nFixes #34190",
      "state": "open",
      "user": "saksham-1304",
      "created_at": "2026-01-30T23:44:08Z",
      "updated_at": "2026-02-04T08:10:28Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34467",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 3421,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3236363653,
      "number": 34479,
      "title": "fuzz: Add and use NodeClockContext",
      "body": "Iterating over fuzz inputs will usually be done in the same process. As the mocktime is global, it can theoretically leak from one fuzz input run into the next run, making it less deterministic.\r\n\r\nFix this issue, by adding and using a context manager to handle the mocktime and reset it before the end.\r\n\r\nThis refactor should not change any behavior.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-02-02T12:36:06Z",
      "updated_at": "2026-02-04T07:05:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34479",
      "labels": [
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 387,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3237226837,
      "number": 34483,
      "title": "refactor: Use SpanReader over DataStream",
      "body": "This changes all places, where possible, to use SpanReader over DataStream. This makes the code easier to read and reason about, because `SpanReader` can never write data. Also, the code should be minimally faster, because it avoids a full redundant copy of the whole vector of bytes.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-02-02T15:54:28Z",
      "updated_at": "2026-02-04T07:01:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34483",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 325,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3241050380,
      "number": 34491,
      "title": "ci: add FreeBSD Clang cross job",
      "body": "Alternative to #33562, which was adding a native FreeBSD job; however that had issues with permissions/caching, as well as potential determinism issues. This adds a FreeBSD cross job using Linux and Clang.\r\n\r\nThis is using FreeBSD 14,3, which avoids the issue in #34093.\r\n\r\nWould close #33438. The same changes here could also be used to produce FreeBSD binaries out of Guix.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-02-03T12:28:36Z",
      "updated_at": "2026-02-04T06:56:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34491",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 407,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3237671040,
      "number": 34486,
      "title": "net: Reduce local network activity when networkactive=0",
      "body": "Fixes https://github.com/bitcoin/bitcoin/issues/34190\r\n\r\nWhen `networkactive=0` is set, NAT-PMP port mapping and Tor **control connections**\r\nstill run in the background, mapping ports and logging retry attempts despite\r\nthe node being \"inactive.\"\r\n\r\nThis wires both subsystems to CConnman::SetNetworkActive so they start and stop\r\nwith the network state:\r\n\r\n- mapport: EnableMapPort is injected as a callback via CConnman::Options.\r\n  SetNetworkActive and SetMapPortEnabled both gate on network state.\r\n\r\n- torcontrol: is injected similarly. The callback dispatches onto the tor event loop via \r\n  event_base_once to respect thread ownership. `EVLOOP_NO_EXIT_ON_EMPTY` is \r\n  used to keep the event loop alive without keepalive timers, so the controller starts disconnected and waits for CConnman::Start() to signal.",
      "state": "open",
      "user": "willcl-ark",
      "created_at": "2026-02-02T17:46:47Z",
      "updated_at": "2026-02-04T06:48:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34486",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 873,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 344943058,
      "number": 17580,
      "title": "refactor: Add ALLOW_LIST flags and enforce usage in CheckArgFlags",
      "body": "<!-- begin based-on -->\n**This is based on #16545.** The non-base commits are:\n\n- [`44d38d5a921` common: Add support for combining ArgsManager flags](https://github.com/bitcoin/bitcoin/pull/17580/commits/44d38d5a921d2ea7f08a1ed1ef02632cc3cfcc19)\n- [`a16319602eb` scripted-diff: Add ALLOW_LIST flag to arguments retrieved with GetArgs](https://github.com/bitcoin/bitcoin/pull/17580/commits/a16319602ebab8fc3a24195aa8a809116d1a0371)\n- [`93c929ec81d` refactor: Fix more ALLOW_LIST arguments](https://github.com/bitcoin/bitcoin/pull/17580/commits/93c929ec81db112c6e850728c396d542b695923b)\n- [`a2c954b8a90` Always reject empty -blockfilterindex=\"\" arguments](https://github.com/bitcoin/bitcoin/pull/17580/commits/a2c954b8a90fa36b2131470c09f486604493f539)\n- [`c7aa26b7b79` refactor: Stop calling GetArg/IsArgSet on ALLOW_LIST options](https://github.com/bitcoin/bitcoin/pull/17580/commits/c7aa26b7b79a0346baff7cd7961855d4c7287a3c)\n- [`d96eb990a42` refactor: Always enforce ALLOW_LIST in CheckArgFlags](https://github.com/bitcoin/bitcoin/pull/17580/commits/d96eb990a42c5e89d156881b417075807b8b38a5)<!-- end -->\n\n---\n\nExcept for two `rpcauth` and `blockfilterindex` fixes (update: rpcauth fix was merged separately in #30401) this PR does not change any behavior outside of tests. It is just supposed to enforce internal consistency and prevent bugs by ensuring that list arguments are always retrieved with GetArgs() and non-list arguments are always retrieved with GetArg(). Followup PRs could use the ALLOW_LIST flags for better documentation and error checking in the future. For example, #17493 builds on this to disallow conflicting config values. \n\nThis change was originally made as part of #17493",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2019-11-24T20:05:39Z",
      "updated_at": "2026-02-04T01:24:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/17580",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1763,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3184839812,
      "number": 34329,
      "title": "rpc,net: Add private broadcast RPCs",
      "body": "Follow up from #29415 \r\n\r\nSending a transaction via private broadcast does not have any way for a user to track the status of the transaction before it gets returned by another peer. The default logs will likely be removed as well in #34267. Nor is there any way to abort a transaction once it has been added to the private broadcast queue.\r\n\r\nThis adds two new RPCs:\r\n- `getprivatebroadastinfo` returns information about what transactions are in the private broadcast queue, including all the peers' addresses we have chosen and timestamps for sending and reception acknowledgement. If the transaction was received back from a peer or otherwise stopped from being broadcast, this information and a timestamp of when we stopped is returned.\r\n- `abortprivatebroadcast` stops broadcasting a transaction in the private broadcast queue.",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2026-01-18T01:46:20Z",
      "updated_at": "2026-02-03T23:28:35Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34329",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 868,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1940576733,
      "number": 30342,
      "title": "kernel, logging: Pass Logger instances to kernel objects",
      "body": "Pass `Logger` instances to `BlockManager`, `CCoinsViewDB`, `CDBWrapper`, `Chainstate`, `ChainstateManager`, `CoinsViews`, and `CTxMemPool` classes so libbitcoinkernel applications and tests have the option to control where log output goes instead of having all output sent to the global logger.\n\nThis PR is an alternative to #30338. It is more limited because it only changes kernel code while leaving other parts of the codebase alone. It also takes the opportunity to migrate legacy LogPrint / LogPrintf calls to the new log macros introduced in #28318.\n\n---\n\n<!-- begin based-on -->\n**This is based on #29256 + #33847.** The non-base commits are:\n\n- [`b90765ae3ad` refactor: Pass Logger instances to kernel objects](https://github.com/bitcoin/bitcoin/pull/30342/commits/b90765ae3ad51e83bfa33878f8a48d0b02758ee7)\n- [`75b104f23c8` refactor: Log kernel output to local log instances](https://github.com/bitcoin/bitcoin/pull/30342/commits/75b104f23c81da39f5afa532619012b6acbb8f69)\n- [`6dbcb9b769b` refactor: Pass Logger instance to CTxMemPool](https://github.com/bitcoin/bitcoin/pull/30342/commits/6dbcb9b769b61b47c71630c71008138615763f76)\n- [`7b78335f66b` kernel: Drop global Logger instance](https://github.com/bitcoin/bitcoin/pull/30342/commits/7b78335f66b08d039f20dc31fb326883ab5ad3c8)<!-- end -->",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-06-26T17:52:24Z",
      "updated_at": "2026-02-03T23:21:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30342",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1357,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 837470043,
      "number": 24230,
      "title": "indexes: Stop using node internal types and locking cs_main, improve sync logic",
      "body": "This PR lets indexing code mostly run outside of the node process. It also improves indexing sync logic, which is moved out of indexing code to a new [`node::SyncChain()`](https://github.com/ryanofsky/bitcoin/blob/cf6d99bed842361fb06986780097fb80c9e879e4/src/node/chain.h#L21-L36) function.\r\n\r\nAlmost all the commits in this PR are small refactoring changes that move code from `src/index/` to `src/node/`, or replace references to node types like `CBlockIndex`, `CChain`, `CChainState` in index code. There are only two commits affecting indexing sync logic which make complicated or substantive changes:\r\n\r\n- [`8862eddeb68b` indexes: Rewrite chain sync logic, simplify index sync code](https://github.com/bitcoin/bitcoin/pull/24230/commits/8862eddeb68b8871421e8aa4e69c7fa567df4da5)\r\n- [`f458cf8a4ce1` indexes: Initialize indexes without holding cs_main](https://github.com/bitcoin/bitcoin/pull/24230/commits/f458cf8a4ce1c9a21633439122df929dbee53946)\r\n\r\nThe commit messages have more details about these and other changes. Followups to this PR will reuse indexing sync code for wallets (#15719, #11756) and let indexes run in separate processes (#10102)",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2022-02-01T16:56:28Z",
      "updated_at": "2026-02-03T22:57:25Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/24230",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1234,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3086363450,
      "number": 34036,
      "title": "contrib: update macOS SDK to Xcode-26.1.1-17B100",
      "body": "Updates the macOS SDK used for Guix builds to `Xcode-26.1.1-17B100`. \r\nCloses #34034.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-12-09T16:45:55Z",
      "updated_at": "2026-02-03T22:46:53Z",
      "merged_at": "2026-02-02T10:45:13Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34036",
      "labels": [
        "Scripts and tools"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 134,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 578665495,
      "number": 21283,
      "title": "Implement BIP 370 PSBTv2",
      "body": "BIP 370 PSBTv2 introduces several new fields and different invariants for PSBT. This PR implements those new fields and restructures the PSBT implementation to match PSBTv2 but still remain compatible with PSBTv0.",
      "state": "open",
      "user": "achow101",
      "created_at": "2021-02-23T18:29:20Z",
      "updated_at": "2026-02-03T21:35:29Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/21283",
      "labels": [
        "Wallet",
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 238,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1785565107,
      "number": 29700,
      "title": "kernel, refactor: return error status on all fatal errors",
      "body": "Return util::Result objects from all functions that can trigger fatal errors.\n\nThere are many validation functions that handle failures by calling `AbortNode` and triggering shutdowns, without returning error information to their callers. This makes error handling in libbitcoinkernel application code difficult, because the only way to handle these errors is to register for [notification callbacks](https://github.com/bitcoin/bitcoin/blob/master/src/kernel/notifications_interface.h). Improve this by making all functions that trigger fatal errors return util::Result objects with the error information.\n\nThis PR is a pure refactoring that returns extra result information from functions without changing their behavior. It's a possible alternative to and subset of #29642, which adds similar return information but also makes behavior changes and exposes a FatalError type.\n\n---\n\n<!-- begin based-on -->\n**This is based on #25665.** The non-base commits are:\n\n- [`74d2bef8754` refactor, kernel: Add FlushStatus / FlushResult types](https://github.com/bitcoin/bitcoin/pull/29700/commits/74d2bef875474ec7c01cf4dad2207cb99f182c18)\n- [`bc7715d2adc` refactor: Add InfoType field to util::Result](https://github.com/bitcoin/bitcoin/pull/29700/commits/bc7715d2adcc0141d39bbf53e973c54a72ebc3a1)\n- [`174eaff7293` refactor, blockstorage: Return FlushResult from flush methods](https://github.com/bitcoin/bitcoin/pull/29700/commits/174eaff7293d5266354969ecd355b9c64a4edc9f)\n- [`09a7e82d95e` refactor, blockstorage: Return fatal errors from block writes](https://github.com/bitcoin/bitcoin/pull/29700/commits/09a7e82d95e0d1477329a85464bd9e6aeaf1f3a4)\n- [`c69f7a4a630` refactor, validation: Switch to result.Update](https://github.com/bitcoin/bitcoin/pull/29700/commits/c69f7a4a6304d7e7a7ccebe44745653d932cdf44)\n- [`6ed2c7e828d` refactor, blockstorage: Return fatal error from LoadBlockIndex](https://github.com/bitcoin/bitcoin/pull/29700/commits/6ed2c7e828df2a39cb6d3ec080a81ed10af9c95a)\n- [`2b5008cb466` refactor, validation: Return fatal errors from FlushStateToDisk](https://github.com/bitcoin/bitcoin/pull/29700/commits/2b5008cb466026fb016d919d406b604d1e7c70c1)\n- [`d5915a9c841` refactor, validation: Return fatal errors from mempool accept functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/d5915a9c8419402e74edbdc2f61de763f7939898)\n- [`70e5893c672` refactor, validation: Return fatal errors from assumeutxo snapshot functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/70e5893c67228c7736319ab6f73871b1eb627f8a)\n- [`c851a5dc6fb` refactor, validation: Return fatal errors from block connect functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/c851a5dc6fbae6c37c517aa8665c2d40dacad0bf)\n- [`64fd4bf6482` refactor, validation: Return fatal errors from activate best chain functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/64fd4bf6482f41180b18a88707df75b0d84b542c)\n- [`08c72512955` refactor, validation: Return fatal errors from new block functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/08c72512955bf0b5a328f6b153e02c8226346e74)\n- [`b3650169639` refactor, blockstorage: Return fatal error from ImportBlocks](https://github.com/bitcoin/bitcoin/pull/29700/commits/b3650169639dae7648157e3fc85044b8b2357ab9)\n- [`738d8e4f8a1` refactor, validation: Return more errors from VerifyDB](https://github.com/bitcoin/bitcoin/pull/29700/commits/738d8e4f8a1e60ef52d731e27e6783ddca8317d2)\n- [`326c23ab46e` ci: Avoid -Wno-error=maybe-uninitialized false positives](https://github.com/bitcoin/bitcoin/pull/29700/commits/326c23ab46e24fcf8114439d6e19f23ef1106968)<!-- end -->",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-03-21T23:11:56Z",
      "updated_at": "2026-02-03T21:13:22Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29700",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3675,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1216590444,
      "number": 26966,
      "title": "index: initial sync speedup, parallelize process",
      "body": "Work is currently happening on #33689.\r\n\r\n------------------------------------------------\r\n\r\nThe current procedure for building the block filter index involves processing filters one at a time;\r\nReading blocks, undo data, and previous headers from disk sequentially.\r\n\r\nThis PR introduces a new mechanism to perform the work concurrently. Dividing the filters\r\ngeneration workload among a pool of workers that can be configured by the user,\r\nsignificantly increasing the speed of the index construction process.\r\n\r\nThe same concurrent processing model has been applied to the transactions index as well.\r\n\r\nThe newly introduced init flag `-indexworkers=<n>` enables the concurrent sync\r\nbehavior.\r\nWhere \"n\" is the number of worker threads that will be spawned at startup to create ranges\r\nof block filters during the initial sync process. Destroying the workers pool once the\r\ninitial sync completes.\r\nNote: by default, the parallelized sync process is not enabled.\r\n\r\nNow the juicy part:\r\nIn my computer, with the node in debug mode and on IBD, with `-indexworkers=4`, the\r\nblock filter index generation took less than an hour. While, in master, the sync took more than 7 hours.\r\n\r\nImportant Note:\r\nAs the access to the block data on disk is protected by `cs_main`, this new feature runs substantially\r\nfaster when the node is not in IBD.\r\n\r\n#### Testing Notes:\r\n\r\n1. Sync your node without any index.\r\n2. Restart the node with one of the indexes (`-blockfilterindex` or `-txindex`) and `-connect=0` (to sync only the index, without running the net/validation threads. Since threads won't be competing for `cs_main`, this will give you a more accurate result).\r\n\r\n   You’ll see a \"[index name] is enabled at height [height]\" log entry once it finishes. Then it’s just a matter of subtracting the index startup time from the \"index synced\" log time.\r\n\r\n  Keep in mind that threads are shared among all indexes you start. So if you run both indexes at the same time, your benchmark results cannot be compared against single-index runs.\r\n\r\n#### Fuzz Test Coverage Report\r\nCoverage diff for the fuzz test can be found on https://brunoerg.xyz/bitcoin-core-coverage/26966/coverage_report/",
      "state": "open",
      "user": "furszy",
      "created_at": "2023-01-25T13:36:23Z",
      "updated_at": "2026-02-03T21:03:59Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/26966",
      "labels": [
        "UTXO Db and Indexes",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2234,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3164120126,
      "number": 34257,
      "title": "txgraph: deterministic optimal transaction order",
      "body": "Part of #30289.\r\n\r\nTxGraph's fundamental responsibility is deciding the order of transactions in the mempool. It relies on the `cluster_linearize.h` code to optimize it, but there can and often will be many different orderings that are essentially equivalent from a quality perspective, so we have to pick one. At a high level, the solution will involve one or more of:\r\n* Deciding based on **internal identifiers** (`Cluster::m_sequence`, `DepGraphIndex`). This is very simple, but risks leaking information about transaction receive order.\r\n* Deciding **randomly**, which is private, but may interfere with relay expectations, block propagation, and ability to monitor network behavior.\r\n* Deciding **based on txid**, which is private and deterministic, but risks incentivizing grinding to get an edge (though we haven't really seen such behavior).\r\n* Deciding **based on size** (e.g. prefer smaller transactions), which is somewhat related to quality, but not unconditionally (depending on mempool layout, the ideal ordering might call for smaller transactions first, last, or anywhere in between). It's also not a strong ordering as there can be many identically-sized transactions. However, if it were to encourage grinding behavior, incentivizing smaller transactions is probably not a bad thing.\r\n\r\nAs of #32545, the current behavior is primarily picking randomly, though inconsistently, as some code paths also use internal identifiers and size. #33335 sought to change it to use random (preferring size in a few places), with the downsides listed above.\r\n\r\nThis PR is an alternative to that, which changes the order to tie-break based on size everywhere possible, and use lowest-txid-first as final fallback. This is fully deterministic: for any given set of mempool transactions, if all linearized optimally, the transaction order exposed by TxGraph is deterministic.\r\n\r\nThe order of transactions within a chunk is tie-broken using:\r\n1. The output of `PostLinearize` (which improves sub-chunk order), using an initial linearization created using the rules 2-4 below.\r\n2. Individual transaction feerate (high to low)\r\n3. Individual transaction weight (small to large)\r\n4. Txid (low to high txid)\r\n\r\nThe order of chunks within a cluster is tie-broken using:\r\n1. Chunk feerate (high to low)\r\n2. Chunk weight (small to large)\r\n3. Max-txid (chunk with lowest maximum-txid first)\r\n\r\nThe order of chunks across clusters is tie-broken using:\r\n1. Feerate (high to low)\r\n2. Equal-feerate-chunk-prefix weight (small to large)\r\n3. Max-txid (chunk with lowest maximum-txid first)\r\n\r\nThe equal-feerate-chunk-prefix weight of a chunk C is defined as the sum of the weights of all chunks in the same cluster as C, with the same feerate as C, up to and including C itself, in linearization order (but excluding such chunks that appear after C). This is a well-defined approximation of sorting chunks from small to large across clusters, while remaining consistent with intra-cluster linearization order.\r\n",
      "state": "open",
      "user": "sipa",
      "created_at": "2026-01-11T23:56:09Z",
      "updated_at": "2026-02-03T18:51:04Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34257",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3047,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1746125849,
      "number": 29491,
      "title": "[EXPERIMENTAL] Schnorr batch verification for blocks",
      "body": "This is a draft implementation of Schnorr signature batch verification in blocks, put here for conceptual discussion, and collaborative benchmarking.\r\n\r\nThe `secp256k1` code is still under review itself, please spend some time giving feedback there if you can:\r\n- [Batch module PR](https://github.com/bitcoin-core/secp256k1/pull/1134)\r\n- [ecmult refactoring PR](https://github.com/bitcoin-core/secp256k1/pull/1789)\r\n\r\nTODOs\r\n- [ ] Batch taproot tweak verification as well",
      "state": "open",
      "user": "fjahr",
      "created_at": "2024-02-27T17:06:26Z",
      "updated_at": "2026-02-03T18:02:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29491",
      "labels": [
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 524,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3210251998,
      "number": 34407,
      "title": "guix: use osslsigncode 2.12",
      "body": "Update osslsigncode used in Guix to [2.12](https://github.com/mtrojnar/osslsigncode/releases/tag/2.12).\r\n\r\nAdd zlib as an input, its a hard dependency since\r\nhttps://github.com/mtrojnar/osslsigncode/pull/303.\r\n\r\nAdd `python-cryptography` and `python-minimal` for running the tests.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-26T11:28:30Z",
      "updated_at": "2026-02-03T17:38:18Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34407",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 309,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1815639680,
      "number": 29843,
      "title": "policy: Allow non-standard scripts with -acceptnonstdtxn=1 (test nets only)",
      "body": "This PR changes `-acceptnonstdtxn=1` so that it also skips the `non-mandatory` script checks, allowing txs that (eg) use OP_NOPx or OP_SUCCESS into the mempool. This remains only available on test nets.",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2024-04-10T09:08:35Z",
      "updated_at": "2026-02-03T17:35:49Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29843",
      "labels": [
        "TX fees and policy"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 278,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1719386983,
      "number": 29415,
      "title": "Broadcast own transactions only via short-lived Tor or I2P connections",
      "body": "_Parts of this PR are isolated in independent smaller PRs to ease review:_\r\n\r\n* [x] _https://github.com/bitcoin/bitcoin/pull/29420_\r\n* [x] _https://github.com/bitcoin/bitcoin/pull/33454_\r\n* [x] _https://github.com/bitcoin/bitcoin/pull/33567_\r\n* [x] _https://github.com/bitcoin/bitcoin/pull/33793_\r\n\r\n---\r\n\r\nTo improve privacy, broadcast locally submitted transactions (from the `sendrawtransaction` RPC) to the P2P network only via Tor or I2P short-lived connections, or to IPv4/IPv6 peers but through the Tor network.\r\n\r\n* Introduce a new connection type for private broadcast of transactions with the following properties:\r\n  * started whenever there are local transactions to be sent\r\n  * opened to Tor or I2P peers or IPv4/IPv6 via the Tor proxy\r\n  * opened regardless of max connections limits\r\n  * after handshake is completed one local transaction is pushed to the peer, `PING` is sent and after receiving `PONG` the connection is closed\r\n  * ignore all incoming messages after handshake is completed (except `PONG`)\r\n\r\n* Broadcast transactions submitted via `sendrawtransaction` using this new mechanism, to a few peers. Keep doing this until we receive back this transaction from one of our ordinary peers (this takes about 1 second on mainnet).\r\n\r\n* The transaction is stored in peerman and does not enter the mempool.\r\n\r\n* Once we get an `INV` from one of our ordinary peers, then the normal flow executes: we request the transaction with `GETDATA`, receive it with a `TX` message, put it in our mempool and broadcast it to all our existent connections (as if we see it for the first time).\r\n\r\n* After we receive the full transaction as a `TX` message, in reply to our `GETDATA` request, only then consider the transaction has propagated through the network and remove it from the storage in peerman, ending the private broadcast attempts.\r\n\r\nThe messages exchange should look like this:\r\n\r\n```\r\ntx-sender >--- connect -------> tx-recipient\r\ntx-sender >--- VERSION -------> tx-recipient (dummy VERSION with no revealing data)\r\ntx-sender <--- VERSION -------< tx-recipient\r\ntx-sender <--- WTXIDRELAY ----< tx-recipient (maybe)\r\ntx-sender <--- SENDADDRV2 ----< tx-recipient (maybe)\r\ntx-sender <--- SENDTXRCNCL ---< tx-recipient (maybe)\r\ntx-sender <--- VERACK --------< tx-recipient\r\ntx-sender >--- VERACK --------> tx-recipient\r\ntx-sender >--- INV/TX --------> tx-recipient\r\ntx-sender <--- GETDATA/TX ----< tx-recipient\r\ntx-sender >--- TX ------------> tx-recipient\r\ntx-sender >--- PING ----------> tx-recipient\r\ntx-sender <--- PONG ----------< tx-recipient\r\ntx-sender disconnects\r\n```\r\n\r\nWhenever a new transaction is received from `sendrawtransaction` RPC, the node will send it to a few (`NUM_PRIVATE_BROADCAST_PER_TX`) recipients right away. If after some time we still have not heard anything about the transaction from the network, then it will be sent to 1 more peer (see `PeerManagerImpl::ReattemptPrivateBroadcast()`).\r\n\r\nA few considerations:\r\n* The short-lived private broadcast connections are very cheap and fast wrt network traffic. It is expected that some of those peers could blackhole the transaction. Just one honest/proper peer is enough for successful propagation.\r\n* The peers that receive the transaction could deduce that this is initial transaction broadcast from the transaction originator. This is ok, they can't identify the sender.\r\n\r\n---\r\n\r\n<details>\r\n<summary>How to test this?</summary>\r\n\r\nThank you, @stratospher and @andrewtoth!\r\n\r\nStart `bitcoind` with `-privatebroadcast=1 -debug=privatebroadcast`.\r\n\r\nCreate a wallet and get a new address, go to the Signet faucet and request some coins to that address:\r\n```bash\r\nbuild/bin/bitcoin-cli -chain=\"signet\" createwallet test\r\nbuild/bin/bitcoin-cli -chain=\"signet\" getnewaddress\r\n```\r\n\r\nGet a new address for the test transaction recipient:\r\n```bash\r\nbuild/bin/bitcoin-cli -chain=\"signet\" loadwallet test\r\nnew_address=$(build/bin/bitcoin-cli -chain=\"signet\" getnewaddress)\r\n```\r\n\r\nCreate the transaction:\r\n```bash\r\n# Option 1: `createrawtransaction` and `signrawtransactionwithwallet`:\r\n\r\ntxid=$(build/bin/bitcoin-cli -chain=\"signet\" listunspent | jq -r '.[0] | .txid')\r\nvout=$(build/bin/bitcoin-cli -chain=\"signet\" listunspent | jq -r '.[0] | .vout')\r\necho \"txid: $txid\"\r\necho \"vout: $vout\"\r\n\r\ntx=$(build/bin/bitcoin-cli -chain=\"signet\" createrawtransaction \"[{\\\"txid\\\": \\\"$txid\\\", \\\"vout\\\": $vout}]\" \"[{\\\"$new_address\\\": 0.00001000}]\" 0 false)\r\necho \"tx: $tx\"\r\n\r\nsigned_tx=$(build/bin/bitcoin-cli -chain=\"signet\" signrawtransactionwithwallet \"$tx\" | jq -r '.hex')\r\necho \"signed_tx: $signed_tx\"\r\n\r\n# OR Option 2: `walletcreatefundedpsbt` and `walletprocesspsbt`:\r\n# This makes it not have to worry about inputs and also automatically sends back change to the wallet.\r\n# Start `bitcoind` with `-fallbackfee=0.00003000` for instance for 3 sat/vbyte fee.\r\n\r\npsbt=$(build/bin/bitcoin-cli -chain=\"signet\" walletcreatefundedpsbt \"[]\" \"[{\\\"$new_address\\\": 0.00001000}]\" | jq -r '.psbt')\r\necho \"psbt: $psbt\"\r\n\r\nsigned_tx=$(build/bin/bitcoin-cli -chain=\"signet\" walletprocesspsbt \"$psbt\" | jq -r '.hex')\r\necho \"signed_tx: $signed_tx\"\r\n```\r\n\r\nFinally, send the transaction:\r\n```bash\r\nraw_tx=$(build/bin/bitcoin-cli -chain=\"signet\" sendrawtransaction \"$signed_tx\")\r\necho \"raw_tx: $raw_tx\"\r\n```\r\n\r\n</details>\r\n\r\n---\r\n\r\n<details>\r\n<summary>High-level explanation of the commits</summary>\r\n\r\n* New logging category and config option to enable private broadcast\r\n  * `log: introduce a new category for private broadcast`\r\n  * `init: introduce a new option to enable/disable private broadcast`\r\n\r\n* Implement the private broadcast connection handling on the `CConnman` side:\r\n  * `net: introduce a new connection type for private broadcast`\r\n  * `net: implement opening PRIVATE_BROADCAST connections`\r\n\r\n* Prepare `BroadcastTransaction()` for private broadcast requests:\r\n  * `net_processing: rename RelayTransaction to better describe what it does`\r\n  * `node: extend node::TxBroadcast with a 3rd option`\r\n  * `net_processing: store transactions for private broadcast in PeerManager`\r\n\r\n* Implement the private broadcast connection handling on the `PeerManager` side:\r\n  * `net_processing: reorder the code that handles the VERSION message`\r\n  * `net_processing: move the debug log about receiving VERSION earlier`\r\n  * `net_processing: modernize PushNodeVersion()`\r\n  * `net_processing: move a debug check in VERACK processing earlier`\r\n  * `net_processing: handle ConnectionType::PRIVATE_BROADCAST connections`\r\n  * `net_processing: stop private broadcast of a transaction after round-trip`\r\n  * `net_processing: retry private broadcast`\r\n\r\n* Engage the new functionality from `sendrawtransaction`:\r\n  * `rpc: use private broadcast from sendrawtransaction RPC if -privatebroadcast is ON`\r\n\r\n* New tests:\r\n  * `test: add functional test for private broadcast`\r\n  * `test: add unit test for the private broadcast storage`\r\n\r\n</details>\r\n\r\n---\r\n\r\n**This PR would resolve the following issues:**\r\nhttps://github.com/bitcoin/bitcoin/issues/3828 Clients leak IPs if they are recipients of a transaction\r\nhttps://github.com/bitcoin/bitcoin/issues/14692 Can't configure bitocoind to only send tx via Tor but receive clearnet transactions\r\nhttps://github.com/bitcoin/bitcoin/issues/19042 Tor-only transaction broadcast onlynet=onion alternative\r\nhttps://github.com/bitcoin/bitcoin/issues/24557 Option for receive events with all networks, but send transactions and/or blocks only with anonymous network[s]?\r\nhttps://github.com/bitcoin/bitcoin/issues/25450 Ability to broadcast wallet transactions only via dedicated oneshot Tor connections\r\nhttps://github.com/bitcoin/bitcoin/issues/32235 Tor: TX circuit isolation\r\n\r\n**Issues that are related, but (maybe?) not to be resolved by this PR:**\r\nhttps://github.com/bitcoin/bitcoin/issues/21876 Broadcast a transaction to specific nodes\r\nhttps://github.com/bitcoin/bitcoin/issues/28636 new RPC: sendrawtransactiontopeer\r\n\r\n---\r\n\r\nFurther extensions:\r\n* Have the wallet do the private broadcast as well, https://github.com/bitcoin/bitcoin/issues/11887 would have to be resolved.\r\n* Have the `submitpackage` RPC do the private broadcast as well, [draft diff in the comment below](https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2972293733), thanks ismaelsadeeq!\r\n* Add some stats via RPC, so that the user can better monitor what is going on during and after the broadcast. Currently this can be done via the debug log, but that is not convenient.\r\n* Make the private broadcast storage, currently in peerman, persistent over node restarts.\r\n* Add (optional) random delay before starting to broadcast the transaction in order to avoid correlating unrelated transactions based on the time when they were broadcast. Suggested independently of this PR [here](https://github.com/bitcoin/bitcoin/issues/30471).\r\n* Consider periodically sending transactions that did not originate from the node as decoy, discussed [here](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035414972).\r\n* Consider waiting for peer's FEEFILTER message and if the transaction that was sent to the peer is below that threshold, then assume the peer is going to drop it. Then use this knowledge to retry more aggressively with another peer, instead of the current 10 min. See [comment below](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3258611648).\r\n* It may make sense to be able to override the default policy -- eg so submitrawtransaction can go straight to the mempool and relay, even if txs are normally privately relayed. See [comment below](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3427086681).\r\n* As a side effect we have a new metric available - the time it takes for a transaction to reach a random node in the network (from the point of view of the private broadcast recipient the tx originator is a random node somewhere in the network). This can be useful for monitoring, unrelated to privacy characteristics of this feature.\r\n\r\n---\r\n\r\n_A previous incarnation of this can be found at https://github.com/bitcoin/bitcoin/pull/27509. It puts the transaction in the mempool and (tries to) hide it from the outside observers. This turned out to be too error prone or maybe even impossible._\r\n",
      "state": "closed",
      "user": "vasild",
      "created_at": "2024-02-09T13:39:10Z",
      "updated_at": "2026-02-03T16:57:44Z",
      "merged_at": "2026-01-12T20:02:22Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29415",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 10312,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3214411194,
      "number": 34418,
      "title": "qa: Make wallet_multiwallet.py Windows-compatible",
      "body": "Main parts:\r\n* Commit \"qa: Check for platform-independent part of error message\" switches to match on platform-independent part of error message.\r\n* Commit \"qa: Test scanning errors individually\" disentangles code causing the same error message substring, based on #31410.\r\n* Commit \"qa: Disable parts of the test when running under Windows or root\" enables the test to be run on Windows, based in part on https://github.com/bitcoin/bitcoin/pull/31410#issuecomment-3554721014.\r\n\r\nAlso:\r\n* Removes unused option in wallet_multiwallet.py.\r\n* Breaks apart wallet_multiwallet.py's `run_test()` into smaller test functions.\r\n* Improves `assert_equal()` output for dicts.\r\n\r\nFixes #31409.",
      "state": "open",
      "user": "hodlinator",
      "created_at": "2026-01-27T12:35:18Z",
      "updated_at": "2026-02-03T16:49:43Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34418",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 732,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2138649533,
      "number": 31132,
      "title": "validation: fetch block inputs on parallel threads 3x faster IBD",
      "body": "_Parts of this PR are isolated in independent smaller PRs to ease review:_\r\n\r\n* [x] _https://github.com/bitcoin/bitcoin/pull/34164_\r\n* [ ] _https://github.com/bitcoin/bitcoin/pull/34165_\r\n\r\n---\r\n\r\nThis PR parallelizes fetching all input prevouts of a block during block connection, achieving over 3x faster IBD performance in some scenarios[^1][^2][^3][^4][^5].\r\n\r\n### Problem\r\n\r\nCurrently, when fetching inputs in `ConnectBlock`, each input is fetched from the cache sequentially. A cache miss requires a round trip to the disk database to fetch the outpoint and insert it into the cache. Since the database is read-only during `ConnectBlock`, we can fetch all inputs of a block in parallel on multiple threads while connecting.\r\n\r\n### Solution\r\n\r\nWe introduce a new `CoinsViewCacheAsync` `CCoinsViewCache` subclass that manages worker threads to fetch block inputs in parallel. The block is passed to the `CoinsViewCacheAsync` view before entering `ConnectBlock`, which kicks off the worker threads to begin fetching the inputs. The view is then passed to `ConnectBlock` since it provides the same API as `CCoinsViewCache`. The cache returns fetched coins as they become available via the overridden `FetchCoin` method. If not available yet, the main thread also fetches coins as it waits.\r\n\r\n### Implementation Details\r\n\r\nThe `CoinsViewCacheAsync` implements a lock-free MPSC (Multiple Producer, Single Consumer) queue design:\r\n\r\n- **Work Distribution**: Collects all input prevouts into a queue and uses a barrier to start all worker threads simultaneously\r\n- **Synchronization**: Worker threads use an atomic counter to claim which inputs to fetch, and each input has an atomic flag to signal completion to the main thread\r\n- **Main Thread Processing**: The main thread waits for inputs in order and moves their `Coin` into the `cacheCoins` map as they become available.\r\n- **Work Stealing**: If the main thread catches up to the workers, it assists with fetching to maximize parallelism\r\n- **Completion**: All threads synchronize on a barrier via a `Reset` method, which ensures all threads are parked before proceeding\r\n\r\n### Safety and Correctness\r\n\r\n- The `CoinsViewCacheAsync` works on a block that has not been fully validated, but it does not interfere or modify any of the validation during `ConnectBlock`\r\n- It simply fetches inputs in parallel, which must be fetched before a transaction is validated anyways\r\n- **Invalid blocks**: If an invalid block is mined, the temporary cache is reset without being flushed. This is an improvement over the current behavior, where existing inputs are inserted into the main `CoinsTip()` cache when pulled through for an invalid block\r\n\r\n### Performance\r\n\r\nBenchmarks show over 3x faster IBD performance in a cloud environment with network connected storage[^1], 3x faster IBD for an M4 Mac and up to 46% faster with directly connected storage[^2][^3][^4][^5]. The parallelization of expensive disk lookups provides significant speedup.\r\n\r\n[Flamegraphs show how the execution is changed](https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3617315125).\r\n\r\n### Credits\r\n\r\nInspired by [this comment](https://github.com/bitcoin/bitcoin/pull/18941#issuecomment-638553680).\r\n\r\nResolves https://github.com/bitcoin/bitcoin/issues/34121.\r\n\r\n[^1]: https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3678847806\r\n[^2]: https://github.com/bitcoin/bitcoin/pull/31132#pullrequestreview-3515011880\r\n[^3]: https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3463894000\r\n[^4]: https://github.com/bitcoin/bitcoin/pull/31132#pullrequestreview-3347436866\r\n[^5]: https://github.com/bitcoin/bitcoin/pull/31132#issuecomment-3488760623",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2024-10-22T14:40:28Z",
      "updated_at": "2026-02-03T15:59:02Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31132",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3751,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2281150274,
      "number": 31668,
      "title": "Added rescan option for import descriptors",
      "body": "Fix related to issue: https://github.com/bitcoin/bitcoin/issues/31263\r\n",
      "state": "open",
      "user": "saikiran57",
      "created_at": "2025-01-16T08:11:27Z",
      "updated_at": "2026-02-03T15:13:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31668",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 114,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2203477250,
      "number": 31382,
      "title": "kernel: Flush in ChainstateManager destructor",
      "body": "This simplifies the shutdown code a bit and reduces the amount of extra logic required in kernel/bitcoinkernel.cpp to tear down the chainman.\r\n\r\nMoving the second flush out of the Shutdown function into the ChainstateManager destructor, should be safe since there should be no new events created after the first flush. Tweak the chainman tests to actually exercise this new tear down behaviour.\r\n\r\n---\r\n\r\nThis PR is part of the [libbitcoinkernel project](https://github.com/bitcoin/bitcoin/issues/27587)",
      "state": "open",
      "user": "sedited",
      "created_at": "2024-11-27T13:18:50Z",
      "updated_at": "2026-02-03T14:58:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31382",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 549,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3228581236,
      "number": 34464,
      "title": "Change BlockRequestAllowed() to take ref (minor refactor)",
      "body": "As [suggested here](https://github.com/bitcoin/bitcoin/pull/34416#discussion_r2745302958), a minor refactor of `PeerManagerImpl::BlockRequestAllowed()` to take reference parameter (instead of pointer). The motivation is to make the code safer, by minimizing the risk of null-dereference, and to be more consistent.\r\nThe change is local to the `PeerManagerImpl::BlockRequestAllowed()` class.\r\nRelated to #34440.\r\n",
      "state": "open",
      "user": "optout21",
      "created_at": "2026-01-30T16:57:17Z",
      "updated_at": "2026-02-03T14:28:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34464",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 470,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3110851566,
      "number": 34093,
      "title": "netif: fix compilation warning in QueryDefaultGatewayImpl()",
      "body": "```\r\nsrc/common/netif.cpp:137:51: error: comparison of integers of different signs: 'int64_t' (aka 'long') and 'unsigned long' [-Werror,-Wsign-compare]\r\n  137 |         for (nlmsghdr* hdr = (nlmsghdr*)response; NLMSG_OK(hdr, recv_result); hdr = NLMSG_NEXT(hdr, recv_result)) {\r\n      |                                                   ^~~~~~~~~~~~~~~~~~~~~~~~~~\r\n/usr/include/netlink/netlink.h:220:31: note: expanded from macro 'NLMSG_OK'\r\n  220 | #define NLMSG_OK(_hdr, _len)            NL_ITEM_OK(_hdr, _len, NLMSG_HDRLEN, _NLMSG_LEN)\r\n      |                                         ^                ~~~~  ~~~~~~~~~~~~\r\n/usr/include/netlink/netlink.h:203:10: note: expanded from macro 'NL_ITEM_OK'\r\n  203 |         ((_len) >= _hlen && _LEN_M(_ptr) >= _hlen && _LEN_M(_ptr) <= (_len))\r\n      |           ~~~~  ^  ~~~~~\r\n1 error generated.\r\n```\r\n\r\nHappens on FreeBSD 15.0, with the default compiler (Clang 19).\r\n\r\nOn FreeBSD 14, `/usr/include/netlink/netlink.h` contains:\r\n```\r\n #define NLMSG_HDRLEN                    ((int)sizeof(struct nlmsghdr))\r\n```\r\n\r\nOn FreeBSD 15, `/usr/include/netlink/netlink.h` contains:\r\n```\r\n #define NLMSG_HDRLEN                    (sizeof(struct nlmsghdr))\r\n```\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "open",
      "user": "vasild",
      "created_at": "2025-12-17T17:45:19Z",
      "updated_at": "2026-02-03T14:26:15Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34093",
      "labels": [
        "Needs backport (30.x)"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 1,
        "text_length": 3321,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3234431586,
      "number": 34472,
      "title": "bench: add script verification benchmark for P2TR key path spends",
      "body": "We currently benchmark Schnorr signature verification only in the context of block validation ([`ConectBlock*`](https://github.com/bitcoin/bitcoin/blob/8bb77f348ef390b7f7c7fb6b57fdc7e86ddb4ce7/src/bench/connectblock.cpp#L107) benchmarks), but not individually for single inputs [1]. This PR adds a script verification benchmark for P2TR key path spends accordingly, by generalizing the already existing one for P2WPKH spends.\r\n\r\nThis should make it easier to quantify potential performance improvements like e.g. https://github.com/bitcoin-core/secp256k1/pull/1777, which allows to plug in our HW-optimized SHA256 functions to be used in libsecp256k1 (see the linked example commit https://github.com/furszy/bitcoin-core/commit/f68bef06d95a589859f98fc898dd80ab2e35eb39). IIRC from last CoreDev, the main speedup from this is expected for ECDSA signing though (as this involves quite a lot of hashing), but it still makes sense to have verification benchmarks available for both signature types as well.\r\n\r\n(An alternative way could be to add benchmarks for the signing/verifying member functions `CKey::Sign{,Schnorr}`, `CPubKey::Verify` and `XOnlyPubKey::VerifySchnorr` directly, if we prefer that.) \r\n\r\n[1] this claim can be practically verified by putting an `assert(false);` into `XOnlyPubKey::VerifySchnorr`: the three benchmarks crashing are `ConnectBlockAllSchnorr`, `ConnectBlockMixedEcdsaSchnorr` and `SignTransactionSchnorr` (as signing includes verification)",
      "state": "open",
      "user": "theStack",
      "created_at": "2026-02-02T01:11:08Z",
      "updated_at": "2026-02-03T14:26:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34472",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1535,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2640910930,
      "number": 32875,
      "title": "index: handle case where pindex_prev equals chain tip in NextSyncBlock()",
      "body": "`NextSyncBlock()` is for getting the next to-sync block to build index. The current master code handles a specific case in a wrong way: when pindex_prev is the chain tip, `NextSyncBlock()` does handle it in \r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/1d3243806da6db8bd13e6b20906628ed434362b6/src/index/base.cpp#L163-L165\r\n but line 165 is for reorg not for `pindex_prev == chain tip` as the comment suggested. So when pindex_prev is the chain tip, return earlier and explicitly rather than mixing it with the reorg case (the above code)\r\n\r\n",
      "state": "open",
      "user": "HowHsu",
      "created_at": "2025-07-04T10:03:17Z",
      "updated_at": "2026-02-03T13:59:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32875",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 613,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3235775852,
      "number": 34474,
      "title": "ci: update ccache to improve hitrate",
      "body": "Currently some CI jobs don't have great ccache hitrates which we should try to improve: https://willcl-ark.github.io/bitcoin-core-ci-stats/graph/ccache/\r\n\r\n- bump ccache maxsize to 2GB in all jobs. We have 150GB shared cache to use, so this should be OK at maximum of 36GB total (current jobset).\r\n- print more verbose ccache stats in the CI logs\r\n\r\nThe idea is that increasing the cache size to > 2x needed size should eliminate any cache thrashing which might be taking place on master builds when we save the cache. Additionally, larger caches result in more hits in general.",
      "state": "closed",
      "user": "willcl-ark",
      "created_at": "2026-02-02T10:00:23Z",
      "updated_at": "2026-02-03T13:44:17Z",
      "merged_at": "2026-02-03T10:16:49Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34474",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 615,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2882266509,
      "number": 33522,
      "title": "guix: use LIEF 0.17.3",
      "body": "Update LIEF in Guix & the CI to 0.17.3: https://lief.re/doc/stable/changelog.html#january-24th-2026",
      "state": "open",
      "user": "fanquake",
      "created_at": "2025-10-02T15:57:55Z",
      "updated_at": "2026-02-03T13:43:24Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33522",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 121,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3233731791,
      "number": 34471,
      "title": "refactor: Use aliasing shared_ptr in Sock::Wait",
      "body": "Currently, a no-op lambda is used as the deleter for the temporary shared pointer helper in `Sock::Wait`. This is perfectly fine, but has a few style issues:\r\n\r\n* The lambda needs to be allocated on the heap\r\n* It triggers a false-positive upstream GCC-16-trunk bug: https://gcc.gnu.org/bugzilla/show_bug.cgi?id=123912\r\n\r\nFix all issues by just using an aliasing shared pointer, which points to `this`, but is otherwise empty (sits on the stack without any heap allocations).",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-02-01T18:37:53Z",
      "updated_at": "2026-02-03T13:06:42Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34471",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 523,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3214986859,
      "number": 34420,
      "title": "consensus: disable min difficulty blocks on testnet4 after height 151200",
      "body": "  ## Summary                                                                                                                                \r\n                                                                                                                                            \r\n  Disable the min-difficulty block rule on testnet4 after block height 151,200 (epoch 75 boundary) and reset difficulty to 1,000,000 at the fork.                                                                                                                                     \r\n                                                                                                                                            \r\n  ## Motivation                                                                                                                             \r\n                                                                                                                                            \r\n  Testnet4's min-difficulty rule (allowing difficulty-1 blocks after 20 minutes) is being exploited, causing ~85-90% of blocks to be CPU-mined min-difficulty blocks. This results in a race of CPU miners broadcasting blocks at exactly the second that it's acceptable. This race is so intense that CPU miners have figured out sending empty blocks, as they propagate faster than those that contain transactions, resulting in a network where transactions are confirmed at only the remaining ASIC blocks, that have ~1 hour average block times.                                                                                                     \r\n                                                                                                                                            \r\n  After the fork:                                                                                                                           \r\n  - Min-difficulty blocks will no longer be allowed                                                                                         \r\n  - Difficulty resets to 1,000,000 (not 1, to avoid a block storm of thousands of blocks in seconds)                                        \r\n  - Normal difficulty retargeting resumes                                                                                                   \r\n                                                                                                                                            \r\n  ## Changes                                                                                                                                \r\n                                                                                                                                            \r\n  - Add `nMinDifficultyBlocksForkHeight` consensus parameter (default 0 = disabled)                                                         \r\n  - Set fork height to 151,200 for testnet4 (epoch 75 boundary, ~31,000 blocks from current height ~120,000)                                \r\n  - Modify `GetNextWorkRequired()` to disable min-difficulty rule and reset difficulty at fork                                              \r\n  - Modify `PermittedDifficultyTransition()` to enforce the new rules                                                                       \r\n  - Modify `WaitAndCreateNewBlock()` in miner to respect the fork                                                                           \r\n  - Add unit tests covering pre-fork, at-fork, and post-fork behavior                                                                       \r\n                                                                                                                                            \r\n  ## Test Plan                                                                                                                              \r\n                                                                                                                                            \r\n  - `./build/bin/test_bitcoin --run_test=pow_tests` - all 21 tests pass                                                                     \r\n                                                                                                                                            \r\n  ## Discussion                                                                                                                             \r\n                                                                                                                                            \r\n  [bitcoin-dev mailing list thread #1](https://groups.google.com/g/bitcoindev/c/iVLHJ1HWhoU)\r\n  [bitcoin-dev mailing list thread #2](https://groups.google.com/g/bitcoindev/c/Jsv1VYpewuU)     \r\n  [Bitcointalk thread](https://bitcointalk.org/index.php?topic=5569103.0)     ",
      "state": "open",
      "user": "batmanbytes",
      "created_at": "2026-01-27T15:08:13Z",
      "updated_at": "2026-02-03T12:39:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34420",
      "labels": [
        "Consensus"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 4957,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3227556540,
      "number": 34459,
      "title": "[30.x] Backports",
      "body": "Backports:\r\n* #34409\r\n* #34434\r\n* #34445\r\n* #34453\r\n* #34461",
      "state": "open",
      "user": "fanquake",
      "created_at": "2026-01-30T11:55:58Z",
      "updated_at": "2026-02-03T12:33:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34459",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 77,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2919092278,
      "number": 33637,
      "title": "refactor: optimize block index comparisons (1.4-6.8x faster)",
      "body": "### Context\r\nThe comparator is often called either directly or for the sorting of [setBlockIndexCandidates](https://github.com/bitcoin/bitcoin/blob/master/src/validation.h#L637), a red-black tree-set containing valid block headers where the comparator is invoked extensively.\r\nBesided the sorted set usages, the comparator is used directly in `Chainstate` in `FindMostWorkChain`, `PruneBlockIndexCandidates`, `ActivateBestChain` and `InvalidateBlock`; and in `ChainstateManager` in `LoadBlockIndex`, `CheckBlockIndex`, `ActivateSnapshot` and `PopulateAndValidateSnapshot`.\r\n\r\nIt was profiled during the investigation of https://github.com/bitcoin/bitcoin/issues/33618#issuecomment-3402229976. \r\n\r\n### Testing\r\nTo ensure the optimized implementations are both fast and correct, the first commit adds a dedicated benchmark to measure `CBlockIndexWorkComparator` performance, and the second commit adds randomized tests comparing the new implementation with the original one.\r\n\r\n### Results\r\n\r\n> GCC 15.0.1:\r\n\r\n* `CBlockIndexWorkComparator`: 100,772,511 cmp/s → 656,674,205 cmp/s = 6.51x faster\r\n* `CheckBlockIndex`: 9,091 ops/s → 14,765 ops/s = 1.62x faster\r\n\r\n> Clang 22.0.0:\r\n\r\n* `CBlockIndexWorkComparator`: 100,451,893 cmp/s → 683,414,234 cmp/s = 6.8x faster\r\n* `CheckBlockIndex`: 10,322 ops/s → 14,376 ops/s = 1.39x faster\r\n\r\nSee https://corecheck.dev/bitcoin/bitcoin/pulls/33637 for the CI's `CheckBlockIndex` performance.\r\n\r\n<details>\r\n<summary>gcc and clang measurements</summary>\r\n\r\n> Compiler: gcc 15.0.1\r\nb60450fae8 bench: add benchmark to measure `CBlockIndexWorkComparator` performance\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                9.92 |      100,772,511.62 |    0.0% |           63.98 |           35.64 |  1.795 |          14.17 |    1.9% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|          109,996.46 |            9,091.20 |    0.2% |    1,014,421.11 |      394,979.29 |  2.568 |     313,025.11 |    0.0% |      5.50 | `CheckBlockIndex`\r\n\r\ne2e02177ba refactor: inline `arith_uint256` comparison operator\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                6.48 |      154,439,491.66 |    0.0% |           31.01 |           23.25 |  1.334 |           7.16 |    3.8% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|          105,754.86 |            9,455.83 |    0.1% |      913,130.11 |      379,588.20 |  2.406 |     276,692.11 |    0.0% |      5.50 | `CheckBlockIndex`\r\n\r\n85b74b01de refactor: optimize `arith_uint256` comparison with spaceship operator\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                6.37 |      156,990,488.06 |    0.0% |           28.85 |           22.87 |  1.261 |           8.61 |    3.2% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           83,803.10 |           11,932.73 |    0.0% |      743,565.09 |      300,824.84 |  2.472 |     232,646.08 |    0.0% |      5.56 | `CheckBlockIndex`\r\n\r\ndeb58eea2f refactor: optimize `CBlockIndexWorkComparator` with std::tie\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                1.52 |      656,674,205.98 |    0.0% |           13.18 |            5.47 |  2.410 |           3.06 |    0.1% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           67,726.84 |           14,765.19 |    0.2% |      585,826.07 |      243,155.90 |  2.409 |     181,920.07 |    0.0% |      5.54 | `CheckBlockIndex`\r\n\r\n> Compiler: clang 22.0.0\r\n\r\nb60450fae8 bench: add benchmark to measure `CBlockIndexWorkComparator` performance\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                9.96 |      100,451,893.46 |    0.0% |           61.28 |           35.75 |  1.714 |          13.62 |    2.1% |      5.52 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           96,878.70 |           10,322.19 |    0.1% |      802,827.10 |      347,679.01 |  2.309 |     234,823.10 |    0.0% |      5.50 | `CheckBlockIndex`\r\n\r\ne2e02177ba refactor: inline `arith_uint256` comparison operator\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                6.13 |      163,183,693.10 |    0.0% |           25.74 |           22.01 |  1.170 |           6.10 |    4.6% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           86,307.94 |           11,586.42 |    1.2% |      646,229.09 |      309,785.33 |  2.086 |     195,119.09 |    0.0% |      5.54 | `CheckBlockIndex`\r\n\r\n85b74b01de refactor: optimize `arith_uint256` comparison with spaceship operator\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                6.36 |      157,330,900.16 |    1.0% |           26.20 |           22.61 |  1.159 |           6.55 |    4.4% |      5.53 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           75,031.66 |           13,327.71 |    1.0% |      650,604.15 |      266,934.04 |  2.437 |     149,967.14 |    0.0% |      5.54 | `CheckBlockIndex`\r\n\r\ndeb58eea2f refactor: optimize `CBlockIndexWorkComparator` with std::tie\r\n\r\n|              ns/cmp |               cmp/s |    err% |         ins/cmp |         cyc/cmp |    IPC |        bra/cmp |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|                1.46 |      683,414,234.14 |    0.0% |           16.12 |            5.25 |  3.067 |           4.02 |    0.1% |      5.50 | `CBlockIndexWorkComparator`\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|           69,559.70 |           14,376.14 |    0.1% |      559,208.07 |      249,654.28 |  2.240 |     132,342.07 |    0.0% |      5.51 | `CheckBlockIndex`\r\n\r\n</details>\r\n\r\n### Reproducer\r\n\r\nRun the equivalence tests with:\r\n```bash\r\ncmake -B build && cmake --build build && ./build/bin/test_bitcoin --run_test=arith_uint256_tests,blockchain_tests\r\n```\r\n\r\nEach commit shows how it changes the relevant benchmarks.\r\n\r\n<details>\r\n<summary>Benchmark script</summary>\r\n\r\n```bash\r\nfor compiler in gcc clang; do \\\r\n  if [ \"$compiler\" = \"gcc\" ]; then CC=gcc; CXX=g++; COMP_VER=$(gcc -dumpfullversion); \\\r\n  else CC=clang; CXX=clang++; COMP_VER=$(clang -dumpversion); fi && \\\r\n  echo \"> Compiler: $compiler $COMP_VER\" && \\\r\n  for commit in 70c6244b709fcf6a853ea44b91b9ed219609ac90 516e05cd7d8dbb61b05854c59f5393367e502284 d053b27c06d06cccbc6395b0aa7dc1c4193a6fc3 8ef4ce2cb3ac80cbe58b8cf76e183f9eca6fafe4 703165e6d3b9fbd58b9c31ddce0e961047fc5e71; do \\\r\n    git fetch origin $commit >/dev/null 2>&1 && git checkout $commit >/dev/null 2>&1 && git log -1 --pretty='%h %s' && \\\r\n    rm -rf build && \\\r\n    cmake -B build -DBUILD_BENCH=ON -DENABLE_IPC=OFF -DCMAKE_BUILD_TYPE=RelWithDebInfo -DCMAKE_C_COMPILER=$CC -DCMAKE_CXX_COMPILER=$CXX >/dev/null 2>&1 && \\\r\n    cmake --build build -j$(nproc) >/dev/null 2>&1 && \\\r\n    for i in 1; do \\\r\n      build/bin/bench_bitcoin -filter='CBlockIndexWorkComparator|CheckBlockIndex' -min-time=5000; \\\r\n    done; \\\r\n  done; \\\r\ndone\r\n```\r\n\r\n</details>\r\n\r\nNote: something similar was already started in https://github.com/bitcoin/bitcoin/pull/33334, but this is a broader optimization that doesn't use the same technique.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-10-16T01:54:31Z",
      "updated_at": "2026-02-03T11:48:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33637",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 11214,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3233709387,
      "number": 34470,
      "title": "Bump leveldb subtree and remove UB workaround in CI",
      "body": "Bump leveldb subtree and remove UB workaround in CI. This also fixes a GCC-16 warning.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-02-01T18:26:32Z",
      "updated_at": "2026-02-03T11:46:17Z",
      "merged_at": "2026-02-03T11:26:46Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34470",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 138,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2391882324,
      "number": 32061,
      "title": "Replace libevent with our own HTTP and socket-handling implementation",
      "body": "This is a major component of [removing libevent as a dependency of the project](https://github.com/bitcoin/bitcoin/issues/31194), by replacing the HTTP server used for RPC and REST with one implemented entirely within the Bitcoin Core codebase. The new `HTTPServer` class runs its own I/O thread, handling socket connections with code based on #30988, but tailored specifically for HTTP.\r\n\r\nSome functional tests were added in #32408 to cover libevent behaviors that remain consistent with this branch. \r\n\r\nCommit strategy:\r\n- Implement a few helper functions for strings, timestamps, etc needed by HTTP protocol\r\n- Isolate the existing libevent-based HTTP server in a namespace `http_libevent`\r\n- Implement HTTP in a new namespace `http_bitcoin` (classes like `HTTPRequest`, `HTTPClient`, etc...)\r\n- Switch bitcoind from the libevent server to the new server\r\n- Clean up (delete `http_libevent`)\r\n\r\nI am currently seeing about a 10% speed up in the functional tests on my own arm/macos machine.\r\n\r\n## Integration testing:\r\n\r\nI am testing the new HTTP server by forking projects that integrate with bitcoin via HTTP and running their integration tests with bitcoind built from this branch (on Github actions). I will continue adding integrations over time, and re-running these CI tests as this branch gets rebased:\r\n\r\n- [NodeJS `rpc-bitcoin`](https://github.com/pinheadmz/rpc-bitcoin/pull/1)\r\n- [electrs](https://github.com/pinheadmz/electrs/pull/1)\r\n- [lnd](https://github.com/pinheadmz/lnd/pull/1)\r\n- [eclair](https://github.com/pinheadmz/eclair/pull/1)\r\n- [corepc](https://github.com/pinheadmz/corepc/pull/1)\r\n- [bitcoinjs-lib](https://github.com/pinheadmz/bitcoinjs-lib/pull/1)",
      "state": "open",
      "user": "pinheadmz",
      "created_at": "2025-03-13T19:32:14Z",
      "updated_at": "2026-02-03T11:44:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32061",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1752,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2498563333,
      "number": 32420,
      "title": "mining, ipc: omit dummy extraNonce from coinbase",
      "body": "This PR changes the Mining IPC interface to stop including a dummy `extraNonce` in the coinbase `scriptSig` by default, exposing only the consensus-required BIP34 height. This simplifies downstream mining software (including Stratum v2), avoids forcing clients to strip or ignore data we generate, and reduces the risk of incompatibilities if future soft forks add required commitments to the `scriptSig`.\r\n\r\nExisting behavior is preserved for RPCs, tests, regtest, and internal mining by explicitly opting in to the dummy `extraNonce` where needed (e.g. to satisfy `bad-cb-length` at low heights), so consensus rules and test coverage are unchanged. The remainder of the PR consists of small comment fixes, naming clarifications, and test cleanups to make the intent and behavior clearer.",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2025-05-05T12:01:31Z",
      "updated_at": "2026-02-03T11:35:23Z",
      "merged_at": "2026-02-02T23:21:48Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32420",
      "labels": [
        "Mining"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 838,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1814496897,
      "number": 29838,
      "title": "Feature: Use different datadirs for different signets",
      "body": "Fixes https://github.com/bitcoin/bitcoin/issues/27494\r\n\r\nWhen the `-signetchallenge` argument is provided, the hash-160 of the challenge is appended to the data directory name. This ensures that each signet has its own distinct data directory, following the naming convention `signet_XXXXXXX`.\r\n\r\nNote:\r\nThe behaviour of the default signet remains unchanged\r\n\r\n### Update:\r\n\r\nWhen the `-signetchallenge` argument is provided, `the first 8 characters of the hash-160 of the challenge` are appended to the data directory name. This ensures that each signet has its own distinct data directory, following the naming convention `signet_XXXXXXX`.\r\n\r\n",
      "state": "open",
      "user": "BrandonOdiwuor",
      "created_at": "2024-04-09T16:25:32Z",
      "updated_at": "2026-02-03T11:30:55Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29838",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 699,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3236411199,
      "number": 34481,
      "title": "Update secp256k1 subtree to latest master",
      "body": "Updates the secp256k1 subtree to latest master (https://github.com/bitcoin-core/secp256k1/commit/57315a69853c9bd4765fccf20b541d47f1b45ca9), which includes https://github.com/bitcoin-core/secp256k1/pull/1813.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-02-02T12:50:00Z",
      "updated_at": "2026-02-03T11:11:33Z",
      "merged_at": "2026-02-03T11:11:24Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34481",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 249,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3227611627,
      "number": 34461,
      "title": "ci: Print verbose build error message in test-each-commit",
      "body": "Currently, the build error in the test-each-commit task is not too nice. E.g. https://github.com/bitcoin/bitcoin/actions/runs/21509735101/job/61973587699#step:8:10464:\r\n\r\n```\r\n...\r\n[ 75%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/txvalidation_tests.cpp.o\r\n[ 75%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/txvalidationcache_tests.cpp.o\r\n[ 75%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/validation_block_tests.cpp.o\r\n[ 75%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/validation_chainstate_tests.cpp.o\r\n[ 75%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/validation_chainstatemanager_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/validation_flush_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/validation_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/wallet_test_fixture.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/db_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/coinselector_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/coinselection_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/feebumper_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/group_outputs_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/ismine_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/psbt_wallet_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/scriptpubkeyman_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/spend_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/wallet_rpc_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/wallet_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/wallet_transaction_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/walletdb_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/wallet/test/walletload_tests.cpp.o\r\n[ 76%] Building CXX object src/test/CMakeFiles/test_bitcoin.dir/__/ipc/test/ipc_tests.cpp.o\r\n[ 77%] Linking CXX executable ../../bin/test_bitcoin\r\n[ 87%] Built target test_bitcoin\r\ngmake: *** [Makefile:146: all] Error 2\r\nCommand '['cmake', '--build', 'ci_build', '-j', '4']' returned non-zero exit status 2.\r\nerror: cannot rebase: Your index contains uncommitted changes.\r\nwarning: execution failed: git merge --no-commit origin/master && python3 ./.github/ci-test-each-commit-exec.py && git reset --hard\r\nand made changes to the index and/or the working tree.\r\nYou can fix the problem, and then run\r\n\r\n  git rebase --continue\r\n\r\n\r\nError: Process completed with exit code 1.\r\n```\r\n\r\nFix it by just using the same approach that the other CI tasks are using:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/01651324f4e540f6b96cff31e89752c3f9417293/ci/test/03_test_script.sh#L143-L146",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-30T12:12:11Z",
      "updated_at": "2026-02-03T11:06:27Z",
      "merged_at": "2026-02-03T10:49:33Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34461",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3327,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2084545790,
      "number": 30941,
      "title": "test: simplify timewarp test",
      "body": "Follow up from PR #30698 (comment https://github.com/bitcoin/bitcoin/pull/30698#discussion_r1729632270).\r\n\r\n`mining_basic` checks that a block with wall time is rejected when the previous block is `MAX_FUTURE_BLOCK_TIME` in the future, then checks that a block just beyond the `MAX_TIMEWARP` is also rejected.\r\n\r\nThis PR removes the first check, since they seem to be essentially checking the same thing twice.\r\nAlso incorporates the suggestion in https://github.com/bitcoin/bitcoin/pull/30698#discussion_r1730946634 to reuse `block`.",
      "state": "closed",
      "user": "tdb3",
      "created_at": "2024-09-21T14:51:15Z",
      "updated_at": "2026-02-03T11:06:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30941",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 563,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2306671936,
      "number": 31763,
      "title": "Pass custom DEP_OPTS and CONFIG_FLAGS to guix-build",
      "body": "This allows building deterministic binaries with multiprocess like so:\r\n\r\n```sh\r\nDEP_OPTS=\"MULTIPROCESS=1\" contrib/guix/guix-build\r\n```\r\n\r\nAdditionally custom options can be passed to `cmake -B` using `CONFIG_FLAGS`. Example (turns off external signer support, the rest is default):\r\n\r\n```sh\r\nCONFIG_FLAGS=\"-DENABLE_EXTERNAL_SIGNER=OFF -DREDUCE_EXPORTS=ON -DBUILD_BENCH=OFF -DBUILD_GUI_TESTS=OFF -DBUILD_FUZZ_BINARY=OFF\" contrib/guix/guix-build\r\n```\r\n\r\nThe `CONFIG_FLAGS` is less useful in practice, because:\r\n\r\n1. Some options will cause the Guix build to fail, e.g. because the packaging step assumes their presence.\r\n2. Some options are already indirectly controlled though `DEP_OPTS`",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2025-01-30T11:45:18Z",
      "updated_at": "2026-02-03T11:06:25Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31763",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 739,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3227175463,
      "number": 34458,
      "title": "net: Don't log own ips during discover",
      "body": "The -logips option seems to imply that ip addresses are only logged when it is set. This seems like an obvious case for not logging these by default. There might be prior discussion around this, but I was unable to find why these might be exempt. There are also a few issues (both open and closed) where printing these lines was useful.",
      "state": "open",
      "user": "sedited",
      "created_at": "2026-01-30T09:59:41Z",
      "updated_at": "2026-02-03T11:00:26Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34458",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 375,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2471245988,
      "number": 32317,
      "title": "kernel: Separate UTXO set access from validation functions",
      "body": "The current code makes it hard to call functions for checking the consensus-correctness of a block without having a full UTXO set at hand. This makes implementing features such as Utreexo and non-assumevalid swiftsync, where maintaining a full UTXO set defeats their purpose, through the kernel API difficult. Checks like the coinbase subsidy, or block sigops are only available through `ConnectBlock`, which requires a complete coins cache.\r\n\r\nSolve this by moving accessing coins and the responsibility of spending them out of `ConnectBlock` and into a new separate function called `SpendBlock`. Pass a block's spent coins through the existing `CBlockUndo` data structure to `ConnectBlock`. \r\n\r\nWhile the change is largely a refactor, some smaller behaviour changes were unavoidable. These should be highlighted in the commit messages. The last commit contains the most important part of the coins logic move, the commits before attempt to prepare it piecemeal.\r\n\r\nThis pull request was benchmarked on [benchcoin](https://github.com/bitcoin-dev-tools/benchcoin/pull/162), which showed no performance regression. While discussing this pull request it was noted that pre-fetching and eliminating the need for some additional map lookups might improve performance a bit, but this does not make a measurable difference in the grand scheme of things and was not the motivation for this pull request.\r\n\r\nIn future changes, ConnectBlock could be made even more self contained, accessing the coins from the internal map could be further optimized by consolidating existence checking and spending, and the function eventually exposed in an external kernel API (as done [here](https://github.com/sedited/bitcoin/commit/09e05493010119fc60d310d3e7ffc388de441f9a#diff-f638e65d9278276b2a6ac42ffbbd26d079c3dba752feed5038a25a1ee565d320R947))",
      "state": "open",
      "user": "sedited",
      "created_at": "2025-04-21T13:15:46Z",
      "updated_at": "2026-02-03T09:34:02Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32317",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1886,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3124280596,
      "number": 34141,
      "title": "miniscript: Use Func and Expr when parsing keys, hashes, and locktimes",
      "body": "The miniscript parser currently only looks for the next `)` when parsing key, hash, and locktime expressions. This fails to parse when the expressions contain a nested expression. Currently, this is only possible with `musig()` inside of key expressions. However, this pattern can be generalized to handling hashes and locktimes, so I implemented those too.\r\n\r\nFixes #34076",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-12-22T21:36:58Z",
      "updated_at": "2026-02-03T00:24:24Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34141",
      "labels": [
        "Descriptors"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 444,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2511642895,
      "number": 32468,
      "title": "rpc: generateblock to allow multiple outputs",
      "body": "## Generatetomany\r\n\r\nFirst approach was to create a `generatetomany` rpc call. That approach can be seen here https://github.com/polespinasa/bitcoin/pull/3\r\n\r\n## Generateblock\r\nModifies `generateblock` to allow a user to set multiple outputs in the coinbase transaction. If an empty set is provided, the block will be empty. If no set of transactions is provided, the block will mine the mempool. If a set of transactions is provided only that set of txs will be mined.\r\n\r\n```\r\n$./bitcoin-cli -rpcport=18443 generateblock bcrt1qw6qkj8wtw5hraxwxjp08m4aymkntms3yhqyacj\r\n{\r\n  \"hash\": \"7359a3ed7af0f18f4016e6cb29193bd787a2452c584781135c585d5204b9ec5b\"\r\n}\r\n\r\n$ ./bitcoin-cli -rpcport=18443 generateblock '[\"bcrt1qal6p633hvwz2yp5mav0qy7u2az8gkn2xywnj6v\", \"bcrt1qvr3qgyhw6y0e0zj97v0j5yc40xtpea4wqj0g43\"]'\r\n{\r\n  \"hash\": \"6db028454b26d6667dd6df45be2772844121fb44f86433f6bbfbafa429974684\"\r\n}\r\n\r\n$ ./bitcoin-cli -rpcport=18443 generateblock '[\"bcrt1qal6p633hvwz2yp5mav0qy7u2az8gkn2xywnj6v\", \"bcrt1qvr3qgyhw6y0e0zj97v0j5yc40xtpea4wqj0g43\"]' []\r\n\r\n{\r\n  \"hash\": \"33e2ddc52546ddb0edf28bef5b295ee8fbd487b8aca19c97018467e2477877df\"\r\n}\r\n\r\n```\r\n\r\n### Motivation\r\nhttps://x.com/SuperTestnet/status/1921220086645342550\r\n\r\nCitating @supertestnet \r\n> When mining a block on regtest, the command \"generatetoaddress\" is available if you want to send the entire coinbase to 1 address. Let's add generatetomany in case you want to split up the coinbase among multiple addresses, similar to how the \"sendtoaddress\" and \"sendmany\" commands both exist and let you send money to (1) one address or (2) multiple addresses. The generatetomany command would be particularly useful for simulating protocols that send money to multiple recipients directly from a coinbase, as several pools do now, like ocean and braidpool.\r\n\r\n### Notes\r\n- ~Needs release note~\r\n- ~Changes on `generateblock` are not backwards compatible as now it takes an array of outputs instead a single output. This should not be critical as it is a test RPC.~ ",
      "state": "open",
      "user": "polespinasa",
      "created_at": "2025-05-10T17:34:29Z",
      "updated_at": "2026-02-03T00:02:22Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32468",
      "labels": [
        "RPC/REST/ZMQ",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2041,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3054407979,
      "number": 33966,
      "title": "refactor: disentangle miner startup defaults from runtime options",
      "body": "The interaction between node startup options like `-blockreservedweight` and runtime options, especially those passed via IPC, is confusing.\r\n\r\nThey're combined in `BlockAssembler::Options`, which this PR gets rid of in favour of two distinct structs:\r\n\r\n1. `BlockCreateOptions`: used by interface clients. As before, IPC clients have access to a safe / sane subset, whereas RPC and test code can use all fields.\r\n2. `MiningArgs`: these are set once during node startup\r\n\r\nBoth structs have a member for the maximum block height, which is not a problem since they're different structs. The one on `MiningArgs` (`block_max_weight`) matches `-maxblockheight` and is left alone. The one on `BlockCreateOptions` (`block_max_weight`) is an optional, it's set by `ApplyMiningDefaults` only if empty. \r\n\r\nThis all happens in the last commit and requires some preparation to keep things easy to review.\r\n\r\nWe get rid of `BlockAssembler::Options` but this is used in many tests. Since large churn is inevitable, we might as well switch all tests, bench and fuzzers over to the Mining interface. The first (non-base) commit does that, dramatically reducing direct use of `BlockAssembler`. Two exceptions are documented in the commit message. Because `test_block_validity` wasn't available via the interface and the block_assemble benchmark needs it, it's moved from `BlockAssembler::Options` to `BlockCreateOptions` (still not exposed via IPC).\r\n\r\nWe need access to mining related defaults and structs from both the miner and node initialization code. To avoid having to pull in all of `BlockAssembler` for the latter, the second commit introduces `node/mining.h` and moves constants and structs there from `src/node/types.h` (`BlockCreateOptions`, `BlockWaitOptions`, `BlockCheckOptions`) and `src/node/miner.h` (`DEFAULT_PRINT_MODIFIED_FEE`).\r\n\r\nI considered also moving `DEFAULT_BLOCK_MAX_WEIGHT`, `DEFAULT_BLOCK_RESERVED_WEIGHT`, `MINIMUM_BLOCK_RESERVED_WEIGHT` and `DEFAULT_BLOCK_MIN_TX_FEE` there from `policy.h`, since they are distinct from relay policy and not needed by the kernel. But this seems more appropriate for a follow-up and requires additional discussion.\r\n\r\nThe meat and potatoes of this PR is split between the three last commits for easier review:\r\n\r\n1. Adds `node/mining_args.{h,cpp}` and move the options checking out of `init.cpp`, without adding storage\r\n2. Add `block_max_weight` to `BlockCreateOptions` as explained above\r\n3. Introduce the `MiningArgs` struct, add it to the `NodeContext`, expand `mining_args.cpp` to store it, pass it to `BlockAssembler`, etc.\r\n\r\nI kept variable renaming and other formatting changes to a minimum to ease review with `--color-moved=dimmed-zebra`.\r\n\r\nThis PR builds on the bug fix in:\r\n- [ ] #33965\r\n\r\nOnce that is merged, this PR should not change behaviour.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-11-28T15:42:31Z",
      "updated_at": "2026-02-02T23:52:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33966",
      "labels": [
        "Refactoring",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2878,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3236402146,
      "number": 34480,
      "title": "wallet: don't back-date locktime below unconfirmed input locktime",
      "body": "Fixes #26527\r\n\r\nThe Bitcoin Core wallet implements an anti-fee-sniping mechanism that sets a transaction's nLockTime to the current block height, and occasionally to an earlier height.\r\n\r\nWhen spending unconfirmed UTXOs, this logic can currently choose a locktime for the child transaction that is earlier than the locktime of its unconfirmed parent. This creates an unrealistic \"transaction signed earlier but only broadcast now\" scenario and may act as a wallet fingerprint.\r\n\r\nThis PR fixes the issue by adding a `min_locktime` parameter to `DiscourageFeeSniping`. When creating a transaction, the wallet now sets this minimum to the highest locktime among all unconfirmed parent transactions (or 0 if all inputs are confirmed). This ensures that while the locktime can still be backdated for anti-fee-sniping, it won't go below any unconfirmed input's locktime.\r\n\r\n`DiscourageFeeSniping` is invoked by the following RPCs:\r\n- sendall\r\n- send\r\n- sendtoaddress\r\n- sendmany\r\n- fundrawtransaction\r\n- walletcreatefundedpsbt\r\n\r\nHowever, only `sendall` and `send` can actually hit this edge case. The `sendtoaddress` and `sendmany` RPCs don't spend unconfirmed inputs, while `fundrawtransaction` and `walletcreatefundedpsbt` don't use the anti-fee-sniping logic and instead always set nLockTime to 0 unless explicitly provided by the user.",
      "state": "open",
      "user": "danielabrozzoni",
      "created_at": "2026-02-02T12:47:55Z",
      "updated_at": "2026-02-02T22:12:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34480",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1401,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3237915411,
      "number": 34487,
      "title": "[Spelling] Bitcin -> Bitcoin (cc translation service)",
      "body": "I don't know polish (or pl, I don't know the language), so I can't change this via translation plattform, so please report this there, thanks!",
      "state": "closed",
      "user": "benediktjohannes",
      "created_at": "2026-02-02T19:02:58Z",
      "updated_at": "2026-02-02T21:54:49Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34487",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 196,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2799580389,
      "number": 33306,
      "title": "index: Force database compaction in coinstatsindex",
      "body": "This PR forces full database compaction on coinstatsindex every 10,000 blocks. This does not seem to come with any considerable performance impact, though I did not test on many different systems.\r\n\r\nMotivation: Currently, coinstatsindex ends up using a lot of 55kb files if this is not the case. This is likely related to very fast writes occurring during sync but so far I could not pin down where exactly the difference in behavior is coming from. It seems to be a LevelDB internal thing though, since I can not make out any difference in configuration between coinstatsindex and the other indexes.\r\n\r\nThis was first reported here: https://github.com/bitcoin/bitcoin/pull/30469#issuecomment-3235597424",
      "state": "open",
      "user": "fjahr",
      "created_at": "2025-09-04T13:56:22Z",
      "updated_at": "2026-02-02T21:52:57Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33306",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 755,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2005623544,
      "number": 30595,
      "title": "kernel: Introduce C header API",
      "body": "This is a first attempt at introducing a C header for the libbitcoinkernel library that may be used by external applications for interfacing with Bitcoin Core's validation logic. It currently is limited to operations on blocks. This is a conscious choice, since it already offers a lot of powerful functionality, but sits just on the cusp of still being reviewable scope-wise while giving some pointers on how the rest of the API could look like.\r\n\r\nThe current design was informed by the development of some tools using the C header:\r\n\r\n* A re-implementation (part of this pull request) of [bitcoin-chainstate](https://github.com/bitcoin/bitcoin/blob/master/src/bitcoin-chainstate.cpp).\r\n* A re-implementation of the python [block linearize](https://github.com/bitcoin/bitcoin/tree/master/contrib/linearize) scripts: https://github.com/TheCharlatan/bitcoin/tree/kernelLinearize \r\n* A silent payment scanner: https://github.com/josibake/silent-payments-scanner\r\n* An electrs index builder: https://github.com/josibake/electrs/commits/electrs-kernel-integration\r\n* A rust bitcoin node: https://github.com/TheCharlatan/kernel-node\r\n* A reindexer: https://github.com/TheCharlatan/bitcoin/tree/kernelApi_Reindexer\r\n\r\nThe library has also been used by other developers already:\r\n\r\n* A historical block analysis tool: https://github.com/ismaelsadeeq/mining-analysis\r\n* A swiftsync hints generator: https://github.com/theStack/swiftsync-hints-gen\r\n* Fast script validation in floresta: https://github.com/vinteumorg/Floresta/pull/456\r\n* A swiftsync node implementation: https://github.com/2140-dev/swiftsync/tree/master/node\r\n\r\nNext to the C++ header also made available in this pull request, bindings for other languages are available here: \r\n\r\n* Rust: https://github.com/TheCharlatan/rust-bitcoinkernel\r\n* Python: https://github.com/stickies-v/py-bitcoinkernel \r\n* Go: https://github.com/stringintech/go-bitcoinkernel\r\n* Java: https://github.com/yuvicc/java-bitcoinkernel\r\n\r\nThe rust bindings include unit and fuzz tests for the API.\r\n\r\nThe header currently exposes logic for enabling the following functionality:\r\n* Feature-parity with the now deprecated libbitcoin-consensus\r\n* Optimized sha256 implementations that were not available to previous users of libbitcoin-consensus thanks to a static kernel context\r\n* Full support for logging as well as control over categories and severity\r\n* Feature parity with the existing experimental bitcoin-chainstate\r\n* Traversing the block index as well as using block index entries for reading block and undo data.\r\n* Running the chainstate in memory\r\n* Reindexing (both full and chainstate-only)\r\n* Interrupting long-running functions\r\n\r\nThe pull request introduces a new kernel-only test binary that purely relies on the kernel C header and the C++ standard library. This is intentionally done to show its capabilities without relying on other code inside the project. This may be relaxed to include some of the existing utilities, or even be merged into the existing test suite.\r\n\r\nThe complete docs for the API as well as some usage examples are hosted on [thecharlatan.ch/kernel-docs](https://thecharlatan.ch/kernel-docs/index.html). The docs are generated from the following repository (which also holds the examples): [github.com/TheCharlatan/kernel-docs](https://github.com/TheCharlatan/kernel-docs).\r\n\r\n#### How can I review this PR?\r\n\r\nScrutinize the commit messages, run the tests, write your own little applications using the library, let your favorite code sanitizer loose on it, hook it up to your fuzzing infrastructure, profile the difference between the existing bitcoin-chainstate and the bitcoin-chainstate introduced here, be nitty on the documentation, police the C interface, opine on your own API design philosophy.\r\n\r\nTo get a feeling for the API, read through the tests, or one of the examples.\r\n\r\nTo configure this PR for making the shared library and the bitcoin-chainstate and test_kernel utilities available:\r\n```\r\ncmake -B build -DBUILD_KERNEL_LIB=ON -DBUILD_UTIL_CHAINSTATE=ON\r\n```\r\n\r\nOnce compiled the library is part of the build artifacts that can be installed with:\r\n```\r\ncmake --install build\r\n```\r\n\r\n#### Why a C header (and not a C++ header)\r\n\r\n* Shipping a shared library with a C++ header is hard, because of name mangling and an unstable ABI.\r\n* Mature and well-supported tooling for integrating C exists for nearly every popular language.\r\n* C offers a reasonably stable ABI\r\n\r\nAlso see https://github.com/bitcoin/bitcoin/pull/30595#issuecomment-2285719575.\r\n\r\n#### What about versioning?\r\n\r\nThe header and library are still experimental and I would expect this to remain so for some time, so best not to worry about versioning yet.\r\n\r\n#### Potential future additions\r\n\r\nIn future, the C header could be expanded to support (some of these have been roughly implemented):\r\n\r\n* Handling transactions, block headers, coins cache, utxo set, meta data, and the mempool\r\n* Adapters for an abstract coins store\r\n* Adapters for an abstract block store\r\n* Adapters for an abstract block tree store\r\n* Allocators and buffers for more efficient memory usage\r\n* An \"[io-less](https://sans-io.readthedocs.io/how-to-sans-io.html)\" interface\r\n* Hooks for an external mempool, or external policy rules\r\n\r\n#### Current drawbacks\r\n\r\n* For external applications to read the block index of an existing Bitcoin Core node, Bitcoin Core needs to shut down first, since leveldb does not support reading across multiple processes. Other than migrating away from leveldb, there does not seem to be a solution for this problem. Such a migration is implemented in #32427.\r\n* The fatal error handling through the notifications is awkward. This is partly improved through #29642.\r\n* Handling shared pointers in the interfaces is unfortunate. They make ownership and freeing of the resources fuzzy and poison the interfaces with additional types and complexity. However, they seem to be an artifact of the current code that interfaces with the validation engine. The validation engine itself does not seem to make extensive use of these shared pointers.\r\n* If multiple instances of the same type of objects are used, there is no mechanism for distinguishing the log messages produced by each of them. A potential solution is #30342.\r\n* The background leveldb compaction thread may not finish in time leading to a non-clean exit. There seems to be nothing we can do about this, outside of patching leveldb.",
      "state": "closed",
      "user": "sedited",
      "created_at": "2024-08-06T09:18:27Z",
      "updated_at": "2026-02-02T20:07:45Z",
      "merged_at": "2025-11-04T15:38:51Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30595",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 6484,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3013940276,
      "number": 33878,
      "title": "refactor, docs: Embedded ASMap [2/3]: Refactor asmap internals and add documentation",
      "body": "This is a second slice carved out of #28792. It contains the following changes that are crucial for the embedding of asmap data which is added the following PR in the series (probably this will remain in #28792).\r\n\r\nThe changes are:\r\n- Modernizes and simplifies the asmap code by operating on `std::byte` instead of bits\r\n- Unifies asmap version calculation and naming (previously it was called version and checksum interchangeably)\r\n- Operate on a `span` rather than a vector in the asmap internal to prevent holding the asmap data in memory twice\r\n- Add more extensive documentation to the asmap implementation\r\n- Unify asmap casing in implemetation function names\r\n\r\nThe first three commits were already part of #28792, the others are new.\r\n\r\nThe documentation commit came out of feedback gathered at the latest CoreDev. The primary input for the documentation was the documentation that already existed in the Python implementation (`contrib/asmap/asmap.py`) but there are several other comments as well. Please note: I have also asked several LLMs to provide suggestions on how to explain pieces of the implementation and better demonstrate how the parts work together. I have copied bits and pieces that I liked but everything has been edited further by me and obviously all mistakes here are my own. ",
      "state": "closed",
      "user": "fjahr",
      "created_at": "2025-11-15T20:50:29Z",
      "updated_at": "2026-02-02T17:22:39Z",
      "merged_at": "2026-02-02T17:22:39Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33878",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1392,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3237156760,
      "number": 34482,
      "title": "Fix discover bind any v26",
      "body": "This PR fixes #31293 on the 26.x branch.\r\n\r\nWhen using `-bind=0.0.0.0:port` (or `-bind=::`), the `Discover()` function was not being executed because the code only checked the `bind_on_any` flag. This meant the node would not discover its own local addresses if an explicit \"any\" bind was used.\r\n\r\nThis commit checks both `bind_on_any` and any bind addresses using `IsBindAny()` to ensure `Discover()` runs when binding to 0.0.0.0 or ::, even if specified explicitly.\r\n\r\nNote: This fix targets the 26.x branch. A similar fix for master is being worked on in #32757.",
      "state": "closed",
      "user": "AnmolM-777",
      "created_at": "2026-02-02T15:38:25Z",
      "updated_at": "2026-02-02T16:46:24Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34482",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 591,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3237311085,
      "number": 34485,
      "title": "rpc: Allow importprunedfunds to import spending transactions",
      "body": "### Motivation\n`importprunedfunds` previously only allowed importing transactions that credit the wallet (`IsMine` check). This prevented users from importing transactions that spend funds from the wallet if the transaction had no outputs belonging to the wallet (e.g. sending entire balance to an external address).\n\nUsers typically want to import spending transactions to correctly reflect the debit and update the balance/history in a pruned wallet.\n\nFixes #21647.\n\n### Solution\nUpdated `importprunedfunds` in `src/wallet/rpc/backup.cpp` to check `pwallet->IsFromMe(*tx_ref)` in addition to `pwallet->IsMine(*tx_ref)`.\n\n### Testing\nAdded a regression test case in `test/functional/wallet_importprunedfunds.py` that:\n1. Funds a wallet address.\n2. Sends the entire balance to an external address (creating a spending transaction with no change output).\n3. Removes the transaction.\n4. Verifies that `importprunedfunds` can successfully re-import this spending transaction.",
      "state": "closed",
      "user": "BuilderFred",
      "created_at": "2026-02-02T16:13:31Z",
      "updated_at": "2026-02-02T16:15:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34485",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1033,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3188542853,
      "number": 34344,
      "title": "ci: update GitHub Actions versions",
      "body": "This PR updates outdated GitHub Action versions to ensure compatibility and improve functionality. The following changes are made to the GitHub Actions:\r\n- `actions/upload-artifact` updated from v4 to v6\r\n- `actions/cache` updated from v4 to v5\r\n- `actions/download-artifact` updated from v5 to v7\r\n\r\nThe updates are necessary to support newer environments and features, and ensure consistent behavior across different workflows. The changes will be tested in the CI pipeline of the pull request.\r\n",
      "state": "closed",
      "user": "pgoslatara",
      "created_at": "2026-01-19T17:02:36Z",
      "updated_at": "2026-02-02T16:11:28Z",
      "merged_at": "2026-01-20T14:49:44Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34344",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 533,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3228429690,
      "number": 34463,
      "title": "[28.x] Backports",
      "body": "Contains one change to switch the macOS runners to a version that still works (13 -> 14):\r\n* https://github.com/bitcoin/bitcoin/pull/34463/commits/4d4e3600af73fb673b68b02eea525675a2761b67\r\n\r\nAlso backports:\r\n* #32513 (partial backport)\r\n* #34174\r\n* #34344",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-01-30T16:12:44Z",
      "updated_at": "2026-02-02T16:10:41Z",
      "merged_at": "2026-02-02T16:09:45Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34463",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 272,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3237263749,
      "number": 34484,
      "title": "net: Enable local address discovery when bind=0.0.0.0 is used",
      "body": "### Motivation\nThe `Discover()` function in `init.cpp` was only being called if `bind_on_any` was true. However, `bind_on_any` is set to false if an explicit `-bind` argument is provided, even if that argument is `-bind=0.0.0.0` (which effectively binds to all interfaces).\n\nThis behavior prevented local address discovery when a user explicitly configured `-bind=0.0.0.0`, which is common in containerized environments or when users want to be explicit about interface binding.\n\nFixes #31293.\n\n### Solution\nUpdated the logic in `init.cpp` to check if any of the provided bind addresses (either via `-bind` or `-whitebind`) are \"any\" addresses (0.0.0.0 or ::). If so, we enable discovery.\n\n### Testing\n- Validated that `Discover()` is called when `-bind=0.0.0.0` is used.\n- Verified standard behavior (no bind, specific bind) remains unchanged.",
      "state": "closed",
      "user": "BuilderFred",
      "created_at": "2026-02-02T16:03:13Z",
      "updated_at": "2026-02-02T16:09:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34484",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 906,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2637847621,
      "number": 32861,
      "title": "Have createwalletdescriptor auto-detect an unused(KEY)",
      "body": "The `createwalletdescriptor` was introduced in #29130 to let users add a `tr()` descriptor to an existing SegWit wallet. The new `addhdkey` method from #29136 introduces a new potential workflow: start from a blank wallet, generate an HD and then add only the descriptors you need, e.g.:\r\n\r\n```sh\r\nbitcoin rpc createwallet TaprootMaxi blank=true\r\nbitcoin rpc addhdkey\r\nbitcoin rpc createwalletdescriptor bech32m\r\n```\r\n\r\nBefore this PR the last line would fail, requiring the user to call `gethdkeys` and copy-paste the xpub.\r\n\r\nThis PR makes `createwalletdescriptor` a bit smarter so it just finds the `unused(KEY)` generated by `hdkey` and uses that.\r\n\r\nIf multiple `unused(KEY)` descriptors are present the user still has to pick one.\r\n\r\nA potential followup is to make our [multisig tutorial](https://github.com/bitcoin/bitcoin/blob/master/doc/multisig-tutorial.md) slightly safer to use. Rather than creating a full wallet, the instruction could be changed to start with a blank wallet and only generate the default legacy descriptor. This avoids accidental use of single sig `p2sh-segwit` and `bech32` addresses.\r\n\r\n(I might do that in #32784, which introduces some other improvements to the tutorial. The situation is still not great; ideally the `importdescriptors` RPC is enhanced to detect when an `xpub` is a child of an hd key and then treats it as if an xpriv was imported.)\r\n\r\nBuilds on #29136.",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-07-03T08:55:40Z",
      "updated_at": "2026-02-02T15:54:16Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32861",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1462,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2607107167,
      "number": 32784,
      "title": "wallet: derivehdkey RPC to get xpub at arbitrary path",
      "body": "Given a (blank) wallet with an `unused(KEY)` descriptor, `derivehdkey \"m/87h/0h/0h\"` gets the xpub or xpriv at any given path.\r\n\r\nThis is particularly useful for multisig setup where it's not desirable to use our default derivations (e.g. 44h).\r\n\r\nI updated the multisig tutorial and the functional test.\r\n\r\nBased on:\r\n- #29136",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-06-20T11:04:39Z",
      "updated_at": "2026-02-02T15:38:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32784",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 381,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2946400797,
      "number": 33701,
      "title": "test: add case where `TOTAL_TRIES` is exceeded yet solution remains",
      "body": "Show that `CoinGrider` halts searching when the number of attempts exceeds `TOTAL_TRIES`.  To do so, show that a solution is found, then add one more entry to the same set of inputs.  Since the search orders by `effective_value`, the solution is constructed such that only values with the lowest `effective_value` have the least weight.  Only the lowest weight values will not exceed the `max_selection_weight`. Therefore, `CoinGrinder` will not evaluate all lowest weight solutions together before exceeding `TOTAL_TRIES` since they are last found.\r\n\r\nThis test case was inspired by a similar test for `BnB` currently named `bnb_test`.",
      "state": "closed",
      "user": "yancyribbens",
      "created_at": "2025-10-25T00:30:30Z",
      "updated_at": "2026-02-02T15:25:12Z",
      "merged_at": "2026-01-31T02:26:18Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33701",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 704,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3222904629,
      "number": 34442,
      "title": "ci: use Alpine 3.23",
      "body": "Use the latest version of Alpine ([3.23](https://www.alpinelinux.org/posts/Alpine-3.23.0-released.html)) in the CI job.\r\nThis should fail for now (https://github.com/bitcoin-core/secp256k1/pull/1813), given the use of GCC `15.x`.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-01-29T11:05:53Z",
      "updated_at": "2026-02-02T15:23:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34442",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 249,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1799118469,
      "number": 29770,
      "title": "index: Check all necessary block data is available before starting to sync",
      "body": "Currently, we check that `BLOCK_HAVE_DATA` is available for all blocks an index needs to sync during startup. However, for `coinstatsindex` and `blockfilterindex` we also need the undo data for these blocks. If that data is missing in the blocks, we are currently still starting to sync each of these indices and then crash later when we encounter the missing data.\r\n\r\nThis PR adds explicit knowledge of which block data is needed for each index and then checks its availability during startup before initializing the sync process on them.\r\n\r\nThis also addresses a few open comments from #29668 in the last commit.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2024-03-30T22:55:19Z",
      "updated_at": "2026-02-02T15:21:22Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29770",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 689,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1966370491,
      "number": 30437,
      "title": "ipc: add bitcoin-mine test program",
      "body": "Add [`bitcoin-mine`](https://github.com/ryanofsky/bitcoin/blob/pr/mine/src/bitcoin-mine.cpp#L20-L37) executable to test connecting to the `bitcoin-node` process over a unix socket and calling [`interface::Mining`](https://github.com/ryanofsky/bitcoin/blob/pr/mine/src/interfaces/mining.h) methods.\r\n\r\nThis is useful as discussed in https://github.com/bitcoin/bitcoin/pull/29432#issuecomment-2222418506 to work on getting mining code working in an external process.\r\n\r\nThis PR initially supported spawning a new `bitcoin-node` process if a connection could not be established with an existing process, but it was dropped to simplify the code. A branch building on this PR and adding that support is\r\n[pr/mine-detach](https://github.com/ryanofsky/bitcoin/commits/pr/mine-detach).\r\n\r\n---\r\n\r\nThis PR is part of the [process separation project](https://github.com/bitcoin/bitcoin/issues/28722).",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-07-12T10:37:28Z",
      "updated_at": "2026-02-02T15:14:12Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30437",
      "labels": [
        "interfaces"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 924,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3236051807,
      "number": 34477,
      "title": "ci: dbg ccache",
      "body": "see if 100% hit rate can be achieved",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-02-02T11:09:10Z",
      "updated_at": "2026-02-02T14:11:36Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34477",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 51,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2578165434,
      "number": 32709,
      "title": "cmake: Fix `FindQt` module",
      "body": "This PR improves the `FindQt` module in two ways:\r\n\r\n1. Ensures that the `find_package(Qt .. MODULE REQUIRED COMPONENTS ...)` call treats any missing component as a fatal error. In the master branch, only a warning is currently issued.\r\n\r\n2. Cleans up the user-facing part of the CMake cache following the migration to Qt 6. An exception (`Qt6_DIR`) is documented.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-06-09T11:34:24Z",
      "updated_at": "2026-02-02T13:23:53Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32709",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 391,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1681972231,
      "number": 29256,
      "title": "log, refactor: Allow log macros to accept context arguments",
      "body": "Allow `LogDebug()`, `LogTrace()`, `LogInfo()`, `LogWarning()`, and `LogError()` macros to accept context arguments to provide more information in log messages and more control over logging to callers.\r\n\r\nThis functionality is used in followup PRs:\r\n\r\n- [#30342](https://github.com/bitcoin/bitcoin/pull/30342) - To let libbitcoinkernel send output to specfic `BCLog::Logger` instances instead of a global instance, so output can be disambiguated and applications can have more control over logging.\r\n\r\n- [#30343](https://github.com/bitcoin/bitcoin/pull/30343) - To replace custom `WalletLogPrintf` calls with standard logging calls that automatically include wallet names and don't log everything at info level.\r\n\r\nThis PR does not change behavior of current log prints or require them to be updated. It includes tests and documentation covering the new functionality.\r\n\r\n---\r\n\r\nNote: Originally this PR also removed some restrictions around passing category constants to log macros to try to make them more consistent, but these changes were too controversial and have been dropped.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2024-01-16T22:09:35Z",
      "updated_at": "2026-02-02T12:55:42Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29256",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1142,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2502815894,
      "number": 32430,
      "title": "test: Add and use NodeClockContext",
      "body": "Currently mocktime is written to a global, which may leak between sub-tests (albeit some tests try to reset the mocktime on a best-effort basis). Also, when advancing it, one has to keep a counter variable around.\r\n\r\nFix both issues by a new `NodeClockContext`, which resets the mocktime once it goes out of scope. Also, it has a method to advance the mocktime by a delta.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2025-05-06T22:39:14Z",
      "updated_at": "2026-02-02T12:50:38Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32430",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 407,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3236158505,
      "number": 34478,
      "title": "ci: Fix LLVM repository signature failure",
      "body": "The LLVM apt repository uses legacy SHA1 signatures which are now rejected by the stricter Sequoia PGP policy.\r\n\r\nThis change extends the `sha1.second_preimage_resistance` cutoff date to 9999-01-01 in the default Sequoia config. This effectively whitelists the legacy signature algorithm, preventing \"OpenPGP signature verification failed\" errors during `apt-get update`.\r\n\r\nSee https://github.com/llvm/llvm-project/issues/153385.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-02-02T11:39:30Z",
      "updated_at": "2026-02-02T12:33:37Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34478",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 472,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3235969567,
      "number": 34475,
      "title": "ci: Treat SHA1 LLVM signing key as warning",
      "body": "The current SHA1 LLVM signing key is considered not secure since\r\n2026-02-01T00:00:00Z which makes this run fail when downloading\r\npackages.\r\n\r\nSee: https://github.com/llvm/llvm-project/issues/153385\r\n\r\nApply the fix from the issue to temporarily to treat this error as a\r\nwarning, until the upstream key can be updated.\r\n\r\nThis PR should be reverted once the upstream key is updated.",
      "state": "closed",
      "user": "willcl-ark",
      "created_at": "2026-02-02T10:46:25Z",
      "updated_at": "2026-02-02T12:32:33Z",
      "merged_at": "2026-02-02T12:32:33Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34475",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 427,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2348103116,
      "number": 31920,
      "title": "build: create Depends build type for depends and use it by default for depends builds",
      "body": "As discussed a good bit with fanquake and hebasto. Would be nice to have for v29, but it's very late, so no worries if it doesn't make it.\r\n\r\nFundamentally, this creates a \"Depends\" build type which represents the flags that were used to build depends as opposed to colliding with the other types.\r\n\r\nThis allows the forwarding of optional flags into the CMake build for the \"Depends\" build type, but the user can now optionally use an existing (Debug/RelWitDebInfo/etc.) type to ignore the optimization flags set by depends and use the ones from that type instead.\r\n\r\nAs an example, a user may do:\r\nmake -C depends\r\ncmake --toolchain depends/arm64-apple-darwin/toolchain.cmake -DCMAKE_BUILD_TYPE=Debug\r\n\r\nThis would compile depends with the default optimization flags for depends (-O2) but build Core with the default debug optimization flags from CMake\r\n\r\nDepends note:\r\nFor hosts, $host_*FLAGS variables now represent the mandatory flags for compiling and will be forwarded to all Core builds via the toolchain file, regardless of the build type. For most platforms they should be empty, but are useful at least for darwin.\r\n\r\nWhen setting (for example) CFLAGS from the command line when building depends, these flags will be stored in $host_release_CFLAGS (or _debug_), and will only be forwarded to the Depends build type.",
      "state": "open",
      "user": "theuni",
      "created_at": "2025-02-20T21:08:17Z",
      "updated_at": "2026-02-02T12:30:34Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31920",
      "labels": [
        "Build system",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 1413,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3230404793,
      "number": 34468,
      "title": "build: Fix debug prefix map for generated source files",
      "body": "This PR fixes an issue where debug paths were inconsistent for generated files residing in the build tree. #34414\r\n\r\nCurrently, the debug prefix map is restricted to `${DISTSRC}/src=.`. This configuration fails to correctly map generated files that exist outside of the `src` directory (e.g., Cap'n Proto definitions), resulting in inconsistent file paths during debugging.\r\n\r\n**Changes:**\r\n- Updated `HOST_CFLAGS` in `contrib/guix/libexec/build.sh` to map the entire `${DISTSRC}` to `.` instead of restricting it to `${DISTSRC}/src`.\r\n\r\nThis ensures all source files, including generated ones, have correct relative paths in the debug information.\r\n\r\n",
      "state": "open",
      "user": "BharathC0",
      "created_at": "2026-01-31T08:48:13Z",
      "updated_at": "2026-02-02T12:18:05Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34468",
      "labels": [
        "Build system",
        "DrahtBot Guix build requested"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 707,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3219913014,
      "number": 34432,
      "title": "test: Turn ElapseSteady into SteadyClockContext",
      "body": "`ElapseSteady` was introduced a while back, but is only used in one place. It makes more sense if this were a context manager, so that mocktime does not leak from one test into the next.\r\n\r\nSo turn it into a context manager, rename it and allow easy time advancement via e.g. `steady_ctx += 1h`.\r\n\r\n",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-28T18:08:52Z",
      "updated_at": "2026-02-02T10:31:41Z",
      "merged_at": "2026-02-02T09:45:09Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34432",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 347,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3136120149,
      "number": 34179,
      "title": "refactor: Enable transparent lookup for setBlockIndexCandidates to remove const_cast",
      "body": "### Rationale\r\n\r\nThis PR improves code safety by removing a `const_cast` in `src/validation.cpp`.\r\n\r\nCurrently, `setBlockIndexCandidates` stores mutable `CBlockIndex*`. However, validation logic (like `CVerifyDB`) often holds `const CBlockIndex*`. Previously, checking for existence in the set required casting away constness. While currently benign, this bypasses compiler safety checks and could mask accidental modifications in future refactors.\r\n\r\n### Description\r\n\r\n1.  **Enable Heterogeneous Lookup:** Added `using is_transparent = void;` to `CBlockIndexWorkComparator` in `src/node/blockstorage.h`. This allows the `std::set` to natively accept `const CBlockIndex*` for lookup (utilizing C++14 heterogeneous lookup).\r\n2.  **Remove Cast:** Removed the now unnecessary `const_cast<CBlockIndex*>` in `src/validation.cpp`, allowing the compiler to strictly enforce const-correctness.\r\n\r\n### Notes\r\n\r\n- **Refactoring only:** No behavioral change.\r\n- **Verification:** `validation_tests` and `blockmanager_tests` pass.",
      "state": "closed",
      "user": "joaonevess",
      "created_at": "2025-12-30T07:40:16Z",
      "updated_at": "2026-02-02T07:49:09Z",
      "merged_at": "2026-02-02T07:49:09Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34179",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1104,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3235087967,
      "number": 34473,
      "title": "test: add Taproot support to script_builder",
      "body": "Make the script_builder used in unit tests compatible with Taproot by adding a PushSchnorrSig helper. Add a few tests that cover boundary values for Taproot SIGHASH flags in SignatureHashSchnorr (including values at and above 84, which were not covered by existing unit tests).\r\nThis slightly improves unit test coverage of SignatureHashSchnorr, as suggested in issue #23279.\r\nCurrent unit test coverage for src/script/interpreter.cpp can be seen here: https://maflcko.github.io/b-c-cov/test_bitcoin.coverage/src/script/interpreter.cpp.gcov.html\r\n\r\nWe also have Taproot tests in bip341_keypath_test_vectors, but extending those tests would require preparing a test data. Making script_builder Taproot-compatible is a simpler way to add edge-case tests for SignatureHashSchnorr and to add more Taproot unit tests later.",
      "state": "open",
      "user": "kannapoix",
      "created_at": "2026-02-02T06:30:56Z",
      "updated_at": "2026-02-02T07:17:33Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34473",
      "labels": [
        "Tests",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 862,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3220348988,
      "number": 34433,
      "title": "script: remove unused `SCRIPT_ERR_LAST`",
      "body": "It was introduced in ab9edbd6b6eb3efbca11f16fa467c3c0ef905708 and never used since. It seems it might have been intended to be exposed as part of a public library interface, which has since been superseded.\r\n\r\nThe only call site uses SCRIPT_ERR_ERROR_COUNT directly.",
      "state": "closed",
      "user": "darosior",
      "created_at": "2026-01-28T20:10:04Z",
      "updated_at": "2026-02-02T07:16:51Z",
      "merged_at": "2026-02-02T07:16:50Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34433",
      "labels": [
        "Consensus"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 306,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3222995795,
      "number": 34443,
      "title": "validation: follow-up nits for lock-free `IsInitialBlockDownload()`",
      "body": "Innocent follow-up to #34253:\r\n* Add `AssertLockHeld(cs_main)` to `ChainstateManager::UpdateIBDStatus()` given it's already annotated with `EXCLUSIVE_LOCKS_REQUIRED(cs_main)`.\r\n* Fix outdated comment about constness of `ChainstateManager::IsInitialBlockDownload()` (compilation and build passes without it).\r\n* And since we're touching it, we might as well mark `ChainstateManager::IsInitialBlockDownload()` as `noexcept` now.\r\n\r\n\r\n",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2026-01-29T11:31:45Z",
      "updated_at": "2026-02-02T06:57:44Z",
      "merged_at": "2026-02-02T06:57:43Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34443",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 500,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1004149182,
      "number": 25665,
      "title": "refactor: Add util::Result failure types and ability to merge result values",
      "body": "Add `util::Result` support for returning more error information and make use of it in [LoadChainstate method](https://github.com/bitcoin/bitcoin/pull/25665/commits/0263614685582fed2290494f5233dbe038fc350c) as an initial application. Followup PRs [#25722](https://github.com/bitcoin/bitcoin/pull/25722) and [#29700](https://github.com/bitcoin/bitcoin/pull/29700) use it more broadly to return errors and warnings from wallet and kernel functions as well.\r\n\r\nThis change adds two major features to the result class:\r\n\r\n- For better error handling, adds the ability to return a value on failure, not just a value on success. This is a key missing feature that makes the result class not useful for functions like `LoadChainstate()` which produce different errors that need to be handled differently [^1].\r\n\r\n[^1]: Ability to return error values was actually present in the original implementation of [#25218](https://github.com/bitcoin/bitcoin/pull/25218), but unfortunately removed in later iterations. See [design notes](https://github.com/bitcoin-core/bitcoin-devwiki/wiki/util::Result-design-notes).\r\n\r\n- For better error reporting, adds the ability to return warning messages and multiple errors, not just a single error string. This provides a way for functions to report errors and warnings in a standard way, and simplifies interfaces:\r\n\r\n    ```diff\r\n    -virtual std::unique_ptr<Wallet> loadWallet(const std::string& name, bilingual_str& error, std::vector<bilingual_str>& warnings) = 0;\r\n    +virtual util::Result<std::unique_ptr<Wallet>> loadWallet(const std::string& name) = 0;\r\n    ```\r\n\r\n    ```diff\r\n    -std::unique_ptr<WalletDatabase> MakeDatabase(const fs::path& path, const DatabaseOptions& options, DatabaseStatus& status, bilingual_str& error);\r\n    +util::Result<std::unique_ptr<WalletDatabase>, DatabaseError> MakeDatabase(const fs::path& path, const DatabaseOptions& options);\r\n   ```\r\n\r\nThis change also makes some more minor improvements:\r\n\r\n- Smaller type size. `util::Result<int>` is 16 bytes, and `util::Result<void>` is 8 bytes. Previously both were 72 bytes.\r\n\r\n- Broader type compatibility. Supports noncopyable and nonmovable success and error types.\r\n\r\n### Comparison with `std::expected`\r\n\r\nCurrently, the `util::Result` class is useful for error reporting—returning translated, user-facing error strings—but not as useful for error handling, where callers need structured failure information to decide how to proceed. By contrast, `std::expected` / `util::Expected` (#34005, #34006) is good for error handling but less helpful for reporting. This PR closes the gap between the two classes.\r\n\r\nWith this PR, `std::expected` remains a good choice for lower-level functions or simple functions that fail in only a few well-defined ways. Meanwhile,\r\n\r\n- `Result` becomes a better choice for operations that can fail in many different ways—loading a wallet, connecting a block, etc.—where callers may want complete error traces, not just low-level errors without context or high-level errors without detail. (Followup [#25722](https://github.com/bitcoin/bitcoin/pull/25722) applies this to wallet-loading functions.) \r\n- `Result` can also be more useful than `expected` when merging status information from multiple calls. (Followup [#29700](https://github.com/bitcoin/bitcoin/pull/29700) uses this to reliably propagate flush and fatal-error status from validation code that can internally trigger flushes or shutdowns.)\r\n- `Result` may also be a better choice than `std::expected` when returning pointer values. (Followup [#26022](https://github.com/bitcoin/bitcoin/pull/26022) adds a `ResultPtr` specialization that avoids double dereferencing.) \r\n- `Result` can be more efficient than `std::expected` when failures are rare but failure objects are large, since failure values are heap-allocated.\r\n\r\nThis PR effectively makes `Result` a superset of `expected`, making the representations compatible and allowing them to be used together.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2022-07-21T12:46:09Z",
      "updated_at": "2026-02-02T04:23:33Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/25665",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 4045,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1047758233,
      "number": 26022,
      "title": "Add util::ResultPtr class",
      "body": "<!-- begin based-on -->\n**This is based on #25665.** The non-base commits are:\n\n- [`5142f017eaa` Add util::ResultPtr class](https://github.com/bitcoin/bitcoin/pull/26022/commits/5142f017eaa3b3f6d0109fc9f836e6243349d541)\n- [`8ef747c80fc` Use ResultPtr<unique_ptr> instead of Result<unique_ptr>](https://github.com/bitcoin/bitcoin/pull/26022/commits/8ef747c80fc3e39ecb2bb5856a489cbfc5737f48)<!-- end -->\n\n---\n\nThe `util::ResultPtr` class is a wrapper for `util::Result` providing syntax sugar to make it less awkward to use with returned pointers. Instead of needing to be deferenced twice with `**result` or `(*result)->member`, it only needs to be dereferenced once with `*result` or `result->member`. Also when it is used in a boolean context, instead of evaluating to true when there is no error and the pointer is null, it evaluates to false so it is straightforward to determine whether the result points to something.\n\nThis PR is only partial a solution to #26004 because while it makes it easier to check for null pointer values, it does not make it impossible to return a null pointer value inside a successful result. It would be possible to enforce that successful results always contain non-null pointers by using a `not_null` type (https://github.com/bitcoin/bitcoin/issues/24423) in combination with `ResultPtr`, though.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2022-09-06T15:57:14Z",
      "updated_at": "2026-02-02T04:17:09Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/26022",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1358,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1566486194,
      "number": 28690,
      "title": "build: Introduce internal kernel library",
      "body": "This PR introduces a new `libbitcoin_kernel` internal library. It completes the internal library design as laid out in [doc/design/libraries.md](https://github.com/bitcoin/bitcoin/blob/master/doc/design/libraries.md). Since the `util` library contains a bunch of modules that are not required by the kernel library, a new `kernel_util` library is introduced as well that only consists of the modules required by the kernel library. The external `libbitcoinkernel` library now re-uses the compiled objects from the internal libraries. \r\n\r\nThere is a trade-off to this. Since we don't manually export symbols from the kernel library yet, this would make the library unusable if `REDUCE_EXPORTS=ON`. For now this means that the patch here introduces a separate source file list for the external library that gets populated by the source files of its static dependents.",
      "state": "open",
      "user": "sedited",
      "created_at": "2023-10-20T11:01:03Z",
      "updated_at": "2026-02-02T03:51:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28690",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 906,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2272618048,
      "number": 31644,
      "title": "leveldb: show non-default options during init",
      "body": "To help with to debugging and traceability (in alignment with displaying other non-default args such as `Command-line arg: dbcache=\"10000\"`) we can extend the LevelDB opening log with an additional debug message for the used non-default settings.\r\n\r\nTo avoid showing booleans as e.g. `create_if_missing=1`, I've added a local `ToString` lambda for `bool`.\r\nI wanted to use `util::Join` at the end, but couldn't find any way that I liked.\r\n\r\nExample output after the change:\r\n```bash\r\n2025-10-15T02:39:45Z Opened LevelDB successfully\r\n2025-10-15T02:39:45Z [leveldb] startup options: options.compression=NoCompression, options.create_if_missing=true, options.max_file_size=33554432, options.paranoid_checks=true, options.write_buffer_size=524288, readoptions.fill_cache=false, readoptions.verify_checksums=true, writeoptions.sync=true\r\n```",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-01-12T17:30:54Z",
      "updated_at": "2026-02-02T02:14:37Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31644",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 883,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2803909911,
      "number": 33324,
      "title": "blocks: add `-reobfuscate-blocks` argument to enable (de)obfuscating existing blocks",
      "body": "### Context\r\n\r\nRecent discussions highlighted that many nodes which synced before Bitcoin Core v28 have their block and undo files stored effectively in the clear (zero XOR key). This patch adds a simple, resumable maintenance tool to obfuscate previously raw block files, rotate an existing key to a fresh random one, or de-obfuscate (set key to zero) if consciously chosen, all without requiring resync. The operation can be cancelled and restarted safely.\r\n\r\n### Implementation\r\n\r\nThe new startup option `-reobfuscate-blocks[=VALUE]` accepts either 16 hex characters as an exact 8-byte XOR key (little-endian in-memory layout) or a boolean to generate a random 64-bit key. e.g. `-reobfuscate-blocks=0000000000000000` sets the key to zero, effectively removing obfuscation.\r\n\r\nIf we detect unobfuscated blocks at start time we suggest this new option in a warning.\r\n\r\nAt startup, we iterate over all undo and block files (grouping the block and undo files for more uniform iteration), read them with the old XOR key and write them back with the new key (`<name>.reobfuscated`). The implementation actually combines the two keys and reads directly into the new obfuscated version to only do a single iteration over the data. This works if the original blocks aren't obfuscated or if the new blocks aren't or if both are.\r\nAfter successful write, we immediately delete the old file. Once all files are staged, we rename them back and atomically swap `xor.dat.reobfuscated` → `xor.dat` and continue operation.\r\n\r\nWe log the old and new keys and print progress roughly per-percent as files complete (i.e. max 100 progress logs).\r\n\r\n### Constraints\r\n\r\n* Re-obfuscation resumes automatically (detected via `xor.dat.reobfuscated`) even without the flag. In worst-case a crash should only force us to redo previous work.\r\n* Single-threaded, processing one file at a time to keep code simple and avoid complexity of interleaving renames and key swaps across threads.\r\n* Fast in practice with sequential read/modify/write per blockfile - after recent obfuscation vectorization, this path is very quick.\r\n\r\n### Reproducer\r\n\r\n```bash\r\ncmake -B build -DBUILD_GUI=ON && cmake --build build -j$(nproc)\r\n# command line\r\n./build/bin/bitcoind -reobfuscate-blocks -stopatheight=1\r\n# same with GUI\r\n./build/bin/bitcoin-qt -reobfuscate-blocks -stopatheight=1\r\n```\r\n\r\n### Single-threaded Performance\r\n\r\n cpu                 | hdd/ssd | block count | size    | files  | time (min) | blocks/min \r\n---------------------|---------|-------------|---------|--------|------------|------------\r\n Apple M4 Max laptop | SSD     | ~909k       | ~707 GB | 9,982  | 8.4        | 146,613    \r\n Intel Core i9       | SSD     | ~909k       | ~725 GB | 10,238 | 23.1       | 39,351     \r\n Raspberry Pi 5      | SSD     | ~914k       | ~728 GB | 10,276 | 72.78      | 12,558     \r\n Intel Core i7       | HDD     | ~909k       | ~720 GB | 10,156 | 208.7      | 4,356      \r\n Raspberry Pi 4B     | HDD     | ~915k       | ~730 GB | 10,304 | 1467       | 624        \r\n\r\n----\r\n\r\nSimilar work:\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/32451\r\n* https://github.com/andrewtoth/blocks-xor\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-09-05T23:51:29Z",
      "updated_at": "2026-02-01T22:07:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33324",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3232,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2876629729,
      "number": 33512,
      "title": "coins: use number of dirty cache entries in flush warnings/logs",
      "body": "Revival of https://github.com/bitcoin/bitcoin/pull/31703 with all outstanding review feedback addressed.\r\n\r\n<details>\r\n<summary>A few changes compared to the original</summary>\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/34207 resolved part of dirty counting in `SanityCheck`\r\n* `EmplaceCoinInternalDANGER` is also fuzz tested now\r\n* Warning and logging moved from `FlushStateToDisk` to `CCoinsViewDB::BatchWrite`, ensuring `AssumeUTXO` snapshot writes also display progress warnings\r\n* Removed the redundant changed counter in `BatchWrite` since we now track `dirty_count` directly\r\n* All instances use `dirty_count` (not `num_dirty`) and parameter alignment is corrected\r\n\r\n</details>\r\n\r\n----\r\n\r\n> Since #28280 and #28233, the percentage of dirty entries in the cache when a flush happens may in practice be far from 100%. The log output, the decision to warn about a large flush (#31534), and the disk-full detection, however always use the entire size of the cache.\r\n>\r\n> Fix this by keeping track of the number of dirty entries in `CCoinsViewCache`, and using that number. We've dropped the usage of `DynamicMemoryUsage` as it's the wrong metric, even before the non-wiping flushes were introduced (if everything is dirty, memory usage is correlated with, but not the same as, the amount of disk space written or used). They could be improved by keeping track of proper write size estimates in a follow-up, but here we're just using a fixed 48 bytes per entry estimate.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-10-01T02:24:51Z",
      "updated_at": "2026-02-01T21:29:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33512",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 2,
        "text_length": 1539,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3037988791,
      "number": 33929,
      "title": "test: Remove `system_tests/run_command` runtime dependencies",
      "body": "`system_tests` currently rely on `cat`, `echo`, `false` and `sh` being available in `PATH` at runtime.\r\n\r\nThis PR:\r\n1. Removes these dependencies.\r\n2. Reduces the number of platform-specific code paths.\r\n\r\nThe change is primarily motivated by my work on maintaining the [`bitcoin-core`](https://packages.guix.gnu.org/packages/bitcoin-core) package in Guix. It enables the removal of the existing `bash` and `coreutils` native inputs, which in turn makes it possible to drop the implicit dependency on `qtbase@5` (see https://codeberg.org/guix/guix/pulls/4386#issuecomment-8613333).\r\n\r\nBased on https://github.com/bitcoin/bitcoin/pull/34349.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-11-23T23:03:10Z",
      "updated_at": "2026-02-01T19:59:32Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33929",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 701,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2532604905,
      "number": 32575,
      "title": "refactor: Remove special treatment for single threaded script checking",
      "body": "This topic has been motivated by my work on batch validation and a related conversation just happened here: https://github.com/bitcoin/bitcoin/pull/32467#discussion_r2098305199 \r\n\r\n`CheckInputScripts` currently only does what its name implies if there is no multithreading usage for validation. If there are worker threads available the function instead only creates the checks and puts them into a vector. Aside from some shared pre-checks the multithreaded code path is much simpler compared to the rest. This dual use makes the function hard to grasp and its naming confusing.\r\n\r\nThis PR refactors this code to be more readable and improves documentation aside from unifying the single threaded and the multithreaded cases by letting checkqueue handle single threaded script checking as well. The code is already suited for this and there seems to be not noticable performance overhead from this.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2025-05-20T20:52:49Z",
      "updated_at": "2026-02-01T19:16:10Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32575",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 970,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3213105614,
      "number": 34416,
      "title": "Add nullptr-check to CChain::Contains(), tests",
      "body": "Add unit tests to the `CChain` class, and add a nullptr-check to `CChain::Contains()` to avoid potential memory access violation by `nullptr` dereference.\r\n\r\nThe `CChain::Contains()` method (in `src/chain.h`) dereferences its input without checking. The `Next()` method also calls into this with a `nullptr` if invoked with `nullptr`. While most call sites have indirect guarantee that the input is not `nullptr`, it's not easy to establish this to all call sites with high confidence. These methods are publicly available. There is no known high-level use case to trigger this error, but the fix is easy, and makes the code safer.\r\n\r\nAlso, unit tests were added to the `CChain` class, filling a gap.\r\n\r\nChanges:\r\n\r\n- Add basic unit tests for `CChain` class methods\r\n- Add a nullptr-check to `CChain::Contains()`\r\n\r\nAlternative. I have considered changing `Contains()` to take a reference instead of pointer, however, when applying that to various methods, it grew to a much bigger changeset -- see #34440. Having in mind the friction of larger PRs, I think the present minimal one-check solution (with the tests) makes sense on its own.\r\n\r\nThis change is remotely related to and indirectly triggered by #32875 .\r\n",
      "state": "open",
      "user": "optout21",
      "created_at": "2026-01-27T05:25:08Z",
      "updated_at": "2026-02-01T15:33:41Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34416",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1261,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2241610331,
      "number": 31521,
      "title": "fuzz: Fix misplaced SeedRand::ZEROS",
      "body": "After commit fae63bf13033adec80c7e6d73144a21ea3cfbc6d this must be placed even before test_setup. This is nice, because it makes the usage consistently appear in the first line.\r\n\r\nThe change is moving a `SeedRandomForTest(SeedRand::ZEROS)` to happen earlier. This is fine, because it will either have no effect, or make the code more deterministic, because after commit fae63bf, no other re-seeding other than `ZEROS` can happen in fuzz tests.\r\n",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2024-12-18T08:14:17Z",
      "updated_at": "2026-02-01T11:05:22Z",
      "merged_at": "2024-12-19T15:23:35Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31521",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 482,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 304070624,
      "number": 16545,
      "title": "refactor: Implement missing error checking for ArgsManager flags",
      "body": "Trigger startup errors if bitcoin is configured with bad setting values according to flags. Also raise internal errors if settings are registered and retrieved with inconsistent flags.\n\nThis change has no effect on behavior because the new ArgsManager flags added here are not used outside of tests yet.\n\nIt'll probably be easier to start applying type checking flags to _new_ options than _existing_ options. But for examples of how type checking flags can make sense applied to existing options, see the new [example_options unit test](https://github.com/ryanofsky/bitcoin/blob/pr/argcheck/src/test/argsman_tests.cpp#L27) added in this PR.\n\n---\n\nFollowups:\n\n- Support for flag combinations is possible and is added in commit c919f51c044f0e80ecd301f9c9d396ddff2331ba ([branch](https://github.com/ryanofsky/bitcoin/commits/pr/argcomb))\n- ALLOW_LIST flags are added and enforced in [#17580](https://github.com/bitcoin/bitcoin/pull/17580)\n- Bad IsArgSet usages with ALLOW_LIST are removed in [#30529](https://github.com/bitcoin/bitcoin/pull/30529) and prevented in [#17783](https://github.com/bitcoin/bitcoin/pull/17783)\n- Confusing and ignored multiple assignments in config files are disallowed in [#17493](https://github.com/bitcoin/bitcoin/pull/17493)\n- Confusing reverse-precedence settings merging code is removed in [#17581](https://github.com/bitcoin/bitcoin/pull/17581)\n- Type flags added in this PR implement runtime part of a change to add more compile-time checking in [#22978](https://github.com/bitcoin/bitcoin/pull/22978)\n",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2019-08-04T14:13:12Z",
      "updated_at": "2026-02-01T04:03:39Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/16545",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1600,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 877751403,
      "number": 24539,
      "title": "Add a \"tx output spender\" index",
      "body": "This PR adds a new \"tx output spender\" index, which allows users to query which tx spent a given outpoint with the `gettxspendingprevout` RPC call that was added by https://github.com/bitcoin/bitcoin/pull/24408.\r\n\r\nSuch an index would be extremely useful for Lightning, and probably for most layer-2 protocols that rely on chains of unpublished transactions.\r\n\r\nUPDATE: this PR is ready for review and issues have been addressed:\r\n- using a watch-only wallet instead would not work if there is a significant number of outpoints to watch (see https://github.com/bitcoin/bitcoin/pull/24539#issuecomment-1276595646)\r\n- this PR does not require `-txindex` anymore\r\n\r\nWe use a composite key with 2 parts (suggested by @romanz): hash(spent outpoint) and tx position, with an empty value. Average composite key size is 15 bytes.\r\n\r\nThe spending tx can optionally be returned by `gettxspendingprevout` (even it `-txindex is not set`).",
      "state": "open",
      "user": "sstone",
      "created_at": "2022-03-11T19:32:41Z",
      "updated_at": "2026-02-01T03:09:24Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/24539",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 958,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1185011431,
      "number": 26812,
      "title": "test: add end-to-end tests for CConnman and PeerManager",
      "body": "Add unit tests that write data to a mocked socket and inspect what CConnman/PeerManager have written back to the socket, or check the internal state to verify that the behavior is as expected.\r\n\r\nThis is now possible, after most of https://github.com/bitcoin/bitcoin/pull/21878 has been merged - we don't do any syscalls (e.g. `connect()`, `recv()`) from the high level code and using a mocked socket allows testing the entire networking stack without opening actual network connections.",
      "state": "open",
      "user": "vasild",
      "created_at": "2023-01-04T14:39:37Z",
      "updated_at": "2026-02-01T01:49:15Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/26812",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 543,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2661268700,
      "number": 32953,
      "title": "[POC] ci: Skip compilation when running static code analysis",
      "body": "This PR is a proof of concept for using a compilation database with static analysis tools such as clang-tidy or IWYU. The idea was suggested in https://github.com/bitcoin/bitcoin/pull/32662#issuecomment-2935293250:\r\n> Shouldn't this be excluded in the tidy CI task as well?\r\n\r\nAdditionally, this PR makes use of the `codegen` target, following the suggestion in https://github.com/bitcoin/bitcoin/pull/32662#issuecomment-2991861497:\r\n> It does seem nice to be able to run clang-tidy on generated files... Maybe more ideally there could be ...  target like `make --build build -t codegen` that only runs code generation steps and doesn't compile the sources.\r\n\r\nA few tasks remain to be addressed. Here's the current TODO list:\r\n- [ ] Implement the `codegen` target for CMake versions older than 3.31.\r\n- [ ] Handle files generated by the `mpgen` tool.\r\n- [ ] Handle files generated by Qt tools.\r\n- [ ] Enable `RUN_CHECK_DEPS=true` elsewhere.\r\n\r\nWhile https://github.com/bitcoin/bitcoin/issues/31965 is still under discussion, it may make sense to move this CI job to GHA to provide quicker feedback.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-07-12T12:51:19Z",
      "updated_at": "2026-02-01T01:44:31Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32953",
      "labels": [
        "Tests",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1160,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1220771563,
      "number": 26988,
      "title": "cli: rework -addrinfo cli to use addresses which aren’t filtered for quality/recency",
      "body": "Rework of `-addrinfo` CLI is done using `getaddrmaninfo` RPC proposed in https://github.com/bitcoin/bitcoin/pull/27511. This would be useful for users who want to know the total number of addresses the node knows about and can make connections to. \r\n\r\nCurrently, `-addrinfo` returns total number of addresses the node knows about after filtering them for quality + recency using [`isTerrible`](https://github.com/bitcoin/bitcoin/blob/4b51290f719559b8506425177f7758abe66fe2c3/src/addrman.cpp#L808). However `isTerrible`addresses [don't matter](https://github.com/bitcoin/bitcoin/pull/26988#discussion_r1147725684) when selecting outbound peers to connect to. Total number of addresses the node knows about could be higher than what `-addrinfo` currently displays. See https://github.com/bitcoin/bitcoin/pull/24370.",
      "state": "open",
      "user": "stratospher",
      "created_at": "2023-01-29T21:25:28Z",
      "updated_at": "2026-02-01T01:36:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/26988",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 898,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1389230610,
      "number": 27865,
      "title": "wallet: Track no-longer-spendable TXOs separately",
      "body": "In #27286, the wallet keeps track of all of its transaction outputs, even if they are already spent or are otherwise unspendable. This TXO set is iterated for balance checking and coin selection preparation, which can still be slow for wallets that have had a lot of activity. This PR aims to improve the performance of such wallets by moving UTXOs that are definitely no longer spendable to a different map in the wallet so that far fewer TXOs need to be iterated for the aforementioned functions.\r\n\r\nUnspendable TXOs (not to be confused with Unspent TXOs) are those which have a spending transaction that has been confirmed, or are no longer valid due to reorgs. TXOs that are spent in unconfirmed transactions remain in the primary TXO set, and are filtered out of balance and coin selection as before.\r\n\r\nDepends on #27286",
      "state": "open",
      "user": "achow101",
      "created_at": "2023-06-12T18:40:10Z",
      "updated_at": "2026-02-01T01:04:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/27865",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 876,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1588144092,
      "number": 28802,
      "title": "ArgsManager: support subcommand-specific options",
      "body": "Adds the ability to link particular options to one or more subcommands, and uses this feature in `bitcoin-wallet`. Separates out the help information for subcommand-specific options (duplicating it if an option applies to multiple subcommands), and provides a function for checking if some options have been specified that only apply to different subcommands.",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2023-11-06T09:00:47Z",
      "updated_at": "2026-02-01T00:09:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/28802",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 408,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1780312050,
      "number": 29678,
      "title": "Bugfix: Correct first-run free space checks",
      "body": "It's not clear what `m_assumed_*_size` are actually set based on, but historically it was in GB, not GiB, and that's still used in the GUI which is more user-facing.\r\n\r\nCould just as easily change the GUI if GiB is preferred.",
      "state": "open",
      "user": "luke-jr",
      "created_at": "2024-03-19T16:36:10Z",
      "updated_at": "2026-01-31T22:17:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29678",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 269,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2086428775,
      "number": 30951,
      "title": "net: option to disallow v1 connection on ipv4 and ipv6 peers",
      "body": "resolves #29618.\r\n\r\nThis PR adds a config flag option `-v2onlyclearnet` which disallows outbound v1 connections on ipv4 and ipv6 networks since they're unencrypted. outbound v1 connections are still possible from tor/i2p/cjdns peers since they're encrypted networks.\r\n\r\n- v1 outbound connections to peers are not attempted\r\n- v1 reconnections are not attempted (if peer is falsely advertised as v2 peer and we attempt a v2 connection but it fails, we do not attempt a v1 reconnection when `-v2onlyclearnet` is switched on)\r\n\r\nCurrently 70% of reachable nodes in network supporting v2 (according to https://21.ninja/reachable-nodes/node-service-share/ and https://bitnodes.io/nodes). Also found 81% of addresses supporting v2 in the addrman of nodes I checked - personal node and the nodes in [peer.observer](https://peer.observer/addrman/alice). (You can use [this branch ](https://github.com/stratospher/bitcoin/commits/addrinfo_service_display/)to check the % of v2 addresses in a node's addrman.)",
      "state": "open",
      "user": "stratospher",
      "created_at": "2024-09-23T12:23:48Z",
      "updated_at": "2026-01-31T20:26:42Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30951",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1060,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2217053399,
      "number": 31425,
      "title": "RFC: Riscv bare metal CI job",
      "body": "This adds a CI job for building the static consensus library and linking it to an executable. It uses newlib-cygwin as a C library for the final linking step. This ensure compatibility with this target going forward and can serve as a starting point for enabling bare metal builds for the entire kernel library. This would have also caught the error fixed in #31365.",
      "state": "open",
      "user": "sedited",
      "created_at": "2024-12-05T08:30:01Z",
      "updated_at": "2026-01-31T18:48:06Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31425",
      "labels": [
        "Build system",
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 395,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2294479432,
      "number": 31723,
      "title": "qa: Facilitate debugging bitcoind inside functional tests",
      "body": "Facilitates debugging specific instances of bitcoind *in the context of Python tests, inside of an editor/IDE/debugger*.\r\n\r\nMakes bitcoind spin during startup, waiting for a debugger to be attached, so that breakpoints during process init can be debugged.\r\n\r\n### Example usage\r\n\r\n1. Generate build files with `-DENABLE_WAIT_FOR_DEBUGGER=ON` & build.\r\n   \r\n   ```\r\n   cmake -B build -DCMAKE_BUILD_TYPE=Debug -DENABLE_WAIT_FOR_DEBUGGER=ON && cmake --build build -j$(nproc)\r\n   ```\r\n\r\n2. Set breakpoints in the C++ code in your editor/IDE/debugger.\r\n\r\n3. Start a Python functional test with a debugger command such as:\r\n   - LLDB inside an already started Tmux pane (append ` -o continue` to the LLDB args to have the debugger continue automatically):\r\n     ```\r\n     ./build/test/functional/feature_loadblock.py --debug_runs 2 --debug_cmd \"tmux split-window -h lldb -p \\$PID\\$\"\r\n     ```\r\n   - Sublime Text Debugger, allows a running session to attach:\r\n     ```\r\n     ./build/test/functional/feature_loadblock.py --debug_runs 2 --debug_cmd \"subl --command \\\"debugger {\\\\\\\"action\\\\\\\": \\\\\\\"start\\\\\\\", \\\\\\\"configuration\\\\\\\": {\\\\\\\"name\\\\\\\": \\\\\\\"foo\\\\\\\", \\\\\\\"type\\\\\\\": \\\\\\\"lldb\\\\\\\", \\\\\\\"request\\\\\\\": \\\\\\\"attach\\\\\\\", \\\\\\\"program\\\\\\\": \\\\\\\"dummyprogram\\\\\\\", \\\\\\\"pid\\\\\\\": \\\\\\\"\\$PID\\$\\\\\\\"}}\\\"\"\r\n     ```\r\n   - Don't specify `--debug_cmd ...\\$PID\\$...`, instead have the test framework log which bitcoind PID you should manually attach to:\r\n     ```\r\n     ./build/test/functional/feature_loadblock.py --debug_runs 2\r\n     ```\r\n\r\n5. Experience how debugger hits breakpoints as the functional test executes RPCs.\r\n\r\nUsing `-debug_runs <RUN_INDEX>` often requires doing a dry-run of a functional test with `-ldebug` and examining the log to see which run index is the one we want to debug:\r\n```\r\n2025-...Z TestFramework.node0 (DEBUG): bitcoind started (run #1, node #0), waiting for RPC to come up\r\n``` \r\n\r\n### Alternative usage\r\n\r\nTweak functional test code to specify `wait_for_debugger` when (re)starting a node:\r\n\r\n```diff\r\n-        self.restart_node(0)\r\n+        self.restart_node(0, wait_for_debugger=True)\r\n```\r\nWhile it can be messy to modify files while moving between commits, and cumbersome inside of loops, it might be more straightforward than `-debug_runs <RUN_INDEX>` in a given case.\r\n\r\n### *Needed before merge*\r\n\r\n- [ ] Testing on Mac to confirm -waitfordebugger on the C++ side behaves as expected.",
      "state": "open",
      "user": "hodlinator",
      "created_at": "2025-01-23T13:18:06Z",
      "updated_at": "2026-01-31T17:00:03Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31723",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2460,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2368554207,
      "number": 31974,
      "title": "Drop testnet3",
      "body": "Testnet3 was deprecated in v28 with the introduction of testnet4. It will be dropped in v30 _or later_, please discuss in #31975.\r\n\r\nThere is no more `[test]` network section. The user is expected to set testnet4 explicitly, which should make future rotation of testnets easier.\r\n\r\nIf a `[test]` or `[testnet3]` section is present in `bitcoin.conf` a warning is issued:\r\n\r\n```\r\nWarning: .../bitcoin.conf:18 Section [test] is not recognized.\r\n```\r\n\r\nStarting with `-testnet3` will be greeted with an error message:\r\n\r\n```\r\nError: Testnet3 was dropped in version 30.0. Consider using '-testnet4' instead.\r\n```\r\n\r\nThis also prevents a fallback to mainnet.\r\n\r\nStarting with `-test` was already not possible with testnet3.\r\n\r\nReview hints:\r\n- make a (Windows) Guix build and test the (un)installer\r\n\r\nGuix hashes:\r\n\r\n```\r\n(todo)\r\n```",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-03-03T16:22:11Z",
      "updated_at": "2026-01-31T15:40:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31974",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 842,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3199348260,
      "number": 34381,
      "title": "script: return proper error for `CScriptNum` errors",
      "body": "When evaluating a script, the current code is bad for analyzing some errors because it returns `SCRIPT_ERR_UNKNOWN_ERROR` for errors that are clearly known. \r\n\r\n`CScriptNum` has two well defined errors: number overflow and non-minimally encoded number. However, for both errors we return as unknown. This PR changes it by adding a new ScriptError that is used for any `CScriptNum` error.",
      "state": "closed",
      "user": "brunoerg",
      "created_at": "2026-01-22T13:16:34Z",
      "updated_at": "2026-01-31T15:18:10Z",
      "merged_at": "2026-01-31T00:23:01Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34381",
      "labels": [
        "Consensus"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 439,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3225525286,
      "number": 34455,
      "title": "ci, iwyu: Fix warnings in `src/univalue` and treat them as errors",
      "body": "This PR continues the ongoing effort to enforce IWYU warnings.\r\n\r\nSee [Developer Notes](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#using-iwyu).",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-01-29T23:30:08Z",
      "updated_at": "2026-01-31T14:06:43Z",
      "merged_at": "2026-01-31T14:05:51Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34455",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 236,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2466171613,
      "number": 32297,
      "title": "bitcoin-cli: Add -ipcconnect option",
      "body": "This implements an idea from sipa in https://github.com/bitcoin/bitcoin/issues/28722#issuecomment-2807026958 to allow `bitcoin-cli` to connect to the node via IPC instead of TCP, if the ENABLE_IPC cmake option is enabled and the node has been started with `-ipcbind`.\r\n\r\nThis feature can be tested with:\r\n\r\n```\r\nbuild/bin/bitcoin-node -regtest -ipcbind=unix -debug=ipc\r\nbuild/bin/bitcoin-cli -regtest -ipcconnect=unix -getinfo\r\n```\r\n\r\nThe -ipconnect parameter can also be omitted, since this change also makes `bitcoin-cli` prefer IPC over HTTP by default, and falling back to HTTP if an IPC connection can't be established.\r\n\r\n---\r\n\r\nThis PR is part of the [process separation project](https://github.com/bitcoin/bitcoin/issues/28722).",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2025-04-17T13:55:32Z",
      "updated_at": "2026-01-31T13:32:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32297",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 772,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3196609350,
      "number": 34374,
      "title": "kernel: use structured logging and simplify logging interface",
      "body": "tl;dr: kernel logging is cumbersome. This PR enables structured logging and a much simplified kernel logging interface. Closes #34062.\r\n\r\n## Motivation\r\n\r\nThe `bitcoinkernel` library (#27587) [exposes](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L698-L778) functionality to interface with the kernel logging. This includes registering callbacks for log statements, level/category filtering, string formatting options, and more.\r\n\r\nKernel logging has a few problems:\r\n- [callbacks](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L304) operate on formatted strings, so users need to parse the string to get the timestamp, category, level, ... based on which options are set. This is cumbersome, brittle, and inefficient.\r\n- the [filtering interface](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L737) is not really intuitive, requiring users to call combinations of `btck_logging_set_level_category` and `btck_logging_enable_category` when they want to produce `debug` or `trace` logs. The level/category system makes sense for node, because it directly controls what gets written to disk and stdout, and there are quite a lot more categories producing logs. Kernel doesn't really need this - users control what happens to the logs, and can do any filtering/manipulation in the callback they provide.\r\n- the node logging infrastructure has quite a bit more functionality than is necessary for a library, including ratelimiting, log formatting, outputting, buffering, ... This introduces unnecessary code and interface complexity.\r\n\r\n## Approach\r\n\r\nMost of the logic in `logging.h` is not necessary for `bitcoinkernel`, so we first separate it into `util/log.h` and `logging.h` (`common`), then upgrade the `bitcoinkernel` logging interface, and finally remove the `logging.cpp` dependency from kernel entirely.\r\n\r\n1. **Separate log generation**: Add a minimal `util::log::Dispatcher` that is used to generate logs, and forwards structured log entries to registered callbacks. No formatting, rate-limiting, or output handling - that's the consumer's responsibility. Dispatcher can be configured with a `filter` predicate (e.g. `WillLogCategoryLevel()` for `node`, or a simpler levels-based filter for `bitcoinkernel`) to avoid unnecessary string formatting and other overhead.\r\n2. **Register `BCLog::Logger` on Dispatcher**: Register a callback on the global Dispatcher to receive entries and handle node-specific concerns (formatting, rate-limiting, file output) without changing most of its logic.\r\n3. **Move logging macros to `util/log.h`**: Allows the entire codebase (including kernel code) to use the same macros without depending on `logging.h`.\r\n4. **Update bitcoinkernel C API**: Replace the string-based callback with `btck_LogEntry` containing full metadata. Remove `btck_LoggingOptions` and category enable/disable functions. Add `btck_logging_set_min_level()` for early filtering.\r\n5. Move **`logging.cpp` to `common`**: remove it as a kernel dependency entirely.\r\n\r\n## Appendix\r\n\r\n### `bitcoinkernel` C logging interface\r\n\r\n```c\r\nstruct btck_LogEntry {\r\n    const char* message;       //!< Log message\r\n    size_t message_len;        //!< Log message length\r\n    const char* file_name;     //!< Source file name\r\n    size_t file_name_len;      //!< Source file name length\r\n    const char* function_name; //!< Source function name\r\n    size_t function_name_len;  //!< Source function name length\r\n    const char* thread_name;   //!< Thread name\r\n    size_t thread_name_len;    //!< Thread name length\r\n    int64_t timestamp_ns;      //!< Timestamp in nanoseconds since epoch\r\n    uint32_t line;             //!< Source line number\r\n    btck_LogLevel level;       //!< Log level\r\n    btck_LogCategory category; //!< Log category\r\n};\r\n\r\ntypedef void (*btck_LogCallback)(void* user_data, const btck_LogEntry* entry);\r\n\r\nBITCOINKERNEL_API void btck_logging_set_min_level(btck_LogLevel level);\r\n\r\nBITCOINKERNEL_API btck_LoggingConnection* BITCOINKERNEL_WARN_UNUSED_RESULT btck_logging_connection_create(\r\n    btck_LogCallback log_callback,\r\n    void* user_data,\r\n    btck_DestroyCallback user_data_destroy_callback) BITCOINKERNEL_ARG_NONNULL(1);\r\n\r\nBITCOINKERNEL_API void btck_logging_connection_destroy(btck_LoggingConnection* logging_connection);\r\n```\r\n\r\n",
      "state": "open",
      "user": "stickies-v",
      "created_at": "2026-01-21T19:56:44Z",
      "updated_at": "2026-01-31T12:26:14Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34374",
      "labels": [
        "Validation",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 4513,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3095820892,
      "number": 34054,
      "title": "net processing: Add ibd check before processing block for txdownloadman",
      "body": "Calculating the rolling bloom filters for the txorphanage takes some CPU time from the scheduler thread. This can be observed for example in [this flamegraph](https://bitcoin-dev-tools.github.io/benchcoin/results/pr-172/20066462508/mainnet-default-instrumented-base-flamegraph.svg?x=920203898521&y=780), where handling the filter takes about 2.6% of total time (and most of the scheduler thread's time). \r\n\r\nDuring ibd the entries in the tx download bloom filter are just continuously rolled over and aren't consumed, since no mempool entries are created by incoming transactions from peers during ibd. The mempool does accept transactions via RPC, or the wallet at the time, however these don't interact with the orphanage and the txdownloadman, because adding anything to those is guarded by IsInitialBlockDownload() checks as well.\r\n\r\nWe're usually latching ibd to false a few blocks before catching up to the tip, so this should also not significantly degrade the performance of the filter once fully caught up.",
      "state": "open",
      "user": "sedited",
      "created_at": "2025-12-12T09:06:28Z",
      "updated_at": "2026-01-31T12:17:19Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34054",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1087,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2913595315,
      "number": 33622,
      "title": "docs: add doc comment for SRD selection algorithm",
      "body": "The params documentation is missing `change_fee` and the description is lacking recent changes.",
      "state": "closed",
      "user": "yancyribbens",
      "created_at": "2025-10-14T13:05:59Z",
      "updated_at": "2026-01-31T12:09:33Z",
      "merged_at": "2026-01-28T13:38:32Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33622",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 145,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2517768893,
      "number": 32489,
      "title": "wallet: Add `exportwatchonlywallet` RPC to export a watchonly version of a wallet",
      "body": "Currently, if a user wants to use an airgapped setup, they need to manually create the watchonly wallet that will live on the online node by importing the public descriptors. This PR introduces `exportwatchonlywallet` which will create a wallet file with the public descriptors to avoid exposing the specific internals to the user. Additionally, this RPC will copy any existing labels, transactions, and wallet flags. This ensures that the exported watchonly wallet is almost entirely a copy of the original wallet but without private keys.",
      "state": "open",
      "user": "achow101",
      "created_at": "2025-05-13T22:22:00Z",
      "updated_at": "2026-01-31T11:38:58Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32489",
      "labels": [
        "Wallet",
        "Review club"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 622,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2527184806,
      "number": 32554,
      "title": "bench: replace embedded raw block with configurable block generator",
      "body": "### Problem\r\n\r\nThe [hardcoded benchmark block 413567](https://mempool.space/block/413567) has several issues:\r\n- embeds 1.1MB of binary data in the repository\r\n- mined in 2016, predates SegWit v0, Taproot, and modern script types\r\n- benchmarks cannot test different transaction patterns or script mixes\r\n- updating to a newer block (e.g., [#32457](https://github.com/bitcoin/bitcoin/pull/32457)) would still add binary bloat and would remain inflexible\r\n\r\n### Fix\r\n\r\nAdded configurable `bench/block_generator.{h,cpp}` that builds fully valid blocks at runtime providing blocks or raw serialized stream.\r\n\r\nNote that `HexStrBench` was simplified to work with random data - it doesn't need to be block-related.\r\n\r\n---\r\n\r\nThis supersedes #32457 by eliminating the need for any hardcoded block data while enabling flexible benchmark scenarios.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-05-18T21:39:14Z",
      "updated_at": "2026-01-31T11:25:24Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32554",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 907,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2302258527,
      "number": 31746,
      "title": "test: Added coverage to the waitfornewblock rpc",
      "body": "Added a test for the Negative timeout error if the rpc is given a negative value for its timeout arg\r\n\r\nThis adds coverage to the `waitfornewblock` rpc\r\n\r\nyou can check to see there is no coverage for this error by doing \r\n`grep -nri \"Negative timeout\" ./test/`\r\n\r\nand nothing shows up, you can also see by manually checking where we call `waitfornewblock` in the functional tests",
      "state": "closed",
      "user": "kevkevinpal",
      "created_at": "2025-01-28T13:17:46Z",
      "updated_at": "2026-01-31T11:04:49Z",
      "merged_at": "2025-01-31T19:45:58Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31746",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 428,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2259357216,
      "number": 31600,
      "title": "rpc: have getblocktemplate mintime account for timewarp",
      "body": "#30681 fixed the `curtime` field of `getblocktemplate` to take the timewarp rule into account. However I forgot to do the same for the `mintime` field, which was hardcoded to use `pindexPrev->GetMedianTimePast()+1`.\r\n\r\nThis PR adds a helper `GetMinimumTime()` and uses it for the `mintime` field.\r\n\r\n#31376 changed the `curtime` field to always account for the timewarp rule. This PR maintains that behavior.\r\n\r\nNote that `mintime` now always applies BIP94, including on mainnet. This makes future softfork activation safer.\r\n\r\nIt could be backported to v28.",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2025-01-03T14:41:39Z",
      "updated_at": "2026-01-31T11:04:49Z",
      "merged_at": "2025-01-31T19:39:46Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31600",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 2,
        "positive_keywords": 1,
        "text_length": 614,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3228226291,
      "number": 34462,
      "title": "util: Drop *BSD headers in `batchpriority.cpp`",
      "body": "Currently, there are issues with headers in `batchpriority.cpp`:\r\n1. `SCHED_BATCH` is not defined on all supported *BSD platforms.\r\n2. `pthread.h` is necessary on other platforms.\r\n\r\nThis PR addresses both issues and fixes other includes.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-01-30T15:12:59Z",
      "updated_at": "2026-01-31T10:39:37Z",
      "merged_at": "2026-01-31T10:32:40Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34462",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 285,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2691828975,
      "number": 33051,
      "title": "Don't fix Python patch version",
      "body": "`.python-version` always matches the minimum supported Python version.\r\nIt's main purpose is to catch accidental use of too modern syntax\r\nin scripts and functional tests.\r\n\r\nWe (currently) don't specify a minimum patch version, so it's not\r\nnecessary to do so here. The minor verion is enough.\r\n\r\nThis also avoids requiring users to keep a potentially unsafe old\r\npatch version installed.\r\n\r\nThe linter CI job used `python_build` (part of PyEnv) which requires specifying an exact Python version. The first commit changes it to use the higher level `pyenv install` which will pick the most recent patch version it knows about.\r\n\r\nThe original stated reason for using the lower level `python_build` https://github.com/bitcoin/bitcoin/pull/26716#issuecomment-1356314359 was that it allowed specifying `CC=clang` which needs fewer resources, but `pyenv install` can do that as well.  \r\n\r\nSee also https://github.com/bitcoin-core/HWI/pull/695",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-07-24T12:18:31Z",
      "updated_at": "2026-01-31T09:29:46Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33051",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 970,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3227561624,
      "number": 34460,
      "title": "iwyu: Update mappings",
      "body": "This PR:\r\n1. Removes mappings that have been [backported](https://github.com/include-what-you-use/include-what-you-use/pull/1706) upstream.\r\n2. Adds a new temporary mapping to work around upstream [issue](https://github.com/include-what-you-use/include-what-you-use/issues/1616).\r\n3. Document the existing mappings for libc symbols.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-01-30T11:57:12Z",
      "updated_at": "2026-01-31T09:14:02Z",
      "merged_at": "2026-01-31T08:57:47Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34460",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 354,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3187604599,
      "number": 34338,
      "title": "ci, iwyu: Fix warnings in `src/zmq` and treat them as errors",
      "body": "This PR [continues](https://github.com/bitcoin/bitcoin/pull/33725#issuecomment-3466897433) the ongoing effort to enforce IWYU warnings.\r\n\r\nSee [Developer Notes](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#using-iwyu).\r\n\r\nAdditionally, this adds a new include category to `src/.clang-format`.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-01-19T12:24:27Z",
      "updated_at": "2026-01-31T08:45:38Z",
      "merged_at": "2026-01-31T08:37:09Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34338",
      "labels": [
        "Refactoring",
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 378,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2677577590,
      "number": 33008,
      "title": "wallet: support bip388 policy with external signer",
      "body": "External signers such as Ledger, BitBox02 and Jade, when used with multisig, use [BIP388](https://github.com/bitcoin/bips/blob/master/bip-0388.mediawiki) to display (and constrain) descriptor policies to their users.\r\n\r\nAt least in the case of Ledger (no others so far, see https://github.com/bitcoin/bitcoin/pull/33008#issuecomment-3165080503) this requires us to hold on to an hmac, which proves to the device that the user previously reviewed and approved it.\r\n\r\nThis PR adds a new RPC call `registerpolicy` which converts our descriptor(s) into a BIP388 policy (_partially implemented_), calls a new HWI method `register` (_implemented_) and stores the resulting HMAC (_implemented_).\r\n\r\nWhen signing a transaction using HWI's `signtx` it passes the HMAC along with the PSBT (_TODO_).\r\n\r\nFor convenience the HMAC can be retrieved via `getwalletinfo` (_implemented_). This is useful for scenario's where we can't (yet) complete a transaction via HWI calls.\r\n\r\nNote that the HMAC itself is not specified in BIP388 and may be different for different hardware vendors. So we'll store and echo any hex string the device gives us.\r\n\r\nAn alternative approach to directly supporting BIP388 policies would be to pass the involved descriptors to HWI and have it figure out how to derive a policy.\r\n\r\nTesting:\r\n- make a multisig wallet with a Ledger or other [supported device](https://github.com/bitcoin/bips/blob/master/bip-0388.mediawiki#reference-implementation)\r\n  - try https://github.com/Sjors/bitcoin/pull/91 if you're feeling adventurous, it includes this PR\r\n- install https://github.com/bitcoin-core/HWI/pull/791 HWI branch\r\n- call `bitcoin rpc registerpolicy`\r\n- call `bitcoin rpc getwalletinfo` to see the hmac\r\n\r\nTODO:\r\n- [ ] derive policy using `Descriptor` class instead regex madness, implement all constraints\r\n- [ ] pass hmac along when signing\r\n\r\nDepends on:\r\n- [ ] HWI `register` command: https://github.com/bitcoin-core/HWI/pull/791\r\n- [ ] HWI optional `--hmac` argument for `signtx` (if set, bypass the current auto-registration workaround)\r\n\r\nPotential followups:\r\n- pass hmac along when displaying an address. This provides some extra assurance to the user. See https://github.com/bitcoin-core/HWI/pull/647\r\n",
      "state": "open",
      "user": "Sjors",
      "created_at": "2025-07-18T15:31:45Z",
      "updated_at": "2026-01-31T05:59:07Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33008",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2277,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2679273445,
      "number": 33018,
      "title": "coins: remove SetFresh method from CCoinsCacheEntry",
      "body": "There is plenty of test code that exercises the code path for FRESH-but-not-DIRTY coins in CCoinsViewCache. However, we can see there is only one place in production code where we call `SetFresh` that is not preceded by `SetDirty`. This is in `CCoinsViewCache::FetchCoin` and we can see that this is called if the coin retrieved from `base->GetCoin` is spent. The `base` in this case can be another `CCoinsViewCache` or a `CCoinsViewDB`. In `CCoinsViewCache::GetCoin` we can see that we do not return spent coins, and in `CCoinsViewDB` we don't ever store spent coins so there are none to return.\r\n\r\nThus, we can safely remove this dead code, and now we can see that there are never any calls to `SetFresh` not preceded by `SetDirty`. This PR removes this dead code and replaces `SetFresh` by passing a `fresh` boolean flag to `SetDirty`. This simplifies the logic of `CCoinsViewCache` and lets us remove test cases checking for FRESH-but-not-DIRTY coins. It removes the possibility of FRESH-but-not-DIRTY coins being called from any code path, so we can eliminate this state entirely and reduce the cognitive load of having to consider it.\r\n\r\nThis is pulled out from https://github.com/bitcoin/bitcoin/pull/30673 to make the change simpler.",
      "state": "open",
      "user": "andrewtoth",
      "created_at": "2025-07-19T19:21:35Z",
      "updated_at": "2026-01-31T05:38:50Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33018",
      "labels": [
        "UTXO Db and Indexes"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1293,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2743753242,
      "number": 33186,
      "title": "wallet, test: Ancient Wallet Migration from v0.14.3 (no-HD and Single Chain)",
      "body": "This PR adds test coverage for migrating legacy Bitcoin Core wallets from v0.14.3 (released in 2017) to the descriptor wallet format. The test validates that users can safely upgrade their wallets while preserving all funds, transaction history, and addresses.\r\n\r\nThis test was originally developed on top of #32977, as it was requested in reviews.\r\nHowever, since it also increases test coverage, it can be merged independently.\r\n\r\nThe test covers two wallet migration scenarios:\r\n\r\n* Non-HD Wallet Migration - Tests migration of non-HD wallets (created with `-usehd=0`)\r\n* Single Chain HD Wallet Migration - Tests migration of HD wallets from v0.14.3 (`VERSION_HD_BASE`)\r\n\r\nThe node v0.14.3 cannot be synced because it doesn't have the `syncwithvalidationinterfacequeue` RPC implemented (required by `test_framework.py`), so the solution is to copy the `block` folder to the modern node and start it with `-reindex-chainstate`. Because of this additional complexity, this testing is best managed in a separate file rather than in the existing migration test files.\r\n\r\n",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2025-08-13T18:50:30Z",
      "updated_at": "2026-01-31T03:25:40Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33186",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1147,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2756065507,
      "number": 33215,
      "title": "Fix compatibility with `-debuglogfile` command-line option",
      "body": "This PR avoids hardcoding the \"debug.log\" filename, ensuring compatibility with custom filenames provided via the `-debuglogfile` command-line option.",
      "state": "open",
      "user": "hebasto",
      "created_at": "2025-08-19T10:59:57Z",
      "updated_at": "2026-01-31T02:51:03Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33215",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 209,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2776641246,
      "number": 33259,
      "title": "rpc, logging: add backgroundvalidation to getblockchaininfo",
      "body": "`getblockchaininfo` returns `verificationprogress=1` and `initialblockdownload=false` even if there's background validation.\r\nThis PR adds information about background validation to rpc `getblockchaininfo` in a similar way to `validationprogress` does.\r\n\r\nIf assume utxo was used the output of a \"sync\" node performing background validation:\r\n```\r\n$ ./build/bin/bitcoin-cli getblockchaininfo\r\n...\r\n  \"mediantime\": 1756933740,\r\n  \"verificationprogress\": 1,\r\n  \"initialblockdownload\": false,\r\n  \"backgroundvalidation\": true,\r\n  \"background\": {\r\n    \"snapshotheight\": 880000,\r\n    \"blocks\": 527589,\r\n    \"bestblockhash\": \"0000000000000000002326308420fa5ccd28a9155217f4d1896ab443d84148fa\",\r\n    \"mediantime\": 1529076654,\r\n    \"chainwork\": \"0000000000000000000000000000000000000000020c92fab9e5e1d8ed2d8dbc\",\r\n    \"verificationprogress\": 0.2815790617966284\r\n  },\r\n  \"chainwork\": \"0000000000000000000000000000000000000000df97866c410b0302954919d2\",\r\n  \"size_on_disk\": 61198817285,\r\n\r\n...\r\n```\r\n\r\nIf assume utxo was not used the progress is hidden and background validation is set to false:\r\n```\r\n$ ./build/bin/bitcoin-cli getblockchaininfo\r\n...\r\n  \"mediantime\": 1756245700,\r\n  \"verificationprogress\": 1,\r\n  \"initialblockdownload\": false,\r\n  \"backgroundvalidation\": false,\r\n  \"chainwork\": \"00000000000000000000000000000000000000000000000000000656d6bb052b\",\r\n  \"size_on_disk\": 3964972194,\r\n...\r\n```\r\n\r\nThe PR also updates the way we estimate the verification progress returning a 100% on the snapshot block and not on the tip as we will stop doing background validation when reaching it.\r\n",
      "state": "open",
      "user": "polespinasa",
      "created_at": "2025-08-26T23:02:29Z",
      "updated_at": "2026-01-31T02:23:18Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33259",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1639,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3226540911,
      "number": 34456,
      "title": "p2p: assign separate network keys to outbound onion connections",
      "body": "This PR is inspired by sipa's suggestion in https://github.com/bitcoin/bitcoin/pull/33464#issuecomment-3356266112.\r\n\r\nOutbound onion connections use distinct Tor circuits and appear unrelated externally. Sharing a network_id might allow correlation via addr caching behaviour (e.g., `GetAddresses()` responses), enabling an observer to link apparently distinct connections.\r\n\r\nChanges proposed here assign each outbound onion connection a unique, deterministic network_id based on its destination address.\r\n\r\nUnchanged:\r\n- Inbound onion connections continue grouping (already linked through the same hidden service)\r\n- Clearnet outbound connections continue grouping (already linked through the same source IP)",
      "state": "open",
      "user": "frankomosh",
      "created_at": "2026-01-30T06:30:05Z",
      "updated_at": "2026-01-31T02:01:02Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34456",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 774,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3113678434,
      "number": 34100,
      "title": "doc: Use multipath descriptors in descriptors.md and linked test",
      "body": "Updates documentation and `wallet_miniscript_decaying_multisig_descriptor_psbt.py` to use single multipath descriptors with `<0;1>` syntax instead of separate external/internal descriptors.\n\n## Changes\n- **doc/descriptors.md**: Update examples (lines 70-71) to use `/<0;1>/*` multipath syntax\n- **doc/descriptors.md**: Update Basic Multisig Example instructions (line 179) to use single multipath descriptor\n- **test/functional/wallet_miniscript_decaying_multisig_descriptor_psbt.py**: Refactor to use single multipath descriptor pattern matching `wallet_multisig_descriptor_psbt.py`\n\n## Implementation\n- `_get_xpub()` now extracts external descriptor and converts to multipath format\n- `create_multisig()` imports single descriptor that expands to receive and change addresses\n- Removed fake checksums from documentation examples\n- Added clear comments documenting multipath convention\n\nFixes #34086",
      "state": "closed",
      "user": "anuragchvn-blip",
      "created_at": "2025-12-18T12:59:17Z",
      "updated_at": "2026-01-31T01:30:07Z",
      "merged_at": "2026-01-31T01:30:07Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34100",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 965,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2809021284,
      "number": 33343,
      "title": "help: enrich help text for `-loadblock`",
      "body": "`-loadblock` doesn't support XOR-ed files, mention it in its help text to avoid troubles for users.",
      "state": "open",
      "user": "HowHsu",
      "created_at": "2025-09-08T17:41:11Z",
      "updated_at": "2026-01-31T01:28:45Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33343",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 139,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 1678271840,
      "number": 29247,
      "title": "CAT in Tapscript (BIP-347)",
      "body": "# CAT in Tapscript\r\n\r\nThis PR provides the necessary code to enable the opcode OP\\_CAT in Tapscript as specified in [BIP-347: OP\\_CAT in Tapscript](https://github.com/bitcoin/bips/blob/master/bip-0347.mediawiki) and [BIN-2024-0001](https://github.com/bitcoin-inquisition/binana/blob/master/2024/BIN-2024-0001.md),\r\n\r\n**Important:** This PR *does not* include miner activation functionality. This means that merging this PR into bitcoin-core will not make OP\\_CAT functional in Bitcoin.\r\nIf this PR is merged it is *not* a signal of community consensus around activating CAT nor be read as a portent about the activation process or timeline.\r\nThe PR is not a stand-in for consensus around such decisions.\r\n\r\nThis PR includes:\r\n\r\n- An implementation of the Tapscript opcode OP\\_CAT along with the flags `SCRIPT_VERIFY_OP_CAT` and `SCRIPT_VERIFY_DISCOURAGE_OP_CAT`.\r\n- Integration and unit tests which ensure that our CAT  implementation works as expected. This includes ensuring that CAT never uses more that 520 bytes of stack memory. A full description of what these tests cover is given below.\r\n- An improvement to `src/test/script_tests.cpp` JSON script format enabling the rapid creation of new Tapscript unit tests.\r\n\r\n## Activation on Bitcoin-inquisition (signet)\r\n\r\n[Bitcoin-inquisition PR 37](https://github.com/bitcoin-inquisition/bitcoin/pull/39) which contained our implementation of OP\\_CAT [was merged into bitcoin-inquisition (signet) on Apr 25 2024](https://github.com/bitcoin-inquisition/bitcoin/pull/39), released as [bitcoin-inquisition release 25.2 on Apr 26 2024.](https://github.com/bitcoin-inquisition/bitcoin/releases/tag/v25.2-inq) and activated in bitcoin-inquisition Apr 30 2024. The bitcoin-inquisition PR was reviewed in the PR review club [(transcript of discussion)](https://bitcoincore.reviews/bitcoin-inquisition-39). Since Apr 30 2024 there have been many OP\\_CAT transactions created and spent on signet.\r\n\r\nThe code merged into bitcoin-inquisition differs from this PR, as we have removed the consensus logic which was used to activate it on signet.\r\n\r\n## OP\\_CAT Tapscript Implementation\r\n\r\nWe implement OP\\_CAT as a new Tapscript op code by redefining the opcode OP\\_SUCCESS126 (126 in decimal and 0x7e in hexadecimal). This is the same opcode value used by the original OP_CAT.\r\n\r\nWhen evaluated, the OP\\_CAT instruction:\r\n\r\n1. Pops the top two values off the stack,\r\n2. concatenates the popped values together in stack order,\r\n3. and then pushes the concatenated value on the top of the stack.\r\n\r\nOP\\_CAT fails if there are fewer than two values on the stack or if a concatenated value would have a combined size greater than the maximum script element size of 520 bytes.\r\n\r\nSee [BIP 347](https://github.com/bitcoin/bips/blob/master/bip-0347.mediawiki) for a deeper description.\r\n\r\n### Errors thrown\r\n\r\nIf evaluated OP\\_CAT can throw the following errors:\r\n\r\n- If at time of evaluation the stack has fewer than two elements we throw the error: `SCRIPT_ERR_INVALID_STACK_OPERATION`\r\n- If at time of evaluation the top two stack elements have a combined size greater than `MAX_SCRIPT_ELEMENT_SIZE` (520 bytes) we throw the error: `SCRIPT_ERR_PUSH_SIZE`.\r\n\r\n### Script verification flags\r\n\r\nWhile this PR does not contain any miner signaling and activation logic and can not activate OP\\_CAT, it does contain two flags which future activation logic could set to control activation of OP\\_CAT.\r\n\r\n- `SCRIPT_VERIFY_OP_CAT` IF a bitcoin node has this set to true, then it treat OP\\_CAT enabled for Tapscript. That is, OP\\_SUCCESS126 will be redefining to OP\\_CAT in Tapscript. If this was set to true at the consensus level this would cause a soft fork.\r\n\r\n`SCRIPT_VERIFY_DISCOURAGE_OP_CAT` When set to true, a node receiving any Tapscript transaction containing the opcode OP\\_CAT or OP\\_SUCCESS126 will reject the transaction throwing the error `SCRIPT_ERR_DISCOURAGE_OP_CAT` but not banning the node which relayed the transaction. This prevents nodes from relaying transactions with OP\\_CAT. This  is equivalent to the behavior of `SCRIPT_ERR_DISCOURAGE_OP_CAT = true` when `SCRIPT_VERIFY_OP_CAT = false` as OP\\_CAT is an OP\\_SUCCESS (OP\\_SUCCESS126).\r\n\r\nThis is how these two flags are intended to be used to ensure a smooth soft fork.\r\n\r\n| Stage | `SCRIPT_VERIFY OP_CAT` | `SCRIPT_VERIFY DISCOURAGE_OP_CAT` | Status |\r\n| --- | --- | --- | --- |\r\n| **1.Default** | False | True | This does not represent any change in behavior of the bitcoin-core node. |\r\n| **2.Upgrading** | True | True | OP\\_CAT is activating. |\r\n| **3.Upgraded** | True | False | It is clear that OP\\_CAT has been activated and the network has been upgraded. |\r\n\r\nThe flag `SCRIPT_ERR_DISCOURAGE_OP_CAT` provides a window of time for the network to fully activate, before nodes will relay or accept transactions containing OP\\_CAT in their mem pools.\r\n\r\n## Tests\r\n\r\nThis PR contains a suite of script tests to ensure that OP\\_CAT functions as expected. In the JSON script tests (`script_tests.json`), we test:\r\n\r\n- That if OP\\_CAT is not activated that there are no changes to bitcoin consensus.\r\n- That regardless of the activation or non-activation of OP\\_CAT in Tapscript, pre-Tapscript scripts, i.e. Bitcoin scripts, have no changes in behavior.\r\n- That OP\\_CAT when evaluated throws the expected error when there are less than two elements on the stack.\r\n- That OP\\_CAT when evaluated in a variety of circumstances and edge cases, successfully concatenates elements of the stack. This includes:\r\n  - multiple calls to OP\\_CAT in a row,\r\n  - evaluating OP\\_CAT inside of a IF conditional,\r\n  - evaluating OP\\_CAT on zero size stack elements, random and large stack elements,\r\n  - evaluating OP\\_CAT on values being moved to and from the alt stack,\r\n  - and checking that when evaluated OP\\_CAT concatenates the elements in the expected order.\r\n\r\nAll of these tests are designed to cover the happy path of OP\\_CAT, the various errors which OP\\_CAT can throw and all the corner cases between those two outcomes.\r\n\r\nAdditionally we include three tests outside of the JSON script tests.\r\n\r\n- `cat_simple` and `cat_empty_stack` are designed to test OP\\_CAT outside of the JSON serialization regime. Ensure that we catch bugs that we might miss in the JSON script tests due to a bug introduced at the JSON serialization layer.\r\n- `cat_dup_test` enumerates all stack element sizes from 1 to 522 bytes and then enumerates up to 10 repetitions of `OP\\_DUP OP\\_CAT`. It then tests if the stack element would exceed 520 bytes and if so did OP\\_CAT throw the error `SCRIPT_ERR_PUSH_SIZE`. This allows us to be certain that OP\\_CAT will not introduce any `OP\\_DUP OP\\_CAT` memory exhaustion attacks.\r\n\r\n### Better Tapscript tests in JSON script tests\r\n\r\nWhile writing these JSON script tests (`script_tests.json`) we ran into the following problem. The JSON script tests are simple and easy to write for pre-Tapscript scripts, but adding or changing a Tapscript test requires substantial work per test.\r\nConsider the following pre-tapscript test:\r\n\r\n```json\r\n[\"'aa' 'bb'\", \"CAT 0x4c 0x02 0xaabb EQUAL\", \"P2SH,STRICTENC\", \"DISABLED_OPCODE\", \"CAT disabled\"]\r\n```\r\n\r\nwhereas a Tapscript test for the same script (annotated with comments for better readability) would look like:\r\n\r\n```json\r\n[\r\n    [\r\n        \"aa\",\r\n        \"bb\",\r\n        \"7e4c02aabb87\", // output script\r\n        \"c0d6889cb081036e0faefa3a35157ad71086b123b2b144b649798b494c300a961d\", // control block\r\n        0.00000001\r\n    ],\r\n    \"\",\r\n    \"0x51 0x20 0x15048ed3a65748549c27b671936987093cf73a4c9cb18522a74fb9553060ca99\", // Tapscript output\r\n    \"P2SH,WITNESS,TAPROOT\",\r\n    \"OK\",\r\n    \"TAPSCRIPT CATs aa and bb together and checks if EQUAL to aabb\"\r\n]\r\n```\r\n\r\nComputing the Tapscript output, such as `0x51 0x20 0x15048ed3a65748549c27b671936987093cf73a4c9cb18522a74fb9553060ca99`, requires writing custom code and running it for each test. The same is true for the Tapscript control block, such as `c0d6889cb081036e0faefa3a35157ad71086b123b2b144b649798b494c300a961d`. If a test is changed or updated new outputs and control blocks must be computed. The complexity of doing this is likely the reason that no one has added any Tapscript tests to JSON script tests until this PR.\r\n\r\nIn this PR we address this issue by adding the following improvements to JSON script tests:\r\n\r\n- Adding simple macros (`\"#SCRIPT#` and `#CONTROLBLOCK#`) that allow the script test parser to automatically generate and inject a valid Tapscript output and control block to be computed automatically from the JSON script.\r\n- Allowing Tapscript scripts to use the human readable strings like pre-script scripts by marking the location of the script in the witness stack using `#SCRIPT#`. This transforms the unreadable script `7e4c02aabb87` into `#SCRIPT# CAT 0x4c 0x02 0xaabb EQUAL`.\r\n\r\nThis results in the following JSON script test which is far easier to write and easier to read.\r\n\r\n```json\r\n[\r\n    [\r\n        \"aa\",\r\n        \"bb\",\r\n        \"#SCRIPT# CAT\",\r\n        \"#CONTROLBLOCK#\",\r\n        0.00000001\r\n    ],\r\n    \"\",\r\n    \"0x51 0x20 #TAPROOTOUTPUT#\",\r\n    \"P2SH,WITNESS,TAPROOT,OP_CAT\",\r\n    \"OK\",\r\n    \"TAPSCRIPT Test of OP_CAT flag by calling CAT on two elements. TAPSCRIPT_OP_CAT flag is set so CAT is executed.\"\r\n],\r\n```\r\n  \r\n",
      "state": "open",
      "user": "arminsabouri",
      "created_at": "2024-01-14T22:40:42Z",
      "updated_at": "2026-01-31T01:08:50Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/29247",
      "labels": [
        "Consensus",
        "Needs rebase",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 4,
        "positive_keywords": 1,
        "text_length": 9301,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3131890251,
      "number": 34156,
      "title": "wallet: fix unnamed legacy wallet migration failure",
      "body": "Minimal fix for #34128.\r\n\r\nThe issue occurs during the migration of a legacy unnamed wallet\r\n(the legacy \"default\" wallet). When the migration fails, the cleanup\r\nlogic is triggered to roll back the state, which involves erasing the\r\nnewly created descriptor wallets directories. Normally, this only\r\naffects the parent directories of named wallets, since they each\r\nreside in their own directories. However, because the unnamed\r\nwallet resides directly in the top-level `/wallets/` folder, this\r\nlogic accidentally deletes the main directory.\r\n\r\nThe fix ensures that only the wallet.dat file of the unnamed wallet\r\nis touched and restored, preserving the wallet in BDB format and\r\nleaving the main `/wallets/` directory intact.\r\n\r\n#### Story Line:\r\n#32273 fixed a different set of issues and, in doing so, uncovered\r\nthis one.\r\nBefore the mentioned PR, backups were stored in the same directory\r\nas the wallet.dat file. On a migration failure, the backup was then\r\ncopied to the top-level `/wallets/` directory. For the unnamed legacy\r\nwallet, the wallet directory is the `/wallets/` directory, so the source\r\nand destination paths were identical. As a result, we threw early in the\r\n`fs::copy_file` call ([here](https://github.com/bitcoin/bitcoin/blob/29.x/src/wallet/wallet.cpp#L4572)) because the file already existed, as we\r\nwere trying to copy the file onto itself. This caused the cleanup logic\r\nto abort early on and never reach the removal line.\r\n\r\n\r\n#### Testing Notes:\r\nCherry-pick the test commit on top of master and run it. You will\r\nsee the failure and realize the reason by reading the test code.",
      "state": "closed",
      "user": "furszy",
      "created_at": "2025-12-27T04:08:33Z",
      "updated_at": "2026-01-30T23:48:44Z",
      "merged_at": "2026-01-07T11:09:03Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34156",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1664,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2858375622,
      "number": 33477,
      "title": "Rollback for dumptxoutset without invalidating blocks",
      "body": "This is an alternative approach to implement `dumptxoutset` with rollback that was discussed a few times. It does not rely on `invalidateblock` and `reconsiderblock` and instead creates a temporary copy of the coins DB, modifies this copy by rolling back as many blocks as necessary and then creating the dump from this temp copy DB. See also https://github.com/bitcoin/bitcoin/pull/29553#issuecomment-1978480989, https://github.com/bitcoin/bitcoin/issues/32817#issuecomment-3012406102 and #29565 discussions.\r\n\r\nThe nice side-effects of this are that forks can not interfere with the rollback and network activity does not have to be suspended. But there are also some downsides when comparing to the current approach: this does require some additional disk space for the copied coins DB and performance is slower (master took 3m 17s vs 9m 16s in my last test with the code here, rolling back ~1500 blocks). However, there is also not much code being added here, network can stay active throughout and performance would stay constant with this approach while it would impact master if there were forks that needed to be invalidated as well (see #33444 for the alternative approach), so this could still be considered a good trade-off.",
      "state": "open",
      "user": "fjahr",
      "created_at": "2025-09-24T21:15:11Z",
      "updated_at": "2026-01-30T23:27:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33477",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1289,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3128861568,
      "number": 34146,
      "title": "p2p: send first addr self-announcement in separate message 🎄",
      "body": "This makes sure the initial address self-announcement a node sends to a peer happends in a separate P2P message. This has benefits for both inbound and outbound connections:\r\n\r\nFor inbound connections from a peer to us, previously, we might send the self-announcement along with our response to a GETADDR request. However, the self-announcement might replace an address from the GETADDR response. This isn't clean.\r\n\r\nFor outbound connections from us to a peer, previously, it could have happend that we send the self-announcement along with other addresses. Since shortly after connection open, the peer might only have one rate-limiting token for us, and the addresses are shuffeld on arrival, it's possible that the self-announcement gets rate-limited. However, note that these rate-limitings seem to be rare in practice.\r\n\r\nThis is inspired by and based on https://github.com/bitcoin/bitcoin/pull/33699#issuecomment-3462287763. The discussion there should be helpful for reviewers. ",
      "state": "closed",
      "user": "0xB10C",
      "created_at": "2025-12-24T15:38:31Z",
      "updated_at": "2026-01-30T22:20:19Z",
      "merged_at": "2026-01-14T22:16:49Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34146",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1047,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2887599768,
      "number": 33540,
      "title": "argsman, cli: GNU-style command-line option parsing (allows options after non-option arguments)",
      "body": "This PR simplifies the argument parsing logic and resolves practical issues for `bitcoin-cli` and similar binaries (e.g. `bitcoin-wallet`) making their usage more consistent and predictable, enabling valid patterns such as mixing commands with wallet- or RPC-specific options—without relying on argument ordering quirks.\r\n\r\n<details>\r\n<summary>What's changed in ArgsManager that allows the above.</summary>\r\n\r\n- Previously, `ArgsManager` stopped interpreting options once a non-option argument was encountered (non-GNU parsing). For example:\r\n\r\n        bitcoind -a -b param -c\r\n\r\n  would ignore `-c` because it followed the non-option argument `param`. In some cases '-c' is interpreted as an argument for 'param', producing unexpected behavior (eg empty arrays for listtransactions command).\r\n\r\n- This PR changes the behavior so that options following non-option argument are recognized and processed (GNU parsing). This is needed for workflows for tools like CLI where command arguments may be followed by wallet- or RPC-specific\r\noptions, e.g.:\r\n\r\n        bitcoin-cli -rpcwallet=\"\" listtransactions -rpcwallet=mywallet\r\n    \r\n        bitcoin-cli getaddressinfo <address> -rpcwallet=mywallet\r\n\r\n- (other binaries could also benefit from this change,  e.g. `bitcoin-wallet`)\r\n\r\n        bitcoin-wallet create -wallet=newname\r\n\r\n- Invalid options passed after non-options will be treated as RPC arguments that begin with a `-` character (so no\r\nbehavioural change against `master`), e.g.:\r\n\r\n        bitcoin-cli -regtest -datadir=/tmp/btc createwallet -mywallet\r\n        {\r\n            \"name\": \"-mywallet\"\r\n        }\r\n\r\n</details>\r\n\r\n<details><summary>Before and after outputs running RPC commands from <code>CLI</code>/ <code>bitcoin-cli</code>.</summary><ul>\r\n     <li><details><summary>wallet commands using <code>CLI</code>:</summary><ul> \r\n           <li><details><summary><code>getaddressinfo</code></summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc getaddressinfo bcrt1qrnz5xlcwz5d85n3fag6v0vc4lryjc90jhqtpsh -rpcwallet=nonExistent\r\nerror message:\r\ngetaddressinfo \"address\"\r\n...\r\n```\r\n</li>\r\n           <li>after\r\n\r\n```\r\n./build/bin/bitcoin-cli -regtest -datadir=/tmp/btc getaddressinfo bcrt1qrnz5xlcwz5d85n3fag6v0vc4lryjc90jhqtpsh -rpcwallet=nonExistent\r\nerror code: -18\r\nerror message:\r\nRequested wallet does not exist or is not loaded\r\n```\r\n\r\n</li>\r\n           </ul></details></li>\r\n           <li><details><summary><code>listtransactions</code></summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=nonExistent\r\n[\r\n]\r\n```\r\n\r\n</li>\r\n           <li>after\r\n\r\n\r\n```\r\n./build/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=nonExistent\r\nerror code: -18\r\nerror message:\r\nRequested wallet does not exist or is not loaded\r\n```\r\n\r\n</li>\r\n           </ul></details></li>\r\n           <li><details><summary>any command that needs an option to be specifed, it can be added at the end directly instead of before the command</summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions\r\nerror code: -19\r\nerror message:\r\nMultiple wallets are loaded. Please select which wallet to use by requesting the RPC through the /wallet/<walletname> URI path. Or for the CLI, specify the \"-rpcwallet=<walletname>\" option before the command (run \"bitcoin-cli -h\" for help or \"bitcoin-cli listwallets\" to see which wallets are currently loaded).\r\n```\r\n\r\n```\r\n./build_master/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=\"\"\r\nerror code: -19\r\nerror message:\r\nMultiple wallets are loaded. Please select which wallet to use by requesting the RPC through the /wallet/<walletname> URI path. Or for the CLI, specify the \"-rpcwallet=<walletname>\" option before the command (run \"bitcoin-cli -h\" for help or \"bitcoin-cli listwallets\" to see which wallets are currently loaded).\r\n```\r\n\r\n</li>\r\n           <li>after\r\n\r\n```\r\n/build/bin/bitcoin-cli -regtest -datadir=/tmp/btc listtransactions -rpcwallet=\"\"\r\n[\r\n  {\r\n    \"address\": \"bcrt1q5pqkrlfrp9rvsg43sxxagrees7r7ul6uyskhs4\",\r\n    \"parent_descs\": [\r\n      \"wpkh([76a11ab0/84h/1h/0h]tpubDCDCuyC1Rtm1weZ5kfBYtdchcmqa2t8db7M68wsPHbWhUrYnzFTrHu7ufVVRydt3FdWQy8iNmKbZYbgpWWcEKPAj896x53UbS6i2xRD1qct/0/*)#kuff3m9t\"\r\n    ],\r\n    \"category\": \"immature\",\r\n    \"amount\": 50.00000000,\r\n    \"label\": \"\",\r\n...\r\n```\r\n\r\n</li>\r\n           </ul></details></li>\r\n     </ul></details></li>\r\n     <li><details><summary>other binaries could benefit from it, e.g. <code>bitcoin-wallet:</code></summary><ul> \r\n           <li><details><summary><code>create</code> command</summary><ul>\r\n           <li>before/ <code>master</code>\r\n\r\n```\r\n./build_master/bin/bitcoin-wallet -regtest -datadir=/tmp/btc create\r\nWallet name must be provided when creating a new wallet.\r\n```\r\n_(`-wallet` option has to be passed before the `create` command in order to work)_\r\n```\r\n./build_master/bin/bitcoin-wallet -regtest -datadir=/tmp/btc create -wallet=newWalletName\r\nError: Additional arguments provided (-wallet=newWalletName). Methods do not take arguments. Please refer to `-help`.\r\n```\r\n\r\n</li>\r\n           <li>after\r\n\r\n```\r\n./build/bin/bitcoin-wallet -regtest -datadir=/tmp/btc create -wallet=newWallet\r\nTopping up keypool...\r\nWallet info\r\n===========\r\nName: newWallet\r\nFormat: sqlite\r\nDescriptors: yes\r\nEncrypted: no\r\nHD (hd seed available): yes\r\nKeypool Size: 8000\r\nTransactions: 0\r\nAddress Book: 0\r\n```\r\n</li>\r\n           </ul></details></li>\r\n     </ul></details></li>\r\n     </ul> <!-- End -->\r\n</details>\r\n\r\n-<ins>_**Notes**_</ins>:\r\n\r\n- <ins>Backwards compatibility</ins>:\r\nThis PR is backward compatible in the sense that it allows new valid invocations that were previously rejected (failed or somehow ignored).\r\nIn `master`, any valid option following a command is treated as a positional argument. This can lead to unexpected RPC errors or help messages due to mismatched argument types. With this PR, those cases are parsed as proper options when applicable.\r\n\r\n- `bitcoin-cli` continues to accept RPC arguments that begin with a `-` character as currently in `master` (check `createwallet` example in _\"What's change in ArgsManager\"_ section above).\r\n\r\n- `bitcoin-cli` could distinguish between options that begin with single and double dashes, and treat options after the RPC method name that begin with double dashes as RPC named parameters (check example in 4th [commit](https://github.com/bitcoin/bitcoin/pull/33540/commits/a101bbb61fdf5563337334d63a10432432ee3625) message body).\r\n\r\n- Refactored both `ArgsManager::ProcessOptionKey` (new function added in this PR) and `ArgsManager::ParseParameters` in separated commits making the code clearer and the PR much easier to follow and review.",
      "state": "open",
      "user": "pablomartin4btc",
      "created_at": "2025-10-04T22:43:06Z",
      "updated_at": "2026-01-30T22:12:21Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33540",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 2,
        "text_length": 6987,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3225435118,
      "number": 34454,
      "title": "wallet: Rename `RecordType::DELETE` to `RecordType::DELETE_FLAG`",
      "body": "On Windows, the `winnt.h` header defines `DELETE` as a macro for a \"Standard Access Right\" bitmask (0x00010000L).\r\n\r\nThis introduces a fragile dependency on header inclusion order: if Windows headers happen to be included before the `RecordType` enum definition, the preprocessor expands `DELETE` into a numeric literal, causing syntax errors.\r\n\r\nRename the enumerator to `DELETE_FLAG` to remove this fragility and avoid the collision entirely.\r\n\r\nSplit from https://github.com/bitcoin/bitcoin/pull/34448.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-01-29T22:50:28Z",
      "updated_at": "2026-01-30T21:31:23Z",
      "merged_at": "2026-01-30T21:22:10Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34454",
      "labels": [
        "Refactoring",
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 570,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2925411752,
      "number": 33646,
      "title": "log: check fclose() results and report safely in logging.cpp",
      "body": "`fclose()` can report write errors (for example if the disk is full or the filesystem has a problem). Right now, some `fclose()` calls in `src/logging.cpp` ignore the return value. This means errors might go unnoticed and log lines could be lost without warning.\r\n\r\n## What this PR does:\r\n- Add a small helper that prints `fclose()` errors to `stderr` (with path and errno).\r\n- In shutdown: close `m_fileout` safely and report errors.\r\n- In reopen: open the new file, swap it in, close the old one, and report errors if closing fails.\r\n- In shrink/rotate: check all `fclose(file)` calls and report failures.\r\n\r\nNo other behavior changes. Normal logging, rotation, and console output remain unchanged.",
      "state": "open",
      "user": "cedwies",
      "created_at": "2025-10-17T19:06:08Z",
      "updated_at": "2026-01-30T20:42:11Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33646",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 761,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2934151848,
      "number": 33671,
      "title": "wallet: Add separate balance info for non-mempool wallet txs",
      "body": "Changes `getbalances` to report the sum of txos spent by transactions that aren't confirmed nor in the mempool (eg due to being part of too long a mempool chain, or spending non-standard outputs, or having a datacarrier output that exceeds `-datacarriersize`, etc). Those values are added to the trusted/untrusted_pending/immature/used fields as appropriate (where previously they were skipped), and subtracted from the new nonmempool field, so that the sum of all fields remains the same.\r\n\r\nFor example:\r\n\r\n```\r\n$ bitcoin-cli -regtest getbalances\r\n{\r\n  \"mine\": {\r\n    \"trusted\": 6049.99999220,\r\n    \"untrusted_pending\": 0.00000000,\r\n    \"immature\": 3200.00000780,\r\n    \"nonmempool\": -100.00000000\r\n  },\r\n  \"lastprocessedblock\": {\r\n    \"hash\": \"3ab4582226d5e8ad76438db48d76e822c31bce2cdbc7ba82a5d974a277515d0d\",\r\n    \"height\": 221\r\n  }\r\n}\r\n```\r\n\r\nCloses #11887",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2025-10-21T16:59:13Z",
      "updated_at": "2026-01-30T19:58:51Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33671",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 922,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2937452835,
      "number": 33680,
      "title": "validation: do not wipe utxo cache for stats/scans/snapshots",
      "body": "Revival of https://github.com/bitcoin/bitcoin/pull/30610#issuecomment-3432564955 with the remaining comments applied on top\r\n\r\n> Since #28280, the cost of a non-wiping sync of the UTXO cache is only proportional to the number of dirty entries, rather than proportional to the size of the entire cache. Because of that, there is no reason to perform a wiping flush in case the contents of the cache is still useful.\r\n> \r\n> Split the `FlushStateMode::ALWAYS` mode into a FORCE_SYNC (non-wiping) and a FORCE_FLUSH (wiping), and then use the former in `scantxoutset`, `gettxoutsetinfo`, snapshot creation.\r\n\r\n(slightly updated after #30214)",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2025-10-22T14:46:09Z",
      "updated_at": "2026-01-30T19:43:22Z",
      "merged_at": "2026-01-29T22:43:47Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33680",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 697,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2965956843,
      "number": 33752,
      "title": "rest: Query predecessor headers using negative count param",
      "body": "There is currently no mechanism by which to batch-query headers from tip, backwards towards genesis.\r\nThis PR extends the REST Blockheaders API to support batch-querying predecessor headers, by providing a negative count parameter.",
      "state": "open",
      "user": "A-Manning",
      "created_at": "2025-10-31T09:11:11Z",
      "updated_at": "2026-01-30T18:49:42Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33752",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 290,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3228801966,
      "number": 34466,
      "title": "kernel: make logging struct-based",
      "body": "The `bitcoinkernel` library (#27587) [exposes](https://github.com/bitcoin/bitcoin/blob/b26762bdcb941096ccc6f53c3fb5a7786ad735e7/src/kernel/bitcoinkernel.h#L698-L778) functionality to interface with kernel logging. This includes registering callbacks for log statements, level/category filtering, string formatting options, and more.\r\n\r\nThis PR improves kernel logging by making it struct-based instead of string-based. Rather than adding this functionality onto an already large `BCLog::Logger` class, the PR first separates log generation (i.e. producing the log message via `LogInfo(msg)`) from log consumption (i.e. formatting, ratelimiting, printing the message) by moving all log generation code to `util/log.h`. While not strictly necessary for adding struct-based logging, it better separates concerns and is a prerequisite for follow-up work in #34374 that completely removes `kernel`'s dependency on `logging.cpp`.\r\n\r\n**Approach:**\r\n\r\n1. **Separate log generation**: Add a minimal `util::log::Dispatcher` that is used to generate logs, and forwards struct-based log entries to registered callbacks. No formatting, rate-limiting, or output handling - that's the consumer's responsibility.\r\n \r\n1. **Register `BCLog::Logger` on Dispatcher**: Register a callback on the global Dispatcher to receive entries and handle node-specific concerns (formatting, rate-limiting, file output) without changing most of its logic. Route logging macros through this global dispatcher.\r\n \r\n1. **Update bitcoinkernel C API**: Replace the string-based callback with `btck_LogEntry` containing full metadata and remove `btck_LoggingOptions` and related functions.\r\n\r\nNote: with this change, `bitcoinkernel` logging callbacks are no longer routed through `BCLog::Logger`. This means that they are no longer buffered (i.e. log messages produced before a logging callback is registered) are dropped, and there is no longer a need for `btck_logging_disable`. In practice, this means users can no longer see the log message produced during the static [context initialization](https://github.com/bitcoin/bitcoin/blob/01651324f4e540f6b96cff31e89752c3f9417293/src/kernel/context.cpp#L20).\r\n\r\nCarve-out of #34374 to narrow the focus while maintaining tangible benefits (i.e. having struct-based logging).\r\n\r\n",
      "state": "closed",
      "user": "stickies-v",
      "created_at": "2026-01-30T18:07:59Z",
      "updated_at": "2026-01-30T18:21:20Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34466",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2320,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3203363765,
      "number": 34393,
      "title": "rpc: Fix off-by-one error in getblockchaininfo help",
      "body": "Correct the `headers` field description in `getblockchaininfo`.\r\n\r\n\"The current number of headers we have validated\" is wrong - the field reports the height of the best known header.\r\n\r\nI'm open to suggestions regarding the exact wording.\r\n\r\nSample output:\r\n```\r\n{\r\n  \"chain\": \"main\",\r\n  \"blocks\": 933527,\r\n  \"headers\": 933527,\r\n  ...\r\n}\r\n```",
      "state": "open",
      "user": "billymcbip",
      "created_at": "2026-01-23T13:46:44Z",
      "updated_at": "2026-01-30T14:53:35Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34393",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 394,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3091431534,
      "number": 34049,
      "title": "rpc: Disallow captures in RPCMethodImpl",
      "body": "When defining `RPCHelpMan` objects, we usually return a lambda, and mostly we define those via `[&](...) { ... }` which explicitly captures any parameters or local variables by reference. If we were to actually use any of those captures (we don't), we would invoke undefined behaviour. So instead, convert all the `[&]` to `[]` to avoid capturing, and as part of `RPCHelpMan` check that the function we provide is convertible to a bare function pointer, so that any attempts to capture anything (even if it's by-copy, which is safe) results in an error.\r\n\r\nWhile we're at it, rename `RPCHelpMan` to `RPCMethod`, reflecting it's greater responsibility since #19386.",
      "state": "open",
      "user": "ajtowns",
      "created_at": "2025-12-11T03:25:25Z",
      "updated_at": "2026-01-30T12:33:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34049",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 704,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3218102916,
      "number": 34427,
      "title": "lint: Flatten lint image entry points",
      "body": "Two fixups to the lint container:\r\n\r\n* Add a missing `--platform=linux` to avoid running a non-native arch, like s390x, which happens with podman if such a container was most recently used.\r\n* Flatten the entry points to remove the bash-based one:\r\n\r\nPreviously, an additional entry point into the container that spawned a bash was supported. The bash had an alias `lint` to run all lint scripts. However, such a use-case seems limited (because it only runs inside the container), inflexible (because it only allows running all lint scripts), and possibly brittle (because it can miss re-building the image when the cache is stale). So remove it and just offer the single entry point via the `./ci/lint.py` script.\r\n\r\nIf there is a use-case to skip the image building, it should be trivial to add an env var setting the the lint Python script like `DANGER_SKIP_IMAGE_RE_BUILD=1` (or so) in the future.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-28T10:09:18Z",
      "updated_at": "2026-01-30T12:24:43Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34427",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 939,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3224372522,
      "number": 34450,
      "title": "[29.x] backports + final changes for 29.3rc2",
      "body": "Backport:\r\n\r\n* #34236\r\n\r\nAnd finalize 29.3rc2.",
      "state": "closed",
      "user": "sedited",
      "created_at": "2026-01-29T17:13:26Z",
      "updated_at": "2026-01-30T11:41:37Z",
      "merged_at": "2026-01-30T11:41:37Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34450",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 91,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3216306855,
      "number": 34425,
      "title": "test: Fix all races after a socket is closed gracefully",
      "body": "Currently, functional tests may intermittently fail, due to a lack of synchronization after a node connection socket was closed gracefully: If node A is connected to node B, and node B closes the connection, node A *must* wait for the connection to be closed before continuing the test. Otherwise, subsequent re-connections may not work while a stale connection is still alive.\r\n\r\nThis can be reproduced locally via something like:\r\n\r\n```diff\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex 6b79e913e8..32bd061500 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -2200,2 +2200,3 @@ void CConnman::SocketHandlerConnected(const std::vector<CNode*>& nodes,\r\n                 }\r\n+            UninterruptibleSleep(599ms);\r\n                 pnode->CloseSocketDisconnect();\r\n```\r\n\r\nWith this diff, the tests should fail on master, and pass after this fix.\r\n\r\nThe fix involves simply calling `self.wait_until(lambda: len(node_a.getpeerinfo()) == 0)` after each disconnect, and before each re-connection.",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-27T21:35:13Z",
      "updated_at": "2026-01-30T11:29:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34425",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1050,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3225030030,
      "number": 34453,
      "title": "ci: Always print low ccache hit rate notice",
      "body": "Looks like the hit rate is low, even on test changes such as https://github.com/bitcoin/bitcoin/actions/runs/21476546461/job/61867393974#step:10:3349\r\n\r\nto make it easier to debug, unconditionally print the low hit rate notice",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-29T20:37:12Z",
      "updated_at": "2026-01-30T11:23:12Z",
      "merged_at": "2026-01-30T08:23:45Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34453",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 270,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2306767820,
      "number": 31764,
      "title": "cmake: Generate man pages at install time",
      "body": "This PR enables the man pages to be generated on the fly during installation.\r\n\r\nAs the GNU help2man tool is required to generate man pages, the `INSTALL_MAN` build option is disabled by default.\r\n\r\nAddresses this comment:https://github.com/bitcoin/bitcoin/blob/809d7e763cc9bdfff3288860a1c530460c76ffff/src/CMakeLists.txt#L456\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/31762.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-01-30T12:33:24Z",
      "updated_at": "2026-01-30T11:04:17Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31764",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 426,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3220429723,
      "number": 34434,
      "title": "miniscript: correct and_v() properties",
      "body": "`and_v()` must never be 'd'. This is not a bug fix since this was unreachable in valid Miniscripts: the first sub of an `and_v()` must be of type V, which conflicts with (i.e. never has) property 'd'.",
      "state": "closed",
      "user": "darosior",
      "created_at": "2026-01-28T20:31:02Z",
      "updated_at": "2026-01-30T09:45:25Z",
      "merged_at": "2026-01-30T09:45:25Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34434",
      "labels": [
        "Descriptors"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 239,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3223669239,
      "number": 34445,
      "title": "fuzz: Use `__AFL_SHM_ID` for naming test directories",
      "body": "During long multicore fuzzing campaigns with AFL++, stale datadirs can eventually accumulate from time outs, resulting in disk running out of space (see https://github.com/bitcoin/bitcoin/issues/28811). The easiest way to reproduce this is by running our `utxo_total_supply` target using multiple cores with AFL++ and observing the crashes that occur because of all the directories in `/tmp/test_common\\ bitcoin/utxo_total_supply/`.\r\n\r\nFix this by using the AFL++ shared memory ID to name the test dirs and cleaning it up before each setup. This ID is unique per AFL++ instance, so multiple cores can run in parallel without conflicts.\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/28811",
      "state": "closed",
      "user": "marcofleon",
      "created_at": "2026-01-29T14:17:23Z",
      "updated_at": "2026-01-30T09:27:35Z",
      "merged_at": "2026-01-30T09:27:34Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34445",
      "labels": [
        "Fuzzing"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 745,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3119768347,
      "number": 34125,
      "title": "refactor: reuse `should_empty` check for chainstate flush",
      "body": "Minor follow-up to https://github.com/bitcoin/bitcoin/pull/33866\r\n\r\nReuse the `should_empty` predicate for both the write decision and for selecting `CoinsTip().Flush()` vs `CoinsTip().Sync()`.\r\nThis is a pure refactor, no behavior is changed.",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2025-12-20T12:14:47Z",
      "updated_at": "2026-01-30T09:15:16Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34125",
      "labels": [
        "Refactoring",
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 301,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3218546135,
      "number": 34429,
      "title": "test: Check that redundant verack message is ignored",
      "body": "The code exists and is uncovered (ref https://maflcko.github.io/b-c-cov/total.coverage/src/net_processing.cpp.gcov.html#L3795), so add a trivial test to cover it.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-28T12:08:11Z",
      "updated_at": "2026-01-30T09:02:47Z",
      "merged_at": "2026-01-30T08:41:13Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34429",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 215,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2678738082,
      "number": 33014,
      "title": "rpc: Fix internal bug in descriptorprocesspsbt when encountering invalid signatures",
      "body": "Fixes #32849\r\nThe descriptorprocesspsbt RPC was crashing with an internal bug assertion when processing PSBTs with invalid signatures (like invalid Schnorr signatures with SIGHASH_SINGLE | ANYONECANPAY flags). Instead of returning a helpful error message, it would just crash.\r\nThis change replaces the CHECK_NONFATAL call with proper error handling that catches the failure and returns a JSONRPCError with a clear message to the user.\r\nTested with Bitcoin Core v29.0.0 using the exact PSBT from the issue report. The fix now returns proper error messages instead of crashing.",
      "state": "open",
      "user": "b-l-u-e",
      "created_at": "2025-07-19T05:15:00Z",
      "updated_at": "2026-01-30T08:27:27Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33014",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 660,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3173584131,
      "number": 34284,
      "title": "ipc, test: Add tests for unclean disconnect and thread busy behavior",
      "body": "Upcoming libmultiprocess changes are expected to alter this behavior (https://github.com/bitcoin/bitcoin/issues/34250#issuecomment-3749243782), making test coverage useful for documenting current behavior and validating the intended changes.",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2026-01-14T13:46:24Z",
      "updated_at": "2026-01-30T05:05:28Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34284",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 310,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3174053537,
      "number": 34286,
      "title": "test: verify node state after restart in assumeutxo",
      "body": "## Summary\n\nThis PR replaces the TODO comment in `wallet_assumeutxo.py` (line 242) with actual test assertions that verify node and wallet behavior after a restart during assumeutxo background sync.\n\n## Changes\n\nThe new tests verify:\n- Two chainstates exist (background validation not complete)\n- Background chainstate is still at `START_HEIGHT`\n- Snapshot chainstate has synced to at least `PAUSE_HEIGHT`\n- Wallets cannot be loaded after restart (expected behavior)\n- Wallet backup from before snapshot height cannot be restored\n\n## Motivation\n\nDuring implementation, I discovered that **wallets cannot be loaded after a node restart during assumeutxo background sync**. This is expected behavior because:\n- The wallet loading code checks if required blocks are available for rescanning\n- During assumeutxo background sync, blocks before the snapshot are not available\n- This applies to all wallets, including watch-only wallets created at the snapshot height\n\nThis is a valuable test addition because it documents this expected behavior and ensures it doesn't regress. Users should be aware that if they restart their node during assumeutxo background sync, they won't be able to load their wallets until the background sync completes.\n\n## Related\n\nrefs #28648\n\nAddresses the TODO comment that was originally added as part of the assumeutxo wallet test implementation.",
      "state": "open",
      "user": "yashbhutwala",
      "created_at": "2026-01-14T15:55:59Z",
      "updated_at": "2026-01-30T04:53:13Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34286",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1422,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3174906348,
      "number": 34293,
      "title": "Bugfix: net_processing: Restore missing comma between peer and peeraddr in \"receive version message\" and \"New ___ peer connected\"",
      "body": "Versions prior to 29.x all included a comma here, and the general format of the message still includes commas between all other fields\r\n",
      "state": "open",
      "user": "luke-jr",
      "created_at": "2026-01-14T20:34:00Z",
      "updated_at": "2026-01-30T04:36:50Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34293",
      "labels": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 266,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3196205347,
      "number": 34372,
      "title": "QA: wallet_migration: Test several more weird scenarios",
      "body": "Includes the \"survive\" file test from #34222 ",
      "state": "open",
      "user": "luke-jr",
      "created_at": "2026-01-21T17:44:07Z",
      "updated_at": "2026-01-30T01:10:54Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34372",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 101,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2908274346,
      "number": 33604,
      "title": "p2p: Allow block downloads from peers without snapshot block after assumeutxo validation",
      "body": "Currently, after assumeutxo background validation finishes, the node continues to skip peers that don't have the snapshot block in their best chain until restart. This unnecessarily excludes peers from block downloads even though the background sync has completed and undo data is available.\r\n\r\nThe restriction persists because `m_chainman.CurrentChainstate().SnapshotBase()` continues to return the snapshot base block until restart, even after validation completes. Added `m_chainman.CurrentChainstate().m_assumeutxo == Assumeutxo::UNVALIDATED` check to only apply the peer restriction while background validation is ongoing. \r\n\r\nAlso added test coverage in `feature_assumeutxo.py` that verifies peers without the snapshot block can be used for block downloads after background validation completes. The test fails without this fix.",
      "state": "closed",
      "user": "stringintech",
      "created_at": "2025-10-12T20:36:02Z",
      "updated_at": "2026-01-29T23:11:14Z",
      "merged_at": "2026-01-29T23:11:14Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33604",
      "labels": [
        "P2P"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 923,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3133196135,
      "number": 34164,
      "title": "validation: add reusable coins view for ConnectBlock",
      "body": "This is the first commit of #31132, which can be merged as an independent change. It has a small benefit on its own, but will help in moving the parent PR forward.\r\n\r\nAdd a `Reset()` method to `CCoinsViewCache` that clears `cacheCoins`, `cachedCoinsUsage`, and `hashBlock` without flushing to the `base` view. This allows efficiently reusing a cache instance across multiple blocks.\r\n\r\nAdd `CCoinsViewCache::CreateResetGuard` method to return a `CCoinsViewCache::ResetGuard`. The `ResetGuard` automatically calls `Reset()` on destruction. This RAII pattern ensures the cache is always properly reset between blocks.\r\n\r\nAdd `m_connect_block_view` as a persistent `CCoinsViewCache` for `ConnectBlock`, avoiding repeated memory allocations.",
      "state": "closed",
      "user": "andrewtoth",
      "created_at": "2025-12-28T20:05:04Z",
      "updated_at": "2026-01-29T22:59:48Z",
      "merged_at": "2026-01-29T22:59:48Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34164",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 790,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3216048052,
      "number": 34422,
      "title": "Update libmultiprocess subtree to be more stable with rust IPC client",
      "body": "**This is based on #34284 + https://github.com/bitcoin-core/libmultiprocess/pull/240 so is currently a draft PR.** It's open to make sure the changes work together and there are no issues in CI.\r\n\r\nIncludes:\r\n\r\n- https://github.com/bitcoin-core/libmultiprocess/pull/241\r\n- https://github.com/bitcoin-core/libmultiprocess/pull/240\r\n\r\nThe latter change fixes issues with asynchronous requests (https://github.com/bitcoin/bitcoin/issues/33923) and unclean disconnects (https://github.com/bitcoin/bitcoin/issues/34250) that happen with the rust mining client.\r\n\r\nThe changes can be verified by running `test/lint/git-subtree-check.sh src/ipc/libmultiprocess` as described in [developer notes](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#subtrees) and [lint instructions](https://github.com/bitcoin/bitcoin/tree/master/test/lint#git-subtree-checksh)\r\n",
      "state": "open",
      "user": "ryanofsky",
      "created_at": "2026-01-27T20:06:40Z",
      "updated_at": "2026-01-29T22:37:58Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34422",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 942,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3221387587,
      "number": 34438,
      "title": "wallet: add `gethdkey` RPC for BIP 32 key derivation",
      "body": "Revives #22341 (marked \"up for grabs\").\r\n\r\nAdd `gethdkey` RPC to derive an extended key at any BIP 32 path from the wallet's active HD key. \r\nThis enables exporting xpubs/xprvs for external setups (e.g., BIP 87 multisig) without modifying the wallet's keypool.\r\n\r\n```\r\n$ bitcoin-cli gethdkey \"m/87'/0'/0'\"\r\n{\r\n    \"xpub\": \"xpub6...\",\r\n    \"fingerprint\": \"1a2b3c4d\",\r\n    \"origin\": \"[1a2b3c4d/87'/0'/0']\" \r\n}                                                                                                                                     \r\n                                                                                                                                        \r\n$ bitcoin-cli gethdkey \"m/87'/0'/0'\" '{\"private\": true}' \r\n{\r\n    \"xpub\": \"xpub6...\",\r\n    \"xprv\": \"xprv9...\",\r\n    .. \r\n}\r\n```\r\n\r\n**Use case**: Users setting up multisig (e.g., with hardware wallets or other software) need xpubs at specific derivation paths. Currently this there is no way to extract a specific path from wallets in Bitcoin Core.\r\n\r\n**Design**: Intentionally simple, only exports key info. To sign with derived keys, users import the returned xprv via `importdescriptors`. This keeps all signing through the normal keypool mechanism.",
      "state": "open",
      "user": "w0xlt",
      "created_at": "2026-01-29T02:21:59Z",
      "updated_at": "2026-01-29T22:03:44Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34438",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1284,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3223420600,
      "number": 34444,
      "title": "refactor: rename remaining BIP14 subversion identifiers to user agent",
      "body": "### Problem\r\n[BIP14](https://github.com/bitcoin/bips/blob/master/bip-0014.mediawiki) defines the `sub_version_num` field in `version` messages as a user-agent string, but there are still internal and user-facing references to \"subver/subversion\" (as noted in https://github.com/bitcoin/bitcoin/pull/34389#discussion_r2721151800).\r\n\r\n### Fix\r\nThe first commit performs the bulk of the mechanical work via a `scripted-diff` that (with a leading preflight check to make sure the target names don't collide), renaming internal identifiers from `*SubVersion*`/`subver*` to `*UserAgent*`/`user_agent`. I have verified the mechanical renames via to produce the same binary (except for the `test_FormatSubVersion` unit test name).\r\n\r\nThe second commit follows up with the remaining non-mechanical cleanup, adjusting user-facing descriptions, comments, and local variable names to use \"user agent\" and explicitly referencing BIP14 as justification.\r\n\r\nFor compatibility, the RPC keys (`subver`, `subversion`) are intentionally left unchanged.",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-29T13:24:38Z",
      "updated_at": "2026-01-29T21:45:31Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34444",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1103,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2825267198,
      "number": 33384,
      "title": "descriptor: fix comments in descriptor.cpp::DescriptorImpl",
      "body": "`P2TR` was missing in `m_pubkey_args` description and it was a typo in `doc/descriptors.md`\r\n",
      "state": "open",
      "user": "pythcoiner",
      "created_at": "2025-09-13T12:40:07Z",
      "updated_at": "2026-01-29T19:10:00Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33384",
      "labels": [
        "Descriptors"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 152,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2856019872,
      "number": 33472,
      "title": "guix: documented shasum gathering command",
      "body": "When a PR requires proof of Guix builds (sha256sums), the PR author or reviewer uses a not well documented command to collect the sha256sums of build outputs or manually gathers them from files.\r\n\r\nThis pull request introduces a new section in the documentation, providing some documentation on the command's functionality and usage.",
      "state": "closed",
      "user": "janb84",
      "created_at": "2025-09-24T08:41:36Z",
      "updated_at": "2026-01-29T18:35:45Z",
      "merged_at": "2026-01-28T16:31:48Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33472",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 375,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3223764653,
      "number": 34447,
      "title": "doc: clarify pruning information insetup documentation",
      "body": "This PR improves the readability of the setup documentation by clarifying the explanation of pruning.\r\n\r\nIt is intended to help beginners, especially users running Bitcoin Core on Linux in a virtual machine (e.g. VirtualBox). The changes clarify how pruning works, including related concepts such as dbcache and connection settings, which are often confusing for new users syncing the node for learning or basic usage.\r\n\r\nNo functional changes.\r\n\r\n\r\n",
      "state": "closed",
      "user": "shivanshshri",
      "created_at": "2026-01-29T14:41:32Z",
      "updated_at": "2026-01-29T17:56:28Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34447",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 505,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2893662859,
      "number": 33562,
      "title": "DRAFT: add a freebsd job using systemlibs",
      "body": "Re #33438\r\n\r\nTest a basic freebsd job in this repo using cirrus runners to get some info on how long a run will take on Cirrus Runners.\r\n\r\nA run on GHA (free) runners is clocking in at around 50 - 60 minutes: https://github.com/willcl-ark/bitcoin/actions/runs/18309856374/job/52135663056 \r\n\r\nThis will need permitting of the `vmactions/freebsd-vm@v1` action in this repo. This action seems well-maintained/used, including by [`rustup`](https://github.com/rust-lang/rustup/blob/061cf7830a61eaefaddddb8454232186d26fd2d1/ci/actions-templates/freebsd-builds-template.yaml#L19), python [`psutil`](https://github.com/giampaolo/psutil/blob/0217662c7e3381612e1a15181b02fe3d06894272/.github/workflows/bsd.yml#L19) and a few other notable repos.\r\n\r\nThis job could alternatively be run as a nightly job (but in this repo, rather than elsewhere), but that does not seem to address:\r\n\r\n> BSDs are being tested in nightly repos, but merging code here, just to have it reported as broken after the fact, which then requires more changes to fix, isn't ideal. Issues should be caught in this repo, before merging.\r\n\r\nInspiration taken from https://github.com/hebasto/bitcoin-core-nightly/blob/main/.github/workflows/freebsd.yml",
      "state": "closed",
      "user": "willcl-ark",
      "created_at": "2025-10-07T11:35:43Z",
      "updated_at": "2026-01-29T17:12:39Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/33562",
      "labels": [
        "Needs rebase"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1252,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3224156991,
      "number": 34449,
      "title": "wallet: limit anti fee sniping locktime backdating when spending unconfirmed UTXOs",
      "body": "Fixes #26527\r\n\r\nThe Bitcoin Core wallet implements an anti fee sniping mechanism that sets a transaction’s nLockTime to the current block height, and occasionally to an earlier height.\r\n\r\nWhen the wallet spends unconfirmed UTXOs, this logic can currently choose a locktime for the child transaction that is earlier than the locktime of its unconfirmed parent. This creates an unrealistic “transaction signed earlier but only broadcast now” scenario and may act as a wallet fingerprint.\r\n\r\nThis PR fixes the issue by preventing a transaction’s nLockTime from being set to a value earlier than the nLockTime of any unconfirmed parent. This is done by passing a minimum nLockTime to `DiscourageFeeSniping` when spending unconfirmed inputs, set to the maximum nLockTime of the unconfirmed parents, or 0 if there are none.\r\n\r\n`DiscourageFeeSniping` is currently invoked by the following RPCs:\r\n- `sendall`\r\n- `send`\r\n- `sendtoaddress`\r\n- `sendmany`\r\n- `fundrawtransaction`\r\n- `walletcreatefundedpsbt`\r\n\r\nTests are added for this behavior for the `sendall` and `send` RPCs. These are the only RPCs that can hit this case, since `sendtoaddress` and `sendmany` don’t spend unconfirmed inputs, and `fundrawtransaction` and `walletcreatefundedpsbt` don’t apply fee sniping (instead, they always set `nLockTime` to 0 unless explicitly provided by the user).\r\n\r\nYou can cherry-pick the two commits adding tests on master and see them intermittently failing (this might take a couple of re-tries to see).",
      "state": "closed",
      "user": "danielabrozzoni",
      "created_at": "2026-01-29T16:19:02Z",
      "updated_at": "2026-01-29T16:58:11Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34449",
      "labels": [
        "Wallet",
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1574,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3195778555,
      "number": 34370,
      "title": "[29.x] Fix #34222 backport bugs",
      "body": "",
      "state": "closed",
      "user": "luke-jr",
      "created_at": "2026-01-21T15:47:10Z",
      "updated_at": "2026-01-29T16:48:51Z",
      "merged_at": "2026-01-29T16:48:51Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34370",
      "labels": [
        "Wallet",
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 32,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3223713807,
      "number": 34446,
      "title": "[29.x] Backport CI changes",
      "body": "Backports:\r\n* #32513 (partial backport)\r\n* #34344",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-01-29T14:28:16Z",
      "updated_at": "2026-01-29T16:24:01Z",
      "merged_at": "2026-01-29T16:23:27Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34446",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 76,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3154093541,
      "number": 34223,
      "title": "[28.x] Backport wallets directory deletion fixes",
      "body": "Backports #34222 to 28.x",
      "state": "open",
      "user": "achow101",
      "created_at": "2026-01-07T22:03:05Z",
      "updated_at": "2026-01-29T16:03:08Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34223",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 73,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3173543618,
      "number": 34283,
      "title": "[30.x] More backports",
      "body": "Backports:\r\n* #32513\r\n* #34185\r\n* #34272\r\n* #34252\r\n* #34281\r\n* #34282\r\n* #34344\r\n* #34358\r\n* #34390\r\n* #34413",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-01-14T13:32:45Z",
      "updated_at": "2026-01-29T15:51:07Z",
      "merged_at": "2026-01-29T15:50:56Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34283",
      "labels": [
        "Backport"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 132,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3188672071,
      "number": 34346,
      "title": "test: use IP_PORTRANGE_HIGH on FreeBSD for dynamic port allocation",
      "body": "Reopening #34336. I’ve now tested it on FreeBSD and confirmed it works.\r\n\r\nOn FreeBSD, the default ephemeral port range (10000-65535) overlaps with the test framework's static port range (11000-26000), possibly causing intermittent \"address already in use\" failures when tests use dynamic port allocation (`port=0`).\r\n\r\nThis PR adds a helper that sets `IP_PORTRANGE_HIGH` via `setsockopt()` before binding, requesting ports from 49152-65535 instead, which avoids the overlap, as suggested in https://github.com/bitcoin/bitcoin/issues/34331#issuecomment-3767161843 by @maflcko .\r\n\r\nFrom FreeBSD's [sys/netinet/in.h](https://cgit.freebsd.org/src/tree/sys/netinet/in.h):                                                          \r\n  ```c\r\n  #define IP_PORTRANGE         19\r\n  #define IP_PORTRANGE_HIGH    1\r\n  #define IPPORT_EPHEMERALFIRST 10000  /* default range start */\r\n  #define IPPORT_HIFIRSTAUTO   49152   /* high range start */\r\n```\r\n\r\nSee also: FreeBSD https://man.freebsd.org/cgi/man.cgi?query=ip&sektion=4 man page.\r\n\r\nFixes #34331",
      "state": "closed",
      "user": "w0xlt",
      "created_at": "2026-01-19T17:57:22Z",
      "updated_at": "2026-01-29T11:33:57Z",
      "merged_at": "2026-01-29T11:33:57Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34346",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1105,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3163366332,
      "number": 34253,
      "title": "validation: cache tip recency for lock-free `IsInitialBlockDownload()`",
      "body": "This PR is a follow-up to the stale #32885.\r\n\r\n### Problem\r\n`ChainstateManager::IsInitialBlockDownload()` currently acquires `cs_main` internally, even though most existing call sites already hold the lock. This becomes relevant for proposals like #34054, which would call `IsInitialBlockDownload()` from the scheduler thread without holding `cs_main`, potentially introducing lock contention.\r\n\r\n### Fix\r\nMake `ChainstateManager::IsInitialBlockDownload()` lock-free by caching its result in a single atomic `m_cached_is_ibd` (true while in IBD, latched to false on exit).\r\nMove the IBD exit checks out of `IsInitialBlockDownload()` (reader-side) into a new `ChainstateManager::UpdateIBDStatus()` (writer-side, called under cs_main).\r\n\r\nCall UpdateIBDStatus() at strategic points where IBD exit conditions may change, after active chain tip updates in `ConnectTip()`, `DisconnectTip()`, and `LoadChainTip()`, and after `ImportBlocks()` returns.\r\n\r\nWith this, `IsInitialBlockDownload()` becomes a lock-free atomic read, avoiding internal `cs_main` acquisition on hot paths.\r\n\r\n### Testing and Benchmarks\r\nThis isn't strictly an optimization (though some usecases might benefit from it), so rather as a sanity check I ran a reindex-chainstate and an `AssumeUTXO` load (without background validation).\r\n\r\n<details>\r\n<summary>assumeutxo load | 910000 blocks | dbcache 4500 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | xfs | SSD</summary>\r\n\r\n```\r\nCOMMITS=\"595504a43209bead162da54a204df7d140a25f0e 63e822b637f67242e3689adedc0155b34100e651\"; \\\r\nCC=gcc; CXX=g++; \\\r\nBASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/ShallowBitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; UTXO_SNAPSHOT_PATH=\"$BASE_DIR/utxo-910000.dat\"; \\\r\n(echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done; echo \"\") && \\\r\nfor DBCACHE in 4500; do \\\r\n  (echo \"assumeutxo load | 910000 blocks | dbcache ${DBCACHE} | $(hostname) | $(uname -m) | $(lscpu | grep 'Model name' | head -1 | cut -d: -f2 | xargs) | $(nproc) cores | $(free -h | awk '/^Mem:/{print $2}') RAM | $(df -T $BASE_DIR | awk 'NR==2{print $2}') | $(lsblk -no ROTA $(df --output=source $BASE_DIR | tail -1) | grep -q 0 && echo SSD || echo HDD)\";) &&\\\r\n  hyperfine \\\r\n  --sort command \\\r\n  --runs 3 \\\r\n  --export-json \"$BASE_DIR/assumeutxo-$(sed -E 's/(\\w{8})\\w+ ?/\\1-/g;s/-$//'<<<\"$COMMITS\")-$DBCACHE-$CC-$(date +%s).json\" \\\r\n  --parameter-list COMMIT ${COMMITS// /,} \\\r\n  --prepare \"killall -9 bitcoind 2>/dev/null; rm -rf $DATA_DIR/blocks $DATA_DIR/chainstate $DATA_DIR/chainstate_snapshot $DATA_DIR/debug.log; git clean -fxd; git reset --hard {COMMIT} && \\\r\n             cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=RelWithDebInfo && ninja -C build bitcoind bitcoin-cli -j2 && \\\r\n             ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=1 -printtoconsole=0; sleep 20 && \\\r\n             ./build/bin/bitcoind -datadir=$DATA_DIR -daemon -blocksonly -connect=0 -dbcache=$DBCACHE -printtoconsole=0; sleep 20\" \\\r\n   --conclude \"build/bin/bitcoin-cli -datadir=$DATA_DIR stop || true; killall bitcoind || true; sleep 10; \\\r\n               echo '{COMMIT} | dbcache=$DBCACHE | chainstate: $(find $DATA_DIR/chainstate_snapshot -type f 2>/dev/null | wc -l) files, $(du -sb $DATA_DIR/chainstate_snapshot 2>/dev/null | cut -f1) bytes' >> $DATA_DIR/debug.log; \\\r\n               cp $DATA_DIR/debug.log $LOG_DIR/debug-assumeutxo-{COMMIT}-dbcache-$DBCACHE-$(date +%s).log\" \\\r\n    \"COMPILER=$CC DBCACHE=$DBCACHE ./build/bin/bitcoin-cli -datadir=$DATA_DIR -rpcclienttimeout=0 loadtxoutset $UTXO_SNAPSHOT_PATH\"; \\\r\ndone\r\n\r\n595504a432 Merge bitcoin/bitcoin#34236: Add sedited to trusted-keys\r\n63e822b637 validation: make `IsInitialBlockDownload()` lock-free\r\n\r\nassumeutxo load | 910000 blocks | dbcache 4500 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | xfs | SSD\r\n\r\nBenchmark 1: COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 595504a43209bead162da54a204df7d140a25f0e)\r\n  Time (mean ± σ):     418.452 s ±  0.461 s    [User: 0.001 s, System: 0.001 s]\r\n  Range (min … max):   418.070 s … 418.964 s    3 runs\r\n \r\nBenchmark 2: COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 63e822b637f67242e3689adedc0155b34100e651)\r\n  Time (mean ± σ):     415.994 s ±  0.294 s    [User: 0.001 s, System: 0.001 s]\r\n  Range (min … max):   415.788 s … 416.330 s    3 runs\r\n \r\nRelative speed comparison\r\n        1.01 ±  0.00  COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 595504a43209bead162da54a204df7d140a25f0e)\r\n        1.00          COMPILER=gcc DBCACHE=4500 ./build/bin/bitcoin-cli -datadir=/mnt/my_storage/ShallowBitcoinData -rpcclienttimeout=0 loadtxoutset /mnt/my_storage/utxo-910000.dat (COMMIT = 63e822b637f67242e3689adedc0155b34100e651)\r\n```\r\n\r\n</details>\r\n\r\n<details>\r\n<summary>2026-01-12 | reindex-chainstate | 931139 blocks | dbcache 4500 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | SSD</summary>\r\n\r\n```\r\nfor DBCACHE in 4500; do \\                                                                                                                           \r\n  COMMITS=\"595504a43209bead162da54a204df7d140a25f0e 63e822b637f67242e3689adedc0155b34100e651\"; \\\r\n  STOP=931139; CC=gcc; CXX=g++; \\\r\n  BASE_DIR=\"/mnt/my_storage\"; DATA_DIR=\"$BASE_DIR/BitcoinData\"; LOG_DIR=\"$BASE_DIR/logs\"; \\\r\n  (echo \"\"; for c in $COMMITS; do git fetch -q origin $c && git log -1 --pretty='%h %s' $c || exit 1; done) && \\\r\n  (echo \"\" && echo \"$(date -I) | reindex-chainstate | ${STOP} blocks | dbcache ${DBCACHE} | $(hostname) | $(uname -m) | $(lscpu | grep 'Model name' | head -1 | cut -d: -f2 | xargs) | $(nproc) cores | $(free -h | awk '/^Mem:/{print $2}') RAM | SSD\"; echo \"\") &&\\\r\n  hyperfine \\\r\n    --sort command \\\r\n    --runs 1 \\\r\n    --export-json \"$BASE_DIR/rdx-$(sed -E 's/(\\w{8})\\w+ ?/\\1-/g;s/-$//'<<<\"$COMMITS\")-$STOP-$DBCACHE-$CC.json\" \\\r\n    --parameter-list COMMIT ${COMMITS// /,} \\\r\n    --prepare \"killall -9 bitcoind 2>/dev/null; rm -f $DATA_DIR/debug.log; git clean -fxd; git reset --hard {COMMIT} && \\\r\n      cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=Release -DENABLE_IPC=OFF && ninja -C build bitcoind -j1 && \\\r\n      ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=1000 -printtoconsole=0; sleep 20; rm -f $DATA_DIR/debug.log\" \\\r\n    --conclude \"killall bitcoind || true; sleep 5; grep -q 'height=0' $DATA_DIR/debug.log && grep -q 'Disabling script verification at block #1' $DATA_DIR/debug.log && grep -q 'height=$STOP' $DATA_DIR/debug.log; \\\r\n                cp $DATA_DIR/debug.log $LOG_DIR/debug-{COMMIT}-$(date +%s).log\" \\\r\n    \"COMPILER=$CC ./build/bin/bitcoind -datadir=$DATA_DIR -stopatheight=$STOP -dbcache=$DBCACHE -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0\";\r\ndone\r\n\r\n595504a432 Merge bitcoin/bitcoin#34236: Add sedited to trusted-keys\r\n63e822b637 validation: make `IsInitialBlockDownload()` lock-free\r\n\r\n2026-01-12 | reindex-chainstate | 931139 blocks | dbcache 4500 | i9-ssd | x86_64 | Intel(R) Core(TM) i9-9900K CPU @ 3.60GHz | 16 cores | 62Gi RAM | SSD\r\n\r\nBenchmark 1: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=931139 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 595504a43209bead162da54a204df7d140a25f0e)\r\n  Time (abs ≡):        17187.310 s               [User: 33104.415 s, System: 937.548 s]\r\n \r\nBenchmark 2: COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=931139 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 63e822b637f67242e3689adedc0155b34100e651)\r\n  Time (abs ≡):        17240.300 s               [User: 33164.803 s, System: 976.485 s]\r\n \r\nRelative speed comparison\r\n        1.00          COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=931139 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 595504a43209bead162da54a204df7d140a25f0e)\r\n        1.00          COMPILER=gcc ./build/bin/bitcoind -datadir=/mnt/my_storage/BitcoinData -stopatheight=931139 -dbcache=4500 -reindex-chainstate -blocksonly -connect=0 -printtoconsole=0 (COMMIT = 63e822b637f67242e3689adedc0155b34100e651)\r\n```\r\n\r\n</details>",
      "state": "closed",
      "user": "l0rinc",
      "created_at": "2026-01-11T15:15:32Z",
      "updated_at": "2026-01-29T11:33:12Z",
      "merged_at": "2026-01-29T10:51:49Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34253",
      "labels": [
        "Validation"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 8682,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2516937442,
      "number": 32482,
      "title": "build: add `-W*-whitespace`",
      "body": "GCC 15 now has options to turn leading & trailing whitespace into compile failures: https://gcc.gnu.org/gcc-15/changes.html#c-family. Fix the few cases of leading tabs, and trailing whitespace, and then enable `-Wleading-whitespace` and `-Wtrailing-whitespace`.\r\n\r\nWe currently get PRs that are opened with various whitespace, i.e #33822, so turning that into compile-time failure where possible, seems useful, to avoid a CI roundtrip.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-05-13T15:13:05Z",
      "updated_at": "2026-01-29T11:06:05Z",
      "merged_at": "2025-11-12T10:53:52Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/32482",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 463,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2058521539,
      "number": 30837,
      "title": "Add NODE_TXRELAY_V2.",
      "body": "This is the top commit from #30572, where the new node service bit support commit is extracted on its own.\r\n\r\nSee the corresponding BIP draft for motivation: https://github.com/bitcoin/bips/pull/1663\r\n\r\nDissociating this change from halting the processing of unrequested transaction, allow the node service bit support to be used for further policies and mechanisms, beyond this mechanism only.",
      "state": "closed",
      "user": "ariard",
      "created_at": "2024-09-06T18:46:30Z",
      "updated_at": "2026-01-29T11:03:43Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30837",
      "labels": [
        "CI failed"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 415,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2059282885,
      "number": 30844,
      "title": "RPC: improve SFFO arg parsing, error catching and coverage",
      "body": "Following changes were made:\r\n\r\n1) Catch and signal error for duplicate string destinations.\r\n2) Catch and signal error for invalid value type.\r\n3) Catch and signal error for string destination not found in tx outputs.\r\n4) Improved `InterpretSubtractFeeFromOutputInstructions()` code organization.\r\n5) Added test coverage for all possible error failures.\r\n\r\nAlso, fixed two PEP 8 warnings at the 'wallet_sendmany.py' file:\r\n- PEP 8: E302 expected 2 blank lines, found 1 at the SendmanyTest class declaration.\r\n- PEP 8: E303 too many blank lines (2) at skip_test_if_missing_module() and set_test_params()",
      "state": "closed",
      "user": "furszy",
      "created_at": "2024-09-07T16:37:34Z",
      "updated_at": "2026-01-29T11:03:42Z",
      "merged_at": "2025-01-29T21:33:22Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/30844",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 662,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2298278324,
      "number": 31736,
      "title": "doc: update links in ci.yml",
      "body": "Updated three outdated GitHub links to avoid redirects.\r\n",
      "state": "closed",
      "user": "espi3",
      "created_at": "2025-01-25T19:41:09Z",
      "updated_at": "2026-01-29T11:03:41Z",
      "merged_at": "2025-01-28T10:13:20Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31736",
      "labels": [
        "Docs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 85,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2300356658,
      "number": 31740,
      "title": "depends: Update libmultiprocess library before converting to subtree",
      "body": "This should be the final update to the libmultiprocess package via the depends system. It brings in the libmultiprocess cmake changes from https://github.com/chaincodelabs/libmultiprocess/pull/136 needed to support building as subtree. After this, followup PR #31741 will add libmultiprocess as a git subtree and depends will just use the git subtree instead of hardcoding its own version hash.\r\n\r\nSince there have been libmultiprocess API changes since the last update, this commit also updates bitcoin code to be compatible with them.\r\n\r\nThis update has the following new changes since previous update #31105:\r\n\r\nhttps://github.com/chaincodelabs/libmultiprocess/pull/121 ProxyClientBase: avoid static_cast to partially constructed object\r\nhttps://github.com/chaincodelabs/libmultiprocess/pull/120 proxy-types.h: add static_assert to detect int/enum size mismatch\r\nhttps://github.com/chaincodelabs/libmultiprocess/pull/127 ProxyClientBase: avoid static_cast to partially destructed object\r\nhttps://github.com/chaincodelabs/libmultiprocess/pull/129 Fix \"disconnected: write(m_post_fd, &buffer, 1): Broken pipe\" EventLoop shutdown races.\r\nhttps://github.com/chaincodelabs/libmultiprocess/pull/130 refactor: Add CleanupRun function to dedup clean list code\r\nhttps://github.com/chaincodelabs/libmultiprocess/pull/131 doc: fix startAsyncThread comment\r\nhttps://github.com/chaincodelabs/libmultiprocess/pull/133 Fix debian \"libatomic not found\" error in downstream builds\r\nhttps://github.com/chaincodelabs/libmultiprocess/pull/94 c++ 20 cleanups\r\nhttps://github.com/chaincodelabs/libmultiprocess/pull/135 refactor: proxy-types.h API cleanup\r\nhttps://github.com/chaincodelabs/libmultiprocess/pull/136 cmake: Support being included with add_subdirectory\r\nhttps://github.com/chaincodelabs/libmultiprocess/pull/137 doc: Fix broken markdown links\r\n",
      "state": "closed",
      "user": "ryanofsky",
      "created_at": "2025-01-27T16:46:29Z",
      "updated_at": "2026-01-29T11:03:40Z",
      "merged_at": "2025-01-29T12:10:36Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31740",
      "labels": [
        "Build system"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1907,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2303325782,
      "number": 31751,
      "title": "test: fix intermittent timeout in p2p_1p1c_network.py",
      "body": "The timeout is due to outstanding txrequests with python peers, which have the same timeout (`60s`) as the mempool sync timeout.\r\nI explained this in more detail in https://github.com/bitcoin/bitcoin/issues/31721#issuecomment-2620169640 and also mentioned there how to reproduce it.\r\n\r\nFix this by disconnecting the python peers after they send their txns, they aren't needed after this point anyway because the main goal of the test is the sync between the 4 full nodes.\r\n\r\nFixes #31721",
      "state": "closed",
      "user": "mzumsande",
      "created_at": "2025-01-28T22:24:46Z",
      "updated_at": "2026-01-29T11:03:39Z",
      "merged_at": "2025-01-29T23:07:40Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/31751",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 541,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3177081870,
      "number": 34303,
      "title": "test: addrman: test self-announcement time penalty handling",
      "body": "This PR adds a test case for addrman that verifies that addresses announcing themselves (addr == source) are exempt from time penalties, while addresses announced by others receive the expected penalty. \r\n\r\nIt fixes the following mutant (https://corecheck.dev/mutation/src/addrman.cpp#L561):\r\n```diff\r\ndiff --git a/src/addrman.cpp b/src/addrman.cpp\r\nindex 206b54118e..c6a045fd8d 100644\r\n--- a/src/addrman.cpp\r\n+++ b/src/addrman.cpp\r\n@@ -558,7 +558,7 @@ bool AddrManImpl::AddSingle(const CAddress& addr, const CNetAddr& source, std::c\r\n     AddrInfo* pinfo = Find(addr, &nId);\r\n\r\n     // Do not set a penalty for a source's self-announcement\r\n-    if (addr == source) {\r\n+    if (addr != source) {\r\n         time_penalty = 0s;\r\n     }\r\n```\r\n",
      "state": "closed",
      "user": "brunoerg",
      "created_at": "2026-01-15T12:07:32Z",
      "updated_at": "2026-01-29T10:43:23Z",
      "merged_at": "2026-01-28T22:37:39Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34303",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 800,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3196490786,
      "number": 34373,
      "title": "refactor: Remove remaining std::bind, check via clang-tidy",
      "body": "`std::bind` has many issues:\r\n\r\n* It is verbose in a meaningless way\r\n* Overriden args are silently accepted and dropped at runtime without a compile error. Same for accidental duplicates.\r\n\r\nOne could use `std::bind_front` similar to commit fa267551c4eaef577db92e248c4b6d31d0c8bc77. Though, I think the remaining cases are better off with lambdas.\r\n\r\nSo do that here, and enable the `modernize-avoid-bind` clang-tidy rule to avoid `std::bind` bugs in the future.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-21T19:14:44Z",
      "updated_at": "2026-01-29T10:35:40Z",
      "merged_at": "2026-01-29T09:51:03Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34373",
      "labels": [
        "Refactoring"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 522,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3193554767,
      "number": 34358,
      "title": "wallet: fix removeprunedfunds bug with conflicting transactions",
      "body": "`removeprunedfunds` removes all entries from `mapTxSpends` for the inputs of the pruned tx. However, this is incorrect, because there could be multiple entries from conflicting transactions (that shouldn't be removed as well). This could lead to the wallet creating invalid transactions, trying to double spend utxos.\r\nThe bug persists when the conflicting tx was mined, because the wallet trusts its internal accounting instead of calling `AddToSpends` again.\r\n\r\nThe added test should fail on master.",
      "state": "closed",
      "user": "mzumsande",
      "created_at": "2026-01-21T02:40:34Z",
      "updated_at": "2026-01-29T10:03:02Z",
      "merged_at": "2026-01-28T19:25:39Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34358",
      "labels": [
        "Wallet"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 565,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3210330346,
      "number": 34409,
      "title": "test: use `ModuleNotFoundError` in `interface_ipc.py`",
      "body": "Change this so we catch the case where the capnp shared libs have been updated, and can no-longer be loaded by the Python module, resulting in a skipped test, even though pycapnp is installed. i.e:\r\n```bash\r\nstderr:\r\nTraceback (most recent call last):\r\n  File \"/root/ci_scratch/build/test/functional/interface_ipc.py\", line 20, in <module>\r\n    import capnp  # type: ignore[import] # noqa: F401\r\n    ^^^^^^^^^^^^\r\n  File \"/usr/local/lib64/python3.14/site-packages/capnp/__init__.py\", line 36, in <module>\r\n    from .version import version as __version__\r\n  File \"/usr/local/lib64/python3.14/site-packages/capnp/version.py\", line 1, in <module>\r\n    from .lib.capnp import _CAPNP_VERSION_MAJOR as LIBCAPNP_VERSION_MAJOR  # noqa: F401\r\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nImportError: libcapnpc.so.1.0.1: cannot open shared object file: No such file or directory\r\n```\r\n\r\nFailing in this way should make it clear that `pycapnp` needs to be reinstalled/rebuilt.\r\n\r\nIf  `pycapnp` is not installed, the test still skips as expected:\r\n```bash\r\nRemaining jobs: [interface_ipc.py]\r\n1/1 - interface_ipc.py skipped (capnp module not available.)\r\n\r\nTEST             | STATUS    | DURATION\r\n\r\ninterface_ipc.py | ○ Skipped | 0 s\r\n```\r\n\r\nFixes: #34016.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-01-26T11:58:41Z",
      "updated_at": "2026-01-29T09:41:36Z",
      "merged_at": "2026-01-28T18:06:27Z",
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34409",
      "labels": [
        "Tests"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1330,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3177133582,
      "number": 34305,
      "title": "log: correct size output in disk space check",
      "body": "The output should be the additional space needed, otherwise we are always warning that 810GB will be stored, even when a user is pruning.\r\n\r\nFor example on machine with ~20GB free disk, pruning to 40GB:\r\n```bash\r\n./build/bin/bitcoind -prune=40000\r\n...\r\n2026-01-15T11:45:33Z [warning] Disk space for \"/root/.bitcoin/blocks\" may not accommodate the block files. Approximately 810 GB of data will be stored in this directory.\r\nWarning: Disk space for \"/root/.bitcoin/blocks\" may not accommodate the block files. Approximately 810 GB of data will be stored in this directory.\r\n```\r\n\r\nThis PR:\r\n```bash\r\n./build/bin/bitcoind -prune=40000\r\n...\r\n2026-01-15T11:41:49Z [warning] Disk space for \"/root/.bitcoin/blocks\" may not accommodate the block files. Approximately 39 GB of data will be stored in this directory.\r\nWarning: Disk space for \"/root/.bitcoin/blocks\" may not accommodate the block files. Approximately 39 GB of data will be stored in this directory.\r\n```",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2026-01-15T12:26:05Z",
      "updated_at": "2026-01-29T09:41:31Z",
      "merged_at": null,
      "comments": 0,
      "review_comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/pull/34305",
      "labels": [
        "Utils/log/libs"
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1005,
        "has_nack": false,
        "has_ack": false
      }
    }
  ],
  "issues": [
    {
      "id": 3900215683,
      "number": 34509,
      "title": "test: Replace hardcoded time.sleep() with smart polling",
      "body": "### Please describe the feature you'd like to see added.\n\nFound several hardcoded `time.sleep()` calls in functional tests that waste CI time:\n\n- `wallet_encryption.py:55` - always sleeps 3s for timeout test\n- `p2p_leak.py:139` - sleeps 5s waiting for peer timeout  \n- `feature_dbcrash.py:96` - 1s sleep in crash recovery\n- Framework sync functions default to 1s waits\n\nThese add up to significant overhead. For example, the wallet test could poll the wallet lock state instead of waiting 3 full seconds.\n\nProposal: Replace with `wait_until()` pattern already used elsewhere in the codebase. Should save 30+ minutes on full test runs.\n\nHappy to work on this if there's interest.\n\n### Is your feature related to a problem, if so please describe it.\n\nFound several hardcoded time.sleep() calls in functional tests that waste CI time:\n\n- wallet_encryption.py:55 - always sleeps 3s for timeout test\n- p2p_leak.py:139 - sleeps 5s waiting for peer timeout  \n- feature_dbcrash.py:96 - 1s sleep in crash recovery\n- Framework sync functions default to 1s waits\n\nThese add up to significant overhead across the test suite. The wallet test could poll the wallet lock state instead of waiting 3 full seconds every time.\n\n### Describe the solution you'd like\n\nReplace hardcoded sleeps with the wait_until() pattern already used elsewhere in the codebase. \n\nFor example, instead of time.sleep(3) in the wallet test, poll the wallet lock status until the condition is met (with a timeout for safety).\n\nShould save 30+ minutes on full test runs while maintaining the same reliability.\n\n### Describe any alternatives you've considered\n\nConsidered leaving things as it is, but the time waste is noticeable during development. Could also just reduce the hardcoded values, but smart polling is more robust.\n\n### Please leave any additional context\n\nHappy to implement this if there's interest. The wait_until() pattern is already used throughout the test framework, so this would just be applying it more consistently.",
      "state": "open",
      "user": "Hijanhv",
      "created_at": "2026-02-05T07:59:19Z",
      "updated_at": "2026-02-05T08:19:04Z",
      "closed_at": null,
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34509",
      "labels": [
        "Feature"
      ],
      "comment_data": [
        {
          "id": 3851779857,
          "user": "maflcko",
          "body": "> `feature_dbcrash.py:96` - 1s sleep in crash recovery\n\nYeah, I guess it could be cleaner code to wait on the Popen object\n\n\n\n\n> Proposal: Replace with `wait_until()` pattern already used elsewhere in the codebase. Should save 30+ minutes on full test runs.\n\nidk, this is just ai llm slop? The full test run takes less than 30 minutes, so this can't possibly make the tests pass in negative time.",
          "created_at": "2026-02-05T08:19:04Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 396,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2054,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3885262280,
      "number": 34476,
      "title": "Private broadcast tracking",
      "body": "_A meta issue to track the pull requests related to private broadcast_\n\n# Initial\n* 🪓 🔥 ⛔ First attempt that tried to put the transaction in the mempool ([#27509](https://github.com/bitcoin/bitcoin/pull/27509))\n* 🟢 ✔️ 🥳 Implement the ability to broadcast a transaction via a short lived privacy connection and use that for the `sendrawtransaction` RPC ([#29415](https://github.com/bitcoin/bitcoin/pull/29415))\n\n# Followups and extensions\n\n## Wallet\n\n* [ ] https://github.com/bitcoin/bitcoin/pull/33671\n* [ ] https://github.com/bitcoin/bitcoin/pull/34359\n* [ ] https://github.com/bitcoin/bitcoin/pull/34457\n\n## Other\n\n* [ ] https://github.com/bitcoin/bitcoin/pull/34329\n* [ ] https://github.com/bitcoin/bitcoin/pull/34322\n\n# Fixes and improvements\n\n* [x] https://github.com/bitcoin/bitcoin/pull/34300\n* [x] https://github.com/bitcoin/bitcoin/pull/34267\n* [ ] https://github.com/bitcoin/bitcoin/pull/34410\n* [ ] https://github.com/bitcoin/bitcoin/pull/34271\n",
      "state": "open",
      "user": "vasild",
      "created_at": "2026-02-02T10:49:23Z",
      "updated_at": "2026-02-04T18:32:24Z",
      "closed_at": null,
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34476",
      "labels": [
        "Tracking Issue"
      ],
      "comment_data": [
        {
          "id": 3849088794,
          "user": "Crypt-iQ",
          "body": "Looks like the private broadcast changes introduced non-determinism in the process_message(s) fuzz harnesses. They re-use the same `Connman` across iterations, and the `m_outbound_tor_ok_at_least_once` may have already been flipped true by a previous iteration. The non-determinism shows up here: https://github.com/bitcoin/bitcoin/blob/d4bc620ad8cf6b7975be55d5ae27dc943cceef3f/src/net.cpp#L4066-L4071\n\nIdeally, this check would not be hit if private broadcast is disabled?",
          "created_at": "2026-02-04T18:32:24Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 473,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 983,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2181716748,
      "number": 29635,
      "title": "valgrind: Conditional jump or move depends on uninitialised value(s)",
      "body": "I see this issue with latest master using Clang 17.0.6 on aarch64, and running the functional tests under Valgrind (3.22.0):\r\n```bash\r\n node0 stderr ==75935== Thread 25 b-msghand:\r\n==75935== Conditional jump or move depends on uninitialised value(s)\r\n==75935==    at 0x1955B8: _M_reset (optional:313)\r\n==75935==    by 0x1955B8: ~_Optional_payload (optional:437)\r\n==75935==    by 0x1955B8: ~_Optional_base (optional:508)\r\n==75935==    by 0x1955B8: GetLocalAddress(CNode const&) (???:220)\r\n==75935==    by 0x1956A3: GetLocalAddrForPeer(CNode&) (net.cpp:240)\r\n==75935==    by 0x1D091F: MaybeSendAddr (net_processing.cpp:5259)\r\n==75935==    by 0x1D091F: (anonymous namespace)::PeerManagerImpl::SendMessages(CNode*) (???:5453)\r\n==75935==    by 0x1AA183: CConnman::ThreadMessageHandler() (net.cpp:2886)\r\n==75935==    by 0x750627: operator() (std_function.h:591)\r\n==75935==    by 0x750627: util::TraceThread(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>) (???:21)\r\n==75935==    by 0x1B290F: __invoke_impl<void, void (*)(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>), const char *, (lambda at net.cpp:3231:71)> (invoke.h:61)\r\n==75935==    by 0x1B290F: __invoke<void (*)(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>), const char *, (lambda at net.cpp:3231:71)> (invoke.h:96)\r\n==75935==    by 0x1B290F: _M_invoke<0UL, 1UL, 2UL> (std_thread.h:292)\r\n==75935==    by 0x1B290F: operator() (std_thread.h:299)\r\n==75935==    by 0x1B290F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_5> > >::_M_run() (std_thread.h:244)\r\n==75935==    by 0x4C501BF: execute_native_thread_routine (thread.cc:104)\r\n==75935==    by 0x4F85E37: start_thread (pthread_create.c:447)\r\n==75935==    by 0x4FF0E5B: thread_start (clone.S:79)\r\n==75935== \r\n{\r\n   <insert_a_suppression_name_here>\r\n   Memcheck:Cond\r\n   fun:_M_reset\r\n   fun:~_Optional_payload\r\n   fun:~_Optional_base\r\n   fun:_Z15GetLocalAddressRK5CNode\r\n   fun:_Z19GetLocalAddrForPeerR5CNode\r\n   fun:MaybeSendAddr\r\n   fun:_ZN12_GLOBAL__N_115PeerManagerImpl12SendMessagesEP5CNode\r\n   fun:_ZN8CConnman20ThreadMessageHandlerEv\r\n   fun:operator()\r\n   fun:_ZN4util11TraceThreadESt17basic_string_viewIcSt11char_traitsIcEESt8functionIFvvEE\r\n   fun:__invoke_impl<void, void (*)(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>), const char *, (lambda at net.cpp:3231:71)>\r\n   fun:__invoke<void (*)(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>), const char *, (lambda at net.cpp:3231:71)>\r\n   fun:_M_invoke<0UL, 1UL, 2UL>\r\n   fun:operator()\r\n   fun:_ZNSt6thread11_State_implINS_8_InvokerISt5tupleIJPFvSt17basic_string_viewIcSt11char_traitsIcEESt8functionIFvvEEEPKcZN8CConnman5StartER10CSchedulerRKNSE_7OptionsEE3$_5EEEEE6_M_runEv\r\n   fun:execute_native_thread_routine\r\n   fun:start_thread\r\n   fun:thread_start\r\n}\r\n==75935== \r\n==75935== Exit program on first error (--exit-on-first-error=yes)\r\n```\r\n\r\nBisected to #28078 being the cause.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2024-03-12T14:07:39Z",
      "updated_at": "2026-02-04T17:03:28Z",
      "closed_at": null,
      "comments": 27,
      "url": "https://github.com/bitcoin/bitcoin/issues/29635",
      "labels": [
        "Tests",
        "Upstream"
      ],
      "comment_data": [
        {
          "id": 3848648182,
          "user": "maflcko",
          "body": "> I think this is hopeless, even with `-O1`, using the following diff, it fails.\n\nAlso, the min required clang version is now 17, so using clang-16 requires workarounds itself.\n\nAlso, the upstream bug report hasn't had activity in about 2 years.",
          "created_at": "2026-02-04T17:03:28Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 245,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 3243,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2966945793,
      "number": 32201,
      "title": "BIP32: Maximal length of derivation paths and depth of extended keys",
      "body": "Hi folks,\nI have started to notice and report an overflow of the depth of extended keys (as described in BIP32) and some confusion regarding the depth came up. On one hand, the depth is, I'd say indirectly, limited to the range [0 , 255] due to the serialization into a [single byte](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki#serialization-format). On the other hand, I don't see an inherent technical reason(s) that would prevent deriving even _lower_ keys (with depth 255+).\n\nThe list of libraries, where I see the depth overflowing is increasing:  https://github.com/libbitcoin/libbitcoin-system/pull/1624, https://github.com/bitcoinj/bitcoinj/pull/3693, https://github.com/tyler-smith/go-bip32/issues/27, https://github.com/MetacoSA/NBitcoin/issues/1260, https://github.com/piotrnar/gocoin/issues/71,...\n\nIn bitcoin repository, the overflow is caught [here](https://github.com/bitcoin/bitcoin/blob/639279e86a6edd6cb68e8cf077d14337bcd13959/src/key.cpp#L360) (and also [here](https://github.com/bitcoin/bitcoin/blob/639279e86a6edd6cb68e8cf077d14337bcd13959/src/pubkey.cpp#L407)) and there is also a [test case](https://github.com/bitcoin/bitcoin/blob/449e2eb7e40f7e14300af92bce8e70a9fde91e1b/src/test/bip32_tests.cpp#L187-L203) for it. But the [derivation paths](https://github.com/bitcoin/bitcoin/blob/449e2eb7e40f7e14300af92bce8e70a9fde91e1b/src/util/bip32.cpp#L18) themselves aren't restricted in the size. Due to the variety of implementations and libraries APIs' for the derivation paths and key derivation (priv -> priv, priv -> pub, pub -> pub), there are also a few different ways how to possibly hit the overflow.\n\nKeys that overflow could be _hiding_ coins (as they would appear to live at different levels), but the valid parents are likely still identifiable via the fingerprints. (Possibly, in some edge-cases, overflown keys could be invalid in such a way that the coins would get locked.) I am not familiar with how the depth is used later on, e.g., after key deserialization, and if it could cause other issues.\n\nAre there any legitimate reasons to allow longer paths and keys with depth > 255? Or shall any such overflow be considered a bug? Not sure, if I can tag Pieter Wuille, to get his thoughts regarding the depth validity and if there is more to it.",
      "state": "open",
      "user": "quapka",
      "created_at": "2025-04-02T16:20:19Z",
      "updated_at": "2026-02-04T14:21:30Z",
      "closed_at": null,
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/32201",
      "labels": [
        "Bug",
        "Questions and Help"
      ],
      "comment_data": [
        {
          "id": 3847251595,
          "user": "quapka",
          "body": "@sipa any thoughts on this?\n\nOn a related note, the specification itself [advices](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki?plain=1#L81) to increment `i` in certain edge-cases, which _in very rare_ cases could lead to overflow of the index from non-hardened variant to the hardened one (and vice versa).\n\nTreating of the index as an integer that can be incremented lead to buggy API in [NBitcoin](https://github.com/MetacoSA/NBitcoin/issues/1259).",
          "created_at": "2026-02-04T12:47:39Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 469,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3847331033,
          "user": "sipa",
          "body": "You're right that there is no inherent reason why the depth should be limited to 255, but for interoperability I think it's better to set a hard limit, and treat deriving to a higher depth as incorrect usage. I'll amend the BIP to include a note about this.\n\n> On a related note, the specification itself [advices](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki?plain=1#L81) to increment i in certain edge-cases, which in very rare cases could lead to overflow of the index from non-hardened variant to the hardened one (and vice versa).\n\nI'm not worried about this, as the increment case is practically unreachable (for secp256k1, it has a chance of 0.63538*2^-127 per derivation). If you're doing enough derivations that you have a non-negligible probability of hitting this, you also have enough computation power to break ECDLP.",
          "created_at": "2026-02-04T13:02:31Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 848,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3847753068,
          "user": "quapka",
          "body": "> for interoperability I think it's better to set a hard limit\n\nI agree, the potential interoperability issues motivated me in the first place.\n\n> I'll amend the BIP to include a note about this.\n\nThanks. While many implementors have updated their code anyway, there are [some](https://github.com/bitcoinjs/bip32/issues/92) that would do it only if the specs were updated. Can you also add (failing) test vectors?",
          "created_at": "2026-02-04T14:21:29Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 413,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2365,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3896240331,
      "number": 34503,
      "title": "validation: CheckBlockIndex() const: Assertion '!c->setBlockIndexCandidates.contains(const_cast<CBlockIndex*>(pindex))' failed",
      "body": "[This](https://github.com/bitcoin/bitcoin/blob/eb3dbbaf30fc072fef78f57064abc744aa9c0516/src/validation.cpp#L5391) assertion in `CheckBlockIndex` may fail under certain block race and shutdown/restart conditions (see attached example log).\n\nThe root cause appears to be the modification of the `nSequenceId` field of `CBlockIndex` pointers, after they have been added to `setBlockIndexCandidates`. This is undefined behavior as the `CBlockIndexWorkComparator` compares `nSequenceId`s.\n\nSpecifically, [here](https://github.com/bitcoin/bitcoin/blob/eb3dbbaf30fc072fef78f57064abc744aa9c0516/src/validation.cpp#L4617-L4627) the tip's (and ancestor) sequence ids are changed while all the indices are in the candidates set already.\n\n[setBlockIndexCandidates_contains.log](https://github.com/user-attachments/files/25071337/setBlockIndexCandidates_contains.log)\n\n*This was found with a test running on [Antithesis](https://antithesis.com/).*",
      "state": "open",
      "user": "dergoegge",
      "created_at": "2026-02-04T12:11:16Z",
      "updated_at": "2026-02-04T12:18:42Z",
      "closed_at": null,
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/34503",
      "labels": [],
      "comment_data": [
        {
          "id": 3847084157,
          "user": "dergoegge",
          "body": "@marcofleon is working on a fix",
          "created_at": "2026-02-04T12:11:25Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 31,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3847101521,
          "user": "dergoegge",
          "body": "Looks like this was introduced by https://github.com/bitcoin/bitcoin/pull/29640",
          "created_at": "2026-02-04T12:15:22Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 79,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3847115849,
          "user": "maflcko",
          "body": "I guess this is https://github.com/bitcoin/bitcoin/issues/33948, which I had difficulties reproducing. So thanks for making this reproducible!",
          "created_at": "2026-02-04T12:18:42Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 142,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1061,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3490744262,
      "number": 33556,
      "title": "build: `libcapnp*.so` \"warning: GCS is required by -z gcs, but this shared library lacks the necessary property note.\"",
      "body": "Building master (919e6d01e93a57d991ed456bc67c43605583ada8) in a Ubuntu 25.10 container (on aarch64), I see:\n```bash\n[  1%] Linking CXX executable mpgen\n/usr/lib/aarch64-linux-gnu/libcapnp-rpc-1.1.0.so: warning: GCS is required by -z gcs, but this shared library lacks the necessary property note. The dynamic loader might not enable GCS or refuse to load the program unless all the shared library dependencies have the GCS marking.\n/usr/lib/aarch64-linux-gnu/libcapnpc-1.1.0.so: warning: GCS is required by -z gcs, but this shared library lacks the necessary property note. The dynamic loader might not enable GCS or refuse to load the program unless all the shared library dependencies have the GCS marking.\n/usr/lib/aarch64-linux-gnu/libcapnp-1.1.0.so: warning: GCS is required by -z gcs, but this shared library lacks the necessary property note. The dynamic loader might not enable GCS or refuse to load the program unless all the shared library dependencies have the GCS marking.\n/usr/lib/aarch64-linux-gnu/libkj-async-1.1.0.so: warning: GCS is required by -z gcs, but this shared library lacks the necessary property note. The dynamic loader might not enable GCS or refuse to load the program unless all the shared library dependencies have the GCS marking.\n/usr/lib/aarch64-linux-gnu/libkj-1.1.0.so: warning: GCS is required by -z gcs, but this shared library lacks the necessary property note. The dynamic loader might not enable GCS or refuse to load the program unless all the shared library dependencies have the GCS marking.\n[  1%] Built target mpgen\n...\n[  2%] Linking CXX executable mptest\n/usr/lib/aarch64-linux-gnu/libkj-test-1.1.0.so: warning: GCS is required by -z gcs, but this shared library lacks the necessary property note. The dynamic loader might not enable GCS or refuse to load the program unless all the shared library dependencies have the GCS marking.\n/usr/lib/aarch64-linux-gnu/libcapnp-rpc-1.1.0.so: warning: GCS is required by -z gcs, but this shared library lacks the necessary property note. The dynamic loader might not enable GCS or refuse to load the program unless all the shared library dependencies have the GCS marking.\n/usr/lib/aarch64-linux-gnu/libcapnp-1.1.0.so: warning: GCS is required by -z gcs, but this shared library lacks the necessary property note. The dynamic loader might not enable GCS or refuse to load the program unless all the shared library dependencies have the GCS marking.\n/usr/lib/aarch64-linux-gnu/libkj-async-1.1.0.so: warning: GCS is required by -z gcs, but this shared library lacks the necessary property note. The dynamic loader might not enable GCS or refuse to load the program unless all the shared library dependencies have the GCS marking.\n/usr/lib/aarch64-linux-gnu/libkj-1.1.0.so: warning: GCS is required by -z gcs, but this shared library lacks the necessary property note. The dynamic loader might not enable GCS or refuse to load the program unless all the shared library dependencies have the GCS marking.\n[  2%] Built target mptest\n[  2%] Built target mptests\n```\nGCS is Guarded Control Stack: https://www.kernel.org/doc/html/next/arch/arm64/gcs.html.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-10-07T09:44:02Z",
      "updated_at": "2026-02-04T11:35:38Z",
      "closed_at": "2026-02-04T11:35:33Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/33556",
      "labels": [
        "Build system",
        "Upstream"
      ],
      "comment_data": [
        {
          "id": 3846922661,
          "user": "fanquake",
          "body": "This still produces on `25.10`, but I don't see this with `26.04`. Will close for now, as this at least wont cause issues if/when the CI is moved to `26.04`.",
          "created_at": "2026-02-04T11:35:33Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 157,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3255,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3014072617,
      "number": 32331,
      "title": "cmake: GUI build broken with `-stdlib=libc++`",
      "body": "```bash\nmaster @ 9a4c92eb9ac29204df3d826f5ae526ab16b8ad65\nclang version 20.1.2 (Fedora 20.1.2-3.fc42)\ncmake -B build -DBUILD_GUI=ON -DAPPEND_CXXFLAGS=\"-stdlib=libc++\" -DAPPEND_LDFLAGS=\"-stdlib=libc++\"\ncmake --build build\n<snip>\ncmake --build build -j17 --target bitcoin-qt\n[  0%] Generating bitcoin-build-info.h\n[  0%] Built target secp256k1_precomputed\n[  0%] Built target crc32c\n[  1%] Built target bitcoin_consensus\n[  3%] Built target bitcoin_cli\n[  4%] Built target univalue\n[  7%] Built target minisketch\n[  7%] Built target secp256k1\n[ 12%] Built target bitcoin_crypto\n[ 20%] Built target leveldb\n[ 20%] Built target generate_build_info\n[ 20%] Built target bitcoin_clientversion\n[ 32%] Built target bitcoin_util\n[ 32%] Built target bitcoin_wallet\n[ 32%] Built target bitcoinqt_autogen_timestamp_deps\n[ 43%] Built target bitcoin_common\n[ 44%] Built target bitcoinqt_autogen\n[ 63%] Built target bitcoin_node\n[100%] Built target bitcoinqt\n[100%] Built target bitcoin-qt_autogen_timestamp_deps\n[100%] Built target bitcoin-qt_autogen\n[100%] Linking CXX executable ../../bin/bitcoin-qt\n/usr/bin/ld: CMakeFiles/bitcoin-qt.dir/main.cpp.o: in function `std::__1::__function::__func<$_0, std::__1::allocator<$_0>, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > (char const*)>::operator()(char const*&&)':\n/usr/include/x86_64-linux-gnu/qt6/QtCore/qstring.h:1477:(.text+0x18f): undefined reference to `QByteArray::toStdString() const'\n/usr/bin/ld: ../../lib/libbitcoinqt.a(bitcoin.cpp.o): in function `QString::toStdString() const':\n/usr/include/x86_64-linux-gnu/qt6/QtCore/qstring.h:1477:(.text+0x3b): undefined reference to `QByteArray::toStdString() const'\n/usr/bin/ld: /usr/include/x86_64-linux-gnu/qt6/QtCore/qstring.h:1477:(.text+0xe0): undefined reference to `QByteArray::toStdString() const'\n/usr/bin/ld: ../../lib/libbitcoinqt.a(bitcoin.cpp.o): in function `BitcoinApplication::createOptionsModel(bool)':\n/usr/include/x86_64-linux-gnu/qt6/QtCore/qstring.h:1477:(.text+0xc86): undefined reference to `QByteArray::toStdString() const'\n/usr/bin/ld: ../../lib/libbitcoinqt.a(bitcoin.cpp.o): in function `initTranslations(QTranslator&, QTranslator&, QTranslator&, QTranslator&)':\n/usr/include/x86_64-linux-gnu/qt6/QtCore/qstring.h:1477:(.text+0x5ab2): undefined reference to `QByteArray::toStdString() const'\n/usr/bin/ld: ../../lib/libbitcoinqt.a(bitcoingui.cpp.o):/usr/include/x86_64-linux-gnu/qt6/QtCore/qstring.h:1477: more undefined references to `QByteArray::toStdString() const' follow\nclang++: error: linker command failed with exit code 1 (use -v to see invocation)\n```",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-04-23T13:41:23Z",
      "updated_at": "2026-02-04T11:28:50Z",
      "closed_at": "2026-02-04T11:28:50Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/32331",
      "labels": [
        "GUI",
        "Build system",
        "Upstream"
      ],
      "comment_data": [
        {
          "id": 3846893998,
          "user": "fanquake",
          "body": "Closing for now. I'm not planning on investigating / debugging this any further.",
          "created_at": "2026-02-04T11:28:50Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 80,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2661,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3069421158,
      "number": 32536,
      "title": "cmake: Cannot find Qt 6 on SunOS / illumos (OpenIndiana Distribution)",
      "body": "Qt 6 was installed as follows:\n```\n$ sudo pkg install library/qt6\n```\n\nAs a workaround, the `Qt6_DIR` CMake variable can be set manually:\n```\n$ cmake -B build -DBUILD_GUI=ON -DQt6_DIR=/usr/lib/qt/6.6/lib/amd64/cmake/Qt6\n```\n\nAlternatively, the [`Qt6_ROOT`](https://cmake.org/cmake/help/latest/variable/PackageName_ROOT.html) CMake or [environment](https://cmake.org/cmake/help/latest/envvar/PackageName_ROOT.html) variable can be used:\n```\n$ env Qt6_ROOT=/usr/lib/qt/6.6/lib/amd64 cmake -B build -DBUILD_GUI=ON\n```\n\nMoved from https://github.com/hebasto/bitcoin/issues/234.",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2025-05-16T16:22:20Z",
      "updated_at": "2026-02-04T11:28:12Z",
      "closed_at": "2026-02-04T11:28:12Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/32536",
      "labels": [
        "Brainstorming",
        "GUI",
        "Build system"
      ],
      "comment_data": [
        {
          "id": 3846883137,
          "user": "fanquake",
          "body": "> Are there any known users on this platform? Maybe this can be closed for now, until there are a few users.\n\nYea, I think we can do that. Especially if nobody in this repo is using this platform, or working on a fix, or reporting this issue upstream (for clarification), or upstreaming a fix.",
          "created_at": "2026-02-04T11:26:18Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 293,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 643,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3486857012,
      "number": 33548,
      "title": "`test_bitcoin-qt`: segfault under LTO (CMAKE_INTERPROCEDURAL_OPTIMIZATION=ON)",
      "body": "```bash\npodman run -it ubuntu:24.04\napt install git build-essential cmake pkgconf python3 libevent-dev libboost-dev qt6-base-dev qt6-tools-dev qt6-l10n-tools qt6-tools-dev-tools libgl-dev libqrencode-dev\ngit clone https://github.com/bitcoin/bitcoin/\ncd bitcoin\n```\n```bash\ncmake -B build -DENABLE_IPC=OFF -DBUILD_GUI=ON -DENABLE_WALLET=OFF\ncmake --build build\nctest --test-dir build # works fine\n```\n\n```bash\n### Enable LTO\ncmake -B build -DENABLE_IPC=OFF -DBUILD_GUI=ON -DENABLE_WALLET=OFF -DCMAKE_INTERPROCEDURAL_OPTIMIZATION=ON\ncmake --build build\nctest --test-dir build\n...\nThe following tests FAILED:\n\t  6 - test_bitcoin-qt (SEGFAULT)\n```\n```bash\nbuild/bin/test_bitcoin-qt\nSegmentation fault (core dumped)\n```\n```bash\ngdb build/bin/test_bitcoin-qt\n...\nProgram received signal SIGSEGV, Segmentation fault.\n0x000079e008f7bafa in ?? () from /lib/x86_64-linux-gnu/libQt6Core.so.6\n(gdb) bt\n#0  0x000079e008f7bafa in ?? () from /lib/x86_64-linux-gnu/libQt6Core.so.6\n#1  0x000079e0095b3844 in QGuiApplication::screenAdded(QScreen*) () from /lib/x86_64-linux-gnu/libQt6Gui.so.6\n#2  0x000079e0096024a6 in QWindowSystemInterface::handleScreenAdded(QPlatformScreen*, bool) () from /lib/x86_64-linux-gnu/libQt6Gui.so.6\n#3  0x000079e005856a13 in ?? () from /usr/lib/x86_64-linux-gnu/qt6/plugins/platforms/libqminimal.so\n#4  0x000079e0095ac142 in QGuiApplicationPrivate::createPlatformIntegration() () from /lib/x86_64-linux-gnu/libQt6Gui.so.6\n#5  0x000079e0095ad860 in QGuiApplicationPrivate::createEventDispatcher() () from /lib/x86_64-linux-gnu/libQt6Gui.so.6\n#6  0x000079e008f348b6 in QCoreApplicationPrivate::init() () from /lib/x86_64-linux-gnu/libQt6Core.so.6\n#7  0x000079e0095ad8ff in QGuiApplicationPrivate::init() () from /lib/x86_64-linux-gnu/libQt6Gui.so.6\n#8  0x000079e009ccc985 in QApplicationPrivate::init() () from /lib/x86_64-linux-gnu/libQt6Widgets.so.6\n#9  0x00005b7f77cb9cff in BitcoinApplication::BitcoinApplication (this=<optimized out>, this=<optimized out>) at .././qt/bitcoin.cpp:201\n#10 0x00005b7f77c6ee8b in main (argc=<optimized out>, argv=<optimized out>) at ./qt/test/test_main.cpp:78\n```",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-10-06T11:36:32Z",
      "updated_at": "2026-02-04T11:20:18Z",
      "closed_at": "2026-02-04T11:20:18Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/issues/33548",
      "labels": [
        "Bug",
        "Build system",
        "Upstream"
      ],
      "comment_data": [
        {
          "id": 3846856606,
          "user": "fanquake",
          "body": "Looks like it. We can leave these compiler / qt combos as known broken.",
          "created_at": "2026-02-04T11:20:18Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 71,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 2187,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3893710679,
      "number": 34497,
      "title": "[rfc] Disallow loading and creating wallets by paths",
      "body": "A discussion that has come up several times at the Localhost office over the past several weeks has been whether it makes sense to load wallets by paths. In particular, supporting wallets by path has been the source of a couple issues, and has also had some involvement in the recent wallet deletion issue.\n\nFor some background, the name of a wallet can always be interpreted as a path. If it is not an absolute path, then it is a path relative to the wallets directory, e.g. a wallet named `mywallet` is always located at `<walletsdir>/mywallet`. But when referring to wallets named by relative path, I mean wallets which actually include `/` in their name which turns the name into a path specifier, rather than a logical name that happens to map to a path relative to the walletsdir. Otherwise, the path is an absolute path. An important note is that with the exception of BDB files stored directly in the walletsdir, the file actually opened is always `<path>/wallet.dat`.\n\nFor absolute paths, this seems mostly ok, if just a bit odd. This has the potential to be problematic when mixing wallet names with filenames and paths. However, I don't recall any specific issues with absolute paths off the top of my head.\n\nOn the other hand, relative paths that include additional directories (e.g.` <walletdir>/<subdir>/mywallet` or `../<more path>/mywallet`) have been a major source of headaches in wallet filesystem code:\n- #32273 pointed out a flaw in how wallet names and paths were being combined in relative paths to produce nonsensical paths\n- The root issue in #31409 is searching subdirectories for additional wallets to have their name by relative path\n\nFurthermore, from a user perspective, relative path wallets are really weird in that the path is relative to the walletsdir, which itself is not always consistent relative to the datadir (excluding when set explicitly). Given that the actual location of the walletsdir is basically never surfaced to the user, I don't really see any situation where a user would want to name a wallet `../<path>`. I can see `<sub>/mywallet`, but that really doesn't need to be a path, and the wallet could actually be in a directory named `<sub>/mywallet` where the `/` is escaped so it doesn't become a path.\n\nI propose that we should remove support for wallets with by relative path, but retain support for wallets by absolute path.\n\nBut I'd like to get some feedback from contributors and users before moving forward with this.\n\n***\n\nThere has also been the suggestion that we should go all the way and just remove support for both relative and absolute paths. I push back on this a bit as I think absolute paths can still be useful, e.g. if a user has wallets both in the walletsdir and on external media, they could want to load wallets from both locations at the same time without needing to change the walletsdir by specifying wallets by absolute path. However, I am open to being convinced that remove absolute path support could be a good idea.",
      "state": "open",
      "user": "achow101",
      "created_at": "2026-02-03T23:20:47Z",
      "updated_at": "2026-02-04T09:34:56Z",
      "closed_at": null,
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34497",
      "labels": [
        "Wallet",
        "Needs Conceptual Review"
      ],
      "comment_data": [
        {
          "id": 3846345031,
          "user": "sobitkarki1",
          "body": "We should remove support for wallets by relative path, but retain support for wallets by absolute path. That's the way to go.",
          "created_at": "2026-02-04T09:34:56Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 125,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 3052,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2661291513,
      "number": 31293,
      "title": "Discover() will not run if listening on any address with an explicit bind=0.0.0.0",
      "body": "### Current behaviour\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/85bcfeea23568053ea09013fb8263fa1511d7123/src/init.cpp#L1890-L1892\r\n\r\n`Discover()` will run only if we are listening on all addresses (`bind_on_any` is `true`). However if `-bind=0.0.0.0:port` is explicitly given, then `bind_on_any` will end up being `false` and thus `Discover()` will not run when it should.\r\n\r\n### Expected behaviour\r\n\r\nDiscover own addresses even if `-bind=0.0.0.0:port` is given.\r\n\r\n### Steps to reproduce\r\n\r\nUse `-bind=0.0.0.0:port`.\r\n\r\n### How did you obtain Bitcoin Core\r\n\r\nCompiled from source\r\n\r\n### What version of Bitcoin Core are you using?\r\n\r\nmaster@85bcfeea23568053ea09013fb8263fa1511d7123\r\n\r\n### Operating system and version\r\n\r\nWindows 3.11\r\n\r\n### Background\r\n\r\nSee https://github.com/bitcoin/bitcoin/issues/31133#issuecomment-2477231557",
      "state": "open",
      "user": "vasild",
      "created_at": "2024-11-15T08:54:02Z",
      "updated_at": "2026-02-04T09:02:05Z",
      "closed_at": null,
      "comments": 12,
      "url": "https://github.com/bitcoin/bitcoin/issues/31293",
      "labels": [
        "P2P",
        "good first issue"
      ],
      "comment_data": [
        {
          "id": 3843001378,
          "user": "Nikolesky",
          "body": "I’ve been investigating this issue and I believe the problem comes from how connOptions.bind_on_any is determined.\n\nCurrently it is set to false whenever -bind or -whitebind is specified, regardless of the actual address value. This causes Discover() to be skipped even when the user specifies wildcard bind addresses like 0.0.0.0 or ::, which are semantically equivalent to binding on all interfaces.\n\nMy understanding is that bind_on_any should remain true when all specified bind addresses are wildcard addresses, and only become false when at least one bind address restricts listening to specific interfaces.\n\nDoes this interpretation match the intended behavior? If so, I’m interested in working on a fix.",
          "created_at": "2026-02-03T18:37:20Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 711,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3846187055,
          "user": "vasild",
          "body": "@Nikolesky, in general yes. However, `bind_on_any` is used in two other places as well with a different semantic - \"is `-bind=` specified at all\". So, to minimize the diff, one might prefer to leave `bind_on_any` alone and only change the conditions on which `Discover()` is called.\n\n> only become false _(thus don't call `Discover()`)_ when at least one bind address restricts listening\n\nHmm, I think `Discover()` should be called also when there are bind addresses that restrict listening, if there is at least one wildcard bind address, no? E.g. what about this:\n\n`-bind=0.0.0.0:8333 -bind=[1234::5]:8333`, run `Discover()` or not?\n\n> I’m interested in working on a fix.\n\nI would start by studying:\n\nhttps://github.com/bitcoin/bitcoin/pull/31492\nhttps://github.com/bitcoin/bitcoin/pull/32757 <-- a good candidate for review that would fix this\nhttps://github.com/bitcoin/bitcoin/pull/33362\n\n\nThanks!",
          "created_at": "2026-02-04T09:02:05Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 902,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 915,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3812548980,
      "number": 34280,
      "title": "Coins Cache Cleanup checklist",
      "body": "The coins cache (the `CCoinsView*` stack, `CCoinsViewCache`, and friends) is a correctness- and performance-critical part of validation, IBD, and assumeutxo.\nOver time it has accumulated subtle invariants and legacy states (around cache entry flags, spent coin handling, and error catching), and we have been chipping away at it through focused refactors, bugfixes, tests, and performance work.\n\nThis issue tracks the related PRs to help reviewers see how they fit together.\nThe overall aim is fewer error cases, cleaner cache layering, and parallel validation.\n\n## PRs needing review\n\n### Remove invalid cache states\n\n* [ ] https://github.com/bitcoin/bitcoin/pull/33018 - remove unreachable FRESH-but-not-DIRTY state.\n\n### Simplify view hierarchy\n\n* [ ] https://github.com/bitcoin/bitcoin/pull/34124 - make `CCoinsView` purely virtual, add explicit `CCoinsViewEmpty`.\n* [ ] https://github.com/bitcoin/bitcoin/pull/34320 - replace `HaveCoin()` with `GetCoin()`.\n* [ ] https://github.com/bitcoin/bitcoin/pull/34132 - inline error catcher into `CCoinsViewDB`, simplify hot path.\n\n### Isolate block connection\n\n* [ ] https://github.com/bitcoin/bitcoin/pull/34165 - add non-mutating `PeekCoin()` to avoid polluting the main cache.\n\n### Flush behavior\n\n* [ ] https://github.com/bitcoin/bitcoin/pull/33512 - track dirty entries so flush progress reflects actual writes.\n\n### Parallel coin fetching\n\n* [ ] https://github.com/bitcoin/bitcoin/pull/31132 - async input prefetch during `ConnectBlock`.\n\n### Other\n\n* [ ] https://github.com/bitcoin/bitcoin/pull/33854 - fix assumevalid ignored during reindex (see #31494).\n* [ ] https://github.com/bitcoin/bitcoin/pull/32317 - move UTXO access to `SpendBlock` (kernel API, Utreexo, SwiftSync).\n\n## Recently merged\n\n* https://github.com/bitcoin/bitcoin/pull/33680 - split `FORCE_SYNC`/`FORCE_FLUSH`, keep cache warm for `scantxoutset`/`gettxoutsetinfo`/snapshots.\n* https://github.com/bitcoin/bitcoin/pull/34164 - add `Reset()` and reusable view to discard failed connects cheaply.\n* https://github.com/bitcoin/bitcoin/pull/34207 - ensure `GetCoin()` only returns unspent coins, align tests with production.\n* https://github.com/bitcoin/bitcoin/pull/33866 - remove always-true return from `BatchWrite`.\n* https://github.com/bitcoin/bitcoin/pull/33657 - allow reading partial block data (useful for bindex).\n* https://github.com/bitcoin/bitcoin/pull/33602 - reduce map lookups in `BatchWrite`.\n* https://github.com/bitcoin/bitcoin/pull/33333 - warn when `-dbcache` exceeds RAM cap.\n\nIRC context: https://bitcoin-irc.chaincode.com/bitcoin-core-dev/2026-01-08",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2026-01-14T10:23:16Z",
      "updated_at": "2026-02-03T20:07:49Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34280",
      "labels": [
        "Tracking Issue"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2622,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3519267236,
      "number": 33635,
      "title": "Intermittent issue in feature_assumeutxo.py\", line 629, in run_test                                        assert not self.has_blockfile(n1, \"00002\"), \"too many blockfiles\"",
      "body": "Seen locally in https://drahtbot.space/temp_scratch/feature_assumeutxo_265.tar.zstd:\n\ncommit should be roughly 40e7d4cd0d7f1d922b92b0c640d3d89eef059411 and the command was `RUN_UNIT_TESTS=false MAKEJOBS=\"-j8\" FILE_ENV=\"./ci/test/00_setup_env_native_nowallet_libbitcoinkernel.sh\" ./ci/test_run_all.sh`\n\n```\n node1 2025-10-15T18:56:48.763939Z [shutoff] [txdb.cpp:151] [virtual bool CCoinsViewDB::BatchWrite(CoinsViewCacheCursor &, const uint256 &)] [coindb] Writing final batch of 0.00 MiB \n node1 2025-10-15T18:56:48.763948Z [shutoff] [txdb.cpp:153] [virtual bool CCoinsViewDB::BatchWrite(CoinsViewCacheCursor &, const uint256 &)] [coindb] Committed 0 changed transaction outputs (out of 0) to coin database... \n node1 2025-10-15T18:56:48.763958Z [shutoff] [logging/timer.h:58] [void BCLog::Timer<std::chrono::duration<long long, std::ratio<1, 1000>>>::Log(const std::string &) [TimeType = std::chrono::duration<long long, std::ratio<1, 1000>>]] [bench] FlushStateToDisk: write coins cache to disk (0 coins, 256KiB) completed (0.02ms) \n node1 2025-10-15T18:56:48.763966Z [shutoff] [validationinterface.cpp:246] [void ValidationSignals::ChainStateFlushed(ChainstateRole, const CBlockLocator &)] [validation] Enqueuing ChainStateFlushed: block hash=5d3144f90878dbabd3a42352be3294df923c93198e1399b93d07292c9cd1e1ce \n node1 2025-10-15T18:56:48.763997Z [shutoff] [validation.cpp:2837] [bool Chainstate::FlushStateToDisk(BlockValidationState &, FlushStateMode, int)] [coindb] Writing chainstate to disk: flush mode=ALWAYS, prune=0, large=0, critical=0, periodic=0 \n node1 2025-10-15T18:56:48.764007Z [shutoff] [logging/timer.h:58] [void BCLog::Timer<std::chrono::duration<long long, std::ratio<1, 1000>>>::Log(const std::string &) [TimeType = std::chrono::duration<long long, std::ratio<1, 1000>>]] [bench] FlushStateToDisk: write block and undo data to disk started \n node1 2025-10-15T18:56:48.764041Z [shutoff] [logging/timer.h:58] [void BCLog::Timer<std::chrono::duration<long long, std::ratio<1, 1000>>>::Log(const std::string &) [TimeType = std::chrono::duration<long long, std::ratio<1, 1000>>]] [bench] FlushStateToDisk: write block and undo data to disk completed (0.03ms) \n node1 2025-10-15T18:56:48.764050Z [shutoff] [logging/timer.h:58] [void BCLog::Timer<std::chrono::duration<long long, std::ratio<1, 1000>>>::Log(const std::string &) [TimeType = std::chrono::duration<long long, std::ratio<1, 1000>>]] [bench] FlushStateToDisk: write block index to disk started \n node1 2025-10-15T18:56:48.764061Z [shutoff] [logging/timer.h:58] [void BCLog::Timer<std::chrono::duration<long long, std::ratio<1, 1000>>>::Log(const std::string &) [TimeType = std::chrono::duration<long long, std::ratio<1, 1000>>]] [bench] FlushStateToDisk: write block index to disk completed (0.01ms) \n node1 2025-10-15T18:56:48.764067Z [shutoff] [logging/timer.h:58] [void BCLog::Timer<std::chrono::duration<long long, std::ratio<1, 1000>>>::Log(const std::string &) [TimeType = std::chrono::duration<long long, std::ratio<1, 1000>>]] [bench] FlushStateToDisk: write coins cache to disk (0 coins, 256KiB) started \n node1 2025-10-15T18:56:48.764076Z [shutoff] [txdb.cpp:151] [virtual bool CCoinsViewDB::BatchWrite(CoinsViewCacheCursor &, const uint256 &)] [coindb] Writing final batch of 0.00 MiB \n node1 2025-10-15T18:56:48.764083Z [shutoff] [txdb.cpp:153] [virtual bool CCoinsViewDB::BatchWrite(CoinsViewCacheCursor &, const uint256 &)] [coindb] Committed 0 changed transaction outputs (out of 0) to coin database... \n node1 2025-10-15T18:56:48.764092Z [shutoff] [logging/timer.h:58] [void BCLog::Timer<std::chrono::duration<long long, std::ratio<1, 1000>>>::Log(const std::string &) [TimeType = std::chrono::duration<long long, std::ratio<1, 1000>>]] [bench] FlushStateToDisk: write coins cache to disk (0 coins, 256KiB) completed (0.02ms) \n node1 2025-10-15T18:56:48.764100Z [shutoff] [validationinterface.cpp:246] [void ValidationSignals::ChainStateFlushed(ChainstateRole, const CBlockLocator &)] [validation] Enqueuing ChainStateFlushed: block hash=6d9186a0db6df121d2006c40c7827c447afe6329b705666bca1744b72c71f0ad \n node1 2025-10-15T18:56:48.767027Z [shutoff] [init.cpp:410] [void Shutdown(NodeContext &)] Shutdown done \n test  2025-10-15T18:56:48.791717Z TestFramework.node1 (DEBUG): Node stopped \n test  2025-10-15T18:56:48.791816Z TestFramework (INFO): Checking that blocks are segmented on disk \n test  2025-10-15T18:56:48.791990Z TestFramework (ERROR): Unexpected exception \n                                   Traceback (most recent call last):\n                                     File \"/ci_container_base/test/functional/test_framework/test_framework.py\", line 198, in main\n                                       self.run_test()\n                                     File \"/ci_container_base/ci/scratch/build-x86_64-pc-linux-gnu/test/functional/feature_assumeutxo.py\", line 629, in run_test\n                                       assert not self.has_blockfile(n1, \"00002\"), \"too many blockfiles\"\n                                   AssertionError: too many blockfiles\n",
      "state": "open",
      "user": "maflcko",
      "created_at": "2025-10-15T19:15:40Z",
      "updated_at": "2026-02-03T20:05:15Z",
      "closed_at": null,
      "comments": 8,
      "url": "https://github.com/bitcoin/bitcoin/issues/33635",
      "labels": [
        "CI failed"
      ],
      "comment_data": [
        {
          "id": 3816554151,
          "user": "maflcko",
          "body": "I tried to reproduce this with the command below, but failed. I guess this fixed itself?\n\n`while ( TEST_RUNNER_EXTRA=\"$( for i in {1..400}; do echo -n \"feature_assumeutxo.py \"; done )\" RUN_UNIT_TESTS=false MAKEJOBS=\"-j8\" FILE_ENV=\"./ci/test/00_setup_env_native_nowallet.sh\" ./ci/test_run_all.sh ) ; do echo _ >> /tmp/runs ; done`",
          "created_at": "2026-01-29T09:42:55Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 329,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3816638768,
          "user": "maflcko",
          "body": "Nvm. It happened again after a few thousand iterations:\n\n\nhttps://drahtbot.space/temp_scratch/feature_assumeutxo_201.tar.zstd",
          "created_at": "2026-01-29T10:00:28Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 125,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3824033117,
          "user": "maflcko",
          "body": "> i tried studying from the report shared above realized that maybe the assertion `assert not self.has_blockfile(n1, \"00002\")` was too strict perhaps maybe we can condition it because segmentation works as expected\n> \n> coz with `-fastprune` it does 64KB blockfiles... coz node1 runs two chainstates concurrently NORMAL and ASSUMED...so this segmentation keeps their blocks separate\n> \n> so when NORMAL syncs enough blocks to fill blk00000.dat it creates blk00002.dat\n> \n> from node1/regtest/debug.log\n> \n> ```\n> [assumed] initializing blockfile cursor to BlockfileCursor(file_num=1)\n> ...\n> Leaving block file 0: CBlockFileInfo(blocks=242, size=65331, heights=0...240) (onto 2) (height 241)\n> ```\n\nThanks for taking a look. I am primarily interested in why this is happening intermittently. Usually this happens due to one thread being slower than another. For example in https://github.com/bitcoin/bitcoin/pull/34425, a sleep added in the right place will make a particular intermittent issue appear more deterministically:\n\n```\ndiff --git a/src/net.cpp b/src/net.cpp\nindex 6b79e913e8..32bd061500 100644\n--- a/src/net.cpp\n+++ b/src/net.cpp\n@@ -2200,2 +2200,3 @@ void CConnman::SocketHandlerConnected(const std::vector<CNode*>& nodes,\n                 }\n+            UninterruptibleSleep(599ms);\n                 pnode->CloseSocketDisconnect();\n```\n\nI'd be great to find a diff to make this one reproduce deterministically as well.",
          "created_at": "2026-01-30T14:22:55Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 1432,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3824159995,
          "user": "b-l-u-e",
          "body": "> > i tried studying from the report shared above realized that maybe the assertion `assert not self.has_blockfile(n1, \"00002\")` was too strict perhaps maybe we can condition it because segmentation works as expected\n> > coz with `-fastprune` it does 64KB blockfiles... coz node1 runs two chainstates concurrently NORMAL and ASSUMED...so this segmentation keeps their blocks separate\n> > so when NORMAL syncs enough blocks to fill blk00000.dat it creates blk00002.dat\n> > from node1/regtest/debug.log\n> > ```\n> > [assumed] initializing blockfile cursor to BlockfileCursor(file_num=1)\n> > ...\n> > Leaving block file 0: CBlockFileInfo(blocks=242, size=65331, heights=0...240) (onto 2) (height 241)\n> > ```\n> \n> Thanks for taking a look. I am primarily interested in why this is happening intermittently. Usually this happens due to one thread being slower than another. For example in [#34425](https://github.com/bitcoin/bitcoin/pull/34425), a sleep added in the right place will make a particular intermittent issue appear more deterministically:\n> \n> ```\n> diff --git a/src/net.cpp b/src/net.cpp\n> index 6b79e913e8..32bd061500 100644\n> --- a/src/net.cpp\n> +++ b/src/net.cpp\n> @@ -2200,2 +2200,3 @@ void CConnman::SocketHandlerConnected(const std::vector<CNode*>& nodes,\n>                  }\n> +            UninterruptibleSleep(599ms);\n>                  pnode->CloseSocketDisconnect();\n> ```\n> \n> I'd be great to find a diff to make this one reproduce deterministically as well.\n \nLet me try to add  a sleep between when NORMAL and ASSUMED chainstates start the syncing\n ",
          "created_at": "2026-01-30T14:51:34Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 1571,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3843393814,
          "user": "b-l-u-e",
          "body": "> I'd be great to find a diff to make this one reproduce deterministically as well.\n\n so i did a test repro run by  adding a sleep in `ConnectTip()` for the snapshot chainstate slows it down giving the normal chainstate time to fill `blk00000.dat` and roll to `blk00002.dat` before `-stopatheight` triggers\n\n```diff\ndiff --git a/src/validation.cpp b/src/validation.cpp\n--- a/src/validation.cpp\n+++ b/src/validation.cpp\n@@ -3079,6 +3079,10 @@ bool Chainstate::ConnectTip(...)\n     {\n         CCoinsViewCache& view{*m_coins_views->m_connect_block_view};\n         const auto reset_guard{view.CreateResetGuard()};\n+        if (m_from_snapshot_blockhash) {\n+            UninterruptibleSleep(std::chrono::milliseconds{120});\n+        }\n         bool rv = ConnectBlock(*block_to_connect, state, pindexNew, view);\n```\n\n\nand also i made change in`feature_assumeutxo.py` with a 10s `wait_until_stopped` so as the slowed snapshot can reach `-stopatheight`).\n```diff\ndiff --git a/test/functional/feature_assumeutxo.py b/test/functional/feature_assumeutxo.py\n--- a/test/functional/feature_assumeutxo.py\n+++ b/test/functional/feature_assumeutxo.py\n@@ -644,15 +644,12 @@ class AssumeutxoTest(BitcoinTestFramework):\n         # assertions and the -stopatheight tripping.\n         self.connect_nodes(0, 1, wait_for_connect=False)\n \n-        n1.wait_until_stopped(timeout=5)\n+        n1.wait_until_stopped(timeout=10)  \n \n         self.log.info(\"Checking that blocks are segmented on disk\")\n         assert self.has_blockfile(n1, \"00000\"), \"normal blockfile missing\"\n         assert self.has_blockfile(n1, \"00001\"), \"assumed blockfile missing\"\n         assert not self.has_blockfile(n1, \"00002\"), \"too many blockfiles\"\n \n         self.log.info(\"Restarted node before snapshot validation completed, reloading...\")\n         self.restart_node(1, extra_args=self.extra_args[1])\n```\n- and i run with `--nocleanup --tmpdir=/tmp/bitcoin_test_assumeutxo_repro` to see the results\n\n\n```\n/tmp/bitcoin_test_assumeutxo_repro/node1/regtest/blocks/\nblk00000.dat  65331 bytes  (filled normal chainstate)\nblk00001.dat  32768 bytes  (snapshot chainstate)\nblk00002.dat  32768 bytes  (normal chainstate rollover)\n```\n\n- so with `-fastprune`, blockfiles are 64 KiB\n- the sleep delays the snapshot chainstate from reaching `-stopatheight=359`\n- while also the background chainstate fills the 64 KiB blockfile\n- so when its full, it rolls to `blk00002.dat` since `blk00001.dat` is reserved for snapshot\n",
          "created_at": "2026-02-03T20:05:15Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 2462,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 5226,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3515047935,
      "number": 33628,
      "title": "Minor Release 29.3",
      "body": "🚧 Milestone: https://github.com/bitcoin/bitcoin/milestone/80\n\nBackports and other changes\n- #33623\n- #33611\n- #34222\n- #33788\n- #34268\n- https://github.com/bitcoin/bitcoin/pull/34370\n\n\nRC 1\n- [x] final changes #34268\n- [x] binaries\n\nRC 2\n- [x] final changes #34450\n- [ ] binaries\n- [ ] announcements\n\n\nSee [release process docs](https://github.com/bitcoin/bitcoin/blob/master/doc/release-process.md) for more details. This issue can be used to track status updates. Please feel free to suggest backports in the comments.",
      "state": "open",
      "user": "glozow",
      "created_at": "2025-10-14T18:35:27Z",
      "updated_at": "2026-02-03T18:02:43Z",
      "closed_at": null,
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/33628",
      "labels": [
        "Tracking Issue"
      ],
      "comment_data": [
        {
          "id": 3824649968,
          "user": "glozow",
          "body": "rc2 has been tagged https://github.com/bitcoin/bitcoin/releases/tag/v29.3rc2",
          "created_at": "2026-01-30T16:39:54Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 76,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3836704169,
          "user": "glozow",
          "body": "@sedited is taking over 29.x from here. Thanks!",
          "created_at": "2026-02-02T17:41:13Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 47,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3842825945,
          "user": "achow101",
          "body": "29.3rc2 bins are up: https://bitcoincore.org/bin/bitcoin-core-29.3/test.rc2/",
          "created_at": "2026-02-03T18:02:43Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 76,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 539,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3491045235,
      "number": 33560,
      "title": "build: depends sqlite compile failure for FreeBSD Clang cross",
      "body": "Using master (919e6d01e93a57d991ed456bc67c43605583ada8) and doing something like:\n```bash\nmake -C depends/ HOST=aarch64-unknown-freebsd CC=clang CXX=clang++ CFLAGS=\"--sysroot=/path/to/sysroot/ \" CXXFLAGS=\"--sysroot=/path/to/sysroot/ -stdlib=libc++\" LDFLAGS=\"-fuse-ld=lld\" AR=llvm-ar STRIP=llvm-strip NM=llvm-nm RANLIB=llvm-ranlib NO_QT=1\n```\nResults in:\n```bash\nlibtool: compile:  clang -DPACKAGE_NAME=\\\"sqlite\\\" -DPACKAGE_TARNAME=\\\"sqlite\\\" -DPACKAGE_VERSION=\\\"3.46.1\\\" \"-DPACKAGE_STRING=\\\"sqlite 3.46.1\\\"\" -DPACKAGE_BUGREPORT=\\\"http://www.sqlite.org\\\" -DPACKAGE_URL=\\\"\\\" -DPACKAGE=\\\"sqlite\\\" -DVERSION=\\\"3.46.1\\\" -DHAVE_STDIO_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_STRINGS_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_UNISTD_H=1 -DSTDC_HEADERS=1 -DHAVE_DLFCN_H=1 -DLT_OBJDIR=\\\".libs/\\\" -DHAVE_FDATASYNC=1 -DHAVE_USLEEP=1 -DHAVE_LOCALTIME_R=1 -DHAVE_GMTIME_R=1 -DHAVE_DECL_STRERROR_R=1 -DHAVE_STRERROR_R=1 -DHAVE_POSIX_FALLOCATE=1 -DHAVE_ZLIB_H=1 -I. -I/bitcoin/depends/aarch64-unknown-freebsd/include -DSQLITE_DQS=0 -DSQLITE_DEFAULT_MEMSTATUS=0 -DSQLITE_OMIT_DEPRECATED -DSQLITE_OMIT_SHARED_CACHE -DSQLITE_OMIT_JSON -DSQLITE_LIKE_DOESNT_MATCH_BLOBS -DSQLITE_OMIT_DECLTYPE -DSQLITE_OMIT_PROGRESS_CALLBACK -DSQLITE_OMIT_AUTOINIT -D_REENTRANT=1 -DSQLITE_THREADSAFE=1 -DSQLITE_OMIT_LOAD_EXTENSION=1 -DSQLITE_ENABLE_MATH_FUNCTIONS -DSQLITE_HAVE_ZLIB --sysroot=/opt/cross-freebsd-14/ -pipe -std=c11 -MT sqlite3.lo -MD -MP -MF .deps/sqlite3.Tpo -c sqlite3.c  -fPIC -DPIC -o sqlite3.o\nsqlite3.c:38913:42: error: use of undeclared identifier 'mremap'\n 38913 |   { \"mremap\",       (sqlite3_syscall_ptr)mremap,          0 },\n       |                                          ^\nsqlite3.c:38988:22: error: invalid application of 'sizeof' to an incomplete type 'struct unix_syscall[]'\n 38988 |     for(i=0; i<sizeof(aSyscall)/sizeof(aSyscall[0]); i++){\n       |                      ^~~~~~~~~~\nsqlite3.c:38997:22: error: invalid application of 'sizeof' to an incomplete type 'struct unix_syscall[]'\n 38997 |     for(i=0; i<sizeof(aSyscall)/sizeof(aSyscall[0]); i++){\n       |                      ^~~~~~~~~~\nsqlite3.c:39024:20: error: invalid application of 'sizeof' to an incomplete type 'struct unix_syscall[]'\n 39024 |   for(i=0; i<sizeof(aSyscall)/sizeof(aSyscall[0]); i++){\n       |                    ^~~~~~~~~~\nsqlite3.c:39041:16: error: invalid application of 'sizeof' to an incomplete type 'struct unix_syscall[]'\n 39041 |     for(i=0; i<ArraySize(aSyscall)-1; i++){\n       |                ^~~~~~~~~~~~~~~~~~~\nsqlite3.c:15273:38: note: expanded from macro 'ArraySize'\n 15273 | #define ArraySize(X)    ((int)(sizeof(X)/sizeof(X[0])))\n       |                                      ^~~\nsqlite3.c:39045:14: error: invalid application of 'sizeof' to an incomplete type 'struct unix_syscall[]'\n 39045 |   for(i++; i<ArraySize(aSyscall); i++){\n       |              ^~~~~~~~~~~~~~~~~~~\nsqlite3.c:15273:38: note: expanded from macro 'ArraySize'\n 15273 | #define ArraySize(X)    ((int)(sizeof(X)/sizeof(X[0])))\n       |                                      ^~~\nsqlite3.c:43706:42: error: use of undeclared identifier 'MREMAP_MAYMOVE'\n 43706 |     pNew = osMremap(pOrig, nReuse, nNew, MREMAP_MAYMOVE);\n       |                                          ^\n7 errors generated.\nmake[1]: *** [Makefile:542: sqlite3.lo] Error 1\n```",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-10-07T11:11:16Z",
      "updated_at": "2026-02-03T13:23:17Z",
      "closed_at": "2026-02-03T13:23:16Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/33560",
      "labels": [
        "Build system"
      ],
      "comment_data": [
        {
          "id": 3841298623,
          "user": "fanquake",
          "body": "Closing for now, this isn't an issue in #34491.",
          "created_at": "2026-02-03T13:23:17Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 47,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 3428,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2729795484,
      "number": 31455,
      "title": "multiprocess: build failure on Alpine with depends & `DEBUG=1`",
      "body": "Alpine 3.21 aarch64\r\ngcc (Alpine 14.2.0) 14.2.0\r\n\r\n```bash\r\nmake -C depends/ NO_USDT=1 NO_WALLET=1 NO_QT=1 NO_ZMQ=1 MULTIPROCESS=1 DEBUG=1\r\ncmake -B build --toolchain /bitcoin/depends/aarch64-unknown-linux-musl/toolchain.cmake\r\ncmake --build build --target bitcoin-node\r\n<snip>\r\n[100%] Linking CXX executable bitcoin-node\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: ipc/libbitcoin_ipc.a(init.capnp.proxy-client.c++.o): in function `mp::ProxyClientBase<ipc::capnp::messages::Echo, interfaces::Echo>::ProxyClientBase(ipc::capnp::messages::Echo::Client, mp::Connection*, bool)::{lambda()#2}::operator()() const':\r\n/bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-io.h:409:(.text._ZNSt17_Function_handlerIFvvEZN2mp15ProxyClientBaseIN3ipc5capnp8messages4EchoEN10interfaces4EchoEEC4ENS6_6ClientEPNS1_10ConnectionEbEUlvE0_E9_M_invokeERKSt9_Any_data[_ZNSt17_Function_handlerIFvvEZN2mp15ProxyClientBaseIN3ipc5capnp8messages4EchoEN10interfaces4EchoEEC4ENS6_6ClientEPNS1_10ConnectionEbEUlvE0_E9_M_invokeERKSt9_Any_data]+0x40): undefined reference to `mp::Connection::removeSyncCleanup(std::_List_iterator<std::function<void ()> >)'\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: ipc/libbitcoin_ipc.a(init.capnp.proxy-client.c++.o): in function `mp::ProxyClientBase<ipc::capnp::messages::Mining, interfaces::Mining>::ProxyClientBase(ipc::capnp::messages::Mining::Client, mp::Connection*, bool)::{lambda()#2}::operator()() const':\r\n/bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-io.h:409:(.text._ZNSt17_Function_handlerIFvvEZN2mp15ProxyClientBaseIN3ipc5capnp8messages6MiningEN10interfaces6MiningEEC4ENS6_6ClientEPNS1_10ConnectionEbEUlvE0_E9_M_invokeERKSt9_Any_data[_ZNSt17_Function_handlerIFvvEZN2mp15ProxyClientBaseIN3ipc5capnp8messages6MiningEN10interfaces6MiningEEC4ENS6_6ClientEPNS1_10ConnectionEbEUlvE0_E9_M_invokeERKSt9_Any_data]+0x40): undefined reference to `mp::Connection::removeSyncCleanup(std::_List_iterator<std::function<void ()> >)'\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: ipc/libbitcoin_ipc.a(init.capnp.proxy-client.c++.o): in function `_ZN2mp16CustomBuildFieldINS_11StructFieldINS_8AccessorINS_11init_fields7ContextELi17EEEN5capnp7RequestIN3ipc5capnp8messages4Init14MakeEchoParamsENSB_15MakeEchoResultsEEEEEEEvNS_8TypeListIJEEENS_8PriorityILi1EEERNS_19ClientInvokeContextEOT_PNSt9enable_ifIXsrSt7is_sameIDTcldtfL0p2_3getEENS_7Context7BuilderEE5valueEvE4typeE':\r\n/bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-types.h:71:(.text._ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages4InitEEEMNS5_6ClientEFN5capnp7RequestINS5_14MakeEchoParamsENS5_15MakeEchoResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_11init_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi18EEEJRSt10unique_ptrIN10interfaces4EchoESt14default_deleteIST_EEEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv[_ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages4InitEEEMNS5_6ClientEFN5capnp7RequestINS5_14MakeEchoParamsENS5_15MakeEchoResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_11init_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi18EEEJRSt10unique_ptrIN10interfaces4EchoESt14default_deleteIST_EEEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv]+0xa4): undefined reference to `mp::SetThread(std::map<mp::Connection*, mp::ProxyClient<mp::Thread>, std::less<mp::Connection*>, std::allocator<std::pair<mp::Connection* const, mp::ProxyClient<mp::Thread> > > >&, std::mutex&, mp::Connection*, std::function<mp::Thread::Client ()>)'\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: /bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-types.h:89:(.text._ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages4InitEEEMNS5_6ClientEFN5capnp7RequestINS5_14MakeEchoParamsENS5_15MakeEchoResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_11init_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi18EEEJRSt10unique_ptrIN10interfaces4EchoESt14default_deleteIST_EEEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv[_ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages4InitEEEMNS5_6ClientEFN5capnp7RequestINS5_14MakeEchoParamsENS5_15MakeEchoResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_11init_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi18EEEJRSt10unique_ptrIN10interfaces4EchoESt14default_deleteIST_EEEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv]+0xf0): undefined reference to `mp::SetThread(std::map<mp::Connection*, mp::ProxyClient<mp::Thread>, std::less<mp::Connection*>, std::allocator<std::pair<mp::Connection* const, mp::ProxyClient<mp::Thread> > > >&, std::mutex&, mp::Connection*, std::function<mp::Thread::Client ()>)'\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: ipc/libbitcoin_ipc.a(init.capnp.proxy-client.c++.o): in function `_ZN2mp16CustomBuildFieldINS_11StructFieldINS_8AccessorINS_11init_fields7ContextELi17EEEN5capnp7RequestIN3ipc5capnp8messages4Init16MakeMiningParamsENSB_17MakeMiningResultsEEEEEEEvNS_8TypeListIJEEENS_8PriorityILi1EEERNS_19ClientInvokeContextEOT_PNSt9enable_ifIXsrSt7is_sameIDTcldtfL0p2_3getEENS_7Context7BuilderEE5valueEvE4typeE':\r\n/bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-types.h:71:(.text._ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages4InitEEEMNS5_6ClientEFN5capnp7RequestINS5_16MakeMiningParamsENS5_17MakeMiningResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_11init_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi18EEEJRSt10unique_ptrIN10interfaces6MiningESt14default_deleteIST_EEEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv[_ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages4InitEEEMNS5_6ClientEFN5capnp7RequestINS5_16MakeMiningParamsENS5_17MakeMiningResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_11init_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi18EEEJRSt10unique_ptrIN10interfaces6MiningESt14default_deleteIST_EEEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv]+0xa4): undefined reference to `mp::SetThread(std::map<mp::Connection*, mp::ProxyClient<mp::Thread>, std::less<mp::Connection*>, std::allocator<std::pair<mp::Connection* const, mp::ProxyClient<mp::Thread> > > >&, std::mutex&, mp::Connection*, std::function<mp::Thread::Client ()>)'\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: /bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-types.h:89:(.text._ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages4InitEEEMNS5_6ClientEFN5capnp7RequestINS5_16MakeMiningParamsENS5_17MakeMiningResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_11init_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi18EEEJRSt10unique_ptrIN10interfaces6MiningESt14default_deleteIST_EEEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv[_ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages4InitEEEMNS5_6ClientEFN5capnp7RequestINS5_16MakeMiningParamsENS5_17MakeMiningResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_11init_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi18EEEJRSt10unique_ptrIN10interfaces6MiningESt14default_deleteIST_EEEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv]+0xf0): undefined reference to `mp::SetThread(std::map<mp::Connection*, mp::ProxyClient<mp::Thread>, std::less<mp::Connection*>, std::allocator<std::pair<mp::Connection* const, mp::ProxyClient<mp::Thread> > > >&, std::mutex&, mp::Connection*, std::function<mp::Thread::Client ()>)'\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: ipc/libbitcoin_ipc.a(echo.capnp.proxy-client.c++.o): in function `_ZN2mp16CustomBuildFieldINS_11StructFieldINS_8AccessorINS_11echo_fields7ContextELi17EEEN5capnp7RequestIN3ipc5capnp8messages4Echo13DestroyParamsENSB_14DestroyResultsEEEEEEEvNS_8TypeListIJEEENS_8PriorityILi1EEERNS_19ClientInvokeContextEOT_PNSt9enable_ifIXsrSt7is_sameIDTcldtfL0p2_3getEENS_7Context7BuilderEE5valueEvE4typeE':\r\n/bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-types.h:71:(.text._ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages4EchoEEEMNS5_6ClientEFN5capnp7RequestINS5_13DestroyParamsENS5_14DestroyResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_11echo_fields7ContextELi17EEEJEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv[_ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages4EchoEEEMNS5_6ClientEFN5capnp7RequestINS5_13DestroyParamsENS5_14DestroyResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_11echo_fields7ContextELi17EEEJEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv]+0xa4): undefined reference to `mp::SetThread(std::map<mp::Connection*, mp::ProxyClient<mp::Thread>, std::less<mp::Connection*>, std::allocator<std::pair<mp::Connection* const, mp::ProxyClient<mp::Thread> > > >&, std::mutex&, mp::Connection*, std::function<mp::Thread::Client ()>)'\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: ipc/libbitcoin_ipc.a(echo.capnp.proxy-client.c++.o):/bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-types.h:89: more undefined references to `mp::SetThread(std::map<mp::Connection*, mp::ProxyClient<mp::Thread>, std::less<mp::Connection*>, std::allocator<std::pair<mp::Connection* const, mp::ProxyClient<mp::Thread> > > >&, std::mutex&, mp::Connection*, std::function<mp::Thread::Client ()>)' follow\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: ipc/libbitcoin_ipc.a(mining.capnp.proxy-client.c++.o): in function `mp::ProxyClientBase<ipc::capnp::messages::BlockTemplate, interfaces::BlockTemplate>::ProxyClientBase(ipc::capnp::messages::BlockTemplate::Client, mp::Connection*, bool)::{lambda()#2}::operator()() const':\r\n/bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-io.h:409:(.text._ZNSt17_Function_handlerIFvvEZN2mp15ProxyClientBaseIN3ipc5capnp8messages13BlockTemplateEN10interfaces13BlockTemplateEEC4ENS6_6ClientEPNS1_10ConnectionEbEUlvE0_E9_M_invokeERKSt9_Any_data[_ZNSt17_Function_handlerIFvvEZN2mp15ProxyClientBaseIN3ipc5capnp8messages13BlockTemplateEN10interfaces13BlockTemplateEEC4ENS6_6ClientEPNS1_10ConnectionEbEUlvE0_E9_M_invokeERKSt9_Any_data]+0x40): undefined reference to `mp::Connection::removeSyncCleanup(std::_List_iterator<std::function<void ()> >)'\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: ipc/libbitcoin_ipc.a(mining.capnp.proxy-client.c++.o): in function `_ZN2mp16CustomBuildFieldINS_11StructFieldINS_8AccessorINS_13mining_fields7ContextELi17EEEN5capnp7RequestIN3ipc5capnp8messages6Mining17IsTestChainParamsENSB_18IsTestChainResultsEEEEEEEvNS_8TypeListIJEEENS_8PriorityILi1EEERNS_19ClientInvokeContextEOT_PNSt9enable_ifIXsrSt7is_sameIDTcldtfL0p2_3getEENS_7Context7BuilderEE5valueEvE4typeE':\r\n/bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-types.h:71:(.text._ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages6MiningEEEMNS5_6ClientEFN5capnp7RequestINS5_17IsTestChainParamsENS5_18IsTestChainResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_13mining_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi2EEEJRbEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv[_ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages6MiningEEEMNS5_6ClientEFN5capnp7RequestINS5_17IsTestChainParamsENS5_18IsTestChainResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_13mining_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi2EEEJRbEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv]+0xa0): undefined reference to `mp::SetThread(std::map<mp::Connection*, mp::ProxyClient<mp::Thread>, std::less<mp::Connection*>, std::allocator<std::pair<mp::Connection* const, mp::ProxyClient<mp::Thread> > > >&, std::mutex&, mp::Connection*, std::function<mp::Thread::Client ()>)'\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: /bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-types.h:89:(.text._ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages6MiningEEEMNS5_6ClientEFN5capnp7RequestINS5_17IsTestChainParamsENS5_18IsTestChainResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_13mining_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi2EEEJRbEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv[_ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages6MiningEEEMNS5_6ClientEFN5capnp7RequestINS5_17IsTestChainParamsENS5_18IsTestChainResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_13mining_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi2EEEJRbEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv]+0xdc): undefined reference to `mp::SetThread(std::map<mp::Connection*, mp::ProxyClient<mp::Thread>, std::less<mp::Connection*>, std::allocator<std::pair<mp::Connection* const, mp::ProxyClient<mp::Thread> > > >&, std::mutex&, mp::Connection*, std::function<mp::Thread::Client ()>)'\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: ipc/libbitcoin_ipc.a(mining.capnp.proxy-client.c++.o): in function `_ZN2mp16CustomBuildFieldINS_11StructFieldINS_8AccessorINS_13mining_fields7ContextELi17EEEN5capnp7RequestIN3ipc5capnp8messages6Mining28IsInitialBlockDownloadParamsENSB_29IsInitialBlockDownloadResultsEEEEEEEvNS_8TypeListIJEEENS_8PriorityILi1EEERNS_19ClientInvokeContextEOT_PNSt9enable_ifIXsrSt7is_sameIDTcldtfL0p2_3getEENS_7Context7BuilderEE5valueEvE4typeE':\r\n/bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-types.h:71:(.text._ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages6MiningEEEMNS5_6ClientEFN5capnp7RequestINS5_28IsInitialBlockDownloadParamsENS5_29IsInitialBlockDownloadResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_13mining_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi2EEEJRbEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv[_ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages6MiningEEEMNS5_6ClientEFN5capnp7RequestINS5_28IsInitialBlockDownloadParamsENS5_29IsInitialBlockDownloadResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_13mining_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi2EEEJRbEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv]+0xa0): undefined reference to `mp::SetThread(std::map<mp::Connection*, mp::ProxyClient<mp::Thread>, std::less<mp::Connection*>, std::allocator<std::pair<mp::Connection* const, mp::ProxyClient<mp::Thread> > > >&, std::mutex&, mp::Connection*, std::function<mp::Thread::Client ()>)'\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: /bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-types.h:89:(.text._ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages6MiningEEEMNS5_6ClientEFN5capnp7RequestINS5_28IsInitialBlockDownloadParamsENS5_29IsInitialBlockDownloadResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_13mining_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi2EEEJRbEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv[_ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages6MiningEEEMNS5_6ClientEFN5capnp7RequestINS5_28IsInitialBlockDownloadParamsENS5_29IsInitialBlockDownloadResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_13mining_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi2EEEJRbEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv]+0xdc): undefined reference to `mp::SetThread(std::map<mp::Connection*, mp::ProxyClient<mp::Thread>, std::less<mp::Connection*>, std::allocator<std::pair<mp::Connection* const, mp::ProxyClient<mp::Thread> > > >&, std::mutex&, mp::Connection*, std::function<mp::Thread::Client ()>)'\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: ipc/libbitcoin_ipc.a(mining.capnp.proxy-client.c++.o): in function `_ZN2mp16CustomBuildFieldINS_11StructFieldINS_8AccessorINS_13mining_fields7ContextELi17EEEN5capnp7RequestIN3ipc5capnp8messages6Mining12GetTipParamsENSB_13GetTipResultsEEEEEEEvNS_8TypeListIJEEENS_8PriorityILi1EEERNS_19ClientInvokeContextEOT_PNSt9enable_ifIXsrSt7is_sameIDTcldtfL0p2_3getEENS_7Context7BuilderEE5valueEvE4typeE':\r\n/bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-types.h:71:(.text._ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages6MiningEEEMNS5_6ClientEFN5capnp7RequestINS5_12GetTipParamsENS5_13GetTipResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_13mining_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi22EEEJRSt8optionalIN10interfaces8BlockRefEEEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv[_ZZN2mp12clientInvokeINS_11ProxyClientIN3ipc5capnp8messages6MiningEEEMNS5_6ClientEFN5capnp7RequestINS5_12GetTipParamsENS5_13GetTipResultsEEEN2kj5MaybeINS8_11MessageSizeEEEEJNS_11ClientParamINS_8AccessorINS_13mining_fields7ContextELi17EEEJEEENSJ_INSK_INSL_6ResultELi22EEEJRSt8optionalIN10interfaces8BlockRefEEEEEEEEvRT_RKT0_DpOT1_ENKUlvE_clEv]+0xa0): undefined reference to `mp::SetThread(std::map<mp::Connection*, mp::ProxyClient<mp::Thread>, std::less<mp::Connection*>, std::allocator<std::pair<mp::Connection* const, mp::ProxyClient<mp::Thread> > > >&, std::mutex&, mp::Connection*, std::function<mp::Thread::Client ()>)'\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: ipc/libbitcoin_ipc.a(mining.capnp.proxy-client.c++.o):/bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-types.h:89: more undefined references to `mp::SetThread(std::map<mp::Connection*, mp::ProxyClient<mp::Thread>, std::less<mp::Connection*>, std::allocator<std::pair<mp::Connection* const, mp::ProxyClient<mp::Thread> > > >&, std::mutex&, mp::Connection*, std::function<mp::Thread::Client ()>)' follow\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: ipc/libbitcoin_ipc.a(process.cpp.o): in function `ipc::(anonymous namespace)::ProcessImpl::spawn(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, fs::path const&, int&)':\r\n/bitcoin/build/src/ipc/./ipc/process.cpp:36:(.text+0x260): undefined reference to `mp::SpawnProcess(int&, std::function<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > (int)>&&)'\r\n/usr/lib/gcc/aarch64-alpine-linux-musl/14.2.0/../../../../aarch64-alpine-linux-musl/bin/ld: ipc/libbitcoin_ipc.a(protocol.cpp.o): in function `mp::ProxyClientBase<ipc::capnp::messages::Init, interfaces::Init>::ProxyClientBase(ipc::capnp::messages::Init::Client, mp::Connection*, bool)::{lambda()#2}::operator()() const':\r\n/bitcoin/depends/aarch64-unknown-linux-musl/include/mp/proxy-io.h:409:(.text._ZNSt17_Function_handlerIFvvEZN2mp15ProxyClientBaseIN3ipc5capnp8messages4InitEN10interfaces4InitEEC4ENS6_6ClientEPNS1_10ConnectionEbEUlvE0_E9_M_invokeERKSt9_Any_data[_ZNSt17_Function_handlerIFvvEZN2mp15ProxyClientBaseIN3ipc5capnp8messages4InitEN10interfaces4InitEEC4ENS6_6ClientEPNS1_10ConnectionEbEUlvE0_E9_M_invokeERKSt9_Any_data]+0x40): undefined reference to `mp::Connection::removeSyncCleanup(std::_List_iterator<std::function<void ()> >)'\r\ncollect2: error: ld returned 1 exit status\r\n```",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2024-12-10T11:04:07Z",
      "updated_at": "2026-02-03T11:06:26Z",
      "closed_at": "2025-02-03T15:02:18Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/31455",
      "labels": [
        "Build system",
        "interfaces"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 19298,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2611936910,
      "number": 31151,
      "title": "ci: intermittent issue in rpc_misc.py   node0 stderr terminate called after throwing an instance of 'kj::ExceptionImpl' [15:12:14.943]   what():  mp/proxy.cpp:242: disconnected: write(m_post_fd, &buffer, 1): Broken pipe",
      "body": "https://cirrus-ci.com/task/5442110629871616?logs=ci#L3430\r\n\r\n```\r\n[15:12:14.943]  node0 2024-10-24T15:12:14.578291Z [shutoff] [src/logging/timer.h:58] [Log] [bench] FlushStateToDisk: write block and undo data to disk started \r\n[15:12:14.943]  node0 2024-10-24T15:12:14.578357Z [shutoff] [src/logging/timer.h:58] [Log] [bench] FlushStateToDisk: write block and undo data to disk completed (0.06ms) \r\n[15:12:14.943]  node0 2024-10-24T15:12:14.578365Z [shutoff] [src/logging/timer.h:58] [Log] [bench] FlushStateToDisk: write block index to disk started \r\n[15:12:14.943]  node0 2024-10-24T15:12:14.578381Z [shutoff] [src/logging/timer.h:58] [Log] [bench] FlushStateToDisk: write block index to disk completed (0.01ms) \r\n[15:12:14.943]  node0 2024-10-24T15:12:14.578390Z [shutoff] [src/logging/timer.h:58] [Log] [bench] FlushStateToDisk: write coins cache to disk (0 coins, 262kB) started \r\n[15:12:14.943]  node0 2024-10-24T15:12:14.578406Z [shutoff] [src/txdb.cpp:146] [BatchWrite] [coindb] Writing final batch of 0.00 MiB \r\n[15:12:14.943]  node0 2024-10-24T15:12:14.578614Z [shutoff] [src/txdb.cpp:148] [BatchWrite] [coindb] Committed 0 changed transaction outputs (out of 0) to coin database... \r\n[15:12:14.943]  node0 2024-10-24T15:12:14.578640Z [shutoff] [src/logging/timer.h:58] [Log] [bench] FlushStateToDisk: write coins cache to disk (0 coins, 262kB) completed (0.24ms) \r\n[15:12:14.943]  node0 2024-10-24T15:12:14.578654Z [shutoff] [src/validationinterface.cpp:245] [ChainStateFlushed] [validation] Enqueuing ChainStateFlushed: block hash=08088a81df63d1c115663bb817c7ce81057d3e9e57dc706c85e4f3878390e828 \r\n[15:12:14.943]  node0 2024-10-24T15:12:14.585972Z [shutoff] [src/init.cpp:398] [Shutdown] Shutdown: done \r\n[15:12:14.943]  node0 2024-10-24T15:12:14.586061Z [capnp-loop] [src/ipc/capnp/protocol.cpp:35] [IpcLogFn] [ipc] {bitcoin-node-21814/b-capnp-loop-21841} EventLoop::loop done, cancelling event listeners. \r\n[15:12:14.943]  node0 2024-10-24T15:12:14.586078Z [capnp-loop] [src/ipc/capnp/protocol.cpp:35] [IpcLogFn] [ipc] {bitcoin-node-21814/b-capnp-loop-21841} EventLoop::loop bye. \r\n[15:12:14.943]  test  2024-10-24T15:12:14.621000Z TestFramework (ERROR): Assertion failed \r\n[15:12:14.943]                                    Traceback (most recent call last):\r\n[15:12:14.943]                                      File \"/ci_container_base/test/functional/test_framework/test_framework.py\", line 132, in main\r\n[15:12:14.943]                                        self.run_test()\r\n[15:12:14.943]                                      File \"/ci_container_base/ci/scratch/build-i686-pc-linux-gnu/test/functional/rpc_misc.py\", line 83, in run_test\r\n[15:12:14.943]                                        self.restart_node(0, [\"-txindex\", \"-blockfilterindex\", \"-coinstatsindex\"])\r\n[15:12:14.943]                                      File \"/ci_container_base/test/functional/test_framework/test_framework.py\", line 595, in restart_node\r\n[15:12:14.943]                                        self.stop_node(i)\r\n[15:12:14.943]                                      File \"/ci_container_base/test/functional/test_framework/test_framework.py\", line 581, in stop_node\r\n[15:12:14.943]                                        self.nodes[i].stop_node(expected_stderr, wait=wait)\r\n[15:12:14.943]                                      File \"/ci_container_base/test/functional/test_framework/test_node.py\", line 410, in stop_node\r\n[15:12:14.943]                                        self.wait_until_stopped(expected_stderr=expected_stderr)\r\n[15:12:14.943]                                      File \"/ci_container_base/test/functional/test_framework/test_node.py\", line 445, in wait_until_stopped\r\n[15:12:14.943]                                        self.wait_until(lambda: self.is_node_stopped(**kwargs), timeout=timeout)\r\n[15:12:14.943]                                      File \"/ci_container_base/test/functional/test_framework/test_node.py\", line 843, in wait_until\r\n[15:12:14.943]                                        return wait_until_helper_internal(test_function, timeout=timeout, timeout_factor=self.timeout_factor)\r\n[15:12:14.943]                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n[15:12:14.943]                                      File \"/ci_container_base/test/functional/test_framework/util.py\", line 292, in wait_until_helper_internal\r\n[15:12:14.943]                                        if predicate():\r\n[15:12:14.943]                                           ^^^^^^^^^^^\r\n[15:12:14.943]                                      File \"/ci_container_base/test/functional/test_framework/test_node.py\", line 445, in <lambda>\r\n[15:12:14.943]                                        self.wait_until(lambda: self.is_node_stopped(**kwargs), timeout=timeout)\r\n[15:12:14.943]                                                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n[15:12:14.943]                                      File \"/ci_container_base/test/functional/test_framework/test_node.py\", line 430, in is_node_stopped\r\n[15:12:14.943]                                        raise AssertionError(\"Unexpected stderr {} != {}\".format(stderr, expected_stderr))\r\n[15:12:14.943]                                    AssertionError: Unexpected stderr terminate called after throwing an instance of 'kj::ExceptionImpl'\r\n[15:12:14.943]                                      what():  mp/proxy.cpp:242: disconnected: write(m_post_fd, &buffer, 1): Broken pipe\r\n[15:12:14.943]                                    stack: 657ed083 657ed86e f7ac7d20 f7713156 f77a7e07 !=\r\n[15:12:14.943]  test  2024-10-24T15:12:14.623000Z TestFramework (DEBUG): Closing down network thread \r\n[15:12:14.943]  test  2024-10-24T15:12:14.673000Z TestFramework (INFO): Stopping nodes \r\n[15:12:14.943]  test  2024-10-24T15:12:14.673000Z TestFramework.node0 (DEBUG): Stopping node \r\n[15:12:14.943] \r\n[15:12:14.943]  node0 stderr terminate called after throwing an instance of 'kj::ExceptionImpl'\r\n[15:12:14.943]   what():  mp/proxy.cpp:242: disconnected: write(m_post_fd, &buffer, 1): Broken pipe\r\n[15:12:14.943] stack: 657ed083 657ed86e f7ac7d20 f7713156 f77a7e07 ",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2024-10-24T15:27:34Z",
      "updated_at": "2026-02-03T11:06:26Z",
      "closed_at": "2025-01-27T15:08:17Z",
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/issues/31151",
      "labels": [
        "interfaces",
        "CI failed"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 6436,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1453726595,
      "number": 26527,
      "title": "wallet: don't back-date locktime when spending unconfirmed UTXOs",
      "body": "As mentioned in https://github.com/bitcoin/bitcoin/pull/26451#issuecomment-1313934927 example 3:\r\n\r\nIf we do anti-fee sniping, the Bitcoin Core wallet has a 10% chance to back-date the locktime of a transaction to up to 100 blocks.  Electrum has similar behavior.\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/48174c0f287b19931ca110670610bd03a03eb914/src/wallet/spend.cpp#L725-L731\r\n\r\nWhen spending an unconfirmed UTXO, it can happen that we back-date the locktime of our transaction to a locktime before the locktime of the unconfirmed parent. In this case, the \"transaction signed earlier but only broadcast now\" is unrealistic I think (please correct me if you think there is a protocol where this makes sense). This is a fingerprint that we are a Bitcoin Core or Electrum wallet.\r\n\r\nrelated https://github.com/bitcoin/bitcoin/issues/26526\r\nelectrum issue: https://github.com/spesmilo/electrum/issues/8073",
      "state": "open",
      "user": "0xB10C",
      "created_at": "2022-11-17T17:35:57Z",
      "updated_at": "2026-02-02T21:43:05Z",
      "closed_at": null,
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/26527",
      "labels": [
        "Feature",
        "Wallet",
        "RPC/REST/ZMQ"
      ],
      "comment_data": [
        {
          "id": 3818834598,
          "user": "danielabrozzoni",
          "body": "Hey! I spent some time thinking about this, ~~and implemented it in #34449~~ (I closed this one, a revised one will be opened).\nInstead of not backdating at all, I decided to limit the locktime to the maximum of the parent transactions' locktimes. \n\nHowever... While writing the PR description, I realized, why would we enforce this only for unconfirmed parents? Wouldn't it make sense to make sure that the fee sniping nlocktime is >= the locktime of any parent, regardless of whether they're unconfirmed or not?\n\nWe want to use anti fee sniping while preserving some plausible deniability, so that it’s not obvious from a transaction whether we’re fee sniping or simply using nLockTime. If a child transaction has an nLockTime earlier than its parent’s nLockTime, even when the parent is confirmed, it’s not really possible to explain it as \"signed earlier and broadcast later\", and everyone can infer we're fee sniping. Am I missing something?",
          "created_at": "2026-01-29T16:33:09Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 946,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3837530439,
          "user": "achow101",
          "body": "> Wouldn't it make sense to make sure that the fee sniping nlocktime is >= the locktime of any parent, regardless of whether they're unconfirmed or not?\n\nThat seems reasonable",
          "created_at": "2026-02-02T21:43:05Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 175,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 970,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3846299633,
      "number": 34387,
      "title": "qa: failure in p2p_private_broadcast.py",
      "body": "Noticed on the test-each-commit job for #32857:\n\nhttps://github.com/bitcoin/bitcoin/actions/runs/21254115595/job/61163625701?pr=32857\n\n```\n node1 2026-01-22T16:33:40.225497Z [http] [httpserver.cpp:308] [http_request_cb] [http] Received a POST request for / from 127.0.0.1:40648 \n node1 2026-01-22T16:33:40.225559Z [httpworker.1] [rpc/request.cpp:243] [parse] [rpc] ThreadRPCServer method=getrawmempool user=__cookie__ \n test  2026-01-22T16:33:40.276527Z TestFramework.utils (ERROR): wait_until() failed. Predicate: '''' \n                                           self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n                                   '''\n test  2026-01-22T16:33:40.276665Z TestFramework (ERROR): Unexpected exception \n                                   Traceback (most recent call last):\n                                     File \"/home/runner/work/bitcoin/bitcoin/test/functional/test_framework/test_framework.py\", line 142, in main\n                                       self.run_test()\n                                     File \"/home/runner/work/bitcoin/bitcoin/ci_build/test/functional/p2p_private_broadcast.py\", line 331, in run_test\n                                       self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n                                     File \"/home/runner/work/bitcoin/bitcoin/test/functional/test_framework/test_framework.py\", line 746, in wait_until\n                                       return wait_until_helper_internal(test_function, timeout=timeout, timeout_factor=self.options.timeout_factor, check_interval=check_interval)\n                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/home/runner/work/bitcoin/bitcoin/test/functional/test_framework/util.py\", line 420, in wait_until_helper_internal\n                                       raise AssertionError(\"Predicate {} not true after {} seconds\".format(predicate_source, timeout))\n                                   AssertionError: Predicate ''''\n                                           self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n                                   ''' not true after 60 seconds\n test  2026-01-22T16:33:40.277541Z TestFramework (DEBUG): Closing down network thread \n test  2026-01-22T16:33:40.327831Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later. \n```",
      "state": "open",
      "user": "Sjors",
      "created_at": "2026-01-23T07:56:48Z",
      "updated_at": "2026-02-02T11:46:40Z",
      "closed_at": null,
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/34387",
      "labels": [
        "CI failed"
      ],
      "comment_data": [
        {
          "id": 3834644353,
          "user": "fanquake",
          "body": "https://github.com/bitcoin/bitcoin/actions/runs/21585565985/job/62192717154?pr=34474#step:14:223",
          "created_at": "2026-02-02T11:46:40Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 96,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2582,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3710207618,
      "number": 34034,
      "title": "build: Bump macOS SDK for release builds?",
      "body": "Currently, the macOS SDK Xcode version is set to 15.0 in the guix release builds.\n\nMy understanding is that it should be harmless to bump. Though, it involves a bit of effort to check for determinism. C.f. https://github.com/bitcoin/bitcoin/pull/32009\n\nSo I wonder if it seems appropriate to bump the SDK to the latest version for the next 31.x release, or if it should wait for the 32.x release?\n\nThe main visible benefit would be that `lexicographical_compare_three_way` will be available. C.f. https://github.com/bitcoin/bitcoin/pull/33772#issuecomment-3481100244, and also cc @l0rinc .",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-12-09T10:24:22Z",
      "updated_at": "2026-02-02T10:45:11Z",
      "closed_at": "2026-02-02T10:45:11Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34034",
      "labels": [
        "Brainstorming",
        "Build system"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 631,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3737265193,
      "number": 34086,
      "title": "doc: Use multi-path descriptors in descriptors.md and linked tests.",
      "body": "### Motivation\n\nA single multipath descriptor is the most convenient pattern for multisig; our documentation should use it.\n\nThese files should use multipath descriptors as per https://github.com/bitcoin/bitcoin/commit/2a46e94a1600a4f28e01db23a89f039acaa2c45e and https://github.com/bitcoin/bitcoin/pull/33286:\n\n**Locations:**\n- [ ] [doc/descriptors.md](https://github.com/bitcoin/bitcoin/tree/master/doc/descriptors.md):\n  - [ ] \"Basic Multisig Example\"\n  - [ ] \"Examples\" with this text:\n    > For brevity, the internal \"change\" descriptor accompanying the above external \"receiving\" descriptor is not included here, but it typically differs only in the xpub derivation steps, ending in /1/* for change addresses. \n- [ ] [wallet_miniscript_decaying_multisig_descriptor_psbt.py](https://github.com/bitcoin/bitcoin/tree/master/test/functional/wallet_miniscript_decaying_multisig_descriptor_psbt.py) functional test\n\n### Possible solution\n\nThis only requires familiarity with multi-path descriptor semantics to solve. See [Specifying receiving and change descriptors in one descriptor](https://github.com/bitcoin/bitcoin/blob/master/doc/descriptors.md#specifying-receiving-and-change-descriptors-in-one-descriptor) for how to update `desciptors.md` and #33286's [functional test diff](https://github.com/bitcoin/bitcoin/pull/33286/changes#diff-94f52fa5de899f58d07aca5026545378bc3da616d4927d71435fa0224eda589b) for an approach to solve this issue in the functional test.\n\n\n### Useful Skills\n\n* Understanding of multi-path descriptor semantics\n* Running the Python functional tests\n* Basic Python\n\n### Guidance for new contributors\n\nWant to work on this issue?\n\nFor guidance on contributing, please read [CONTRIBUTING.md](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md) before opening your pull request.\n",
      "state": "closed",
      "user": "BenWestgate",
      "created_at": "2025-12-17T04:16:29Z",
      "updated_at": "2026-02-02T00:40:22Z",
      "closed_at": "2026-01-31T01:30:06Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/34086",
      "labels": [
        "good first issue"
      ],
      "comment_data": [
        {
          "id": 3832388688,
          "user": "BenWestgate",
          "body": "I don't think those descriptor checksums were fake.\n\nI used them as test vectors and they all passed.\n\nGrabbing the checksum of a multi-path descriptor is in a different field than for canonical form but they do have a checksum.\n\nAnd it should be used for backups.\n\nIf you agree with this nit, I'll open a PR to append the multi-path descriptor's checksum in descriptors.md",
          "created_at": "2026-02-02T00:40:22Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 2,
            "text_length": 373,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1885,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 2823379110,
      "number": 31769,
      "title": "incrementalrelayfee configuration option should be present in bitcoin.conf",
      "body": "### Please describe the feature you'd like to see added.\n\n... just like minrelaytxfee and others. Ideally, bitcoin.conf should encompass all configuration options.\n\n### Is your feature related to a problem, if so please describe it.\n\nAs a user, I would like to specify value of the incrementalrelayfee configuration option in bitcoin.conf file so that I don't have to type it in a command line each time I start bitcoind.\n\nIn Bitcoin 28.1, the option is hidden, i.e. there isn't any description of the option shown in --help.\n\n### Describe the solution you'd like\n\n_No response_\n\n### Describe any alternatives you've considered\n\n_No response_\n\n### Please leave any additional context\n\n_No response_",
      "state": "closed",
      "user": "GregTonoski",
      "created_at": "2025-01-31T12:47:47Z",
      "updated_at": "2026-01-31T11:04:48Z",
      "closed_at": "2025-01-31T15:01:07Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/31769",
      "labels": [
        "Feature"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 773,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3856656444,
      "number": 34414,
      "title": "guix: Re-evaluate fdebug-prefix-map",
      "body": "It could make sense to double check an re-evaluate if this is all right. Original comment follows:\r\n\r\nHowever, some source files are generated and reside in the build tree. So the mapping should be:\r\n\r\n```diff\r\n-HOST_CFLAGS+=\" -fdebug-prefix-map=${DISTSRC}/src=.\"\r\n+HOST_CFLAGS+=\" -fdebug-prefix-map=${DISTSRC}=.\"\r\n```\r\n\r\nOtherwise, paths become inconsistent and problematic for configuring source remapping in the debugger:\r\n```\r\n$ gdb ./bitcoin-fa37928536e0/libexec/bitcoin-node\r\n(gdb) break IsRoutable\r\nBreakpoint 1 at 0xb2aa40: file ./netaddress.cpp, line 463.\r\n(gdb) break mp::ProxyClient<ipc::capnp::messages::Init>::construct\r\nBreakpoint 2 at 0x5d82e0: file /distsrc-base/distsrc-fa37928536e0-x86_64-linux-gnu/build/src/ipc/capnp/init.capnp.proxy-client.c++, line 18.\r\n```\r\n\r\n_Originally posted by @hebasto in https://github.com/bitcoin/bitcoin/pull/34281#discussion_r2727335884_\r\n            ",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-26T16:21:01Z",
      "updated_at": "2026-01-31T08:50:30Z",
      "closed_at": null,
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34414",
      "labels": [
        "Build system"
      ],
      "comment_data": [
        {
          "id": 3827858794,
          "user": "BharathC0",
          "body": "@maflcko fixes #34468 ",
          "created_at": "2026-01-31T08:16:22Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 22,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 936,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3834142125,
      "number": 34354,
      "title": "Windows CI failure: restore wallet test case related to pruned blockchain in `wallet_assumeutxo.py` is failing.",
      "body": "ISTM that the [Windows, ucrt, test cross-built CI failure](https://github.com/bitcoin/bitcoin/actions/runs/21172425203/job/60894641918?pr=33014) is unrelated, a restore wallet test case related to pruned blockchain in `wallet_assumeutxo.py` is failing.\r\n\r\n<details open>\r\n<summary>From the logs:</summary>\r\n\r\n```zsh\r\n2026-01-20T13:41:07.2385503Z 2026-01-20T13:41:04.152353Z TestFramework (INFO): Ensuring wallet can't be restored from a backup that was created before the pruneheight (pruned node)\r\n2026-01-20T13:41:07.2386535Z \r\n2026-01-20T13:41:07.2386839Z 2026-01-20T13:41:06.479889Z TestFramework (ERROR): Unexpected exception\r\n2026-01-20T13:41:07.2387306Z \r\n2026-01-20T13:41:07.2387503Z Traceback (most recent call last):\r\n2026-01-20T13:41:07.2387815Z \r\n2026-01-20T13:41:07.2388269Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\util.py\", line 166, in try_rpc\r\n2026-01-20T13:41:07.2388901Z \r\n2026-01-20T13:41:07.2389049Z     fun(*args, **kwds)\r\n2026-01-20T13:41:07.2389318Z \r\n2026-01-20T13:41:07.2389432Z     ~~~^^^^^^^^^^^^^^^\r\n2026-01-20T13:41:07.2389660Z \r\n2026-01-20T13:41:07.2390180Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\coverage.py\", line 50, in __call__\r\n2026-01-20T13:41:07.2390808Z \r\n2026-01-20T13:41:07.2391156Z     return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n2026-01-20T13:41:07.2391651Z \r\n2026-01-20T13:41:07.2392093Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\authproxy.py\", line 156, in __call__\r\n2026-01-20T13:41:07.2392771Z \r\n2026-01-20T13:41:07.2392996Z     raise JSONRPCException(response['error'], status)\r\n2026-01-20T13:41:07.2393424Z \r\n2026-01-20T13:41:07.2395532Z test_framework.authproxy.JSONRPCException: filesystem error: cannot remove: The process cannot access the file because it is being used by another process [D:\\a\\_temp\\test_runner_₿_🏃_20260120_132914\\wallet_assumeutxo_56\\node3\\regtest\\w2\\wallet.dat] (-1)\r\n2026-01-20T13:41:07.2397271Z \r\n2026-01-20T13:41:07.2397277Z \r\n2026-01-20T13:41:07.2397281Z \r\n2026-01-20T13:41:07.2397613Z During handling of the above exception, another exception occurred:\r\n2026-01-20T13:41:07.2398102Z \r\n2026-01-20T13:41:07.2398107Z \r\n2026-01-20T13:41:07.2398112Z \r\n2026-01-20T13:41:07.2398334Z Traceback (most recent call last):\r\n2026-01-20T13:41:07.2398622Z \r\n2026-01-20T13:41:07.2399135Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\test_framework.py\", line 142, in main\r\n2026-01-20T13:41:07.2399796Z \r\n2026-01-20T13:41:07.2399922Z     self.run_test()\r\n2026-01-20T13:41:07.2400161Z \r\n2026-01-20T13:41:07.2400286Z     ~~~~~~~~~~~~~^^\r\n2026-01-20T13:41:07.2400474Z \r\n2026-01-20T13:41:07.2400948Z   File \"D:\\a\\bitcoin\\bitcoin/test/functional/wallet_assumeutxo.py\", line 267, in run_test\r\n2026-01-20T13:41:07.2401587Z \r\n2026-01-20T13:41:07.2401827Z     self.test_restore_wallet_pruneheight(n3)\r\n2026-01-20T13:41:07.2402338Z \r\n2026-01-20T13:41:07.2402476Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^\r\n2026-01-20T13:41:07.2402806Z \r\n2026-01-20T13:41:07.2403384Z   File \"D:\\a\\bitcoin\\bitcoin/test/functional/wallet_assumeutxo.py\", line 99, in test_restore_wallet_pruneheight\r\n2026-01-20T13:41:07.2404151Z \r\n2026-01-20T13:41:07.2404691Z     assert_raises_rpc_error(-4, error_message, n3.restorewallet, \"w2\", \"backup_w2.dat\")\r\n2026-01-20T13:41:07.2405294Z \r\n2026-01-20T13:41:07.2405553Z     ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n2026-01-20T13:41:07.2405970Z \r\n2026-01-20T13:41:07.2406496Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\util.py\", line 157, in assert_raises_rpc_error\r\n2026-01-20T13:41:07.2407238Z \r\n2026-01-20T13:41:07.2407544Z     assert try_rpc(code, message, fun, *args, **kwds), \"No exception raised\"\r\n2026-01-20T13:41:07.2408097Z \r\n2026-01-20T13:41:07.2408261Z            ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n2026-01-20T13:41:07.2408598Z \r\n2026-01-20T13:41:07.2409048Z   File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\util.py\", line 170, in try_rpc\r\n2026-01-20T13:41:07.2409645Z \r\n2026-01-20T13:41:07.2410041Z     raise AssertionError(\"Unexpected JSONRPC error code %i\" % e.error[\"code\"])\r\n2026-01-20T13:41:07.2410583Z \r\n2026-01-20T13:41:07.2410797Z AssertionError: Unexpected JSONRPC error code -1\r\n2026-01-20T13:41:07.2411215Z \r\n2026-01-20T13:41:07.2411925Z 2026-01-20T13:41:06.484138Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\r\n2026-01-20T13:41:07.2412795Z \r\n2026-01-20T13:41:07.2413676Z 2026-01-20T13:41:06.484270Z TestFramework (WARNING): Not cleaning up dir D:\\a\\_temp\\test_runner_₿_🏃_20260120_132914\\wallet_assumeutxo_56\r\n2026-01-20T13:41:07.2414525Z \r\n2026-01-20T13:41:07.2415646Z 2026-01-20T13:41:06.484375Z TestFramework (ERROR): Test failed. Test logging available at D:\\a\\_temp\\test_runner_₿_🏃_20260120_132914\\wallet_assumeutxo_56/test_framework.log\r\n2026-01-20T13:41:07.2416737Z \r\n\r\n2026-01-20T13:42:33.3464929Z wallet_assumeutxo.py                                                             | ✖ Failed  | 8 s\r\n2026-01-20T13:42:33.3465209Z \r\n2026-01-20T13:42:33.3465460Z ALL                                                                              | ✖ Failed  | 2893 s (accumulated) \r\n2026-01-20T13:42:33.3465784Z Runtime: 796 s\r\n\r\n```\r\n</details>\r\n\r\n_Originally posted by @rkrux in https://github.com/bitcoin/bitcoin/issues/33014#issuecomment-3773073528_\r\n            ",
      "state": "open",
      "user": "maflcko",
      "created_at": "2026-01-20T15:07:00Z",
      "updated_at": "2026-01-30T15:56:41Z",
      "closed_at": null,
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/issues/34354",
      "labels": [
        "Wallet",
        "Windows",
        "Tests",
        "CI failed"
      ],
      "comment_data": [
        {
          "id": 3823374615,
          "user": "fanquake",
          "body": "https://github.com/bitcoin/bitcoin/actions/runs/21513900951/job/61988945140?pr=34452#step:12:221",
          "created_at": "2026-01-30T12:05:54Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 96,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3823825044,
          "user": "Sjors",
          "body": "I ran this test a couple of times on a windows machine, but couldn't reproduce. I'll let it run in a loop for a while.... Update: still no failure after 400+ runs.\n\nMaybe there's some changes I can make to increase the likeliness of failure?",
          "created_at": "2026-01-30T13:41:56Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 241,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3824329163,
          "user": "Sjors",
          "body": "The following (vibe coded) patch seems to reliably reproduce the issue on my Windows machine:\n\n```diff\ndiff --git a/src/wallet/sqlite.cpp b/src/wallet/sqlite.cpp\nindex e72455a3be..c23268d30a 100644\n--- a/src/wallet/sqlite.cpp\n+++ b/src/wallet/sqlite.cpp\n@@ -20,0 +21,5 @@\n+#ifdef WIN32\n+#include <windows.h>\n+#include <thread>\n+#endif\n+\n@@ -376,0 +382,23 @@ void SQLiteDatabase::Close()\n+\n+#ifdef WIN32\n+    // TEST: Immediately after closing SQLite, grab an exclusive lock on the file.\n+    // This simulates Windows not releasing the file handle immediately after sqlite3_close().\n+    // The lock is held for 200ms, causing fs::remove() to fail if called too soon.\n+    std::wstring full_path_w = (m_dir_path / fs::PathFromString(m_file_path)).wstring();\n+    HANDLE hFile = CreateFileW(\n+        full_path_w.c_str(),\n+        GENERIC_READ | GENERIC_WRITE,\n+        0,  // No sharing - exclusive access\n+        NULL,\n+        OPEN_EXISTING,\n+        FILE_ATTRIBUTE_NORMAL,\n+        NULL\n+    );\n+    if (hFile != INVALID_HANDLE_VALUE) {\n+        // Detach a thread to hold the lock, so Close() returns immediately\n+        std::thread([hFile]() {\n+            std::this_thread::sleep_for(std::chrono::milliseconds(200));\n+            CloseHandle(hFile);\n+        }).detach();\n+    }\n+#endif\n```\n",
          "created_at": "2026-01-30T15:31:01Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 1299,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3824411701,
          "user": "Sjors",
          "body": "And here's a trivial albeit not elegant fix:\n\n```diff\ndiff --git a/src/wallet/wallet.cpp b/src/wallet/wallet.cpp\nindex 64d7f191de..ba3c1d4c75 100644\n--- a/src/wallet/wallet.cpp\n+++ b/src/wallet/wallet.cpp\n@@ -538 +538,7 @@ std::shared_ptr<CWallet> RestoreWallet(WalletContext& context, const fs::path& b\n-        if (wallet_file_copied) fs::remove(wallet_file);\n+        if (wallet_file_copied) {\n+            // On Windows, and e.g. on network file systems for all platforms,\n+            // file handles may not be released immediately after closing, so\n+            // wait briefly before attempting removal.\n+            std::this_thread::sleep_for(std::chrono::seconds(1));\n+            fs::remove(wallet_file);\n+        }\n```",
          "created_at": "2026-01-30T15:50:21Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 731,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 5519,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 1981042386,
      "number": 28811,
      "title": "fuzz: Left over tmp files when fuzzing with afl++",
      "body": "I frequently run out of disk space when fuzzing our targets with afl++ due to left over tmp files created by our `TestingSetup`s. Similar issues were previously reported (see #22572, #22472).\r\n\r\nThe tmp files are left over when test cases cause timeouts (or crashes) and the afl++ fork-server simply kills the process, leaving it no time to cleanup. Note: this is not a bug in afl++, they specifically advise against creating tmp files in fuzz tests. Increasing the timeout threshold sort of works but it more or less just slows down the disk filling.\r\n\r\n`TestingSetup` should have a memory-only option that results in no disk usage at all.\r\n\r\n* Using a ram disks doesn't work because they would run out of memory\r\n* The fix in #22472 doesn't work when fuzzing on multiple cores",
      "state": "closed",
      "user": "dergoegge",
      "created_at": "2023-11-07T10:34:21Z",
      "updated_at": "2026-01-30T09:27:33Z",
      "closed_at": "2026-01-30T09:27:33Z",
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/issues/28811",
      "labels": [
        "Tests",
        "Fuzzing"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 828,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3680657459,
      "number": 33982,
      "title": "build: `guix` package was removed from debian",
      "body": "Apparently the `guix` debian package was no longer maintained, and was removed from debian recently (see https://lwn.net/Articles/1035491/). Ubuntu and other debian derivatives will likely follow.\n\nThis means we need new setup instructions for guix on debian in `contrib/guix/INSTALL.md`.",
      "state": "open",
      "user": "laanwj",
      "created_at": "2025-12-01T11:58:44Z",
      "updated_at": "2026-01-29T22:43:59Z",
      "closed_at": null,
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/issues/33982",
      "labels": [
        "Docs",
        "Build system"
      ],
      "comment_data": [
        {
          "id": 3820452389,
          "user": "davidgumberg",
          "body": "> https://guix.gnu.org/en/blog/2026/gnu-guix-1.5.0-released/\n\nNice!\n\n@laanwj Skimming the release notes:\n\n> Release tarballs are now available for the RISC-V 64-bit architecture (riscv64-linux).\n",
          "created_at": "2026-01-29T21:27:44Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 195,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3820801450,
          "user": "hebasto",
          "body": "> > https://guix.gnu.org/en/blog/2026/gnu-guix-1.5.0-released/\n> \n> Nice!\n> \n> [@laanwj](https://github.com/laanwj) Skimming the release notes:\n> \n> > Release tarballs are now available for the RISC-V 64-bit architecture (riscv64-linux).\n\nA modern Linux kernel is still necessary. The [Elastic Metal RV1](https://labs.scaleway.com/en/em-rv1/) running kernel 5.10 is a nightmare.",
          "created_at": "2026-01-29T22:43:59Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 378,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 334,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3804550497,
      "number": 34263,
      "title": "rpc: Assertion '!pindex || pindex->GetBlockHash() == view->GetBestBlock()' failed during `gettxoutsetinfo`",
      "body": "The `CHECK_NONFATAL`  check [here](https://github.com/bitcoin/bitcoin/blob/abc6a3a4eb9814a7f17e40f7a4d330cbef86bff0/src/rpc/blockchain.cpp#L976) may fail when `gettxoutsetinfo` is called.\n\n```\nrpc/blockchain.cpp:976 std::optional<kernel::CCoinsStats> GetUTXOStats(CCoinsView *, node::BlockManager &, kernel::CoinStatsHashType, const std::function<void ()> &, const CBlockIndex *, bool): Assertion `!pindex || pindex->GetBlockHash() == view->GetBestBlock()' failed.\n```\n\nI've not written a test for this, but looking at the code, it seems that there is a race where the coins view's best block gets updated in between [here](https://github.com/bitcoin/bitcoin/blob/abc6a3a4eb9814a7f17e40f7a4d330cbef86bff0/src/rpc/blockchain.cpp#L1054C9-L1054C15) and [here](https://github.com/bitcoin/bitcoin/blob/abc6a3a4eb9814a7f17e40f7a4d330cbef86bff0/src/rpc/blockchain.cpp#L976) (e.g. because a new block is connected), causing the check to fail (resulting in an assertion failure in debug builds).\n\nSee attached debug logs for an example.\n\n[gettxoutsetinfo_check_nonfatal.log](https://github.com/user-attachments/files/24566483/gettxoutsetinfo_check_nonfatal.log)\n\n\n*This was found with a test running on [Antithesis](https://antithesis.com/).*",
      "state": "open",
      "user": "dergoegge",
      "created_at": "2026-01-12T14:24:58Z",
      "updated_at": "2026-01-29T19:28:22Z",
      "closed_at": null,
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34263",
      "labels": [
        "RPC/REST/ZMQ"
      ],
      "comment_data": [
        {
          "id": 3819825757,
          "user": "w0xlt",
          "body": "Suggested fix: https://github.com/bitcoin/bitcoin/pull/34451",
          "created_at": "2026-01-29T19:28:22Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 60,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1340,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3862308356,
      "number": 34423,
      "title": "uptime RPC returns 0 on first invocation",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nFirst time `bitcoin-cli uptime` is called, output is always zero.\n\n### Expected behaviour\n\nExpected behavior should be first time invocation of `bitcoin-cli uptime` shows the actual `bitcoind` uptime.\n\n### Steps to reproduce\n\nOn Linux:\n\n1. `./build/bin/bitcoind -regtest -daemon`\n2. `sleep 10`\n3. `./build/bin/bitcoin-cli -regtest uptime`\n\nOutput is zero, while non-zero is expected.\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nv30.99.0-c0e6556e4f51\n\n### Operating system and version\n\nUbuntu 22.04.5 LTS\n\n### Machine specifications\n\n_No response_",
      "state": "open",
      "user": "carloantinarella",
      "created_at": "2026-01-27T20:26:11Z",
      "updated_at": "2026-01-29T19:06:21Z",
      "closed_at": null,
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/issues/34423",
      "labels": [
        "Bug",
        "RPC/REST/ZMQ"
      ],
      "comment_data": [
        {
          "id": 3816813000,
          "user": "dergoegge",
          "body": "@carloantinarella out of curiosity what is your usecase for the `uptime` RPC? Any reason you prefer it over querying your OS for the uptime of the bitcoind process?",
          "created_at": "2026-01-29T10:32:58Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 164,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3819723365,
          "user": "carloantinarella",
          "body": "No special needs, I just use it to check if the node is up and running. It's os agnostic and returns plain number (good for quick scripting). ",
          "created_at": "2026-01-29T19:06:21Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 142,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 800,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3434544542,
      "number": 33438,
      "title": "ci: add (atleast one) *BSD job to the CI",
      "body": "See https://github.com/bitcoin/bitcoin/pull/33333#discussion_r2362493046 & #33435. BSDs are being tested in nightly repos, but merging code here, just to have it reported as broken after the fact, which then requires more changes to fix, isn't ideal. Issues should be caught in this repo, before merging.",
      "state": "open",
      "user": "fanquake",
      "created_at": "2025-09-19T14:12:56Z",
      "updated_at": "2026-01-29T17:54:57Z",
      "closed_at": null,
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/33438",
      "labels": [
        "Tests"
      ],
      "comment_data": [
        {
          "id": 3817180275,
          "user": "fanquake",
          "body": "> but merging code here, just to have it reported as broken after the fact, which then requires more changes to fix, isn't ideal. \n\nThis has happened again with #34186 -> #34331 -> #34346. ",
          "created_at": "2026-01-29T11:53:02Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 189,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3819255460,
          "user": "hebasto",
          "body": "> > but merging code here, just to have it reported as broken after the fact, which then requires more changes to fix, isn't ideal.\n> \n> This has happened again with [#34186](https://github.com/bitcoin/bitcoin/pull/34186) -> [#34331](https://github.com/bitcoin/bitcoin/issues/34331) -> [#34346](https://github.com/bitcoin/bitcoin/pull/34346).\n\nI fully support extending platform coverage in the repo CI. However, that wouldn't necessarily prevent the problems described above, because the issue reported in #34331 is probabilistic in nature.",
          "created_at": "2026-01-29T17:48:37Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 541,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3819283323,
          "user": "maflcko",
          "body": "Another issue seems to be that even a pinned freebsd isn't deterministic: https://github.com/bitcoin/bitcoin/pull/34093#issuecomment-3812614894?\n\nSo any issue may appear/disappear at any point in time.",
          "created_at": "2026-01-29T17:54:57Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 201,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 345,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3792714752,
      "number": 34232,
      "title": "wallet: SetBumpFeeDiscount(const CAmount): Assertion `discount >= 0' failed",
      "body": "*I hit this assertion in a test running on [Antithesis](https://antithesis.com/).*\n\nVibe coded functional test to demonstrate: https://github.com/dergoegge/bitcoin/commit/587e42c3504bed5cb45137cd151f1e80e2314eed. Because this is caused by a race condition, the commit also includes a sleep to reliably trigger the issue.\n\n```\nnode0 stderr bitcoind: wallet/coinselection.cpp:823: void wallet::SelectionResult::SetBumpFeeDiscount(const CAmount): Assertion `discount >= 0' failed.\n```\n\n<details>\n\n<summary>Here's an LLM's explanation for the bug:</summary>\n\n## Bug\n\nAssertion `discount >= 0` fails in `SelectionResult::SetBumpFeeDiscount` (`src/wallet/coinselection.cpp:823`).\n\nFound during Antithesis testing with concurrent transaction creation.\n\n## Root Cause\n\nRace condition between two MiniMiner calculations during coin selection:\n\n1. **Individual bump fees** calculated in `AvailableCoins` (`spend.cpp:517`) via `calculateIndividualBumpFees()` - creates MiniMiner, copies mempool state, releases lock\n2. **Combined bump fee** calculated later in `ChooseSelectionResult` (`spend.cpp:809`) via `calculateCombinedBumpFee()` - creates a *new* MiniMiner with potentially different mempool state\n\nEach MiniMiner constructor acquires `LOCK(mempool.cs)` only for the duration of the constructor (`mini_miner.cpp:26`). The lock is released before the actual fee calculations run.\n\nIf mempool state changes between these two calls (e.g., fee deltas modified via `prioritisetransaction`, new transactions, evictions), the combined calculation can return a higher value than the sum of individual calculations:\n\n```cpp\n// spend.cpp:813-815\nCAmount bump_fee_overestimate = summed_bump_fees - combined_bump_fee.value();\nif (bump_fee_overestimate) {\n    result.SetBumpFeeDiscount(bump_fee_overestimate);  // negative if combined > summed\n}\n```\n</details>\n\n\n\n\n",
      "state": "open",
      "user": "dergoegge",
      "created_at": "2026-01-08T12:35:53Z",
      "updated_at": "2026-01-29T15:59:32Z",
      "closed_at": null,
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/34232",
      "labels": [
        "Wallet"
      ],
      "comment_data": [
        {
          "id": 3818599647,
          "user": "BharathC0",
          "body": "@fanquake Can I work on this",
          "created_at": "2026-01-29T15:59:32Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 28,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 1924,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3149228636,
      "number": 32759,
      "title": "Guix build fails on M4 macOS host with Ubuntu in UTM",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nSince #32431 my macOS (M4 using UTM) Guix builds no longer work: \n\n```\nHOSTS=\"x86_64-linux-gnu\" contrib/guix/guix-build\n...\nguix shell: error: while setting up the build environment: cannot set armhf-linux personality: Invalid argument\n```\n\nThis seems to be something else than what I encountered on my native AMD Ubuntu machine: https://github.com/bitcoin/bitcoin/pull/32431#issuecomment-2966089437\n\nBut perhaps a common factor is that this PR pulled in a lot of new guix packages.\n\n### Expected behaviour\n\nGuix build should work, it does on c8abd972818f83d90bf50b250131f338034460ef.\n\n### Steps to reproduce\n\nSee below\n\n### Relevant log output\n\n```\n$ HOSTS=\"x86_64-linux-gnu\" contrib/guix/guix-build\nChecking that we can connect to the guix-daemon...\n\nHint: If this hangs, you may want to try turning your guix-daemon off and on\n      again.\n\nmake: Entering directory '/home/sjors/bitcoin/depends'\nmake[1]: Entering directory '/home/sjors/bitcoin/depends'\nmake[1]: Leaving directory '/home/sjors/bitcoin/depends'\nmake: Leaving directory '/home/sjors/bitcoin/depends'\nINFO: Building fed41b75fbfa for platform triple x86_64-linux-gnu:\n      ...using reference timestamp: 1749642062\n      ...running at most 10 jobs\n      ...from worktree directory: '/home/sjors/bitcoin'\n          ...bind-mounted in container to: '/bitcoin'\n      ...in build directory: '/home/sjors/bitcoin/guix-build-fed41b75fbfa/distsrc-fed41b75fbfa-x86_64-linux-gnu'\n          ...bind-mounted in container to: '/distsrc-base/distsrc-fed41b75fbfa-x86_64-linux-gnu'\n      ...outputting in: '/home/sjors/bitcoin/guix-build-fed41b75fbfa/output/x86_64-linux-gnu'\n          ...bind-mounted in container to: '/outdir-base/x86_64-linux-gnu'\n      ADDITIONAL FLAGS (if set)\n          ADDITIONAL_GUIX_COMMON_FLAGS: --max-jobs=4 --no-substitutes\n          ADDITIONAL_GUIX_ENVIRONMENT_FLAGS:\n          ADDITIONAL_GUIX_TIMEMACHINE_FLAGS:\nThe following derivations will be built:\n  /gnu/store/5kpjfn7qg25c4w1q3cczl565x0yi8mpb-python-lief-0.16.6.drv\n  /gnu/store/04dcmhmlhgj2pgnyspb88lm5j9rwbd60-python-typing-extensions-4.9.0.drv\n  /gnu/store/nd7dcikf5dnq113cxmb1r4w0q8ijs1qq-typing_extensions-4.9.0.tar.gz.drv\n  /gnu/store/25adw1ck5fvbgvrx405c0l6kjag49j9z-python-importlib-metadata-5.2.0.drv\n...\n  /gnu/store/c985sj9mqmk3qvsd55b0g11hlv26krbk-msgpack-1.0.4.tar.gz.drv\n  /gnu/store/x8vm49yz0k8wm3w2hgishy5q1svkcfaw-python-pymongo-4.1.1.drv\n  /gnu/store/6dv3fazv5hnhwvgfnnykm0f2lwnajgsq-pymongo-4.1.1.tar.gz.drv\n\nbuilding /gnu/store/ck789yrq1xslycd986zdh5fq8dknl3r3-rust-actix-derive-0.5.0.tar.gz.drv...\nbuilding /gnu/store/2xasv0pcv8gw6lafag6bkjfqkmlbj02f-rust-actix-http-1.0.1.tar.gz.drv...\nbuilding /gnu/store/qifi4hb8hjm6bk6nv4664fyw7cb25fgp-rust-actix-http-2.2.0.tar.gz.drv...\nbuilding /gnu/store/gm8l3rn479p9hf3zs1vj9pzchvcj42f8-rust-actix-macros-0.1.3.tar.gz.drv...\nThe following builds are still in progress:\n  /gnu/store/qifi4hb8hjm6bk6nv4664fyw7cb25fgp-rust-actix-http-2.2.0.tar.gz.drv\n  /gnu/store/ck789yrq1xslycd986zdh5fq8dknl3r3-rust-actix-derive-0.5.0.tar.gz.drv\n\nbuilding /gnu/store/grpq0sq301rwsz6h4vbdx9sgvi64wai4-Python-2.7.18.tar.xz.drv...\nThe following builds are still in progress:\n  /gnu/store/grpq0sq301rwsz6h4vbdx9sgvi64wai4-Python-2.7.18.tar.xz.drv\n  /gnu/store/qifi4hb8hjm6bk6nv4664fyw7cb25fgp-rust-actix-http-2.2.0.tar.gz.drv\n\nThe following builds are still in progress:\n  /gnu/store/grpq0sq301rwsz6h4vbdx9sgvi64wai4-Python-2.7.18.tar.xz.drv\n  /gnu/store/qifi4hb8hjm6bk6nv4664fyw7cb25fgp-rust-actix-http-2.2.0.tar.gz.drv\n\nbuilding /gnu/store/sf5wwnpy8mr9l8iic2xz5bmg3bppjrj9-asynctest-0.13.0.tar.gz.drv...\nbuilding /gnu/store/hiqwnz4mhiad1zcqyf250b1ws0s36djc-attrs-21.2.0.tar.gz.drv...\nThe following builds are still in progress:\n  /gnu/store/hiqwnz4mhiad1zcqyf250b1ws0s36djc-attrs-21.2.0.tar.gz.drv\n  /gnu/store/sf5wwnpy8mr9l8iic2xz5bmg3bppjrj9-asynctest-0.13.0.tar.gz.drv\n  /gnu/store/grpq0sq301rwsz6h4vbdx9sgvi64wai4-Python-2.7.18.tar.xz.drv\n\nnote: keeping build directory `/tmp/guix-build-Python-2.7.18.tar.xz.drv-2'\nnote: keeping build directory `/tmp/guix-build-bash.drv-2'\nnote: keeping build directory `/tmp/guix-build-asynctest-0.13.0.tar.gz.drv-2'\nnote: keeping build directory `/tmp/guix-build-attrs-21.2.0.tar.gz.drv-2'\nguix shell: error: while setting up the build environment: cannot set armhf-linux personality: Invalid argument\n```\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nmaster@fed41b75fbfa6d14cce852863271b1fb0206eef0\n\n### Operating system and version\n\nMacOS 15.5 with UTM, guest (virtualized) Ubuntu 24.10 (aarch64\n\n### Machine specifications\n\nM4",
      "state": "closed",
      "user": "Sjors",
      "created_at": "2025-06-16T09:25:48Z",
      "updated_at": "2026-01-29T14:07:47Z",
      "closed_at": "2025-12-09T09:35:10Z",
      "comments": 23,
      "url": "https://github.com/bitcoin/bitcoin/issues/32759",
      "labels": [
        "Build system",
        "Upstream",
        "Questions and Help"
      ],
      "comment_data": [
        {
          "id": 3817156405,
          "user": "willcl-ark",
          "body": "@Sjors I have just tried to replicate this again but can't get the same error as you still :(\n\nI am on an M3 MacBook Pro, using UTM 4.7.5. I downloaded the arm Ubuntu server 24.04.3 image and ran it as a new VM using UTM. (I notice this says it's using QEMU in the settings, which I guess matches yours too?)\n\nAfter booting I disabled apparmor via `GRUB_CMDLINE_LINUX=\"apparmor=0\"` in _/etc/default/grub_ and installed `guix` from apt.\n\nI seem to be able to build various `hello` packages without issue:\n\nx64\n<img width=\"1451\" height=\"474\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/8ac3f105-c388-485e-bded-fbef3dca0bb1\" />\n\narmhf\n<img width=\"1451\" height=\"489\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/5bb0a3c7-ef1f-4c2f-abba-c7b80b19d491\" />\n\nfull x64 bitcoin build\n<img width=\"1560\" height=\"1056\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/4ef0796a-c15c-4cf0-afaa-10e55ca8325f\" />\n\nI think I'd be surprisef if M3 and M4 diffferent-enough to cause these issues you have, but we are getting different outcomes, and that's the only difference I can see at this time...",
          "created_at": "2026-01-29T11:47:45Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 1121,
            "has_nack": false,
            "has_ack": true
          }
        },
        {
          "id": 3817391896,
          "user": "Sjors",
          "body": "I installed the arm version of Ubuntu 25, did you install the x86 version?\n\nI use UTM 4.7.5, so that's the same.\n\nQemu 10.0\n\n<img width=\"788\" height=\"324\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/92adf251-7bca-479b-845e-d1d4c3fa99b9\" />\n\n<img width=\"716\" height=\"297\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/6e36b582-679f-4282-ad7d-c2795840278e\" />\n",
          "created_at": "2026-01-29T12:36:34Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 388,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3817920970,
          "user": "willcl-ark",
          "body": "Nope, I used arm64:\n\n<img width=\"413\" height=\"373\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/e51b53c7-cc1d-4430-b26a-2a6a1609fc8f\" />\n\n(not sure how to get the neat menus you show)",
          "created_at": "2026-01-29T14:07:47Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 198,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 4776,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3065864808,
      "number": 32508,
      "title": "ci: remove third-party javascript usage from Windows CI",
      "body": "See:\n\nhttps://github.com/bitcoin/bitcoin/blob/c779ee3a4044df3a263394bbb8b104aeeaa7c727/.github/workflows/ci.yml#L189-L190\n\nWe shouldn't need to use a third-party repo, that runs some Javascript, to configure a command prompt. The comment in our code also doesn't explain why this is necessary. We should be able to drop this dependency.\n\nAlso discussed in #32396.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-05-15T11:09:12Z",
      "updated_at": "2026-01-29T14:03:18Z",
      "closed_at": "2026-01-29T14:03:18Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/32508",
      "labels": [
        "Windows",
        "Tests"
      ],
      "comment_data": [
        {
          "id": 3817889284,
          "user": "fanquake",
          "body": "I've removed `ilammy/msvc-dev-cmd` from the allowed actions list. Issues can be addressed by rebasing. If anything further needs backporting, I'll take care of it.",
          "created_at": "2026-01-29T14:03:18Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 1,
            "text_length": 163,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 0,
        "text_length": 419,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3826722076,
      "number": 34331,
      "title": "qa: Failure in `p2p_fingerprint.py`",
      "body": "On FreeBSD 15.0, https://github.com/hebasto/bitcoin-core-nightly/actions/runs/21105606197/job/60696569283:\n```\n386/456 - p2p_fingerprint.py failed, Duration: 0 s\n\nstdout:\n2026-01-18T04:34:49.101209Z TestFramework (INFO): PRNG seed is: 4679507874993432966\n2026-01-18T04:34:49.102528Z TestFramework (INFO): Initializing test directory /tmp/test_runner_₿_🏃_20260118_042715/p2p_fingerprint_63\n2026-01-18T04:34:49.360239Z TestFramework (ERROR): Unexpected exception\nTraceback (most recent call last):\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 138, in main\n    self.setup()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 269, in setup\n    self.setup_network()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 360, in setup_network\n    self.setup_nodes()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 382, in setup_nodes\n    self.start_nodes()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 528, in start_nodes\n    node.wait_for_rpc_connection()\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_node.py\", line 316, in wait_for_rpc_connection\n    raise FailedToStartError(self._node_msg(\ntest_framework.test_node.FailedToStartError: [node 0] bitcoind exited with status 1 during initialization. Error: Unable to bind to 127.0.0.1:11756 on this computer. Bitcoin Core is probably already running.\nError: Failed to listen on any port. Use -listen=0 if you want this.\n************************\n\n2026-01-18T04:34:49.423831Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n2026-01-18T04:34:49.424142Z TestFramework (WARNING): Not cleaning up dir /tmp/test_runner_₿_🏃_20260118_042715/p2p_fingerprint_63\n2026-01-18T04:34:49.424336Z TestFramework (ERROR): Test failed. Test logging available at /tmp/test_runner_₿_🏃_20260118_042715/p2p_fingerprint_63/test_framework.log\n2026-01-18T04:34:49.424671Z TestFramework (ERROR): \n2026-01-18T04:34:49.425017Z TestFramework (ERROR): Hint: Call /home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/combine_logs.py '/tmp/test_runner_₿_🏃_20260118_042715/p2p_fingerprint_63' to consolidate all logs\n2026-01-18T04:34:49.425220Z TestFramework (ERROR): \n2026-01-18T04:34:49.425516Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\n2026-01-18T04:34:49.425685Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\n2026-01-18T04:34:49.425795Z TestFramework (ERROR): \n\n\n```",
      "state": "closed",
      "user": "hebasto",
      "created_at": "2026-01-18T12:22:44Z",
      "updated_at": "2026-01-29T11:33:57Z",
      "closed_at": "2026-01-29T11:33:57Z",
      "comments": 11,
      "url": "https://github.com/bitcoin/bitcoin/issues/34331",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 2957,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2632690416,
      "number": 31210,
      "title": "intermittent issue in wallet_upgradewallet.py: AssertionError: bdb magic does not match bdb btree magic",
      "body": "https://cirrus-ci.com/task/5232872305459200:\r\n```bash\r\n067]  node0 2024-11-04T11:58:48.064759Z [httpworker.0] [src/wallet/wallet.h:936] [WalletLogPrintf] [default wallet] m_address_book.size() = 2 \r\n[06:58:49.067]  test  2024-11-04T11:58:48.065000Z TestFramework (INFO): Can upgrade to HD \r\n[06:58:49.067]  test  2024-11-04T11:58:48.066000Z TestFramework (ERROR): Assertion failed \r\n[06:58:49.067]                                    Traceback (most recent call last):\r\n[06:58:49.067]                                      File \"/ci_container_base/test/functional/test_framework/test_framework.py\", line 132, in main\r\n[06:58:49.067]                                        self.run_test()\r\n[06:58:49.067]                                      File \"/ci_container_base/ci/scratch/build-x86_64-pc-linux-gnu/test/functional/wallet_upgradewallet.py\", line 226, in run_test\r\n[06:58:49.067]                                        orig_kvs = dump_bdb_kv(node_master_wallet)\r\n[06:58:49.067]                                      File \"/ci_container_base/test/functional/test_framework/bdb.py\", line 142, in dump_bdb_kv\r\n[06:58:49.067]                                        dump_meta_page(pages[INNER_META_PAGE])\r\n[06:58:49.067]                                      File \"/ci_container_base/test/functional/test_framework/bdb.py\", line 100, in dump_meta_page\r\n[06:58:49.067]                                        assert magic == BTREE_MAGIC, 'bdb magic does not match bdb btree magic'\r\n[06:58:49.067]                                    AssertionError: bdb magic does not match bdb btree magic\r\n[06:58:49.067]  test  2024-11-04T11:58:48.067000Z TestFramework (DEBUG): Closing down network thread \r\n```\r\n\r\nLooking at all the logs in #30798, this seems to be a different issue.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2024-11-04T12:29:23Z",
      "updated_at": "2026-01-29T11:03:42Z",
      "closed_at": "2025-01-29T20:56:47Z",
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/issues/31210",
      "labels": [
        "CI failed"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 1866,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 2816999140,
      "number": 31754,
      "title": "guix SWH vault Internal Server Error",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nFor the first time, running contrib/guix/guix-build, I ran into: \n\n```\nUpdating channel 'guix' from Git repository at 'https://git.savannah.gnu.org/git/guix.git'...\nSWH: found revision 53396a22afc04536ddf75d8f82ad2eafa5082725 with directory at 'https://archive.softwareheritage.org/api/1/directory/d6d830512c16e46521fab9a956c1842ab2fcdea9/'\nSWH vault: failure: Internal Server Error. This incident will be reported.\nThe full error was:\n\nTraceback (most recent call last):\n  File \"/opt/swh/.local/lib/python3.10/site-packages/swh/vault/cookers/base.py\", line 135, in cook\n    self.prepare_bundle()\n  File \"/opt/swh/.local/lib/python3.10/site-packages/swh/vault/cookers/git_bare.py\", line 168, in prepare_bundle\n    self.load_objects()\n  File \"/opt/swh/.local/lib/python3.10/site-packages/swh/vault/cookers/git_bare.py\", line 413, in load_objects\n    self.load_revisions(revision_ids)\n  File \"/opt/swh/.local/lib/python3.10/site-packages/swh/vault/cookers/git_bare.py\", line 586, in load_revisions\n    ret: List[Optional[Revision]] = self.storage.revision_get(obj_ids)\n  File \"/opt/swh/.local/lib/python3.10/site-packages/tenacity/__init__.py\", line 336, in wrapped_f\n    return copy(f, *args, **kw)\n  File \"/opt/swh/.local/lib/python3.10/site-packages/tenacity/__init__.py\", line 475, in __call__\n    do = self.iter(retry_state=retry_state)\n  File \"/opt/swh/.local/lib/python3.10/site-packages/tenacity/__init__.py\", line 376, in iter\n    result = action(retry_state)\n  File \"/opt/swh/.local/lib/python3.10/site-packages/tenacity/__init__.py\", line 418, in exc_check\n    raise retry_exc.reraise()\n  File \"/opt/swh/.local/lib/python3.10/site-packages/tenacity/__init__.py\", line 185, in reraise\n    raise self.last_attempt.result()\n  File \"/usr/local/lib/python3.10/concurrent/futures/_base.py\", line 451, in result\n    return self.__get_result()\n  File \"/usr/local/lib/python3.10/concurrent/futures/_base.py\", line 403, in __get_result\n    raise self._exception\n  File \"/opt/swh/.local/lib/python3.10/site-packages/tenacity/__init__.py\", line 478, in __call__\n    result = fn(*args, **kwargs)\n  File \"/opt/swh/.local/lib/python3.10/site-packages/swh/storage/proxies/retry.py\", line 81, in newf\n    return getattr(storage, attribute_name)(*args, **kwargs)\n  File \"/opt/swh/.local/lib/python3.10/site-packages/swh/core/api/__init__.py\", line 196, in meth_\n    return self._post(meth._endpoint_path, post_data)\n  File \"/opt/swh/.local/lib/python3.10/site-packages/swh/core/api/__init__.py\", line 356, in _post\n    return self._decode_response(response)\n  File \"/opt/swh/.local/lib/python3.10/site-packages/swh/core/api/__init__.py\", line 443, in _decode_response\n    self.raise_for_status(response)\n  File \"/opt/swh/.local/lib/python3.10/site-packages/swh/storage/api/client.py\", line 45, in raise_for_status\n    super().raise_for_status(response)\n  File \"/opt/swh/.local/lib/python3.10/site-packages/swh/core/api/__init__.py\", line 433, in raise_for_status\n    raise exception from None\nswh.core.api.RemoteException: <RemoteException 500 ReadTimeout: ['Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\\' responses] message=\"Operation timed out - received only 1 responses.\" info={\\'consistency\\': \\'LOCAL_QUORUM\\', \\'required_responses\\': 2, \\'received_responses\\': 1}']>\n\nSWH vault: retrying...\nSWH vault: requested bundle cooking, waiting for completion...\n```\nHas anyone else seen this before? Anyone else seeing this? Is it just me? Thank you.\n\n### Expected behaviour\n\nShould compile as normal.\n\n### Steps to reproduce\n\ncontrib/guix/guix-build\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\ncommit b432e367427f1f9fe0f0a5800e31e496f00cd38d\n\n### Operating system and version\n\nUbuntu 24.04.1 LTS\n\n### Machine specifications\n\nancient machine, but good Ubuntu.\n\n$ guix --version\nguix (GNU Guix) 1.4.0\nCopyright (C) 2022 the Guix authors\n\n",
      "state": "closed",
      "user": "tofutim",
      "created_at": "2025-01-29T00:50:47Z",
      "updated_at": "2026-01-29T11:03:38Z",
      "closed_at": "2025-01-29T09:34:08Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/issues/31754",
      "labels": [
        "Upstream"
      ],
      "comment_data": [],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 1,
        "text_length": 4115,
        "has_nack": false,
        "has_ack": true
      }
    },
    {
      "id": 3825454472,
      "number": 34326,
      "title": "node uptime wrong",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nSystem is freshly booted but bitcoind show wrong uptime:\n\n```\nroot@raspberrypi5-c8-bf-64:~# bitcoin-cli -conf=/etc/bitcoin/bitcoin.conf uptime\n20120688\n\n```\n\nMy real uptime:\n```\nroot@raspberrypi5-c8-bf-64:~# uptime \n 15:53:22 up 10 min,  0 user,  load average: 0.61, 0.56, 0.31\n```\nversion:\n```\nroot@raspberrypi5-c8-bf-64:~# bitcoind --version\nBitcoin Core daemon version v30.2.0 bitcoind\nCopyright (C) 2009-2026 The Bitcoin Core developers\n\nPlease contribute if you find Bitcoin Core useful. Visit\n<https://bitcoincore.org/> for further information about the software.\nThe source code is available from <https://github.com/bitcoin/bitcoin>.\n\nThis is experimental software.\nDistributed under the MIT software license, see the accompanying file COPYING\nor <https://opensource.org/license/MIT>\n\n```\nbitcoin conf file:\n```\nroot@raspberrypi5-c8-bf-64:~# cat /etc/bitcoin/bitcoin.conf \n#############################################################\n# Bitcoin configuration file\n#############################################################\npid=/run/bitcoin/bitcoind.pid\nnodebuglogfile=1\ndatadir=/var/bitcoin\nloglevel=info\nproxy=127.0.0.1:9050\nsigner=/usr/bin/hwi\n\n# Settings for signet Network\nsignet=1\n\n[signet]\nwalletdir=/var/wallets\nlisten=1\nbind=127.0.0.1\nport=38333\n\n# RPC Settings\nrpcuser=satobox\nrpcport=38332\nrpcbind=127.0.0.1\nrpcallowip=127.0.0.1\nrpcauth=satobox:3381456077fa06cabce053c62a368693$263f4f1cbdc1b4b25233385b931807508f5d8bd59d2c46dc418e4ea2b23dfd09\nrpccookiefile=/run/bitcoin/cookie\nrpccookieperms=group\nserver=1\ndeprecatedrpc=warnings\n```\n\n### Expected behaviour\n\nshould show correct uptime\n\n### Steps to reproduce\n\njust build new bitcoin core and test with commands above\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nv30.2\n\n### Operating system and version\n\nlinux \n\n### Machine specifications\n\nraspberrypi5",
      "state": "closed",
      "user": "embetrix",
      "created_at": "2026-01-17T15:56:13Z",
      "updated_at": "2026-01-29T10:51:05Z",
      "closed_at": "2026-01-27T16:31:19Z",
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/issues/34326",
      "labels": [
        "Bug"
      ],
      "comment_data": [
        {
          "id": 3816818910,
          "user": "dergoegge",
          "body": "@embetrix out of curiosity what is your usecase for the uptime RPC? Any reason you prefer it over querying your OS for the uptime of the bitcoind process?\n",
          "created_at": "2026-01-29T10:34:15Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 155,
            "has_nack": false,
            "has_ack": false
          }
        },
        {
          "id": 3816894923,
          "user": "embetrix",
          "body": "@dergoegge : I started a project recently : https://github.com/embetrix/satobox it implement a full node built completely from sources (including OS and all packages). \nIt runs actually on RPI5 but not exclusivly. \nI have hw wallet management system using Specter-Desktop and it showed previously wrong uptime when bitcoin was started before NTP sync. \nI mitigated that by adding systemd requirement on NTP : https://github.com/embetrix/satobox/blob/scarthgap/meta-satobox/recipes-bitcoin/bitcoin/bitcoin/bitcoind.service.in#L3 \nbut the fix proposed by  @l0rinc is cleaner and I can remove this dependency with future bitcoin core releases to have a quicker start of the node.",
          "created_at": "2026-01-29T10:49:40Z",
          "drama_signals": {
            "drama_keywords": 1,
            "positive_keywords": 1,
            "text_length": 676,
            "has_nack": false,
            "has_ack": true
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 1,
        "positive_keywords": 0,
        "text_length": 2053,
        "has_nack": false,
        "has_ack": false
      }
    },
    {
      "id": 3864972233,
      "number": 34428,
      "title": "ci: iwyu task fails when run in a worktree",
      "body": "(I don't need this, but maybe someone else does?)\n\nJust wanted to note that the iwyu task is known to not work in a worktree. It fails with:\n\n```\n...\nIWYU edited 0 files on your behalf.\n\n+ git diff -U0\n+ ./contrib/devtools/clang-format-diff.py -binary=clang-format-21 -p1 -i -v\nfatal: not a git repository: /home/runner/work/bitcoin-core-with-ci/bitcoin-core-with-ci/.git/worktrees/ci-matrix-worktree\n+ git --no-pager diff --exit-code\nfatal: not a git repository: /home/runner/work/bitcoin-core-with-ci/bitcoin-core-with-ci/.git/worktrees/ci-matrix-worktree\n+ echo '^^^ ⚠️ Failure generated from IWYU'\n+ false\n^^^ ⚠️ Failure generated from IWYU\nCommand '['docker', 'exec', 'ebf1d1ae7dd7efd91962e3363c2859da5fc8a5061655d95b9fd90a2b51929fd1', '/home/runner/work/_temp/ci/test/03_test_script.sh']' returned non-zero exit status 1.\n```\n\nTested with a hacky diff like:\n\n```diff\ndiff --git a/.github/actions/configure-environment/action.yml b/.github/actions/configure-environment/action.yml\nindex e2a26b7184..df2a6aae28 100644\n--- a/.github/actions/configure-environment/action.yml\n+++ b/.github/actions/configure-environment/action.yml\n@@ -19,2 +19,3 @@ runs:\n       run: |\n+        cd ../ci-matrix-worktree\n         echo \"DEPENDS_HASH=$(git ls-tree HEAD depends \"$FILE_ENV\" | sha256sum | cut -d' ' -f1)\" >> $GITHUB_ENV\n@@ -25,2 +26,3 @@ runs:\n       run: |\n+        cd ../ci-matrix-worktree\n         source $FILE_ENV\ndiff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml\nindex bbac5e023c..afb51b99e2 100644\n--- a/.github/workflows/ci.yml\n+++ b/.github/workflows/ci.yml\n@@ -626,2 +626,6 @@ jobs:\n       - *CHECKOUT\n+      \n+      - name: Worktree add\n+        run: |\n+          git worktree add ../ci-matrix-worktree HEAD\n \n@@ -655,3 +659,5 @@ jobs:\n       - name: CI script\n-        run: ./ci/test_run_all.sh\n+        run: |\n+          cd ../ci-matrix-worktree  # cd required :(\n+          ./ci/test_run_all.sh\n \n",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2026-01-28T11:31:37Z",
      "updated_at": "2026-01-29T09:23:20Z",
      "closed_at": "2026-01-29T09:23:20Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/34428",
      "labels": [
        "Tests",
        "CI failed"
      ],
      "comment_data": [
        {
          "id": 3816466328,
          "user": "maflcko",
          "body": "I submitted a fix in https://github.com/bitcoin/bitcoin/pull/34441, let's continue discussion and review there.",
          "created_at": "2026-01-29T09:23:20Z",
          "drama_signals": {
            "drama_keywords": 0,
            "positive_keywords": 0,
            "text_length": 111,
            "has_nack": false,
            "has_ack": false
          }
        }
      ],
      "drama_signals": {
        "drama_keywords": 0,
        "positive_keywords": 2,
        "text_length": 1964,
        "has_nack": false,
        "has_ack": true
      }
    }
  ],
  "summary": {
    "total_prs": 279,
    "total_issues": 37,
    "total_comments": 50,
    "unique_participants": 90
  }
}