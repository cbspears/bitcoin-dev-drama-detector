{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T19:45:08.049886+00:00",
  "date": "2025-05-22",
  "pull_requests": [
    {
      "number": 32596,
      "title": "wallet, rpc, doc: various legacy wallet removal cleanups in RPCs",
      "body": "This PR contains a few smaller wallet RPC cleanups based on that we only ever operate on descriptor wallets now:\r\n* remove the now obsolete \"keypoololdest\" field from the `getwalletinfo` RPC and the corresponding CWallet/ScriptPubKeyMan methods\r\n* in RPCs where potential fast wallet rescan is documented, remove the \"descriptor wallet\" mentions (back then introduced in commit ca48a4694f73e5be8f971ae482ebc2cce4caef44, PR #25957)\r\n* for the `createwallet` RPC examples, remove the \"descriptors\" parameters that always have to be true now (proposed in https://github.com/bitcoin/bitcoin/pull/31250#discussion_r2042020967; corresponds to 86de8c1668005304b2c630ca2ad4a8ca8e348e90, PR #32544 which did the same for functional tests)",
      "state": "closed",
      "user": "theStack",
      "created_at": "2025-05-22T22:46:30Z",
      "updated_at": "2025-05-23T19:38:16Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/pull/32596",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32596.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [1440000bytes](https://github.com/bitcoin/bitcoin/pull/32596#pullrequestreview-2862873626), [rkrux](https://github.com/bitcoin/bitcoin/pull/32596#pullrequestreview-2864719763), [achow101](https://github.com/bitcoin/bitcoin/pull/32596#issuecomment-2905565617) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-22T22:46:32Z"
        },
        {
          "user": "achow101",
          "body": "ACK e5cbea416b2f63e5d99819052f3e69a6383336d6",
          "created_at": "2025-05-23T19:20:59Z"
        }
      ]
    },
    {
      "number": 32595,
      "title": "build: add a depends dependency provider",
      "body": "Fixes: #32428\r\n\r\nThis PR adds a [dependency provider](https://cmake.org/cmake/help/latest/guide/using-dependencies/index.html#dependency-providers) to depends builds.\r\n\r\nCurrently the depends toolchain appears to rely on certain assumptions [citation needed] to find packages correctly. It does largely do this correctly, however NixOS sets some environment variables which interfere with this and cause builds from depends to fail, due to attempting to link system packages.\r\n\r\nWe can reproduce this interferrence by running a NixOS container and loading system packages using a flake:\r\n\r\n```bash\r\ndocker run --pull=always -it nixos/nix\r\n\r\n# In the container:\r\ngit clone --depth=1 https://github.com/bitcoin/bitcoin && cd bitcoin\r\n\r\n# Install system packages for a non-depends build from https://github.com/bitcoin-dev-tools/bix\r\nnix develop github:bitcoin-dev-tools/bix --extra-experimental-features flakes --extra-experimental-features nix-command --no-write-lock-file\r\n\r\n# Attempt depends build\r\nmake -C depends -j$(nproc)\r\ncmake -B build --toolchain /bitcoin/depends/<host-platform-triplet>/toolchain.cmake\r\n\r\n# Find possibly-interferring env vars:\r\nenv | grep -E 'CMAKE|NIX'\r\n```\r\n\r\nA dependency provider allows the overriding of  `cmake`'s `find_package()` therefore giving total control over where dependencies come from in a build.\r\n\r\nThis achieves two things:\r\n\r\n1. Provides stronger guarantees about where dependencies come from during a (depends) build; not permitting environment flags to override these locations [citation needed].\r\n2. Fixes issues like a non-standard `CMAKE_PREFIX_PATH` breaking builds (i.e. 32428)\r\n\r\nThis provider must be specified along with the toolchain, with an invocation of the type:\r\n\r\n```bash\r\nmake -C depends\r\ncmake -B build --toolchain depends/x86_64-pc-linux-gnu/toolchain.cmake -DCMAKE_PROJECT_TOP_LEVEL_INCLUDES=depends/x86_64-pc-linux-gnu/dependency_provider.cmake\r\ncmake --build build\r\n```\r\n## To-do\r\n\r\n- [x] Figure out why the provider does not like to find boost ([link](https://github.com/bitcoin/bitcoin/pull/32595/commits/f89253f9d3382d7cad084a11aff243e1e7d6bf5e)) fixed by rebasing on #32665 and #32667\r\n- [x] Fix the failing CI job. This appears to somehow use an old `cmake`, even after we install `cmake` 4.0.2. Fixed by using bookworm, gcc-12 and `-Wno-error=array-bounds` in the previous releases job.",
      "state": "closed",
      "user": "willcl-ark",
      "created_at": "2025-05-22T21:25:46Z",
      "updated_at": "2025-06-20T14:04:22Z",
      "comments": 14,
      "url": "https://github.com/bitcoin/bitcoin/pull/32595",
      "labels": [
        "Build system",
        "Up for grabs"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32595.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept NACK | [fanquake](https://github.com/bitcoin/bitcoin/pull/32595#issuecomment-2919014673), [purpleKarrot](https://github.com/bitcoin/bitcoin/pull/32595#issuecomment-2922613939) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-22T21:25:50Z"
        },
        {
          "user": "willcl-ark",
          "body": "Opened in draft for feedback on approach. \r\n\r\nThere is also a bypass for the boost package (in _cmake/module/AddBoostIfNeeded.cmake_) which I'd like to get working with the dependency provider ideally.\r\n\r\nNote that this also bumps the minimum cmake version to 3.24.",
          "created_at": "2025-05-22T21:28:01Z"
        },
        {
          "user": "hebasto",
          "body": "cc @purpleKarrot ",
          "created_at": "2025-05-22T21:29:28Z"
        },
        {
          "user": "fanquake",
          "body": "> Provides stronger guarantees about where dependencies come from during a (depends) build; i.e. only from depends.\n\nCan you elaborate on this? Currently, CMake configured with a depends toolchain, should never look outside depends (doing so would be a bug). What are the stronger guarantees?",
          "created_at": "2025-05-22T21:42:05Z"
        },
        {
          "user": "willcl-ark",
          "body": "> > Provides stronger guarantees about where dependencies come from during a (depends) build; i.e. only from depends.\r\n> \r\n> Can you elaborate on this? Currently, CMake configured with a depends toolchain, should never look outside depends (doing so would be a bug). What are the stronger guarantees?\r\n\r\nRight, perhaps I didn't use the best wording here.\r\n\r\nWhen using the toolchain I _have not_ found us pulling in extraneous deps from outside of depends, but _have_ encountered us missing dependencies from inside of depends, e.g. in my original issue.\r\n\r\nBy using a dependency provider and intercepting calls to `find_package()`, as I understand it, we are getting even more control over which packages can be found than when using the toolchain.\r\n\r\nThis is what I termed \"stronger guarantees\", perhaps misleadingly!",
          "created_at": "2025-05-22T22:37:34Z"
        },
        {
          "user": "willcl-ark",
          "body": "The windows job fails as currently we activate the dependency provider automatically based on whether a(ny) toolchain is in use.\r\n\r\nThis works fine for depends, but doesn't make sense on windows where the vcpkg toolchain is used, without depends.\r\n\r\nThe idea for doing it this way was to try and avoid users having to pass _two_ flags in order to build from depends -- a toolchain and a dependency-provider -- but perhaps this is necessary after all...\r\n\r\nI do recall reading somewhere in cmake docs that choice of dependency provider should always be left to the user too, so I suppose doing it this way would fit with that.",
          "created_at": "2025-05-23T09:39:38Z"
        },
        {
          "user": "willcl-ark",
          "body": "Pushed an update which now only activates the dependency provider when using the depends toolchain.\r\n\r\nThis will hopefully appease the windows CI job, as well as making more sense in general and being more expected behaviour.",
          "created_at": "2025-05-23T12:24:35Z"
        },
        {
          "user": "purpleKarrot",
          "body": "Thank you for working on a dependency provider!\r\n\r\nI think core should provide *two* dependency providers, which will give users *three* different ways to build:\r\n\r\n1. Not using a dependency provider: CMake will produce an error when dependencies are not found on the system. This will be the preferred way for distro packagers.\r\n2. A fallback provider: This will use system packages when they are found and fall back to compiling vendored depends. Using this provider, `find_package` will always succeed, but it will not compile any \"unnecessary\" code. This approach may be preferred by developers or for quick experiments.\r\n3. A depends provider: This will ignore system packages and always use vendored depends. This approach will be used for reproducible builds.\r\n\r\nAt the moment, the dependency provider points to prebuilt depends. Alternatively, the dependency provider could take the responsibility of building depends at the moment they are requested. This would make the current, Makefile based depends system an implementation detail that can be ported piece by piece to CMake.",
          "created_at": "2025-05-26T08:44:37Z"
        },
        {
          "user": "willcl-ark",
          "body": "Thanks for the feedback @purpleKarrot.\r\n\r\nI like the sound of your approach here myself and will be happy to adapt to it. I think i'll start off by targetting 3.:\r\n\r\n> A depends provider: This will ignore system packages and always use vendored depends. This approach will be used for reproducible builds.\r\n\r\n...without the optionl \"auto-build depends\" functionality. This is close to what I have here already (and solves my immediate personal itch regarding building using depends on NixOS).\r\n\r\nI would appreciate your input though on one more aspect of this; namely the (dev) UX involved with the 3 options. Option 1 would not see any UX changes.\r\n\r\nOption 2 would require dev to specify the \"fallback provider\" file with a `-DCMAKE_PROJECT_TOP_LEVEL_INCLUDES` flag.\r\n\r\nOption 3 would require the dev to specify **both** a `--toolchain` and a `-DCMAKE_PROJECT_TOP_LEVEL_INCLUDES`.\r\n\r\nOption 3 in particular feels a little clunky to me (as a cmake novice), as I'd expect the toolchain to \"contain everything needed to build\". But I am guessing this can be abstracted away with a `CMakePreset` handling passing of the toolchain and dep. provider. This would become even more seamless in a version which auto-built depends for you too.\r\n\r\nDoes my understanding above sound roughly logical to you? If so I can make the changes later this week.",
          "created_at": "2025-05-27T08:17:07Z"
        },
        {
          "user": "fanquake",
          "body": "> A fallback provider: This will use system packages when they are found and fall back to compiling vendored depends. Using this provider, find_package will always succeed, but it will not compile any \"unnecessary\" code. This approach may be preferred by developers or for quick experiments.\r\n\r\nI can't tell from this if you are saying to use depends to \"fill in\" any missing system packages, or, if all the required system packages aren't available, we would switch to using depends (unclear if that is actually desirable). Certainly a NACK on mixing and matching the two.",
          "created_at": "2025-05-29T10:43:08Z"
        },
        {
          "user": "purpleKarrot",
          "body": "> I can't tell from this if you are saying to use depends to \"fill in\" any missing system packages,\r\n\r\nYes. The idea is to provide an approach to build core with minimal effort. If you NACK mixing system packages with vendored dependencies, are you saying that nobody will ever want that, or that nobody *should* ever want that?",
          "created_at": "2025-05-30T14:52:25Z"
        },
        {
          "user": "fanquake",
          "body": "> Yes. The idea is to provide an approach to build core with minimal effort. \r\n\r\nI think `make -C depends && cmake -B --toolchain` and `apt install your_dependencies && cmake -B` are both already pretty minimal effort. It's not really clear why a developer would `apt install x`, but not `apt install x y`, and then would need a behaviour to fallback to depends for `y`?\r\n\r\nI'm also not currently aware of a platform that we support, where the dependencies needed to compile Core, aren't available via the system package manager; one used to be our specific version of BDB `4.x`, but that dependency has now been removed. So this fallback usecase mostly seems like additional build complexity, which creates a larger matrix of \"supported\" builds to test / debug, for not much gain. We used to have a similar kind of option in our depends system (`ALLOW_HOST_PACKAGES`), but allowing the use of system packages, with depends, defeats the point of a self-contained dependency builder, so it was removed.\r\n\r\nThere's also some nuance around how this would function, are you imaging it all integrated into into CMake, so depends is no-longer a stand alone system? Otherwise, we need logic in CMake, to detect if the depends requirements (curl, compilers, patch, binutils etc) are actually installed / usable (i.e otherwise the fallback would fail because curl isn't installed, probably leaving the user wondering why it's trying to download stuff), as well as making sure that build flags / compiler selection are all passed through to depends (i.e if the user is trying to build with Clang & libc++, then any tools / flags need to be forwarded to the depends compilation).\r\n\r\nI'm also just not sure that if a dependency is missing, downloading and compiling something is even the best behaviour. Maybe the user just forgot to apt install it, and will do so when CMake fails to configure?",
          "created_at": "2025-05-30T15:45:56Z"
        },
        {
          "user": "willcl-ark",
          "body": "OK I reworked this a little so that it works as described in top comment.\r\n\r\nThe overview is that the provider must be manually specified with `-DCMAKE_PROJECT_TOP_LEVEL_INCLUDES`, thus keeping full control for the user.\r\n\r\nThe toolchain remains usable (as today) without the provider being specified.",
          "created_at": "2025-06-02T13:20:41Z"
        },
        {
          "user": "fanquake",
          "body": "https://cirrus-ci.com/task/5352790488252416?logs=ci#L1675:\r\n```bash\r\n[09:31:48.288] Extracting freetype...\r\n[09:31:48.316] /ci_container_base/depends/sources/freetype-2.11.0.tar.xz: OK\r\n[09:31:48.562] Preprocessing freetype...\r\n[09:31:48.575] Configuring freetype...\r\n[09:31:48.656] CMake Error at CMakeLists.txt:100 (cmake_minimum_required):\r\n[09:31:48.656]   Compatibility with CMake < 3.5 has been removed from CMake.\r\n[09:31:48.656] \r\n[09:31:48.656]   Update the VERSION argument <min> value.  Or, use the <min>...<max> syntax\r\n[09:31:48.656]   to tell CMake that the project requires at least <min> but has been updated\r\n[09:31:48.656]   to work with policies introduced by <max> or earlier.\r\n[09:31:48.656] \r\n[09:31:48.656]   Or, add -DCMAKE_POLICY_VERSION_MINIMUM=3.5 to try configuring anyway.\r\n[09:31:48.656] \r\n[09:31:48.656] \r\n[09:31:48.656] -- Configuring incomplete, errors occurred!\r\n```",
          "created_at": "2025-06-02T16:58:37Z"
        }
      ]
    },
    {
      "number": 32594,
      "title": "wallet, rpc: Return normalized descriptor in parent_descs",
      "body": "Instead of prividing the descriptor string as stored in the db, use the normalized descriptor as is done for getaddressinfo's parent_desc field.\r\n\r\nSplit from #32489",
      "state": "closed",
      "user": "achow101",
      "created_at": "2025-05-22T21:18:21Z",
      "updated_at": "2025-06-13T22:28:51Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/32594",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32594.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [Sjors](https://github.com/bitcoin/bitcoin/pull/32594#issuecomment-2933471621), [rkrux](https://github.com/bitcoin/bitcoin/pull/32594#pullrequestreview-2892155604), [w0xlt](https://github.com/bitcoin/bitcoin/pull/32594#pullrequestreview-2918290915) |\n| Stale ACK | [janb84](https://github.com/bitcoin/bitcoin/pull/32594#pullrequestreview-2872621106) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (‚ú® experimental)\n\nPossible typos and grammar issues:\n\n- aspostrophe -> apostrophe [misspelling]\n\n<sup>drahtbot_id_4_m</sup>\n",
          "created_at": "2025-05-22T21:18:24Z"
        },
        {
          "user": "Sjors",
          "body": "Concept ACK\r\n\r\nIn general normalized descriptors are more useful, because you can't derive addresses from e.g. `xpub/1h/*`. So it makes sense to use them for the parent.\r\n\r\nACK 107517ea7d29d959e7a0b94d8217dcb894680547\r\n\r\nI checked that the tests fail if I revert the first commit.\r\n\r\nnit: \"prividing\" -> \"providing\"",
          "created_at": "2025-05-23T10:31:03Z"
        },
        {
          "user": "achow101",
          "body": "> nit: \"prividing\" -> \"providing\"\r\n\r\nFixed",
          "created_at": "2025-05-23T18:26:51Z"
        },
        {
          "user": "achow101",
          "body": "> is parent_descs field useful only when the unspent is not solvable?\r\n\r\nNo. The purpose is to allow identifying the actual descriptor in the wallet that produced the address. These are supposed to be the same descriptors as output by `listdescriptors false`.",
          "created_at": "2025-05-27T18:11:24Z"
        },
        {
          "user": "Sjors",
          "body": "re-utACK 0def84d407\r\n\r\n\"vcpkg install failed\" on Windows CI seems unrelated.",
          "created_at": "2025-06-03T05:14:07Z"
        }
      ]
    },
    {
      "number": 32593,
      "title": "wallet, rpc: Move (Un)LockCoin WalletBatch creation out of RPC",
      "body": "If the locked coin needs to be persisted to the wallet database, insteead of having the RPC figure out when to create a WalletBatch and having LockCoin's behavior depend on it, have LockCoin take whether to persist as a parameter so it makes the batch.\r\n\r\nSince unlocking a persisted locked coin requires a database write as well, we need to track whether the locked coin was persisted to the wallet database so that it can erase the locked coin when necessary.\r\n\r\nKeeping track of whether a locked coin was persisted is also useful information for future PRs.\r\n\r\nSplit from #32489",
      "state": "closed",
      "user": "achow101",
      "created_at": "2025-05-22T20:35:53Z",
      "updated_at": "2025-07-24T17:40:38Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/32593",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32593.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [rkrux](https://github.com/bitcoin/bitcoin/pull/32593#pullrequestreview-2892695590), [Sjors](https://github.com/bitcoin/bitcoin/pull/32593#pullrequestreview-2900637374), [w0xlt](https://github.com/bitcoin/bitcoin/pull/32593#pullrequestreview-2976415024) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#33008](https://github.com/bitcoin/bitcoin/pull/33008) (wallet: support bip388 policy with external signer by Sjors)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-22T20:35:57Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `tidy`: https://github.com/bitcoin/bitcoin/runs/42741157527</sub>\n<sub>LLM reason (‚ú® experimental): The CI failure is due to a clang-tidy error.\n</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-05-22T21:19:38Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `tidy`: https://github.com/bitcoin/bitcoin/runs/43333360130</sub>\n<sub>LLM reason (‚ú® experimental): Compilation failed due to a self-comparison in wallet.cpp at line 2644, caused by an incorrect use of the '==' operator instead of an assignment operator.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-06-02T19:54:18Z"
        }
      ]
    },
    {
      "number": 32592,
      "title": "threading: remove ancient CRITICAL_SECTION macros",
      "body": "Now that #32467 is merged, the only remaining usage of our old `CRITICAL_SECTION` macros (other than tests) is in `getblocktemplate()` and it can safely be replaced with a `REVERSE_LOCK`.\r\n\r\nThis PR makes that replacement, replaces the old `CRITICAL_SECTION` macro usage in tests, then deletes the macros themselves.\r\n\r\n~While testing this a few weeks ago, I noticed that `REVERSE_LOCK` does not currently work properly with our thread-safety annotations as after the `REVERSE_LOCK` is acquired, clang still believes that the mutex is locked. #32465 fixes this problem. Without that fix, this PR would potentially allow a false-negative if code were added in the future to this chunk of `getblocktemplate` which required `cs_main` to be locked.~\r\n\r\n~I added a test for the reverse lock here in the form of a compiler warning in `reverselock_tests.cpp` to simulate that possibility. This PR will therefore cause a new warning (and should fail a warnings-as-errors ci check) until #32465 is merged and this is rebased on top of it.~\r\n\r\nEdit: Rebased on top of #32465, so this should now pass tests.",
      "state": "closed",
      "user": "theuni",
      "created_at": "2025-05-22T18:12:56Z",
      "updated_at": "2025-08-24T00:56:08Z",
      "comments": 14,
      "url": "https://github.com/bitcoin/bitcoin/pull/32592",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32592.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/32592#pullrequestreview-3146111612), [maflcko](https://github.com/bitcoin/bitcoin/pull/32592#issuecomment-3216477238), [fjahr](https://github.com/bitcoin/bitcoin/pull/32592#issuecomment-3216589996), [furszy](https://github.com/bitcoin/bitcoin/pull/32592#pullrequestreview-3147579126) |\n| Concept ACK | [hebasto](https://github.com/bitcoin/bitcoin/pull/32592#issuecomment-2902589733) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-22T18:12:59Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `MSan, depends`: https://github.com/bitcoin/bitcoin/runs/42732951890</sub>\n<sub>LLM reason (‚ú® experimental): The CI failure is due to a thread safety error in `reverselock_tests.cpp`.\n</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-05-22T19:04:08Z"
        },
        {
          "user": "theuni",
          "body": "As mentioned in the description, failing tests are just demonstrating the borked REVERSE_LOCK fixed by #32465.",
          "created_at": "2025-05-22T19:22:09Z"
        },
        {
          "user": "hebasto",
          "body": "Concept ACK. ",
          "created_at": "2025-05-22T21:15:18Z"
        },
        {
          "user": "fjahr",
          "body": "Concept ACK",
          "created_at": "2025-05-26T11:09:15Z"
        },
        {
          "user": "theuni",
          "body": "Pushed a small additional commit that removes a now-unnecessary template instantiation. Just a little janitorial work, but it will make some future changes more obviously correct.",
          "created_at": "2025-05-28T15:52:49Z"
        },
        {
          "user": "fanquake",
          "body": "https://cirrus-ci.com/task/6734127736553472?logs=ci#L3223\r\n```bash\r\n[12:12:21.305] /ci_container_base/src/test/reverselock_tests.cpp:23:9: error: cannot call function 'AssertLockNotHeldInline' while mutex 'mutex' is held [-Werror,-Wthread-safety-analysis]\r\n[12:12:21.305]    23 |         AssertLockNotHeld(mutex);\r\n[12:12:21.305]       |         ^\r\n[12:12:21.305] /ci_container_base/src/sync.h:141:31: note: expanded from macro 'AssertLockNotHeld'\r\n[12:12:21.305]   141 | #define AssertLockNotHeld(cs) AssertLockNotHeldInline(#cs, __FILE__, __LINE__, &cs)\r\n[12:12:21.305]       |                               ^\r\n[12:12:21.305] 1 error generated.\r\n```",
          "created_at": "2025-05-29T10:12:37Z"
        },
        {
          "user": "theuni",
          "body": "> https://cirrus-ci.com/task/6734127736553472?logs=ci#L3223\r\n> \r\n> ```shell\r\n> [12:12:21.305] /ci_container_base/src/test/reverselock_tests.cpp:23:9: error: cannot call function 'AssertLockNotHeldInline' while mutex 'mutex' is held [-Werror,-Wthread-safety-analysis]\r\n> [12:12:21.305]    23 |         AssertLockNotHeld(mutex);\r\n> [12:12:21.305]       |         ^\r\n> [12:12:21.305] /ci_container_base/src/sync.h:141:31: note: expanded from macro 'AssertLockNotHeld'\r\n> [12:12:21.305]   141 | #define AssertLockNotHeld(cs) AssertLockNotHeldInline(#cs, __FILE__, __LINE__, &cs)\r\n> [12:12:21.305]       |                               ^\r\n> [12:12:21.305] 1 error generated.\r\n> ```\r\n\r\nAs expected :) From description:\r\n\r\n> I added a test for the reverse lock here in the form of a compiler warning in reverselock_tests.cpp to simulate that possibility. This PR will therefore cause a new warning (and should fail a warnings-as-errors ci check) until https://github.com/bitcoin/bitcoin/pull/32465 is merged and this is rebased on top of it.",
          "created_at": "2025-05-29T14:55:50Z"
        },
        {
          "user": "fanquake",
          "body": "@theuni want to rebase this now that #32465 is in?",
          "created_at": "2025-07-01T14:01:14Z"
        },
        {
          "user": "fanquake",
          "body": "Put this on `30.0`.",
          "created_at": "2025-07-15T14:58:09Z"
        },
        {
          "user": "maflcko",
          "body": "This is tagged for 30.0, but feature freeze is in less than two weeks, and it still needs rebase, so it'll likely miss the milestone.",
          "created_at": "2025-08-07T15:27:31Z"
        },
        {
          "user": "fanquake",
          "body": "> This is tagged for 30.0, but feature freeze is in less than two weeks, and it still needs rebase, so it'll likely miss the milestone.\r\n\r\nFeature freeze doesn't seem important here, given this isn't a feature; it's part of a cleanup of which the prior PRs have already landed, so landing this any time before branch off seems fine (assuming it gets rebased, have pinged @theuni).",
          "created_at": "2025-08-19T13:35:28Z"
        },
        {
          "user": "maflcko",
          "body": "review ACK 46ca7712cb5fcf759cfc9f4f32d74215c8c83763 üìå\r\n\r\n<details><summary>Show signature</summary>\r\n\r\nSignature:\r\n\r\n```\r\nuntrusted comment: signature from minisign secret key on empty file; verify via: minisign -Vm \"${path_to_any_empty_file}\" -P RWTRmVTMeKV5noAMqVlsMugDDCyyTSbA3Re5AkUrhvLVln0tSaFWglOw -x \"${path_to_this_whole_four_line_signature_blob}\"\r\nRUTRmVTMeKV5npGrKx1nqXCw5zeVHdtdYURB/KlyA/LMFgpNCs+SkW9a8N95d+U4AP1RJMi+krxU1A3Yux4bpwZNLvVBKy0wLgM=\r\ntrusted comment: review ACK 46ca7712cb5fcf759cfc9f4f32d74215c8c83763 üìå\r\nV2n3Eh8Fc5sBB4pkAgZwhO+niN3JRgn02KN6u3xaWJyYem/L+0JNJeiBY543bvMUZO6moB6cpFgOcoXMz3FDDA==\r\n```\r\n\r\n</details>\r\n",
          "created_at": "2025-08-23T06:56:45Z"
        },
        {
          "user": "fjahr",
          "body": "Code review ACK 46ca7712cb5fcf759cfc9f4f32d74215c8c83763",
          "created_at": "2025-08-23T09:05:00Z"
        }
      ]
    },
    {
      "number": 32591,
      "title": "test: fix and augment block tests of invalid_txs",
      "body": "We are not actually testing some cases accidentally, for block inclusion.\r\n\r\nIssue discovered while reviewing https://github.com/bitcoin/bitcoin/pull/32533",
      "state": "closed",
      "user": "instagibbs",
      "created_at": "2025-05-22T14:45:38Z",
      "updated_at": "2025-05-27T13:25:36Z",
      "comments": 3,
      "url": "https://github.com/bitcoin/bitcoin/pull/32591",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32591.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [theStack](https://github.com/bitcoin/bitcoin/pull/32591#pullrequestreview-2864682937), [maflcko](https://github.com/bitcoin/bitcoin/pull/32591#issuecomment-2908905046), [BrandonOdiwuor](https://github.com/bitcoin/bitcoin/pull/32591#pullrequestreview-2868092029), [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/32591#pullrequestreview-2870607751) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-22T14:45:41Z"
        },
        {
          "user": "theStack",
          "body": "Concept ACK, good catch!",
          "created_at": "2025-05-22T14:49:55Z"
        },
        {
          "user": "maflcko",
          "body": "\r\nreview ACK 8fcd6845052354fad80ae7e5feda3f6a2e441e12 üî∂\r\n\r\n<details><summary>Show signature</summary>\r\n\r\nSignature:\r\n\r\n```\r\nuntrusted comment: signature from minisign secret key on empty file; verify via: minisign -Vm \"${path_to_any_empty_file}\" -P RWTRmVTMeKV5noAMqVlsMugDDCyyTSbA3Re5AkUrhvLVln0tSaFWglOw -x \"${path_to_this_whole_four_line_signature_blob}\"\r\nRUTRmVTMeKV5npGrKx1nqXCw5zeVHdtdYURB/KlyA/LMFgpNCs+SkW9a8N95d+U4AP1RJMi+krxU1A3Yux4bpwZNLvVBKy0wLgM=\r\ntrusted comment: review ACK 8fcd6845052354fad80ae7e5feda3f6a2e441e12 üî∂\r\ne066qpLseQp5Fo5KxGJdcA7vJSlbVMRlI7Q1n8fYQkubEeOeazm3ds2n8dgztwr9hLYBFQQor2zSept36SnWAw==\r\n```\r\n\r\n</details>\r\n",
          "created_at": "2025-05-26T08:00:19Z"
        }
      ]
    },
    {
      "number": 32589,
      "title": "[29.x] More backports",
      "body": "Backports\r\n- #31757\r\n- #32333\r\n- #32439\r\n- #32551 (just 800b7cc42ca63f2a6b245a4d327c7092289da6e1)\r\n- #32568\r\n- #32607\r\n- #32630\r\n- #32678\r\n- #32679\r\n- #32690 (just 8713e8060d504f561fed705b4aa5af7b96c36e75)\r\n- #32693\r\n- #32696\r\n- #32708\r\n- #32711\r\n- #32719\r\n- #32760\r\n- #32765\r\n- #32771\r\n- #32776\r\n- #32777\r\n\r\n\r\nCloses #32625.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-05-22T13:57:32Z",
      "updated_at": "2025-06-27T18:13:14Z",
      "comments": 8,
      "url": "https://github.com/bitcoin/bitcoin/pull/32589",
      "labels": [
        "Backport"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32589.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [instagibbs](https://github.com/bitcoin/bitcoin/pull/32589#pullrequestreview-2954625132), [willcl-ark](https://github.com/bitcoin/bitcoin/pull/32589#pullrequestreview-2957497706) |\n| Stale ACK | [glozow](https://github.com/bitcoin/bitcoin/pull/32589#pullrequestreview-2937141749), [theuni](https://github.com/bitcoin/bitcoin/pull/32589#pullrequestreview-2940441823) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (‚ú® experimental)\n\nPossible typos and grammar issues:\n\n- accomodate -> accommodate [correct spelling]  \n- into -> in [use correct preposition for ‚Äúends up in the best chain‚Äù]\n\n<sup>drahtbot_id_4_m</sup>\n",
          "created_at": "2025-05-22T13:57:35Z"
        },
        {
          "user": "achow101",
          "body": "Could add #31757",
          "created_at": "2025-06-17T20:47:08Z"
        },
        {
          "user": "fanquake",
          "body": "@achow101 is that ok to backport? See https://github.com/bitcoin/bitcoin/issues/32625#issuecomment-2920129544",
          "created_at": "2025-06-17T20:49:45Z"
        },
        {
          "user": "achow101",
          "body": "> @achow101 is that ok to backport? See [#32625 (comment)](https://github.com/bitcoin/bitcoin/issues/32625#issuecomment-2920129544)\r\n\r\nYes. https://github.com/bitcoin-core/gui/pull/864 is a fix for the root cause of some unclean shutdowns, it's otherwise unrelated to #31757.",
          "created_at": "2025-06-17T20:55:17Z"
        },
        {
          "user": "furszy",
          "body": "I probably didn‚Äôt explain it well; what I meant on https://github.com/bitcoin/bitcoin/issues/32625#issuecomment-2920129544 is that the unclean shutdown fixed by https://github.com/bitcoin-core/gui/pull/864 was triggering the issue addressed by https://github.com/bitcoin/bitcoin/pull/31757.",
          "created_at": "2025-06-18T00:28:15Z"
        },
        {
          "user": "fanquake",
          "body": "Pulled in #31757.",
          "created_at": "2025-06-18T08:45:13Z"
        },
        {
          "user": "theuni",
          "body": "I think we either want #32760 or #31998.",
          "created_at": "2025-06-18T18:44:01Z"
        },
        {
          "user": "fanquake",
          "body": "> I think we either want https://github.com/bitcoin/bitcoin/pull/32760 or https://github.com/bitcoin/bitcoin/pull/31998.\r\n\r\nSure. Pulled in #32760, and made #32690 partial (just 8713e8060d504f561fed705b4aa5af7b96c36e75).",
          "created_at": "2025-06-19T09:51:00Z"
        }
      ]
    },
    {
      "number": 32588,
      "title": "util: Abort on failing CHECK_NONFATAL in debug builds",
      "body": "A failing `CHECK_NONFATAL` will throw an exception. This is fine and even desired in production builds, because the program may catch the exception and give the user a way to easily report the bug upstream.\r\n\r\nHowever, in debug development builds, exceptions for internal bugs are problematic:\r\n\r\n* The exception could accidentally be caught and silently ignored\r\n* The exception does not include a full stacktrace, possibly making debugging harder\r\n\r\nFix all issues by turning the exception into an abort in debug builds.\r\n\r\nThis can be tested by reverting the hunks to `src/rpc/node.cpp` and `test/functional/rpc_misc.py` and then running the functional or fuzz tests.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-05-22T13:29:52Z",
      "updated_at": "2025-10-24T07:39:28Z",
      "comments": 8,
      "url": "https://github.com/bitcoin/bitcoin/pull/32588",
      "labels": [
        "Utils/log/libs"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32588.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [ryanofsky](https://github.com/bitcoin/bitcoin/pull/32588#pullrequestreview-3063286442), [achow101](https://github.com/bitcoin/bitcoin/pull/32588#issuecomment-3133809122), [stickies-v](https://github.com/bitcoin/bitcoin/pull/32588#pullrequestreview-3369219621) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-22T13:29:55Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `multiprocess, i686, DEBUG`: https://github.com/bitcoin/bitcoin/runs/42714583822</sub>\n<sub>LLM reason (‚ú® experimental): The CI failure is due to the \"rpc_tests\" subprocess aborting during the test execution.\n</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-05-22T14:34:58Z"
        },
        {
          "user": "ryanofsky",
          "body": "Concept ACK. Nice idea, and it does seem useful to have a macro checking for unexpected but not very serious conditions by throwing an exception that gets reported in release builds but is a fatal error in debug builds. And current uses of the macro seem like good candidates for that behavior.\r\n\r\nThe only possible issues I see are:\r\n\r\n(1) The name CHECK_NONFATAL doesn't make a lot of sense anymore, now triggering fatal errors when it literally says \"nonfatal\" in the name.\r\n(2) It is now more cumbersome to write unit tests checking for these conditions since they require a release build to run.\r\n\r\nBoth could be addressed in followups. Issue (2) could be addressed by having a `g_abort_hook` or similar hook allowing specific unit tests to write custom code to check for these errors if they want. (This could also be used to replace the `g_debug_lockorder_abort` variable which does something similar.)\r\n\r\nIMO, issue (1) would be nice to address by coming up with a better designed set of checking macros and starting to use them. I think it could be good to have a:\r\n\r\n- `CHECK` to check conditions and abort if false in all builds\r\n- `DCHECK` to do the same but be compiled out of release builds,\r\n- `CHECK_LOG` to log an \"internal bug detected please report\" type log message in release builds, and abort in debug builds\r\n- `CHECK_THROW` to throw an exception in release builds, and abort in log builds.\r\n\r\nThen, current `assert` uses could become `CHECK`, current `Assume` uses in hotspots could become `DCHECK`, majority of other `Assume` uses could become `CHECK_LOG`, and current `CHECK_NONFATAL` uses could become `CHECK_THROW`.\r\n\r\nJust a thought though. Maybe current names are not a real problem, and naming shouldn't block this PR in any case.",
          "created_at": "2025-05-22T19:16:49Z"
        },
        {
          "user": "maflcko",
          "body": "> `CHECK_THROW`\r\n\r\nI don't think this solves issue (1). Instead of NONFATAL being inaccurately named in debug builds, it will now be THROW, because the check is neither nonfatal nor throwing in debug builds.\r\n\r\n> Then, current `assert` uses could become `CHECK`, current `Assume` uses in hotspots could become `DCHECK`, majority of other `Assume` uses could become `CHECK_LOG`, and current `CHECK_NONFATAL` uses could become `CHECK_THROW`.\r\n\r\nNo objection, just mentioning that this would be a larger diff (including link-time changes, which are for some reason more involved in this area (https://github.com/bitcoin/bitcoin/pull/26688#issuecomment-1359622072, https://github.com/bitcoin/bitcoin/pull/32543#discussion_r2095532020)), so a separate discussion/issue/pull seems better.\r\n\r\n> cumbersome to write unit tests\r\n\r\nThx, pushed a commit to fix this.",
          "created_at": "2025-05-23T06:34:56Z"
        },
        {
          "user": "achow101",
          "body": "Concept ACK",
          "created_at": "2025-06-02T20:28:49Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `lint`: https://github.com/bitcoin/bitcoin/runs/46638610833</sub>\n<sub>LLM reason (‚ú® experimental): The CI failure is caused by a lint error due to Python code issues identified by ruff.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
          "created_at": "2025-07-24T11:34:10Z"
        },
        {
          "user": "achow101",
          "body": "ACK fa37153288ca420420636046ef6b8c4ba7e5a478",
          "created_at": "2025-07-29T19:41:59Z"
        },
        {
          "user": "maflcko",
          "body": "rfm with two acks, or does this util-only change need more?",
          "created_at": "2025-10-22T15:57:04Z"
        }
      ]
    },
    {
      "number": 32587,
      "title": "test: Fix reorg patterns in tests to use proper fork-based approach",
      "body": "Updated functional tests to replace direct use of `invalidateblock` with proper fork-based reorg behaviour. The direct invalidation approach bypasses important validation checks and has depth limitations(10 block) that don't match real-world reorg scenarios. For more details see #32531.\r\n\r\nFixes #32531",
      "state": "closed",
      "user": "yuvicc",
      "created_at": "2025-05-22T13:26:44Z",
      "updated_at": "2025-11-27T05:52:10Z",
      "comments": 47,
      "url": "https://github.com/bitcoin/bitcoin/pull/32587",
      "labels": [
        "Tests"
      ]
    },
    {
      "number": 32586,
      "title": "ci: Downgrade DEBUG=1 to -D_GLIBCXX_ASSERTIONS in centos task",
      "body": "to work around https://github.com/bitcoin/bitcoin/issues/32524#issuecomment-2900903169\r\n\r\ncloses #32524",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-05-22T11:48:55Z",
      "updated_at": "2025-05-23T15:55:28Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/pull/32586",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32586.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [laanwj](https://github.com/bitcoin/bitcoin/pull/32586#pullrequestreview-2861096204), [fanquake](https://github.com/bitcoin/bitcoin/pull/32586#pullrequestreview-2861961840) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#31802](https://github.com/bitcoin/bitcoin/pull/31802) (Add bitcoin-{node,gui} to release binaries for IPC by Sjors)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-22T11:48:59Z"
        },
        {
          "user": "fanquake",
          "body": "Not sure; now we wouldn't have any (non-msan, non-32 bit task) CI using `DEBUG=1`? It'd at least be good to note in the CI config, why this is being changed this way / when it could be removed. ",
          "created_at": "2025-05-22T13:06:52Z"
        },
        {
          "user": "maflcko",
          "body": "> Not sure; now we wouldn't have any (non-msan, non-32 bit task) CI using `DEBUG=1`? It'd at least be good to note in the CI config, why this is being changed this way / when it could be removed.\r\n\r\nOf course there is no right or wrong answer here, but I'd say that the libc++ debug build (msan) and glibc++ debug build (32-bit) are probably enough and redundant with this one anyway, so one could  even fully remove the debug setting here. (Also, there is other, possibly more important stuff, only run in nightly CIs outside this repo, including a full gcc debug run, so based on that it should also be fine)",
          "created_at": "2025-05-22T13:12:17Z"
        },
        {
          "user": "laanwj",
          "body": "> Not sure; now we wouldn't have any (non-msan, non-32 bit task) CI using DEBUG=1? It'd at least be good to note in the CI config, why this is being changed this way / when it could be removed.\r\n\r\nIn the short term, getting the CI to pass reliably again is most important imo. Adding another DEBUG run can always be considered, but shouldn't come at the cost of CI flakiness.",
          "created_at": "2025-05-22T13:37:41Z"
        },
        {
          "user": "maflcko",
          "body": "(edited a prior comment of mine, which said there are two libc++ debug runs in the CI. In reality there is the libc++ debug build (msan) and the glibc++ debug build (32-bit).)",
          "created_at": "2025-05-23T15:55:28Z"
        }
      ]
    },
    {
      "number": 32584,
      "title": "depends: hard-code necessary c(xx)flags rather than setting them per-host",
      "body": "The per-host flag variables hold platform-specific defaults that are ignored when flag environment variables are set, so it was wrong for them to contain -std options relied on by package definitions.\r\n\r\nAdditionally, these flags (-pipe and -std=xx) will no longer be passed into the CMake build, meaning less duplication in the build summary.\r\n\r\nPulled out of #31920.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-05-22T09:33:12Z",
      "updated_at": "2025-07-31T07:53:18Z",
      "comments": 10,
      "url": "https://github.com/bitcoin/bitcoin/pull/32584",
      "labels": [
        "Build system"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32584.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [ryanofsky](https://github.com/bitcoin/bitcoin/pull/32584#pullrequestreview-3067012972), [theuni](https://github.com/bitcoin/bitcoin/pull/32584#pullrequestreview-3072776246), [achow101](https://github.com/bitcoin/bitcoin/pull/32584#issuecomment-3137786763) |\n| Concept ACK | [hebasto](https://github.com/bitcoin/bitcoin/pull/32584#issuecomment-2900712416) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-22T09:33:14Z"
        },
        {
          "user": "hebasto",
          "body": "Concept ACK.",
          "created_at": "2025-05-22T10:28:43Z"
        },
        {
          "user": "maflcko",
          "body": "> The per-host flag values now represent the mandatory flags that cannot be overridden by the environment. Additionally, these flags (-pipe and -std=xx) will no longer be passed into the CMake build.\r\n\r\nWould be nice to explain this with commands to test and observe the difference in behavior. This would make it easier to understand the goals and test them.",
          "created_at": "2025-05-22T12:08:39Z"
        },
        {
          "user": "hebasto",
          "body": "My Guix build:\r\n```\r\naarch64\r\n7a5858e3364998675e06a2bec330a6fb9f619613a9228a568b5c98cba873460f  guix-build-0275825f7ace/output/aarch64-linux-gnu/SHA256SUMS.part\r\na8b08f5f246ca97ae26bf9142355797f82d3f1e7eb2ffbc1b7d78f35c4c0cd4d  guix-build-0275825f7ace/output/aarch64-linux-gnu/bitcoin-0275825f7ace-aarch64-linux-gnu-debug.tar.gz\r\n92cbdec0549173a3e3a90ac81ad2dac98d9758a76efe12a6d205cc1265f9f701  guix-build-0275825f7ace/output/aarch64-linux-gnu/bitcoin-0275825f7ace-aarch64-linux-gnu.tar.gz\r\nc7915b68fdfa3fb68e78d6264f36ddca591204578d8f3d857c3d322a17522439  guix-build-0275825f7ace/output/arm-linux-gnueabihf/SHA256SUMS.part\r\n55777a80adf1abf9e39cac043e5736279b67b67dc8dac2a3c37a19cb37e71e54  guix-build-0275825f7ace/output/arm-linux-gnueabihf/bitcoin-0275825f7ace-arm-linux-gnueabihf-debug.tar.gz\r\n1ecff64fb689fdf879de55a5a702fdcf9e35617f012a40f989e1365304745ae3  guix-build-0275825f7ace/output/arm-linux-gnueabihf/bitcoin-0275825f7ace-arm-linux-gnueabihf.tar.gz\r\n644d8e2e1b5cd4316703c6fa78d65a3ea575a31e1f24938efbf02eaadaf1bbc4  guix-build-0275825f7ace/output/arm64-apple-darwin/SHA256SUMS.part\r\ne4fa5170eaf6b0dbc792f33bc163d8ba22b0a05c0bd1b1e225bc50ad48448720  guix-build-0275825f7ace/output/arm64-apple-darwin/bitcoin-0275825f7ace-arm64-apple-darwin-codesigning.tar.gz\r\n9684c05d427446218e72f40340f65680f8e2b1a06496b7ab3f65181daf432a9b  guix-build-0275825f7ace/output/arm64-apple-darwin/bitcoin-0275825f7ace-arm64-apple-darwin-unsigned.tar.gz\r\na9b892fa30ef9e02c9066635bd7768a13c3971ec0035d13c0857a8c837af2170  guix-build-0275825f7ace/output/arm64-apple-darwin/bitcoin-0275825f7ace-arm64-apple-darwin-unsigned.zip\r\nb085ac19b1eac59497975bccbe4997b772a224c27c527376950590ce86b8ef82  guix-build-0275825f7ace/output/dist-archive/bitcoin-0275825f7ace.tar.gz\r\n7da262d6ac77a64fc5c3a550c6b72dd9dd93a923cbf3045edc4696eb4e1af043  guix-build-0275825f7ace/output/powerpc64-linux-gnu/SHA256SUMS.part\r\n5eef5b5c79b26f3f8ad3243637ca238b5e43f55f369375312ab186dc29213e7b  guix-build-0275825f7ace/output/powerpc64-linux-gnu/bitcoin-0275825f7ace-powerpc64-linux-gnu-debug.tar.gz\r\n3a5f90e01e28fa920954bc551594936d359f0009033172d218cb31bd6842138b  guix-build-0275825f7ace/output/powerpc64-linux-gnu/bitcoin-0275825f7ace-powerpc64-linux-gnu.tar.gz\r\ned6ce026a6ae7a22dfcdc7f9c8c2ab4df33f665562b65924633288fa9b19f7e8  guix-build-0275825f7ace/output/riscv64-linux-gnu/SHA256SUMS.part\r\n205569f39bc41d0b70206f08dbafae994afaedce32c2dd79972c9775dc916dd8  guix-build-0275825f7ace/output/riscv64-linux-gnu/bitcoin-0275825f7ace-riscv64-linux-gnu-debug.tar.gz\r\n90f23ce8f6498992b55069b5c8f616adfb9b5061bb301fee31f2e4ebc7912741  guix-build-0275825f7ace/output/riscv64-linux-gnu/bitcoin-0275825f7ace-riscv64-linux-gnu.tar.gz\r\n4628de0d41b2a2fceddc115e66a54455cdd0eea61118c841ac9ba0dc789cf3c6  guix-build-0275825f7ace/output/x86_64-apple-darwin/SHA256SUMS.part\r\ne851467d91e4d0ccccd3a93e3b34a76eb1c7df22c5167014ee7273f9ea78b481  guix-build-0275825f7ace/output/x86_64-apple-darwin/bitcoin-0275825f7ace-x86_64-apple-darwin-codesigning.tar.gz\r\n7e933ca4b5598f50d7c981f4c555965b383469c15a138c426c3151626de676b4  guix-build-0275825f7ace/output/x86_64-apple-darwin/bitcoin-0275825f7ace-x86_64-apple-darwin-unsigned.tar.gz\r\n03fe5fc86d56a1a88f5b50e2da2fad4c72449ae3f6922aa7366cd15e730f4b89  guix-build-0275825f7ace/output/x86_64-apple-darwin/bitcoin-0275825f7ace-x86_64-apple-darwin-unsigned.zip\r\n11de70c37658da525c7c24d9230ac56256c081446bd1db4adab6daa5bc4f44d6  guix-build-0275825f7ace/output/x86_64-linux-gnu/SHA256SUMS.part\r\nb9afb4e4991e07d33b221be4b3e8dbbafa97cd9ea32d86750d0badb507545ff0  guix-build-0275825f7ace/output/x86_64-linux-gnu/bitcoin-0275825f7ace-x86_64-linux-gnu-debug.tar.gz\r\nb52d43b67ff116532f7570ea370328f769058cb1b98e61bc4458ad9ea61816b6  guix-build-0275825f7ace/output/x86_64-linux-gnu/bitcoin-0275825f7ace-x86_64-linux-gnu.tar.gz\r\n7a226edf53b81befd0f88897894dd379d5ff646d8e39e24d8d9cbadb349d2f71  guix-build-0275825f7ace/output/x86_64-w64-mingw32/SHA256SUMS.part\r\neeb512d3fa02d381eb440b91eeb7c59498021181a6d59c7f4b6e2a7836e7b913  guix-build-0275825f7ace/output/x86_64-w64-mingw32/bitcoin-0275825f7ace-win64-codesigning.tar.gz\r\nf90557e9ec12797544e46ce487ea615c0034963e570e67ddace85fafdb654455  guix-build-0275825f7ace/output/x86_64-w64-mingw32/bitcoin-0275825f7ace-win64-debug.zip\r\nb5aef6dbcc804ede4750c0975b3936df16dc855f41b867044207893a09facc0e  guix-build-0275825f7ace/output/x86_64-w64-mingw32/bitcoin-0275825f7ace-win64-setup-unsigned.exe\r\nca9d189c66eb2b4f4f56f93272fd09ba2bf8d46dc68217782163020d2071c81e  guix-build-0275825f7ace/output/x86_64-w64-mingw32/bitcoin-0275825f7ace-win64-unsigned.zip\r\n```",
          "created_at": "2025-05-22T14:21:22Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--9cd9c72976c961c55c7acef8f6ba82cd-->\n### Guix builds (on x86_64) [untrusted test-only build, possibly unsafe, not for production use]\n\n| File | commit 35bf3f88398da0211cece0a29da4de001e34a4dd<br>(master) | commit 21d855af47ee4cbcd038c588529566779181fc32<br>(pull/32584/merge) |\n|--|--|--|\n| *-aarch64-linux-gnu-debug.tar.gz | [`c35cf51a398c92df...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-aarch64-linux-gnu-debug.tar.gz) | [`a22608e4225637a7...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-aarch64-linux-gnu-debug.tar.gz) |\n| *-aarch64-linux-gnu.tar.gz | [`82d0798dfae78051...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-aarch64-linux-gnu.tar.gz) | [`2f2705212ffa1c69...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-aarch64-linux-gnu.tar.gz) |\n| *-arm-linux-gnueabihf-debug.tar.gz | [`df45940210e7d3b8...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-arm-linux-gnueabihf-debug.tar.gz) | [`34ac31537a9af3d6...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-arm-linux-gnueabihf-debug.tar.gz) |\n| *-arm-linux-gnueabihf.tar.gz | [`f8999c6256936417...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-arm-linux-gnueabihf.tar.gz) | [`68c1e4ec2a247131...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-arm-linux-gnueabihf.tar.gz) |\n| *-arm64-apple-darwin-codesigning.tar.gz | [`e33513a263389b7c...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-arm64-apple-darwin-codesigning.tar.gz) | [`81bf7cd522670770...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-arm64-apple-darwin-codesigning.tar.gz) |\n| *-arm64-apple-darwin-unsigned.tar.gz | [`7c5a453513ec0850...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-arm64-apple-darwin-unsigned.tar.gz) | [`f47233df5c83e4cf...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-arm64-apple-darwin-unsigned.tar.gz) |\n| *-arm64-apple-darwin-unsigned.zip | [`d57eb714e111132b...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-arm64-apple-darwin-unsigned.zip) | [`e3dfe76fc44c05c2...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-arm64-apple-darwin-unsigned.zip) |\n| *-powerpc64-linux-gnu-debug.tar.gz | [`5467ae49d1d3c68c...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-powerpc64-linux-gnu-debug.tar.gz) | [`a7456d49c6dd2915...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-powerpc64-linux-gnu-debug.tar.gz) |\n| *-powerpc64-linux-gnu.tar.gz | [`76f667e56592f732...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-powerpc64-linux-gnu.tar.gz) | [`398f77f8f5877965...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-powerpc64-linux-gnu.tar.gz) |\n| *-riscv64-linux-gnu-debug.tar.gz | [`29c6f37babe24e24...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-riscv64-linux-gnu-debug.tar.gz) | [`433a3a360708e910...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-riscv64-linux-gnu-debug.tar.gz) |\n| *-riscv64-linux-gnu.tar.gz | [`4ac255dfa3f295c6...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-riscv64-linux-gnu.tar.gz) | [`750d33b88fd4db35...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-riscv64-linux-gnu.tar.gz) |\n| *-x86_64-apple-darwin-codesigning.tar.gz | [`1fab8a669d4b58c9...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-x86_64-apple-darwin-codesigning.tar.gz) | [`1ca27635a9338e0e...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-x86_64-apple-darwin-codesigning.tar.gz) |\n| *-x86_64-apple-darwin-unsigned.tar.gz | [`abbbc7b484711bc7...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-x86_64-apple-darwin-unsigned.tar.gz) | [`55a3db7ba7c8e60d...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-x86_64-apple-darwin-unsigned.tar.gz) |\n| *-x86_64-apple-darwin-unsigned.zip | [`d748d4548ea33f6c...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-x86_64-apple-darwin-unsigned.zip) | [`df58b83819fa4ba3...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-x86_64-apple-darwin-unsigned.zip) |\n| *-x86_64-linux-gnu-debug.tar.gz | [`8fc1e04b90d920df...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-x86_64-linux-gnu-debug.tar.gz) | [`0f1bab24f73b0f1f...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-x86_64-linux-gnu-debug.tar.gz) |\n| *-x86_64-linux-gnu.tar.gz | [`7831f9973e845882...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d-x86_64-linux-gnu.tar.gz) | [`bcf9e56695d9437a...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee-x86_64-linux-gnu.tar.gz) |\n| *.tar.gz | [`eaf62bd30c82aab0...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/bitcoin-35bf3f88398d.tar.gz) | [`2f988f8cbb8e698d...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/bitcoin-21d855af47ee.tar.gz) |\n| SHA256SUMS.part | [`9ca1bc71bda735df...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/SHA256SUMS.part) | [`f2b33615e84e95d3...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/SHA256SUMS.part) |\n| guix_build.log | [`810be13f8c3ecc43...`](https://drahtbot.space/guix/monotree/35bf3f88398da0211cece0a29da4de001e34a4dd/guix_build.log) | [`21055af7dd4549f6...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/guix_build.log) |\n| guix_build.log.diff |  | [`716ad18d12ece0ad...`](https://drahtbot.space/guix/monotree/21d855af47ee4cbcd038c588529566779181fc32/guix_build.log.diff) |\n\n",
          "created_at": "2025-05-23T02:04:47Z"
        },
        {
          "user": "fanquake",
          "body": "> Would be nice to explain this with commands to test and observe the difference in behavior. This would make it easier to understand the goals and test them.\r\n\r\nSure. On master (4b1d48a6866b24f0ed027334c6de642fc848d083):\r\n```bash\r\n# flags in C(XX)FLAGS\r\nmake -C depends print-linux_CFLAGS\r\nlinux_CFLAGS=-pipe -std=c11\r\nmake -C depends print-linux_CXXFLAGS\r\nlinux_CXXFLAGS=-pipe -std=c++20\r\n```\r\n\r\nLibevent depends build:\r\n```bash\r\n make -C depends libevent\r\n# base cflags (-pipe -std=c11) present in libevent build\r\n-- CMAKE_C_FLAGS:            -I/root/ci_scratch/depends/x86_64-pc-linux-gnu/include -D_GNU_SOURCE -D_FORTIFY_SOURCE=3 -pipe -std=c11 -O2 -fdebug-prefix-map=/root/ci_scratch/depends/work/build/x86_64-pc-linux-gnu/libevent/2.1.12-stable-1afae5fc856=/usr -fmacro-prefix-map=/root/ci_scratch/depends/work/build/x86_64-pc-linux-gnu/libevent/2.1.12-stable-1afae5fc856=/usr -Wall -Wextra -Wno-unused-parameter -Wstrict-aliasing -Wstrict-prototypes -fno-strict-aliasing -Wmissing-prototypes -Winit-self -Wmissing-field-initializers -Wdeclaration-after-statement -Waddress -Wnormalized=id -Woverride-init -Wlogical-op -Wwrite-strings\r\n```\r\n\r\nCMake configure:\r\n```bash\r\n# duplicated -std=c++20, -pipe\r\nC++ compiler flags .................... -m64 -pipe -std=c++20 -O2 -O2 -g -std=c++20 -fPIC -fno-extended-identifiers -fdebug-prefix-map=/root/ci_scratch/src=. -fmacro-prefix-map=/root/ci_scratch/src=. -fstack-reuse=none -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=3 -Wstack-protector -fstack-protector-all -fcf-protection=full -fstack-clash-protection -Wall -Wextra -Wformat -Wformat-security -Wvla -Wredundant-decls -Wdate-time -Wduplicated-branches -Wduplicated-cond -Wlogical-op -Woverloaded-virtual -Wsuggest-override -Wimplicit-fallthrough -Wunreachable-code -Wbidi-chars=any -Wundef -Wno-unused-parameter\r\nLinker flags .......................... -pipe -std=c++20 -O2 -O2 -g -fstack-reuse=none -fstack-protector-all -fcf-protection=full -fstack-clash-protection -Wl,-z,relro -Wl,-z,now -Wl,-z,separate-code -fPIE -pie\r\n```\r\n\r\nWith this PR:\r\n```bash\r\n# flags no-longer in C(XX)FLAGS\r\nmake -C depends print-linux_CFLAGS\r\nlinux_CFLAGS=\r\nmake -C depends print-linux_CXXFLAGS\r\nlinux_CXXFLAGS=\r\n```\r\n\r\nLibevent depends build:\r\n```bash\r\n make -C depends libevent\r\n# base cflags still present in libevent build\r\n-- CMAKE_C_FLAGS:            -I/root/ci_scratch/depends/x86_64-pc-linux-gnu/include -D_GNU_SOURCE -D_FORTIFY_SOURCE=3  -O2 -pipe -std=c11 -fdebug-prefix-map=/root/ci_scratch/depends/work/build/x86_64-pc-linux-gnu/libevent/2.1.12-stable-ce229553a77=/usr -fmacro-prefix-map=/root/ci_scratch/depends/work/build/x86_64-pc-linux-gnu/libevent/2.1.12-stable-ce229553a77=/usr -Wall -Wextra -Wno-unused-parameter -Wstrict-aliasing -Wstrict-prototypes -fno-strict-aliasing -Wmissing-prototypes -Winit-self -Wmissing-field-initializers -Wdeclaration-after-statement -Waddress -Wnormalized=id -Woverride-init -Wlogical-op -Wwrite-strings\r\n```\r\n\r\nCMake configure\r\n```bash\r\ncmake -B build --toolchain /root/ci_scratch/depends/x86_64-pc-linux-gnu/toolchain.cmake\r\n# flags no-longer being passed through. \r\n# No more duplicated -std=c++20, -pipe removed\r\nC++ compiler flags .................... -m64 -O2 -O2 -g -std=c++20 -fPIC -fno-extended-identifiers -fdebug-prefix-map=/root/ci_scratch/src=. -fmacro-prefix-map=/root/ci_scratch/src=. -fstack-reuse=none -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=3 -Wstack-protector -fstack-protector-all -fcf-protection=full -fstack-clash-protection -Wall -Wextra -Wformat -Wformat-security -Wvla -Wredundant-decls -Wdate-time -Wduplicated-branches -Wduplicated-cond -Wlogical-op -Woverloaded-virtual -Wsuggest-override -Wimplicit-fallthrough -Wunreachable-code -Wbidi-chars=any -Wundef -Wno-unused-parameter\r\nLinker flags .......................... -O2 -O2 -g -fstack-reuse=none -fstack-protector-all -fcf-protection=full -fstack-clash-protection -Wl,-z,relro -Wl,-z,now -Wl,-z,separate-code -fPIE -pie\r\n```",
          "created_at": "2025-05-30T13:25:59Z"
        },
        {
          "user": "fanquake",
          "body": "Guix Build:\r\n```bash\r\nc118e9965e3dc46a58e78ca4bb1573bf799d10b0a5a33c978ed5873801ded1e4  guix-build-51f6aa8ac47b/output/aarch64-linux-gnu/SHA256SUMS.part\r\nabe0a4b2fee4bc928b73a0d8bfaeb7441a45afc01147f71ec76339844fa1a502  guix-build-51f6aa8ac47b/output/aarch64-linux-gnu/bitcoin-51f6aa8ac47b-aarch64-linux-gnu-debug.tar.gz\r\n444bccc99b7a8910b62aef674ac9a0249f895c78ed19268017651eefeef5abd2  guix-build-51f6aa8ac47b/output/aarch64-linux-gnu/bitcoin-51f6aa8ac47b-aarch64-linux-gnu.tar.gz\r\nec1a9597e32d60a8588b5ac75b5f37cde90275f0dc1eeaf5a68310b43a5a3c84  guix-build-51f6aa8ac47b/output/arm-linux-gnueabihf/SHA256SUMS.part\r\n90ae5ac3137e4644791f2e2c330df1c305552ba7346efec23fa5e343ac0500d2  guix-build-51f6aa8ac47b/output/arm-linux-gnueabihf/bitcoin-51f6aa8ac47b-arm-linux-gnueabihf-debug.tar.gz\r\ne850814b9773ae89047db6ce8132ed4729152cce42bbd8afbc8135baac9428f9  guix-build-51f6aa8ac47b/output/arm-linux-gnueabihf/bitcoin-51f6aa8ac47b-arm-linux-gnueabihf.tar.gz\r\nf0f35d08337a1cf6a2ec49d5c1ba763ef43e8bd742534f7ef2fb713e48241cd9  guix-build-51f6aa8ac47b/output/arm64-apple-darwin/SHA256SUMS.part\r\n5254245b0788ef0e14e263f4c95bb0495ea164350e5818d3cba8a3cb96716194  guix-build-51f6aa8ac47b/output/arm64-apple-darwin/bitcoin-51f6aa8ac47b-arm64-apple-darwin-codesigning.tar.gz\r\n4dc618aeccd57ea4cca4ba75b451e80ef2edcc198011c608042708ee7400472d  guix-build-51f6aa8ac47b/output/arm64-apple-darwin/bitcoin-51f6aa8ac47b-arm64-apple-darwin-unsigned.tar.gz\r\n8c70722ad7f6112a9d95d8ba631c6e18060b967290d53d5dadda030b941267c1  guix-build-51f6aa8ac47b/output/arm64-apple-darwin/bitcoin-51f6aa8ac47b-arm64-apple-darwin-unsigned.zip\r\ncdaa7a6bf8f86e72414688c8c28f9156e29bf4a4a7435193bea52358e48d9b28  guix-build-51f6aa8ac47b/output/dist-archive/bitcoin-51f6aa8ac47b.tar.gz\r\nd413725fca363d8f375ee5c1db233ccf6e96fd847b0ae63a1a6dfde59f98695b  guix-build-51f6aa8ac47b/output/powerpc64-linux-gnu/SHA256SUMS.part\r\n3b685610b39a2e01665eed76e688871d8079533ebcfbbc0fe9b8f4fd69fe6114  guix-build-51f6aa8ac47b/output/powerpc64-linux-gnu/bitcoin-51f6aa8ac47b-powerpc64-linux-gnu-debug.tar.gz\r\n771c426dc6bffba8f17cb092653c85a3554d92e4e5b892cc69370aa1ed50115b  guix-build-51f6aa8ac47b/output/powerpc64-linux-gnu/bitcoin-51f6aa8ac47b-powerpc64-linux-gnu.tar.gz\r\n84a66c1a4661e98dea9fe871e333ea19812687e6910639d69be3b9e6cc252f35  guix-build-51f6aa8ac47b/output/riscv64-linux-gnu/SHA256SUMS.part\r\na94bfe4984fe5171963962a73bd5b5239a5c725fc264510f034cb7a63fee1cd6  guix-build-51f6aa8ac47b/output/riscv64-linux-gnu/bitcoin-51f6aa8ac47b-riscv64-linux-gnu-debug.tar.gz\r\nd1e8c64b66854a29882d3e12b6f28f8f9b4737ccbf285f40d252854d2b960771  guix-build-51f6aa8ac47b/output/riscv64-linux-gnu/bitcoin-51f6aa8ac47b-riscv64-linux-gnu.tar.gz\r\nb6fbe77174f73b544c21720631b0b1b7b387c3e635159f9ca9cb6cdeedbde76a  guix-build-51f6aa8ac47b/output/x86_64-apple-darwin/SHA256SUMS.part\r\nc2895950434f8b946ec9ab380659104e5c763d07f353263d5b5d889de4385be8  guix-build-51f6aa8ac47b/output/x86_64-apple-darwin/bitcoin-51f6aa8ac47b-x86_64-apple-darwin-codesigning.tar.gz\r\n645547eaaf9b37adbba3efca9387db9a50238dbc079853a0d40bd75565313e89  guix-build-51f6aa8ac47b/output/x86_64-apple-darwin/bitcoin-51f6aa8ac47b-x86_64-apple-darwin-unsigned.tar.gz\r\nb1ab6fd7a47c495bd5f18411f3d9ce4f2820e3f0ce2826fe40cdf8f05c42a99e  guix-build-51f6aa8ac47b/output/x86_64-apple-darwin/bitcoin-51f6aa8ac47b-x86_64-apple-darwin-unsigned.zip\r\n5361f2e3f6c980579c663f9bebef8a60c5c939a8f70dacd8fc9d3a9dd6b94ba3  guix-build-51f6aa8ac47b/output/x86_64-linux-gnu/SHA256SUMS.part\r\n92f47e0af06207c53904f4ff4f3ff7dad2636e3d0c38bad5fb01ab434aca5d9b  guix-build-51f6aa8ac47b/output/x86_64-linux-gnu/bitcoin-51f6aa8ac47b-x86_64-linux-gnu-debug.tar.gz\r\na18b3d0c2143879b59caafc8f09e999ab4d9435c665d091f49ba612f572cbfa9  guix-build-51f6aa8ac47b/output/x86_64-linux-gnu/bitcoin-51f6aa8ac47b-x86_64-linux-gnu.tar.gz\r\nf0c361e3efdbd799cbeb91e7423e9de5ee09f83a93c6857365b8ac1a4670a6ed  guix-build-51f6aa8ac47b/output/x86_64-w64-mingw32/SHA256SUMS.part\r\n7d0341bf264916c96d8816f923affa37908d8b4a5ada3d4b276d2450ca874788  guix-build-51f6aa8ac47b/output/x86_64-w64-mingw32/bitcoin-51f6aa8ac47b-win64-codesigning.tar.gz\r\n8d150336eb837673c964d3c9d2137ad9e475f1c6db457b7a845d3277b5a29d1b  guix-build-51f6aa8ac47b/output/x86_64-w64-mingw32/bitcoin-51f6aa8ac47b-win64-debug.zip\r\nf437f7403b6958d991d1f7d4d5f5b611cc2e3e245335b6bf5cf5b33aeff8a1cf  guix-build-51f6aa8ac47b/output/x86_64-w64-mingw32/bitcoin-51f6aa8ac47b-win64-setup-unsigned.exe\r\n2b06924fe6e5f20a1a2993e63198584278be0407e312c392f6be0240d4a52f1d  guix-build-51f6aa8ac47b/output/x86_64-w64-mingw32/bitcoin-51f6aa8ac47b-win64-unsigned.zip\r\n```",
          "created_at": "2025-05-30T15:47:18Z"
        },
        {
          "user": "fanquake",
          "body": "@ryanofsky made some changes to try and address your feedback. ",
          "created_at": "2025-07-29T10:15:39Z"
        },
        {
          "user": "fanquake",
          "body": "Guix Build (aarch64):\r\n```bash\r\nd7dcb667b0d801e51490f677fe08be66ba635df93085d0479dcd00443b93bbf2  guix-build-9954d6c83338/output/aarch64-linux-gnu/SHA256SUMS.part\r\n296a26bd69bc458e5a5953876703c664bf760f24ed93c61a43b418522c5c8e3a  guix-build-9954d6c83338/output/aarch64-linux-gnu/bitcoin-9954d6c83338-aarch64-linux-gnu-debug.tar.gz\r\n118a81b7e941929f2d95d426e2b2a5d698b90f381819fc68572f5ec06d05b825  guix-build-9954d6c83338/output/aarch64-linux-gnu/bitcoin-9954d6c83338-aarch64-linux-gnu.tar.gz\r\n24d45e2b4e2d09a29b08ae8597b620a7ac657bfd4ee43dc7f8a371bd9b6b9a11  guix-build-9954d6c83338/output/arm-linux-gnueabihf/SHA256SUMS.part\r\n208d0671a44751aaadad7a9a65756e0e7b92c2e1d44a462a479bd5d42129c543  guix-build-9954d6c83338/output/arm-linux-gnueabihf/bitcoin-9954d6c83338-arm-linux-gnueabihf-debug.tar.gz\r\n53bddbb6abf554a14dea629ea962e17db86ba4e86c1de74dd146e5ad2c70bc07  guix-build-9954d6c83338/output/arm-linux-gnueabihf/bitcoin-9954d6c83338-arm-linux-gnueabihf.tar.gz\r\n81420ef9f0bd51bf9d96e39d4093550b12e668226cf1c536c31020bafe48e81d  guix-build-9954d6c83338/output/arm64-apple-darwin/SHA256SUMS.part\r\nb3293d37d063d589724975b4da12314f71c1fac22bf08690a79296d48057f62c  guix-build-9954d6c83338/output/arm64-apple-darwin/bitcoin-9954d6c83338-arm64-apple-darwin-codesigning.tar.gz\r\n9b28cbf6d8bcd7871dfbc2e1783dcbfb98a10624cd70a89f9534abf58a16d50e  guix-build-9954d6c83338/output/arm64-apple-darwin/bitcoin-9954d6c83338-arm64-apple-darwin-unsigned.tar.gz\r\n93bec960a74cecd9820618423fb2166db82d3b0558108fbdc5bde0bffc87019f  guix-build-9954d6c83338/output/arm64-apple-darwin/bitcoin-9954d6c83338-arm64-apple-darwin-unsigned.zip\r\n52cb86ee94ad7c3500c8bce15ad99c81bd4d6df838e25f9a40f5e58ed6934da3  guix-build-9954d6c83338/output/dist-archive/bitcoin-9954d6c83338.tar.gz\r\n7b5f18f3b805ca0fb91a8394b9848d8d8961152f888e09e741412ec1ec0f681b  guix-build-9954d6c83338/output/powerpc64-linux-gnu/SHA256SUMS.part\r\na02963535304002b9f243e7867163a2574ed67797043d4f9ab834b02ec0b42e3  guix-build-9954d6c83338/output/powerpc64-linux-gnu/bitcoin-9954d6c83338-powerpc64-linux-gnu-debug.tar.gz\r\n7ba5fd240e748a51d8bf96034501b42bb17066f0ab37304de40a97f9aa74def3  guix-build-9954d6c83338/output/powerpc64-linux-gnu/bitcoin-9954d6c83338-powerpc64-linux-gnu.tar.gz\r\neeea9d6d6f65b17f56fa0c828bce80e5b75895c89976ff751cef653feeffad74  guix-build-9954d6c83338/output/riscv64-linux-gnu/SHA256SUMS.part\r\ndebc8334f914062b32aa8587831f6ff5ee62c0e47718c773110d36f730462069  guix-build-9954d6c83338/output/riscv64-linux-gnu/bitcoin-9954d6c83338-riscv64-linux-gnu-debug.tar.gz\r\n33bb5d3f89f4eed67fc5dbe0123002d089c026f5dd5a2d4946c09a29d05b654e  guix-build-9954d6c83338/output/riscv64-linux-gnu/bitcoin-9954d6c83338-riscv64-linux-gnu.tar.gz\r\n35c75687c542b300eb0a135ca042b44e76c6857271193ff874d58c626466343e  guix-build-9954d6c83338/output/x86_64-apple-darwin/SHA256SUMS.part\r\n0c3cd5ac202382de581b3a3d7bdae8cbe8140abb169046e9d5e187e7926bae6c  guix-build-9954d6c83338/output/x86_64-apple-darwin/bitcoin-9954d6c83338-x86_64-apple-darwin-codesigning.tar.gz\r\n5b103619180837f66bb78bdee721ee43f5cb136a4d29f46bdc71564dc9b8ad4c  guix-build-9954d6c83338/output/x86_64-apple-darwin/bitcoin-9954d6c83338-x86_64-apple-darwin-unsigned.tar.gz\r\nd31986c8aad00a9ad15d9118338e962a91b9f9d01e889ea1098345962876074f  guix-build-9954d6c83338/output/x86_64-apple-darwin/bitcoin-9954d6c83338-x86_64-apple-darwin-unsigned.zip\r\n3b6f644f9328fd3b15fca810d63d1a026c51ff20e26dc886feb27b4457629a80  guix-build-9954d6c83338/output/x86_64-linux-gnu/SHA256SUMS.part\r\n2760e4cbb5fc08c475d1f975a01245442b03f7e06e4775c60eb98777e609e994  guix-build-9954d6c83338/output/x86_64-linux-gnu/bitcoin-9954d6c83338-x86_64-linux-gnu-debug.tar.gz\r\n6383ef2a8dd083324647b87cb0d65fdb82a9603c7145ff116ee210d2a5431aee  guix-build-9954d6c83338/output/x86_64-linux-gnu/bitcoin-9954d6c83338-x86_64-linux-gnu.tar.gz\r\n1fa7c2e217473f7306061473319deafc9f4b70fb45c7a6ac196da6ae81a981f8  guix-build-9954d6c83338/output/x86_64-w64-mingw32/SHA256SUMS.part\r\n0eae1f6129dec68d531a5d02ca91e420e6c8a7f411e9e47e3cd04479f9b4d985  guix-build-9954d6c83338/output/x86_64-w64-mingw32/bitcoin-9954d6c83338-win64-codesigning.tar.gz\r\n2f38a57a5ca2def7b2f0298a8f38e51528e77ef194e763488538da02e7296bac  guix-build-9954d6c83338/output/x86_64-w64-mingw32/bitcoin-9954d6c83338-win64-debug.zip\r\n4ac3facb227516381629e0169e11f6e1d68b0ffedb4a0cc0d8524431dd5f3271  guix-build-9954d6c83338/output/x86_64-w64-mingw32/bitcoin-9954d6c83338-win64-setup-unsigned.exe\r\ndb61a847feb0b2de0bb54c59bcb49b1da2bded0cab20bb3d53e88ca771e9bf52  guix-build-9954d6c83338/output/x86_64-w64-mingw32/bitcoin-9954d6c83338-win64-unsigned.zip\r\n```",
          "created_at": "2025-07-29T14:01:21Z"
        },
        {
          "user": "achow101",
          "body": "ACK 9954d6c833381a44e1ea34d182ffe4d61b65d2ba",
          "created_at": "2025-07-30T20:53:19Z"
        }
      ]
    },
    {
      "number": 32582,
      "title": "log: Additional compact block logging",
      "body": "This PR adds some additional logging to help measure performance of compact block reconstruction.\r\n\r\n1. Adds a message to the beginning of `PartiallyDownloadedBlock::InitData()` so that that the logs indicate the amount of time it takes to populate a compact block from mempool transactions.\r\n2. Logs the size of the transactions which a node did not have in its mempool and was forced to request.\r\n3. Logs the size and number of transactions that a node sends to it's peer in a `BLOCKTXN` to fulfill a compact block `GETBLOCKTXN` request.\r\n\r\nRelevant to this discussion on delving bitcoin: https://delvingbitcoin.org/t/stats-on-compact-block-reconstructions/1052",
      "state": "closed",
      "user": "davidgumberg",
      "created_at": "2025-05-22T02:00:42Z",
      "updated_at": "2025-07-31T19:15:36Z",
      "comments": 7,
      "url": "https://github.com/bitcoin/bitcoin/pull/32582",
      "labels": [
        "Utils/log/libs"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32582.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [w0xlt](https://github.com/bitcoin/bitcoin/pull/32582#pullrequestreview-2876384059), [instagibbs](https://github.com/bitcoin/bitcoin/pull/32582#issuecomment-2917570611), [1440000bytes](https://github.com/bitcoin/bitcoin/pull/32582#pullrequestreview-2876724595) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-05-22T02:00:45Z"
        },
        {
          "user": "1440000bytes",
          "body": "Concept ACK ",
          "created_at": "2025-05-22T12:30:59Z"
        },
        {
          "user": "fanquake",
          "body": "cc @instagibbs ",
          "created_at": "2025-05-22T17:15:59Z"
        },
        {
          "user": "davidgumberg",
          "body": "Rebased to address @w0xlt feedback.",
          "created_at": "2025-05-28T18:48:11Z"
        },
        {
          "user": "davidgumberg",
          "body": "Rebased to address @instagibbs feedback.",
          "created_at": "2025-05-28T20:33:41Z"
        },
        {
          "user": "instagibbs",
          "body": "reACK https://github.com/bitcoin/bitcoin/pull/32582/commits/83df64d7491b8271f7dfa2aea30f055102e3ff39",
          "created_at": "2025-05-28T20:46:06Z"
        },
        {
          "user": "0xB10C",
          "body": "LGTM post-merge ACK. Will run this with compact block logging enabled on a few of my nodes.",
          "created_at": "2025-06-03T10:50:11Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 32590,
      "title": "seeds: seed.bitcoin.jonasschnelli.ch not returning results",
      "body": "Also shown by [check-dnsseeds.py](https://github.com/bitcoin-core/bitcoin-maintainer-tools/blob/main/check-dnsseeds.py):\n```bash\n./check-dnsseeds.py\n* mainnet\nOK   seed.bitcoin.sipa.be (39 results)\nOK   dnsseed.bluematt.me (31 results)\nOK   dnsseed.bitcoin.dashjr-list-of-p2p-nodes.us (35 results)\nOK   seed.bitcoinstats.com (24 results)\nFAIL seed.bitcoin.jonasschnelli.ch\nOK   seed.btc.petertodd.net (37 results)\nOK   seed.bitcoin.sprovoost.nl (36 results)\nOK   dnsseed.emzy.de (40 results)\nOK   seed.bitcoin.wiz.biz (31 results)\n```\n\ncc @jonasschnelli.",
      "state": "closed",
      "user": "fanquake",
      "created_at": "2025-05-22T14:18:40Z",
      "updated_at": "2025-06-01T08:05:41Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/issues/32590",
      "labels": [
        "P2P"
      ],
      "comment_list": [
        {
          "user": "jonasschnelli",
          "body": "Fixed.",
          "created_at": "2025-05-22T17:29:42Z"
        },
        {
          "user": "fanquake",
          "body": "Thanks mate.",
          "created_at": "2025-05-22T21:09:22Z"
        },
        {
          "user": "fanquake",
          "body": "I am seeing this again.",
          "created_at": "2025-05-29T09:06:43Z"
        },
        {
          "user": "jonasschnelli",
          "body": "Thanks for reporting.\nVM ran out of RAM again... increased RAM and restarted.\nLet‚Äôs see.",
          "created_at": "2025-05-31T20:28:43Z"
        }
      ]
    },
    {
      "number": 32583,
      "title": "Support `Accept` HTTP header in REST API",
      "body": "### Please describe the feature you'd like to see added.\n\nFollowing https://github.com/bitcoin/bitcoin/pull/32540#issuecomment-2888533229, I would like to add support for the [HTTP `Accept` header](https://www.rfc-editor.org/rfc/rfc9110#name-accept), in addition to current \"suffix-based\" data format detection:\nhttps://github.com/bitcoin/bitcoin/blob/87ec923d3a7af7b30613174b41c6fb11671df466/src/rest.cpp#L137-L160\n\nWDYT?\n\n### Describe the solution you'd like\n\nI would suggest checking the HTTP request `Accept` header, and using it to if there is no suffix set:\n\n>  I wonder about just adding a content-type like option so that the api endpoint is the same but you simply say if you want binary or json content returned?\n",
      "state": "closed",
      "user": "romanz",
      "created_at": "2025-05-22T05:15:53Z",
      "updated_at": "2025-05-24T15:31:04Z",
      "comments": 9,
      "url": "https://github.com/bitcoin/bitcoin/issues/32583",
      "labels": [
        "Feature"
      ],
      "comment_list": [
        {
          "user": "maflcko",
          "body": "Not sure. This means there will be two conflicting? ways to specify the same. I don't see the benefit either.",
          "created_at": "2025-05-22T12:37:39Z"
        },
        {
          "user": "romanz",
          "body": "Thanks @maflcko - you're right, it's better to have one way for specifying the expected content format.\n\n@yancyribbens WDYT? ",
          "created_at": "2025-05-22T13:39:46Z"
        },
        {
          "user": "yancyribbens",
          "body": "I'm not sure what is meant by two conflicting types really.\n\nI was thinking it would be possible to make a request using either json or binary in the request HTTP header.  For example:\n\n```\ncurl -X POST https://bitcoin\n   -H 'Accept: application/json'\n```\n\nOR\n\n```\ncurl -X POST https://bitcoin\n   -H 'Accept: application/octet-stream'\n```\n\nIf no Accept content type is set then default to what it is now, json.\n\nI'm not sure, is that what the code snippet above is doing?  I don't really grok what's happening with format string.",
          "created_at": "2025-05-24T13:07:25Z"
        },
        {
          "user": "sipa",
          "body": "I don't understand the point of this. The format is already specified using the extension, which seems more convenient to me than needing an additional header to specify the content type, and having two distinct ways of specifying it seems significantly worse than just having one.\n\n> I'm not sure what is meant by two conflicting types really.\n\nI suspect Marco means: what do you do if someone requests `/block/$BLOCKHASH.bin`, but with `Accept: application/json` header.",
          "created_at": "2025-05-24T13:18:33Z"
        },
        {
          "user": "yancyribbens",
          "body": ">  The format is already specified using the extension, which seems more convenient to me than needing an additional header to specify the content type,\n\nOh, if one can say `.bin` or `.json` in the request to specify the expected content format that's great.\n\nIn the PR https://github.com/bitcoin/bitcoin/pull/32540\n\n> We can significantly optimize it by adding a new REST endpoint, using a binary response format (returning a collection of spent txout lists, one per each block transaction)\n\nSo I was suggesting instead of adding a new endpoint, to add a way to specify content type instead, either via http header or via format if that works.  Maybe I missed the point of PR 32540 in that the new endpoint is doing more than just changing the response format.",
          "created_at": "2025-05-24T13:37:47Z"
        },
        {
          "user": "sipa",
          "body": "I suggest you read the [documentation](https://github.com/bitcoin/bitcoin/blob/master/doc/REST-interface.md) on the REST interface before commenting on it.\n\n#32540 adds a new REST endpoint, which provides information that no current endpoint provides. Like all REST endpoints, it provides this information in a number of formats, based on the extension of the filename used in the request.",
          "created_at": "2025-05-24T13:40:28Z"
        },
        {
          "user": "yancyribbens",
          "body": "> I suggest you read the [documentation](https://github.com/bitcoin/bitcoin/blob/master/doc/REST-interface.md) on the REST interface before commenting on it.\n\n> https://github.com/bitcoin/bitcoin/pull/32540 adds a new REST endpoint, which provides information that no current endpoint provides. Like all REST endpoints, it provides this information in a number of formats, based on the extension of the filename used in the request.\n\nI see that now.  My mistake.",
          "created_at": "2025-05-24T13:42:49Z"
        },
        {
          "user": "yancyribbens",
          "body": "@romanz sorry to lead you astray, I should have inspected your PR a bit closer.",
          "created_at": "2025-05-24T13:50:04Z"
        },
        {
          "user": "romanz",
          "body": "No problem :)",
          "created_at": "2025-05-24T15:31:03Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 12,
    "issues": 2
  }
}