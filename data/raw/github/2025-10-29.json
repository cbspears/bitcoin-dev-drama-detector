{
  "source": "github",
  "repository": "bitcoin/bitcoin",
  "fetched_at": "2026-01-15T20:26:52.454439+00:00",
  "date": "2025-10-29",
  "pull_requests": [
    {
      "number": 33740,
      "title": "RFC: bench: Add multi thread benchmarking",
      "body": "This adds a rough way to run specific benchmarks with different numbers of worker threads to see how these impact performance. This is useful for me in the batch validation context and for potential refactorings of checkqueue but I am not sure if this is useful in many other contexts so I am leaving this as a RFC draft for now to see if there is any interest in merging something like this.\r\n\r\nExample output:\r\n\r\n```\r\n$ build/bin/bench_bitcoin -filter=ConnectBlockAllSchnorr -min-time=1000 -scale-threads\r\nRunning benchmarks with worker threads from 1 to 15\r\n\r\n|            ns/block |             block/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|       43,118,187.50 |               23.19 |    0.1% |      0.99 | `ConnectBlockAllSchnorr_1_threads`\r\n|       29,015,444.33 |               34.46 |    0.2% |      1.10 | `ConnectBlockAllSchnorr_2_threads`\r\n|       22,241,437.50 |               44.96 |    0.1% |      1.09 | `ConnectBlockAllSchnorr_3_threads`\r\n|       17,893,361.00 |               55.89 |    0.3% |      1.09 | `ConnectBlockAllSchnorr_4_threads`\r\n|       15,105,819.50 |               66.20 |    0.2% |      1.09 | `ConnectBlockAllSchnorr_5_threads`\r\n|       13,145,510.38 |               76.07 |    0.2% |      1.08 | `ConnectBlockAllSchnorr_6_threads`\r\n|       11,646,614.62 |               85.86 |    0.2% |      1.06 | `ConnectBlockAllSchnorr_7_threads`\r\n|       10,476,425.89 |               95.45 |    0.2% |      1.07 | `ConnectBlockAllSchnorr_8_threads`\r\n|        9,547,125.00 |              104.74 |    0.2% |      1.08 | `ConnectBlockAllSchnorr_9_threads`\r\n|        9,574,246.27 |              104.45 |    0.6% |      1.08 | `ConnectBlockAllSchnorr_10_threads`\r\n|        9,557,633.40 |              104.63 |    1.1% |      1.08 | `ConnectBlockAllSchnorr_11_threads`\r\n|        9,495,175.00 |              105.32 |    0.8% |      1.08 | `ConnectBlockAllSchnorr_12_threads`\r\n|        9,297,012.50 |              107.56 |    0.3% |      1.07 | `ConnectBlockAllSchnorr_13_threads`\r\n|        9,775,795.45 |              102.29 |    0.7% |      1.11 | `ConnectBlockAllSchnorr_14_threads`\r\n|        9,776,140.18 |              102.29 |    0.9% |      1.06 | `ConnectBlockAllSchnorr_15_threads`\r\n```\r\n",
      "state": "open",
      "user": "fjahr",
      "created_at": "2025-10-29T23:36:13Z",
      "updated_at": "2026-01-14T23:13:30Z",
      "comments": 4,
      "url": "https://github.com/bitcoin/bitcoin/pull/33740",
      "labels": [
        "Needs rebase"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33740.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#34210](https://github.com/bitcoin/bitcoin/pull/34210) (bench: Remove -priority-level= option by maflcko)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-10-29T23:36:18Z"
        },
        {
          "user": "fjahr",
          "body": "I people could test the exact command as above it might be interesting to post the results here. ~~For me at least, 13 worker threads are consistently delivering a better result than 15 worker threads.~~ EDIT: After some time I started to see the best results with 14 and 15, so maybe this was nothing.",
          "created_at": "2025-10-29T23:44:49Z"
        },
        {
          "user": "fjahr",
          "body": "> Not sure whether the concept of script validation has to creep into the benchmarking parameters, maybe we could generalize it to `-thread-count` or `-par` or something.\r\n\r\nThanks, happy to change this and address the other comments. But aside from that do you think this is generally interesting enough to be considered merging? I was unsure and since I haven't worked much on benchmarking I would like to get some concept-ack-ish feedback from the benchmarking wg :)",
          "created_at": "2025-11-26T22:58:53Z"
        },
        {
          "user": "DrahtBot",
          "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\nüêô This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
          "created_at": "2026-01-14T23:13:30Z"
        }
      ]
    },
    {
      "number": 33738,
      "title": "log: avoid collecting `GetSerializeSize` data when compact block logging is disabled",
      "body": "### Context\r\n\r\nThe new accounting options introduced in https://github.com/bitcoin/bitcoin/pull/32582 can be quite heavy, and are not needed when debug logging is disabled.\r\n\r\n### Problem\r\n`PartiallyDownloadedBlock::FillBlock()` and `PeerManagerImpl::SendBlockTransactions()` accumulate transaction sizes for debug logging by calling `ComputeTotalSize()` in loops, which invokes expensive `GetSerializeSize()` serializations.\r\nThe block header hash is also only computed for the debug log.\r\n\r\n### Fixes\r\n\r\nGuard the size and hash calculations with `LogAcceptCategory()` checks so the serialization and hashing work only occurs when compact block debug logging is enabled.\r\n\r\nAlso modernized the surrounding code a bit since the change is quite trivial.\r\n\r\n### Reproducer\r\n\r\nYou can test the change by starting an up-to-date `bitcoind` node with `-debug=cmpctblock` and observing compact block log lines such as:\r\n\r\n> [cmpctblock] Successfully reconstructed block 00000000000000000001061eaa6c0fe79258e7f79606e67ac495765cb121a520 with 1 txn prefilled, 3122 txn from mempool (incl at least 3 from extra pool) and 641 txn (352126 bytes) requested\r\n\r\n<details>\r\n<summary>Test patch</summary>\r\n\r\n```patch\r\ndiff --git a/src/blockencodings.cpp b/src/blockencodings.cpp\r\nindex 58620c93cc..f16eb38fa5 100644\r\n--- a/src/blockencodings.cpp\r\n+++ b/src/blockencodings.cpp\r\n@@ -186,6 +186,7 @@ bool PartiallyDownloadedBlock::IsTxAvailable(size_t index) const\r\n\r\n ReadStatus PartiallyDownloadedBlock::FillBlock(CBlock& block, const std::vector<CTransactionRef>& vtx_missing, bool segwit_active)\r\n {\r\n+    LogInfo(\"PartiallyDownloadedBlock::FillBlock called\");\r\n     if (header.IsNull()) return READ_STATUS_INVALID;\r\n\r\n     block = header;\r\n@@ -218,6 +219,7 @@ ReadStatus PartiallyDownloadedBlock::FillBlock(CBlock& block, const std::vector<\r\n     }\r\n\r\n     if (LogAcceptCategory(BCLog::CMPCTBLOCK, BCLog::Level::Debug)) {\r\n+        LogInfo(\"debug log enabled\");\r\n         const uint256 hash{block.GetHash()}; // avoid cleared header\r\n         uint32_t tx_missing_size{0};\r\n         for (const auto& tx : vtx_missing) tx_missing_size += tx->ComputeTotalSize(); // avoid cleared txn_available\r\ndiff --git a/src/net_processing.cpp b/src/net_processing.cpp\r\nindex 5600c8d389..c081825f77 100644\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -2470,6 +2470,7 @@ uint32_t PeerManagerImpl::GetFetchFlags(const Peer& peer) const\r\n\r\n void PeerManagerImpl::SendBlockTransactions(CNode& pfrom, Peer& peer, const CBlock& block, const BlockTransactionsRequest& req)\r\n {\r\n+    LogInfo(\"PeerManagerImpl::SendBlockTransactions called\");\r\n     BlockTransactions resp(req);\r\n     for (size_t i = 0; i < req.indexes.size(); i++) {\r\n         if (req.indexes[i] >= block.vtx.size()) {\r\n@@ -2480,6 +2481,7 @@ void PeerManagerImpl::SendBlockTransactions(CNode& pfrom, Peer& peer, const CBlo\r\n     }\r\n\r\n     if (LogAcceptCategory(BCLog::CMPCTBLOCK, BCLog::Level::Debug)) {\r\n+        LogInfo(\"debug log enabled\");\r\n         uint32_t tx_requested_size{0};\r\n         for (const auto i : req.indexes) tx_requested_size += block.vtx[i]->ComputeTotalSize();\r\n         LogDebug(BCLog::CMPCTBLOCK, \"Peer %d sent us a GETBLOCKTXN for block %s, sending a BLOCKTXN with %u txns. (%u bytes)\\n\", pfrom.GetId(), block.GetHash().ToString(), resp.txn.size(), tx_requested_size);\r\n```\r\n\r\n</details>\r\n",
      "state": "open",
      "user": "l0rinc",
      "created_at": "2025-10-29T22:57:43Z",
      "updated_at": "2026-01-14T22:38:59Z",
      "comments": 8,
      "url": "https://github.com/bitcoin/bitcoin/pull/33738",
      "labels": [
        "Utils/log/libs"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33738.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [sedited](https://github.com/bitcoin/bitcoin/pull/33738#issuecomment-3466336991), [0xB10C](https://github.com/bitcoin/bitcoin/pull/33738#issuecomment-3473161056) |\n| Stale ACK | [danielabrozzoni](https://github.com/bitcoin/bitcoin/pull/33738#pullrequestreview-3437924068), [davidgumberg](https://github.com/bitcoin/bitcoin/pull/33738#issuecomment-3560241264) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32606](https://github.com/bitcoin/bitcoin/pull/32606) (p2p: Drop unsolicited CMPCTBLOCK from non-HB peer by davidgumberg)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-10-29T22:57:47Z"
        },
        {
          "user": "davidgumberg",
          "body": "Thanks for catching this, the PR seems correct to me, why is it in draft?",
          "created_at": "2025-10-30T01:24:22Z"
        },
        {
          "user": "sedited",
          "body": "Concept ACK",
          "created_at": "2025-10-30T06:43:00Z"
        },
        {
          "user": "davidgumberg",
          "body": "crACK https://github.com/bitcoin/bitcoin/pull/33738/commits/17856343f80fcfe307121679621ade6d1e0ec32b",
          "created_at": "2025-10-31T00:29:06Z"
        },
        {
          "user": "0xB10C",
          "body": "Concept ACK",
          "created_at": "2025-10-31T13:45:20Z"
        },
        {
          "user": "davidgumberg",
          "body": "crACK 10e0e96e703a40b298b8\r\n\r\nLightly tested running on mainnet, logs for receiving look good:\r\n\r\n```\r\n2025-11-20T21:56:39.778340Z [cmpctblock] Successfully reconstructed block 000000000000000000004152f92a1ec0a2f2e4356264001b11361f35247f641d with 1 txn prefilled, 3940 txn from mempool (incl at least 6 from extra pool) and 141 txn (64021 bytes) requested\r\n```\r\n\r\nHaven't received a `GETBLOCKTXN` request yet.",
          "created_at": "2025-11-20T22:02:23Z"
        },
        {
          "user": "l0rinc",
          "body": "> However, when I see CTransaction I often think it should be renamed ImmutableTransaction (to counter CMutableTransaction).\r\n\r\nI didn't understand at first how that's related, but slept on it and now I do :)\r\nI don't mind experimenting with that in a separate PR (thanks for the detailed reproducers and benchmarks), had a similar-looking draft in https://github.com/l0rinc/bitcoin/pull/21 (caching the hashes lazily - caching the size would fit here better). \r\n\r\nIf we want to cache size (or compute it alongside hashing), that should be evaluated based on broader call sites and overall construction cost, and done in a separate PR with focused benchmarks and review. I will investigate that in a separate PR.\r\n\r\n> Might be a shame to change the name to ComputeTotalSize if we later decide to return a cached size value.\r\n\r\nI would consider that a feature: we should rename it back when we're not computing it anymore as it's confusing currently. \r\nThis PR is intentionally narrow: it avoids debug-only serialization/hashing work when cmpctblock debug logging, I would like to avoid doing unrelated refactors here. Alternatively I can revert that commit, but it was explicitly requested.\r\n\r\n-----\r\n\r\nRebased in separate empty push and and pushed 2 suggestions in https://github.com/bitcoin/bitcoin/compare/4f1b29d32dea5fbcefe92df6dd0540807cfac1b2..2d3b557f1d414c509b992caa8b96f8ef3bb2aa46",
          "created_at": "2025-12-22T11:06:43Z"
        },
        {
          "user": "l0rinc",
          "body": "close/open dance to retrigger CI - likely caused by [GitHub outage](https://www.githubstatus.com/history) ",
          "created_at": "2025-12-23T08:03:03Z"
        }
      ]
    },
    {
      "number": 33732,
      "title": "ci: Call docker exec from Python script to fix word splitting",
      "body": "The remaining `ci/test/02_run_container.sh` is fine, but has a bunch of shellcheck SC2086 word splitting violations.\r\n\r\nThis is fine currently, because the only place that needed them had additional escaping, and all other commands happened to split fine on spaces.\r\n\r\nHowever, this may change in the future. So fix it now, by rewriting it in Python, which is recommended in the dev notes.",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-10-29T12:13:02Z",
      "updated_at": "2025-12-19T16:11:09Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/pull/33732",
      "labels": [
        "Tests"
      ],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33732.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [frankomosh](https://github.com/bitcoin/bitcoin/pull/33732#issuecomment-3636517692), [m3dwards](https://github.com/bitcoin/bitcoin/pull/33732#pullrequestreview-3584102744) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#33362](https://github.com/bitcoin/bitcoin/pull/33362) (Run feature_bind_port_(discover|externalip).py in CI by vasild)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-10-29T12:13:07Z"
        },
        {
          "user": "frankomosh",
          "body": "Code Review ACK [fa33605](https://github.com/bitcoin/bitcoin/pull/33732/commits/fa336053aada79d13cd771ce025857256814465e)",
          "created_at": "2025-12-10T10:56:53Z"
        }
      ]
    },
    {
      "number": 33730,
      "title": "chainparams: remove  *petertodd.net",
      "body": "**Rationale**\r\n\r\nThese emails were leaked on bitcointalk and Peter Todd acknowledged that they are not fake. His communication with someone about bitcoin development who claims to work for government agencies potentially violates the DNS seed policy.\r\n\r\n> A DNS seed operating organization or person is expected to follow good host security practices, maintain control of applicable infrastructure, and not sell or transfer control of the DNS seed. Any hosting services contracted by the operator are equally expected to uphold these expectations.\r\n\r\nhttps://agorism.dev/petertodd-emails.txt\r\n",
      "state": "closed",
      "user": "ghost",
      "created_at": "2025-10-29T10:41:21Z",
      "updated_at": "2025-10-29T14:24:39Z",
      "comments": 6,
      "url": "https://github.com/bitcoin/bitcoin/pull/33730",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33730.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept NACK | [l0rinc](https://github.com/bitcoin/bitcoin/pull/33730#issuecomment-3460872871) |\n| Concept ACK | [jaonoctus](https://github.com/bitcoin/bitcoin/pull/33730#pullrequestreview-3393535153) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-10-29T10:41:27Z"
        },
        {
          "user": "l0rinc",
          "body": "NACK, seems like trolling, please provide proper motivation ",
          "created_at": "2025-10-29T10:46:39Z"
        },
        {
          "user": "pinheadmz",
          "body": "This PR description is unacceptable, please expand it with technical details or references to specific, documented project policy.",
          "created_at": "2025-10-29T10:47:13Z"
        },
        {
          "user": "pinheadmz",
          "body": "I'm closing this PR since it the author has not justified it with any technical explanation and as it is written it is just a personal attack, which violates moderation policy.",
          "created_at": "2025-10-29T14:03:54Z"
        },
        {
          "user": "ghost",
          "body": "> This PR description is unacceptable, please expand it with technical details or references to specific, documented project policy.\r\n\r\nI have added the details.",
          "created_at": "2025-10-29T14:14:50Z"
        },
        {
          "user": "glozow",
          "body": "Historically, when a DNS seed was not operating properly, an issue was opened and we waited for the operator to respond. Potential actions we can take: (0) address the problems with the DNS seed, (1) decide there is no problem, or (2) remove the DNS seed. I don't think it's appropriate to just jump to removal straight away.\r\n\r\nI suggest you open an issue (see #29911 or #33734 for examples) and wait for a response from the operator.",
          "created_at": "2025-10-29T14:24:39Z"
        }
      ]
    },
    {
      "number": 33729,
      "title": ".",
      "body": "<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
      "state": "closed",
      "user": "Ashok8601",
      "created_at": "2025-10-29T06:34:39Z",
      "updated_at": "2025-10-29T09:05:55Z",
      "comments": 1,
      "url": "https://github.com/bitcoin/bitcoin/pull/33729",
      "labels": [],
      "comment_list": [
        {
          "user": "DrahtBot",
          "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33729.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
          "created_at": "2025-10-29T06:34:43Z"
        }
      ]
    }
  ],
  "issues": [
    {
      "number": 33739,
      "title": ".",
      "body": ".",
      "state": "closed",
      "user": "ukml",
      "created_at": "2025-10-29T23:03:48Z",
      "updated_at": "2025-10-30T09:06:06Z",
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/33739",
      "labels": []
    },
    {
      "number": 33737,
      "title": "Limit \"Bulk Dust\" with a default filter or consensus..",
      "body": "I‚Äôm exploring a potential default filter or consensus-level rule (since a large number of people believe that default filters don't work) to discourage UTXO-bloat patterns without touching Script, witness data, or the block size limit.\n\nThe idea is to target ‚Äúbulk dust‚Äù transactions ‚Äî those that create large numbers of extremely small outputs ‚Äî which are the main cause of long-term UTXO set growth.\n\nThese types of \"bulk dust\" transactions have been the No. 1 reason cited for wanting to expand the default OP_RETURN limit... and removing that limit obviously influenced BIP 444.  So it appears to me that there is overwhelming majority support for limiting these types of \"bulk dust\" transactions, as they do present a legitimate concern for node runners.\n\n**Concept**\n\nFlag a transaction as ‚Äúbulk dust‚Äù if:\n- It has >=100 outputs each below a dynamically defined TinyTx threshold, and\n- Those tiny outputs make up >=60% of all outputs in the transaction.\n\nWhen flagged, it would be considered nonstandard (relay policy) or invalid (if soft-forked into consensus).\n\n**TinyTx threshold (dynamic halving schedule)**\n\nI originally considered a constant definition of what was a \"tiny\" Tx to be 1,000 sats... but some might still just use 1,001 sats, right?  Plus there very likely will be a time where there is  a valid use-case of >100 outputs under 1,000 sats.\n\nRather than fixing the ‚Äútiny‚Äù threshold to a constant like 1,000 sats, the rule defines it as a decreasing function of block height, starting high and gradually tightening over time.\n\n- Starts at 4096 sats when activated (target ~2028).\n- Halves every 210,000 blocks (~4 years).\n- Never falls below 1 sat (hard floor).\n\nYear ---- Block Height -- TinyTx Threshold\n2028 --- ~activation ---- 4096 sats\n2032 --- ~1,260,000 ---- 2048 sats\n2036 --- ~1,470,000 ---- 1024 sats\n2040 --- ~1,680,000 ---- 512 sats\n‚Ä¶ -- every 210,000 blocks -- ‚Ä¶ until 1 sat floor\n\nThis gradual halving ensures the definition of \"tiny\" stays relevant as Bitcoin‚Äôs value rises.\nFor example, if 1 sat = $1 someday, having 100 outputs worth <1,000 sats each would no longer represent spam ‚Äî but rather normal payments.\nBy then, the TinyTx limit would already have adjusted down automatically.\n\n**Patterns this would limit**\n\n- Fake pubkeys or scripts used to embed data via many UTXOs\n- Bitcoin STAMPS / UTXO-art spreading payloads across thousands of dust outputs\n- BRC-20 batch mints with 100s of \"tiny\" sat fan-outs\n- Some Ordinal or state inscription schemes that distribute data across many tiny outputs\n- Dust bombing (UTXO tracking or chain spam)\n- Mass micro-airdrops below the \"tiny\" sat range\n\nThese use cases rely on cheap, numerous outputs ‚Äî making them several times more costly under this rule.\n\n**Non-goals / unaffected**\n\n- Normal user transactions, LN channel opens, and multisig spends\n- Batched exchange payouts (they typically have > 40% large-value outputs)\n- Single/few-output inscriptions using witness data (not affected)\n- Any legitimate pattern where most outputs are above the threshold\n\n**Why a ratio and a count?**\n\nRequiring both (tiny_count >= 100) and (tiny_ratio >= 60%) helps avoid false positives, such as legitimate custodial payouts or consolidation transactions with mixed values.\nIt specifically filters transactions that are mostly dust, rather than merely containing some.\n\n**Inquiry**\n\n- Are there credible, non-spam use cases that truly require >=100 sub-4k-sat outputs (or equivalent at later eras) and a >=60% tiny ratio?\n- Could this affect fee market behavior or any privacy tools in unintended ways?\n- Any concern with the 100 tiny_count limit or 60% tiny_ratio?\n- Any other unintended consequences?\n- Any objections in general??  What are they?\n\n**Intent**\n\nThis proposal doesn‚Äôt censor any monetary transaction or prevent inscriptions; it simply prices storage according to resource cost.\nIt keeps the chain ‚Äúlight and nimble‚Äù for everyday payments while allowing future flexibility ‚Äî because the TinyTx definition decreases automatically in line with halvings and Bitcoin‚Äôs long-term value growth.\n\n**CODE SKETCHES**\n(with minimal syntax highlighting here:  https://pastebin.com/9qdQCH83)\n\n**RELAY POLICY FILTER sketch ‚Äî**\n```\n// Place in src/policy/policy.cpp, and call from within IsStandardTx() before returning:\n//     if (IsBulkDust(tx, reason))\n//         return false;   // reject as nonstandard\n// ==========================================================================================================\n\nbool IsBulkDust(const CTransaction& tx, std::string& reason)\n{\n    static constexpr int     MAX_TINY_OUTPUTS        = 100;     // >=100 tiny outputs triggers ratio check\n    static constexpr double  TINY_RATIO_THRESHOLD    = 0.6;     // >=60% of all outputs tiny ‚Üí reject\n    static constexpr CAmount BASE_TINY_THRESHOLD     = 4096;    // starting tiny threshold (sats)\n    static constexpr int64_t FIRST_TINY_HALVING_H    = 1260000; // first halving of tiny threshold\n    static constexpr int64_t HALVING_INTERVAL        = 210000;  // blocks per subsequent halving\n    static constexpr CAmount MIN_TINY_FLOOR          = 1;       // never below 1 sat\n\n    const int total = tx.vout.size();\n    if (total == 0) return false;\n\n    int currentHeight = chainActive.Tip() ? chainActive.Tip()->nHeight : 0;\n\n    // Era index for TinyTx threshold, anchored at FIRST_TINY_HALVING_H (not subsidy eras)\n    int era = 0;\n    if (currentHeight >= FIRST_TINY_HALVING_H) {\n        era = 1 + static_cast<int>((currentHeight - FIRST_TINY_HALVING_H) / HALVING_INTERVAL);\n    }\n\n    CAmount tinyThresh = BASE_TINY_THRESHOLD >> era;      // halve per era\n    if (tinyThresh < MIN_TINY_FLOOR) tinyThresh = MIN_TINY_FLOOR;\n\n    int tiny = 0;\n    for (const auto& out : tx.vout) {\n        if (out.nValue < tinyThresh) ++tiny;\n    }\n\n    if (tiny >= MAX_TINY_OUTPUTS && (static_cast<double>(tiny) / total) >= TINY_RATIO_THRESHOLD) {\n        reason = strprintf(\"too-many-tiny-outputs(%d of %d, %.2f%%, tiny<%d)\",\n                           tiny, total, 100.0 * tiny / total, tinyThresh);\n        return true; // flag as bulk dust (nonstandard)\n    }\n    return false;\n}\n```\n\n**CONSENSUS (soft-fork, hybrid activation) sketch ‚Äî**\n```\n// Helpers in src/consensus/tx_check.cpp; activation/enforcement in src/validation.cpp\n// Also define deployment in: src/consensus/params.h, src/chainparams.cpp, src/versionbits.*\n// ==========================================================================================================\n\n// -----------------------------------------------------------------------\n// --- In src/consensus/tx_check.cpp (helper only; no params needed) ---\n// -----------------------------------------------------------------------\n\nstatic constexpr CAmount BASE_TINY_THRESHOLD     = 4096;\nstatic constexpr int64_t FIRST_TINY_HALVING_H    = 1260000;\nstatic constexpr int64_t HALVING_INTERVAL        = 210000;\nstatic constexpr int     MAX_TINY_OUTPUTS        = 100;\nstatic constexpr double  TINY_RATIO_THRESHOLD    = 0.6;\nstatic constexpr CAmount MIN_TINY_FLOOR          = 1;\n\nbool IsBulkDust(const CTransaction& tx, int currentHeight) // expose via tx_check.h if needed\n{\n    const int total = tx.vout.size();\n    if (total == 0) return false;\n\n    int era = 0;\n    if (currentHeight >= FIRST_TINY_HALVING_H) {\n        era = 1 + static_cast<int>((currentHeight - FIRST_TINY_HALVING_H) / HALVING_INTERVAL);\n    }\n\n    CAmount tinyThresh = BASE_TINY_THRESHOLD >> era;\n    if (tinyThresh < MIN_TINY_FLOOR) tinyThresh = MIN_TINY_FLOOR;\n\n    int tiny = 0;\n    for (const auto& out : tx.vout) {\n        if (out.nValue < tinyThresh) ++tiny;\n    }\n\n    if (tiny >= MAX_TINY_OUTPUTS && (static_cast<double>(tiny) / total) >= TINY_RATIO_THRESHOLD)\n        return true;\n\n    return false;\n}\n\n\n// -----------------------------------------------------------------------\n// --- In src/validation.cpp (enforcement with hybrid activation) ---\n// -----------------------------------------------------------------------\n\n#include <consensus/tx_check.h>\n#include <versionbits.h>\n\nconst Consensus::Params& params = chainparams.GetConsensus();\nint currentHeight = chainActive.Tip() ? chainActive.Tip()->nHeight : 0;\n\nconst bool bulk_dust_active =\n    DeploymentActiveAtTip(params, Consensus::DEPLOYMENT_BULK_DUST_LIMIT) ||\n    (currentHeight >= params.BulkDustActivationHeight);\n\nif (bulk_dust_active) {\n    if (IsBulkDust(tx, currentHeight)) {\n        return state.Invalid(TxValidationResult::TX_CONSENSUS, \"too-many-tiny-outputs\");\n    }\n}\n\n\n// -----------------------------------------------------------------------\n// --- In src/consensus/params.h ---\n// -----------------------------------------------------------------------\n\nenum DeploymentPos {\n    // ...\n    DEPLOYMENT_BULK_DUST_LIMIT,\n    MAX_VERSION_BITS_DEPLOYMENTS\n};\n\nstruct Params {\n    // ...\n    int BulkDustActivationHeight; // height flag-day fallback\n};\n\n\n// -----------------------------------------------------------------------\n// --- In src/chainparams.cpp (per-network values; examples only) ---\n// -----------------------------------------------------------------------\n\nconsensus.vDeployments[Consensus::DEPLOYMENT_BULK_DUST_LIMIT].bit = 12;\nconsensus.vDeployments[Consensus::DEPLOYMENT_BULK_DUST_LIMIT].nStartTime = 1767225600;  // 2026-01-01 UTC\nconsensus.vDeployments[Consensus::DEPLOYMENT_BULK_DUST_LIMIT].nTimeout   = 1838160000;  // 2028-04-01 UTC\nconsensus.vDeployments[Consensus::DEPLOYMENT_BULK_DUST_LIMIT].min_activation_height = 969696;\n\nconsensus.BulkDustActivationHeight = 1021021; // flag-day fallback\n```",
      "state": "closed",
      "user": "DoctorBuzz1",
      "created_at": "2025-10-29T20:00:40Z",
      "updated_at": "2025-10-29T23:53:59Z",
      "comments": 2,
      "url": "https://github.com/bitcoin/bitcoin/issues/33737",
      "labels": [],
      "comment_list": [
        {
          "user": "Frenchanfry",
          "body": "I love this idea to keep spammers away; it also is fundamental when bitcoins value isn't compared relatively to the $. to keep the network clean and efficient.\n\n1 satoshi = 1 satoshi.",
          "created_at": "2025-10-29T23:51:41Z"
        },
        {
          "user": "pinheadmz",
          "body": "This should be posted on the [bitcoin-dev mailing list](https://groups.google.com/g/bitcoindev), the [Delving Bitcoin forum](https://delvingbitcoin.org/) or some other platform where broad, protocol-level concepts are discussed. Conceptual questions and most usage questions can be posted on [Stack Exchange](https://bitcoin.stackexchange.com/). The Bitcoin Core issue tracker is reserved for discussion about this specific software project only, its implementation and usage.",
          "created_at": "2025-10-29T23:53:59Z"
        }
      ]
    },
    {
      "number": 33736,
      "title": "Remove *petertodd.net DNS seed for testnet and mainnet",
      "body": "Creating an issue based on @glozow's suggestion in https://github.com/bitcoin/bitcoin/pull/33730#issuecomment-3461843402\n\nSome [emails](https://agorism.dev/petertodd-emails.txt) were leaked on bitcointalk and Peter Todd acknowledged that they are not fake. His communication with John Dillon about bitcoin development and privacy who claims to work for government agencies potentially violates the DNS seed policy.\n\n> A DNS seed operating organization or person is expected to follow good host security practices, **maintain control of applicable infrastructure**, and **not sell or transfer control of the DNS seed**. Any hosting services contracted by the operator are equally expected to uphold these expectations.\n\nThe DNS seed should be removed from bitcoin core and replaced with other seed run by a regular contributor.\n\n",
      "state": "closed",
      "user": "ghost",
      "created_at": "2025-10-29T18:08:27Z",
      "updated_at": "2025-10-30T16:55:10Z",
      "comments": 5,
      "url": "https://github.com/bitcoin/bitcoin/issues/33736",
      "labels": [],
      "comment_list": [
        {
          "user": "achow101",
          "body": "Can you cite where in those emails you believe this part of the policy is being violated? I searched for \"dns\" and \"seed\" and got no results. I searched for \"server\" and don't see anything that seems to discuss handing over any DNS seed infrastructure to someone else.",
          "created_at": "2025-10-29T18:17:21Z"
        },
        {
          "user": "jlopp",
          "body": "15,000 words from 12+ year old emails?\n\nFurther specification is needed to explain how this has anything to do with Peter's control of his DNS seed. All I see are discussions of how different aspects of Bitcoin work.",
          "created_at": "2025-10-29T21:38:23Z"
        },
        {
          "user": "ghost",
          "body": "<img width=\"948\" height=\"289\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/080212eb-ada9-496e-9c85-d87a9306e2e5\" />",
          "created_at": "2025-10-30T16:34:13Z"
        },
        {
          "user": "dergoegge",
          "body": "> floppy profile pic in screenshot\n\n<img width=\"272\" height=\"186\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/88349a98-b1b5-432d-a2af-9a21cb5372ce\" />",
          "created_at": "2025-10-30T16:37:22Z"
        },
        {
          "user": "ghost",
          "body": "> > floppy profile pic in screenshot\n> \n> <img alt=\"Image\" width=\"272\" height=\"186\" src=\"https://private-user-images.githubusercontent.com/8077169/507760105-88349a98-b1b5-432d-a2af-9a21cb5372ce.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NjE4NDI1NDQsIm5iZiI6MTc2MTg0MjI0NCwicGF0aCI6Ii84MDc3MTY5LzUwNzc2MDEwNS04ODM0OWE5OC1iMWI1LTQzMmQtYTJhZi05YTIxY2I1MzcyY2UucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MTAzMCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTEwMzBUMTYzNzI0WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MjBkZjFmZjAwNWU4OGEwODBlNDc1YTZiYTAxMjBmMTUyZWRlNTc4YjA2ZTY5NmYwMWFhODAyNGNlMzBkODRmMiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.GigP3PC0AKO-k2Ozp8hVZW5h_iPw3U6pd-oDFmDyOEg\">\n\n",
          "created_at": "2025-10-30T16:39:50Z"
        }
      ]
    },
    {
      "number": 33735,
      "title": "ci: Lint task caching does not work?",
      "body": "\n _Originally posted by @maflcko in [#33640](https://github.com/bitcoin/bitcoin/issues/33640#issuecomment-3458556346)_\n\nI presume the same issue exists for the lint task. Though, the caching there does not seem to work at all. So it could make sense to make the caching work there, and then also add a retry loop there.\n \n \nOtherwise, there could be Ubuntu APT timeouts like https://github.com/bitcoin/bitcoin/actions/runs/18861389218/job/53820273763?pr=33247#step:4:1053 \n",
      "state": "closed",
      "user": "maflcko",
      "created_at": "2025-10-29T15:38:44Z",
      "updated_at": "2025-11-04T11:37:31Z",
      "comments": 0,
      "url": "https://github.com/bitcoin/bitcoin/issues/33735",
      "labels": [
        "Tests"
      ]
    },
    {
      "number": 33734,
      "title": "dnsseed.bitcoin.dashjr-list-of-p2p-nodes.us appears to be violating DNS seed policy",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nBitcoin Core has a [DNS seed policy](https://github.com/bitcoin/bitcoin/blob/master/doc/dnsseed-policy.md).\n\nThere are concerns about @luke-jr's security practices and control over the server: https://github.com/bitcoin/bitcoin/pull/33723#issuecomment-3457730865\n\n@luke-jr was hacked and posted on his [website](https://luke.dashjr.org/) that his server has been compromised. As of this morning, the warning is still there:\n\n<img width=\"1119\" height=\"308\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/dedb2a0a-b6d9-40dc-ac6e-d07f41094a7a\" />\n\nWe also learned of an investigation following the hack and are unsure whether Luke has shared access to the server with investigators. It would be helpful if @luke-jr can clarify this point.\n\nThere are also concerns that @luke-jr is purposefully filtering nodes based on user agent, attempting to stop users from running or connecting to recent versions of Bitcoin Core.\nhttps://github.com/bitcoin/bitcoin/pull/33723#issuecomment-3458071231\nhttps://github.com/bitcoin/bitcoin/pull/33723#issuecomment-3458091139\nhttps://github.com/bitcoin/bitcoin/pull/33723#issuecomment-3457601403\nhttps://github.com/bitcoin/bitcoin/pull/33723#pullrequestreview-3390131426\n\n### Expected behaviour\n\nThe current behavior appears to violate the [DNS seed policy](https://github.com/bitcoin/bitcoin/blob/master/doc/dnsseed-policy.md).\n  \n> 0. A DNS seed operating organization or person is expected to follow good host security practices, maintain control of applicable infrastructure, and not sell or transfer control of the DNS seed. Any hosting services contracted by the operator are equally expected to uphold these expectations.\n>\n> 1. The DNS seed results must consist exclusively of fairly selected and functioning Bitcoin nodes from the public network to the best of the operator's understanding and capability.\n\n\n### Solutions\n\nTypically when a DNS seed is not operating properly, an issue is opened and we wait for the operator to respond (for example, see #29911)\n\nIdeally, the problems are addressed. If not, the DNS seed can be removed (see #33723).\n\nAlternatively, we may determine that there is no violation. Discuss here.\n",
      "state": "closed",
      "user": "glozow",
      "created_at": "2025-10-29T14:10:02Z",
      "updated_at": "2025-11-12T14:11:08Z",
      "comments": 23,
      "url": "https://github.com/bitcoin/bitcoin/issues/33734",
      "labels": [
        "P2P"
      ]
    },
    {
      "number": 33733,
      "title": "Can I compile on OSX Tahoe?",
      "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nI recently upgraded my OS to Mac OSX Tahoe 26.0.1 (25A362)\n\nStep 1: Success\n\n```\ngit clone ssh://github.com/bitcoin/bitcoin.git\n```\n\nStep 2: Success\n\n```\ncmake -B build -DENABLE_IPC=OFF -DBUILD_GUI=OFF -DWITH_QRENCODE=OFF\n```\n\nStep 3: Fails\n\n```\ncmake --build build\n```\n\nThe default clang was from homebrew which also failed but then I switched to XCode clang and still fails :joy:\n\n### Expected behaviour\n\nGet a compiled bitcoind ‚ù§Ô∏è \n\n### Steps to reproduce\n\nStep 1: Success\n\n```\ngit clone ssh://github.com/bitcoin/bitcoin.git\n```\n\nStep 2: Success\n\n```\ncmake -B build -DENABLE_IPC=OFF -DBUILD_GUI=OFF -DWITH_QRENCODE=OFF\n```\n\nStep 3: Fails\n\n```\ncmake --build build\n```\n\n### Relevant log output\n\nHit the length limit so here's the URL https://gist.github.com/umrashrf/5302d7db0fe3e613d4ca94861eab452b\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nzsh: command not found: bitcoind\n\n### Operating system and version\n\nMaxOS Tahoe 26.0.1 (25A362)\n\n### Machine specifications\n\nClang Version\n\n```\n% clang --version\nApple clang version 17.0.0 (clang-1700.3.19.1)\nTarget: arm64-apple-darwin25.0.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n```\n\nHomebrew Dependencies\n\n```\n% brew info cmake boost pkgconf libevent capnp\n==> cmake: stable 4.1.2 (bottled), HEAD\nCross-platform make\nhttps://www.cmake.org/\nInstalled\n/opt/homebrew/Cellar/cmake/4.1.2 (3,913 files, 59.0MB) *\n  Poured from bottle using the formulae.brew.sh API on 2025-10-25 at 12:17:51\nFrom: https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/c/cmake.rb\nLicense: BSD-3-Clause\n==> Options\n--HEAD\n\tInstall HEAD version\n==> Caveats\nTo install the CMake documentation, run:\n  brew install cmake-docs\n==> Analytics\ninstall: 142,737 (30 days), 415,117 (90 days), 1,567,236 (365 days)\ninstall-on-request: 106,081 (30 days), 317,265 (90 days), 1,206,009 (365 days)\nbuild-error: 2,193 (30 days)\n\n==> boost: stable 1.89.0 (bottled), HEAD\nCollection of portable C++ source libraries\nhttps://www.boost.org/\nInstalled\n/opt/homebrew/Cellar/boost/1.89.0 (16,214 files, 348.0MB) *\n  Poured from bottle using the formulae.brew.sh API on 2025-10-25 at 12:17:55\nFrom: https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/b/boost.rb\nLicense: BSL-1.0\n==> Dependencies\nRequired: icu4c@77, xz, zstd\n==> Options\n--HEAD\n\tInstall HEAD version\n==> Analytics\ninstall: 31,894 (30 days), 108,486 (90 days), 586,596 (365 days)\ninstall-on-request: 11,761 (30 days), 42,580 (90 days), 254,592 (365 days)\nbuild-error: 60 (30 days)\n\n==> pkgconf: stable 2.5.1 (bottled), HEAD\nPackage compiler and linker metadata toolkit\nhttps://github.com/pkgconf/pkgconf\nInstalled\n/opt/homebrew/Cellar/pkgconf/2.5.1 (28 files, 521.5KB) *\n  Poured from bottle using the formulae.brew.sh API on 2025-07-12 at 17:51:14\nFrom: https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/p/pkgconf.rb\nLicense: ISC\n==> Options\n--HEAD\n\tInstall HEAD version\n==> Analytics\ninstall: 193,222 (30 days), 489,560 (90 days), 1,999,656 (365 days)\ninstall-on-request: 104,564 (30 days), 244,676 (90 days), 836,900 (365 days)\nbuild-error: 212 (30 days)\n\n==> libevent: stable 2.1.12 (bottled)\nAsynchronous event library\nhttps://libevent.org/\nInstalled\n/opt/homebrew/Cellar/libevent/2.1.12_1 (57 files, 2.2MB) *\n  Poured from bottle using the formulae.brew.sh API on 2024-05-11 at 19:13:14\nFrom: https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/lib/libevent.rb\nLicense: BSD-3-Clause\n==> Dependencies\nBuild: autoconf, automake, libtool, pkgconf\nRequired: openssl@3\n==> Analytics\ninstall: 58,116 (30 days), 185,092 (90 days), 671,699 (365 days)\ninstall-on-request: 394 (30 days), 1,302 (90 days), 7,444 (365 days)\nbuild-error: 0 (30 days)\n\n==> capnp: stable 1.2.0 (bottled), HEAD\nData interchange format and capability-based RPC system\nhttps://capnproto.org/\nInstalled\n/opt/homebrew/Cellar/capnp/1.2.0 (145 files, 16MB) *\n  Poured from bottle using the formulae.brew.sh API on 2025-10-25 at 12:18:05\nFrom: https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/c/capnp.rb\nLicense: MIT\n==> Dependencies\nBuild: cmake\n==> Options\n--HEAD\n\tInstall HEAD version\n==> Analytics\ninstall: 1,585 (30 days), 4,577 (90 days), 18,064 (365 days)\ninstall-on-request: 1,381 (30 days), 4,119 (90 days), 16,719 (365 days)\nbuild-error: 1 (30 days)\n```",
      "state": "closed",
      "user": "umrashrf",
      "created_at": "2025-10-29T13:50:51Z",
      "updated_at": "2025-11-01T05:39:27Z",
      "comments": 13,
      "url": "https://github.com/bitcoin/bitcoin/issues/33733",
      "labels": [
        "macOS",
        "Build system",
        "Questions and Help"
      ],
      "comment_list": [
        {
          "user": "maflcko",
          "body": "What is the configure summary, before you start to compile? (The output of `cmake -B build -DENABLE_IPC=OFF -DBUILD_GUI=OFF -DWITH_QRENCODE=OFF`)\n\nWhat is your XCode version?\n\nYou are certainly not using the brew installed boost lib.\n\nWhat other boost libs are on your system?",
          "created_at": "2025-10-29T15:00:36Z"
        },
        {
          "user": "umrashrf",
          "body": "@maflcko ran configure again and here's the output https://gist.github.com/umrashrf/6a63476cce762e00a4f45603837c5bda\n\nI just opened XCode and it asked me to install it. Still fails to build after installation.\n\nNew logs: https://gist.github.com/umrashrf/0714372957165e0264c8854d0060f660\n\nXCode version: 26.0.1 (17A400)",
          "created_at": "2025-10-29T16:29:38Z"
        },
        {
          "user": "umrashrf",
          "body": "Boost libs https://gist.github.com/umrashrf/b6c49a51c6607a8f2760e756570ad86e",
          "created_at": "2025-10-29T16:45:01Z"
        },
        {
          "user": "hebasto",
          "body": "@umrashrf \n\nCould you please post the output of the following command:\n```\nrm -rf build && cmake -B build -DENABLE_IPC=OFF -DBUILD_GUI=OFF -DWITH_QRENCODE=OFF -LA 2>&1 | grep -i boost\n```\n?",
          "created_at": "2025-10-29T17:23:19Z"
        },
        {
          "user": "umrashrf",
          "body": "@hebasto I first put the output to a file so I can resue it later.\n\n```\n% cat configure.log.3 | grep -i boost\n-- Performing Test NO_DIAGNOSTICS_BOOST_NO_CXX98_FUNCTION_BASE\n-- Performing Test NO_DIAGNOSTICS_BOOST_NO_CXX98_FUNCTION_BASE - Failed\nBoost_DIR:PATH=/opt/homebrew/opt/boost/lib/cmake/Boost-1.89.0\nboost_headers_DIR:PATH=/opt/homebrew/opt/boost/lib/cmake/boost_headers-1.89.0\n```",
          "created_at": "2025-10-29T17:42:45Z"
        },
        {
          "user": "hebasto",
          "body": "@umrashrf \n\nI have a guess, and to confirm it, I'd ask you to try configuring and building with the additional `-DENABLE_WALLET=OFF` option.",
          "created_at": "2025-10-29T17:49:04Z"
        },
        {
          "user": "umrashrf",
          "body": "@hebasto tried that but fails.\n\nconfigure.log https://gist.github.com/umrashrf/691047f40e17b7ca06abce2d25375323\nbuild.log https://gist.github.com/umrashrf/019e10e3fca1c6a686b556c7a6b65ce2",
          "created_at": "2025-10-29T18:04:09Z"
        },
        {
          "user": "l0rinc",
          "body": "> -L/opt/homebrew/opt/llvm@14\n\nthis is too old, you need at least version 17.\nDo a general `brew upgrade` on the system and retry, I have the same OSx, it should work.",
          "created_at": "2025-10-29T21:01:53Z"
        },
        {
          "user": "umrashrf",
          "body": "@l0rinc still fails\n\n1. brew upgrade\n2. brew reinstall boost\n3. use clang from homebrew (update $PATH)\n4. configure logs https://gist.github.com/umrashrf/6ca23317de227f3c8173a0031ced26f8\n5. build logs https://gist.github.com/umrashrf/d4e0ef25921f78fe9fc8909bff043ccb",
          "created_at": "2025-10-29T22:41:46Z"
        },
        {
          "user": "l0rinc",
          "body": "Seems the llvm upgrade was successful, but you still have two boost installations, try removing the old one.",
          "created_at": "2025-10-29T22:49:35Z"
        },
        {
          "user": "umrashrf",
          "body": "I feel a bit stupid as I just did git pull and it brought some new changes.\n\nAnyway I am still struggling to build successfully. @l0rinc you gave me a good tip. It's using /usr/local/include/boost/ instead of /opt/homebrew/Cellar/boost/1.89.0/include/boost/\n\nAny idea how can switch boost? I have already tried Boost_ROOT and other variables.",
          "created_at": "2025-10-30T05:07:03Z"
        },
        {
          "user": "umrashrf",
          "body": "Oh looks like I made some progress by using:\n\n```\nrm -rf build\ncmake -B build \\\n    -DCMAKE_C_COMPILER=/opt/homebrew/opt/llvm/bin/clang \\\n    -DCMAKE_CXX_COMPILER=/opt/homebrew/opt/llvm/bin/clang++ \\\n    -DENABLE_IPC=OFF \\\n    -DBUILD_GUI=OFF \\\n    -DWITH_QRENCODE=OFF \\\n    -DENABLE_WALLET=OFF\n```\n\nconfigure logs: https://gist.github.com/umrashrf/dabd3c476da9fa727add2db1522bf3c7\n\nIt failed but with a different error.\n\nBuild logs: https://gist.github.com/umrashrf/919fbed81177e5829b16bddea6220aae",
          "created_at": "2025-10-30T05:54:21Z"
        },
        {
          "user": "umrashrf",
          "body": "Doing the following fixed the issue!\n\n```\nexport LDFLAGS=\"-L$(brew --prefix llvm)/lib/c++\"\nexport CXXFLAGS=\"-I$(brew --prefix llvm)/include\"\n```\n\nBuild success 100%",
          "created_at": "2025-10-30T06:05:43Z"
        }
      ]
    },
    {
      "number": 33731,
      "title": "RFC: Do we want to support fuzzing on MacOS?",
      "body": "Fuzzing on MacOS (i.e. actual fuzzing not just running the inputs through the `fuzz` binary) is known to be brittle and we've had plenty of issues reported to us showcasing this:\n\n- https://github.com/bitcoin/bitcoin/issues/33667\n- https://github.com/bitcoin/bitcoin/issues/32089\n- https://github.com/bitcoin/bitcoin/issues/31049\n- https://github.com/bitcoin/bitcoin/issues/27550\n- https://github.com/bitcoin/bitcoin/issues/19789\n\nThe solution usually involves something along the lines of waiting for a brew llvm update or adding macOS specific hints to our documentation. These issues can however also depend on specific macOS versions, and our hints might not be accurate for every version or get stale with time.\n\nI usually don't chime in on these issues because I don't have a Mac and afaik, all serious fuzzing (at scale & automated) for us (and most other projects) happens on Linux.\n\nI think there are two options:\n\n1. Keep the current approach and fix/document as issues are reported.\n2. Deprecate \"official\" support for fuzzing on macOS and add a section to the docs about using Linux instead (e.g. to use a VM or VPS). MacOS users will still be able to fuzz on a their Mac but it won't be on us to triage the issues for their specific setup.\n\nI'd prefer option 2).",
      "state": "closed",
      "user": "dergoegge",
      "created_at": "2025-10-29T11:17:08Z",
      "updated_at": "2025-11-25T16:26:09Z",
      "comments": 19,
      "url": "https://github.com/bitcoin/bitcoin/issues/33731",
      "labels": [
        "Brainstorming",
        "Docs",
        "macOS",
        "Tests",
        "Up for grabs",
        "Fuzzing"
      ],
      "comment_list": [
        {
          "user": "fanquake",
          "body": "> 1. Keep the current approach and fix/document as issues are reported.\n\nIf we do do this, it should be clear what is supported (i.e just the latest version of LLVM/Clang shipped via brew, using `lld` to link?) , otherwise (as you metion above) we'll be documenting many different \"workarounds\" depending on the version of macOS, version of Apple clang/binutils install, if brew LLVM is being used, and it's version, using `ld64` to link, vs `lld`.\n\n> I'd prefer option 2).\n\nConcept ACK. Getting fuzzing to work on macOS seems like whack-a-mole, and even if somebody can get it to compile, the amount of useful fuzzing they are likely to do, other than a sanity check that the fuzzer doesn't immeadiately crash, seems limited.",
          "created_at": "2025-10-29T11:57:06Z"
        },
        {
          "user": "Crypt-iQ",
          "body": "I have a mac and prefer option 2 also. The fuzz tests usually break each macOS update and I don't think it makes sense to maintain documentation for it. I occasionally find it useful just to see that a harness is working, but I can fix issues on my own as they come up.",
          "created_at": "2025-10-29T12:13:25Z"
        },
        {
          "user": "marcofleon",
          "body": "Concept ACK on option 2. I remember struggling on my mac when I first started fuzzing and the section we have in the docs didn't really help. Ended up just figuring it out on my own. These days pretty much all of my fuzzing happens on Linux.",
          "created_at": "2025-10-29T12:20:05Z"
        },
        {
          "user": "maflcko",
          "body": "No strong opinion, but I don't mind having docs that just say they only works with a specific brew llvm version and macOS version, and have them updated when they break.\n\nThough, saying that libFuzzer is not supported on macOS seems also fine.",
          "created_at": "2025-10-29T12:24:37Z"
        },
        {
          "user": "brunoerg",
          "body": "Concept ACK on option 2. I use macOS and I agree this is a pain -- The effort of updating the documentation is not worth it. The only downside of it would be not attracting macOS people to fuzzing development (?). But anyway, if someone really wants to get in fuzzing dev would have to have a linux at some point.",
          "created_at": "2025-10-29T13:05:17Z"
        },
        {
          "user": "Crypt-iQ",
          "body": "> The only downside of it would be not attracting macOS people to fuzzing development (?)\n\nI was also thinking about this, and it could turn away some people from writing fuzz tests. Maybe if the docs mentioned a specific working version as suggested by @maflcko above, but then somebody would need to test these versions. I've had issues where even updating to a new macOS version isn't possible without some hacks.",
          "created_at": "2025-10-29T14:34:56Z"
        },
        {
          "user": "furszy",
          "body": "It‚Äôs definitely painful to run it on Mac. I'm not against officially deprecating it if that is the general consensus but it‚Äôs quite useful to be able to troubleshoot individual crashes/timeouts locally. It would be handy to have pinned versions with specific docs on how to make it work (if possible).",
          "created_at": "2025-10-29T14:48:56Z"
        },
        {
          "user": "dergoegge",
          "body": "> but it‚Äôs quite useful to be able to troubleshoot individual crashes/timeouts locally\n\nThis will still be possible, because you can build the `fuzz` binary without libFuzzer for reproduction purposes (this is what we do in the macOS fuzz CI job). Unless the bugs only manifest when running the fuzzer due to non-determinism.",
          "created_at": "2025-10-29T16:12:24Z"
        },
        {
          "user": "l0rinc",
          "body": "I have also documented some workarounds for mac in https://github.com/bitcoin/bitcoin/pull/32084#issuecomment-3361478681 - they kinda' work, without sanitizers at least, which cannot handle exceptions for some reason.\n\nBut I'm not sure why we want to give up fuzzing on Macs, everything we do is a whack-a-mole game, if we want people to write fuzz tests, we can't expect them to run them on a different machine and not even try them locally. We'll just end up with 100 PR pushes because people will debug these on the CI.",
          "created_at": "2025-10-29T20:56:22Z"
        },
        {
          "user": "maflcko",
          "body": "My suggestion would be similar to how valgrind is handled, which doesn't really work unless the dev picks a tested Linux distro, arch, and compiler, with compiler settings:\n\nhttps://github.com/bitcoin/bitcoin/blob/72511fd02e72b74be11273e97bd7911786a82e54/contrib/valgrind.supp#L15-L16\n\nIn that case, I'd expect that the `doc/fuzzing.md` would only list the latest release of macOS and the exact steps (with compiler version) to reproduce there. If someone is on an older macOS, they can check the older version of the docs on their own.\n\nObviously this means it will have to be updated yearly, but this is true for a lot of other docs, such as `doc/build-netbsd.md`, which list the latest tested version to work.",
          "created_at": "2025-10-30T08:58:20Z"
        },
        {
          "user": "fanquake",
          "body": "> we can't expect them to run them on a different machine and not even try them locally. \n\nThey can always use Podman or Docker, and run a Linux VM, on their macOS machine.",
          "created_at": "2025-10-30T10:44:57Z"
        },
        {
          "user": "Sjors",
          "body": "The only performant macOS machine I have is a laptop, so I would never use that for long running fuzzer jobs. I do want to be able to reproduce failures, but that's not at stake here.\n\nIf I ever want to add a new fuzz target, I don't mind trying it on a physical linux machine (virtualisation on Apple Silicon has often been a can of worms for me, though I haven't tried with fuzzing).\n\nNot doing (1) does increase the barrier for macOS based developers to contribute fuzz code. I'm not sure how to compare that to the effort saved by (2).\n\nMy preference would be (1), but limit documentation / support to the most recent macOS version. It can be limited to the minimum tooling required to briefly run fuzzers.",
          "created_at": "2025-11-05T20:10:47Z"
        },
        {
          "user": "maflcko",
          "body": "> My preference would be (1), but limit documentation / support to the most recent macOS version. It can be limited to the minimum tooling required to briefly run fuzzers.\n\nSounds good. So I guess this is up-for-grabs, and a dev with the latest macOS can just update the docs (https://github.com/bitcoin/bitcoin/blob/master/doc/fuzzing.md#macos-hints-for-libfuzzer) with the steps that work with that version?",
          "created_at": "2025-11-20T19:03:40Z"
        },
        {
          "user": "brunoerg",
          "body": "> Sounds good. So I guess this is up-for-grabs, and a dev with the latest macOS can just update the docs (https://github.com/bitcoin/bitcoin/blob/master/doc/fuzzing.md#macos-hints-for-libfuzzer) with the steps that work with that version?\n\nACK on doing it.",
          "created_at": "2025-11-20T19:41:32Z"
        },
        {
          "user": "l0rinc",
          "body": "> a dev with the latest macOS can just update the docs\n\nShould I revive https://github.com/bitcoin/bitcoin/pull/32084?",
          "created_at": "2025-11-20T19:54:18Z"
        },
        {
          "user": "maflcko",
          "body": "> > a dev with the latest macOS can just update the docs\n> \n> Should I revive [#32084](https://github.com/bitcoin/bitcoin/pull/32084)?\n\nI think you found that it doesn't work reliably. If there truly is no single way to get fuzzing to work fully reliably on macOS, it seems best to remove the docs temporarily.",
          "created_at": "2025-11-20T21:20:24Z"
        },
        {
          "user": "l0rinc",
          "body": "Fuzzing works, I just have to disable the sanitizers, since they disable exception support - and the fuzzer halts at the very first throw.",
          "created_at": "2025-11-20T21:46:49Z"
        },
        {
          "user": "maflcko",
          "body": "If `--preset=libfuzzer-nosan` is the only thing that works reliably, then only that should be mentioned. And possibly mention the option to reproduce existing fuzz inputs with a sanitizer, without libfuzzer.",
          "created_at": "2025-11-20T22:33:04Z"
        },
        {
          "user": "dergoegge",
          "body": "Opened #33921 ",
          "created_at": "2025-11-21T14:29:38Z"
        }
      ]
    }
  ],
  "summary": {
    "pull_requests": 5,
    "issues": 7
  }
}